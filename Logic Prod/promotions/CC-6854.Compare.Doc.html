<html>
<head>
<title>Compare Module List</title>
</head>
<body style="background-color:PowderBlue;"><div align="center"><h2>Compares for CC-6854-PEMA.ini</h2>
<h3>Processed on - 04/05/2018</h3></div>
<a name="topper"></a>
<a href="#inifile">INI File</a><br>
<a href="#ciddaily1">ciddaily1</a><br>
<a href="#cilgcrltrs">cilgcrltrs</a><br>
<a href="#EL1273S.bms">EL1273S.bms</a><br>
<a href="#EL6311S.bms">EL6311S.bms</a><br>
<a href="#ERCPNDB">ERCPNDB</a><br>
<a href="#ELCCERT">ELCCERT</a><br>
<a href="#ECSCRT01">ECSCRT01</a><br>
<a href="#ELC50WS">ELC50WS</a><br>
<a href="#ELC50PD">ELC50PD</a><br>
<a href="#DCC010.cbl">DCC010.cbl</a><br>
<a href="#ECS010.cbl">ECS010.cbl</a><br>
<a href="#EL331.cbl">EL331.cbl</a><br>
<a href="#EL512.cbl">EL512.cbl</a><br>
<a href="#EL570.cbl">EL570.cbl</a><br>
<a href="#EL689B.cbl">EL689B.cbl</a><br>
<a href="#CIDNSARE.cbl">CIDNSARE.cbl</a><br>
<a href="#EL6301.cl2">EL6301.cl2</a><br>
<a href="#EL6311.cl2">EL6311.cl2</a><br>
<a href="#VP6301.cl2">VP6301.cl2</a><br>
<a href="#VP6311.cl2">VP6311.cl2</a><br>
<a href="#EL689.cl2">EL689.cl2</a><br>
<a href="#ELCANC.cl2">ELCANC.cl2</a><br>
<a href="#EL1273.cl2">EL1273.cl2</a><br>
<a href="#NSRASBL.cl2">NSRASBL.cl2</a><br>
<h3>INI FILE As submitted by programmer, followed by log information <h3>
<pre>

[2015091000001]
[/apps/test/cid1s/jcl/daily_jobs/;/apps/prod/cid1p/jcl/daily_jobs/]
ciddaily1=
cilgcrltrs=
[/apps/test/cid1s/jcl/monthly_jobs/;/apps/prod/cid1p/jcl/monthly_jobs/]
[/apps/test/cid1s/jcl/quarterly_jobs/;/apps/prod/cid1p/jcl/quarterly_jobs/]
[/apps/test/cid1s/jcl/yearly_jobs/;/apps/prod/cid1p/jcl/yearly_jobs/]
[/export/home/pema/bin/;/export/home/mtpadmin/bin/]
[/data/test/seqfiles/;/data/seqfiles/]
[/apps/test/cid1s/sys/webroot/;/apps/prod/cid1p/sys/webroot/]
[/apps/test/cid1s/sys/webroot/balancesheet/;/apps/prod/cid1p/sys/webroot/balancesheet/]
[/apps/test/cid1s/sys/webroot/balancesheet/images/;/apps/prod/cid1p/sys/webroot/balancesheet/images/]
[/apps/test/cid1s/sys/webroot/balancesheet/javascript/;/apps/prod/cid1p/sys/webroot/balancesheet/javascript/]
[/apps/test/cid1s/sys/webroot/balancesheet/style/;/apps/prod/cid1p/sys/webroot/balancesheet/style/]
[/apps/test/cid1s/maps/;/apps/prod/cid1p/maps/]
EL1273S.bms=
EL1273S.map=
EL1273S=
EL6311S.bms=
EL6311S.map=
EL6311S=
[/apps/test/cid1s/copy/;/apps/prod/cid1p/copy/]
ERCPNDB=
ELCCERT=
ECSCRT01=
ELC50WS=
ELC50PD=
[/apps/test/cid1s/emails/;/apps/prod/cid1p/emails/]
[/apps/test/cid1s/parmlib/;/apps/prod/cid1p/parmlib/]
[/apps/test/cid1s/src/batch/;/apps/prod/cid1p/src/batch/]
DCC010.cbl=
DCC010.lst=
ECS010.cbl=
ECS010.lst=
EL331.cbl=
EL331.lst=
EL512.cbl=
EL512.lst=
EL570.cbl=
EL570.lst=
EL689B.cbl=
EL689B.lst=
EL517.lst=
CIDNSARE.cbl=
CIDNSARE.lst=
[/apps/test/cid1s/src/online/;/apps/prod/cid1p/src/online/]
EL6301.cl2=
EL6301.cbl=
EL6301.lst=
EL6311.cl2=
EL6311.cbl=
EL6311.lst=
VP6301.cl2=
VP6301.cbl=
VP6301.lst=
VP6311.cl2=
VP6311.cbl=
VP6311.lst=
EL689.cl2=
EL689.cbl=
EL689.lst=
ELCANC.cl2=
ELCANC.cbl=
ELCANC.lst=
EL1273.cl2=
EL1273.cbl=
EL1273.lst=
NSRASBL.cl2=
NSRASBL.cbl=
NSRASBL.lst=
EL050.cbl=
EL050.lst=
[/apps/test/cid1s/exe/bat/;/apps/prod/cid1p/staging/exe_bat/]
DCC010.gnt=
ECS010.gnt=
EL331.gnt=
EL512.gnt=
EL570.gnt=
EL689B.gnt=
EL517.gnt=
CIDNSARE.gnt=
[/apps/test/cid1s/exe/onl/;/apps/prod/cid1p/staging/exe_onl/]
EL6301.gnt=
EL6311.gnt=
VP6301.gnt=
VP6311.gnt=
EL689.gnt=
ELCANC.gnt=
EL1273.gnt=
NSRASBL.gnt=
EL050.gnt=
Archive Process Successfull using - perl /export/home/mtpadmin/bin/mtp_archive.pl CC-6854-PEMA.ini
Move Process Successfull using - perl /export/home/mtpadmin/bin/mtp_move.pl CC-6854-PEMA.ini
Promote process successfull and verified using - perl /export/home/mtpadmin/bin/mtp_verify.pl CC-6854-PEMA.ini
Archived module - /apps/prod/cid1p/jcl/daily_jobs/archive/ciddaily1.20180405
Archived module - /apps/prod/cid1p/jcl/daily_jobs/archive/cilgcrltrs.20180405
Archived module - /apps/prod/cid1p/maps/archive/EL1273S.bms.20180405
Archived module - /apps/prod/cid1p/maps/archive/EL1273S.map.20180405
Archived module - /apps/prod/cid1p/maps/archive/EL1273S.20180405
Archived module - /apps/prod/cid1p/maps/archive/EL6311S.bms.20180405
Archived module - /apps/prod/cid1p/maps/archive/EL6311S.map.20180405
Archived module - /apps/prod/cid1p/maps/archive/EL6311S.20180405
Archived module - /apps/prod/cid1p/copy/archive/ERCPNDB.20180405
Archived module - /apps/prod/cid1p/copy/archive/ELCCERT.20180405
Archived module - /apps/prod/cid1p/copy/archive/ECSCRT01.20180405
Archived module - /apps/prod/cid1p/copy/archive/ELC50WS.20180405
Archived module - /apps/prod/cid1p/copy/archive/ELC50PD.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/DCC010.cbl.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/DCC010.lst.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/ECS010.cbl.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/ECS010.lst.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/EL331.cbl.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/EL331.lst.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/EL512.cbl.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/EL512.lst.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/EL570.cbl.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/EL570.lst.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/EL689B.cbl.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/EL689B.lst.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/EL517.lst.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/CIDNSARE.cbl.20180405
Archived module - /apps/prod/cid1p/src/batch/archive/CIDNSARE.lst.20180405
Archived module - /apps/prod/cid1p/src/online/archive/EL6301.cl2.20180405
Archived module - /apps/prod/cid1p/src/online/archive/EL6301.cbl.20180405
Archived module - /apps/prod/cid1p/src/online/archive/EL6301.lst.20180405
Archived module - /apps/prod/cid1p/src/online/archive/EL6311.cl2.20180405
Archived module - /apps/prod/cid1p/src/online/archive/EL6311.cbl.20180405
Archived module - /apps/prod/cid1p/src/online/archive/EL6311.lst.20180405
Archived module - /apps/prod/cid1p/src/online/archive/VP6301.cl2.20180405
Archived module - /apps/prod/cid1p/src/online/archive/VP6301.cbl.20180405
Archived module - /apps/prod/cid1p/src/online/archive/VP6301.lst.20180405
Archived module - /apps/prod/cid1p/src/online/archive/VP6311.cl2.20180405
Archived module - /apps/prod/cid1p/src/online/archive/VP6311.cbl.20180405
Archived module - /apps/prod/cid1p/src/online/archive/VP6311.lst.20180405
Archived module - /apps/prod/cid1p/src/online/archive/EL689.cl2.20180405
Archived module - /apps/prod/cid1p/src/online/archive/EL689.cbl.20180405
Archived module - /apps/prod/cid1p/src/online/archive/EL689.lst.20180405
Archived module - /apps/prod/cid1p/src/online/archive/ELCANC.cl2.20180405
Archived module - /apps/prod/cid1p/src/online/archive/ELCANC.cbl.20180405
Archived module - /apps/prod/cid1p/src/online/archive/ELCANC.lst.20180405
Archived module - /apps/prod/cid1p/src/online/archive/EL1273.cl2.20180405
Archived module - /apps/prod/cid1p/src/online/archive/EL1273.cbl.20180405
Archived module - /apps/prod/cid1p/src/online/archive/EL1273.lst.20180405
Archived module - /apps/prod/cid1p/src/online/archive/NSRASBL.cl2.20180405
Archived module - /apps/prod/cid1p/src/online/archive/NSRASBL.cbl.20180405
Archived module - /apps/prod/cid1p/src/online/archive/NSRASBL.lst.20180405
Archived module - /apps/prod/cid1p/src/online/archive/EL050.cbl.20180405
Archived module - /apps/prod/cid1p/src/online/archive/EL050.lst.20180405
Archived module - /apps/prod/cid1p/exe/bat/archive/DCC010.gnt.20180405
Archived module - /apps/prod/cid1p/exe/bat/archive/ECS010.gnt.20180405
Archived module - /apps/prod/cid1p/exe/bat/archive/EL331.gnt.20180405
Archived module - /apps/prod/cid1p/exe/bat/archive/EL512.gnt.20180405
Archived module - /apps/prod/cid1p/exe/bat/archive/EL570.gnt.20180405
Archived module - /apps/prod/cid1p/exe/bat/archive/EL689B.gnt.20180405
Archived module - /apps/prod/cid1p/exe/bat/archive/EL517.gnt.20180405
Archived module - /apps/prod/cid1p/exe/bat/archive/CIDNSARE.gnt.20180405
Archived module - /apps/prod/cid1p/exe/onl/archive/EL6301.gnt.20180405
Archived module - /apps/prod/cid1p/exe/onl/archive/EL6311.gnt.20180405
Archived module - /apps/prod/cid1p/exe/onl/archive/VP6301.gnt.20180405
Archived module - /apps/prod/cid1p/exe/onl/archive/VP6311.gnt.20180405
Archived module - /apps/prod/cid1p/exe/onl/archive/EL689.gnt.20180405
Archived module - /apps/prod/cid1p/exe/onl/archive/ELCANC.gnt.20180405
Archived module - /apps/prod/cid1p/exe/onl/archive/EL1273.gnt.20180405
Archived module - /apps/prod/cid1p/exe/onl/archive/NSRASBL.gnt.20180405
Archived module - /apps/prod/cid1p/exe/onl/archive/EL050.gnt.20180405
moved module - /apps/prod/cid1p/jcl/daily_jobs/ciddaily1
moved module - /apps/prod/cid1p/jcl/daily_jobs/cilgcrltrs
moved module - /apps/prod/cid1p/maps/EL1273S.bms
moved module - /apps/prod/cid1p/maps/EL1273S.map
moved module - /apps/prod/cid1p/maps/EL1273S
moved module - /apps/prod/cid1p/maps/EL6311S.bms
moved module - /apps/prod/cid1p/maps/EL6311S.map
moved module - /apps/prod/cid1p/maps/EL6311S
moved module - /apps/prod/cid1p/copy/ERCPNDB
moved module - /apps/prod/cid1p/copy/ELCCERT
moved module - /apps/prod/cid1p/copy/ECSCRT01
moved module - /apps/prod/cid1p/copy/ELC50WS
moved module - /apps/prod/cid1p/copy/ELC50PD
moved module - /apps/prod/cid1p/src/batch/DCC010.cbl
moved module - /apps/prod/cid1p/src/batch/DCC010.lst
moved module - /apps/prod/cid1p/src/batch/ECS010.cbl
moved module - /apps/prod/cid1p/src/batch/ECS010.lst
moved module - /apps/prod/cid1p/src/batch/EL331.cbl
moved module - /apps/prod/cid1p/src/batch/EL331.lst
moved module - /apps/prod/cid1p/src/batch/EL512.cbl
moved module - /apps/prod/cid1p/src/batch/EL512.lst
moved module - /apps/prod/cid1p/src/batch/EL570.cbl
moved module - /apps/prod/cid1p/src/batch/EL570.lst
moved module - /apps/prod/cid1p/src/batch/EL689B.cbl
moved module - /apps/prod/cid1p/src/batch/EL689B.lst
moved module - /apps/prod/cid1p/src/batch/EL517.lst
moved module - /apps/prod/cid1p/src/batch/CIDNSARE.cbl
moved module - /apps/prod/cid1p/src/batch/CIDNSARE.lst
moved module - /apps/prod/cid1p/src/online/EL6301.cl2
moved module - /apps/prod/cid1p/src/online/EL6301.cbl
moved module - /apps/prod/cid1p/src/online/EL6301.lst
moved module - /apps/prod/cid1p/src/online/EL6311.cl2
moved module - /apps/prod/cid1p/src/online/EL6311.cbl
moved module - /apps/prod/cid1p/src/online/EL6311.lst
moved module - /apps/prod/cid1p/src/online/VP6301.cl2
moved module - /apps/prod/cid1p/src/online/VP6301.cbl
moved module - /apps/prod/cid1p/src/online/VP6301.lst
moved module - /apps/prod/cid1p/src/online/VP6311.cl2
moved module - /apps/prod/cid1p/src/online/VP6311.cbl
moved module - /apps/prod/cid1p/src/online/VP6311.lst
moved module - /apps/prod/cid1p/src/online/EL689.cl2
moved module - /apps/prod/cid1p/src/online/EL689.cbl
moved module - /apps/prod/cid1p/src/online/EL689.lst
moved module - /apps/prod/cid1p/src/online/ELCANC.cl2
moved module - /apps/prod/cid1p/src/online/ELCANC.cbl
moved module - /apps/prod/cid1p/src/online/ELCANC.lst
moved module - /apps/prod/cid1p/src/online/EL1273.cl2
moved module - /apps/prod/cid1p/src/online/EL1273.cbl
moved module - /apps/prod/cid1p/src/online/EL1273.lst
moved module - /apps/prod/cid1p/src/online/NSRASBL.cl2
moved module - /apps/prod/cid1p/src/online/NSRASBL.cbl
moved module - /apps/prod/cid1p/src/online/NSRASBL.lst
moved module - /apps/prod/cid1p/src/online/EL050.cbl
moved module - /apps/prod/cid1p/src/online/EL050.lst
moved module - /apps/prod/cid1p/staging/exe_bat/DCC010.gnt
moved module - /apps/prod/cid1p/staging/exe_bat/ECS010.gnt
moved module - /apps/prod/cid1p/staging/exe_bat/EL331.gnt
moved module - /apps/prod/cid1p/staging/exe_bat/EL512.gnt
moved module - /apps/prod/cid1p/staging/exe_bat/EL570.gnt
moved module - /apps/prod/cid1p/staging/exe_bat/EL689B.gnt
moved module - /apps/prod/cid1p/staging/exe_bat/EL517.gnt
moved module - /apps/prod/cid1p/staging/exe_bat/CIDNSARE.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/EL6301.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/EL6311.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/VP6301.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/VP6311.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/EL689.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/ELCANC.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/EL1273.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/NSRASBL.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/EL050.gnt

</pre>
<h3><a name="ciddaily1">ciddaily1</a><br><a href="#topper">Back to Top</a><br><pre>

175,181d174
< echo "cilg570 is about to start"
< unikixjob cilg570 -w -ca
< if ($status != 0) then
<     echo "cilg570 aborted"
<     exit 1
< endif
< echo "cilg570 terminated successfully"

</pre>
<h3><a name="CIDNSARE.cbl">CIDNSARE.cbl</a><br><a href="#topper">Back to Top</a><br><pre>

19a20
> 062017* 062017  CR2015091000001  PEMA  Calc interest amt for TN refunds
92c93,97
<                    
---
> 062017     SELECT ERENDT           ASSIGN TO ERENDT
> 062017                             ACCESS IS DYNAMIC
> 062017                             ORGANIZATION IS INDEXED
> 062017                             FILE STATUS IS ERENDT-FILE-STATUS
> 062017                             RECORD KEY IS EN-CONTROL-PRIMARY.
143a149,151
> 062017 FD  ERENDT.
> 062017                                 COPY ERCENDT.
> 
173a182
> 062017 77  ERENDT-FILE-STATUS          PIC XX  VALUE LOW-VALUES.
198a208,216
> 062017 77  v1                          pic s999 comp-3 value +0.
> 062017 77  WS-REF-AMT                  PIC S9(7)V99 COMP-3 VALUE +0.
> 062017 77  WS-INT-AMT                  PIC S9(7)V99 COMP-3 VALUE +0.
> 062017 77  ws-dis-int-amt              pic 9(7).99 value zeros.
> 062017 77  i1                          pic s999 comp-3 value +0.
> 062017 77  ws-dis-eff-dt               pic x(8).
> 062017 77  b1                          pic s9(5) comp-3 value +0.
> 062017 77  cntr                        pic s999 comp-3 value +0.
> 062017 77  ws-cc-bin-dt                pic xx value low-values.
200d217
<       
201a219,223
> 062017     05  ws-lf-orig-prm-amt      pic s9(7)v99 comp-3 value +0.
> 062017     05  ws-lf-orig-alt-prm-amt  pic s9(7)v99 comp-3 value +0.
> 062017     05  ws-ah-orig-prm-amt      pic s9(7)v99 comp-3 value +0.
> 062017     05  ws-done-sw-endt         pic x value ' '.
> 062017         88  i-am-done             value 'Y'.
258a281,690
> 062017 01  filler.
> 062017     05  ws-state-int-table occurs 70.
> 062017         10  ws-state-abbr           pic xx.
> 062017         10  ws-state-ref-int-rate   pic s9v9(4) comp-3 value +0.
> 062017
> 062017 01  ws-variable-table.
> 062017     05  ws-var-table.
> 062017         10  fld-001             pic x(20).
> 062017         10  fld-002             pic x(20).
> 062017         10  fld-003             pic x(20).
> 062017         10  fld-004             pic x(20).
> 062017         10  fld-005             pic x(20).
> 062017         10  fld-006             pic x(20).
> 062017         10  fld-007             pic x(20).
> 062017         10  fld-008             pic x(20).
> 062017         10  fld-009             pic x(20).
> 062017         10  fld-010             pic x(20).
> 062017         10  fld-011             pic x(20).
> 062017         10  fld-012             pic x(20).
> 062017         10  fld-013             pic x(20).
> 062017         10  fld-014             pic x(20).
> 062017         10  fld-015             pic x(20).
> 062017         10  fld-016             pic x(20).
> 062017         10  fld-017             pic x(20).
> 062017         10  fld-018             pic x(20).
> 062017         10  fld-019             pic x(20).
> 062017         10  fld-020             pic x(20).
> 062017         10  fld-021             pic x(20).
> 062017         10  fld-022             pic x(20).
> 062017         10  fld-023             pic x(20).
> 062017         10  fld-024             pic x(20).
> 062017         10  fld-025             pic x(20).
> 062017         10  fld-026             pic x(20).
> 062017         10  fld-027             pic x(20).
> 062017         10  fld-028             pic x(20).
> 062017         10  fld-029             pic x(20).
> 062017         10  fld-030             pic x(20).
> 062017         10  fld-031             pic x(20).
> 062017         10  fld-032             pic x(20).
> 062017         10  fld-033             pic x(20).
> 062017         10  fld-034             pic x(20).
> 062017         10  fld-035             pic x(20).
> 062017         10  fld-036             pic x(20).
> 062017         10  fld-037             pic x(20).
> 062017         10  fld-038             pic x(20).
> 062017         10  fld-039             pic x(20).
> 062017         10  fld-040             pic x(20).
> 062017         10  fld-041             pic x(20).
> 062017         10  fld-042             pic x(20).
> 062017         10  fld-043             pic x(20).
> 062017         10  fld-044             pic x(20).
> 062017         10  fld-045             pic x(20).
> 062017         10  fld-046             pic x(20).
> 062017         10  fld-047             pic x(20).
> 062017         10  fld-048             pic x(20).
> 062017         10  fld-049             pic x(20).
> 062017         10  fld-050             pic x(20).
> 062017         10  fld-051             pic x(20).
> 062017         10  fld-052             pic x(20).
> 062017         10  fld-053             pic x(20).
> 062017         10  fld-054             pic x(20).
> 062017         10  fld-055             pic x(20).
> 062017         10  fld-056             pic x(20).
> 062017         10  fld-057             pic x(20).
> 062017         10  fld-058             pic x(20).
> 062017         10  fld-059             pic x(20).
> 062017         10  fld-060             pic x(20).
> 062017         10  fld-061             pic x(20).
> 062017         10  fld-062             pic x(20).
> 062017         10  fld-063             pic x(20).
> 062017         10  fld-064             pic x(20).
> 062017         10  fld-065             pic x(20).
> 062017         10  fld-066             pic x(20).
> 062017         10  fld-067             pic x(20).
> 062017         10  fld-068             pic x(20).
> 062017         10  fld-069             pic x(20).
> 062017         10  fld-070             pic x(20).
> 062017         10  fld-071             pic x(20).
> 062017         10  fld-072             pic x(20).
> 062017         10  fld-073             pic x(20).
> 062017         10  fld-074             pic x(20).
> 062017         10  fld-075             pic x(20).
> 062017         10  fld-076             pic x(20).
> 062017         10  fld-077             pic x(20).
> 062017         10  fld-078             pic x(20).
> 062017         10  fld-079             pic x(20).
> 062017         10  fld-080             pic x(20).
> 062017         10  fld-081             pic x(20).
> 062017         10  fld-082             pic x(20).
> 062017         10  fld-083             pic x(20).
> 062017         10  fld-084             pic x(20).
> 062017         10  fld-085             pic x(20).
> 062017         10  fld-086             pic x(20).
> 062017         10  fld-087             pic x(20).
> 062017         10  fld-088             pic x(20).
> 062017         10  fld-089             pic x(20).
> 062017         10  fld-090             pic x(20).
> 062017         10  fld-091             pic x(20).
> 062017         10  fld-092             pic x(20).
> 062017         10  fld-093             pic x(20).
> 062017         10  fld-094             pic x(20).
> 062017         10  fld-095             pic x(20).
> 062017         10  fld-096             pic x(20).
> 062017         10  fld-097             pic x(20).
> 062017         10  fld-098             pic x(20).
> 062017         10  fld-099             pic x(20).
> 062017         10  fld-100             pic x(20).
> 062017         10  fld-101             pic x(20).
> 062017         10  fld-102             pic x(20).
> 062017         10  fld-103             pic x(20).
> 062017         10  fld-104             pic x(20).
> 062017         10  fld-105             pic x(20).
> 062017         10  fld-106             pic x(20).
> 062017         10  fld-107             pic x(20).
> 062017         10  fld-108             pic x(20).
> 062017         10  fld-109             pic x(20).
> 062017         10  fld-110             pic x(20).
> 062017         10  fld-111             pic x(20).
> 062017         10  fld-112             pic x(20).
> 062017         10  fld-113             pic x(20).
> 062017         10  fld-114             pic x(20).
> 062017         10  fld-115             pic x(20).
> 062017         10  fld-116             pic x(20).
> 062017         10  fld-117             pic x(20).
> 062017         10  fld-118             pic x(20).
> 062017         10  fld-119             pic x(20).
> 062017         10  fld-120             pic x(20).
> 062017         10  fld-121             pic x(20).
> 062017         10  fld-122             pic x(20).
> 062017         10  fld-123             pic x(20).
> 062017         10  fld-124             pic x(20).
> 062017         10  fld-125             pic x(20).
> 062017         10  fld-126             pic x(20).
> 062017         10  fld-127             pic x(20).
> 062017         10  fld-128             pic x(20).
> 062017         10  fld-129             pic x(20).
> 062017         10  fld-130             pic x(20).
> 062017         10  fld-131             pic x(20).
> 062017         10  fld-132             pic x(20).
> 062017         10  fld-133             pic x(20).
> 062017         10  fld-134             pic x(20).
> 062017         10  fld-135             pic x(20).
> 062017         10  fld-136             pic x(20).
> 062017         10  fld-137             pic x(20).
> 062017         10  fld-138             pic x(20).
> 062017         10  fld-139             pic x(20).
> 062017         10  fld-140             pic x(20).
> 062017         10  fld-141             pic x(20).
> 062017         10  fld-142             pic x(20).
> 062017         10  fld-143             pic x(20).
> 062017         10  fld-144             pic x(20).
> 062017         10  fld-145             pic x(20).
> 062017         10  fld-146             pic x(20).
> 062017         10  fld-147             pic x(20).
> 062017         10  fld-148             pic x(20).
> 062017         10  fld-149             pic x(20).
> 062017         10  fld-150             pic x(20).
> 062017         10  fld-151             pic x(20).
> 062017         10  fld-152             pic x(20).
> 062017         10  fld-153             pic x(20).
> 062017         10  fld-154             pic x(20).
> 062017         10  fld-155             pic x(20).
> 062017         10  fld-156             pic x(20).
> 062017         10  fld-157             pic x(20).
> 062017         10  fld-158             pic x(20).
> 062017         10  fld-159             pic x(20).
> 062017         10  fld-160             pic x(20).
> 062017         10  fld-161             pic x(20).
> 062017         10  fld-162             pic x(20).
> 062017         10  fld-163             pic x(20).
> 062017         10  fld-164             pic x(20).
> 062017         10  fld-165             pic x(20).
> 062017         10  fld-166             pic x(20).
> 062017         10  fld-167             pic x(20).
> 062017         10  fld-168             pic x(20).
> 062017         10  fld-169             pic x(20).
> 062017         10  fld-170             pic x(20).
> 062017         10  fld-171             pic x(20).
> 062017         10  fld-172             pic x(20).
> 062017         10  fld-173             pic x(20).
> 062017         10  fld-174             pic x(20).
> 062017         10  fld-175             pic x(20).
> 062017         10  fld-176             pic x(20).
> 062017         10  fld-177             pic x(20).
> 062017         10  fld-178             pic x(20).
> 062017         10  fld-179             pic x(20).
> 062017         10  fld-180             pic x(20).
> 062017         10  fld-181             pic x(20).
> 062017         10  fld-182             pic x(20).
> 062017         10  fld-183             pic x(20).
> 062017         10  fld-184             pic x(20).
> 062017         10  fld-185             pic x(20).
> 062017         10  fld-186             pic x(20).
> 062017         10  fld-187             pic x(20).
> 062017         10  fld-188             pic x(20).
> 062017         10  fld-189             pic x(20).
> 062017         10  fld-190             pic x(20).
> 062017         10  fld-191             pic x(20).
> 062017         10  fld-192             pic x(20).
> 062017         10  fld-193             pic x(20).
> 062017         10  fld-194             pic x(20).
> 062017         10  fld-195             pic x(20).
> 062017         10  fld-196             pic x(20).
> 062017         10  fld-197             pic x(20).
> 062017         10  fld-198             pic x(20).
> 062017         10  fld-199             pic x(20).
> 062017         10  fld-200             pic x(20).
> 062017         10  fld-201             pic x(20).
> 062017         10  fld-202             pic x(20).
> 062017         10  fld-203             pic x(20).
> 062017         10  fld-204             pic x(20).
> 062017         10  fld-205             pic x(20).
> 062017         10  fld-206             pic x(20).
> 062017         10  fld-207             pic x(20).
> 062017         10  fld-208             pic x(20).
> 062017         10  fld-209             pic x(20).
> 062017         10  fld-210             pic x(20).
> 062017         10  fld-211             pic x(20).
> 062017         10  fld-212             pic x(20).
> 062017         10  fld-213             pic x(20).
> 062017         10  fld-214             pic x(20).
> 062017         10  fld-215             pic x(20).
> 062017         10  fld-216             pic x(20).
> 062017         10  fld-217             pic x(20).
> 062017         10  fld-218             pic x(20).
> 062017         10  fld-219             pic x(20).
> 062017         10  fld-220             pic x(20).
> 062017         10  fld-221             pic x(20).
> 062017         10  fld-222             pic x(20).
> 062017         10  fld-223             pic x(20).
> 062017         10  fld-224             pic x(20).
> 062017         10  fld-225             pic x(20).
> 062017         10  fld-226             pic x(20).
> 062017         10  fld-227             pic x(20).
> 062017         10  fld-228             pic x(20).
> 062017         10  fld-229             pic x(20).
> 062017         10  fld-230             pic x(20).
> 062017         10  fld-231             pic x(20).
> 062017         10  fld-232             pic x(20).
> 062017         10  fld-233             pic x(20).
> 062017         10  fld-234             pic x(20).
> 062017         10  fld-235             pic x(20).
> 062017         10  fld-236             pic x(20).
> 062017         10  fld-237             pic x(20).
> 062017         10  fld-238             pic x(20).
> 062017         10  fld-239             pic x(20).
> 062017         10  fld-240             pic x(20).
> 062017         10  fld-241             pic x(20).
> 062017         10  fld-242             pic x(20).
> 062017         10  fld-243             pic x(20).
> 062017         10  fld-244             pic x(20).
> 062017         10  fld-245             pic x(20).
> 062017         10  fld-246             pic x(20).
> 062017         10  fld-247             pic x(20).
> 062017         10  fld-248             pic x(20).
> 062017         10  fld-249             pic x(20).
> 062017         10  fld-250             pic x(20).
> 062017         10  fld-251             pic x(20).
> 062017         10  fld-252             pic x(20).
> 062017         10  fld-253             pic x(20).
> 062017         10  fld-254             pic x(20).
> 062017         10  fld-255             pic x(20).
> 062017         10  fld-256             pic x(20).
> 062017         10  fld-257             pic x(20).
> 062017         10  fld-258             pic x(20).
> 062017         10  fld-259             pic x(20).
> 062017         10  fld-260             pic x(20).
> 062017         10  fld-261             pic x(20).
> 062017         10  fld-262             pic x(20).
> 062017         10  fld-263             pic x(20).
> 062017         10  fld-264             pic x(20).
> 062017         10  fld-265             pic x(20).
> 062017         10  fld-266             pic x(20).
> 062017         10  fld-267             pic x(20).
> 062017         10  fld-268             pic x(20).
> 062017         10  fld-269             pic x(20).
> 062017         10  fld-270             pic x(20).
> 062017         10  fld-271             pic x(20).
> 062017         10  fld-272             pic x(20).
> 062017         10  fld-273             pic x(20).
> 062017         10  fld-274             pic x(20).
> 062017         10  fld-275             pic x(20).
> 062017         10  fld-276             pic x(20).
> 062017         10  fld-277             pic x(20).
> 062017         10  fld-278             pic x(20).
> 062017         10  fld-279             pic x(20).
> 062017         10  fld-280             pic x(20).
> 062017         10  fld-281             pic x(20).
> 062017         10  fld-282             pic x(20).
> 062017         10  fld-283             pic x(20).
> 062017         10  fld-284             pic x(20).
> 062017         10  fld-285             pic x(20).
> 062017         10  fld-286             pic x(20).
> 062017         10  fld-287             pic x(20).
> 062017         10  fld-288             pic x(20).
> 062017         10  fld-289             pic x(20).
> 062017         10  fld-290             pic x(20).
> 062017         10  fld-291             pic x(20).
> 062017         10  fld-292             pic x(20).
> 062017         10  fld-293             pic x(20).
> 062017         10  fld-294             pic x(20).
> 062017         10  fld-295             pic x(20).
> 062017         10  fld-296             pic x(20).
> 062017         10  fld-297             pic x(20).
> 062017         10  fld-298             pic x(20).
> 062017         10  fld-299             pic x(20).
> 062017         10  fld-300             pic x(20).
> 062017         10  fld-301             pic x(20).
> 062017         10  fld-302             pic x(20).
> 062017         10  fld-303             pic x(20).
> 062017         10  fld-304             pic x(20).
> 062017         10  fld-305             pic x(20).
> 062017         10  fld-306             pic x(20).
> 062017         10  fld-307             pic x(20).
> 062017         10  fld-308             pic x(20).
> 062017         10  fld-309             pic x(20).
> 062017         10  fld-310             pic x(20).
> 062017         10  fld-311             pic x(20).
> 062017         10  fld-312             pic x(20).
> 062017         10  fld-313             pic x(20).
> 062017         10  fld-314             pic x(20).
> 062017         10  fld-315             pic x(20).
> 062017         10  fld-316             pic x(20).
> 062017         10  fld-317             pic x(20).
> 062017         10  fld-318             pic x(20).
> 062017         10  fld-319             pic x(20).
> 062017         10  fld-320             pic x(20).
> 062017         10  fld-321             pic x(20).
> 062017         10  fld-322             pic x(20).
> 062017         10  fld-323             pic x(20).
> 062017         10  fld-324             pic x(20).
> 062017         10  fld-325             pic x(20).
> 062017         10  fld-326             pic x(20).
> 062017         10  fld-327             pic x(20).
> 062017         10  fld-328             pic x(20).
> 062017         10  fld-329             pic x(20).
> 062017         10  fld-330             pic x(20).
> 062017         10  fld-331             pic x(20).
> 062017         10  fld-332             pic x(20).
> 062017         10  fld-333             pic x(20).
> 062017         10  fld-334             pic x(20).
> 062017         10  fld-335             pic x(20).
> 062017         10  fld-336             pic x(20).
> 062017         10  fld-337             pic x(20).
> 062017         10  fld-338             pic x(20).
> 062017         10  fld-339             pic x(20).
> 062017         10  fld-340             pic x(20).
> 062017         10  fld-341             pic x(20).
> 062017         10  fld-342             pic x(20).
> 062017         10  fld-343             pic x(20).
> 062017         10  fld-344             pic x(20).
> 062017         10  fld-345             pic x(20).
> 062017         10  fld-346             pic x(20).
> 062017         10  fld-347             pic x(20).
> 062017         10  fld-348             pic x(20).
> 062017         10  fld-349             pic x(20).
> 062017         10  fld-350             pic x(20).
> 062017         10  fld-351             pic x(20).
> 062017         10  fld-352             pic x(20).
> 062017         10  fld-353             pic x(20).
> 062017         10  fld-354             pic x(20).
> 062017         10  fld-355             pic x(20).
> 062017         10  fld-356             pic x(20).
> 062017         10  fld-357             pic x(20).
> 062017         10  fld-358             pic x(20).
> 062017         10  fld-359             pic x(20).
> 062017         10  fld-360             pic x(20).
> 062017         10  fld-361             pic x(20).
> 062017         10  fld-362             pic x(20).
> 062017         10  fld-363             pic x(20).
> 062017         10  fld-364             pic x(20).
> 062017         10  fld-365             pic x(20).
> 062017         10  fld-366             pic x(20).
> 062017         10  fld-367             pic x(20).
> 062017         10  fld-368             pic x(20).
> 062017         10  fld-369             pic x(20).
> 062017         10  fld-370             pic x(20).
> 062017         10  fld-371             pic x(20).
> 062017         10  fld-372             pic x(20).
> 062017         10  fld-373             pic x(20).
> 062017         10  fld-374             pic x(20).
> 062017         10  fld-375             pic x(20).
> 062017         10  fld-376             pic x(20).
> 062017         10  fld-377             pic x(20).
> 062017         10  fld-378             pic x(20).
> 062017         10  fld-379             pic x(20).
> 062017         10  fld-380             pic x(20).
> 062017         10  fld-381             pic x(20).
> 062017         10  fld-382             pic x(20).
> 062017         10  fld-383             pic x(20).
> 062017         10  fld-384             pic x(20).
> 062017         10  fld-385             pic x(20).
> 062017         10  fld-386             pic x(20).
> 062017         10  fld-387             pic x(20).
> 062017         10  fld-388             pic x(20).
> 062017         10  fld-389             pic x(20).
> 062017         10  fld-390             pic x(20).
> 062017         10  fld-391             pic x(20).
> 062017         10  fld-392             pic x(20).
> 062017         10  fld-393             pic x(20).
> 062017         10  fld-394             pic x(20).
> 062017         10  fld-395             pic x(20).
> 062017         10  fld-396             pic x(20).
> 062017         10  fld-397             pic x(20).
> 062017         10  fld-398             pic x(20).
> 062017         10  fld-399             pic x(20).
> 062017         10  fld-400             pic x(20).
> 062017     05  filler redefines ws-var-table occurs 400.
> 062017         10  ws-variable-value   pic x(20).
> 
327d758
< 
329d759
< 
333c763
<        
---
> 
344c774
<             
---
> 
373c803
<            
---
> 
377c807
<                       
---
> 
394c824
<            
---
> 
449d878
< 
480c909
<                   
---
> 
504c933
<                                   WRK-ORIG-ARCHIVE-NO
---
> 062017          la-cert-no-a2 ' ' WRK-ORIG-ARCHIVE-NO
513c942
<                                   WRK-ORIG-ARCHIVE-NO
---
> 062017            la-cert-no-a2 ' ' WRK-ORIG-ARCHIVE-NO
542a972
> 062017     perform 1100-extract-vars   thru 1100-exit
545c975
<            
---
> 
594d1023
< 
605c1034
< 100913     OPEN INPUT ELLETR ERPNDB ELMSTR ELEOBC.
---
> 062017     OPEN INPUT ELLETR ERPNDB ELMSTR ELEOBC ERENDT
640a1070,1075
> 062017     IF ERENDT-FILE-STATUS NOT = '00' AND '97'
> 062017        MOVE ' ERENDT OPEN ERROR ' TO WS-ABEND-MESSAGE
> 062017        MOVE ERENDT-FILE-STATUS    TO WS-ABEND-FILE-STATUS
> 062017        PERFORM ABEND-PGM
> 062017     END-IF.
> 
677a1113,1117
> 062017     perform varying i1 from +1 by +1 until i1 > +70
> 062017        move spaces              to ws-state-abbr (i1)
> 062017        move zeros               to ws-state-ref-int-rate (i1)
> 062017     end-perform
> 
714a1155,1157
> 
> 062017     perform 0230-build-ref-int-table
> 062017                                 thru 0230-exit
724a1168,1178
> 062017     move parm-cycle-date        to dc-greg-date-cymd-r
> 062017     move 'L'                    to dc-option-code
> 062017     PERFORM 8510-DATE-CONVERSION
> 062017     IF NO-CONVERSION-ERROR
> 062017        MOVE DC-BIN-DATE-1       to ws-cc-bin-dt
> 062017     ELSE
> 062017        DISPLAY 'ERROR converting cycle date ' parm-cycle-date
> 062017        perform abend-pgm
> 062017     END-IF
> 
>            .
734c1188
< 103012     CLOSE ELMSTR.
---
> 062017     CLOSE ELMSTR ERENDT
746a1201,1205
> 062017     IF ERENDT-FILE-STATUS NOT = '00'
> 062017        DISPLAY ' ERENDT CLOSE ' ERENDT-FILE-STATUS
> 062017        PERFORM ABEND-PGM
> 062017     END-IF.
> 
955d1413
< 
958a1417,1456
> 062017 0230-build-ref-int-table.
> 062017
> 062017     MOVE DTE-CLIENT             TO CF-COMPANY-ID
> 062017     MOVE '3'                    TO CF-RECORD-TYPE
> 062017     MOVE low-values             TO CF-ACCESS-of-state
> 062017     MOVE +0                     TO CF-SEQUENCE-NO
> 062017
> 062017     start ELCNTL key >= cf-control-primary
> 062017     if elcntl-file-status not = '00'
> 062017        display 'ERROR-ELCNTL-START ' ELCNTL-FILE-STATUS
> 062017        PERFORM ABEND-PGM
> 062017     END-IF
> 062017
> 062017     read elcntl next record
> 062017     move +1                     to i1
> 062017
> 062017     perform until
> 062017        (elcntl-file-status <> '00')
> 062017        or (cf-record-type <> '3')
> 062017        if cf-st-calc-interest not numeric
> 062017           move +0               to cf-st-calc-interest
> 062017        end-if
> 062017        if cf-st-calc-interest <> zeros
> 062017           move cf-state-abbreviation
> 062017                                 to ws-state-abbr (i1)
> 062017           move cf-st-calc-interest
> 062017                                 to ws-state-ref-int-rate (i1)
> 062017           display ' found state with int ' cf-state-code ' '
> 062017              cf-st-calc-interest
> 062017           add +1 to i1
> 062017        end-if
> 062017        read elcntl next record
> 062017     end-perform
> 062017
> 062017     display ' load of ref int table complete ' i1
> 062017
> 062017     .
> 062017 0230-EXIT.
> 062017     EXIT.
> 
1276c1774,2296
< 100913
---
> 062017 1100-extract-vars.
> 062017
> 062017***  Total interest field is field #230.
> 062017
> 062017*    if (cm-state = 'TN')
> 062017*       and (w-auto-close-ind = 'B' OR 'C')
> 062017*       display ' found Final action of b or c ' ext-letter-id
> 062017*    else
> 062017*       go to 1100-exit
> 062017*    end-if
> 062017
> 062017     unstring EXT-LETTER-VARIABLES
> 062017        delimited by '~' into
> 062017        fld-001    
> 062017        fld-002    
> 062017        fld-003    
> 062017        fld-004    
> 062017        fld-005    
> 062017        fld-006    
> 062017        fld-007    
> 062017        fld-008    
> 062017        fld-009    
> 062017        fld-010    
> 062017        fld-011    
> 062017        fld-012    
> 062017        fld-013    
> 062017        fld-014    
> 062017        fld-015    
> 062017        fld-016    
> 062017        fld-017    
> 062017        fld-018    
> 062017        fld-019    
> 062017        fld-020    
> 062017        fld-021    
> 062017        fld-022    
> 062017        fld-023    
> 062017        fld-024    
> 062017        fld-025    
> 062017        fld-026    
> 062017        fld-027    
> 062017        fld-028    
> 062017        fld-029    
> 062017        fld-030    
> 062017        fld-031    
> 062017        fld-032    
> 062017        fld-033    
> 062017        fld-034    
> 062017        fld-035    
> 062017        fld-036    
> 062017        fld-037    
> 062017        fld-038    
> 062017        fld-039    
> 062017        fld-040    
> 062017        fld-041    
> 062017        fld-042    
> 062017        fld-043    
> 062017        fld-044    
> 062017        fld-045    
> 062017        fld-046    
> 062017        fld-047    
> 062017        fld-048    
> 062017        fld-049    
> 062017        fld-050    
> 062017        fld-051    
> 062017        fld-052    
> 062017        fld-053    
> 062017        fld-054    
> 062017        fld-055    
> 062017        fld-056    
> 062017        fld-057    
> 062017        fld-058    
> 062017        fld-059    
> 062017        fld-060    
> 062017        fld-061    
> 062017        fld-062    
> 062017        fld-063    
> 062017        fld-064    
> 062017        fld-065    
> 062017        fld-066    
> 062017        fld-067    
> 062017        fld-068    
> 062017        fld-069    
> 062017        fld-070    
> 062017        fld-071    
> 062017        fld-072    
> 062017        fld-073    
> 062017        fld-074    
> 062017        fld-075    
> 062017        fld-076    
> 062017        fld-077    
> 062017        fld-078    
> 062017        fld-079    
> 062017        fld-080    
> 062017        fld-081    
> 062017        fld-082    
> 062017        fld-083    
> 062017        fld-084    
> 062017        fld-085    
> 062017        fld-086    
> 062017        fld-087    
> 062017        fld-088    
> 062017        fld-089    
> 062017        fld-090    
> 062017        fld-091    
> 062017        fld-092    
> 062017        fld-093    
> 062017        fld-094    
> 062017        fld-095    
> 062017        fld-096    
> 062017        fld-097    
> 062017        fld-098    
> 062017        fld-099    
> 062017        fld-100    
> 062017        fld-101    
> 062017        fld-102    
> 062017        fld-103    
> 062017        fld-104    
> 062017        fld-105    
> 062017        fld-106    
> 062017        fld-107    
> 062017        fld-108    
> 062017        fld-109    
> 062017        fld-110    
> 062017        fld-111    
> 062017        fld-112    
> 062017        fld-113    
> 062017        fld-114    
> 062017        fld-115    
> 062017        fld-116    
> 062017        fld-117    
> 062017        fld-118    
> 062017        fld-119    
> 062017        fld-120    
> 062017        fld-121    
> 062017        fld-122    
> 062017        fld-123    
> 062017        fld-124    
> 062017        fld-125    
> 062017        fld-126    
> 062017        fld-127    
> 062017        fld-128    
> 062017        fld-129    
> 062017        fld-130    
> 062017        fld-131    
> 062017        fld-132    
> 062017        fld-133    
> 062017        fld-134    
> 062017        fld-135    
> 062017        fld-136    
> 062017        fld-137    
> 062017        fld-138    
> 062017        fld-139    
> 062017        fld-140    
> 062017        fld-141    
> 062017        fld-142    
> 062017        fld-143    
> 062017        fld-144    
> 062017        fld-145    
> 062017        fld-146    
> 062017        fld-147    
> 062017        fld-148    
> 062017        fld-149    
> 062017        fld-150    
> 062017        fld-151    
> 062017        fld-152    
> 062017        fld-153    
> 062017        fld-154    
> 062017        fld-155    
> 062017        fld-156    
> 062017        fld-157    
> 062017        fld-158    
> 062017        fld-159    
> 062017        fld-160    
> 062017        fld-161    
> 062017        fld-162    
> 062017        fld-163    
> 062017        fld-164    
> 062017        fld-165    
> 062017        fld-166    
> 062017        fld-167    
> 062017        fld-168    
> 062017        fld-169    
> 062017        fld-170    
> 062017        fld-171    
> 062017        fld-172    
> 062017        fld-173    
> 062017        fld-174    
> 062017        fld-175    
> 062017        fld-176    
> 062017        fld-177    
> 062017        fld-178    
> 062017        fld-179    
> 062017        fld-180    
> 062017        fld-181    
> 062017        fld-182    
> 062017        fld-183    
> 062017        fld-184    
> 062017        fld-185    
> 062017        fld-186    
> 062017        fld-187    
> 062017        fld-188    
> 062017        fld-189    
> 062017        fld-190    
> 062017        fld-191    
> 062017        fld-192    
> 062017        fld-193    
> 062017        fld-194    
> 062017        fld-195    
> 062017        fld-196    
> 062017        fld-197    
> 062017        fld-198    
> 062017        fld-199    
> 062017        fld-200    
> 062017        fld-201    
> 062017        fld-202    
> 062017        fld-203    
> 062017        fld-204    
> 062017        fld-205    
> 062017        fld-206    
> 062017        fld-207    
> 062017        fld-208    
> 062017        fld-209    
> 062017        fld-210    
> 062017        fld-211    
> 062017        fld-212    
> 062017        fld-213    
> 062017        fld-214    
> 062017        fld-215    
> 062017        fld-216    
> 062017        fld-217    
> 062017        fld-218    
> 062017        fld-219    
> 062017        fld-220    
> 062017        fld-221    
> 062017        fld-222    
> 062017        fld-223    
> 062017        fld-224    
> 062017        fld-225    
> 062017        fld-226    
> 062017        fld-227    
> 062017        fld-228    
> 062017        fld-229    
> 062017        fld-230     *>  Interest
> 062017        fld-231    
> 062017        fld-232    
> 062017        fld-233    
> 062017        fld-234    
> 062017        fld-235    
> 062017        fld-236    
> 062017        fld-237    
> 062017        fld-238    
> 062017        fld-239    
> 062017        fld-240    
> 062017        fld-241    
> 062017        fld-242    
> 062017        fld-243    
> 062017        fld-244    
> 062017        fld-245    
> 062017        fld-246    
> 062017        fld-247    
> 062017        fld-248    
> 062017        fld-249    
> 062017        fld-250    
> 062017        fld-251    
> 062017        fld-252    
> 062017        fld-253    
> 062017        fld-254    
> 062017        fld-255    
> 062017        fld-256    
> 062017        fld-257    
> 062017        fld-258    
> 062017        fld-259    
> 062017        fld-260    
> 062017        fld-261    
> 062017        fld-262    
> 062017        fld-263    
> 062017        fld-264    
> 062017        fld-265    
> 062017        fld-266    
> 062017        fld-267    
> 062017        fld-268    
> 062017        fld-269    
> 062017        fld-270    
> 062017        fld-271    
> 062017        fld-272    
> 062017        fld-273    
> 062017        fld-274    
> 062017        fld-275    
> 062017        fld-276    
> 062017        fld-277    
> 062017        fld-278    
> 062017        fld-279    
> 062017        fld-280    
> 062017        fld-281    
> 062017        fld-282    
> 062017        fld-283    
> 062017        fld-284    
> 062017        fld-285    
> 062017        fld-286    
> 062017        fld-287    
> 062017        fld-288    
> 062017        fld-289    
> 062017        fld-290    
> 062017        fld-291    
> 062017        fld-292    
> 062017        fld-293    
> 062017        fld-294    
> 062017        fld-295    
> 062017        fld-296    
> 062017        fld-297    
> 062017        fld-298    
> 062017        fld-299    
> 062017        fld-300    
> 062017        fld-301    
> 062017        fld-302    
> 062017        fld-303    
> 062017        fld-304    
> 062017        fld-305    
> 062017        fld-306    
> 062017        fld-307    
> 062017        fld-308    
> 062017        fld-309    
> 062017        fld-310    
> 062017        fld-311    
> 062017        fld-312    
> 062017        fld-313    
> 062017        fld-314    
> 062017        fld-315    
> 062017        fld-316    
> 062017        fld-317    
> 062017        fld-318    
> 062017        fld-319    
> 062017        fld-320    
> 062017        fld-321    
> 062017        fld-322    
> 062017        fld-323    
> 062017        fld-324    
> 062017        fld-325    
> 062017        fld-326    
> 062017        fld-327    
> 062017        fld-328    
> 062017        fld-329    
> 062017        fld-330    
> 062017        fld-331    
> 062017        fld-332    
> 062017        fld-333    
> 062017        fld-334    
> 062017        fld-335    
> 062017        fld-336    
> 062017        fld-337    
> 062017        fld-338    
> 062017        fld-339    
> 062017        fld-340    
> 062017        fld-341    
> 062017        fld-342    
> 062017        fld-343    
> 062017        fld-344    
> 062017        fld-345    
> 062017        fld-346    
> 062017        fld-347    
> 062017        fld-348    
> 062017        fld-349    
> 062017        fld-350    
> 062017        fld-351    
> 062017        fld-352    
> 062017        fld-353    
> 062017        fld-354    
> 062017        fld-355    
> 062017        fld-356    
> 062017        fld-357    
> 062017        fld-358    
> 062017        fld-359    
> 062017        fld-360    
> 062017        fld-361    
> 062017        fld-362    
> 062017        fld-363    
> 062017        fld-364    
> 062017        fld-365    
> 062017        fld-366    
> 062017        fld-367    
> 062017        fld-368    
> 062017        fld-369    
> 062017        fld-370    
> 062017        fld-371    
> 062017        fld-372    
> 062017        fld-373    
> 062017        fld-374    
> 062017        fld-375    
> 062017        fld-376    
> 062017        fld-377    
> 062017        fld-378    
> 062017        fld-379    
> 062017        fld-380    
> 062017        fld-381    
> 062017        fld-382    
> 062017        fld-383    
> 062017        fld-384    
> 062017        fld-385    
> 062017        fld-386    
> 062017        fld-387    
> 062017        fld-388    
> 062017        fld-389    
> 062017        fld-390    
> 062017        fld-391    
> 062017        fld-392    
> 062017        fld-393    
> 062017        fld-394    
> 062017        fld-395    
> 062017        fld-396    
> 062017        fld-397    
> 062017        fld-398    
> 062017        fld-399    
> 062017        fld-400
> 062017     end-unstring
> 062017
> 062017     perform varying v1 from +1 by +1 until v1 > +400
> 062017        display ' fld' v1 ' ' ws-variable-value (v1)
> 062017     end-perform
> 
> 062017     move cm-cert-eff-dt         to dc-bin-date-1
> 062017     move ' '                    to dc-option-code
> 062017     perform 8510-date-conversion
> 062017                                 thru 8590-exit
> 062017     if no-conversion-error
> 062017        move dc-greg-date-1-edit to ws-dis-eff-dt
> 062017     else
> 062017        move '  /  /  '          to ws-dis-eff-dt
> 062017     end-if
> 062017     move cm-cert-eff-dt         to dc-bin-date-1
> 062017     move ws-cc-bin-dt           to dc-bin-date-2
> 062017     move '1'                    to dc-option-code
> 062017     perform 8510-date-conversion
> 062017                                 thru 8590-exit
> 062017
> 062017     if cm-state = ws-state-abbr (i1)
> 062017        continue
> 062017     else
> 062017        perform varying i1 from +1 by +1 until
> 062017           (i1 > +70)
> 062017           or (ws-state-abbr (i1) = cm-state)
> 062017           or (ws-state-abbr (i1) = spaces)
> 062017        end-perform
> 062017        if (i1 > +70)
> 062017           or (ws-state-ref-int-rate (i1) = zeros)
> 062017           or (ws-state-abbr (i1) = spaces)
> 062017           DISPLAY ' REF BYPASSED, NO INTEREST '
> 062017              cm-STATE ' ' cm-ACCOUNT ' ' cm-CERT-NO
> 062017           GO TO 1100-exit
> 062017        end-if
> 062017     end-if
> 062017
> 062017***  Before we compute the ws-ref-amt we need to see what the
> 062017***  original premium was, may have to calc it based on that.
> 062017
> 062017     move cm-lf-premium-amt      to ws-lf-orig-prm-amt
> 062017     move cm-lf-alt-premium-amt  to ws-lf-orig-alt-prm-amt
> 062017     move cm-ah-premium-amt      to ws-ah-orig-prm-amt
> 062017
> 062017     move cm-control-primary     to en-control-primary
> 062017     move 'I'                    to en-rec-type
> 062017     move +0                     to en-seq-no
> 062017     start ERENDT key >= en-control-primary
> 
> 062017     if erendt-file-status <> '00'
> 062017        go to 1100-continue
> 062017     end-if
> 
> 062017     move ' '                    to ws-done-sw-endt
> 062017     perform until i-am-done
> 062017        read ERENDT next record
> 062017        display ' after erendt read ' erendt-file-status ' '
> 062017           cm-cert-no
> 062017        if (erendt-file-status = '00')
> 062017           and (cm-control-primary = en-control-primary(1:33))
> 062017           and (en-rec-type = 'I')
> 
> 062017           move en-lf-orig-prm-amt  to ws-lf-orig-prm-amt
> 062017           move en-lf-orig-alt-prm-amt
> 062017                                    to ws-lf-orig-alt-prm-amt
> 062017           move en-ah-orig-prm-amt  to ws-ah-orig-prm-amt
> 062017        else
> 062017           set i-am-done to true
> 062017        end-if
> 062017     end-perform
> 062017
> 062017     .
> 062017 1100-continue.
> 062017
> 062017     compute ws-ref-amt =
> 062017        ws-lf-orig-prm-amt + ws-lf-orig-alt-prm-amt +
> 062017        ws-ah-orig-prm-amt
> 062017
> 062017     COMPUTE WS-INT-AMT ROUNDED = (WS-REF-AMT * 
> 062017           ((1 + ws-state-ref-int-rate (i1)) **
> 062017              (dc-elapsed-days / 365) - 1))
> 062017
> 062017     IF WS-INT-AMT = ZEROS
> 062017        DISPLAY ' REF BYPASSED, ZERO INTEREST '
> 062017           cm-STATE ' ' cm-ACCOUNT ' ' cm-CERT-NO
> 062017        GO TO 1100-exit
> 062017     END-IF
> 062017
> 062017     move ws-int-amt             to ws-dis-int-amt
> 062017
> 062017     move +1                     to cntr
> 062017     perform varying b1 from +1 by +1 until
> 062017        (b1 > +4350)
> 062017        or (cntr = +230)
> 062017        if ext-letter-variables (b1:1) = '~'
> 062017           add +1 to cntr
> 062017        end-if
> 062017     end-perform
> 062017
> 062017     if cntr = +230
> 062017        move ws-dis-int-amt      to ext-letter-variables (b1:10)
> 062017     else
> 062017        display ' failed to update interest amount '
> 062017     end-if
> 062017
> 062017     .
> 062017 1100-exit.
> 062017     exit.
> 

</pre>
<h3><a name="cilgcrltrs">cilgcrltrs</a><br><a href="#topper">Back to Top</a><br><pre>

8a9,12
> setenv cdte `date +%m%d`
> #setenv cdte "0129"
> echo " cdte = " $cdte
> 
15c19
< LABEL name=BACKUP1 
---
> LABEL name=BACKUP
17,18d20
< ASSGNDD ddname='SYSUT1' type='VS' filename='ERARCH' disp='i-o' 
< ASSGNDD ddname='SYSUT2' filename='$SEQFILES/CI.TEMP.ERARCH.BACKUP' disp='o' normal='k' abend='d' recfmt='F' recsize='250' 
20c22,29
<  REPRO IFILE(SYSUT1) OFILE(SYSUT2)
---
> unikixbld -t s -d ERPNDB -s $SEQFILES/$JOBNAME/erpndb.bkp
> unikixbld -t s -d ERARCH -s $SEQFILES/$JOBNAME/erarch.bkp
> unikixbld -t s -d ERARCT -s $SEQFILES/$JOBNAME/erarct.bkp
> unikixbld -t s -d NSASEXTR -s $SEQFILES/$JOBNAME/nsasextr.bkp
> unikixbld -t s -d ELCNTL -s $SEQFILES/$JOBNAME/elcntl.bkp
> unikixbld -t s -d ELCERT -s $SEQFILES/$JOBNAME/elcert.bkp
> unikixbld -t s -d ERCNOT -s $SEQFILES/$JOBNAME/ercnot.bkp
> unikixbld -t s -d ELCRTO -s $SEQFILES/$JOBNAME/elcrto.bkp
21a31
> EXECPGM pgmname='BPXBATCH' stepname='BACKUP' parm='SH'
23,26d32
< EXECPGM pgmname='IDCAMS' stepname='BACKUP1' 
< 
< ################################################################################
< LABEL name=BKPCRTO
28,42c34
< ASSGNDD ddname='SYSIN' type='INSTREAM'  << !
< unikixbld -t s -d ELCRTO -s $SEQFILES/$JOBNAME.elcrto.bkporig
< !
< EXECPGM pgmname='BPXBATCH' stepname='BKPCRTO' parm='SH'
< 
< ################################################################################
< LABEL name=BKPCERT
< ################################################################################
< ASSGNDD ddname='SYSIN' type='INSTREAM'  << !
< unikixbld -t s -d ELCERT -s $SEQFILES/$JOBNAME.elcert.bkpcert
< !
< EXECPGM pgmname='BPXBATCH' stepname='BKPCERT' parm='SH'
< 
< ################################################################################
< LABEL name=BKPCNOT
---
> LABEL name=BACKUP1 
43a36,37
> ASSGNDD ddname='SYSUT1' type='VS' filename='ERARCH' disp='i-o' 
> ASSGNDD ddname='SYSUT2' filename='$SEQFILES/CI.TEMP.ERARCH.BACKUP' disp='o' normal='k' abend='d' recfmt='F' recsize='250' 
45c39
< unikixbld -t s -d ERCNOT -s $SEQFILES/$JOBNAME.ercnot.bkpcnot
---
>  REPRO IFILE(SYSUT1) OFILE(SYSUT2)
47d40
< EXECPGM pgmname='BPXBATCH' stepname='BKPCNOT' parm='SH'
49,55c42
< ################################################################################
< LABEL name=BKPPNDB
< ################################################################################
< ASSGNDD ddname='SYSIN' type='INSTREAM'  << !
< unikixbld -t s -d ERPNDB -s $SEQFILES/$JOBNAME.erpndb.bkppend
< !
< EXECPGM pgmname='BPXBATCH' stepname='BKPPNDB' parm='SH'
---
> EXECPGM pgmname='IDCAMS' stepname='BACKUP1' 
58c45
< LABEL name=ELDAT10 
---
> LABEL name=EL300A
64c51
< ASSGNDD ddname='SYS019' dataset='CI.DD.LG.CIDNSAFA.DATECARD' filename='\${SEQFILES}/CI.DD.LG.CIDNSAFA.DATECARD' disp='o' normal='k' abend='k' recfmt='F' recsize='100' 
---
> ASSGNDD ddname='SYS019' filename='$SEQFILES/CI.DD.LG.CIDNSAFA.DATECARD' disp='o' normal='k' abend='k' recfmt='F' recsize='100' 
71c58
< EXECPGM pgmname='EL300' stepname='ELDAT10' 
---
> EXECPGM pgmname='EL300' stepname='EL300A' 
82,83c69,70
< ASSGNDD ddname='SYS012' filename='\${SEQFILES}/CI.ELCRTO.RPT.UPDATE' disp='o' normal='k' abend='d' recsize='133' recfmt='f' 
< ASSGNDD ddname='SYS019' filename='\${SEQFILES}/CI.DD.LG.CIDNSAFA.DATECARD' disp='i-o' normal='k' abend='k'
---
> ASSGNDD ddname='SYS012' filename='$SEQFILES/CI.ELCRTO.RPT.UPDATE' disp='o' normal='k' abend='d' recsize='133' recfmt='f' 
> ASSGNDD ddname='SYS019' filename='$SEQFILES/CI.DD.LG.CIDNSAFA.DATECARD' disp='i-o' normal='k' abend='k'
103c90
< LABEL name=CIDNSASX
---
> LABEL name=NSASXA
112c99
< EXECPGM pgmname='CIDNSASX' stepname='CIDNSASX' parm='@CCYYYYMMDD'
---
> EXECPGM pgmname='CIDNSASX' stepname='NSASXA' parm='@CCYYYYMMDD'
122,124c109,111
< ASSGNDD ddname='SYS011' filename='\${SEQFILES}/CI.DL.FINALACT.CANCELS' disp='o' normal='k' abend='d' recsize='80' recfmt='F' 
< ASSGNDD ddname='SYS012' filename='\${SEQFILES}/CI.DL.FINALACT.REPORT' disp='o' normal='k' abend='d' recsize='133' recfmt='F' 
< ASSGNDD ddname='SYS019' filename='\${SEQFILES}/CI.DD.LG.CIDNSAFA.DATECARD' disp='i-o' normal='k' abend='k'
---
> ASSGNDD ddname='SYS011' filename='$SEQFILES/CI.DL.FINALACT.CANCELS' disp='o' normal='k' abend='d' recsize='80' recfmt='F' 
> ASSGNDD ddname='SYS012' filename='$SEQFILES/CI.DL.FINALACT.REPORT' disp='o' normal='k' abend='d' recsize='133' recfmt='F' 
> ASSGNDD ddname='SYS019' filename='$SEQFILES/CI.DD.LG.CIDNSAFA.DATECARD' disp='i-o' normal='k' abend='k'
136,139c123,126
< ASSGNDD  ddname='SYS008' type='SYSOUT' class='A' 
< ASSGNDD ddname='SYS010' filename='\${SEQFILES}/CI.DL.FINALACT.CANCELS' disp='i-o' 
< ASSGNDD ddname='SYS011' filename='\${SEQFILES}/CI.DD.FINALACT.EL512' disp='o' normal='k' abend='d' recfmt='F' recsize='585' 
< ASSGNDD ddname='SYS019' filename='\${SEQFILES}/CI.DD.LG.CIDNSAFA.DATECARD' disp='i-o' 
---
> ASSGNDD ddname='SYS008' type='SYSOUT' class='A' 
> ASSGNDD ddname='SYS010' filename='$SEQFILES/CI.DL.FINALACT.CANCELS' disp='i-o' 
> ASSGNDD ddname='SYS011' filename='$SEQFILES/CI.DD.FINALACT.EL512' disp='o' normal='k' abend='d' recfmt='F' recsize='585' 
> ASSGNDD ddname='SYS019' filename='$SEQFILES/CI.DD.LG.CIDNSAFA.DATECARD' disp='i-o' 
204a192,261
> LABEL name=EL300B
> ################################################################################
> 
> ASSGNDD ddname='SYSOUT' type='SYSOUT' class='J' 
> ASSGNDD ddname='SYSLOG' type='SYSOUT' class='J' 
> ASSGNDD ddname='SYSLST' type='SYSOUT' class='J' 
> ASSGNDD ddname='ELCNTL' type='VS' filename='ELCNTL' disp='i-o' 
> ASSGNDD ddname='ELPGMN' type='VS' filename='ELPGMN' disp='i-o' 
> ASSGNDD ddname='ELPGMS' type='VS' filename='ELPGMS' disp='i-o' 
> ASSGNDD ddname='ELPGMO' type='VS' filename='ELPGMO' disp='i-o' 
> ASSGNDD ddname='SYS008' type='SYSOUT' class='A' 
> ASSGNDD ddname='SYS019' filename='$SEQFILES/CI.DD.ER.DATECARD.EL570' disp='o' normal='k' abend='d' recsize='100' recfmt='F' 
> ASSGNDD ddname='SYS006' type='INSTREAM'  << !
> COLCCID1
> CLAS@CCMMDDYY
> !
> 
> EXECPGM pgmname='EL300' stepname='EL300B'
> 
> ################################################################################
> LABEL name=EL570
> ################################################################################
> #LIBDEF scope='STEP' type='PGM' lib='/apps/prod/cid1p/src/batch'
> ASSGNDD ddname='ELREPT' type='VS' filename='ELREPT' disp='i-o' 
> ASSGNDD ddname='ERPNDB' type='VS' filename='ERPNDB' disp='i-o' 
> ASSGNDD ddname='ERMAIL' type='VS' filename='ERMAIL' disp='i-o' 
> ASSGNDD ddname='ERACCT' type='VS' filename='ERACCT' disp='i-o' 
> ASSGNDD ddname='ERARCH' type='VS' filename='ERARCH' disp='i-o' 
> ASSGNDD ddname='ELCERT' type='VS' filename='ELCERT' disp='i-o' 
> ASSGNDD ddname='ELCNTL' type='VS' filename='ELCNTL' disp='i-o' 
> ASSGNDD ddname='ERCNOT' type='VS' filename='ERCNOT' disp='i-o' 
> ASSGNDD ddname='ELLETR' type='VS' filename='ELLETR' disp='i-o' 
> ASSGNDD ddname='ELENCC' type='VS' filename='ELENCC' disp='i-o' 
> ASSGNDD ddname='NSASEXTR' type='VS' filename='NSASEXTR' disp='i-o' 
> ASSGNDD ddname='SYS019' filename='$SEQFILES/CI.DD.ER.DATECARD.EL570' disp='i-o' 
> ASSGNDD ddname='SYS020' filename='$SEQFILES/CI.EX.FICH570' disp='o' normal='k' abend='d' recfmt='F' recsize='133' 
> ASSGNDD ddname='SYS008' type='DUMMY' 
> ASSGNDD ddname='SYS021' filename='$SEQFILES/$cdte\_refund.freedom' disp='o' normal='k' abend='d' recfmt='F' recsize='400' 
> ASSGNDD ddname='SYSIN' type='DUMMY' 
> 
> EXECPGM pgmname='EL570' stepname='EL570' 
> 
> ################################################################################
> LABEL name=CPY570
> ################################################################################
> ASSGNDD ddname='SYS010' filename='$SEQFILES/CI.EX.FICH570' disp='i-o'
> ASSGNDD ddname='SYS011' filename='$SEQFILES/CI.DL.CIADM.FICH570' disp='o' normal='k' abend='d' recfmt='F' recsize='132' 
> 
> EXECPGM pgmname='CIB009L' stepname='CPY570' parm='ALL'
> 
> if ($JOBSTATUS == 0) then
>    rm -f $JCLLIB/ftp-cilg570-tmp
>    sed 's/\$cdte/$cdte/' < $JCLLIB/ftp-cilg570 > $JCLLIB/ftp-cilg570-tmp
> else
>         echo " Job aborted, nothing to do "
> endif
> 
> ################################################################################
> LABEL name=NSASXB
> ################################################################################
> ASSGNDD ddname='ERARCH' type='VS' filename='ERARCH' disp='i-o'
> ASSGNDD ddname='NSASEXTR' type='VS' filename='NSASEXTR' disp='i-o'
> ASSGNDD ddname='SYS011' filename='$SEQFILES/NSASEXTR_CPS.TXT' disp='a' normal='k' abend='d' recsize='4500' recfmt='F'
> ASSGNDD ddname='SYS012' filename='$SEQFILES/NSASEXTR_VADISC_CPS.TXT' disp='a' normal='k' abend='d' recsize='4500' recfmt='F'
> ASSGNDD ddname='STOPQWS' type='DUMMY'
> ASSGNDD ddname='SYS019' filename='$SEQFILES/CI.DD.LG.CIDNSAFA.DATECARD' disp='i-o' normal='k' abend='k'
> 
> EXECPGM pgmname='CIDNSASX' stepname='NSASXB' parm='@CCYYYYMMDD'
> 
> ################################################################################
249c306
< # This step reads the file from above and creates a pdf file
---
> # This step reads the files from above and creates pdf files
253,263d309
< !
< EXECPGM pgmname='BPXBATCH' stepname='PERL1' parm='SH'
< 
< ################################################################################
< ################################################################################
< LABEL name=PERL2
< ################################################################################
< #
< # This step reads a file from above and creates a pdf file
< #
< ASSGNDD ddname='SYSIN' type='INSTREAM'  << !
265,275d310
< !
< EXECPGM pgmname='BPXBATCH' stepname='PERL2' parm='SH'
< 
< ################################################################################
< ################################################################################
< LABEL name=PERL3
< ################################################################################
< #
< # This step reads a file from above and creates a pdf file
< #
< ASSGNDD ddname='SYSIN' type='INSTREAM'  << !
277,287d311
< !
< EXECPGM pgmname='BPXBATCH' stepname='PERL3' parm='SH'
< 
< ################################################################################
< ################################################################################
< LABEL name=PERL4
< ################################################################################
< #
< # This step reads a file from above and creates a pdf file
< #
< ASSGNDD ddname='SYSIN' type='INSTREAM'  << !
289,299d312
< !
< EXECPGM pgmname='BPXBATCH' stepname='PERL4' parm='SH'
< 
< ################################################################################
< ################################################################################
< LABEL name=PERL5
< ################################################################################
< #
< # This step reads a file from above and creates a pdf file
< #
< ASSGNDD ddname='SYSIN' type='INSTREAM'  << !
301,311d313
< !
< EXECPGM pgmname='BPXBATCH' stepname='PERL5' parm='SH'
< 
< ################################################################################
< ################################################################################
< LABEL name=PERL6
< ################################################################################
< #
< # This step reads a file from above and creates a pdf file
< #
< ASSGNDD ddname='SYSIN' type='INSTREAM'  << !
313,323d314
< !
< EXECPGM pgmname='BPXBATCH' stepname='PERL6' parm='SH'
< 
< ################################################################################
< ################################################################################
< LABEL name=PERL7
< ################################################################################
< #
< # This step reads a file from above and creates a pdf file
< #
< ASSGNDD ddname='SYSIN' type='INSTREAM'  << !
326,328c317
< EXECPGM pgmname='BPXBATCH' stepname='PERL7' parm='SH'
< 
< 
---
> EXECPGM pgmname='BPXBATCH' stepname='PERL1' parm='SH'
330a320
> 
333a324,325
>    ftp -n ntcso1 < $JCLLIB/ftp-cilg570-tmp
> 
341a334
> 
348a342,343
>    "mutt -s 'REF INT RPT READY' -i $SEQFILES/CI.DL.CIADM.FICH570 -e 'my_hdr FROM:pema@cso.com' dcpscid570@cso.com < /dev/null"
> 

</pre>
<h3><a name="DCC010.cbl">DCC010.cbl</a><br><a href="#topper">Back to Top</a><br><pre>

91a92
> 062017* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTEREST
2118c2119
< 01714                CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
---
> 062017               CR-LFPRM-CALC-ALT       CR-INT-ON-REF
3105,3106c3106,3107
< 02423      IF CR-NH-INT-ON-REF NOT NUMERIC                           
< 02424          MOVE ZEROS                 TO CR-NH-INT-ON-REF
---
> 062017     IF CR-INT-ON-REF NOT NUMERIC                           
> 062017         MOVE ZEROS                 TO CR-INT-ON-REF
3760,3762c3761,3763
< 02911      IF PB-C-NH-INT-ON-REFS NUMERIC
< 02912         AND PB-C-NH-INT-ON-REFS NOT = ZEROS                             
< 02913         MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
---
> 062017     IF PB-C-INT-ON-REFS NUMERIC
> 062017        AND PB-C-INT-ON-REFS NOT = ZEROS                             
> 062017        MOVE PB-C-INT-ON-REFS  TO CR-INT-ON-REF
4283c4284
< 03289          MOVE ZEROS             TO CR-NH-INT-ON-REF
---
> 062017         MOVE ZEROS             TO CR-INT-ON-REF

</pre>
<h3><a name="ECS010.cbl">ECS010.cbl</a><br><a href="#topper">Back to Top</a><br><pre>

91a92
> 062017* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTEREST
2109c2110
< 01714                CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
---
> 062017               CR-LFPRM-CALC-ALT       CR-INT-ON-REF
3103,3104c3104,3105
< 02423      IF CR-NH-INT-ON-REF NOT NUMERIC                           
< 02424          MOVE ZEROS                 TO CR-NH-INT-ON-REF
---
> 062017     IF CR-INT-ON-REF NOT NUMERIC                           
> 062017         MOVE ZEROS                 TO CR-INT-ON-REF
3749,3751c3750,3752
< 02911      IF PB-C-NH-INT-ON-REFS NUMERIC
< 02912         AND PB-C-NH-INT-ON-REFS NOT = ZEROS                             
< 02913         MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
---
> 062017     IF PB-C-INT-ON-REFS NUMERIC
> 062017        AND PB-C-INT-ON-REFS NOT = ZEROS                             
> 062017        MOVE PB-C-INT-ON-REFS    TO CR-INT-ON-REF
4256c4257
< 03289          MOVE ZEROS             TO CR-NH-INT-ON-REF
---
> 062017         MOVE ZEROS             TO CR-INT-ON-REF

</pre>
<h3><a name="ECSCRT01">ECSCRT01</a><br><a href="#topper">Back to Top</a><br><pre>

35a36
> 062017* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
276c277
< 00235              88  CR-AH-IS-VOID                VALUE 'V'.          
---
> 00235              88  CR-AH-IS-VOID                VALUE 'V'.
370c371
< 00314      12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
---
> 062017     12  CR-INT-ON-REF                     PIC S9(7)V99   COMP-3.

</pre>
<h3><a name="EL1273.cl2">EL1273.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

87a88
> 062017* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTEREST
874,876c875,877
< 072308     IF CM-NH-INT-ON-REFS NUMERIC
< 072308        IF CM-NH-INT-ON-REFS NOT = ZEROS
< 072308           MOVE CM-NH-INT-ON-REFS TO CNHINTO
---
> 062017     IF CM-INT-ON-REFS NUMERIC
> 062017        IF CM-INT-ON-REFS NOT = ZEROS
> 062017           MOVE CM-INT-ON-REFS TO CNHINTO

</pre>
<h3><a name="EL1273S.bms">EL1273S.bms</a><br><a href="#topper">Back to Top</a><br><pre>

19a20
> * 062017  CR2015091000001   PEMA  INTEREST ON REFUNDS
173c174
<                INITIAL='NH REF INT  :'
---
>                INITIAL='INT ON REF  :'
176c177
<                PICOUT='999999.99'
---
>                PICOUT='ZZZZZ9.99'

</pre>
<h3><a name="EL331.cbl">EL331.cbl</a><br><a href="#topper">Back to Top</a><br><pre>

73a74
> 062017* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTEREST
1736,1737c1737,1738
< 01545      IF CM-NH-INT-ON-REFS NOT NUMERIC                           
< 01546          MOVE ZEROS               TO CM-NH-INT-ON-REFS.         
---
> 062017     IF CM-INT-ON-REFS NOT NUMERIC                           
> 062017         MOVE ZEROS               TO CM-INT-ON-REFS.         
2512,2513c2513,2514
< 02269      IF CR-NH-INT-ON-REF     NUMERIC                              
< 02270          MOVE CR-NH-INT-ON-REF    TO CM-NH-INT-ON-REFS          
---
> 062017     IF CR-INT-ON-REF     NUMERIC                              
> 062017         MOVE CR-INT-ON-REF      TO CM-INT-ON-REFS          
2515c2516
< 02272          MOVE ZEROS               TO CM-NH-INT-ON-REFS.         
---
> 062017         MOVE ZEROS               TO CM-INT-ON-REFS.         

</pre>
<h3><a name="EL512.cbl">EL512.cbl</a><br><a href="#topper">Back to Top</a><br><pre>

52a53
> 062017* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTEREST
2664c2665
< 02558                                     PB-C-NH-INT-ON-REFS.
---
> 062017                                    PB-C-INT-ON-REFS.

</pre>
<h3><a name="EL570.cbl">EL570.cbl</a><br><a href="#topper">Back to Top</a><br><pre>

0a1
>       $SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
18c19
<       *    THEN FLAGS THE ERPNDB RECORD.
---
>       *    THEN FLAGS THE ERPNDB RECORD. Added TN to the mix.
44a46
> 062017* 062017 CR2015091000001   PEMA  ADD TN INTEREST PROCESSING
66c68
<            SELECT ERPNDB          ASSIGN TO ERPNDB
---
> 062017     SELECT ERPNDB          ASSIGN TO ERPNDB2
69c71
<                                   RECORD KEY IS PB-CONTROL-PRIMARY
---
> 062017                            RECORD KEY IS PB-CONTROL-by-account
121a124,129
> 062017     SELECT ERENDT           ASSIGN TO ERENDT
> 062017                             ACCESS IS DYNAMIC
> 062017                             ORGANIZATION IS INDEXED
> 062017                             FILE STATUS IS ERENDT-FILE-STATUS
> 062017                             RECORD KEY IS EN-CONTROL-PRIMARY.
> 
167a176,178
> 062017 FD  ERENDT.
> 062017                                 COPY ERCENDT.
> 
177a189
> 062017 77  ERENDT-FILE-STATUS          PIC XX  VALUE LOW-VALUES.
179a192,193
> 062017 77  ELCERT-FIND-SW              PIC X   VALUE LOW-VALUES.
> 062017     88  ELCERT-FOUND               VALUE 'Y'.
192a207
> 062017 77  i1                          pic s999 comp-3 value +0.
196a212
> 062017 77  ws-int-rate                 pic s99v9    comp-3 value +0.
209a226,286
> 062017 77  ws-connect-sw               pic x  value spaces.
> 062017     88  connected-to-db            value 'Y'.
> 062017 77  ws-sql-code                 pic s9(7) value zeros.
> 062017 77  ws-dis-sql-code             pic -9999999 value zeros.
> 
> 062017 EXEC SQL
> 062017    INCLUDE SQLDA
> 062017 END-EXEC
> 062017
> 062017 EXEC SQL
> 062017    INCLUDE SQLCA
> 062017 END-EXEC
> 
> 062017 01  P pointer.
> 062017 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
> 062017 01  var-ptr pointer.
> 062017 01  env-var-len                 pic 9(4)  binary.
> 062017 01  rc                          pic 9(9)  binary.
> 062017
> 062017 01  WS-KIXSYS.
> 062017     05  WS-KIX-FIL1             PIC X(10).
> 062017     05  WS-KIX-APPS             PIC X(10).
> 062017     05  WS-KIX-ENV              PIC X(10).
> 062017     05  WS-KIX-MYENV            PIC X(10).
> 062017     05  WS-KIX-SYS              PIC X(10).
> 062017
> 062017 EXEC SQL
> 062017    BEGIN DECLARE SECTION
> 062017 END-EXEC
> 062017
> 062017 01  sqlcmd                      pic x(1024).
> 062017 01  WS-MOE-DATE                 pic x(10).
> 062017 01  svr                         pic x(32).
> 062017 01  usr                         pic x(32).
> 062017 01  pass                        pic x(32).
> 062017 01  usr-pass                    pic x(64).
> 062017 01  ws-disp-code                pic s9(11).
> 
> 062017 01  NS-EL513-TABLE-RECORD.
> 062017     05  TB-MOE-DATE             PIC X(10).
> 062017     05  TB-CARRIER              PIC X.               
> 062017     05  TB-GROUPING             PIC X(6).            
> 062017     05  TB-STATE                PIC XX.              
> 062017     05  TB-ACCOUNT              PIC X(10).           
> 062017     05  TB-CERT-EFF-DT          PIC X(10).
> 062017     05  TB-CERT-NO              PIC X(11).
> 062017     05  TB-BATCH-NO             PIC X(6).
> 062017     05  tb-insured-name         pic x(15).
> 062017     05  tb-lf-cancel-date       pic x(10).
> 062017     05  tb-lf-cancel-amt        pic 9(7).99.
> 062017     05  tb-lf-cancel-amt-a redefines
> 062017         tb-lf-cancel-amt        pic x(10).
> 062017     05  tb-ah-cancel-date       pic x(10).
> 062017     05  tb-ah-cancel-amt        pic 9(7).99.
> 062017     05  tb-ah-cancel-amt-a redefines
> 062017         tb-ah-cancel-amt        pic x(10).
> 062017
> 062017 EXEC SQL
> 062017    END DECLARE SECTION
> 062017 END-EXEC
> 
261a339,343
> 062017     05  ws-sv-bene-addr1            pic x(30).
> 062017     05  ws-sv-bene-addr2            pic x(30).
> 062017     05  ws-sv-bene-city             pic x(30).
> 062017     05  ws-sv-bene-state            pic xx.
> 062017     05  ws-sv-bene-zip              pic x(10).
272c354,376
<        01  FILLER.                                                      
---
> 062017 01  filler.
> 062017     05  ws-lf-orig-prm-amt      pic s9(7)v99 comp-3 value +0.
> 062017     05  ws-lf-orig-alt-prm-amt  pic s9(7)v99 comp-3 value +0.
> 062017     05  ws-ah-orig-prm-amt      pic s9(7)v99 comp-3 value +0.
> 062017     05  ws-done-sw-endt         pic x value ' '.
> 062017         88  i-am-done             value 'Y'.
> 062017     05  ws-prev-state-key.
> 062017         10  ws-psk-carr         pic x.
> 062017         10  ws-psk-group        pic x(6).
> 062017         10  ws-psk-state        pic xx.
> 062017     05  ws-curr-state-key.
> 062017         10  ws-csk-carr         pic x.
> 062017         10  ws-csk-group        pic x(6).
> 062017         10  ws-csk-state        pic xx.
> 062017     05  ws-state-int-table occurs 70.
> 062017         10  ws-state-abbr           pic xx.
> 062017         10  ws-state-ref-int-rate   pic s9v9(4) comp-3 value +0.
> 062017
> 062017 01  FILLER.
> 062017     05  ws-temp-note                pic x(90)     value spaces.
> 062017     05  ws-display-ref-amt          pic $$$$$.99  value zeros.
> 062017     05  ws-display-int-amt          pic $$$$.99   value zeros.
> 062017     05  ws-display-int-rate         pic zz.9      value zeros.
293c397
<                                                                         
---
> 
335c439,455
<                                                                         
---
> 
> 062017     05  FILLER                      COMP-3.                      
> 062017         10  ST-CURR-LF-PMTS-AMT           PIC S9(9)V99  VALUE +0.
> 062017         10  ST-CURR-LF-PMTS-CNT           PIC S9(7)     VALUE +0.
> 062017                                                                  
> 062017         10  ST-CURR-AH-PMTS-AMT           PIC S9(9)V99  VALUE +0.
> 062017         10  ST-CURR-AH-PMTS-CNT           PIC S9(7)     VALUE +0.
> 062017
> 062017         10  ST-CURR-TOT-PMTS-AMT          PIC S9(9)V99  VALUE +0.
> 062017         10  ST-CURR-TOT-PMTS-CNT          PIC S9(7)     VALUE +0.
> 062017
> 062017         10  ST-CURR-LF-PMTS-AMT-BM        PIC S9(9)V99  VALUE +0.
> 062017         10  ST-CURR-LF-PMTS-CNT-BM        PIC S9(7)     VALUE +0.
> 062017
> 062017         10  ST-CURR-LF-PMTS-AMT-DR        PIC S9(9)V99  VALUE +0.
> 062017         10  ST-CURR-LF-PMTS-CNT-DR        PIC S9(7)     VALUE +0.
> 
369c489
<            05  FILLER                      PIC X(26)      VALUE SPACES.
---
> 062017     05  FILLER                      PIC X(60)      VALUE SPACES.
510a631,643
> 062017     EXEC SQL
> 062017        DISCONNECT
> 062017     END-EXEC
> 062017
> 062017     if sqlcode not = 0
> 062017        display "Error: disconnect "
> 062017        display ' sql return code ' sqlcode
> 062017        display ' sql err mess    ' sqlerrmc
> 062017     end-if
> 062017
> 062017     perform 0500-state-totals   thru 0500-exit
> 062017
> 062017     move +1                     to WS-REPORT-SW
519c652
<            OPEN INPUT ELCERT ERMAIL ERACCT
---
> 062017     OPEN INPUT ELCERT ERMAIL ERACCT ERENDT
577a711,715
> 062017     IF ERENDT-FILE-STATUS NOT = '00' AND '97'
> 062017        DISPLAY ' ERROR - ERENDT - OPEN ' ERENDT-FILE-STATUS
> 062017        PERFORM ABEND-PGM
> 062017     END-IF
> 
627a766,770
> 062017     perform varying i1 from +1 by +1 until i1 > +70
> 062017        move spaces              to ws-state-abbr (i1)
> 062017        move zeros               to ws-state-ref-int-rate (i1)
> 062017     end-perform
> 
717a861,862
> 062017     perform 0230-build-ref-int-table
> 062017                                 thru 0230-exit
728c873
<            IF (PB-STATE = 'NH')
---
> 062017     IF (PB-STATE = 'NH' or 'TN')
754c899
<               OR (PB-COMPANY-CD NOT = DTE-CLASIC-COMPANY-CD)
---
> 062017        OR (PB-COMPANY-CD-a1 NOT = DTE-CLASIC-COMPANY-CD)
770c915
<            MOVE DTE-CLASIC-COMPANY-CD  TO PB-CONTROL-PRIMARY
---
> 062017     MOVE DTE-CLASIC-COMPANY-CD  TO PB-CONTROL-by-account
772c917
<            START ERPNDB KEY >= PB-CONTROL-PRIMARY
---
> 062017     START ERPNDB KEY >= PB-CONTROL-by-account
775c920
<               OR (PB-COMPANY-CD NOT = DTE-CLASIC-COMPANY-CD)
---
> 062017        OR (PB-COMPANY-CD-a1 NOT = DTE-CLASIC-COMPANY-CD)
789a935,947
> 062017     move pb-carrier             to ws-csk-carr
> 062017     move pb-grouping            to ws-csk-group
> 062017     move pb-state               to ws-csk-state
> 062017
> 062017     if ws-prev-state-key <> ws-curr-state-key
> 062017        perform 0500-state-totals
> 062017                                 thru 0500-exit
> 062017        move ws-curr-state-key   to ws-prev-state-key
> 062017     end-if
> 062017
> 062017*    display ' made 0100 check ref ' pb-state ' ' pb-account
> 062017*      ' ' pb-cert-no ' ' pb-entry-batch
> 
792c950
<                                           WS-LF-RATIO
---
> 062017                                    WS-LF-RATIO ws-int-rate
812,814c970,975
<                  DISPLAY ' REFUND BYPASSED, BUS TYPE '
<                     PB-STATE ' ' PB-ACCOUNT ' ' PB-CERT-NO ' ' AM-GPCD
<                  GO TO 0100-EXIT
---
> 062017           if am-state = 'NH'
> 062017              DISPLAY ' REFUND BYPASSED, BUS TYPE '
> 062017                PB-STATE ' ' PB-ACCOUNT ' ' PB-CERT-NO ' '
> 062017                  AM-GPCD
> 062017              GO TO 0100-EXIT
> 062017           end-if
823,825c984,990
<            IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
<               GO TO 0100-ERPNDB-REWRITE
<            END-IF
---
> 062017     if pb-state = 'NH'
> 062017        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
> 062017           display ' NH FLAT CANCEL, BYPASS ' pb-state ' '
> 062017              pb-account ' ' pb-cert-no ' ' pb-entry-batch
> 062017           GO TO 0100-ERPNDB-REWRITE
> 062017        END-IF
> 062017     END-IF
845a1011,1014
> 062017     if pb-state <> 'NH'
> 062017        go to 0100-calc-tn-duration
> 062017     end-if
> 
880,884c1049,1214
< 
<            COMPUTE WS-REF-AMT = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
< 
<            COMPUTE WS-INT-AMT ROUNDED = (WS-REF-AMT * 
<                  (1.10 ** (WS-DAYS / 365) - 1))
---
> 062017     go to 0100-interest-calculation
> 062017
> 062017     .
> 062017 0100-calc-tn-duration.
> 062017
> 062017     MOVE pb-cert-eff-dt         TO DC-BIN-DATE-1
> 062017     MOVE SPACES                 TO DC-OPTION-CODE
> 062017     PERFORM 8500-DATE-CONVERSION
> 062017                                 THRU 8590-EXIT
> 062017     IF NO-CONVERSION-ERROR
> 062017        MOVE DC-GREG-DATE-A-EDIT TO tb-cert-eff-dt
> 062017     ELSE
> 062017        display ' error converting eff dt ' pb-cert-no
> 062017        go to 0100-erpndb-rewrite
> 062017     END-IF
> 062017
> 062017     move pb-state               to tb-state
> 062017     move pb-account             to tb-account
> 062017     move pb-cert-no             to tb-cert-no
> 062017     move pb-entry-batch         to tb-batch-no
> 062017     move pb-c-lf-cancel-amt     to tb-lf-cancel-amt
> 062017     move pb-c-ah-cancel-amt     to tb-ah-cancel-amt
> 062017     if not connected-to-db
> 062017        perform 0400-connect     thru 0400-exit
> 062017     end-if
> 062017
> 062017*    display ' tb  state      ' tb-state
> 062017*    display ' tb account     ' tb-account
> 062017*    display ' tb cert no     ' tb-cert-no
> 062017*    display ' tb cert eff dt ' tb-cert-eff-dt
> 062017*    display ' tb batch no    ' tb-batch-no
> 062017*    display ' tb lf cancel   ' tb-lf-cancel-amt
> 062017*    display ' tb ah cancel   ' tb-ah-cancel-amt
> 062017
> 062017     exec sql
> 062017        select
> 062017           Insured_Name
> 062017        into
> 062017           :tb-insured-name
> 062017        from
> 062017           NAPERSOFT_EL513A
> 062017        where
> 062017                State         = :tb-state
> 062017            and Account       = :tb-account
> 062017            and Cert_No       = :tb-cert-no
> 062017            and Cert_Eff_Dt   = :tb-cert-eff-dt
> 062017            and Batch_No      = :tb-batch-no
> 062017            and Lf_Cancel_Amt = :tb-lf-cancel-amt-a
> 062017            and Ah_Cancel_Amt = :tb-ah-cancel-amt-a
> 062017     end-exec
> 062017
> 062017     if sqlcode not = 0 and 1
> 062017        display "Error: Did not find auto cnc rec "
> 062017        move sqlcode             to ws-sql-code
> 062017        move ws-sql-code         to ws-dis-sql-code
> 062017        display ' sqlcode ' ws-dis-sql-code
> 062017        display ' sql err mess    ' sqlerrmc
> 062017        go to 0100-erpndb-rewrite
> 062017     end-if
> 062017
> 062017*    display ' found one ' pb-state ' ' pb-cert-no ' '
> 062017*       tb-insured-name
> 062017     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
> 062017*    MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
>            MOVE BIN-RUN-DATE           TO DC-BIN-DATE-2
> 062017
> 062017     MOVE '1'                    TO DC-OPTION-CODE
> 062017     PERFORM 8500-DATE-CONVERSION
> 062017                                 THRU 8590-EXIT
> 062017     IF NO-CONVERSION-ERROR
> 062017        move dc-elapsed-days     to ws-days
> 062017     ELSE
> 062017        DISPLAY ' CURRENT AND EFFECT DATE CONVERSION ERROR '
> 062017           PB-STATE ' ' PB-ACCOUNT ' ' PB-CERT-NO
> 062017        PERFORM ABEND-PGM
> 062017     END-IF
> 062017
> 062017     .
> 062017 0100-interest-calculation.
> 
> 062017     MOVE ' '                    TO ELCERT-FIND-SW
> 062017     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
> 062017                                 TO CM-CONTROL-PRIMARY
> 062017
> 062017     READ ELCERT
> 062017     IF ELCERT-FILE-STATUS = '10' OR '23'
> 062017        DISPLAY ' ELCERT  RECORD NOT FOUND ' PB-STATE ' '
> 062017           PB-ACCOUNT ' ' PB-CERT-NO
> 062017     ELSE
> 062017        IF ELCERT-FILE-STATUS NOT = '00'
> 062017           DISPLAY ' ERROR - ELCERT - READ ' ELCERT-FILE-STATUS
> 062017           ' ' PB-STATE ' ' PB-ACCOUNT ' ' PB-CERT-NO
> 062017        else
> 062017           set elcert-found to true
> 062017        END-IF
> 062017     END-IF
> 062017
> 062017     if pb-state = ws-state-abbr (i1)
> 062017        continue
> 062017     else
> 062017        perform varying i1 from +1 by +1 until
> 062017           (i1 > +70)
> 062017           or (ws-state-abbr (i1) = pb-state)
> 062017           or (ws-state-abbr (i1) = spaces)
> 062017        end-perform
> 062017        if (i1 > +70)
> 062017           or (ws-state-ref-int-rate (i1) = zeros)
> 062017           or (ws-state-abbr (i1) = spaces)
> 062017           DISPLAY ' REF BYPASSED, NO INTEREST '
> 062017              PB-STATE ' ' PB-ACCOUNT ' ' PB-CERT-NO
> 062017           GO TO 0100-ERPNDB-REWRITE
> 062017        end-if
> 062017     end-if
> 062017
> 062017     compute ws-int-rate =
> 062017        ws-state-ref-int-rate (i1) * +100
> 062017
> 062017     move pb-c-lf-cancel-amt     to ws-lf-orig-prm-amt
> 062017     move +0                     to ws-lf-orig-alt-prm-amt
> 062017     move pb-c-ah-cancel-amt     to ws-ah-orig-prm-amt
> 062017
> 062017     if pb-state not = 'TN'
> 062017        go to 0100-continue
> 062017     end-if
> 062017
> 062017     move pb-ci-lf-premium-amt   to ws-lf-orig-prm-amt
> 062017     move pb-ci-lf-alt-premium-amt
> 062017                                 to ws-lf-orig-alt-prm-amt
> 062017     move pb-ci-ah-premium-amt   to ws-ah-orig-prm-amt
> 062017
> 062017     move pb-control-by-account  to en-control-primary
> 062017     move 'I'                    to en-rec-type
> 062017     move +0                     to en-seq-no
> 062017     start ERENDT key >= en-control-primary
> 062017     if erendt-file-status <> '00'
> 062017        go to 0100-continue
> 062017     end-if
> 062017     move ' '                    to ws-done-sw-endt
> 062017     perform until i-am-done
> 062017        read ERENDT next record
> 062017        if (erendt-file-status = '00')
> 062017           and (pb-control-by-account(1:33) =
> 062017              en-control-primary(1:33))
> 062017           and (en-rec-type = 'I')
> 062017           move en-lf-orig-prm-amt  to ws-lf-orig-prm-amt
> 062017           move en-lf-orig-alt-prm-amt
> 062017                                    to ws-lf-orig-alt-prm-amt
> 062017           move en-ah-orig-prm-amt  to ws-ah-orig-prm-amt
> 062017        else
> 062017           set i-am-done to true
> 062017        end-if
> 062017     end-perform
> 062017
> 062017     .
> 062017 0100-continue.
> 062017
> 062017     compute ws-ref-amt =
> 062017        ws-lf-orig-prm-amt + ws-lf-orig-alt-prm-amt +
> 062017        ws-ah-orig-prm-amt
> 
> 062017*    COMPUTE WS-REF-AMT =
> 062017*       PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
> 062017
> 062017     COMPUTE WS-INT-AMT ROUNDED = (WS-REF-AMT * 
> 062017           ((1 + ws-state-ref-int-rate (i1)) **
> 062017              (WS-DAYS / 365) - 1))
898d1227
< 
932a1262
> 
936c1266
<               MOVE WS-INT-AMT          TO PB-C-NH-INT-ON-REFS
---
> 062017        MOVE WS-INT-AMT          TO PB-C-INT-ON-REFS
1001,1002c1331,1337
<            MOVE PB-C-LAST-NAME         TO PR-PAYEE-NAME
<                                           VR-VENDOR-NAME (1)
---
> 062017     move pb-c-last-name         to vr-vendor-name (1)
> 062017     if pb-state = 'NH'
> 062017        MOVE PB-C-LAST-NAME      TO PR-PAYEE-NAME
> 062017     else
> 062017        move pb-ci-beneficiary-name
> 062017                                 to pr-payee-name
> 062017     end-if
1081a1417
> 062017                                    ST-CURR-LF-PMTS-CNT-DR
1082a1419
> 062017                                    ST-CURR-LF-PMTS-AMT-DR
1092a1430
> 062017                                    ST-CURR-LF-PMTS-CNT-DR
1093a1432
> 062017                                    ST-CURR-LF-PMTS-AMT-DR
1100a1440
> 062017                                    ST-CURR-LF-PMTS-CNT-BM
1101a1442
> 062017                                    ST-CURR-LF-PMTS-AMT-BM
1188a1530
> 062017                                    ST-CURR-TOT-PMTS-CNT
1189a1532
> 062017                                    ST-CURR-TOT-PMTS-AMT
1192a1536
> 062017                                    ST-CURR-LF-PMTS-CNT
1193a1538
> 062017                                    ST-CURR-LF-PMTS-AMT
1197a1543
> 062017                                    ST-CURR-AH-PMTS-CNT
1198a1545
> 062017                                    ST-CURR-AH-PMTS-AMT
1209a1557
>       *                                   ST-CURR-LF-PMTS-CNT-BM
1210a1559
>       *                                   ST-CURR-LF-PMTS-AMT-BM
1248a1598,1599
> 
> 
1249a1601,1609
> 062017     move ma-cred-bene-addr      to ws-sv-bene-addr1
> 062017     move ma-cred-bene-addr2     to ws-sv-bene-addr2
> 062017     move ma-cred-bene-city      to ws-sv-bene-city
> 062017     move ma-cred-bene-state     to ws-sv-bene-state
> 062017     move ma-cred-bene-zip       to ws-sv-bene-zip
> 
> 062017     if pb-state <> 'NH'
> 062017        go to 0150-payee-is-cred-bene
> 062017     end-if
1258,1271c1618
< 051810*    PERFORM VARYING S1 FROM +30 BY -1 UNTIL
< 051810*       (S1 < +2)
< 051810*       OR (MA-CITY-STATE (S1:1) NOT = SPACES)
< 051810*    END-PERFORM
< 051810*    IF S1 > +1
< 051810*       IF S1 < +30
< 051810*          ADD +1                TO S1
< 051810*       END-IF
< 051810*       STRING MA-CITY-STATE (1:S1) MA-ZIP DELIMITED BY SIZE
< 051810*          INTO PR-ADDRESS (3)
< 051810*       END-STRING
< 051810*    ELSE
< 051810*       MOVE MA-ZIP              TO PR-ADDRESS (3)
< 051810*    END-IF
---
> 
1274,1286c1621,1631
< 111912*        STRING MA-CITY ' ' MA-ADDR-STATE
< 111912*           DELIMITED BY '  ' INTO VR-VENDOR-ADDRESS (2)
< 111912*        END-STRING
< 111912        MOVE MA-CITY             TO VR-VENDOR-ADDRESS (2) (1:29)
< 111912        MOVE MA-ADDR-STATE       TO VR-VENDOR-ADDRESS (2) (30:2)
< 111912        MOVE MA-ZIP              TO VR-VENDOR-ADDRESS (2) (32:9)
<       *    IF PR-PAYEE-NAME = SPACES
<               STRING MA-INSURED-FIRST-NAME ' '
<                  MA-INSURED-LAST-NAME DELIMITED BY '  '
<                  INTO PR-PAYEE-NAME
<               END-STRING
<               MOVE PR-PAYEE-NAME       TO VR-VENDOR-NAME (1)
<       *    END-IF
---
> 111912     MOVE MA-CITY                TO VR-VENDOR-ADDRESS (2) (1:29)
> 111912     MOVE MA-ADDR-STATE          TO VR-VENDOR-ADDRESS (2) (30:2)
> 111912     MOVE MA-ZIP                 TO VR-VENDOR-ADDRESS (2) (32:9)
> 
>            STRING
>               MA-INSURED-FIRST-NAME ' '
>               MA-INSURED-LAST-NAME DELIMITED BY '  '
>               INTO PR-PAYEE-NAME
>            END-STRING
>            MOVE PR-PAYEE-NAME          TO VR-VENDOR-NAME (1)
> 
1291d1635
<            
1293,1309c1637,1714
<            IF (MA-INSURED-SOC-SEC-NO (4:1) = '-')
<               AND (MA-INSURED-SOC-SEC-NO (7:1) = '-')
<               DISPLAY ' SOC SEC FIX BEFORE ' MA-INSURED-SOC-SEC-NO
<               MOVE MA-INSURED-SOC-SEC-NO (5:2)
<                                        TO MA-INSURED-SOC-SEC-NO (4:2)
<               MOVE MA-INSURED-SOC-SEC-NO (8:4)
<                                        TO MA-INSURED-SOC-SEC-NO (6:4)
<               MOVE ZEROS               TO MA-INSURED-SOC-SEC-NO (10:2)
<               DISPLAY ' SOC SEC FIX AFTER ' MA-INSURED-SOC-SEC-NO
<            END-IF
<            IF MA-INSURED-SOC-SEC-NO (1:9) NOT NUMERIC
<               MOVE ZEROS               TO MA-INSURED-SOC-SEC-NO
<            END-IF
<            
<            MOVE MA-INSURED-SOC-SEC-NO (1:9)
<                                        TO AR-TAX-ID-NO
<                                           DR-SUSPENSE (1) (2:9)
---
> 062017     IF ELCERT-FOUND
>               display ' ssn ' cm-cert-no ' ' cm-soc-sec-no
> 062017        IF (CM-SOC-SEC-NO (4:1) = '-')
> 062017           AND (CM-SOC-SEC-NO (7:1) = '-')
> 062017           DISPLAY ' SOC SEC FIX BEFORE ' CM-SOC-SEC-NO
> 062017           MOVE CM-SOC-SEC-NO (5:2)
> 062017                                 TO CM-SOC-SEC-NO (4:2)
> 062017           MOVE CM-SOC-SEC-NO (8:4)
> 062017                                 TO CM-SOC-SEC-NO (6:4)
> 062017           MOVE ZEROS            TO CM-SOC-SEC-NO (10:2)
> 062017           DISPLAY ' SOC SEC FIX AFTER ' CM-SOC-SEC-NO
> 062017        END-IF
> 062017        IF CM-SOC-SEC-NO (1:9) NOT NUMERIC
> 062017           MOVE ZEROS            TO CM-SOC-SEC-NO
> 062017        END-IF
> 062017           
> 062017        MOVE CM-SOC-SEC-NO (1:9) TO AR-TAX-ID-NO
> 062017                                    DR-SUSPENSE (1) (2:9)
>       *       display ' tax id ' cm-cert-no ' ' ar-tax-id-no
> 062017     END-IF
> 
>       *    IF (MA-INSURED-SOC-SEC-NO (4:1) = '-')
>       *       AND (MA-INSURED-SOC-SEC-NO (7:1) = '-')
>       *       DISPLAY ' SOC SEC FIX BEFORE ' MA-INSURED-SOC-SEC-NO
>       *       MOVE MA-INSURED-SOC-SEC-NO (5:2)
>       *                                TO MA-INSURED-SOC-SEC-NO (4:2)
>       *       MOVE MA-INSURED-SOC-SEC-NO (8:4)
>       *                                TO MA-INSURED-SOC-SEC-NO (6:4)
>       *       MOVE ZEROS               TO MA-INSURED-SOC-SEC-NO (10:2)
>       *       DISPLAY ' SOC SEC FIX AFTER ' MA-INSURED-SOC-SEC-NO
>       *    END-IF
>       *    IF MA-INSURED-SOC-SEC-NO (1:9) NOT NUMERIC
>       *       MOVE ZEROS               TO MA-INSURED-SOC-SEC-NO
>       *    END-IF
>       *       
>       *    MOVE MA-INSURED-SOC-SEC-NO (1:9)
>       *                                TO AR-TAX-ID-NO
>       *                                   DR-SUSPENSE (1) (2:9)
> 062017     go to 0150-exit
> 
>            .
> 062017 0150-payee-is-cred-bene.
> 062017
> 062017     move ma-cred-bene-name      to pr-payee-name
> 062017     MOVE MA-cred-bene-addr      TO PR-ADDRESS (1)
> 062017     MOVE MA-cred-bene-addr2     TO PR-ADDRESS (2)
> 062017     MOVE SPACES                 TO PR-ADDRESS (3)
> 062017     STRING
> 062017        MA-cred-bene-CITY ' '
> 062017        MA-cred-bene-STATE ' '
> 062017        MA-cred-bene-zip
> 062017        DELIMITED BY '  ' INTO PR-ADDRESS (3)
> 062017     END-STRING
> 062017
> 062017     MOVE SPACES                 TO PR-ADDRESS (4)
> 062017
> 062017     IF PR-ADDRESS (2) = SPACES
> 062017        MOVE PR-ADDRESS (3)      TO PR-ADDRESS (2)
> 062017        MOVE SPACES              TO PR-ADDRESS (3)
> 062017     END-IF
> 062017
> 062017     move zeros                  to ar-tax-id-no
> 062017                                    dr-suspense (1) (2:9)
> 062017
> 062017****   Build 1099 name and address   ****
> 062017
> 062017     STRING
> 062017        MA-INSURED-FIRST-NAME ' '
> 062017        MA-INSURED-LAST-NAME DELIMITED BY '  '
> 062017        INTO VR-VENDOR-NAME (1)
> 062017     END-STRING
> 062017
> 062017     MOVE MA-ADDRESS-LINE-1      TO VR-VENDOR-ADDRESS (1)
> 062017
> 062017     MOVE SPACES                 TO VR-VENDOR-ADDRESS (2)
> 062017     MOVE MA-CITY                TO VR-VENDOR-ADDRESS (2) (1:29)
> 062017     MOVE MA-ADDR-STATE          TO VR-VENDOR-ADDRESS (2) (30:2)
> 062017     MOVE MA-ZIP                 TO VR-VENDOR-ADDRESS (2) (32:9)
1318a1724
>                                           ws-temp-note
1320,1335c1726,1769
<            IF WS-INT-AMT < 1.00
<               STRING 'NH INTEREST ON CANCELLATION LESS THAN MINIMUM '
<                  WS-CURRENT-DATE ' ' WS-ERNOTE-AMT DELIMITED BY '     '
<                  INTO WS-CERT-NOTE-LINE
<               END-STRING
<            ELSE
<               STRING WS-CURRENT-DATE
<                  ' NH INT ON RFD, THRU ' WS-DT-PLUS-15 ' AMT '
<                  WS-ERNOTE-AMT ' TO ' PR-PAYEE-NAME DELIMITED BY '     '
<                  INTO WS-CERT-NOTE-LINE
<               END-STRING
<       *       STRING 'NH INTEREST ON CANCELLATION ' WS-CURRENT-DATE ' '
<       *          WS-ERNOTE-AMT ' ' PR-PAYEE-NAME DELIMITED BY '     '
<       *          INTO WS-CERT-NOTE-LINE
<       *       END-STRING
<            END-IF
---
> 062017     move ws-ref-amt             to ws-display-ref-amt
> 062017     move ws-int-amt             to ws-display-int-amt
> 062017     move ws-int-rate            to ws-display-int-rate
> 062017
> 062017     evaluate true
> 062017        when ws-int-amt < 1.00
> 062017           STRING
> 062017              pb-state ' '
> 062017              'INTEREST ON CANCELLATION LESS THAN MINIMUM '
> 062017              WS-CURRENT-DATE ' '
> 062017              WS-ERNOTE-AMT DELIMITED BY '     '
> 062017              INTO WS-CERT-NOTE-LINE
> 062017           END-STRING
> 062017        when pb-state = 'NH'
> 062017          STRING
> 062017           WS-CURRENT-DATE ' '
> 062017           pb-state        ' '
> 062017           'INT ON RFD, THRU ' WS-DT-PLUS-15 ' AMT '
> 062017           WS-ERNOTE-AMT ' TO ' PR-PAYEE-NAME DELIMITED BY '     '
> 062017           INTO WS-CERT-NOTE-LINE
> 062017          END-STRING
> 062017        when other
> 062017           string
> 062017              'INT OF '
> 062017              ws-display-int-amt
> 062017*             ' PD TO CRED BENE CALC ON REFD OF '
> 062017              ' PD TO CR BEN CALC ON ORIG PREM OF'
> 062017              ws-display-ref-amt
> 062017              ' @ '
> 062017              ws-display-int-rate
> 062017              '%' delimited by size into ws-temp-note
> 062017           end-string
> 062017           move +1               to s1
> 062017           perform varying n1 from +1 by +1 until
> 062017              n1 > +90
> 062017              if ws-temp-note (n1:2) = '  '
> 062017                 continue
> 062017              else
> 062017                 move ws-temp-note (n1:1)
> 062017                                 to ws-cert-note-line (s1:1)
> 062017                 add +1 to s1
> 062017              end-if
> 062017           end-perform
> 062017     end-evaluate
1375a1810,1813
> 062017     if pb-state <> 'NH'
> 062017        go to 0200-exit
> 062017     end-if
> 
1489a1928,1970
> 062017 0230-build-ref-int-table.
> 062017
> 062017     MOVE DTE-CLIENT             TO CF-COMPANY-ID
> 062017     MOVE '3'                    TO CF-RECORD-TYPE
> 062017     MOVE low-values             TO CF-ACCESS-of-state
> 062017     MOVE +0                     TO CF-SEQUENCE-NO
> 062017
> 062017     start ELCNTL key >= cf-control-primary
> 062017     if elcntl-file-status not = '00'
> 062017        display 'ERROR-ELCNTL-START ' ELCNTL-FILE-STATUS
> 062017        PERFORM ABEND-PGM
> 062017     END-IF
> 062017
> 062017     read elcntl next record
> 062017     move +1                     to i1
> 062017
> 062017     perform until
> 062017        (elcntl-file-status <> '00')
> 062017        or (cf-record-type <> '3')
> 062017        if cf-st-calc-interest not numeric
> 062017           move +0               to cf-st-calc-interest
> 062017        end-if
> 062017*       if cf-st-calc-interest = zeros
> 062017*          move 0.0800           to cf-st-calc-interest
> 062017*       end-if
> 062017        if cf-st-calc-interest <> zeros
> 062017           move cf-state-abbreviation
> 062017                                 to ws-state-abbr (i1)
> 062017           move cf-st-calc-interest
> 062017                                 to ws-state-ref-int-rate (i1)
> 062017           display ' found state with int ' cf-state-code ' '
> 062017              cf-st-calc-interest
> 062017           add +1 to i1
> 062017        end-if
> 062017        read elcntl next record
> 062017     end-perform
> 062017
> 062017     display ' load of ref int table complete ' i1
> 062017
> 062017     .
> 062017 0230-EXIT.
> 062017     EXIT.
> 
1631a2113,2118
> 062017     move ws-sv-bene-addr1       to out-bene-addr1
> 062017     move ws-sv-bene-addr2       to out-bene-addr2
> 062017     move ws-sv-bene-city        to out-bene-city
> 062017     move ws-sv-bene-state       to out-bene-state
> 062017     move ws-sv-bene-zip         to out-bene-zip
> 
1640,1652c2127,2130
< 033114     READ ELCERT
< 033114     IF ELCERT-FILE-STATUS = '10' OR '23'
< 033114        DISPLAY ' ELCERT  RECORD NOT FOUND ' PB-STATE ' '
< 033114           PB-ACCOUNT ' ' PB-CERT-NO
< 033114           GO TO 0300-CONT
< 033114     ELSE
< 033114        IF ELCERT-FILE-STATUS NOT = '00'
< 033114           DISPLAY ' ERROR - ELCERT - READ ' ELCERT-FILE-STATUS
< 033114           ' ' PB-STATE ' ' PB-ACCOUNT ' ' PB-CERT-NO
< 033114           GO TO 0300-CONT
< 033114        END-IF
< 033114     END-IF
< 033114
---
> 062017     if not elcert-found
> 062017        go to 0300-cont
> 062017     end-if
> 
1972a2451,2583
> 
> 062017 0400-connect.
> 062017
> 062017***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
> 062017***                                                            ***
> 062017***  If this program is run in any other region than cid1p     ***
> 062017***  then it will populate the tabl on NTSQLTST2, otherwise    ***
> 062017***  it will populate the table on ntcso2.                     ***
> 062017***                                                            ***
> 062017***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
> 062017
> 062017     if dte-client not = 'CID'
> 062017        go to 0400-exit
> 062017     end-if
> 062017
> 062017     move 'NTSQLTST2_Logic'      to svr
> 062017     move 'sa'                   to usr
> 062017     move 'sql2008r2'            to pass
> 062017
> 062017     if ws-kix-myenv = 'cid1p'
> 062017        move 'NTCSO2_Logic'
> 062017                                 to svr
> 062017        move 'sa'                to usr
> 062017        move 'ntcso2'            to pass
> 062017     end-if
> 062017
> 062017     display 'Begin connect to DB '
> 062017     string
> 062017         usr delimited space
> 062017         "." delimited size
> 062017         pass delimited space into usr-pass
> 062017     end-string
> 062017
> 062017     display ' usr pass ' usr-pass
> 062017
> 062017     EXEC SQL
> 062017        CONNECT TO :svr USER :usr-pass
> 062017     END-EXEC
> 062017
> 062017     if sqlcode not = 0
> 062017        display "Error: cannot connect "
> 062017        display sqlcode
> 062017        display sqlerrmc
> 062017        goback
> 062017     end-if
> 062017
> 062017     set connected-to-db to true
> 062017     display " connect to DB successful "
> 062017
> 062017     .
> 062017 0400-exit.
> 062017     exit.
> 
>        0500-state-totals.
> 
>            if zeros =                     ST-CURR-LF-PMTS-AMT   
>               and                         ST-CURR-LF-PMTS-CNT   
>               and                         ST-CURR-AH-PMTS-AMT   
>               and                         ST-CURR-AH-PMTS-CNT   
>               and                         ST-CURR-TOT-PMTS-AMT  
>               and                         ST-CURR-TOT-PMTS-CNT  
>               and                         ST-CURR-LF-PMTS-AMT-BM
>               and                         ST-CURR-LF-PMTS-CNT-BM
>               and                         ST-CURR-LF-PMTS-AMT-DR
>               and                         ST-CURR-LF-PMTS-CNT-DR
>               go to 0500-exit
>            end-if
> 
>            move spaces                 to ws-total-line1
>            string
>               '0 Totals for State - '
>               ws-psk-state
>                 delimited by size into ws-total-line1
>            end-string
>            MOVE WS-TOTAL-LINE1         TO PRT
>            PERFORM WRITE-A-LINE
> 
>            MOVE WS-HEADING9            TO PRT                              
>            PERFORM WRITE-PRINTER                                    
> 
>            MOVE '0 STATE PAYMENTS INTERFACED '
>                                        TO WS-TOTAL-LINE1
>       *    MOVE SPACES                 TO WS-T1-TOTAL-DESCRIPTION
>            MOVE ST-CURR-TOT-PMTS-AMT   TO WS-T1-CURR-AMOUNT
>            MOVE ST-CURR-TOT-PMTS-CNT   TO WS-T1-CURR-COUNT
>            MOVE WS-TOTAL-LINE1         TO PRT
>            PERFORM WRITE-A-LINE
> 
>            MOVE '  STATE PAYMENTS BELOW MINIMUM '
>                                        TO WS-TOTAL-LINE1
>            MOVE ST-CURR-LF-PMTS-AMT-BM TO WS-T1-CURR-AMOUNT
>            MOVE ST-CURR-LF-PMTS-CNT-BM TO WS-T1-CURR-COUNT
>            MOVE WS-TOTAL-LINE1         TO PRT
>            PERFORM WRITE-A-LINE
> 
>            MOVE '  STATE PAYMENTS DROPPED       '
>                                        TO WS-TOTAL-LINE1
>            MOVE ST-CURR-LF-PMTS-AMT-DR TO WS-T1-CURR-AMOUNT
>            MOVE ST-CURR-LF-PMTS-CNT-DR TO WS-T1-CURR-COUNT
>            MOVE WS-TOTAL-LINE1         TO PRT
>            PERFORM WRITE-A-LINE
> 
>            MOVE '0 STATE LIFE INTEREST AMT   '
>                                        TO WS-TOTAL-LINE1
>            MOVE ST-CURR-LF-PMTS-AMT    TO WS-T1-CURR-AMOUNT
>            MOVE ST-CURR-LF-PMTS-CNT    TO WS-T1-CURR-COUNT
>            MOVE WS-TOTAL-LINE1         TO PRT
>            PERFORM WRITE-A-LINE
> 
>            MOVE '  STATE DISAB INTEREST AMT  '
>                                        TO WS-TOTAL-LINE1
>            MOVE ST-CURR-AH-PMTS-AMT    TO WS-T1-CURR-AMOUNT
>            MOVE ST-CURR-AH-PMTS-CNT    TO WS-T1-CURR-COUNT
>            MOVE WS-TOTAL-LINE1         TO PRT
>            PERFORM WRITE-A-LINE
> 
>            MOVE ZEROS                  TO ST-CURR-LF-PMTS-AMT   
>                                           ST-CURR-LF-PMTS-CNT   
>                                           ST-CURR-AH-PMTS-AMT   
>                                           ST-CURR-AH-PMTS-CNT   
>                                           ST-CURR-TOT-PMTS-AMT  
>                                           ST-CURR-TOT-PMTS-CNT  
>                                           ST-CURR-LF-PMTS-AMT-BM
>                                           ST-CURR-LF-PMTS-CNT-BM
>                                           ST-CURR-LF-PMTS-AMT-DR
>                                           ST-CURR-LF-PMTS-CNT-DR
> 
>            MOVE +99                    TO WS-LINE-COUNT
> 
>            .
>        0500-exit.
>            exit.
> 
2094c2705
<            CLOSE ERPNDB ERMAIL ELCERT
---
> 062017     CLOSE ERPNDB ERMAIL ELCERT ERENDT
2141a2753,2757
> 
> 062017     IF ERENDT-FILE-STATUS NOT = '00'
> 062017        DISPLAY ' ERROR - ERENDT - CLOSE ' ERENDT-FILE-STATUS
> 062017        PERFORM ABEND-PGM
> 062017     END-IF

</pre>
<h3><a name="EL6301.cl2">EL6301.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

52a53
> 062017* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTEREST
5301c5302
< 04578                                     PB-C-NH-INT-ON-REFS
---
> 062017                                    PB-C-INT-ON-REFS

</pre>
<h3><a name="EL6311.cl2">EL6311.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

80a81
> 062017* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTEREST
6485c6486
< 072908                                    PB-C-NH-INT-ON-REFS                       
---
> 062017                                    PB-C-INT-ON-REFS                       
12158,12160c12159,12161
< 072908     IF PB-C-NH-INT-ON-REFS NUMERIC
< 072908        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
< 072908           MOVE PB-C-NH-INT-ON-REFS
---
> 062017     IF PB-C-INT-ON-REFS NUMERIC
> 062017        IF PB-C-INT-ON-REFS NOT = ZEROS
> 062017           MOVE PB-C-INT-ON-REFS

</pre>
<h3><a name="EL6311S.bms">EL6311S.bms</a><br><a href="#topper">Back to Top</a><br><pre>

16a17
> * 062017  2015091000001  PEMA  INTEREST ON REFUNDS
331c332
<                INITIAL='NH INT ON REF :'                                
---
>                INITIAL='INT ON REFUND :'                                
334c335
<                PICOUT='999999.99',                                     -
---
>                PICOUT='ZZZZZ9.99',                                     -

</pre>
<h3><a name="EL689.cl2">EL689.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

77a78
> 062017* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTEREST
6702,6703c6703,6704
< 072908     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
< 072908        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
---
> 062017     IF PB-C-INT-ON-REFS NOT NUMERIC
> 062017        MOVE ZEROS               TO PB-C-INT-ON-REFS
6706c6707
< 072908     MOVE PB-C-NH-INT-ON-REFS    TO W-EDIT-7-2
---
> 062017     MOVE PB-C-INT-ON-REFS       TO W-EDIT-7-2
6868,6869c6869,6870
< 102408     IF CM-NH-INT-ON-REFS NOT NUMERIC
< 102408        MOVE ZEROS               TO CM-NH-INT-ON-REFS
---
> 062017     IF CM-INT-ON-REFS NOT NUMERIC
> 062017        MOVE ZEROS               TO CM-INT-ON-REFS
6872c6873
< 102408     MOVE CM-NH-INT-ON-REFS      TO W-EDIT-7-2
---
> 062017     MOVE CM-INT-ON-REFS         TO W-EDIT-7-2

</pre>
<h3><a name="EL689B.cbl">EL689B.cbl</a><br><a href="#topper">Back to Top</a><br><pre>

33a34
> 062017* 062017 CR2015091000001   PEMA  ADD TN INTEREST PROCESSING
3972,3973c3973,3974
< 072908     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
< 072908        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
---
> 062017     IF PB-C-INT-ON-REFS NOT NUMERIC
> 062017        MOVE ZEROS               TO PB-C-INT-ON-REFS
3976c3977
< 072908     MOVE PB-C-NH-INT-ON-REFS    TO W-EDIT-7-2
---
> 062017     MOVE PB-C-INT-ON-REFS       TO W-EDIT-7-2

</pre>
<h3><a name="ELC50PD">ELC50PD</a><br><a href="#topper">Back to Top</a><br><pre>

141a142
> 062017* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTEREST
682a684
> 062017     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
693c695
< 00463         MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
---
> 062017*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
8413,8414c8415,8416
< 072308     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
< 072308        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
---
> 062017     IF PB-C-INT-ON-REFS NOT NUMERIC
> 062017        MOVE ZEROS               TO PB-C-INT-ON-REFS
9982c9984
< 072308               GO TO 3785-CHECK-NH.
---
> 062017               GO TO 3785-CHECK-REF-INT.
10030c10032
< 050311                GO TO 3785-CHECK-NH
---
> 062017                GO TO 3785-CHECK-REF-INT
10049c10051
< 050311                   GO TO 3785-CHECK-NH
---
> 062017                   GO TO 3785-CHECK-REF-INT
10054c10056
< 072308               GO TO 3785-CHECK-NH.
---
> 062017               GO TO 3785-CHECK-REF-INT.
10105c10107
< 072308 3785-CHECK-NH.
---
> 062017 3785-CHECK-REF-INT.
10116c10118
< 072308        OR (CM-NH-INTERFACE-SW = 'Y')
---
> 062017        OR (CM-REF-INTERFACE-SW = 'Y')
10217,10221c10219,10227
<            if pb-state = 'NH'
<               move +1.10               to ws-work-rate
<            else
<               move +1.035              to ws-work-rate
<            end-if
---
> 062017*    if pb-state = 'NH'
> 062017*       move +1.10               to ws-work-rate
> 062017*    else
> 062017*       move +1.035              to ws-work-rate
> 062017*    end-if
> 062017     compute ws-work-rate = (1 + ws-st-refund-int-rate)
> 
>            display ' cal int ' ws-st-refund-int-rate ' ' ws-work-rate
>              ' ' dc-elapsed-days 
10227c10233
< 072308     IF WS-PAYMENT-AMT < 600.00
---
> 062017     IF WS-PAYMENT-AMT < 10.00
10231c10237
< 072308     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
---
> 062017*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
10233,10235c10239,10240
< 072308     IF (ERMAIL-FOUND = ' ')
< 072308         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
< 072308         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
---
> 062017     if (cm-soc-sec-no(1:9) numeric)
> 062017        and (cm-soc-sec-no(1:9) not = zeros)
10238a10244
> 
10534,10540c10540,10550
<            IF PB-C-NH-INT-ON-REFS > ZEROS
<               MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
<            END-IF
<            IF PB-C-REF-INTERFACE-SW = 'Y'
<               MOVE PB-C-REF-INTERFACE-SW
<                                        TO CM-NH-INTERFACE-SW
<            END-IF
---
> 062017     IF PB-C-INT-ON-REFS > ZEROS
> 062017        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
> 062017     END-IF
> 062017     IF PB-C-REF-INTERFACE-SW = 'Y'
> 062017        MOVE PB-C-REF-INTERFACE-SW
> 062017                                 TO CM-REF-INTERFACE-SW
> 062017     END-IF
> 062017     IF ERMAIL-FOUND = ' '
> 062017        PERFORM 8140-UNLOCK-ERMAIL
> 062017                                 THRU 8140-EXIT
> 062017     end-if

</pre>
<h3><a name="ELC50WS">ELC50WS</a><br><a href="#topper">Back to Top</a><br><pre>

66a67
> 062017* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
141a143
> 062017     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.

</pre>
<h3><a name="ELCANC.cl2">ELCANC.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

56a57
> 062017* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTEREST
692c693
<                                           PB-C-NH-INT-ON-REFS
---
> 062017                                    PB-C-INT-ON-REFS

</pre>
<h3><a name="ELCCERT">ELCCERT</a><br><a href="#topper">Back to Top</a><br><pre>

37a38
> 062017* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
176c177
< 072308         16  CM-NH-INTERFACE-SW            PIC X.
---
> 062017         16  CM-REF-INTERFACE-SW           PIC X.
302c303
< 072308     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
---
> 062017     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3. ELCCERT

</pre>
<h3><a name="ERCPNDB">ERCPNDB</a><br><a href="#topper">Back to Top</a><br><pre>

58a59
> 062017* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
347c348
< 072308         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.  
---
> 062017         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.  

</pre>
<h3><a name="NSRASBL.cl2">NSRASBL.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

41a42
> 062017* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTEREST
3048,3050c3049,3051
<            IF CM-NH-INT-ON-REFS NUMERIC
<               IF CM-NH-INT-ON-REFS NOT = ZEROS
< 110612           MOVE CM-NH-INT-ON-REFS TO OUT-TOT-INTEREST
---
> 062017     IF CM-INT-ON-REFS NUMERIC
> 062017        IF CM-INT-ON-REFS NOT = ZEROS
> 062017           MOVE CM-INT-ON-REFS   TO OUT-TOT-INTEREST

</pre>
<h3><a name="VP6301.cl2">VP6301.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

49a50
> 062017* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTEREST
4507c4508
<                                           PB-C-NH-INT-ON-REFS
---
> 062017                                    PB-C-INT-ON-REFS

</pre>
<h3><a name="VP6311.cl2">VP6311.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

78a79
> 062017* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTEREST
6273c6274
< 072908                                    PB-C-NH-INT-ON-REFS                       
---
> 062017                                    PB-C-INT-ON-REFS                       
11866,11868c11867,11869
< 072908     IF PB-C-NH-INT-ON-REFS NUMERIC
< 072908        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
< 072908           MOVE PB-C-NH-INT-ON-REFS
---
> 062017     IF PB-C-INT-ON-REFS NUMERIC
> 062017        IF PB-C-INT-ON-REFS NOT = ZEROS
> 062017           MOVE PB-C-INT-ON-REFS

</pre>
</body></html>