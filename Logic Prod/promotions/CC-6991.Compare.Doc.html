<html>
<head>
<title>Compare Module List</title>
</head>
<body style="background-color:PowderBlue;"><div align="center"><h2>Compares for CC-6991-PEMA.ini</h2>
<h3>Processed on - 10/11/2018</h3></div>
<a name="topper"></a>
<a href="#inifile">INI File</a><br>
<a href="#ELAGGB.cbl">ELAGGB.cbl</a><br>
<a href="#ELAGGO.cl2">ELAGGO.cl2</a><br>
<a href="#SOCK06.cl2">SOCK06.cl2</a><br>
<h3>INI FILE As submitted by programmer, followed by log information <h3>
<pre>

[2018082400001]
[/apps/test/cid1s/jcl/daily_jobs/;/apps/prod/cid1p/jcl/daily_jobs/]
[/apps/test/cid1s/jcl/monthly_jobs/;/apps/prod/cid1p/jcl/monthly_jobs/]
[/apps/test/cid1s/jcl/quarterly_jobs/;/apps/prod/cid1p/jcl/quarterly_jobs/]
[/apps/test/cid1s/jcl/yearly_jobs/;/apps/prod/cid1p/jcl/yearly_jobs/]
[/export/home/pema/bin/;/export/home/mtpadmin/bin/]
[/data/test/seqfiles/;/data/seqfiles/]
[/apps/test/cid1s/sys/webroot/;/apps/prod/cid1p/sys/webroot/]
[/apps/test/cid1s/sys/webroot/balancesheet/;/apps/prod/cid1p/sys/webroot/balancesheet/]
[/apps/test/cid1s/sys/webroot/balancesheet/images/;/apps/prod/cid1p/sys/webroot/balancesheet/images/]
[/apps/test/cid1s/sys/webroot/balancesheet/javascript/;/apps/prod/cid1p/sys/webroot/balancesheet/javascript/]
[/apps/test/cid1s/sys/webroot/balancesheet/style/;/apps/prod/cid1p/sys/webroot/balancesheet/style/]
[/apps/test/cid1s/maps/;/apps/prod/cid1p/maps/]
[/apps/test/cid1s/copy/;/apps/prod/cid1p/copy/]
[/apps/test/cid1s/emails/;/apps/prod/cid1p/emails/]
[/apps/test/cid1s/parmlib/;/apps/prod/cid1p/parmlib/]
[/apps/test/cid1s/src/batch/;/apps/prod/cid1p/src/batch/]
ELAGGB.cbl=
ELAGGB.lst=
[/apps/test/cid1s/src/online/;/apps/prod/cid1p/src/online/]
ELAGGO.cl2=
ELAGGO.cbl=
ELAGGO.lst=
SOCK06.cl2=
SOCK06.cbl=
SOCK06.lst=
[/apps/test/cid1s/exe/bat/;/apps/prod/cid1p/staging/exe_bat/]
ELAGGB.gnt=
[/apps/test/cid1s/exe/onl/;/apps/prod/cid1p/staging/exe_onl/]
ELAGGO.gnt=
SOCK06.gnt=
Archive Process Successfull using - perl /export/home/mtpadmin/bin/mtp_archive.pl CC-6991-PEMA.ini
Move Process Successfull using - perl /export/home/mtpadmin/bin/mtp_move.pl CC-6991-PEMA.ini
Promote process successfull and verified using - perl /export/home/mtpadmin/bin/mtp_verify.pl CC-6991-PEMA.ini
Archived module - /apps/prod/cid1p/src/batch/archive/ELAGGB.cbl.20181011
Archived module - /apps/prod/cid1p/src/batch/archive/ELAGGB.lst.20181011
Archived module - /apps/prod/cid1p/src/online/archive/ELAGGO.cl2.20181011
Archived module - /apps/prod/cid1p/src/online/archive/ELAGGO.cbl.20181011
Archived module - /apps/prod/cid1p/src/online/archive/ELAGGO.lst.20181011
Archived module - /apps/prod/cid1p/src/online/archive/SOCK06.cl2.20181011
Archived module - /apps/prod/cid1p/src/online/archive/SOCK06.cbl.20181011
Archived module - /apps/prod/cid1p/src/online/archive/SOCK06.lst.20181011
Archived module - /apps/prod/cid1p/exe/bat/archive/ELAGGB.gnt.20181011
Archived module - /apps/prod/cid1p/exe/onl/archive/ELAGGO.gnt.20181011
Archived module - /apps/prod/cid1p/exe/onl/archive/SOCK06.gnt.20181011
moved module - /apps/prod/cid1p/src/batch/ELAGGB.cbl
moved module - /apps/prod/cid1p/src/batch/ELAGGB.lst
moved module - /apps/prod/cid1p/src/online/ELAGGO.cl2
moved module - /apps/prod/cid1p/src/online/ELAGGO.cbl
moved module - /apps/prod/cid1p/src/online/ELAGGO.lst
moved module - /apps/prod/cid1p/src/online/SOCK06.cl2
moved module - /apps/prod/cid1p/src/online/SOCK06.cbl
moved module - /apps/prod/cid1p/src/online/SOCK06.lst
moved module - /apps/prod/cid1p/staging/exe_bat/ELAGGB.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/ELAGGO.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/SOCK06.gnt

</pre>
<h3><a name="ELAGGB.cbl">ELAGGB.cbl</a><br><a href="#topper">Back to Top</a><br><pre>

31a32
> 082718* 082718 CR2018082400001   PEMA  Incorp pri & co borw current age
55,60d55
<            SELECT ELMSTR5          ASSIGN TO ELMSTR5
<                                    ORGANIZATION IS INDEXED
<                                    ACCESS IS DYNAMIC
<                                    RECORD KEY IS CL-CONTROL-BY-CERT-NO
<                                    FILE STATUS IS ELMSTR5-FILE-STATUS.
< 
66a62,67
>            SELECT ELCERT           ASSIGN TO ELCERT
>                                    ORGANIZATION IS INDEXED
>                                    ACCESS IS DYNAMIC
>                                    RECORD KEY IS CM-CONTROL-PRIMARY
>                                    FILE STATUS IS ELCERT-FILE-STATUS.
> 
84,87d84
<        FD  ELMSTR5.
< 
<                                        COPY ELCMSTR.
< 
91a89,92
>        FD  ELCERT.
> 
>                                        COPY ELCCERT.
> 
94c95
<        77  FILLER  PIC X(32) VALUE '   PRGMTBD  WORKING STORAGE     '.
---
>        77  FILLER  PIC X(32) VALUE '   ELAGGB   WORKING STORAGE     '.
104a106,107
>        77  WS-COMP-CD                  PIC X  VALUE LOW-VALUES.
>        77  WS-COMP-ID                  PIC XXX VALUE 'CID'.
109a113
> 082718 77  n1                          pic s999 value +0 comp-3.
113a118,119
> 010517 77  save-bin-date               pic xx value low-values.           
> 082718 77  ws-current-bin-dt           pic xx value low-values.
118a125,130
> 082718 77  ws-work-age                 pic s999 comp-3 value zeros.
> 082718 77  ws-pb-pri-curr-age          pic s999 comp-3 value +0.
> 082718 77  ws-pb-cob-curr-age          pic s999 comp-3 value +0.
> 082718 77  ws-p5-pri-curr-age          pic s999 comp-3 value +0.
> 082718 77  ws-p5-cob-curr-age          pic s999 comp-3 value +0.
> 082718 77  ws-alph-curr-age            pic s999 comp-3 value +0.
120a133
>        01  ws-hold-elcert              pic x(450) value spaces.
137a151,155
> 082718 01  ws-alpha-last-name          pic x(15) value spaces.
> 082718 01  ws-p5-last-name             pic x(15) value spaces.
> 082718 01  ws-p5-jnt-last-name         pic x(15) value spaces.
> 082718 01  ws-name-in                  pic x(15) value spaces.
> 082718 01  ws-name-out                 pic x(15) value spaces.
153d170
<            05  ELMSTR5-FILE-STATUS     PIC XX    VALUE ZEROS.
154a172
>            05  ELCERT-FILE-STATUS      PIC XX    VALUE ZEROS.
157a176,187
> 010517     05  ws-lf-ben-code          pic xx.
> 010517     05  ws-ah-ben-code          pic xx.
> 010517     05  ws-lf-calc-cd           pic x   value spaces.
> 010517     05  ws-lf-coverage-type     pic x   value spaces.
> 010517     05  ws-lf-earnings-calc     pic x   value spaces.
> 010517     05  ws-lf-kind              pic x   value spaces.
> 010517     05  ws-lf-ben-descrip       pic x(10) value spaces.
> 010517     05  ws-ah-calc-cd           pic x   value spaces.
> 010517     05  ws-ah-coverage-type     pic x   value spaces.
> 010517     05  ws-ah-earnings-calc     pic x   value spaces.
> 010517     05  ws-ah-kind              pic x   value spaces.
> 010517     05  ws-ah-ben-descrip       pic x(10) value spaces.
158a189,190
>                                        copy ELCCALC.
>                                        copy ELCFUNDT.
177,178c209,210
<                  perform 0500-close-files
<                                        thru 0500-exit
---
>                  perform 1000-close-files
>                                        thru 1000-exit
192c224
<            OPEN INPUT ERALPH2 ERPNDB2 ERPNDB5 ELMSTR5 ELCNTL
---
>            OPEN INPUT ERALPH2 ERPNDB2 ERPNDB5 ELCNTL ELCERT
218c250
<            IF ELMSTR5-FILE-STATUS = '00' OR '97'
---
>            IF ELCNTL-FILE-STATUS = '00' OR '97'
221,222c253,254
<               DISPLAY ' ERROR ON ELMSTR5 - OPEN   '
<                  ELMSTR5-FILE-STATUS
---
>               DISPLAY ' ERROR ON ELCNTL - OPEN   '
>                  ELCNTL-FILE-STATUS
226c258
<            IF ELCNTL-FILE-STATUS = '00' OR '97'
---
>            IF ELCERT-FILE-STATUS = '00' OR '97'
229,230c261,262
<               DISPLAY ' ERROR ON ELCNTL - OPEN   '
<                  ELCNTL-FILE-STATUS
---
>               DISPLAY ' ERROR ON ELCERT - OPEN   '
>                  ELCERT-FILE-STATUS
239a272,284
>            MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
>       *    DISPLAY ' WS-FN-DATE ' WS-FN-DATE
>            MOVE WS-FN-DATE             TO DC-GREG-DATE-CYMD
>            MOVE 'L'                    TO DC-OPTION-CODE
>            PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
>            IF NO-CONVERSION-ERROR
>               MOVE DC-BIN-DATE-1       TO WS-CURRENT-BIN-DT
>                                           save-bin-date
>            ELSE
>               DISPLAY 'BAD CURRENT DATE ' WS-FN-DATE
>               PERFORM ABEND-PGM
>            END-IF
> 
241a287,288
>            move zeros                  to ws-lf-tot-benefit
>                                           ws-ah-tot-benefit
243a291
>            perform 0045-get-ben-codes  thru 0045-exit
249,278d296
<        0030-START-ERPNDB.
< 
<            MOVE LOW-VALUES             TO pb-control-by-account
<            MOVE DTE-CLASIC-COMPANY-CD  TO pb-company-cd-a1
< 
<            START ERPNDB2 KEY >= pb-CONTROL-BY-ACCOUNT
< 
<            IF ERPNDB-FILE-STATUS = '10' OR '23'
<               display ' set end of pndb ' erpndb-file-status
<               SET END-OF-ERPNDB        TO TRUE
<            ELSE
<               IF ERPNDB-FILE-STATUS NOT = '00'
<                  DISPLAY ' ERROR ON ERPNDB - START  '
<                     ERPNDB-FILE-STATUS
<                  PERFORM ABEND-PGM
<               END-IF
<            END-IF
< 
<            .
<        0030-EXIT.
<            EXIT.
< 
<        0040-READ-ERPNDB.
< 
<            read erpndb2
< 
<            .
<        0040-EXIT.
<            EXIT.
< 
282,312c300,306
<            if pb-i-lf-benefit-cd = '00' or '  '
<               go to 0045-check-ah
<            end-if
<            move pb-company-id          to cf-company-id
<            move '4'                    to cf-record-type
<            move pb-i-lf-benefit-cd     to cf-hi-ben-in-rec
<            move zeros                  to cf-sequence-no
< 
<            start elcntl key >= cf-control-primary
<            if elcntl-file-status not = '00'
<               go to 0045-check-ah
<            end-if
<            read elcntl next record
<            if (elcntl-file-status not = '00')
<               or (pb-company-id not = cf-company-id)
<               or (cf-record-type not = '4')
<               go to 0045-check-ah
<            end-if
<            perform varying c1 from +1 by +1 until
<               (c1 > +8)
<               or (cf-benefit-code (c1) = pb-i-lf-benefit-cd)
<            end-perform
<            if c1 < +9
<               move cf-joint-indicator (c1) to lf-joint-ind
<            end-if
< 
<            .
<        0045-check-ah.
< 
<            if pb-i-ah-benefit-cd = '00' or '  '
<               go to 0045-exit
---
>            if pb-i-lf-benefit-cd <> '00' and spaces
>               move pb-i-lf-benefit-cd  to ws-lf-ben-code
>               perform 0400-get-lf-code thru 0400-exit
>               if c1 < +9
>                  move cf-joint-indicator (c1)
>                                        to lf-joint-ind
>               end-if
315,335c309,315
<            move pb-company-id          to cf-company-id
<            move '5'                    to cf-record-type
<            move pb-i-ah-benefit-cd     to cf-hi-ben-in-rec
<            move zeros                  to cf-sequence-no
< 
<            start elcntl key >= cf-control-primary
<            if elcntl-file-status not = '00'
<               go to 0045-exit
<            end-if
<            read elcntl next record
<            if (elcntl-file-status not = '00')
<               or (pb-company-id not = cf-company-id)
<               or (cf-record-type not = '5')
<               go to 0045-exit
<            end-if
<            perform varying c1 from +1 by +1 until
<               (c1 > +8)
<               or (cf-benefit-code (c1) = pb-i-ah-benefit-cd)
<            end-perform
<            if c1 < +9
<               move cf-joint-indicator (c1) to ah-joint-ind
---
>            if pb-i-ah-benefit-cd <> '00' and spaces
>               move pb-i-ah-benefit-cd  to ws-ah-ben-code
>               perform 0410-get-ah-code thru 0410-exit
>               if c1 < +9
>                  move cf-joint-indicator (c1)
>                                        to ah-joint-ind
>               end-if
347a328
>               move +0                  to a1
349,351c330,336
<               move pb-i-age            to ws-age
<               MOVE PB-i-insured-last-name
<                                        to ws-last-name
---
>       *       MOVE PB-i-insured-last-name
>       *                                to ws-last-name
> 082718        move pb-i-insured-last-name
> 082718                                 to ws-name-in
> 082718        perform 0650-set-last-name
> 082718                                 thru 0650-exit
> 082718        move ws-name-out         to ws-last-name
353a339,341
> 082718        perform 0700-calc-cur-pb-ages
> 082718                                 thru 0700-exit
>               move ws-pb-pri-curr-age  to ws-age
355a344
> 
356a346
>                  move ws-hold-elcert   to certificate-master
359,361c349,356
<                  move pb-i-joint-age   to ws-age
<                  move pb-i-joint-last-name
<                                        to ws-last-name
---
>       *          move pb-i-joint-age   to ws-age
>       *          move pb-i-joint-last-name
>       *                                to ws-last-name
> 082718           move pb-i-joint-last-name
> 082718                                 to ws-name-in
> 082718           perform 0650-set-last-name
> 082718                                 thru 0650-exit
> 082718           move ws-name-out      to ws-last-name
363a359,360
> 082718           move ws-pb-cob-curr-age
> 082718                                 to ws-age
367d363
<               
369d364
<       *    PERFORM 0040-READ-ERPNDB    THRU 0040-EXIT
377c372
<       *** check to see if there is a pending cancel for the issue **
---
>       *** check to see if the cert is cancelled
379,386c374,382
<            move pb-control-by-account  to p5-control-by-account
<            move +0                     to p5-alt-chg-seq-no
<            move '2'                    to p5-record-type
<            read erpndb5
<            if erpndb5-file-status = '00'
<               if p5-ci-lf-benefit-cd not = '00' and '  '
<                  if p5-c-lf-cancel-dt <> low-values
<                     move '00'             to pb-i-lf-benefit-cd
---
>            move pb-control-by-account (1:33)
>                                        to cm-control-primary
>            perform 0600-get-elcert     thru 0600-exit
> 
>            if elcert-file-status = '00'
>               move certificate-master  to ws-hold-elcert
> 082718        if cm-lf-benefit-cd <> '00' and '  '
> 082718           if cm-lf-cancel-dt <> low-values
> 082718              move '00'          to pb-i-lf-benefit-cd
389,391c385,387
<               if p5-ci-ah-benefit-cd not = '00' and '  '
<                  if p5-c-ah-cancel-dt <> low-values
<                     move '00'             to pb-i-ah-benefit-cd
---
> 082718        if cm-ah-benefit-cd <> '00' and '  '
> 082718           if cm-ah-cancel-dt <> low-values
> 082718              move '00'          to pb-i-ah-benefit-cd
395a392,408
>       *    move pb-control-by-account  to p5-control-by-account
>       *    move +0                     to p5-alt-chg-seq-no
>       *    move '2'                    to p5-record-type
>       *    read erpndb5
>       *    if erpndb5-file-status = '00'
>       *       if p5-ci-lf-benefit-cd not = '00' and '  '
>       *          if p5-c-lf-cancel-dt <> low-values
>       *             move '00'             to pb-i-lf-benefit-cd
>       *          end-if
>       *       end-if
>       *       if p5-ci-ah-benefit-cd not = '00' and '  '
>       *          if p5-c-ah-cancel-dt <> low-values
>       *             move '00'             to pb-i-ah-benefit-cd
>       *          end-if
>       *       end-if
>       *    end-if
> 
402c415
<            move ' ' to ws-eralph-sw
---
>            move ' '                    to ws-eralph-sw
404,405c417
<       ****  this reads 
<            move +1                     to a1
---
>            add +1                      to a1
415a428,436
>       *    move pb-control-by-account (1:33)
>       *                                to cm-control-primary
> 010517*    perform 0600-get-elcert     thru 0600-exit
>       *    display ' got cert ' cm-account ' ' cm-cert-no
> 
>            move zeros                  to ws-eralph-lf-remamt (a1)
>                                           ws-eralph-ah-amt (a1)
>                                           ws-eralph-ah-remamt (a1)
> 
417,420c438,449
<            move pb-i-lf-benefit-cd     to ws-eralph-lf-cd (a1)
<            compute ws-eralph-lf-remamt (a1) =
<               pb-i-lf-benefit-amt + pb-i-lf-alt-benefit-amt
<            move ws-eralph-lf-remamt (a1)
---
> 
>           if pb-i-lf-benefit-cd <> '00' and '  '
>               if (processing-primary)
>                           or
>                  ((processing-secondary)
>                  and (lf-joint-ind = 'J'))
>                  move pb-i-lf-benefit-cd
>                                        to ws-eralph-lf-cd (a1)
>                  perform 0500-get-lf-rem
>                                        thru 0500-exit
>                  move cp-remaining-amt to ws-eralph-lf-remamt (a1)
>                  move ws-eralph-lf-remamt (a1)
422,426c451,469
<            move pb-i-ah-benefit-cd     to ws-eralph-ah-cd (a1)
<            move pb-i-ah-benefit-amt    to ws-eralph-ah-amt (a1)
<            compute ws-eralph-ah-remamt (a1) =
<               pb-i-ah-term * pb-i-ah-benefit-amt
<            move ws-eralph-ah-amt (a1)  to ws-ah-tot-benefit
---
>               end-if
>            end-if
> 
>            if pb-i-ah-benefit-cd <> '00' and '  '
>               if (processing-primary)
>                           or
>                  ((processing-secondary)
>                  and (ah-joint-ind = 'J'))
>                  move pb-i-ah-benefit-cd
>                                        to ws-eralph-ah-cd (a1)
>                  perform 0510-get-ah-rem
>                                        thru 0510-exit
>                  move cp-remaining-amt to ws-eralph-ah-remamt (a1)
>                  move ws-eralph-ah-remamt (a1)
>                                        to ws-ah-tot-benefit
>                  move cm-ah-benefit-amt
>                                        to ws-eralph-ah-amt (a1)
>               end-if
>            end-if
449c492
<               or (af-lname       not = ws-last-name)
---
>               or (ws-alpha-last-name not = ws-last-name)
454c497,504
<            if a1 > +1
---
>            if ((ws-cov-sw = 'P')
>               and (a1 > +1))
>                    or
>               ((ws-cov-sw = 'S')
>               and (a1 > +2))
> 
> 
>       *    if a1 > +1
503d552
<       *          display ' **** TOTAL **** '
520d568
<               OR (AF-COMPANY-CD-A1 NOT = pb-company-cd)
521a570
>               go to 0155-exit
526a576
>                  go to 0155-exit
529a580,591
>            if pb-company-cd = af-company-cd-a1
>               and pb-account = af-account-a1
>               continue
>            else
>               set end-of-eralph to true
>               go to 0155-exit
>            end-if
> 
> 082718     move af-lname               to ws-name-in
> 082718     perform 0650-set-last-name  thru 0650-exit
> 082718     move ws-name-out            to ws-alpha-last-name
> 
536c598
<       *** check to see if there is a pending cancel for the alpha rec **
---
>       *** check to see if the alpha record is cancelled
539,545c601,611
<            move af-control-primary     to p5-control-by-account
<            move +0                     to p5-alt-chg-seq-no
<            move '2'                    to p5-record-type
<            read erpndb5
<            if erpndb5-file-status = '00'
<               if p5-ci-lf-benefit-cd not = '00' and '  '
<                  if p5-c-lf-cancel-dt <> low-values
---
> 082718     if pb-control-by-account (1:33) = af-control-primary(1:33)
> 082718        go to 0160-continue
> 082718     end-if
> 082718
> 082718     move af-control-primary(1:33)
>                                        to cm-control-primary
> 082718     perform 0600-get-elcert     thru 0600-exit
> 
>            if elcert-file-status = '00'
> 082718        if cm-lf-benefit-cd not = '00' and '  '
> 082718           if cm-lf-cancel-dt <> low-values
549,550c615,616
<               if p5-ci-ah-benefit-cd not = '00' and '  '
<                  if p5-c-ah-cancel-dt <> low-values
---
> 082718        if cm-ah-benefit-cd not = '00' and '  '
> 082718           if cm-ah-cancel-dt <> low-values
553a620,621
>            else
>               go to 0160-continue
555,562c623,638
<       *    if ((processing-primary)
<       *       and (af-insured-alpha))
<       *              or
<       *       ((processing-secondary)
<       *       and (af-joint-alpha))
<       *       continue
<       *    else
<       *       go to 0160-continue
---
> 
>       *    move af-control-primary     to p5-control-by-account
>       *    move +0                     to p5-alt-chg-seq-no
>       *    move '2'                    to p5-record-type
>       *    read erpndb5
>       *    if erpndb5-file-status = '00'
>       *       if p5-ci-lf-benefit-cd not = '00' and '  '
>       *          if p5-c-lf-cancel-dt <> low-values
>       *             move '00'             to af-lf-typ
>       *          end-if
>       *       end-if
>       *       if p5-ci-ah-benefit-cd not = '00' and '  '
>       *          if p5-c-ah-cancel-dt <> low-values
>       *             move '00'             to af-ah-typ
>       *          end-if
>       *       end-if
564,566c640,643
< 033116     if (af-lf-typ not = '00' and '  ')
< 033116        or (af-ah-typ not = '00' and '  ')
<               add +1 to a1
---
> 
> 082718     if (af-lf-typ = '00' or spaces)
> 082718        and (af-ah-typ = '00' or spaces)
>               go to 0160-continue
567a645,666
> 
> 082718     perform 0720-calc-cur-alph-age
> 082718                                 thru 0720-exit
> 
>            if ws-age - ws-alph-curr-age < 4 and > -4
>               continue
>            else
>               go to 0160-continue
>            end-if
> 
>            if af-lf-remamt = zeros
>               and af-ah-remamt = zeros
>               go to 0160-continue
>            end-if
> 
> 010517*    move af-control-primary     to cm-control-primary
> 010517*    perform 0600-get-elcert     thru 0600-exit
>       *    if elcert-file-status <> '00'
>       *       go to 0160-continue  *> probably not in force
>       *    end-if                  *> anyway
> 
>            add +1 to a1
571c670,671
<               move af-lf-remamt        to ws-eralph-lf-remamt (a1)
---
> 010517        perform 0500-get-lf-rem  thru 0500-exit
> 010517        move cp-remaining-amt    to ws-eralph-lf-remamt (a1)
573c673
<                  ws-lf-tot-benefit + af-lf-remamt + af-lf-remamt-alt
---
>                  ws-lf-tot-benefit + ws-eralph-lf-remamt (a1)
579,584c679,686
<               move af-ah-amt           to ws-eralph-ah-amt (a1)
<               move af-ah-remamt        to ws-eralph-ah-remamt (a1)
<               compute ws-ah-tot-benefit =
<                  ws-ah-tot-benefit + af-ah-amt
<               perform 0165-check-for-ah-claim
<                                        thru 0165-exit
---
>               if af-ah-status <> '8'
>                  move af-ah-amt        to ws-eralph-ah-amt (a1)
> 010517           perform 0510-get-ah-rem
> 010517                                 thru 0510-exit
> 010517           move cp-remaining-amt to ws-eralph-ah-remamt (a1)
>                  compute ws-ah-tot-benefit =
> 010517              ws-ah-tot-benefit + cp-remaining-amt
>               end-if
596,649d697
<        0165-check-for-ah-claim.
< 
<            move pb-company-cd          to cl-company-cd-a4
<            move af-cert-no             to cl-cert-no-a4
<            start elmstr5 key >= cl-control-by-cert-no
<            if elmstr5-file-status = '00' or '02'
<               continue
<            else
<               if elmstr5-file-status = '10' or '23'
<                  go to 0165-exit
<               else
<                  display ' error-elmstr5-start ' elmstr5-file-status
<                     ' ' af-state ' ' af-account ' ' af-cert-no
<                  perform abend-pgm
<               end-if
<            end-if
<            if elmstr5-file-status not = '00' and '02'
<               go to 0165-exit
<            end-if
<            read elmstr5 next record
<            if elmstr5-file-status = '00' or '02'
<               continue
<            else
<               if elmstr5-file-status = '10' or '23'
<                  go to 0165-exit
<               else
<                  display ' error-elmstr5-read next '
<                     elmstr5-file-status ' ' af-state ' '
<                     af-account ' ' af-cert-no
<                  perform abend-pgm
<               end-if
<            end-if
< 
<            if (cl-cert-carrier = af-carrier)
<               and (cl-cert-grouping = af-grouping)
<               and (cl-cert-state    = af-state)
<               and (cl-cert-account  = af-account)
<               and (cl-cert-eff-dt   = af-dt)
<               and (cl-cert-no-a4    = af-cert-no)
<               move cl-incurred-dt      to dc-bin-date-1
<               move pb-cert-eff-dt      to dc-bin-date-2
<               move '1'                 to dc-option-code
<               perform 8500-date-convert thru 8500-exit
<               if (no-conversion-error)
<                  and (dc-elapsed-months > 11)
<                  display ' A & H claim ' cl-cert-no-a4 ' '
<                     cl-claim-status ' ' cl-total-paid-amt
<               end-if
<            end-if
< 
<            .
<        0165-exit.
<            exit.
< 
706,753c754,855
<            if pb-control-by-account = p5-control-by-account
<               continue
<            else
<               if (p5-control-by-account (1:33) =
<                             ws-save-issue-key (1:33))
<                  and (p5-record-type = '2')
<                  move spaces           to ws-save-issue-key
<                  if p5-ci-lf-benefit-cd not = '00' and '  '
<                     if p5-c-lf-cancel-dt <> low-values
<       *                display ' found lf accum cancel ' p5-account
<       *                   ' ' p5-cert-no
<                        move '00'             to ws-eralph-lf-cd (a1)
<                     end-if
<                  end-if
<                  if p5-ci-ah-benefit-cd not = '00' and '  '
<                     if p5-c-ah-cancel-dt <> low-values
<       *                display ' found ah accum cancel ' p5-account
<       *                   ' ' p5-cert-no
<                        move '00'             to ws-eralph-ah-cd (a1)
<                     end-if
<                  end-if
<               end-if
<               if ((p5-i-insured-last-name = ws-last-name)
< 092215            and (p5-i-insured-first-name (1:3) = ws-first-three)
<                   and (p5-record-type = '1'))
<                               or
<                   ((p5-i-joint-last-name = ws-last-name)
< 092215            and (p5-i-joint-first-name (1:3) = ws-first-three)
<                   and (p5-record-type = '1'))
<                  add +1 to a1
<                  move p5-control-by-account to ws-save-issue-key
<                  move p5-cert-no       to ws-eralph-cert  (a1)
<                  move p5-i-lf-benefit-cd
<                                        to ws-eralph-lf-cd (a1)
<                  move p5-i-lf-benefit-amt
<                                        to ws-eralph-lf-remamt (a1)
<                  compute ws-lf-tot-benefit = ws-lf-tot-benefit +
<                     p5-i-lf-benefit-amt + p5-i-lf-alt-benefit-amt
<                  move p5-i-ah-benefit-cd
<                                        to ws-eralph-ah-cd (a1)
<                  move p5-i-ah-benefit-amt
<                                        to ws-eralph-ah-amt (a1)
<                  compute ws-ah-tot-benefit =
<                     ws-ah-tot-benefit + p5-i-ah-benefit-amt
<                  compute ws-eralph-ah-remamt (a1) =
<                     p5-i-ah-term * p5-i-ah-benefit-amt
<               end-if
<            end-if
---
>            if (pb-control-by-account = p5-control-by-account)
>               or (p5-record-type <> '1')
>               go to 0180-read
>            end-if
> 
>            move p5-control-by-account (1:33)
>                                     to cm-control-primary
>            perform 0600-get-elcert  thru 0600-exit
>            if (cm-lf-benefit-cd <> '00' and spaces)
>               and (cm-lf-cancel-dt <> low-values)
>               move '00'             to p5-i-lf-benefit-cd
>            end-if
>            if (cm-ah-benefit-cd <> '00' and spaces)
>               and (cm-ah-cancel-dt <> low-values)
>               move '00'             to p5-i-ah-benefit-cd
>            end-if
>            if ((p5-i-lf-benefit-cd = '00' or spaces)
>               and (p5-i-ah-benefit-cd = '00' or spaces))
>                        or
>               (p5-i-entry-status = '5' or '9' or
>                                 'D' or 'V')                 
>               go to 0180-read   *>  Must be cancelled or something
>            end-if
> 
> 082718     move p5-i-insured-last-name to ws-name-in
> 082718     perform 0650-set-last-name  thru 0650-exit
> 082718     move ws-name-out            to ws-p5-last-name
> 082718     move p5-i-joint-last-name   to ws-name-in
> 082718     perform 0650-set-last-name  thru 0650-exit
> 082718     move ws-name-out            to ws-p5-jnt-last-name
> 
> 
>            if ((ws-last-name = ws-p5-last-name)
> 092215        and (ws-first-three = p5-i-insured-first-name (1:3)))
>                           or
>               ((ws-last-name = ws-p5-jnt-last-name)
> 092215        and (ws-first-three = p5-i-joint-first-name (1:3)))
> 082718        perform 0710-calc-cur-p5-ages
> 082718                                 thru 0710-exit
>            end-if
> 
> 082718     if ((ws-last-name = ws-p5-last-name)
> 082718        and (ws-first-three = p5-i-insured-first-name (1:3)))
> 082718        and  (ws-age - ws-p5-pri-curr-age < 4 and > -4)
> 082718        add +1 to a1
> 082718        move p5-cert-no          to ws-eralph-cert  (a1)
> 082718        if (p5-i-lf-benefit-cd <> '  ' and '00')
> 082718           move p5-i-lf-benefit-cd
> 082718                                 to ws-eralph-lf-cd (a1)
> 082718           perform 0500-get-lf-rem
> 082718                                 thru 0500-exit
> 082718           move cp-remaining-amt to ws-eralph-lf-remamt (a1)
> 082718           compute ws-lf-tot-benefit =
> 082718              ws-lf-tot-benefit + cp-remaining-amt
> 082718        end-if
> 082718        if p5-i-ah-benefit-cd <> '  ' and '00'
> 082718           move p5-i-ah-benefit-cd
> 082718                              to ws-eralph-ah-cd (a1)
> 082718           perform 0510-get-ah-rem
> 082718                              thru 0510-exit
> 082718           move cp-remaining-amt
> 082718                              to ws-eralph-ah-remamt (a1)
> 082718           compute ws-ah-tot-benefit =
> 082718              ws-ah-tot-benefit + cp-remaining-amt
> 082718           move p5-i-ah-benefit-amt to ws-eralph-ah-amt (a1)
> 082718        end-if
> 082718        go to 0180-read  *> They can't possibly be pri & cob
> 082718     end-if
> 
> 
> 082718     if ((ws-last-name = ws-p5-jnt-last-name)
> 082718        and (ws-first-three =
> 082718                       p5-i-joint-first-name (1:3)))
> 082718        and  (ws-age - ws-p5-cob-curr-age < 4 and > -4)
> 082718        add +1 to a1
> 082718        move p5-control-by-account to ws-save-issue-key
> 082718        move p5-cert-no       to ws-eralph-cert  (a1)
> 082718        if p5-i-lf-benefit-cd <> '  ' and '00'
> 082718           move p5-i-lf-benefit-cd
> 082718                              to ws-eralph-lf-cd (a1)
> 082718           perform 0500-get-lf-rem
> 082718                              thru 0500-exit
> 082718           move cp-remaining-amt
> 082718                              to ws-eralph-lf-remamt (a1)
> 082718           compute ws-lf-tot-benefit =
> 082718              ws-lf-tot-benefit + cp-remaining-amt
> 082718        end-if
> 082718        if p5-i-ah-benefit-cd <> '  ' and '00'
> 082718           move p5-i-ah-benefit-cd
> 082718                              to ws-eralph-ah-cd (a1)
> 082718           perform 0510-get-ah-rem
> 082718                              thru 0510-exit
> 082718           move cp-remaining-amt
> 082718                              to ws-eralph-ah-remamt (a1)
> 082718           compute ws-ah-tot-benefit =
> 082718              ws-ah-tot-benefit + cp-remaining-amt
> 082718           move p5-i-ah-benefit-amt to ws-eralph-ah-amt (a1)
> 082718        end-if
> 082718     end-if
> 
>            .
>        0180-read.
761c863,1233
<        0500-CLOSE-FILES.
---
>        0400-get-lf-code.
> 
>            move pb-company-id          to cf-company-id
>            move '4'                    to cf-record-type
>            move ws-lf-ben-code         to cf-hi-ben-in-rec
>            move zeros                  to cf-sequence-no
> 
>            start elcntl key >= cf-control-primary
>            if elcntl-file-status not = '00'
>               go to 0400-exit
>            end-if
>            read elcntl next record
>            if (elcntl-file-status not = '00')
>               or (pb-company-id not = cf-company-id)
>               or (cf-record-type not = '4')
>               go to 0400-exit
>            end-if
>            perform varying c1 from +1 by +1 until
>               (c1 > +8)
>               or (cf-benefit-code (c1) = ws-lf-ben-code)
>            end-perform
>            if c1 < +9
> 010517        MOVE CF-BENEFIT-ALPHA (c1)
> 010517                                 TO WS-lf-KIND
> 010517        MOVE CF-SPECIAL-CALC-CD (c1)
> 010517                                 TO WS-lf-CALC-CD
> 010517        MOVE CF-BENEFIT-DESCRIP (c1)
> 010517                                 TO WS-lf-BEN-DESCRIP
> 010517        MOVE CF-LF-COVERAGE-TYPE (c1)
> 010517                                 TO WS-LF-COVERAGE-TYPE
> 010517        MOVE CF-CO-EARNINGS-CALC (c1)
> 010517                                 TO WS-lf-EARNINGS-CALC
>            end-if
> 
>            .
>        0400-exit.
>            exit.
> 
>        0410-get-ah-code.
> 
>            move pb-company-id          to cf-company-id
>            move '5'                    to cf-record-type
>            move ws-ah-ben-code         to cf-hi-ben-in-rec
>            move zeros                  to cf-sequence-no
> 
>            start elcntl key >= cf-control-primary
>            if elcntl-file-status not = '00'
>               go to 0410-exit
>            end-if
>            read elcntl next record
>            if (elcntl-file-status not = '00')
>               or (pb-company-id not = cf-company-id)
>               or (cf-record-type not = '5')
>               go to 0410-exit
>            end-if
>            perform varying c1 from +1 by +1 until
>               (c1 > +8)
>               or (cf-benefit-code (c1) = ws-ah-ben-code)
>            end-perform
> 
>            if c1 < +9
> 010517        MOVE CF-BENEFIT-ALPHA (c1)
> 010517                                 TO WS-ah-KIND
> 010517        MOVE CF-SPECIAL-CALC-CD (c1)
> 010517                                 TO WS-ah-CALC-CD
> 010517        MOVE CF-BENEFIT-DESCRIP (c1)
> 010517                                 TO WS-ah-BEN-DESCRIP
> 010517        MOVE CF-LF-COVERAGE-TYPE (c1)
> 010517                                 TO WS-ah-COVERAGE-TYPE
> 010517        MOVE CF-CO-EARNINGS-CALC (c1)
> 010517                                 TO WS-ah-EARNINGS-CALC
>            end-if
> 
>            .
>        0410-exit.
>            exit.
> 
>        0500-get-lf-rem.
>       
>            move zeros to cp-remaining-benefit
>            MOVE '2'                    TO CP-PROCESS-TYPE
>            MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
>            MOVE WS-lf-EARNINGS-CALC    TO CP-EARNING-METHOD
>                                           CP-RATING-METHOD
>            MOVE WS-lf-CALC-CD          TO CP-SPECIAL-CALC-CD
>            MOVE cm-cert-eff-dt         TO CP-CERT-EFF-DT
>            MOVE cm-loan-1st-pmt-dt     TO CP-FIRST-PAY-DATE
>            MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT
>            IF cm-lf-orig-term = 0
>               MOVE 1                   TO CP-ORIGINAL-TERM
>            ELSE
>               MOVE cm-lf-orig-term     TO CP-ORIGINAL-TERM
>            end-if
>            MOVE cm-loan-term           TO CP-LOAN-TERM
>            MOVE '1'                    TO CP-REM-TRM-CALC-OPTION
>            MOVE '4'                    TO CP-REM-TERM-METHOD
>            MOVE ws-comp-id             TO CP-COMPANY-ID
>            MOVE ws-comp-cd             TO CP-COMPANY-CD
> 
>            CALL 'ELRTRMX' USING CALCULATION-PASS-AREA
> 
>            if not no-cp-error
>               display ' rem term error ' cp-return-code ' '
>               pb-cert-no
>            end-if
>            MOVE cm-lf-benefit-amt      TO CP-ORIGINAL-BENEFIT
>                                           CP-RATING-BENEFIT-AMT
>            MOVE cm-lf-premium-amt      TO CP-ORIGINAL-PREMIUM
>            MOVE cm-lf-alt-benefit-amt  TO CP-ALTERNATE-BENEFIT
>            MOVE cm-lf-alt-premium-amt  TO CP-ALTERNATE-PREMIUM
>            MOVE cm-loan-apr            TO CP-LOAN-APR
>            MOVE cm-pay-frequency       TO CP-PAY-FREQUENCY
>       
>            MOVE cm-rate-class          TO CP-CLASS-CODE
>            MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
>            CALL 'ELRAMTX' using calculation-pass-area
>            if not no-cp-error
>               display ' rem amt error ' cp-return-code ' '
>               pb-cert-no
>            end-if
>       
>            .
>        0500-exit.
>            exit.
>       
>        0510-get-ah-rem.
>       
>            MOVE '2'                    TO CP-PROCESS-TYPE
>            MOVE WS-ah-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
>            MOVE WS-ah-EARNINGS-CALC    TO CP-EARNING-METHOD
>                                           CP-RATING-METHOD
>            MOVE WS-ah-CALC-CD          TO CP-SPECIAL-CALC-CD
>            MOVE cm-cert-eff-dt         TO CP-CERT-EFF-DT
>            MOVE cm-loan-1st-pmt-dt     TO CP-FIRST-PAY-DATE
>            MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT
>            MOVE cm-ah-orig-term        TO CP-ORIGINAL-TERM
>            MOVE cm-loan-term           TO CP-LOAN-TERM
>            MOVE '1'                    TO CP-REM-TRM-CALC-OPTION
>            MOVE '4'                    TO CP-REM-TERM-METHOD
>            MOVE ws-comp-id             TO CP-COMPANY-ID
>            MOVE ws-comp-cd             TO CP-COMPANY-CD
>       
>            CALL 'ELRTRMX' using calculation-pass-area
>       
>            MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
>            compute cp-remaining-amt =
>               cm-ah-benefit-amt * cp-remaining-term-3
>       
>            .
>        0510-exit.
>            exit.
> 
>        0600-get-elcert.
> 
>            read elcert
>       
>            if elcert-file-status not = '00'
>               display ' bad read on elcert ' elcert-file-status
>               go to 0600-exit
>            end-if
>       
>            if cm-lf-benefit-cd not = '00' and spaces
>               move cm-lf-benefit-cd    to ws-lf-ben-code
>               perform 0400-get-lf-code thru 0400-exit
>            end-if
>            if cm-ah-benefit-cd not = '00' and spaces
>               move cm-ah-benefit-cd    to ws-ah-ben-code
>               perform 0410-get-ah-code thru 0410-exit
>            end-if
>       
>            .
>        0600-exit.
>            exit.
> 
> 082718 0650-set-last-name.
> 082718
> 082718     move ws-name-in             to ws-name-out
> 082718     perform varying n1 from +13 by -1 until n1 < +3
> 082718        if (ws-name-in (n1:3) = ' SR' or ' JR' or ' II' or
> 082718           ' IV' or ' VI' or ' I ' or ' V ')
> 082718           or (ws-name-in (n1:4) = ' III')
> 082718           or (ws-name-in (n1:5) = ' IIII')
> 082718           or (ws-name-in (14:2) = ' I')
> 082718           or (ws-name-in (14:2) = ' V')
> 082718           move ws-name-in (1:n1 - 1)
> 082718                                 to ws-name-out
> 082718           move +3               to n1
> 082718        end-if
> 082718     end-perform
> 082718
> 082718     .
> 082718 0650-exit.
> 082718     exit.
> 082718
> 082718 0700-calc-cur-pb-ages.
> 082718
> 082718     move zeros                  to ws-pb-pri-curr-age
> 082718                                    ws-pb-cob-curr-age
> 082718     if (pb-i-age not numeric)
> 082718               or
> 082718        (pb-i-age = zeros)
> 082718        move 42                  to pb-i-age
> 082718     end-if
> 082718
> 082718     move pb-i-age               to ws-pb-pri-curr-age
> 082718
> 082718     if pb-i-birthday <> low-values
> 082718        move pb-i-birthday       to dc-bin-date-1
> 082718        move ws-current-bin-dt   to dc-bin-date-2
> 082718        move '1'                 to dc-option-code
> 082718        perform 8500-DATE-CONVERT
> 082718                                 thru 8500-exit
> 082718        if no-conversion-error
> 082718           compute ws-work-age = dc-elapsed-months / 12
> 082718           move ws-work-age      to ws-pb-pri-curr-age
> 082718           go to 0700-joint-stuff
> 082718        end-if
> 082718     end-if
> 082718
> 082718     move pb-cert-eff-dt         to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 8500-DATE-CONVERT   thru 8500-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age = pb-i-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-pb-pri-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0700-joint-stuff.
> 082718
> 082718     if pb-i-joint-last-name = spaces
> 082718        and pb-i-joint-first-name = spaces
> 082718        go to 0700-exit
> 082718     end-if
> 082718
> 082718     if (pb-i-joint-age not numeric)
> 082718        move zeros               to pb-i-joint-age
> 082718     end-if
> 082718
> 082718     move pb-i-joint-age         to ws-pb-cob-curr-age
> 082718
> 082718     if pb-i-joint-birthday <> low-values
> 082718        move pb-i-joint-birthday to dc-bin-date-1
> 082718        move ws-current-bin-dt   to dc-bin-date-2
> 082718        move '1'                 to dc-option-code
> 082718        perform 8500-DATE-CONVERT
> 082718                                 thru 8500-exit
> 082718        if no-conversion-error
> 082718           compute ws-work-age = dc-elapsed-months / 12
> 082718           move ws-work-age      to ws-pb-cob-curr-age
> 082718           go to 0700-exit
> 082718        end-if
> 082718     end-if
> 082718
> 082718     move pb-cert-eff-dt         to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 8500-DATE-CONVERT   thru 8500-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age =
> 082718           pb-i-joint-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-pb-cob-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0700-exit.
> 082718     exit.
> 082718
> 082718 0710-calc-cur-p5-ages.
> 082718
> 082718     move zeros                  to ws-p5-pri-curr-age
> 082718                                    ws-p5-cob-curr-age
> 082718     if (p5-i-age not numeric)
> 082718               or
> 082718        (p5-i-age = zeros)
> 082718        move 42                  to p5-i-age
> 082718     end-if
> 082718
> 082718     move p5-i-age               to ws-p5-pri-curr-age
> 082718
> 082718     if p5-i-birthday <> low-values
> 082718        move p5-i-birthday       to dc-bin-date-1
> 082718        move ws-current-bin-dt   to dc-bin-date-2
> 082718        move '1'                 to dc-option-code
> 082718        perform 8500-DATE-CONVERT
> 082718                                 thru 8500-exit
> 082718        if no-conversion-error
> 082718           compute ws-work-age = dc-elapsed-months / 12
> 082718           move ws-work-age      to ws-p5-pri-curr-age
> 082718           go to 0710-joint-stuff
> 082718        end-if
> 082718     end-if
> 082718
> 082718     move p5-cert-eff-dt         to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 8500-DATE-CONVERT   thru 8500-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age = p5-i-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-p5-pri-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0710-joint-stuff.
> 082718
> 082718     if p5-i-joint-last-name = spaces
> 082718        and p5-i-joint-first-name = spaces
> 082718        go to 0710-exit
> 082718     end-if
> 082718
> 082718     if (p5-i-joint-age not numeric)
> 082718        move zeros               to p5-i-joint-age
> 082718     end-if
> 082718
> 082718     move p5-i-joint-age         to ws-p5-cob-curr-age
> 082718
> 082718     if p5-i-joint-birthday <> low-values
> 082718        move p5-i-joint-birthday to dc-bin-date-1
> 082718        move ws-current-bin-dt   to dc-bin-date-2
> 082718        move '1'                 to dc-option-code
> 082718        perform 8500-DATE-CONVERT
> 082718                                 thru 8500-exit
> 082718        if no-conversion-error
> 082718           compute ws-work-age = dc-elapsed-months / 12
> 082718           move ws-work-age      to ws-p5-cob-curr-age
> 082718           go to 0710-exit
> 082718        end-if
> 082718     end-if
> 082718
> 082718     move p5-cert-eff-dt         to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 8500-DATE-CONVERT   thru 8500-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age =
> 082718           p5-i-joint-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-p5-cob-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0710-exit.
> 082718     exit.
> 082718
> 082718 0720-calc-cur-alph-age.
> 082718
> 082718     move zeros                  to ws-alph-curr-age
> 082718
> 082718     if (af-age not numeric)
> 082718               or
> 082718        (af-age = zeros)
> 082718        move 42                  to af-age
> 082718     end-if
> 082718
> 082718     move af-age                 to ws-alph-curr-age
> 082718
> 082718     move af-dt                  to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 8500-DATE-CONVERT   thru 8500-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age = af-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-alph-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0720-exit.
> 082718     exit.
> 
> 
>        1000-CLOSE-FILES.
763c1235
<            CLOSE ERPNDB2 ERALPH2 ERPNDB5 ELMSTR5
---
>            CLOSE ERPNDB2 ERALPH2 ERPNDB5 ELCERT
766c1238
<        0500-EXIT.
---
>        1000-EXIT.

</pre>
<h3><a name="ELAGGO.cl2">ELAGGO.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

37a38
> 082718* 082718 CR2018082400001   PEMA  Incorp pri & co borw current age
43d43
< 
46c46
<        77  FILLER  PIC X(32) VALUE '   PRGMTBD  WORKING STORAGE     '.
---
> 082718 77  FILLER  PIC X(32) VALUE '   ELAGGO   WORKING STORAGE     '.
56a57,58
> 082718 77  WS-COMP-CD                  PIC X  VALUE LOW-VALUES.
> 082718 77  WS-COMP-ID                  PIC XXX VALUE 'CID'.
61a64
> 082718 77  n1                          pic s999 value +0 comp-3.
76a80,87
> 082718 77  save-bin-date               pic xx value low-values.           
> 082718 77  ws-current-bin-dt           pic xx value low-values.
> 082718 77  ws-work-age                 pic s999 comp-3 value zeros.
> 082718 77  ws-pb-pri-curr-age          pic s999 comp-3 value +0.
> 082718 77  ws-pb-cob-curr-age          pic s999 comp-3 value +0.
> 082718 77  ws-p5-pri-curr-age          pic s999 comp-3 value +0.
> 082718 77  ws-p5-cob-curr-age          pic s999 comp-3 value +0.
> 082718 77  ws-alph-curr-age            pic s999 comp-3 value +0.
106a118,122
> 082718 01  ws-alpha-last-name          pic x(15) value spaces.
> 082718 01  ws-p5-last-name             pic x(15) value spaces.
> 082718 01  ws-p5-jnt-last-name         pic x(15) value spaces.
> 082718 01  ws-name-in                  pic x(15) value spaces.
> 082718 01  ws-name-out                 pic x(15) value spaces.
125a142,153
> 082718     05  ws-lf-ben-code          pic xx.
> 082718     05  ws-ah-ben-code          pic xx.
> 082718     05  ws-lf-calc-cd           pic x   value spaces.
> 082718     05  ws-lf-coverage-type     pic x   value spaces.
> 082718     05  ws-lf-earnings-calc     pic x   value spaces.
> 082718     05  ws-lf-kind              pic x   value spaces.
> 082718     05  ws-lf-ben-descrip       pic x(10) value spaces.
> 082718     05  ws-ah-calc-cd           pic x   value spaces.
> 082718     05  ws-ah-coverage-type     pic x   value spaces.
> 082718     05  ws-ah-earnings-calc     pic x   value spaces.
> 082718     05  ws-ah-kind              pic x   value spaces.
> 082718     05  ws-ah-ben-descrip       pic x(10) value spaces.
135a164,172
> 082718 01  ws-elcert-key.
> 082718     05  ws-elcert-company-cd   pic x.
> 082718     05  ws-elcert-carrier      pic x.
> 082718     05  ws-elcert-grouping     pic x(6).
> 082718     05  ws-elcert-state        pic xx.
> 082718     05  ws-elcert-account      pic x(10).
> 082718     05  ws-elcert-eff-dt       pic xx.
> 082718     05  ws-elcert-cert-no      pic x(11).
> 
182c219
<        01  ws-pass-to-pemaggo.
---
> 082718 01  ws-pass-to-elaggo.
186a224
> 082718                                 copy ELCCALC.
193a232
> 082718                                 COPY ELCCERT.
203,204c242,243
<       *    display ' Entering PEMAGGO '
<            move dfhcommarea            to ws-pass-to-pemaggo
---
>       *    display ' Entering ELAGGO  '
>            move dfhcommarea            to ws-pass-to-elaggo
211c250
<            move ws-pass-to-pemaggo     to dfhcommarea
---
>            move ws-pass-to-elaggo      to dfhcommarea
215d253
< 
222d259
<       *    PERFORM 0030-START-ERPNDB   THRU 0030-EXIT
224d260
<       *    if not end-of-erpndb
229,230c265,279
<       *    PERFORM 0040-READ-ERPNDB    THRU 0040-EXIT
<       *    end-if
---
> 082718     exec cics
> 082718        asktime
> 082718     end-exec
> 082718
> 082718     MOVE EIBDATE                TO DC-JULIAN-YYDDD
> 082718     MOVE '5'                    TO DC-OPTION-CODE
> 082718     perform 9700-date-convert   thru 9700-exit
> 082718
> 082718     IF DATE-CONVERSION-ERROR
> 082718        display ' error converting eibdate '
> 082718        MOVE LOW-VALUES          TO save-bin-date
> 082718     ELSE
> 082718        MOVE DC-BIN-DATE-1       TO save-bin-date
> 082718                                    ws-current-bin-dt
> 082718     end-if
236,300d284
<        0030-START-ERPNDB.
< 
<            exec cics startbr
<               dataset      ('ERPNDB2')
<               ridfld       (ws-erpndb-key)
<               gteq
<               resp         (ws-response)
<            end-exec
< 
<            if resp-endfile or resp-notfnd
<               display ' end of file on start ' 
<               set end-of-erpndb        to true
<            else
<               if not resp-normal
<                  DISPLAY ' ERROR ON ERPNDB - START  '
<                     ERPNDB-FILE-STATUS
<                  set end-of-erpndb     to true
<               end-if
<            end-if
< 
<            .
<        0030-EXIT.
<            EXIT.
< 
<        0040-READ-ERPNDB.
< 
<       **    exec cics readnext
<       **       dataset     ('ERPNDB2')
<       **       into        (pending-business)
<       **       ridfld      (ws-erpndb-key)
<       **       resp        (ws-response)
<       **    end-exec
<       *
<       *     display ' about to read erpndb initial '
<       *     move pb-control-by-account  to ws-erpndb-key
<       *     exec cics read
<       *        dataset     ('ERPNDB2')
<       *        into        (pending-business)
<       *        ridfld      (ws-erpndb-key)
<       *        resp        (ws-response)
<       *     end-exec
<       *
<       *     if (resp-endfile)
<       **       or (resp-notfnd)
<       *        or (ws-erpndb-key <> ws-passed-pend-key)
<       *        display ' did not find pending issue '
<       *           ws-passed-pend-key (2:19) ' '
<       *           ws-passed-pend-key (23:11) ' '
<       *           ws-passed-pend-key (36:1)
<       *        display ' key ' ws-erpndb-key (2:19) ' '
<       *           ws-erpndb-key (23:11) ' '
<       *           ws-erpndb-key (36:1)
<       *        set end-of-erpndb        to true
<       *     else
<       *        if not resp-normal
<       *           DISPLAY ' ERROR ON ERPNDB - READ  '
<       *              ws-response
<       *           set end-of-erpndb     to true
<       *        end-if
<       *     end-if
< 
<            .
<        0040-EXIT.
<            EXIT.
< 
303,357c287,302
<            move spaces                 to lf-joint-ind ah-joint-ind
<            if pb-i-lf-benefit-cd = '00' or '  '
<               go to 0045-check-ah
<            end-if
<            move pb-company-id          to ws-elcntl-key
<            set ws-elcntl-lf-ben-cd     to true
<            move pb-i-lf-benefit-cd     to ws-elcntl-hi-ben-cd
<            move zeros                  to ws-elcntl-seq-no
< 
<            exec cics read
<               dataset     ('ELCNTL')
<               into        (control-file)
<               ridfld      (ws-elcntl-key)
<               gteq
<               resp        (ws-response)
<            end-exec
< 
<            if resp-normal
<               perform varying c1 from +1 by +1 until
<                  (c1 > +8)
<                  or (cf-benefit-code (c1) = pb-i-lf-benefit-cd)
<               end-perform
<               if c1 < +9
<                  move cf-joint-indicator (c1) to lf-joint-ind
<               end-if
<            end-if
< 
<            .
<        0045-check-ah.
< 
<            if pb-i-ah-benefit-cd = '00' or '  '
<               go to 0045-exit
<            end-if
< 
<            move pb-company-id          to ws-elcntl-key
<            set ws-elcntl-ah-ben-cd     to true
<            move pb-i-ah-benefit-cd     to ws-elcntl-hi-ben-cd
<            move zeros                  to ws-elcntl-seq-no
< 
<            exec cics read
<               dataset     ('ELCNTL')
<               into        (control-file)
<               ridfld      (ws-elcntl-key)
<               gteq
<               resp        (ws-response)
<            end-exec
< 
<            if resp-normal
<               perform varying c1 from +1 by +1 until
<                  (c1 > +8)
<                  or (cf-benefit-code (c1) = pb-i-ah-benefit-cd)
<               end-perform
<               if c1 < +9
<                  move cf-joint-indicator (c1) to ah-joint-ind
<               end-if
---
> 082718     if pb-i-lf-benefit-cd not = '00' and spaces
> 082718        move pb-i-lf-benefit-cd   to ws-lf-ben-code
> 082718        perform 0400-get-lf-code thru 0400-exit
> 082718        if c1 < +9
> 082718           move cf-joint-indicator (c1)
> 082718                                 to lf-joint-ind
> 082718        end-if
> 082718     end-if
> 082718     if pb-i-ah-benefit-cd not = '00' and spaces
> 082718        move pb-i-ah-benefit-cd   to ws-ah-ben-code
> 082718        perform 0410-get-ah-code thru 0410-exit
> 082718        if c1 < +9
> 082718           move cf-joint-indicator (c1)
> 082718                                 to ah-joint-ind
> 082718        end-if
> 082718     end-if
368a314,315
>               move +0                  to a1
>               move spaces              to ws-alpha-table
370,372c317,323
<               move pb-i-age            to ws-age
<               MOVE PB-i-insured-last-name
<                                        to ws-last-name
---
>       *       MOVE PB-i-insured-last-name
>       *                                to ws-last-name
> 082718        move pb-i-insured-last-name
> 082718                                 to ws-name-in
> 082718        perform 0650-set-last-name
> 082718                                 thru 0650-exit
> 082718        move ws-name-out         to ws-last-name
374a326,332
> 082718        perform 0700-calc-cur-pb-ages
> 082718                                 thru 0700-exit
>       *       display ' key info ' pb-account ' ' ws-last-name ' '
>       *          ws-first-three
>       *       display ' pri curr age ' ws-pb-pri-curr-age
>       *       display ' cob curr age ' ws-pb-cob-curr-age
> 082718        move ws-pb-pri-curr-age  to ws-age
377,378c335,338
<               if (lf-joint-ind = 'J')
<                  or (ah-joint-ind = 'J')
---
>               if ((lf-joint-ind = 'J')
>                  or (ah-joint-ind = 'J'))
>                     and
>                  (pb-i-joint-last-name not = spaces)
380a341
>                  move ' '              to WS-ERPNDB5-SW
382,384c343,350
<                  move pb-i-joint-age   to ws-age
<                  move pb-i-joint-last-name
<                                        to ws-last-name
---
>       *          move pb-i-joint-last-name
>       *                                to ws-last-name
> 082718           move pb-i-joint-last-name
> 082718                                 to ws-name-in
> 082718           perform 0650-set-last-name
> 082718                                 thru 0650-exit
> 082718           move ws-name-out      to ws-last-name
>                                        
386a353,354
> 082718           move ws-pb-cob-curr-age
> 082718                                 to ws-age
390d357
<               
399c366
<       *** check to see if there is a pending cancel for the issue **
---
>       *** check to see if the pending issue is cancelled
401,409c368,370
<            move ws-erpndb-key          to ws-erpndb5-key
<            move +0                     to ws-erpndb5-seq-no
<            move '2'                    to ws-erpndb5-rec-type
<            exec cics read
<               dataset       ('ERPNDB2')
<               ridfld        (ws-erpndb5-key)
<               into          (p5-pending-business)
<               resp          (ws-response)
<            end-exec
---
> 082718     move pb-control-by-account (1:33)
> 082718                                 to ws-elcert-key
> 082718     perform 0600-get-elcert     thru 0600-exit
412,414c373,375
<               if p5-ci-lf-benefit-cd not = '00' and '  '
<                  if p5-c-lf-cancel-dt <> low-values
<                     move '00'             to pb-i-lf-benefit-cd
---
> 082718        if cm-lf-benefit-cd <> '00' and '  '
> 082718           if cm-lf-cancel-dt <> low-values
> 082718              move '00'          to pb-i-lf-benefit-cd
417,419c378,380
<               if p5-ci-ah-benefit-cd not = '00' and '  '
<                  if p5-c-ah-cancel-dt <> low-values
<                     move '00'             to pb-i-ah-benefit-cd
---
> 082718        if cm-ah-benefit-cd <> '00' and '  '
> 082718           if cm-ah-cancel-dt <> low-values
> 082718              move '00'          to pb-i-ah-benefit-cd
423a385,407
>       *    move ws-erpndb-key          to ws-erpndb5-key
>       *    move +0                     to ws-erpndb5-seq-no
>       *    move '2'                    to ws-erpndb5-rec-type
>       *    exec cics read
>       *       dataset       ('ERPNDB2')
>       *       ridfld        (ws-erpndb5-key)
>       *       into          (p5-pending-business)
>       *       resp          (ws-response)
>       *    end-exec
>       *
>       *    if resp-normal
>       *       if p5-ci-lf-benefit-cd not = '00' and '  '
>       *          if p5-c-lf-cancel-dt <> low-values
>       *             move '00'             to pb-i-lf-benefit-cd
>       *          end-if
>       *       end-if
>       *       if p5-ci-ah-benefit-cd not = '00' and '  '
>       *          if p5-c-ah-cancel-dt <> low-values
>       *             move '00'             to pb-i-ah-benefit-cd
>       *          end-if
>       *       end-if
>       *    end-if
> 
430,432c414,421
<       ****  this reads 
<            move +1                     to a1
<            move spaces                 to ws-alpha-table
---
>       ****=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
>       ****                                                           ***
>       ****     All we are doing below is setting up the Pending      ***
>       ****     issue from review and corrections.                    ***
>       ****                                                           ***
>       ****                                                           ***
>       ****                                                           ***
>       ****=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
434c423
<               move ' ' to ws-eralph-sw
---
>            move ' '                    to ws-eralph-sw
441,442c430
< 
<            move ws-age                 to ws-age-from-pndb
---
>            add +1                      to a1
445d432
<            move pb-i-lf-benefit-cd     to ws-eralph-lf-cd (a1)
447,465c434,483
<            if ((ws-cov-sw = 'S')
<               and (lf-joint-ind = 'J'))
<                      or
<               (ws-cov-sw = 'P')
<               compute ws-eralph-lf-remamt (a1) =
<                  pb-i-lf-benefit-amt + pb-i-lf-alt-benefit-amt
<               move ws-eralph-lf-remamt (a1)
<                                        to ws-lf-tot-benefit
<            end-if
<            move pb-i-ah-benefit-cd     to ws-eralph-ah-cd (a1)
<            if ((ws-cov-sw = 'S')
<               and (ah-joint-ind = 'J'))
<                      or
<               (ws-cov-sw = 'P')
<               move pb-i-ah-benefit-amt    to ws-eralph-ah-amt (a1)
<               compute ws-eralph-ah-remamt (a1) =
<                  pb-i-ah-term * pb-i-ah-benefit-amt
<               move ws-eralph-ah-amt (a1)  to ws-ah-tot-benefit
<            end-if
---
>            move pb-control-by-account (1:33)
>                                        to ws-elcert-key
> 010517     perform 0600-get-elcert     thru 0600-exit
> 
>            move zeros                  to ws-eralph-lf-remamt (a1)
>                                           ws-eralph-ah-amt (a1)
>                                           ws-eralph-ah-remamt (a1)
> 
> 
> 082718     if pb-i-lf-benefit-cd <> '00' and '  '
> 082718        if (processing-primary)
> 082718                    or
> 082718           ((processing-secondary)
> 082718           and (lf-joint-ind = 'J'))
> 082718           move pb-i-lf-benefit-cd
> 082718                                 to ws-eralph-lf-cd (a1)
> 082718           perform 0500-get-lf-rem
> 082718                                 thru 0500-exit
> 082718           move cp-remaining-amt to ws-eralph-lf-remamt (a1)
> 082718           move ws-eralph-lf-remamt (a1)
> 082718                                 to ws-lf-tot-benefit
> 082718        end-if
> 082718     end-if
> 
> 082718     if pb-i-ah-benefit-cd <> '00' and '  '
> 082718        if (processing-primary)
> 082718                    or
> 082718           ((processing-secondary)
> 082718           and (ah-joint-ind = 'J'))
> 082718           move pb-i-ah-benefit-cd
> 082718                                 to ws-eralph-ah-cd (a1)
> 082718           perform 0510-get-ah-rem
> 082718                                 thru 0510-exit
> 082718           move cp-remaining-amt to ws-eralph-ah-remamt (a1)
> 082718           move ws-eralph-ah-remamt (a1)
> 082718                                 to ws-ah-tot-benefit
> 082718           move cm-ah-benefit-amt
> 082718                                 to ws-eralph-ah-amt (a1)
> 082718        end-if
> 082718     end-if
> 
>       ****=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
>       ****    0170-ERPNDB5 reads thru all the erpndb issues records  ***
>       ****    and looks for a match on the account number, last      ***
>       ****    name and the 1st 3 characters of the first name and    ***
>       ****    the age as of today to be within 4 years of this one   ***
>       ****                                                           ***
>       ****                                                           ***
>       ****                                                           ***
>       ****=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=***
498a517
>            set eralph2-startbr to true
508c527
<               or (af-lname       not = ws-last-name)
---
> 082718        or (ws-alpha-last-name not = ws-last-name)
519c538,546
<            if a1 > +1
---
> 
>            if ((ws-cov-sw = 'P')
>               and (a1 > +1))
>                    or
>               ((ws-cov-sw = 'S')
>               and (a1 > +2))
> 
> 
>       *    if a1 > +1
568a596,597
>       *          display ' tot lf ben ' pt-lf-tot-benefit
>       *          display ' tot ah ben ' pt-ah-tot-benefit
585,592c614,635
<            if (not resp-normal and not resp-dupkey)
<               or (pb-company-cd not = ws-eralph-aix-company-cd)
<               or (pb-account not = ws-eralph-aix-account)
<               or (ws-last-name not = ws-eralph-aix-lname)
< 092215        or (ws-first-three not = ws-eralph-aix-1st-three)
<               set end-of-eralph to true
<               exec cics endbr dataset    ('ERALPH2') end-exec
<            end-if
---
> 082718     if (not resp-normal)
> 082718        and (not resp-dupkey)
> 082718        set end-of-eralph to true
> 082718        go to 0155-exit
> 082718     end-if
> 
> 082718     if (pb-company-cd = ws-eralph-aix-company-cd)
> 082718        and (pb-account = ws-eralph-aix-account)
> 082718        continue
> 082718     else
> 082718        set end-of-eralph to true
> 082718        go to 0155-exit
> 082718     end-if
> 
> 082718     move af-lname               to ws-name-in
> 082718     perform 0650-set-last-name  thru 0650-exit
> 082718     move ws-name-out            to ws-alpha-last-name
> 082718
> 082718     if (ws-last-name not = ws-alpha-last-name)
> 082718        or (ws-first-three not = ws-eralph-aix-1st-three)
> 082718        set end-of-eralph to true
> 082718     end-if
600c643
<       *** check to see if there is a pending cancel for the alpha rec **
---
>       *** check to see if the alpha record is cancelled
603,611c646,651
<            move af-control-primary     to ws-erpndb5-key
<            move +0                     to ws-erpndb5-seq-no
<            move '2'                    to ws-erpndb5-rec-type
<            exec cics read
<               dataset       ('ERPNDB2')
<               ridfld        (ws-erpndb5-key)
<               into          (p5-pending-business)
<               resp          (ws-response)
<            end-exec
---
> 082718     if pb-control-by-account (1:33) = af-control-primary(1:33)
> 082718        go to 0160-continue
> 082718     end-if
> 082718
> 082718     move af-control-primary     to ws-elcert-key
> 082718     perform 0600-get-elcert     thru 0600-exit
614,617c654,655
<               if p5-ci-lf-benefit-cd not = '00' and '  '
<                  if p5-c-lf-cancel-dt <> low-values
<       *             display ' found lf alpha cancel ' af-account
<       *                ' ' af-cert-no
---
> 082718        if cm-lf-benefit-cd not = '00' and '  '
> 082718           if cm-lf-cancel-dt <> low-values
621,624c659,660
<               if p5-ci-ah-benefit-cd not = '00' and '  '
<                  if p5-c-ah-cancel-dt <> low-values
<       *             display ' found ah alpha cancel ' af-account
<       *                ' ' af-cert-no
---
> 082718        if cm-ah-benefit-cd not = '00' and '  '
> 082718           if cm-ah-cancel-dt <> low-values
627a664,665
>            else
>               go to 0160-continue
630,632c668,670
< 033116     if (af-lf-typ not = '00' and '  ')
< 033116        or (af-ah-typ not = '00' and '  ')
<               add +1 to a1
---
> 082718     if (af-lf-typ = '00' or spaces)
> 082718        and (af-ah-typ = '00' or spaces)
>               go to 0160-continue
633a672,687
> 
> 082718     perform 0720-calc-cur-alph-age
> 082718                                 thru 0720-exit
> 
>            if ws-age - ws-alph-curr-age < 4 and > -4
>               continue
>            else
>               go to 0160-continue
>            end-if
> 
>            if af-lf-remamt = zeros
>               and af-ah-remamt = zeros
>               go to 0160-continue
>            end-if
> 
>            add +1 to a1
637c691,692
<               move af-lf-remamt        to ws-eralph-lf-remamt (a1)
---
> 010517        perform 0500-get-lf-rem  thru 0500-exit
> 010517        move cp-remaining-amt    to ws-eralph-lf-remamt (a1)
639c694,696
<                  ws-lf-tot-benefit + af-lf-remamt + af-lf-remamt-alt
---
>                  ws-lf-tot-benefit + ws-eralph-lf-remamt (a1)
>       *          display ' lf rem amt ' ws-eralph-lf-remamt (a1) ' '
>       *             ws-lf-tot-benefit ' ' a1
645,650c702,711
<               move af-ah-amt           to ws-eralph-ah-amt (a1)
<               move af-ah-remamt        to ws-eralph-ah-remamt (a1)
<               compute ws-ah-tot-benefit =
<                  ws-ah-tot-benefit + af-ah-amt
<       *       perform 0165-check-for-ah-claim
<       *                                thru 0165-exit
---
>               if af-ah-status <> '8'
>                  move af-ah-amt        to ws-eralph-ah-amt (a1)
> 010517           perform 0510-get-ah-rem
> 010517                                 thru 0510-exit
> 010517           move cp-remaining-amt to ws-eralph-ah-remamt (a1)
>                  compute ws-ah-tot-benefit =
> 010517              ws-ah-tot-benefit + cp-remaining-amt
>       *          display ' ah rem amt ' ws-eralph-ah-remamt (a1) ' '
>       *             ws-ah-tot-benefit ' ' a1
>               end-if
662a724
>       **** this para not being executed only needed on socket call.
779,780d840
<       *    display ' made it to 0175 '
< 
808,857c868,968
<            if pb-control-by-account = p5-control-by-account
<               display ' found my equal '
<               continue
<            else
<               if (p5-control-by-account (1:33) =
<                             ws-save-issue-key (1:33))
<                  and (p5-record-type = '2')
<                  display ' found cancelled accum pend '
<                  move spaces           to ws-save-issue-key
<                  if p5-ci-lf-benefit-cd not = '00' and '  '
<                     if p5-c-lf-cancel-dt <> low-values
<       *                display ' found lf accum cancel ' p5-account
<       *                   ' ' p5-cert-no
<                        move '00'             to ws-eralph-lf-cd (a1)
<                     end-if
<                  end-if
<                  if p5-ci-ah-benefit-cd not = '00' and '  '
<                     if p5-c-ah-cancel-dt <> low-values
<       *                display ' found ah accum cancel ' p5-account
<       *                   ' ' p5-cert-no
<                        move '00'             to ws-eralph-ah-cd (a1)
<                     end-if
<                  end-if
<               end-if
<               if ((p5-i-insured-last-name = ws-last-name)
< 092215            and (p5-i-insured-first-name (1:3) = ws-first-three)
<                   and (p5-record-type = '1'))
<                               or
<                   ((p5-i-joint-last-name = ws-last-name)
< 092215            and (p5-i-joint-first-name (1:3) = ws-first-three)
<                   and (p5-record-type = '1'))
<                  add +1 to a1
<                  move p5-control-by-account to ws-save-issue-key
<                  move p5-cert-no       to ws-eralph-cert  (a1)
<                  move p5-i-lf-benefit-cd
<                                        to ws-eralph-lf-cd (a1)
<                  move p5-i-lf-benefit-amt
<                                        to ws-eralph-lf-remamt (a1)
<                  compute ws-lf-tot-benefit = ws-lf-tot-benefit +
<                     p5-i-lf-benefit-amt + p5-i-lf-alt-benefit-amt
<                  move p5-i-ah-benefit-cd
<                                        to ws-eralph-ah-cd (a1)
<                  move p5-i-ah-benefit-amt
<                                        to ws-eralph-ah-amt (a1)
<                  compute ws-ah-tot-benefit =
<                     ws-ah-tot-benefit + p5-i-ah-benefit-amt
<                  compute ws-eralph-ah-remamt (a1) =
<                     p5-i-ah-term * p5-i-ah-benefit-amt
<               end-if
<            end-if
---
> 082718     if (pb-control-by-account = p5-control-by-account)
> 082718        or (p5-record-type <> '1')
> 082718        go to 0180-read  *> I found myself or a batch or cancel record
> 082718     end-if
> 
> 082718     move p5-control-by-account (1:33)
> 082718                                 to ws-elcert-key
> 082718     perform 0600-get-elcert     thru 0600-exit
> 082718
> 082718     if (cm-lf-benefit-cd <> '00' and spaces)
> 082718        and (cm-lf-cancel-dt <> low-values)
> 082718        move '00'                to p5-i-lf-benefit-cd
> 082718     end-if
> 082718     if (cm-ah-benefit-cd <> '00' and spaces)
> 082718        and (cm-ah-cancel-dt <> low-values)
> 082718        move '00'                to p5-i-ah-benefit-cd
> 082718     end-if
> 082718     if ((p5-i-lf-benefit-cd = '00' or spaces)
> 082718        and (p5-i-ah-benefit-cd = '00' or spaces))
> 082718                 or
> 082718        (p5-i-entry-status = '5' or '9' or
> 082718                          'D' or 'V')                 
> 082718        go to 0180-read   *>  Must be cancelled or something
> 082718     end-if
> 082718
> 082718     move p5-i-insured-last-name to ws-name-in
> 082718     perform 0650-set-last-name  thru 0650-exit
> 082718     move ws-name-out            to ws-p5-last-name
> 082718     move p5-i-joint-last-name   to ws-name-in
> 082718     perform 0650-set-last-name  thru 0650-exit
> 082718     move ws-name-out            to ws-p5-jnt-last-name
> 
>            if ((ws-last-name = ws-p5-last-name)
> 092215        and (ws-first-three = p5-i-insured-first-name (1:3)))
>                           or
>               ((ws-last-name = ws-p5-jnt-last-name)
> 092215        and (ws-first-three = p5-i-joint-first-name (1:3)))
> 082718        perform 0710-calc-cur-p5-ages
> 082718                                 thru 0710-exit
>            end-if
> 
> 082718     if ((ws-last-name = ws-p5-last-name)
> 082718        and (ws-first-three = p5-i-insured-first-name (1:3)))
> 082718        and  (ws-age - ws-p5-pri-curr-age < 4 and > -4)
> 082718        add +1 to a1
> 082718        move p5-cert-no          to ws-eralph-cert  (a1)
> 082718        if (p5-i-lf-benefit-cd <> '  ' and '00')
> 082718           move p5-i-lf-benefit-cd
> 082718                                 to ws-eralph-lf-cd (a1)
> 082718           perform 0500-get-lf-rem
> 082718                                 thru 0500-exit
> 082718           move cp-remaining-amt to ws-eralph-lf-remamt (a1)
> 082718           compute ws-lf-tot-benefit =
> 082718              ws-lf-tot-benefit + cp-remaining-amt
> 082718        end-if
> 082718        if p5-i-ah-benefit-cd <> '  ' and '00'
> 082718           move p5-i-ah-benefit-cd
> 082718                              to ws-eralph-ah-cd (a1)
> 082718           perform 0510-get-ah-rem
> 082718                              thru 0510-exit
> 082718           move cp-remaining-amt
> 082718                              to ws-eralph-ah-remamt (a1)
> 082718           compute ws-ah-tot-benefit =
> 082718              ws-ah-tot-benefit + cp-remaining-amt
> 082718           move p5-i-ah-benefit-amt to ws-eralph-ah-amt (a1)
> 082718        end-if
> 082718        go to 0180-read  *> They can't possibly be pri & cob
> 082718     end-if
> 
> 082718     if ((ws-last-name = ws-p5-jnt-last-name)
> 082718        and (ws-first-three =
> 082718                       p5-i-joint-first-name (1:3)))
> 082718        and  (ws-age - ws-p5-cob-curr-age < 4 and > -4)
> 082718        add +1 to a1
> 082718        move p5-control-by-account to ws-save-issue-key
> 082718        move p5-cert-no       to ws-eralph-cert  (a1)
> 082718        if p5-i-lf-benefit-cd <> '  ' and '00'
> 082718           move p5-i-lf-benefit-cd
> 082718                              to ws-eralph-lf-cd (a1)
> 082718           perform 0500-get-lf-rem
> 082718                              thru 0500-exit
> 082718           move cp-remaining-amt
> 082718                              to ws-eralph-lf-remamt (a1)
> 082718           compute ws-lf-tot-benefit =
> 082718              ws-lf-tot-benefit + cp-remaining-amt
> 082718        end-if
> 082718        if p5-i-ah-benefit-cd <> '  ' and '00'
> 082718           move p5-i-ah-benefit-cd
> 082718                              to ws-eralph-ah-cd (a1)
> 082718           perform 0510-get-ah-rem
> 082718                              thru 0510-exit
> 082718           move cp-remaining-amt
> 082718                              to ws-eralph-ah-remamt (a1)
> 082718           compute ws-ah-tot-benefit =
> 082718              ws-ah-tot-benefit + cp-remaining-amt
> 082718           move p5-i-ah-benefit-amt to ws-eralph-ah-amt (a1)
> 082718        end-if
> 082718     end-if
> 
> 082718     .
> 082718 0180-read.
864a976,1350
> 082718 0400-get-lf-code.
> 082718
> 082718     move ws-comp-id             to ws-elcntl-key
> 082718     set ws-elcntl-lf-ben-cd     to true
> 082718     move ws-lf-ben-code         to ws-elcntl-hi-ben-cd
> 082718     move zeros                  to ws-elcntl-seq-no
> 082718
> 082718     exec cics read
> 082718        dataset     ('ELCNTL')
> 082718        into        (control-file)
> 082718        ridfld      (ws-elcntl-key)
> 082718        gteq
> 082718        resp        (ws-response)
> 082718     end-exec
> 082718
> 082718     if resp-normal
> 082718        perform varying c1 from +1 by +1 until
> 082718           (c1 > +8)
> 082718           or (cf-benefit-code (c1) = ws-lf-ben-code)
> 082718        end-perform
> 082718
> 082718        if c1 < +9
> 082718           MOVE CF-BENEFIT-ALPHA (c1)
> 082718                                 TO WS-lf-KIND
> 082718           MOVE CF-SPECIAL-CALC-CD (c1)
> 082718                                 TO WS-lf-CALC-CD
> 082718           MOVE CF-BENEFIT-DESCRIP (c1)
> 082718                                 TO WS-lf-BEN-DESCRIP
> 082718           MOVE CF-LF-COVERAGE-TYPE (c1)
> 082718                                 TO WS-LF-COVERAGE-TYPE
> 082718           MOVE CF-CO-EARNINGS-CALC (c1)
> 082718                                 TO WS-lf-EARNINGS-CALC
> 082718        end-if
> 082718     end-if
> 082718
> 082718     .
> 082718 0400-exit.
> 082718     exit.
> 082718
> 082718 0410-get-ah-code.
> 082718
> 082718     move ws-comp-id             to ws-elcntl-key
> 082718     set ws-elcntl-ah-ben-cd     to true
> 082718     move ws-ah-ben-code         to ws-elcntl-hi-ben-cd
> 082718     move zeros                  to ws-elcntl-seq-no
> 082718
> 082718     exec cics read
> 082718        dataset     ('ELCNTL')
> 082718        into        (control-file)
> 082718        ridfld      (ws-elcntl-key)
> 082718        gteq
> 082718        resp        (ws-response)
> 082718     end-exec
> 082718
> 082718     if resp-normal
> 082718        perform varying c1 from +1 by +1 until
> 082718           (c1 > +8)
> 082718           or (cf-benefit-code (c1) = ws-ah-ben-code)
> 082718        end-perform
> 082718        if c1 < +9
> 082718           MOVE CF-BENEFIT-ALPHA (c1)
> 082718                                 TO WS-ah-KIND
> 082718           MOVE CF-SPECIAL-CALC-CD (c1)
> 082718                                 TO WS-ah-CALC-CD
> 082718           MOVE CF-BENEFIT-DESCRIP (c1)
> 082718                                 TO WS-ah-BEN-DESCRIP
> 082718           MOVE CF-LF-COVERAGE-TYPE (c1)
> 082718                                 TO WS-ah-COVERAGE-TYPE
> 082718           MOVE CF-CO-EARNINGS-CALC (c1)
> 082718                                 TO WS-ah-EARNINGS-CALC
> 082718        end-if
> 082718     .
> 082718 0410-exit.
> 082718     exit.
> 082718
> 082718 0500-get-lf-rem.
> 082718
> 082718     MOVE '2'                    TO CP-PROCESS-TYPE
> 082718     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
> 082718     MOVE WS-lf-EARNINGS-CALC    TO CP-EARNING-METHOD
> 082718                                    CP-RATING-METHOD
> 082718     MOVE WS-lf-CALC-CD          TO CP-SPECIAL-CALC-CD
> 082718     MOVE cm-cert-eff-dt         TO CP-CERT-EFF-DT
> 082718     MOVE cm-loan-1st-pmt-dt     TO CP-FIRST-PAY-DATE
> 082718     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT
> 082718     IF cm-lf-orig-term = 0
> 082718        MOVE 1                   TO CP-ORIGINAL-TERM
> 082718     ELSE
> 082718        MOVE cm-lf-orig-term     TO CP-ORIGINAL-TERM
> 082718     end-if
> 082718     MOVE cm-loan-term           TO CP-LOAN-TERM
> 082718     MOVE '1'                    TO CP-REM-TRM-CALC-OPTION
> 082718     MOVE '4'                    TO CP-REM-TERM-METHOD
> 082718     MOVE ws-comp-id             TO CP-COMPANY-ID
> 082718     MOVE ws-comp-cd             TO CP-COMPANY-CD
> 082718
> 082718     PERFORM 9800-LINK-REM-TERM  thru 9800-exit
> 082718
> 082718     MOVE cm-lf-benefit-amt      TO CP-ORIGINAL-BENEFIT
> 082718                                    CP-RATING-BENEFIT-AMT
> 082718     MOVE cm-lf-premium-amt      TO CP-ORIGINAL-PREMIUM
> 082718     MOVE cm-lf-alt-benefit-amt  TO CP-ALTERNATE-BENEFIT
> 082718     MOVE cm-lf-alt-premium-amt  TO CP-ALTERNATE-PREMIUM
> 082718     MOVE cm-loan-apr            TO CP-LOAN-APR
> 082718     MOVE cm-pay-frequency       TO CP-PAY-FREQUENCY
> 082718
> 082718     MOVE cm-rate-class          TO CP-CLASS-CODE
> 082718     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
> 082718     perform 9500-link-rem-amt   thru 9500-exit
> 082718
> 082718     .
> 082718 0500-exit.
> 082718     exit.
> 082718
> 082718 0510-get-ah-rem.
> 082718
> 082718     MOVE '2'                    TO CP-PROCESS-TYPE
> 082718     MOVE WS-ah-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
> 082718     MOVE WS-ah-EARNINGS-CALC    TO CP-EARNING-METHOD
> 082718                                    CP-RATING-METHOD
> 082718     MOVE WS-ah-CALC-CD          TO CP-SPECIAL-CALC-CD
> 082718     MOVE cm-cert-eff-dt         TO CP-CERT-EFF-DT
> 082718     MOVE cm-loan-1st-pmt-dt     TO CP-FIRST-PAY-DATE
> 082718     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT
> 082718     MOVE cm-ah-orig-term        TO CP-ORIGINAL-TERM
> 082718     MOVE cm-loan-term           TO CP-LOAN-TERM
> 082718     MOVE '1'                    TO CP-REM-TRM-CALC-OPTION
> 082718     MOVE '4'                    TO CP-REM-TERM-METHOD
> 082718     MOVE ws-comp-id             TO CP-COMPANY-ID
> 082718     MOVE ws-comp-cd             TO CP-COMPANY-CD
> 082718
> 082718     PERFORM 9800-LINK-REM-TERM  thru 9800-exit
> 082718
> 082718     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
> 082718     compute cp-remaining-amt =
> 082718        cm-ah-benefit-amt * cp-remaining-term-3
> 082718
> 082718     .
> 082718 0510-exit.
> 082718     exit.
> 082718
> 082718 0600-get-elcert.
> 082718
> 082718     exec cics read
> 082718        dataset   ('ELCERT')
> 082718        ridfld    (ws-elcert-key)
> 082718        into      (certificate-master)
> 082718        resp      (ws-response)
> 082718     end-exec
> 082718
> 082718     if not resp-normal
> 082718        display ' bad read on elcert ' ws-response
> 082718        go to 0600-exit
> 082718     end-if
> 082718
> 082718     if cm-lf-benefit-cd not = '00' and spaces
> 082718        move cm-lf-benefit-cd    to ws-lf-ben-code
> 082718        perform 0400-get-lf-code thru 0400-exit
> 082718     end-if
> 082718     if cm-ah-benefit-cd not = '00' and spaces
> 082718        move cm-ah-benefit-cd    to ws-ah-ben-code
> 082718        perform 0410-get-ah-code thru 0410-exit
> 082718     end-if
> 082718
> 082718     .
> 082718 0600-exit.
> 082718     exit.
> 082718
> 082718 0650-set-last-name.
> 082718
> 082718     move ws-name-in             to ws-name-out
> 082718     perform varying n1 from +13 by -1 until n1 < +3
> 082718        if (ws-name-in (n1:3) = ' SR' or ' JR' or ' II' or
> 082718           ' IV' or ' VI' or ' I ' or ' V ')
> 082718           or (ws-name-in (n1:4) = ' III')
> 082718           or (ws-name-in (n1:5) = ' IIII')
> 082718           or (ws-name-in (14:2) = ' I')
> 082718           or (ws-name-in (14:2) = ' V')
> 082718           move ws-name-in (1:n1 - 1)
> 082718                                 to ws-name-out
> 082718           move +3               to n1
> 082718        end-if
> 082718     end-perform
> 082718
> 082718     .
> 082718 0650-exit.
> 082718     exit.
> 082718
> 082718 0700-calc-cur-pb-ages.
> 082718
> 082718     move zeros                  to ws-pb-pri-curr-age
> 082718                                    ws-pb-cob-curr-age
> 082718     if (pb-i-age not numeric)
> 082718               or
> 082718        (pb-i-age = zeros)
> 082718        move 42                  to pb-i-age
> 082718     end-if
> 082718
> 082718     move pb-i-age               to ws-pb-pri-curr-age
> 082718
> 082718     if pb-i-birthday <> low-values
> 082718        move pb-i-birthday       to dc-bin-date-1
> 082718        move ws-current-bin-dt   to dc-bin-date-2
> 082718        move '1'                 to dc-option-code
> 082718        perform 9700-DATE-CONVERT
> 082718                                 thru 9700-exit
> 082718        if no-conversion-error
> 082718           compute ws-work-age = dc-elapsed-months / 12
> 082718           move ws-work-age      to ws-pb-pri-curr-age
> 082718           go to 0700-joint-stuff
> 082718        end-if
> 082718     end-if
> 082718
> 082718     move pb-cert-eff-dt         to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 9700-DATE-CONVERT   thru 9700-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age = pb-i-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-pb-pri-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0700-joint-stuff.
> 082718
> 082718     if pb-i-joint-last-name = spaces
> 082718        and pb-i-joint-first-name = spaces
> 082718        go to 0700-exit
> 082718     end-if
> 082718
> 082718     if (pb-i-joint-age not numeric)
> 082718        move zeros               to pb-i-joint-age
> 082718     end-if
> 082718
> 082718     move pb-i-joint-age         to ws-pb-cob-curr-age
> 082718
> 082718     if pb-i-joint-birthday <> low-values
> 082718        move pb-i-joint-birthday to dc-bin-date-1
> 082718        move ws-current-bin-dt   to dc-bin-date-2
> 082718        move '1'                 to dc-option-code
> 082718        perform 9700-DATE-CONVERT
> 082718                                 thru 9700-exit
> 082718        if no-conversion-error
> 082718           compute ws-work-age = dc-elapsed-months / 12
> 082718           move ws-work-age      to ws-pb-cob-curr-age
> 082718           go to 0700-exit
> 082718        end-if
> 082718     end-if
> 082718
> 082718     move pb-cert-eff-dt         to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 9700-DATE-CONVERT   thru 9700-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age =
> 082718           pb-i-joint-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-pb-cob-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0700-exit.
> 082718     exit.
> 082718
> 082718 0710-calc-cur-p5-ages.
> 082718
> 082718     move zeros                  to ws-p5-pri-curr-age
> 082718                                    ws-p5-cob-curr-age
> 082718     if (p5-i-age not numeric)
> 082718               or
> 082718        (p5-i-age = zeros)
> 082718        move 42                  to p5-i-age
> 082718     end-if
> 082718
> 082718     move p5-i-age               to ws-p5-pri-curr-age
> 082718
> 082718     if p5-i-birthday <> low-values
> 082718        move p5-i-birthday       to dc-bin-date-1
> 082718        move ws-current-bin-dt   to dc-bin-date-2
> 082718        move '1'                 to dc-option-code
> 082718        perform 9700-DATE-CONVERT
> 082718                                 thru 9700-exit
> 082718        if no-conversion-error
> 082718           compute ws-work-age = dc-elapsed-months / 12
> 082718           move ws-work-age      to ws-p5-pri-curr-age
> 082718           go to 0710-joint-stuff
> 082718        end-if
> 082718     end-if
> 082718
> 082718     move p5-cert-eff-dt         to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 9700-DATE-CONVERT   thru 9700-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age = p5-i-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-p5-pri-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0710-joint-stuff.
> 082718
> 082718     if p5-i-joint-last-name = spaces
> 082718        and p5-i-joint-first-name = spaces
> 082718        go to 0710-exit
> 082718     end-if
> 082718
> 082718     if (p5-i-joint-age not numeric)
> 082718        move zeros               to p5-i-joint-age
> 082718     end-if
> 082718
> 082718     move p5-i-joint-age         to ws-p5-cob-curr-age
> 082718
> 082718     if p5-i-joint-birthday <> low-values
> 082718        move p5-i-joint-birthday to dc-bin-date-1
> 082718        move ws-current-bin-dt   to dc-bin-date-2
> 082718        move '1'                 to dc-option-code
> 082718        perform 9700-DATE-CONVERT
> 082718                                 thru 9700-exit
> 082718        if no-conversion-error
> 082718           compute ws-work-age = dc-elapsed-months / 12
> 082718           move ws-work-age      to ws-p5-cob-curr-age
> 082718           go to 0710-exit
> 082718        end-if
> 082718     end-if
> 082718
> 082718     move p5-cert-eff-dt         to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 9700-DATE-CONVERT   thru 9700-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age =
> 082718           p5-i-joint-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-p5-cob-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0710-exit.
> 082718     exit.
> 082718
> 082718 0720-calc-cur-alph-age.
> 082718
> 082718     move zeros                  to ws-alph-curr-age
> 082718
> 082718     if (af-age not numeric)
> 082718               or
> 082718        (af-age = zeros)
> 082718        move 42                  to af-age
> 082718     end-if
> 082718
> 082718     move af-age                 to ws-alph-curr-age
> 082718
> 082718     move af-dt                  to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 9700-DATE-CONVERT   thru 9700-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age = af-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-alph-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0720-exit.
> 082718     exit.
> 
> 010517 9500-LINK-REM-AMT.
> 010517
> 010517     EXEC CICS LINK
> 010517         PROGRAM   ('ELRAMT')
> 010517         COMMAREA  (CALCULATION-PASS-AREA)
> 010517         LENGTH    (CP-COMM-LENGTH)
> 010517     END-EXEC
> 010517
> 010517     .
> 010517 9500-EXIT.
> 010517     EXIT.
> 
875a1362,1374
> 010517 9800-LINK-REM-TERM.
> 010517
> 010517     EXEC CICS LINK
> 010517         PROGRAM   ('ELRTRM')
> 010517         COMMAREA  (CALCULATION-PASS-AREA)
> 010517         LENGTH    (CP-COMM-LENGTH)
> 010517     END-EXEC
> 010517
> 010517     .
> 010517 9800-EXIT.
> 010517     EXIT.
> 
> 
877c1376
<                                        COPY ELCABEND.
---
>                                        COPY ELCABEND. 
\ No newline at end of file

</pre>
<h3><a name="SOCK06.cl2">SOCK06.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

31a32
> 082718* 082718 CR2018082400001   PEMA  Incorp pri & co borw current age
37d37
< 
59,60c59,60
<        77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
<        77 WS-COMP-ID                   PIC XXX VALUE 'CID'.
---
>        77  WS-COMP-CD                  PIC X  VALUE LOW-VALUES.
>        77  WS-COMP-ID                  PIC XXX VALUE 'CID'.
65a66
> 082718 77  n1                          pic s999 value +0 comp-3.
89a91,97
> 082718 77  ws-current-bin-dt           pic xx value low-values.
> 082718 77  ws-work-age                 pic s999 comp-3 value zeros.
> 082718 77  ws-pb-pri-curr-age          pic s999 comp-3 value +0.
> 082718 77  ws-pb-cob-curr-age          pic s999 comp-3 value +0.
> 082718 77  ws-p5-pri-curr-age          pic s999 comp-3 value +0.
> 082718 77  ws-p5-cob-curr-age          pic s999 comp-3 value +0.
> 082718 77  ws-alph-curr-age            pic s999 comp-3 value +0.
139a148,152
> 082718 01  ws-alpha-last-name          pic x(15) value spaces.
> 082718 01  ws-p5-last-name             pic x(15) value spaces.
> 082718 01  ws-p5-jnt-last-name         pic x(15) value spaces.
> 082718 01  ws-name-in                  pic x(15) value spaces.
> 082718 01  ws-name-out                 pic x(15) value spaces.
294c307
<            display ' Entering SOCK06  '
---
>       *    display ' Entering SOCK06  '
298,299c311,312
<            display 'SOCK06:transaction data =', CLIENT-IN-DATA '**'
<            display 'SOCK06:socket number    =', GIVE-TAKE-SOCKET.
---
>       *    display 'SOCK06:transaction data =', CLIENT-IN-DATA '**'
>       *    display 'SOCK06:socket number    =', GIVE-TAKE-SOCKET.
316d328
< 
326d337
< 
339a351
> 082718                                    ws-current-bin-dt
403,481d414
< 010517*    move spaces                 to lf-joint-ind ah-joint-ind
< 010517*    if pb-i-lf-benefit-cd = '00' or '  '
< 010517*       go to 0045-check-ah
< 010517*    end-if
< 010517*    move ws-comp-id             to ws-elcntl-key
< 010517*    set ws-elcntl-lf-ben-cd     to true
< 010517*    move pb-i-lf-benefit-cd     to ws-elcntl-hi-ben-cd
< 010517*    move zeros                  to ws-elcntl-seq-no
< 010517*
< 010517*    exec cics read
< 010517*       dataset     ('ELCNTL')
< 010517*       into        (control-file)
< 010517*       ridfld      (ws-elcntl-key)
< 010517*       gteq
< 010517*       resp        (ws-response)
< 010517*    end-exec
< 010517*
< 010517*    if resp-normal
< 010517*       perform varying c1 from +1 by +1 until
< 010517*          (c1 > +8)
< 010517*          or (cf-benefit-code (c1) = pb-i-lf-benefit-cd)
< 010517*       end-perform
< 010517*
< 010517*       if c1 < +9
< 010517*          move cf-joint-indicator (c1)
< 010517*                                to lf-joint-ind
< 010517*          MOVE CF-BENEFIT-ALPHA (c1)
< 010517*                                TO WS-lf-KIND
< 010517*          MOVE CF-SPECIAL-CALC-CD (c1)
< 010517*                                TO WS-lf-CALC-CD
< 010517*          MOVE CF-BENEFIT-DESCRIP (c1)
< 010517*                                TO WS-lf-BEN-DESCRIP
< 010517*          MOVE CF-LF-COVERAGE-TYPE (c1)
< 010517*                                TO WS-LF-COVERAGE-TYPE
< 010517*          MOVE CF-CO-EARNINGS-CALC (c1)
< 010517*                                TO WS-lf-EARNINGS-CALC
< 010517*       end-if
< 010517*    end-if
< 
<            .
<        0045-check-ah.
< 
<            if pb-i-ah-benefit-cd = '00' or '  '
<               go to 0045-exit
<            end-if
< 
<            move ws-comp-id             to ws-elcntl-key
<            set ws-elcntl-ah-ben-cd     to true
<            move pb-i-ah-benefit-cd     to ws-elcntl-hi-ben-cd
<            move zeros                  to ws-elcntl-seq-no
< 
<            exec cics read
<               dataset     ('ELCNTL')
<               into        (control-file)
<               ridfld      (ws-elcntl-key)
<               gteq
<               resp        (ws-response)
<            end-exec
< 
<            if resp-normal
<               perform varying c1 from +1 by +1 until
<                  (c1 > +8)
<                  or (cf-benefit-code (c1) = pb-i-ah-benefit-cd)
<               end-perform
<               if c1 < +9
< 010517           move cf-joint-indicator (c1)
< 010517                                 to ah-joint-ind
< 010517           MOVE CF-BENEFIT-ALPHA (c1)
< 010517                                 TO WS-ah-KIND
< 010517           MOVE CF-SPECIAL-CALC-CD (c1)
< 010517                                 TO WS-ah-CALC-CD
< 010517           MOVE CF-BENEFIT-DESCRIP (c1)
< 010517                                 TO WS-ah-BEN-DESCRIP
< 010517           MOVE CF-LF-COVERAGE-TYPE (c1)
< 010517                                 TO WS-ah-COVERAGE-TYPE
< 010517           MOVE CF-CO-EARNINGS-CALC (c1)
< 010517                                 TO WS-ah-EARNINGS-CALC
<               end-if
< 
496,498c429,435
<               move pb-i-age            to ws-age
<               MOVE PB-i-insured-last-name
<                                        to ws-last-name
---
> 082718*       MOVE PB-i-insured-last-name
> 082718*                                to ws-last-name
> 082718        move pb-i-insured-last-name
> 082718                                 to ws-name-in
> 082718        perform 0650-set-last-name
> 082718                                 thru 0650-exit
> 082718        move ws-name-out         to ws-last-name
500a438,440
> 082718        perform 0700-calc-cur-pb-ages
> 082718                                 thru 0700-exit
>               move ws-pb-pri-curr-age  to ws-age
509,511c449,455
<                  move pb-i-joint-age   to ws-age
<                  move pb-i-joint-last-name
<                                        to ws-last-name
---
> 082718*          move pb-i-joint-last-name
> 082718*                                to ws-last-name
> 082718           move pb-i-joint-last-name
> 082718                                 to ws-name-in
> 082718           perform 0650-set-last-name
> 082718                                 thru 0650-exit
> 082718           move ws-name-out      to ws-last-name
513a458,459
> 082718           move ws-pb-cob-curr-age
> 082718                                 to ws-age
517d462
<               
526c471
<       *** check to see if there is a pending cancel for the issue **
---
>       *** check to see if the pending issue is cancelled
528,536c473,475
<            move pb-control-by-account  to ws-erpndb5-key
<            move +0                     to ws-erpndb5-seq-no
<            move '2'                    to ws-erpndb5-rec-type
<            exec cics read
<               dataset       ('ERPNDB2')
<               ridfld        (ws-erpndb5-key)
<               into          (p5-pending-business)
<               resp          (ws-response)
<            end-exec
---
> 082718     move pb-control-by-account (1:33)
> 082718                                 to ws-elcert-key
> 082718     perform 0600-get-elcert     thru 0600-exit
539,541c478,480
<               if p5-ci-lf-benefit-cd not = '00' and '  '
<                  if p5-c-lf-cancel-dt <> low-values
<                     move '00'             to pb-i-lf-benefit-cd
---
> 082718        if cm-lf-benefit-cd <> '00' and '  '
> 082718           if cm-lf-cancel-dt <> low-values
> 082718              move '00'          to pb-i-lf-benefit-cd
544,546c483,485
<               if p5-ci-ah-benefit-cd not = '00' and '  '
<                  if p5-c-ah-cancel-dt <> low-values
<                     move '00'             to pb-i-ah-benefit-cd
---
> 082718        if cm-ah-benefit-cd <> '00' and '  '
> 082718           if cm-ah-cancel-dt <> low-values
> 082718              move '00'          to pb-i-ah-benefit-cd
549,550d487
<       *    else
<       *       display ' i guess no cancel initial '
569,570d505
<            move ws-age                 to ws-age-from-pndb
< 
592,594d526
< 010517     perform 0610-elcert-key-from-erpndb
< 010517                                 thru 0610-exit
< 010517     perform 0600-get-elcert     thru 0600-exit
678c610
<               display ' no matching eralph record ' 
---
>       *       display ' no matching eralph record ' 
683c615
<                  display ' error-eralph-start ' ws-response
---
>       *          display ' error-eralph-start ' ws-response
700c632
<               or (af-lname       not = ws-last-name)
---
> 082718        or (ws-alpha-last-name not = ws-last-name)
770a703,708
> 082718        go to 0155-exit
> 082718     end-if
> 
> 082718     if (pb-company-cd = ws-eralph-aix-company-cd)
> 082718        and (pb-account = ws-eralph-aix-account)
> 082718        continue
772,779c710,720
<               if (pb-company-cd not = ws-eralph-aix-company-cd)
<                  or (pb-account not = ws-eralph-aix-account)
<                  or (ws-last-name not = ws-eralph-aix-lname)
< 092215           or (ws-first-three not = ws-eralph-aix-1st-three)
<                  set end-of-eralph to true
<       *       else
<       *          display ' found eralph2 '
<               end-if
---
> 082718        set end-of-eralph to true
> 082718        go to 0155-exit
> 082718     end-if
> 082718
> 082718     move af-lname               to ws-name-in
> 082718     perform 0650-set-last-name  thru 0650-exit
> 082718     move ws-name-out            to ws-alpha-last-name
> 082718     
> 082718     if (ws-last-name not = ws-alpha-last-name)
> 082718        or (ws-first-three not = ws-eralph-aix-1st-three)
> 082718        set end-of-eralph to true
787a729,732
> 082718***** calc the current age on the alpha record here
> 082718***** then compare it to the pb ages, if there not within
> 082718***** a few years then go to 0160-continue.
> 
791,799c736,741
<            move af-control-primary     to ws-erpndb5-key
<            move +0                     to ws-erpndb5-seq-no
<            move '2'                    to ws-erpndb5-rec-type
<            exec cics read
<               dataset       ('ERPNDB2')
<               ridfld        (ws-erpndb5-key)
<               into          (p5-pending-business)
<               resp          (ws-response)
<            end-exec
---
> 082718     if pb-control-by-account (1:33) = af-control-primary(1:33)
> 082718        go to 0160-continue
> 082718     end-if
> 082718
> 082718     move af-control-primary     to ws-elcert-key
> 082718     perform 0600-get-elcert     thru 0600-exit
802,804c744,745
<       *       display ' found cancel alpha '
<               if p5-ci-lf-benefit-cd not = '00' and '  '
<                  if p5-c-lf-cancel-dt <> low-values
---
> 082718        if cm-lf-benefit-cd not = '00' and '  '
> 082718           if cm-lf-cancel-dt <> low-values
808,809c749,750
<               if p5-ci-ah-benefit-cd not = '00' and '  '
<                  if p5-c-ah-cancel-dt <> low-values
---
> 082718        if cm-ah-benefit-cd not = '00' and '  '
> 082718           if cm-ah-cancel-dt <> low-values
814,817c755,757
<            if (af-lf-typ not = '00')
<               or (af-ah-typ not = '00')
<               add +1 to a1
<            else
---
> 
> 082718     if (af-lf-typ = '00' or spaces)
> 082718        and (af-ah-typ = '00' or spaces)
820a761,773
> 082718     perform 0720-calc-cur-alph-age
> 082718                                 thru 0720-exit
> 082718
> 082718     if (ws-age - ws-alph-curr-age < 4
> 082718        and >= 0)
> 082718                      or
> 082718        (ws-alph-curr-age - ws-age < 4
> 082718        and >= 0)
> 082718        add +1 to a1
> 082718     else
> 082718        go to 0160-continue
> 082718     end-if
> 
828c781
<            move af-age                 to ws-eralph-age (a1)
---
> 082718     move ws-alph-curr-age       to ws-eralph-age (a1)
842,844d794
< 010517     move af-control-primary     to ws-elcert-key
< 010517     perform 0600-get-elcert     thru 0600-exit
< 
961,962c911,912
<                  display ' Found A & H claim ' cl-cert-no-a4 ' '
<                     cl-claim-status ' ' cl-total-paid-amt
---
>       *          display ' Found A & H claim ' cl-cert-no-a4 ' '
>       *             cl-claim-status ' ' cl-total-paid-amt
1039c989
<               display ' end of file on read next ' 
---
>       *       display ' end of file on read next ' 
1055,1082c1005,1052
<            if pb-control-by-account = p5-control-by-account
<               continue
<            else
<               if (p5-control-by-account (1:33) =
<                             ws-save-issue-key (1:33))
<                  and (p5-record-type = '2')
<                  move spaces           to ws-save-issue-key
<                  if p5-ci-lf-benefit-cd not = '00' and '  '
<                     if p5-c-lf-cancel-dt <> low-values
<       *                display ' found lf accum cancel ' p5-account
<       *                   ' ' p5-cert-no
<                        move '00'             to ws-eralph-lf-cd (a1)
<                     end-if
<                  end-if
<                  if p5-ci-ah-benefit-cd not = '00' and '  '
<                     if p5-c-ah-cancel-dt <> low-values
<       *                display ' found ah accum cancel ' p5-account
<       *                   ' ' p5-cert-no
<                        move '00'             to ws-eralph-ah-cd (a1)
<                     end-if
<                  end-if
<               end-if
<               move ' '                 to ws-pend-match
<               if (p5-i-insured-last-name = ws-last-name)
< 092215           and (p5-i-insured-first-name (1:3) = ws-first-three)
<                  and (p5-record-type = '1')
< 052016           and (p5-i-entry-status not = '5' AND '9' AND
< 052016                             'D' AND 'V')
---
> 082718     if (pb-control-by-account = p5-control-by-account)
> 082718        or (p5-record-type <> '1')
> 082718        go to 0180-read  *> I found myself or a batch or cancel record
> 082718     end-if
> 
> 082718     move spaces                 to ws-p5-last-name
> 082718                                    ws-p5-jnt-last-name
> 082718     move zeros                  to ws-p5-pri-curr-age
> 082718                                    ws-p5-cob-curr-age
> 
> 082718     move ' '                    to ws-pend-match
> 082718     move p5-control-by-account (1:33)
> 082718                                 to ws-elcert-key
> 082718     perform 0600-get-elcert     thru 0600-exit
> 082718     if (cm-lf-benefit-cd <> '00' and spaces)
> 082718        and (cm-lf-cancel-dt <> low-values)
> 082718        move '00'                to p5-i-lf-benefit-cd
> 082718     end-if
> 082718     if (cm-ah-benefit-cd <> '00' and spaces)
> 082718        and (cm-ah-cancel-dt <> low-values)
> 082718        move '00'                to p5-i-ah-benefit-cd
> 082718     end-if
> 082718     if ((p5-i-lf-benefit-cd = '00' or spaces)
> 082718        and (p5-i-ah-benefit-cd = '00' or spaces))
> 082718                 or
> 082718        (p5-i-entry-status = '5' or '9' or
> 082718                          'D' or 'V')                 
> 082718        go to 0180-read   *>  Must be cancelled or something
> 082718     end-if
> 082718     move p5-i-insured-last-name to ws-name-in
> 082718     perform 0650-set-last-name  thru 0650-exit
> 082718     move ws-name-out            to ws-p5-last-name
> 082718     move p5-i-joint-last-name   to ws-name-in
> 082718     perform 0650-set-last-name  thru 0650-exit
> 082718     move ws-name-out            to ws-p5-jnt-last-name
> 
> 082718     if ((ws-p5-last-name = ws-last-name)
> 082718        and (p5-i-insured-first-name (1:3) = ws-first-three))
> 082718                    or
> 082718       ((ws-p5-jnt-last-name = ws-last-name)
> 082718        and (p5-i-joint-first-name (1:3) = ws-first-three))
> 082718        perform 0710-calc-cur-p5-ages
> 082718                              thru 0710-exit
> 082718     end-if
> 
>            if (ws-p5-last-name = ws-last-name)
> 092215        and (p5-i-insured-first-name (1:3) = ws-first-three)
> 082718        if (ws-age - ws-p5-pri-curr-age < 4 and > -4)
1085,1087c1055,1058
<                  move 'Y'              to ws-pend (a1)
<                  move 'P'              to ws-eralph-prm-sec (a1)
<                  move p5-i-age         to ws-eralph-age (a1)
---
>                  move 'Y'           to ws-pend (a1)
>                  move 'P'           to ws-eralph-prm-sec (a1)
>                  move ws-p5-pri-curr-age
>                                     to ws-eralph-age (a1)
1089c1060
<                                        to ws-first-name (a1)
---
>                                     to ws-first-name (a1)
1091,1097c1062,1068
<                                        thru 0185-exit
<               end-if 
<               if (p5-i-joint-last-name = ws-last-name)
< 092215           and (p5-i-joint-first-name (1:3) = ws-first-three)
<                  and (p5-record-type = '1')
< 052016           and (p5-i-entry-status not = '5' AND '9' AND
< 052016                             'D' AND 'V')
---
>                                     thru 0185-exit
>               end-if
>            end-if 
> 
>            if (ws-p5-jnt-last-name = ws-last-name)
> 092215        and (p5-i-joint-first-name (1:3) = ws-first-three)
> 082718        if (ws-age - ws-p5-cob-curr-age < 4 and > -4)
1100,1102c1071,1074
<                  move 'Y'              to ws-pend (a1)
<                  move 'C'              to ws-eralph-prm-sec (a1)
<                  move p5-i-joint-age   to ws-eralph-age (a1)
---
>                  move 'Y'           to ws-pend (a1)
>                  move 'C'           to ws-eralph-prm-sec (a1)
>                  move ws-p5-cob-curr-age
>                                     to ws-eralph-age (a1)
1104c1076
<                                        to ws-first-name (a1)
---
>                                     to ws-first-name (a1)
1106c1078
<                                        thru 0185-exit
---
>                                     thru 0185-exit
1109a1082,1084
> 082718     .
> 082718 0180-read.
> 
1118c1093
<            move ws-cov-sw           to ws-cov-type (a1)
---
>            move ws-cov-sw              to ws-cov-type (a1)
1126d1100
<            move p5-control-by-account  to ws-save-issue-key
1131,1135d1104
< 010517     move p5-control-by-account (1:33)
< 010517                                 to ws-elcert-key
< 010517     perform 0600-get-elcert     thru 0600-exit
< 
< 
1140c1109
< 012417         and (cm-lf-benefit-cd <> '00' and '  ')
---
> 082718         and (p5-i-lf-benefit-cd <> '00' and '  ')
1168c1137
< 010517         and (cm-ah-benefit-cd <> '00' and '  ')
---
> 082718         and (p5-i-ah-benefit-cd <> '00' and '  ')
1199d1167
< 
1203,1205c1171,1173
<            display 'SOCK06:About to send      '
<            display 'SOCK06:sequence number  =', ws-seq-num.
<            display 'SOCK06:send buffer      =', ws-send-buf(1:80).
---
>       *    display 'SOCK06:About to send      '
>       *    display 'SOCK06:sequence number  =', ws-seq-num.
>       *    display 'SOCK06:send buffer      =', ws-send-buf(1:80).
1460d1427
< 010517
1484c1451
<            display 'SOCK06:done'
---
>       *    display 'SOCK06:done'
1649,1652d1615
< 010517*       if c1 < +9
< 010517*          move cf-joint-indicator (c1)
< 010517*                                to lf-joint-ind
< 010517*       end-if
1657,1660d1619
< 010517*       if c1 < +9
< 010517*          move cf-joint-indicator (c1)
< 010517*                                to ah-joint-ind
< 010517*       end-if
1667,1675c1626,1824
< 010517 0610-elcert-key-from-erpndb.
< 010517
< 010517     move pb-control-by-account (1:33)
< 010517                                 to ws-elcert-key
< 010517
< 010517     .
< 010517 0610-exit.
< 010517     exit.
< 010517
---
> 082718 0650-set-last-name.
> 082718
> 082718     move ws-name-in             to ws-name-out
> 082718     perform varying n1 from +13 by -1 until n1 < +3
> 082718        if (ws-name-in (n1:3) = ' SR' or ' JR' or ' II' or
> 082718           ' IV' or ' VI' or ' I ' or ' V ')
> 082718           or (ws-name-in (n1:4) = ' III')
> 082718           or (ws-name-in (n1:5) = ' IIII')
> 082718           or (ws-name-in (14:2) = ' I')
> 082718           or (ws-name-in (14:2) = ' V')
> 082718           move ws-name-in (1:n1 - 1)
> 082718                                 to ws-name-out
> 082718           move +3               to n1
> 082718        end-if
> 082718     end-perform
> 082718
> 082718     .
> 082718 0650-exit.
> 082718     exit.
> 
> 082718 0700-calc-cur-pb-ages.
> 082718
> 082718     move zeros                  to ws-pb-pri-curr-age
> 082718                                    ws-pb-cob-curr-age
> 082718     if (pb-i-age not numeric)
> 082718               or
> 082718        (pb-i-age = zeros)
> 082718        move 42                  to pb-i-age
> 082718     end-if
> 082718
> 082718     move pb-i-age               to ws-pb-pri-curr-age
> 082718
> 082718     if pb-i-birthday <> low-values
> 082718        move pb-i-birthday       to dc-bin-date-1
> 082718        move ws-current-bin-dt   to dc-bin-date-2
> 082718        move '1'                 to dc-option-code
> 082718        perform 9700-DATE-CONVERT
> 082718                                 thru 9700-exit
> 082718        if no-conversion-error
> 082718           compute ws-work-age = dc-elapsed-months / 12
> 082718           move ws-work-age      to ws-pb-pri-curr-age
> 082718           go to 0700-joint-stuff
> 082718        end-if
> 082718     end-if
> 082718
> 082718     move pb-cert-eff-dt         to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 9700-DATE-CONVERT   thru 9700-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age = pb-i-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-pb-pri-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0700-joint-stuff.
> 082718
> 082718     if pb-i-joint-last-name = spaces
> 082718        and pb-i-joint-first-name = spaces
> 082718        go to 0700-exit
> 082718     end-if
> 082718
> 082718     if (pb-i-joint-age not numeric)
> 082718        move zeros               to pb-i-joint-age
> 082718     end-if
> 082718
> 082718     move pb-i-joint-age         to ws-pb-cob-curr-age
> 082718
> 082718     if pb-i-joint-birthday <> low-values
> 082718        move pb-i-joint-birthday to dc-bin-date-1
> 082718        move ws-current-bin-dt   to dc-bin-date-2
> 082718        move '1'                 to dc-option-code
> 082718        perform 9700-DATE-CONVERT
> 082718                                 thru 9700-exit
> 082718        if no-conversion-error
> 082718           compute ws-work-age = dc-elapsed-months / 12
> 082718           move ws-work-age      to ws-pb-cob-curr-age
> 082718           go to 0700-exit
> 082718        end-if
> 082718     end-if
> 082718
> 082718     move pb-cert-eff-dt         to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 9700-DATE-CONVERT   thru 9700-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age =
> 082718           pb-i-joint-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-pb-cob-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0700-exit.
> 082718     exit.
> 082718
> 082718 0710-calc-cur-p5-ages.
> 082718
> 082718     move zeros                  to ws-p5-pri-curr-age
> 082718                                    ws-p5-cob-curr-age
> 082718     move spaces                 to ws-p5-last-name
> 082718                                    ws-p5-jnt-last-name
> 082718
> 082718
> 082718     if (p5-i-age not numeric)
> 082718               or
> 082718        (p5-i-age = zeros)
> 082718        move 42                  to p5-i-age
> 082718     end-if
> 082718
> 082718     move p5-i-age               to ws-p5-pri-curr-age
> 082718
> 082718     if p5-i-birthday <> low-values
> 082718        move p5-i-birthday       to dc-bin-date-1
> 082718        move ws-current-bin-dt   to dc-bin-date-2
> 082718        move '1'                 to dc-option-code
> 082718        perform 9700-DATE-CONVERT
> 082718                                 thru 9700-exit
> 082718        if no-conversion-error
> 082718           compute ws-work-age = dc-elapsed-months / 12
> 082718           move ws-work-age      to ws-p5-pri-curr-age
> 082718           go to 0710-joint-stuff
> 082718        end-if
> 082718     end-if
> 082718
> 082718     move p5-cert-eff-dt         to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 9700-DATE-CONVERT   thru 9700-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age = p5-i-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-p5-pri-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0710-joint-stuff.
> 082718
> 082718     if p5-i-joint-last-name = spaces
> 082718        and p5-i-joint-first-name = spaces
> 082718        go to 0710-exit
> 082718     end-if
> 082718
> 082718     if (p5-i-joint-age not numeric)
> 082718        move zeros               to p5-i-joint-age
> 082718     end-if
> 082718
> 082718     move p5-i-joint-age         to ws-p5-cob-curr-age
> 082718
> 082718     if p5-i-joint-birthday <> low-values
> 082718        move p5-i-joint-birthday to dc-bin-date-1
> 082718        move ws-current-bin-dt   to dc-bin-date-2
> 082718        move '1'                 to dc-option-code
> 082718        perform 9700-DATE-CONVERT
> 082718                                 thru 9700-exit
> 082718        if no-conversion-error
> 082718           compute ws-work-age = dc-elapsed-months / 12
> 082718           move ws-work-age      to ws-p5-cob-curr-age
> 082718           go to 0710-exit
> 082718        end-if
> 082718     end-if
> 082718
> 082718     move p5-cert-eff-dt         to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 9700-DATE-CONVERT   thru 9700-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age =
> 082718           p5-i-joint-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-p5-cob-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0710-exit.
> 082718     exit.
> 082718
> 082718 0720-calc-cur-alph-age.
> 082718
> 082718     move zeros                  to ws-alph-curr-age
> 082718
> 082718     if (af-age not numeric)
> 082718               or
> 082718        (af-age = zeros)
> 082718        move 42                  to af-age
> 082718     end-if
> 082718
> 082718     move af-age                 to ws-alph-curr-age
> 082718
> 082718     move af-dt                  to dc-bin-date-1
> 082718     move ws-current-bin-dt      to dc-bin-date-2
> 082718     move '1'                    to dc-option-code
> 082718     perform 9700-DATE-CONVERT   thru 9700-exit
> 082718     if no-conversion-error
> 082718        compute ws-work-age = af-age + (dc-elapsed-months / 12)
> 082718        move ws-work-age         to ws-alph-curr-age
> 082718     end-if
> 082718
> 082718     .
> 082718 0720-exit.
> 082718     exit.
> 

</pre>
</body></html>