<html>
<head>
<title>Compare Module List</title>
</head>
<body style="background-color:PowderBlue;"><div align="center"><h2>Compares for CC-8039-TANA.ini</h2>
<h3>Processed on - 07/07/2022</h3></div>
<a name="topper"></a>
<a href="#inifile">INI File</a><br>
<a href="#ELC631PI">ELC631PI</a><br>
<a href="#NSCASOUTB">NSCASOUTB</a><br>
<a href="#NSCASVARS">NSCASVARS</a><br>
<a href="#CIDNSASX.cbl">CIDNSASX.cbl</a><br>
<a href="#EL1278.cl2">EL1278.cl2</a><br>
<a href="#EL677.cl2">EL677.cl2</a><br>
<a href="#EL6301.cl2">EL6301.cl2</a><br>
<a href="#EL6311.cl2">EL6311.cl2</a><br>
<a href="#ELCANC.cl2">ELCANC.cl2</a><br>
<a href="#NSRASBL.cl2">NSRASBL.cl2</a><br>
<h3>INI FILE As submitted by programmer, followed by log information <h3>
<pre>

[2020061200002]
[/apps/test/cid1s/jcl/daily_jobs/;/apps/prod/cid1p/jcl/daily_jobs/]
[/apps/test/cid1s/jcl/monthly_jobs/;/apps/prod/cid1p/jcl/monthly_jobs/]
[/apps/test/cid1s/jcl/quarterly_jobs/;/apps/prod/cid1p/jcl/quarterly_jobs/]
[/apps/test/cid1s/jcl/yearly_jobs/;/apps/prod/cid1p/jcl/yearly_jobs/]
[/export/home/tana/bin/;/export/home/mtpadmin/bin/]
[/apps/test/cid1s/sys/webroot/;/apps/prod/cid1p/sys/webroot/]
ASBOD.tem=
[/apps/test/cid1s/sys/webroot/coversheets/;/apps/prod/cid1p/sys/webroot/coversheets/]
[/apps/test/cid1s/sys/webroot/coversheets/images/;/apps/prod/cid1p/sys/webroot/coversheets/images/]
[/apps/test/cid1s/sys/webroot/coversheets/javascript/;/apps/prod/cid1p/sys/webroot/coversheets/javascript/]
[/apps/test/cid1s/sys/webroot/coversheets/style/;/apps/prod/cid1p/sys/webroot/coversheets/style/]
[/apps/test/cid1s/maps/;/apps/prod/cid1p/maps/]
[/apps/test/cid1s/copy/;/apps/prod/cid1p/copy/]
ELC631PI=
NSCASOUTB=
NSCASVARS=
[/apps/test/cid1s/emails/;/apps/prod/cid1p/emails/]
[/apps/test/cid1s/parmlib/;/apps/prod/cid1p/parmlib/]
[/apps/test/cid1s/src/batch/;/apps/prod/cid1p/src/batch/]
CIDNSASX.cbl=
CIDNSASX.idy=
CIDNSASX.int=
[/apps/test/cid1s/src/online/;/apps/prod/cid1p/src/online/]
EL1278.cbl=
EL1278.cl2=
EL1278.idy=
EL1278.int=
EL1278.lst=
EL677.cbl=
EL677.cl2=
EL677.idy=
EL677.int=
EL677.lst=
EL6301.cbl=
EL6301.cl2=
EL6301.idy=
EL6301.int=
EL6301.lst=
EL6311.cbl=
EL6311.cl2=
EL6311.idy=
EL6311.int=
EL6311.lst=
ELCANC.cbl=
ELCANC.cl2=
ELCANC.idy=
ELCANC.int=
ELCANC.lst=
NSRASBL.cbl=
NSRASBL.cl2=
NSRASBL.idy=
NSRASBL.int=
NSRASBL.lst=
[/apps/test/cid1s/exe/bat/;/apps/prod/cid1p/staging/exe_bat/]
CIDNSASX.gnt=
[/apps/test/cid1s/exe/onl/;/apps/prod/cid1p/staging/exe_onl/]
EL1278.gnt=
EL677.gnt=
EL6301.gnt=
EL6311.gnt=
ELCANC.gnt=
NSRASBL.gnt=Archive Process Successfull using - perl /export/home/mtpadmin/bin/mtp_archive.pl CC-8039-TANA.ini
Move Process Successfull using - perl /export/home/mtpadmin/bin/mtp_move.pl CC-8039-TANA.ini
Promote process successfull and verified using - perl /export/home/mtpadmin/bin/mtp_verify.pl CC-8039-TANA.ini
Archived module - /apps/prod/cid1p/sys/webroot/archive/ASBOD.tem.20220707
Archived module - /apps/prod/cid1p/copy/archive/ELC631PI.20220707
Archived module - /apps/prod/cid1p/copy/archive/NSCASOUTB.20220707
Archived module - /apps/prod/cid1p/copy/archive/NSCASVARS.20220707
Archived module - /apps/prod/cid1p/src/batch/archive/CIDNSASX.cbl.20220707
Archived module - /apps/prod/cid1p/src/batch/archive/CIDNSASX.idy.20220707
Archived module - /apps/prod/cid1p/src/batch/archive/CIDNSASX.int.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL1278.cbl.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL1278.cl2.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL1278.idy.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL1278.int.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL1278.lst.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL677.cbl.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL677.cl2.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL677.idy.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL677.int.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL677.lst.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL6301.cbl.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL6301.cl2.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL6301.idy.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL6301.int.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL6301.lst.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL6311.cbl.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL6311.cl2.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL6311.idy.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL6311.int.20220707
Archived module - /apps/prod/cid1p/src/online/archive/EL6311.lst.20220707
Archived module - /apps/prod/cid1p/src/online/archive/ELCANC.cbl.20220707
Archived module - /apps/prod/cid1p/src/online/archive/ELCANC.cl2.20220707
Archived module - /apps/prod/cid1p/src/online/archive/ELCANC.idy.20220707
Archived module - /apps/prod/cid1p/src/online/archive/ELCANC.int.20220707
Archived module - /apps/prod/cid1p/src/online/archive/ELCANC.lst.20220707
Archived module - /apps/prod/cid1p/src/online/archive/NSRASBL.cbl.20220707
Archived module - /apps/prod/cid1p/src/online/archive/NSRASBL.cl2.20220707
Archived module - /apps/prod/cid1p/src/online/archive/NSRASBL.idy.20220707
Archived module - /apps/prod/cid1p/src/online/archive/NSRASBL.int.20220707
Archived module - /apps/prod/cid1p/src/online/archive/NSRASBL.lst.20220707
Archived module - /apps/prod/cid1p/exe/bat/archive/CIDNSASX.gnt.20220707
Archived module - /apps/prod/cid1p/exe/onl/archive/EL1278.gnt.20220707
Archived module - /apps/prod/cid1p/exe/onl/archive/EL677.gnt.20220707
Archived module - /apps/prod/cid1p/exe/onl/archive/EL6301.gnt.20220707
Archived module - /apps/prod/cid1p/exe/onl/archive/EL6311.gnt.20220707
Archived module - /apps/prod/cid1p/exe/onl/archive/ELCANC.gnt.20220707
Archived module - /apps/prod/cid1p/exe/onl/archive/NSRASBL.gnt.20220707
moved module - /apps/prod/cid1p/sys/webroot/ASBOD.tem
moved module - /apps/prod/cid1p/copy/ELC631PI
moved module - /apps/prod/cid1p/copy/NSCASOUTB
moved module - /apps/prod/cid1p/copy/NSCASVARS
moved module - /apps/prod/cid1p/src/batch/CIDNSASX.cbl
moved module - /apps/prod/cid1p/src/batch/CIDNSASX.idy
moved module - /apps/prod/cid1p/src/batch/CIDNSASX.int
moved module - /apps/prod/cid1p/src/online/EL1278.cbl
moved module - /apps/prod/cid1p/src/online/EL1278.cl2
moved module - /apps/prod/cid1p/src/online/EL1278.idy
moved module - /apps/prod/cid1p/src/online/EL1278.int
moved module - /apps/prod/cid1p/src/online/EL1278.lst
moved module - /apps/prod/cid1p/src/online/EL677.cbl
moved module - /apps/prod/cid1p/src/online/EL677.cl2
moved module - /apps/prod/cid1p/src/online/EL677.idy
moved module - /apps/prod/cid1p/src/online/EL677.int
moved module - /apps/prod/cid1p/src/online/EL677.lst
moved module - /apps/prod/cid1p/src/online/EL6301.cbl
moved module - /apps/prod/cid1p/src/online/EL6301.cl2
moved module - /apps/prod/cid1p/src/online/EL6301.idy
moved module - /apps/prod/cid1p/src/online/EL6301.int
moved module - /apps/prod/cid1p/src/online/EL6301.lst
moved module - /apps/prod/cid1p/src/online/EL6311.cbl
moved module - /apps/prod/cid1p/src/online/EL6311.cl2
moved module - /apps/prod/cid1p/src/online/EL6311.idy
moved module - /apps/prod/cid1p/src/online/EL6311.int
moved module - /apps/prod/cid1p/src/online/EL6311.lst
moved module - /apps/prod/cid1p/src/online/ELCANC.cbl
moved module - /apps/prod/cid1p/src/online/ELCANC.cl2
moved module - /apps/prod/cid1p/src/online/ELCANC.idy
moved module - /apps/prod/cid1p/src/online/ELCANC.int
moved module - /apps/prod/cid1p/src/online/ELCANC.lst
moved module - /apps/prod/cid1p/src/online/NSRASBL.cbl
moved module - /apps/prod/cid1p/src/online/NSRASBL.cl2
moved module - /apps/prod/cid1p/src/online/NSRASBL.idy
moved module - /apps/prod/cid1p/src/online/NSRASBL.int
moved module - /apps/prod/cid1p/src/online/NSRASBL.lst
moved module - /apps/prod/cid1p/staging/exe_bat/CIDNSASX.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/EL1278.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/EL677.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/EL6301.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/EL6311.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/ELCANC.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/NSRASBL.gnt

</pre>
<h3><a name="CIDNSASX.cbl">CIDNSASX.cbl</a><br><a href="#topper">Back to Top</a><br><pre>

19a20
> 070622* 070622    2020061200002  TANA  ADD REFUND CHECK INFO
138c139,140
< 121015 77  MAX-FIELDS                  PIC S9(5) COMP-3 VALUE +297.
---
> 121015*77  MAX-FIELDS                  PIC S9(5) COMP-3 VALUE +297.
> 070622 77  MAX-FIELDS                  PIC S9(5) COMP-3 VALUE +305.
359a362,363
>                display ' cert no - QWS - ' LA-CERT-NO-A2
>                display ' archive no : ' LA-ARCHIVE-NO-A2

</pre>
<h3><a name="EL1278.cl2">EL1278.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

0a1
>       $SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
65a67
> 070622* 070622  CR2020061200002  TANA  Add cancel reason logic
120a123,174
> 070622 77  WS-ATT-AGE                  PIC S9(3)V99    COMP-3 VALUE +0.
> 070622 77  WS-EDIT-AGE                 PIC S999       COMP-3 VALUE ZERO.
> 
> 070622 EXEC SQL
> 070622    INCLUDE SQLDA
> 070622 END-EXEC
> 070622
> 070622 EXEC SQL
> 070622    INCLUDE SQLCA
> 070622 END-EXEC
> 070622
> 070622 EXEC SQL
> 070622    BEGIN DECLARE SECTION
> 070622 END-EXEC
> 070622
> 070622 01  SQLCMD                      PIC X(1024).
> 070622 01  SVR                         PIC X(32).
> 070622 01  USR                         PIC X(32).
> 070622 01  PASS                        PIC X(32).
> 070622 01  USR-PASS                    PIC X(64).
> 070622
> 070622 01  WS-SQL-DATA.
> 070622     05  WS-CYCLE-DATE           PIC X(10).
> 070622     05  WS-NEXT-BUS-DT          PIC X(10).
> 070622     05  WS-LOOKUPID             PIC X(4).
> 070622     05  WS-LOOKUPNAME           PIC X(4).
> 070622     05  WS-LOOKUP-VALUE         PIC X(100).
> 070622     05  WS-CARRIER              PIC X.
> 070622     05  WS-GROUP                PIC X(6).
> 070622     05  WS-STATE                PIC XX.
> 070622     05  WS-ACCOUNT              PIC X(10).
> 070622     05  WS-EFF-DT               PIC XX.
> 070622     05  WS-CERT-NO              PIC X(10).
> 070622     05  WS-CERT-NO-SUF          PIC X(01).
> 070622
> 070622 EXEC SQL
> 070622    END DECLARE SECTION
> 070622 END-EXEC
> 011514 01  P pointer.
> 011514 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
> 011514 01  KIXHOST             pic x(9) value Z"HOSTNAME".
> 011514 01  var-ptr pointer.
> 011514 01  env-var-len                 pic 9(4)  binary.
> 011514 01  rc                          pic 9(9)  binary.
> 011514
> 011514 01  WS-KIXHOST                  PIC X(10).
> 011514 01  WS-KIXSYS.
> 011514     05  WS-KIX-FIL1             PIC X(10).
> 011514     05  WS-KIX-APPS             PIC X(10).
> 011514     05  WS-KIX-ENV              PIC X(10).
> 011514     05  WS-KIX-MYENV            PIC X(10).
> 011514     05  WS-KIX-SYS              PIC X(10).
313a368
> 070622         16  ER-1590             PIC  X(04)      VALUE '1590'.
440,441c495,499
< 072312     05  FILLER                  PIC X(306).
< 
---
> 072312     05  CG-DCC-REASON-CD        PIC X.
> 122712     05  CG-COMM-PCT-ZERO        PIC X.
> 100917     05  cg-vin                  pic x(17).
> 101918     05  cg-from-where           pic x(6).
> 100917     05  FILLER                  PIC X(281).
607a666
> 011514 01  var  pic x(30).
702a762,790
> 070622
> 070622     set P to address of KIXSYS
> 070622     CALL "getenv" using by value P returning var-ptr
> 070622     if var-ptr = null then
> 070622        display ' kixsys not set '
> 070622     else
> 070622        set address of var to var-ptr
> 070622        move 0 to env-var-len
> 070622        inspect var tallying env-var-len
> 070622          for characters before X'00'
> 070622        unstring var (1:env-var-len) delimited by '/'
> 070622        into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
> 070622              WS-KIX-SYS
> 070622        end-unstring
> 070622     end-if
> 070622
> 070622     set P to address of KIXHOST
> 070622     CALL "getenv" using by value P returning var-ptr
> 070622     if var-ptr = null then
> 070622        display ' kixhost not set '
> 070622     else
> 070622        set address of var to var-ptr
> 070622        move 0 to env-var-len
> 070622        inspect var tallying env-var-len
> 070622          for characters before X'00'
> 070622        MOVE var(1:env-var-len)  to ws-kixhost
> 070622        DISPLAY ' WS KIX HOST ' WS-KIXHOST
> 070622     end-if.
> 
797,798c885,888
<               MOVE ' '                 TO PI-CANCEL-REASON
<               MOVE AL-UANON            TO CANREAA
---
> 070622        IF CANREAI > SPACES
> 070622           MOVE CANREAI             TO PI-CANCEL-REASON
>                  MOVE AL-UANON            TO CANREAA
>               END-IF
799a890,891
> 
> 070622     PERFORM 0450-CHECK-CANCEL-REASON THRU 0450-EXIT.
959a1052
> 070622        MOVE PI-CANCEL-REASON TO PI-CANCEL-REASON-631
970a1064,1109
> 070622 0450-CHECK-CANCEL-REASON.
> 070622
> 070622*      Read Napersoft CancelReasons Lookup Table
> 070622     MOVE 'naperadmin'           TO USR
> 070622     MOVE 'cCm8naper'            TO PASS
> 070622     IF WS-KIXHOST = 'logictest'
> 070622        MOVE 'HOVTSTDB01_NaperRepo'
> 070622                                 TO SVR
> 070622        MOVE '1029'              TO WS-LOOKUPID
> 070622     ELSE
> 070622        MOVE 'SDVDB01_NaperRepo' TO SVR
> 070622        MOVE '1029'              TO WS-LOOKUPID
> 070622     END-IF
> 070622
> 070622     MOVE SPACES                 TO WS-LOOKUP-VALUE
> 070622
> 070622     PERFORM 4100-CONNECT-TO-DB  THRU 4100-EXIT
> 070622     MOVE PI-CANCEL-REASON TO WS-LOOKUPNAME
> 070622
> 070622     EXEC SQL
> 070622           SELECT LOOKUPVALUE
> 070622             INTO :WS-LOOKUP-VALUE
> 070622             FROM LOOKUPVALUES
> 070622               WHERE LOOKUPID = :WS-LOOKUPID
> 070622                 AND LOOKUPNAME = :WS-LOOKUPNAME
> 070622     END-EXEC
> 070622
> 070622     IF SQLCODE = 0
> 070622        CONTINUE
> 070622     ELSE
> 070622     IF SQLCODE = 100
> 070622         MOVE -1                    TO CANREAL
> 070622         MOVE AL-UANON              TO CANREAA
> 070622         MOVE ER-1590               TO EMI-ERROR
> 070622         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
> 070622     ELSE
> 070622        DISPLAY "ERROR: INVALID CancelReasons Lookup Table SELECT"
> 070622        DISPLAY ' SQL RETURN CODE ' SQLCODE
> 070622        DISPLAY ' SQL ERR MESS    ' SQLERRMC
> 070622     END-IF.
> 070622
> 070622     PERFORM 4300-DISCONNECT THRU 4300-EXIT.
> 070622
> 070622 0450-EXIT.
> 070622     EXIT.
> 
987d1125
<            MOVE PI-CANCEL-REASON       TO  CANREAO
1624a1763,1768
> 070622     IF AM-GPCD > 1
> 070622       AND AM-GPCD < 6
> 070622       AND PI-CANCEL-REASON NOT > SPACES
> 070622        MOVE 'Y'                 TO PI-CANCEL-REASON
> 070622     END-IF.
>            MOVE PI-CANCEL-REASON       TO  CANREAO
1917a2062,2068
> 070622           IF CM-INSURED-JOINT-AGE LESS CM-INSURED-ISSUE-AGE
> 070622               MOVE CM-INSURED-JOINT-AGE TO WS-EDIT-AGE
> 070622           ELSE
> 070622               MOVE CM-INSURED-ISSUE-AGE TO WS-EDIT-AGE
> 070622           END-IF
> 070622           COMPUTE WS-ATT-AGE = WS-EDIT-AGE
> 070622              + ((CM-LF-ORIG-TERM - CP-REMAINING-TERM-3) / 12)
1919,1920c2070,2072
<                     (P1 > +8)
<                     OR (PD-PROD-CODE (P1) = 'L')
---
> PEMTST              (P1 > +11)
>                     OR ((PD-PROD-CODE (P1) = 'L' OR 'O')
> 070622                AND (PD-MAX-ATT-AGE (P1) >= WS-ATT-AGE))
1922c2074
<                  IF P1 < +9
---
> PEMTST           IF P1 < +12
3310a3463
> 070622     MOVE PI-CANCEL-REASON       TO CG-DCC-REASON-CD
3367a3521,3560
> 070622 4100-CONNECT-TO-DB.
> 070622
> 070622     IF SVR > SPACES
> 070622        CONTINUE
> 070622     ELSE
> 070622        MOVE 'NTCSO2_LOGIC'         TO SVR
> 070622        MOVE 'sa'                   TO USR
> 070622        MOVE 'ntcso2'               TO PASS
> 070622     END-IF
> 070622
> 070622     STRING
> 070622         USR DELIMITED SPACE
> 070622         "." DELIMITED SIZE
> 070622         PASS DELIMITED SPACE INTO USR-PASS
> 070622     END-STRING
> 070622
> 070622     EXEC SQL
> 070622        CONNECT TO :SVR USER :USR-PASS
> 070622     END-EXEC
> 070622
> 070622     IF SQLCODE NOT = 0
> 070622        DISPLAY "ERROR: CANNOT CONNECT "
> 070622        DISPLAY SQLCODE
> 070622        DISPLAY SQLERRMC
> 070622        GO TO 4100-EXIT
> 070622     END-IF
> 070622
> 070622     .
> 070622 4100-EXIT.
> 070622     EXIT.
> 070622 4300-DISCONNECT.
> 070622
> 070622     EXEC SQL
> 070622        DISCONNECT
> 070622     END-EXEC
> 070622     .
> 070622 4300-EXIT.
> 070622     EXIT.
> 
> 
4042,4044c4235,4237
< 020816        MOVE AL-SADOF            TO CANREAHA
< 020816                                    CLPYNHA
< 020816                                    CANREAA
---
> 070622*       MOVE AL-SADOF            TO CANREAHA
> 020816        MOVE AL-SADOF            TO CLPYNHA
> 070622*                                   CANREAA

</pre>
<h3><a name="EL6301.cl2">EL6301.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

0a1
>       $SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
55a57
> 070622* 070622  CR2020061200002  TANA  Add cancel reason logic
64a67
> 101110 77  A1                          PIC S999 COMP-3 VALUE +0.
87a91,107
> 070622 EXEC SQL
> 070622    INCLUDE SQLDA
> 070622 END-EXEC
> 070622
> 070622 EXEC SQL
> 070622    INCLUDE SQLCA
> 070622 END-EXEC
> 070622
> 070622 EXEC SQL
> 070622    BEGIN DECLARE SECTION
> 070622 END-EXEC
> 070622
> 070622 01  SQLCMD                      PIC X(1024).
> 070622 01  SVR                         PIC X(32).
> 070622 01  USR                         PIC X(32).
> 070622 01  PASS                        PIC X(32).
> 070622 01  USR-PASS                    PIC X(64).
88a109,141
> 070622
> 070622 01  WS-SQL-DATA.
> 070622     05  WS-CYCLE-DATE           PIC X(10).
> 070622     05  WS-NEXT-BUS-DT          PIC X(10).
> 070622     05  WS-LOOKUPID             PIC X(4).
> 070622     05  WS-LOOKUPNAME           PIC X(4).
> 070622     05  WS-LOOKUP-VALUE         PIC X(100).
> 070622     05  WS-CARRIER              PIC X.
> 070622     05  WS-GROUP                PIC X(6).
> 070622     05  WS-STATE                PIC XX.
> 070622     05  WS-ACCOUNT              PIC X(10).
> 070622     05  WS-EFF-DT               PIC XX.
> 070622     05  WS-CERT-NO              PIC X(10).
> 070622     05  WS-CERT-NO-SUF          PIC X(01).
> 070622
> 070622 EXEC SQL
> 070622    END DECLARE SECTION
> 070622 END-EXEC
> 
> 070622 01  P pointer.
> 070622 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
> 070622 01  KIXHOST                     pic x(9) value Z"HOSTNAME".
> 070622 01  var-ptr pointer.
> 070622 01  env-var-len                 pic 9(4)  binary.
> 070622 01  rc                          pic 9(9)  binary.
> 070622
> 070622 01  WS-KIXSYS.
> 070622     05  WS-KIX-FIL1             PIC X(10).
> 070622     05  WS-KIX-APPS             PIC X(10).
> 070622     05  WS-KIX-ENV              PIC X(10).
> 070622     05  WS-KIX-MYENV            PIC X(10).
> 070622     05  WS-KIX-SYS              PIC X(10).
> 070622 01  WS-KIXHOST                  PIC X(10).
229a283,291
> 070622     12  ERACCT-KEY.
> 070622         16  ERACCT-COMPANY-CD          PIC  X.
> 070622         16  ERACCT-CARRIER             PIC  X.
> 070622         16  ERACCT-GROUPING            PIC  X(6).
> 070622         16  ERACCT-STATE               PIC  XX.
> 070622         16  ERACCT-ACCOUNT             PIC  X(10).
> 070622         16  ERACCT-EXP-DT.
> 070622             20  ERACCT-DT              PIC  XX.
> 070622             20  ERACCT-FILL            PIC  X(4).
742c804,805
< 00684                                                                   
---
> 070622     COPY ERCACCT.
> 00686      EJECT
748a812
> 070622 01  var                         pic x(30).
755a820,855
> 070622     move spaces to ws-kix-myenv
> 070622     set P to address of KIXSYS
> 070622     CALL "getenv" using by value P returning var-ptr
> 070622     if var-ptr = null then
> 070622        display ' kixsys not set '
> 070622     else
> 070622        set address of var to var-ptr
> 070622        move 0 to env-var-len
> 070622        inspect var tallying env-var-len
> 070622          for characters before X'00'
> 070622        unstring var (1:env-var-len) delimited by '/'
> 070622           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
> 070622              WS-KIX-SYS
> 070622        end-unstring
> 070622     end-if
> 070622     perform varying a1 from +1 by +1 until a1 > +10
> 070622        if ws-kix-myenv (a1:1) = low-values or high-values
> 070622           display ' found low or hi val '
> 070622           move spaces to ws-kix-myenv (a1:1)
> 070622        end-if
> 070622     end-perform
> 
> 070622     set P to address of KIXHOST
> 070622     CALL "getenv" using by value P returning var-ptr
> 070622     if var-ptr = null then
> 070622        display ' kixhost not set '
> 070622     else
> 070622        set address of var to var-ptr
> 070622        move 0 to env-var-len
> 070622        inspect var tallying env-var-len
> 070622          for characters before X'00'
> 070622        MOVE var(1:env-var-len)  to ws-kixhost
> 070622        DISPLAY ' WS KIX HOST ' WS-KIXHOST
> 070622     end-if.
> 
>       *    display ' env *' ws-kix-myenv '*'
3513,3518c3613,3623
< 02951          MOVE 'Y'                TO  PI-CAN-REA-KEYED-SW         
<                IF CCANREA (WS-SUB2) = 'R' OR ' '
< 02956             MOVE CCANREA (WS-SUB2)                                
< 02957                                  TO  WS-CAN-REA (WS-SUB2)        
< 02958              MOVE AL-UANON       TO  CCANREA-ATTRB (WS-SUB2)    
< 02959          ELSE                                                     
---
> 02951         MOVE 'Y'                TO  PI-CAN-REA-KEYED-SW
> 070622        PERFORM 1150-CHECK-CANCEL-REASON THRU 1150-EXIT
> 070622        IF SQLCODE = ZERO
> 02956             MOVE CCANREA (WS-SUB2) TO  WS-CAN-REA (WS-SUB2)
> 02958             MOVE AL-UANON       TO  CCANREA-ATTRB (WS-SUB2)
>       *        IF CCANREA (WS-SUB2) = 'R' OR ' '
> 02956 *           MOVE CCANREA (WS-SUB2)
> 02957 *                                TO  WS-CAN-REA (WS-SUB2)
> 02958 *            MOVE AL-UANON       TO  CCANREA-ATTRB (WS-SUB2)
>               ELSE
> 070622        IF SQLCODE = 100
3612c3717,3759
< 03053      EJECT                                                        
---
> 070622 1150-CHECK-CANCEL-REASON.
> 070622
> 070622*      Read Napersoft CancelReasons Lookup Table
> 070622     MOVE 'naperadmin'           TO USR
> 070622     MOVE 'cCm8naper'            TO PASS
> 070622     IF WS-KIXHOST = 'logictest'
> 070622        MOVE 'HOVTSTDB01_NaperRepo'
> 070622                                 TO SVR
> 070622        MOVE '1029'              TO WS-LOOKUPID
> 070622     ELSE
> 070622        MOVE 'SDVDB01_NaperRepo' TO SVR
> 070622        MOVE '1029'              TO WS-LOOKUPID
> 070622     END-IF
> 070622
> 070622     MOVE SPACES                 TO WS-LOOKUP-VALUE
> 070622
> 070622     PERFORM 9000-CONNECT-TO-DB  THRU 9000-EXIT
> 070622
> 070622     MOVE CCANREA (WS-SUB2) TO WS-LOOKUPNAME
> 070622
> 070622     EXEC SQL
> 070622           SELECT LOOKUPVALUE
> 070622             INTO :WS-LOOKUP-VALUE
> 070622             FROM LOOKUPVALUES
> 070622               WHERE LOOKUPID = :WS-LOOKUPID
> 070622                 AND LOOKUPNAME = :WS-LOOKUPNAME
> 070622     END-EXEC
> 070622
> 070622     IF SQLCODE = 0
> 070622      OR SQLCODE = 100
> 070622        CONTINUE
> 070622     ELSE
> 070622        DISPLAY "ERROR: INVALID CancelReasons Lookup Table SELECT"
> 070622        DISPLAY ' SQL RETURN CODE ' SQLCODE
> 070622        DISPLAY ' SQL ERR MESS    ' SQLERRMC
> 070622     END-IF.
> 070622
> 070622     PERFORM 9050-DISCONNECT THRU 9050-EXIT.
> 070622
> 070622 1150-EXIT.
> 070622     EXIT.
> 
> 03053      EJECT
5542c5689,5706
< 04805  6880-DELETE-ERROR.                                               
---
> 070622 6410-READ-ERACCT.
> 070622
> 070622     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
> 070622     MOVE LOW-VALUES             TO ERACCT-FILL
> 070622
> 070622     EXEC CICS READ
> 070622          DATASET   ('ERACCT')
> 070622          INTO      (ACCOUNT-MASTER)
> 070622          RIDFLD    (ERACCT-KEY)
> 070622          GTEQ
> 070622          RESP      (WS-RESPONSE)
> 070622     END-EXEC
> 070622
> 070622     .
> 070622 6410-EXIT.
> 070622     EXIT.
> 
> 04805  6880-DELETE-ERROR.
5911c6075,6083
<            END-IF
---
> 070622     ELSE
> 070622        PERFORM 6410-READ-ERACCT THRU 6410-EXIT
> 070622        IF AM-GPCD > 1
> 070622          AND AM-GPCD < 6
> 070622           MOVE 'Y'                 TO PB-C-CANCEL-REASON
> 070622           MOVE PB-C-CANCEL-REASON  TO CCANREA (1)
> 070622           MOVE AL-UANON            TO CCANREA-ATTRB (1)
> 070622        END-IF
>            END-IF.
6292a6465,6502
> 070622
> 070622 9000-CONNECT-TO-DB.
> 070622
> 070622     IF SVR > SPACES
> 070622        CONTINUE
> 070622     ELSE
> 070622        MOVE 'NTCSO2_LOGIC'         TO SVR
> 070622        MOVE 'sa'                   TO USR
> 070622        MOVE 'ntcso2'               TO PASS
> 070622     END-IF
> 070622
> 070622     STRING
> 070622         USR DELIMITED SPACE
> 070622         "." DELIMITED SIZE
> 070622         PASS DELIMITED SPACE INTO USR-PASS
> 070622     END-STRING
> 070622
> 070622     EXEC SQL
> 070622        CONNECT TO :SVR USER :USR-PASS
> 070622     END-EXEC
> 070622
> 070622     IF SQLCODE NOT = 0
> 070622        DISPLAY "ERROR: CANNOT CONNECT "
> 070622        DISPLAY SQLCODE
> 070622        DISPLAY SQLERRMC
> 070622     END-IF
> 070622
> 070622     .
> 070622 9000-EXIT.
> 070622     EXIT.
> 070622 9050-DISCONNECT.
> 070622
> 070622     EXEC SQL
> 070622        DISCONNECT
> 070622     END-EXEC
> 070622     .
> 070622 9050-EXIT.
> 070622     EXIT.

</pre>
<h3><a name="EL6311.cl2">EL6311.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

0a1
>       $SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
94a96
> 070622* 070622  CR2020061200002  TANA  Add cancel reason logic
142a145,179
> 070622 EXEC SQL
> 070622    INCLUDE SQLDA
> 070622 END-EXEC
> 070622
> 070622 EXEC SQL
> 070622    INCLUDE SQLCA
> 070622 END-EXEC
> 070622
> 070622 EXEC SQL
> 070622    BEGIN DECLARE SECTION
> 070622 END-EXEC
> 070622
> 070622 01  SQLCMD                      PIC X(1024).
> 070622 01  SVR                         PIC X(32).
> 070622 01  USR                         PIC X(32).
> 070622 01  PASS                        PIC X(32).
> 070622 01  USR-PASS                    PIC X(64).
> 070622
> 070622 01  WS-SQL-DATA.
> 070622     05  WS-CYCLE-DATE           PIC X(10).
> 070622     05  WS-NEXT-BUS-DT          PIC X(10).
> 070622     05  WS-LOOKUPID             PIC X(4).
> 070622     05  WS-LOOKUPNAME           PIC X(4).
> 070622     05  WS-LOOKUP-VALUE         PIC X(100).
> 070622     05  WS-CARRIER              PIC X.
> 070622     05  WS-GROUP                PIC X(6).
> 070622     05  WS-STATE                PIC XX.
> 070622     05  WS-ACCOUNT              PIC X(10).
> 070622     05  WS-EFF-DT               PIC XX.
> 070622     05  WS-CERT-NO              PIC X(10).
> 070622     05  WS-CERT-NO-SUF          PIC X(01).
> 070622
> 070622 EXEC SQL
> 070622    END DECLARE SECTION
> 070622 END-EXEC
145a183
> 070622 01  KIXHOST                     pic x(9) value Z"HOSTNAME".
155a194
> 070622 01  WS-KIXHOST                  PIC X(10).
916a956,957
> 070622     12  ER-1590                 PIC  9(4) VALUE 1590.
> 070622     12  ER-1591                 PIC  9(4) VALUE 1591.
1309a1351,1363
> 070622     set P to address of KIXHOST
> 070622     CALL "getenv" using by value P returning var-ptr
> 070622     if var-ptr = null then
> 070622        display ' kixhost not set '
> 070622     else
> 070622        set address of var to var-ptr
> 070622        move 0 to env-var-len
> 070622        inspect var tallying env-var-len
> 070622          for characters before X'00'
> 070622        MOVE var(1:env-var-len)  to ws-kixhost
> 070622        DISPLAY ' WS KIX HOST ' WS-KIXHOST
> 070622     end-if.
> 
6428,6435c6482,6490
<               IF CCANREAI = 'R' OR ' '
<                  CONTINUE
<               ELSE
<                  MOVE ER-9841        TO EMI-ERROR
<                  MOVE -1             TO CCANREAL
<                  MOVE AL-UABON       TO CCANREAA
<                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
<               END-IF
---
> 070622        MOVE CCANREAI            TO PI-CANCEL-REASON-631
> 070622*       IF CCANREAI = 'R' OR ' '
> 070622*          CONTINUE
> 070622*       ELSE
> 070622*          MOVE ER-9841        TO EMI-ERROR
> 070622*          MOVE -1             TO CCANREAL
> 070622*          MOVE AL-UABON       TO CCANREAA
> 070622*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
> 070622*       END-IF
6558a6614,6622
> 070622     IF PI-CANCEL-REASON-631 > SPACES
> 070622        PERFORM 2050-CHECK-CANCEL-REASON THRU 2050-EXIT
> 070622     ELSE
> 070622        MOVE ER-1591        TO EMI-ERROR
> 070622        MOVE -1             TO CCANREAL
> 070622        MOVE AL-UABON       TO CCANREAA
> 070622        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
> 070622     END-IF
> 
6572a6637,6681
> 070622 2050-CHECK-CANCEL-REASON.
> 070622
> 070622*      Read Napersoft CancelReasons Lookup Table
> 070622     MOVE 'naperadmin'           TO USR
> 070622     MOVE 'cCm8naper'            TO PASS
> 070622     IF WS-KIXHOST = 'logictest'
> 070622        MOVE 'HOVTSTDB01_NaperRepo'
> 070622                                 TO SVR
> 070622        MOVE '1029'              TO WS-LOOKUPID
> 070622     ELSE
> 070622        MOVE 'SDVDB01_NaperRepo' TO SVR
> 070622        MOVE '1029'              TO WS-LOOKUPID
> 070622     END-IF
> 070622
> 070622     MOVE SPACES                 TO WS-LOOKUP-VALUE
> 070622
> 070622     PERFORM 9000-CONNECT-TO-DB  THRU 9000-EXIT
> 070622     MOVE PI-CANCEL-REASON-631 TO WS-LOOKUPNAME
> 070622
> 070622     EXEC SQL
> 070622           SELECT LOOKUPVALUE
> 070622             INTO :WS-LOOKUP-VALUE
> 070622             FROM LOOKUPVALUES
> 070622               WHERE LOOKUPID = :WS-LOOKUPID
> 070622                 AND LOOKUPNAME = :WS-LOOKUPNAME
> 070622     END-EXEC
> 070622
> 070622     IF SQLCODE = 0
> 070622        CONTINUE
> 070622     ELSE
> 070622     IF SQLCODE = 100
> 070622        MOVE ER-1590        TO EMI-ERROR
> 070622        MOVE -1             TO CCANREAL
> 070622        MOVE AL-UABON       TO CCANREAA
> 070622        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
> 070622     ELSE
> 070622        DISPLAY "ERROR: INVALID CancelReasons Lookup Table SELECT"
> 070622        DISPLAY ' SQL RETURN CODE ' SQLCODE
> 070622        DISPLAY ' SQL ERR MESS    ' SQLERRMC
> 070622     END-IF.
> 070622
> 070622     PERFORM 9050-DISCONNECT THRU 9050-EXIT.
> 070622
> 070622 2050-EXIT.
> 070622     EXIT.
6760a6870
> 070622        MOVE CCANREAI            TO PI-CANCEL-REASON-631
7306a7417
> 070622        MOVE CCANREAI            TO PI-CANCEL-REASON-631
12297a12409,12418
> 070622     PERFORM 6210-READ-ERACCT THRU 6210-EXIT
> 070622     IF (RESP-NORMAL)
> 070622       AND (PB-CONTROL-BY-ACCOUNT (1:20) =
> 070622          AM-CONTROL-PRIMARY (1:20))
> 070622       IF AM-GPCD > 1
> 070622         AND AM-GPCD < 6
> 070622         AND PB-C-CANCEL-REASON NOT > SPACES
> 070622          MOVE 'Y'                     TO PB-C-CANCEL-REASON
> 070622       END-IF
> 070622     END-IF.
12299c12420
< 
---
> 070622                                        PI-CANCEL-REASON-631
13956a14078,14115
> 070622
> 070622 9000-CONNECT-TO-DB.
> 070622
> 070622     IF SVR > SPACES
> 070622        CONTINUE
> 070622     ELSE
> 070622        MOVE 'NTCSO2_LOGIC'         TO SVR
> 070622        MOVE 'sa'                   TO USR
> 070622        MOVE 'ntcso2'               TO PASS
> 070622     END-IF
> 070622
> 070622     STRING
> 070622         USR DELIMITED SPACE
> 070622         "." DELIMITED SIZE
> 070622         PASS DELIMITED SPACE INTO USR-PASS
> 070622     END-STRING
> 070622
> 070622     EXEC SQL
> 070622        CONNECT TO :SVR USER :USR-PASS
> 070622     END-EXEC
> 070622
> 070622     IF SQLCODE NOT = 0
> 070622        DISPLAY "ERROR: CANNOT CONNECT "
> 070622        DISPLAY SQLCODE
> 070622        DISPLAY SQLERRMC
> 070622     END-IF
> 070622
> 070622     .
> 070622 9000-EXIT.
> 070622     EXIT.
> 070622 9050-DISCONNECT.
> 070622
> 070622     EXEC SQL
> 070622        DISCONNECT
> 070622     END-EXEC
> 070622     .
> 070622 9050-EXIT.
> 070622     EXIT.

</pre>
<h3><a name="EL677.cl2">EL677.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

43a44
> 070622* 070622  CR2020061200002  TANA  Add payee code
193a195,196
> 070622     05  db-payeecode            pic x(10).
> 
1759a1763,1764
> 070622     MOVE CH-PAYEE-CODE          TO db-payeecode
> 
1802c1807,1808
< 091615           CheckSubType)
---
> 091615           CheckSubType,
> 070622           PayeeCode)
1832c1838,1839
< 091615           :db-check-sub-type)
---
> 091615           :db-check-sub-type,
> 070622           :db-payeecode)
1835,1836c1842,1843
<       *    display ' about to insert '
<       *    display ' db-compid     ' db-compid
---
>            display ' about to insert '
>            display ' db-compid     ' db-compid
1842c1849,1851
<       *    display ' cert          ' db-certificate
---
>            display ' cert          ' db-certificate
>            display ' payee code ' CH-PAYEE-CODE
> 

</pre>
<h3><a name="ELC631PI">ELC631PI</a><br><a href="#topper">Back to Top</a><br><pre>

27a28
> 070622*         CR2020061200002  TANA  ADD Cancel Reason Code
136c137,138
< 021414             20  FILLER                       PIC X(4).              CL*11
---
> 070622             20  PI-CANCEL-REASON-631         PIC X.
> 070622             20  FILLER                       PIC X(3).              CL*11

</pre>
<h3><a name="ELCANC.cl2">ELCANC.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

58c58,59
< 101918* 101918 CR2018050200001  PEMA  Add check for cancel rec
---
> 101918* 101918  CR2018050200001  PEMA  Add check for cancel rec
> 070622* 070622  CR2020061200002  TANA  Add cancel reason logic
471c472,474
< 020816     IF CG-COMPANY-ID = 'DCC' or 'VPP'
---
> 020816*    IF CG-COMPANY-ID = 'DCC' or 'VPP'
> 070622     IF CG-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
> 070622       AND CG-DCC-REASON-CD  > SPACES
473c476,489
<            END-IF
---
> 070622     ELSE
> 070622     IF AM-GPCD > 1
> 070622       AND AM-GPCD < 6
> 070622        MOVE 'Y'              TO PB-C-CANCEL-REASON
> 070622     END-IF.
> 
> 070622     IF CG-FROM-WHERE = 'EL1273'
> 070622        EVALUATE CG-OPTION-CODE
> 070622           WHEN '3'
> 070622              MOVE 'F'              TO PB-C-CANCEL-REASON
> 070622           WHEN '1'
> 070622              MOVE 'X'              TO PB-C-CANCEL-REASON
> 070622        END-EVALUATE
> 070622     END-IF

</pre>
<h3><a name="NSCASOUTB">NSCASOUTB</a><br><a href="#topper">Back to Top</a><br><pre>

13a14
> 070622* 070622  CR2020061200002  TANA  ADD REFUND CHECK INFO
338a340,347
> 070622    05  OUT-REF-PAYEE           PIC X(30) VALUE SPACES.
> 070622    05  OUT-REF-ADDRESS         PIC X(30) VALUE SPACES.
> 070622    05  OUT-REF-CITY            PIC X(30) VALUE SPACES.
> 070622    05  OUT-REF-STATE           PIC X(02) VALUE SPACES.
> 070622    05  OUT-REF-ZIP             PIC X(11) VALUE SPACES.
> 070622    05  OUT-REF-CHK-AMOUNT      PIC 9(7).99 VALUE ZEROS.
> 070622    05  OUT-CANCEL-REASON       PIC X.
> 070622    05  OUT-REF-PAYEE-CODE      PIC X(10) VALUE SPACES.

</pre>
<h3><a name="NSCASVARS">NSCASVARS</a><br><a href="#topper">Back to Top</a><br><pre>

14a15
> 070622* 070622  CR2020061200002  TANA  ADD REFUND CHECK INFO
654a656,671
> 070622    05  F                       PIC X(11) VALUE "~REFPAYEE=".
> 070622    05  OUT-REF-PAYEE           PIC X(30) VALUE SPACES.
> 070622    05  F                       PIC X(09) VALUE "~REFADDR=".
> 070622    05  OUT-REF-ADDRESS         PIC X(30) VALUE SPACES.
> 070622    05  F                       PIC X(09) VALUE "~REFCITY=".
> 070622    05  OUT-REF-CITY            PIC X(30) VALUE SPACES.
> 070622    05  F                       PIC X(10) VALUE "~REFSTATE=".
> 070622    05  OUT-REF-STATE           PIC X(02) VALUE SPACES.
> 070622    05  F                       PIC X(08) VALUE "~REFZIP=".
> 070622    05  OUT-REF-ZIP             PIC X(11) VALUE SPACES.
> 070622    05  F                       PIC X(10) VALUE "~REFCKAMT=".
> 070622    05  OUT-REF-CHK-AMOUNT      PIC 9(7).99 VALUE ZEROS.
> 070622    05  F                       PIC X(09) VALUE "~CANREAS=".
> 070622    05  OUT-CANCEL-REASON       PIC X.
> 070622    05  F                       PIC X(11) VALUE "~REFPAYCD=".
> 070622    05  OUT-REF-PAYEE-CODE      PIC X(10) VALUE SPACES.

</pre>
<h3><a name="NSRASBL.cl2">NSRASBL.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

43a44
> 070622* 070622  CR2020061200002  TANA  ADD CANCEL REAS, PAYEE, CHK AMT
86a88,89
> 070622 77  WS-CONNECT-SW               PIC X  VALUE ' '.
> 070622     88  CONNECTED-TO-DB             VALUE 'Y'.
146a150,206
> 070622     05  WS-CARRIER              PIC X.
> 070622     05  WS-GROUP                PIC X(6).
> 070622     05  WS-STATE                PIC XX.
> 070622     05  WS-ACCOUNT              PIC X(10).
> 070622     05  WS-EFF-DT               PIC XX.
> 070622     05  WS-CERT-NO              PIC X(10).
> 070622     05  WS-CERT-NO-SUF          PIC X(01).
> 070622
> 070622 01  indicator-vaiables-for-nulls.
> 070622     05  nu-app-status           pic s9(4) comp value +0.
> 070622     05  nu-app-by               pic s9(4) comp value +0.
> 070622     05  nu-app-date             pic s9(4) comp value +0.
> 070622     05  nu-app-batch            pic s9(4) comp value +0.
> 070622
> 070622 01  daily-check-request-rec.
> 070622     05  db-compid               pic xxx.
> 070622     05  db-carrier              pic x.
> 070622     05  db-grouping             pic x(6).
> 070622     05  db-state                pic xx.
> 070622     05  db-account              pic x(10).
> 070622     05  db-effdate              pic x(10).
> 070622     05  db-certificate          pic x(10).
> 070622     05  db-cert-sfx             pic x.
> 070622     05  db-seq-no               pic 999.
> 070622     05  db-type                 pic x.
> 070622     05  db-amount-n             PIC S9(13)V99   COMP-3.
> 070622*    05  db-amount redefines db-amount-n
> 070622*                                pic x(10).
> 070622     05  db-checkno              pic x(15).
> 070622     05  db-checkdate            pic x(10).
> 070622     05  db-checkstatus          pic 9(5).
> 070622     05  db-releasebatch         pic 9(5).
> 070622     05  db-releasedt            pic x(10).
> 070622     05  db-releaseby            pic x(4).
> 070622     05  db-payeename1           pic x(30).
> 070622     05  db-payeename2           pic x(30).
> 070622     05  db-payeeaddr1           pic x(30).
> 070622     05  db-payeeaddr2           pic x(30).
> 070622     05  db-payeecity            pic x(30).
> 070622     05  db-payeest              pic xx.
> 070622     05  db-payeezip             pic x(10).
> 070622     05  db-fincar               pic x.
> 070622     05  db-fingrp               pic x(6).
> 070622     05  db-finresp              pic x(10).
> 070622     05  db-finacct              pic x(10).
> 070622     05  db-preparer             pic x(4).
> 070622     05  db-app-status           pic x(9).
> 070622     05  dp-app-status-n redefines db-app-status
> 070622                                 pic 9(9).
> 070622     05  db-app-by               pic x(20).
> 070622     05  db-app-date             pic x(30).
> 070622     05  db-app-batch            pic x(10).
> 070622     05  db-return-to            pic x(30).
> 070622     05  db-insured-name         pic x(30).
> 070622     05  db-check-sub-type       pic x.
> 070622     05  db-payeecode            pic x(10).
> 
847a908,916
> 070622           IF BL-DATA-SRCE = '4'
> 070622             AND PROCESS-CANCEL
> 070622              MOVE PB-C-CANCEL-REASON  TO OUT-CANCEL-REASON
> 070622              DISPLAY ' CANCEL-REASON ' OUT-CANCEL-REASON
> 070622              IF PB-C-REFUND-CREATED
> 070622                 PERFORM 2000-GET-CANCEL-REFUND THRU 2000-EXIT
> 070622              END-IF
> 070622           END-IF
> 
3642a3712,3806
> 070622 2000-GET-CANCEL-REFUND.
> 070622     IF NOT CONNECTED-TO-DB
> 070622        PERFORM 4150-CONNECT-TO-DB-CHECK THRU 4150-EXIT
> 070622     END-IF
> 070622
> 070622     MOVE WS-ELCERT-CARRIER           TO WS-CARRIER
> 070622     MOVE WS-ELCERT-GROUP             TO WS-GROUP
> 070622     MOVE WS-ELCERT-STATE             TO WS-STATE
> 070622     MOVE WS-ELCERT-ACCOUNT           TO WS-ACCOUNT
> 070622     MOVE OUT-CERT-EFF-DT             TO WS-EFF-DT
> 070622     MOVE WS-ELCERT-CERT-NO           TO WS-CERT-NO
> 070622     MOVE WS-ELCERT-CERT-NO(11:1)     TO WS-CERT-NO-SUF
> 070622     DISPLAY 'WS-ELCERT-KEY ' WS-ELCERT-KEY
> 070622
> 070622     EXEC SQL
> 070622        SELECT TOP 1
> 070622           Company,
> 070622           CertCarrier,
> 070622           CertGroup,
> 070622           CertState,
> 070622           CertAccount,
> 070622           CertEffDate,
> 070622           CertNumber,
> 070622           CertNumberSuf,
> 070622           CheckSeqNbr,
> 070622           CheckType,
> 070622           CheckAmount,
> 070622           PayeeName1,
> 070622           PayeeAddress1,
> 070622           PayeeCity,
> 070622           PayeeState,
> 070622           PayeeZIP,
> 070622           Preparer,
> 070622           CheckSubType,
> 070622           PayeeCode
> 070622        INTO
> 070622           :db-compid,
> 070622           :db-carrier,
> 070622           :db-grouping,
> 070622           :db-state,
> 070622           :db-account,
> 070622           :db-effdate,
> 070622           :db-certificate,
> 070622           :db-cert-sfx,
> 070622           :db-seq-no,
> 070622           :db-type,
> 070622           :db-amount-n,
> 070622           :db-payeename1,
> 070622           :db-payeeaddr1,
> 070622           :db-payeecity,
> 070622           :db-payeest,
> 070622           :db-payeezip,
> 070622           :db-preparer,
> 070622           :db-check-sub-type,
> 070622           :db-payeecode
> 070622        FROM
> 070622           ChkApp_Check
> 070622        WHERE
> 070622                  CertCarrier = :WS-CARRIER
> 070622             and  CertGroup   = :WS-GROUP
> 070622             and  CertState   = :WS-STATE
> 070622             and  CertAccount = :WS-ACCOUNT
> 070622*            and  CertEffDate = :WS-EFF-DT
> 070622             and  CertNumber  = :WS-CERT-NO
> 070622             AND  CertNumberSuf = :WS-CERT-NO-SUF
> 070622             AND CheckSubType = 1
> 070622        ORDER BY RELEASEDATE DESC
> 070622     end-exec
> 070622
> 070622     IF SQLCODE = 0
> 070622       OR SQLCODE = 1
> 070622        MOVE db-payeename1  TO OUT-REF-PAYEE
> 070622        DISPLAY ' payeename1 ' OUT-REF-PAYEE
> 070622        MOVE db-payeeaddr1  TO OUT-REF-ADDRESS
> 070622        MOVE db-payeecity   TO OUT-REF-CITY
> 070622        MOVE db-payeest     TO OUT-REF-STATE
> 070622        MOVE db-payeezip    TO OUT-REF-ZIP
> 070622        MOVE db-amount-n    TO OUT-REF-CHK-AMOUNT
> 070622        DISPLAY ' CHECK AMOUNT '  OUT-REF-CHK-AMOUNT
> 070622        MOVE db-payeecode   TO OUT-REF-PAYEE-CODE
> 070622        DISPLAY ' payeecode ' OUT-REF-PAYEE-CODE
> 070622     ELSE
> 070622        DISPLAY ' DIS SQL CODE ' SQLCODE
> 070622        DISPLAY "ERROR: CANNOT READ ROW ChkApp_Check "
> 070622        DISPLAY ' SQL RETURN CODE ' SQLCODE
> 070622        DISPLAY ' SQL ERR MESS    ' SQLERRMC
> 070622     END-IF
> 070622
> 070622     PERFORM 4300-DISCONNECT THRU 4300-EXIT
> 070622     MOVE SPACES TO WS-CONNECT-SW
> 070622
> 070622     .
> 070622
> 070622 2000-EXIT.
> 070622     EXIT.
3675a3840,3869
>        4150-CONNECT-TO-DB-CHECK.
> 030921     move 'HOVTSTDB01_ChkApprv'  to svr
> 030921     move 'appuser'              to usr
> 030921     move 'appuser@cso'          to pass
> 021714
> 021714     if ws-kix-myenv = 'cid1p'
> 030921        move 'SDVDB01_ChkApprv'  to svr
> 030921        move 'appuser'           to usr
> 030921        move 'appuser@cso'       to pass
> 021714     end-if
>            string
>                usr delimited space
>                "." delimited size
>                pass delimited space into usr-pass
>            end-string
>            EXEC SQL
>               CONNECT TO :svr USER :usr-pass
>            END-EXEC
>            IF SQLCODE NOT = 0
>               DISPLAY "ERROR: CANNOT CONNECT "
>               DISPLAY SQLCODE
>               DISPLAY SQLERRMC
>            END-IF
>            SET CONNECTED-TO-DB TO TRUE
>            DISPLAY ' CONNECTED '   svr
> 
>            .
>        4150-EXIT.
>            EXIT.
> 

</pre>
</body></html>