<html>
<head>
<title>Compare Module List</title>
</head>
<body style="background-color:PowderBlue;"><div align="center"><h2>Compares for CC-7912-PEMA.ini</h2>
<h3>Processed on - 03/02/2022</h3></div>
<a name="topper"></a>
<a href="#inifile">INI File</a><br>
<a href="#EL130.cl2">EL130.cl2</a><br>
<a href="#EL131.cl2">EL131.cl2</a><br>
<a href="#EL156.cl2">EL156.cl2</a><br>
<h3>INI FILE As submitted by programmer, followed by log information <h3>
<pre>

[2021081200003]
[/apps/test/cid1s/jcl/daily_jobs/;/apps/prod/cid1p/jcl/daily_jobs/]
[/apps/test/cid1s/jcl/monthly_jobs/;/apps/prod/cid1p/jcl/monthly_jobs/]
[/apps/test/cid1s/jcl/quarterly_jobs/;/apps/prod/cid1p/jcl/quarterly_jobs/]
[/apps/test/cid1s/jcl/yearly_jobs/;/apps/prod/cid1p/jcl/yearly_jobs/]
[/export/home/pema/;/export/home/mtpadmin/]
[/export/home/pema/bin/;/export/home/mtpadmin/bin/]
[/data/test/seqfiles/;/data/seqfiles/]
[/apps/test/cid1s/sys/webroot/;/apps/prod/cid1p/sys/webroot/]
[/apps/test/cid1s/sys/webroot/napersoft/;/apps/prod/cid1p/sys/webroot/napersoft/]
[/apps/test/cid1s/sys/webroot/AdminServ/;/apps/prod/cid1p/sys/webroot/AdminServ/]
[/apps/test/cid1s/sys/webroot/balancesheet/images/;/apps/prod/cid1p/sys/webroot/balancesheet/images/]
[/apps/test/cid1s/sys/webroot/balancesheet/javascript/;/apps/prod/cid1p/sys/webroot/balancesheet/javascript/]
[/apps/test/cid1s/sys/webroot/balancesheet/style/;/apps/prod/cid1p/sys/webroot/balancesheet/style/]
[/apps/test/cid1s/maps/;/apps/prod/cid1p/maps/]
[/apps/test/cid1s/copy/;/apps/prod/cid1p/copy/]
[/apps/test/cid1s/emails/;/apps/prod/cid1p/emails/]
[/apps/test/cid1s/parmlib/;/apps/prod/cid1p/parmlib/]
[/apps/test/cid1s/src/batch/;/apps/prod/cid1p/src/batch/]
[/apps/test/cid1s/src/online/;/apps/prod/cid1p/src/online/]
EL130.cl2=
EL130.cbl=
EL130.lst=
EL131.cl2=
EL131.cbl=
EL131.lst=
EL156.cl2=
EL156.cbl=
EL156.lst=
[/apps/test/cid1s/exe/onl/;/apps/prod/cid1p/staging/exe_onl/]
EL130.gnt=
EL131.gnt=
EL156.gnt=
[/apps/test/cid1s/exe/bat/;/apps/prod/cid1p/staging/exe_bat/]
Archive Process Successfull using - perl /export/home/mtpadmin/bin/mtp_archive.pl CC-7912-PEMA.ini
Move Process Successfull using - perl /export/home/mtpadmin/bin/mtp_move.pl CC-7912-PEMA.ini
Promote process successfull and verified using - perl /export/home/mtpadmin/bin/mtp_verify.pl CC-7912-PEMA.ini
Archived module - /apps/prod/cid1p/src/online/archive/EL130.cl2.20220302
Archived module - /apps/prod/cid1p/src/online/archive/EL130.cbl.20220302
Archived module - /apps/prod/cid1p/src/online/archive/EL130.lst.20220302
Archived module - /apps/prod/cid1p/src/online/archive/EL131.cl2.20220302
Archived module - /apps/prod/cid1p/src/online/archive/EL131.cbl.20220302
Archived module - /apps/prod/cid1p/src/online/archive/EL131.lst.20220302
Archived module - /apps/prod/cid1p/src/online/archive/EL156.cl2.20220302
Archived module - /apps/prod/cid1p/src/online/archive/EL156.cbl.20220302
Archived module - /apps/prod/cid1p/src/online/archive/EL156.lst.20220302
Archived module - /apps/prod/cid1p/exe/onl/archive/EL130.gnt.20220302
Archived module - /apps/prod/cid1p/exe/onl/archive/EL131.gnt.20220302
Archived module - /apps/prod/cid1p/exe/onl/archive/EL156.gnt.20220302
moved module - /apps/prod/cid1p/src/online/EL130.cl2
moved module - /apps/prod/cid1p/src/online/EL130.cbl
moved module - /apps/prod/cid1p/src/online/EL130.lst
moved module - /apps/prod/cid1p/src/online/EL131.cl2
moved module - /apps/prod/cid1p/src/online/EL131.cbl
moved module - /apps/prod/cid1p/src/online/EL131.lst
moved module - /apps/prod/cid1p/src/online/EL156.cl2
moved module - /apps/prod/cid1p/src/online/EL156.cbl
moved module - /apps/prod/cid1p/src/online/EL156.lst
moved module - /apps/prod/cid1p/staging/exe_onl/EL130.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/EL131.gnt
moved module - /apps/prod/cid1p/staging/exe_onl/EL156.gnt

</pre>
<h3><a name="EL130.cl2">EL130.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

51a52
> 090821* 090821  CR2021081200003  PEMA  Add error if inc > act cnc dt
115a117,129
> 090821 01  filler.
> 090821     05  ws-prev-inc-dt          pic xx value low-values.
> 090821     05  ws-mob-cert-ind         pic x value ' '.
> 090821         88  mob-cert        value 'M'.
> 090821     05  ws-eracct-startbr-ind   pic x  value spaces.
> 090821         88  eracct-browse-started  value 'Y'.
> 090821     05  ws-lo-acct-dt           pic xx value low-values.
> 090821     05  ws-hi-acct-dt           pic xx value low-values.
> 090821     05  ws-acct-status          pic x value spaces.
> 090821         88  acct-cancelled          value '3'.
> 090821     05  WS-I-SAY-STOP-IND       PIC X  VALUE ' '.
> 090821         88  i-say-STOP            value 'S'.
> 
116a131,136
> 090821     12  er-1679-text        pic x(60) value
> 090821       '1679-N CONTRACT IS NOT CONTESTABLE'.
> 090821     12  er-1682-text        pic x(60) value
> 090821       '1682-N INC DATE > MOB ACCOUNT CANCEL DATE'.
> 090821     12  er-1683-text        pic x(60) value
> 090821       '1683-N INC DATE < CERTIFICATE EFF DATE'.
648a669,670
> 090821     12  er-1682                 pic x(4)  value '1682'.
> 090821     12  er-1683                 pic x(4)  value '1683'.
3688a3711,3771
> 090821     if clmtypei = 'L' or 'O'
> 090821        move cm-lf-benefit-cd    to ws-ben-hold
> 090821        move '4'                 to ws-rec-type
> 090821        perform 7100-read-benefit thru 7199-exit
> 090821        if ws-ben-alpha-hold <> spaces
> 090821           move ws-special-calc-cd
> 090821                                 to ws-lf-special-calc-cd
> 090821        end-if
> 090821     else
> 090821        move cm-ah-benefit-cd    to ws-ben-hold
> 090821        move '5'                 to ws-rec-type
> 090821        perform 7100-read-benefit thru 7199-exit
> 090821        if ws-ben-alpha-hold <> spaces
> 090821           move ws-special-calc-cd
> 090821                                 to ws-ah-special-calc-cd
> 090821        end-if
> 090821     end-if
> 090821
> 090821     move ' '                    to ws-mob-cert-ind
> 090821     if pi-company-id = 'CID'
> 090821        if ((CLMTYPEI = PI-LIFE-OVERRIDE-L1 or 'O')
> 090821           and (ws-lf-special-calc-cd = 'O'))
> 090821                      or
> 090821           ((clmtypei <> pi-life-override-l1 and 'O')
> 090821           and (ws-ah-special-calc-cd = 'O'))
> 090821           set mob-cert to true
> 090821        end-if
> 090821     else
> 090821        if (pi-company-id = 'DCC')
> 090821           and (cm-carrier = '7')
> 090821           set mob-cert to true
> 090821        end-if
> 090821     end-if
> 090821 
> 090821     perform 7990-get-lo-hi-acct-dates
> 090821                                 thru 7990-exit
> 090821 
> 090821     if (ws-incur >= ws-hi-acct-dt)
> 090821        and (acct-cancelled)
> 090821        and (mob-cert)
> 090821        MOVE er-1682             TO EMI-ERROR
> 090821        MOVE -1                  TO INCURL
> 090821        MOVE AL-UABON            TO INCURA
> 090821        PERFORM 9900-ERROR-FORMAT
> 090821                                 THRU 9900-EXIT
> 090821        PERFORM 3992-BUILD-TRAILER
> 090821                                 THRU 3992-EXIT
> 090821     end-if
> 090821
> 090821     if ws-incur < cm-cert-eff-dt
> 090821        MOVE er-1683             TO EMI-ERROR
> 090821        MOVE -1                  TO INCURL
> 090821        MOVE AL-UABON            TO INCURA
> 090821        PERFORM 9900-ERROR-FORMAT
> 090821                                 THRU 9900-EXIT
> 090821        PERFORM 3992-BUILD-TRAILER
> 090821                                 THRU 3992-EXIT
> 090821     end-if
> 
>            .
>        3990-continue.
3802,3806c3885,3898
< 061418     IF EMI-ERROR = ER-7572
< 061418        MOVE +97             TO AT-SEQUENCE-NO
< 061418     ELSE
< 101917        MOVE +96             TO AT-SEQUENCE-NO
< 061418     END-IF
---
> 090821     evaluate true
> 090821        when emi-error = er-1679
> 090821           move er-1679-text     to at-info-line-1
> 090821        when emi-error = er-1682
> 090821           move er-1682-text     to at-info-line-1
> 090821        when emi-error = er-1683
> 090821           move er-1683-text     to at-info-line-1
> 090821     end-evaluate
> 090821     move +97                to at-sequence-no
> 061418*     IF EMI-ERROR = ER-7572
> 061418*        MOVE +97             TO AT-SEQUENCE-NO
> 061418*     ELSE
> 101917*        MOVE +96             TO AT-SEQUENCE-NO
> 061418*     END-IF
3814,3818c3906,3910
< 061418     IF EMI-ERROR = ER-7572
< 061418        MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
< 061418     ELSE
< 101917        MOVE EMI-LINE2 TO AT-INFO-LINE-1
< 061418     END-IF
---
> 061418*     IF EMI-ERROR = ER-7572
> 061418*        MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
> 061418*     ELSE
> 101917*        MOVE EMI-LINE2 TO AT-INFO-LINE-1
> 061418*     END-IF
5075c5167,5168
< 03678      MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.           
---
> 03678      MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT
> 090821                                    ws-prev-inc-dt
5161a5255,5326
> 
> 090821     if clmtypei = 'L' or 'O'
> 090821        move cm-lf-benefit-cd    to ws-ben-hold
> 090821        move '4'                 to ws-rec-type
> 090821        perform 7100-read-benefit thru 7199-exit
> 090821        if ws-ben-alpha-hold <> spaces
> 090821           move ws-special-calc-cd
> 090821                                 to ws-lf-special-calc-cd
> 090821        end-if
> 090821     else
> 090821        move cm-ah-benefit-cd    to ws-ben-hold
> 090821        move '5'                 to ws-rec-type
> 090821        perform 7100-read-benefit thru 7199-exit
> 090821        if ws-ben-alpha-hold <> spaces
> 090821           move ws-special-calc-cd
> 090821                                 to ws-ah-special-calc-cd
> 090821        end-if
> 090821     end-if
> 090821 
> 090821     move ' '                    to ws-mob-cert-ind
> 090821     if pi-company-id = 'CID'
> 090821        if ((CLMTYPEI = PI-LIFE-OVERRIDE-L1 or 'O')
> 090821           and (ws-lf-special-calc-cd = 'O'))
> 090821                      or
> 090821           ((clmtypei <> pi-life-override-l1 and 'O')
> 090821           and (ws-ah-special-calc-cd = 'O'))
> 090821           set mob-cert to true
> 090821        end-if
> 090821     else
> 090821        if (pi-company-id = 'DCC')
> 090821           and (cm-carrier = '7')
> 090821           set mob-cert to true
> 090821        end-if
> 090821     end-if
> 090821 
> 090821     perform 7990-get-lo-hi-acct-dates
> 090821                                 thru 7990-exit
> 090821 
>       ** if the prev inc dt >= hi dt then probably
>       ** have error already set
>            if ws-prev-inc-dt >= ws-hi-acct-dt
>               continue
>            else
> 090821        if (ws-incur >= ws-hi-acct-dt)
> 090821           and (acct-cancelled)
> 090821           and (mob-cert)
> 090821           MOVE er-1682          TO EMI-ERROR
> 090821           MOVE -1               TO INCURL
> 090821           MOVE AL-UABON         TO INCURA
> 090821           PERFORM 9900-ERROR-FORMAT
> 090821                                 THRU 9900-EXIT
> 090821           PERFORM 3992-BUILD-TRAILER
> 090821                                 THRU 3992-EXIT
> 090821        end-if
>            end-if
> 090821
>            if ws-prev-inc-dt < cm-cert-eff-dt
>               continue
>            else
> 090821        if ws-incur < cm-cert-eff-dt
> 090821           MOVE er-1683          TO EMI-ERROR
> 090821           MOVE -1               TO INCURL
> 090821           MOVE AL-UABON         TO INCURA
> 090821           PERFORM 9900-ERROR-FORMAT
> 090821                                 THRU 9900-EXIT
> 090821           PERFORM 3992-BUILD-TRAILER
> 090821                                 THRU 3992-EXIT
> 090821        end-if
>            end-if
> 
>            .
>        5035-continue.
6001a6167
> 
6474c6640
< 04880                                                                   
---
> 
8092a8259,8281
> 06154  7930-READ-CERT-UPDATE.                                           
> 06155      
>            EXEC CICS READ
> 06156          DATASET  (ELCERT-DSID)
> 06157          SET      (ADDRESS OF CERTIFICATE-MASTER)
> 06158          RIDFLD   (ELCERT-KEY)
> 06159          UPDATE
> 06160      END-EXEC.
> 06161                                                                   
> 06162  7930-EXIT.                                                       
> 06163       EXIT.                                                       
> 06164                                                                   
> 06165  7940-READ-CERT.                                                  
> 06166      
>            EXEC CICS READ
> 06167          DATASET  (ELCERT-DSID)
> 06168          SET      (ADDRESS OF CERTIFICATE-MASTER)
> 06169          RIDFLD   (ELCERT-KEY)
> 06170      END-EXEC.
> 06171                                                                   
> 06172  7940-EXIT.                                                       
> 06173       EXIT.                                                       
> 
8160,8183c8349,8408
< 06154  7930-READ-CERT-UPDATE.                                           
< 06155      
<            EXEC CICS READ
< 06156          DATASET  (ELCERT-DSID)
< 06157          SET      (ADDRESS OF CERTIFICATE-MASTER)
< 06158          RIDFLD   (ELCERT-KEY)
< 06159          UPDATE
< 06160      END-EXEC.
< 06161                                                                   
< 06162  7930-EXIT.                                                       
< 06163       EXIT.                                                       
< 06164                                                                   
< 06165  7940-READ-CERT.                                                  
< 06166      
<            EXEC CICS READ
< 06167          DATASET  (ELCERT-DSID)
< 06168          SET      (ADDRESS OF CERTIFICATE-MASTER)
< 06169          RIDFLD   (ELCERT-KEY)
< 06170      END-EXEC.
< 06171                                                                   
< 06172  7940-EXIT.                                                       
< 06173       EXIT.                                                       
< 06174                                                                   
< 06175      EJECT                                                        
---
> 090821 7990-get-lo-hi-acct-dates.
> 
> 090821     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
> 090821     MOVE PI-CARRIER          TO ACCT-CARRIER
> 090821     MOVE PI-GROUPING         TO ACCT-GROUPING
> 090821     MOVE PI-STATE            TO ACCT-STATE
> 090821     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
> 090821     MOVE low-values          TO ACCT-EXP-DT
> 090821     MOVE ERACCT-KEY          TO SAVE-ERACCT-KEY
> 090821
> 090821     move spaces              to ws-i-say-stop-ind
> 090821                                 ws-eracct-startbr-ind
> 090821                                 ws-acct-status
> 090821
> 090821     EXEC CICS STARTBR
> 090821          DATASET    ('ERACCT')
> 090821          RIDFLD     (ERACCT-KEY)
> 090821          GTEQ
> 090821          resp       (ws-response)
> 090821     END-EXEC
> 
> 090821     if ws-resp-normal
> 090821        set eracct-browse-started to true
> 090821     end-if
> 090821
> 090821     perform until i-say-stop
> 090821        EXEC CICS READNEXT
> 090821           DATASET ('ERACCT')
> 090821           RIDFLD  (ERACCT-KEY)
> 090821           SET     (ADDRESS OF ACCOUNT-MASTER)
> 090821           resp    (WS-RESPONSE)
> 090821        END-EXEC
> 090821
> 090821        IF WS-RESP-NORMAL
> 090821           AND save-eracct-key(1:20) =
> 090821                       AM-CONTROL-PRIMARY (1:20)
> 090821           if ws-lo-acct-dt = low-values
> 090821              move am-effective-dt
> 090821                                 to ws-lo-acct-dt
> 090821           end-if
> 090821           if am-expiration-dt > ws-hi-acct-dt
> 090821              move am-expiration-dt
> 090821                                 to ws-hi-acct-dt
> 090821           end-if
> 090821           move am-status        to ws-acct-status
> 090821        else
> 090821           set i-say-stop to true
> 090821        end-if
> 090821     end-perform
> 090821
> 090821     if eracct-browse-started
> 090821        exec cics endbr
> 090821           dataset('ERACCT')
> 090821        end-exec
> 090821     end-if
> 090821
> 090821     .
> 090821 7990-exit.
> 090821     exit.
> 

</pre>
<h3><a name="EL131.cl2">EL131.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

54a55
> 090821* 090821  CR2021081200003  PEMA  Add error if inc > act cnc dt
89d89
< 
99a100
> 090821 77  sub                         pic s999 comp-3 value +0.
222c223,245
< 00130                                                                      CL*34
---
> 
> 090821 01  filler.
> 090821     05  ws-prev-inc-dt          pic xx value low-values.
> 090821     05  ws-mob-cert-ind         pic x value ' '.
> 090821         88  mob-cert        value 'M'.
> 090821     05  ws-eracct-startbr-ind   pic x  value spaces.
> 090821         88  eracct-browse-started  value 'Y'.
> 090821     05  ws-lo-acct-dt           pic xx value low-values.
> 090821     05  ws-hi-acct-dt           pic xx value low-values.
> 090821     05  ws-acct-status          pic x value spaces.
> 090821         88  acct-cancelled          value '3'.
> 090821     05  WS-I-SAY-STOP-IND       PIC X  VALUE ' '.
> 090821         88  i-say-STOP            value 'S'.
> 090821     05  er-1679-text        pic x(60) value
> 090821       '1679-N CONTRACT IS NOT CONTESTABLE'.
> 090821     05  er-1682-text        pic x(60) value
> 090821       '1682-N INC DATE > MOB ACCOUNT CANCEL DATE'.
> 090821     05  er-1683-text        pic x(60) value
> 090821       '1683-N INC DATE < CERTIFICATE EFF DATE'.
> 090821     05  ws-rec-type             pic x.
> 090821     05  ws-ben-hold             pic xx.
> 090821     05  ws-special-calc-cd      pic x.
> 
606a630,631
> 090821     12  er-1682                 pic x(4)    value '1682'.
> 090821     12  er-1683                 pic x(4)    value '1683'.
724a750,752
> 090821     12  CNTL-bene-ACCESS REDEFINES CNTL-PROC-ID.
> 090821         16  filler              PIC XX.                          EL131
> 090821         16  cntl-benefit        PIC XX.                          EL131
1773c1801
< 01330      IF INCL GREATER THAN ZERO                                    EL131
---
> 01330      IF INCL GREATER THAN ZERO
1796,1799c1824,1831
< 01353                  MOVE 'X'        TO ERROR-SWITCH                  EL131
< 01354        ELSE                                                       EL131
< 01355            IF PI-NO-PMTS = ZEROS                                  EL131
< 01356                MOVE AL-UANOF     TO INCA.                         EL131
---
> 01353                  MOVE 'X'        TO ERROR-SWITCH
> 090821             end-if
> 090821         end-if
> 01354      ELSE
> 01355         IF PI-NO-PMTS = ZEROS
> 01356            MOVE AL-UANOF     TO INCA
> 090821        end-if
> 090821     end-if
5108a5141,5166
> 090821     if incl > zeros
> 090821        move cl-incurred-dt      to ws-prev-inc-dt
> 090821        perform 7990-get-lo-hi-acct-dates
> 090821                                 thru 7990-exit
> 090821        if (hold-incur >= ws-hi-acct-dt)
> 090821           and (acct-cancelled)
> 090821           and (mob-cert)
> 090821           MOVE er-1682          TO EMI-ERROR
> 090821           MOVE -1               TO INCL
> 090821           MOVE AL-UABON         TO INCA
> 090821           PERFORM 9900-ERROR-FORMAT
> 090821                                 THRU 9900-EXIT
> 090821           PERFORM 2620-CHECK-TRLR
> 090821                                 THRU 2620-EXIT
> 090821        end-if
> 090821        if hold-incur < cm-cert-eff-dt
> 090821           MOVE er-1683          TO EMI-ERROR
> 090821           MOVE -1               TO INCL
> 090821           MOVE AL-UABON         TO INCA
> 090821           PERFORM 9900-ERROR-FORMAT
> 090821                                 THRU 9900-EXIT
> 090821           PERFORM 2620-CHECK-TRLR
> 090821                                 THRU 2620-EXIT
> 090821        end-if
> 090821     end-if
> 
5266a5325,5374
> 090821 2620-CHECK-TRLR.
> 090821
> 090821     MOVE SPACES                 TO AT-GENERAL-INFO-TR
> 090821     INITIALIZE AT-GENERAL-INFO-TR
> 090821     MOVE MSTR-KEY               TO AT-CONTROL-PRIMARY
> 090821     MOVE 'AT'                   TO AT-RECORD-ID
> 090821     evaluate true
> 090821        when emi-error = er-1679
> 090821           move er-1679-text     to at-info-line-1
> 090821        when emi-error = er-1682
> 090821           move er-1682-text     to at-info-line-1
> 090821        when emi-error = er-1683
> 090821           move er-1683-text     to at-info-line-1
> 090821     end-evaluate
> 090821     move +97                    to at-sequence-no
> 090821     MOVE '6'                    TO AT-TRAILER-TYPE
> 090821     MOVE save-bin-date          TO AT-RECORDED-DT
> 090821                                    AT-GEN-INFO-LAST-MAINT-DT
> 090821     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
> 090821                                    AT-GEN-INFO-LAST-UPDATED-BY
> 090821     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
> 090821
> 090821     MOVE SPACES                 TO AT-INFO-LINE-2
> 090821
> 090821     .
> 090821 2620-WRITE.
> 090821
> 090821     EXEC CICS HANDLE CONDITION
> 090821         DUPREC    (2620-DUPREC)
> 090821     END-EXEC.
> 090821
> 090821     EXEC CICS WRITE
> 090821          DATASET     ('ELTRLR')
> 090821          FROM        (ACTIVITY-TRAILERS)
> 090821          RIDFLD      (AT-CONTROL-PRIMARY)
> 090821      END-EXEC
> 090821
> 090821     GO TO 2620-EXIT
> 090821
> 090821     .
> 090821 2620-DUPREC.
> 090821
> 090821     SUBTRACT +1 FROM AT-SEQUENCE-NO
> 090821     GO TO 2620-WRITE
> 090821
> 090821     .
> 090821 2620-EXIT.
> 090821     EXIT.
> 
> 
6999d7106
< 04956      EJECT                                                           CL**8
7387c7494,7630
< 05323      EJECT                                                           CL*26
---
> 
> 090821 7900-READ-BENEFIT.
> 090821
> 090821     move spaces                 to cntl-key
> 090821     move pi-company-id          to cntl-co-id
> 090821     if cl-claim-type = 'L' or 'O' or 'P'
> 090821        move cm-lf-benefit-cd    to cntl-benefit
> 090821                                    ws-ben-hold
> 090821        move '4'                 to cntl-rec-type
> 090821                                    ws-rec-type
> 090821     else
> 090821        move cm-ah-benefit-cd    to cntl-benefit
> 090821                                    ws-ben-hold
> 090821        move '5'                 to cntl-rec-type
> 090821                                    ws-rec-type
> 090821     end-if
> 090821     MOVE ZEROS                  TO CNTL-SEQ-NO
> 090821
> 090821     .
> 090821 7900-READ-FILE.                                                  
> 090821
> 090821     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT
> 090821
> 090821     if not WS-RESP-NORMAL
> 090821        go to 7900-not-found
> 090821     end-if
> 090821
> 090821     IF (PI-COMPANY-ID NOT = CF-COMPANY-ID)  OR
> 090821        (WS-REC-TYPE   NOT = CF-RECORD-TYPE)
> 090821        GO TO 7900-NOT-FOUND
> 090821     END-IF
> 090821                                                                  
> 090821     MOVE 1                      TO SUB
> 090821
> 090821     .
> 090821 7900-LOOP.                                                       
> 090821     IF SUB = 9                                                   
> 090821         GO TO 7900-NOT-FOUND
> 090821     END-IF
> 090821                                                                  
> 090821     IF WS-BEN-HOLD <> CF-BENEFIT-CODE (SUB)                   
> 090821        ADD 1                    TO SUB                           
> 090821        GO TO 7900-LOOP
> 090821     END-IF
> 090821                                                                  
> 090821     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.        
> 090821     if (ws-special-calc-cd = 'O')
> 090821                OR
> 090821        (pi-company-id = 'DCC' and cl-carrier = '7')
> 090821        set mob-cert to true
> 090821     end-if
> 090821     GO TO 7900-EXIT
> 090821
> 090821     .                                                                        
> 090821 7900-NOT-FOUND.                                                  
> 090821     MOVE SPACES                 TO WS-special-calc-cd
> 090821
> 090821     .                                                                        
> 090821 7900-EXIT.                                                       
> 090821      EXIT.                                                       
> 090821
> 090821 7975-READ-CNTL-GTEQ.                                             
> 090821     
> 090821     EXEC CICS READ
> 090821          DATASET   ('ELCNTL')
> 090821          SET       (ADDRESS OF CONTROL-FILE)
> 090821          RIDFLD    (CNTL-KEY)
> 090821          resp      (ws-response)
> 090821          GTEQ
> 090821      END-EXEC.
> 090821                                                                  
> 090821 7975-EXIT.                                                       
> 090821      EXIT.                                                       
>                                                                         
> 090821 7990-get-lo-hi-acct-dates.
> 090821
> 090821     MOVE PI-COMPANY-CD       TO ACCT-company-code
> 090821     MOVE PI-CARRIER          TO ACCT-CARRIER
> 090821     MOVE PI-GROUPING         TO ACCT-GROUP
> 090821     MOVE PI-STATE            TO ACCT-STATE
> 090821     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
> 090821     MOVE low-values          TO ACCT-date
> 090821     MOVE ACCT-KEY            TO SAVE-ACCT-KEY
> 090821
> 090821     move spaces              to ws-i-say-stop-ind
> 090821                                 ws-eracct-startbr-ind
> 090821                                 ws-acct-status
> 090821
> 090821     EXEC CICS STARTBR
> 090821          DATASET    ('ERACCT')
> 090821          RIDFLD     (ACCT-KEY)
> 090821          GTEQ
> 090821          resp       (ws-response)
> 090821     END-EXEC
> 090821
> 090821     if ws-resp-normal
> 090821        set eracct-browse-started to true
> 090821     end-if
> 090821
> 090821     perform until i-say-stop
> 090821        EXEC CICS READNEXT
> 090821           DATASET ('ERACCT')
> 090821           RIDFLD  (ACCT-KEY)
> 090821           SET     (ADDRESS OF ACCOUNT-MASTER)
> 090821           resp    (WS-RESPONSE)
> 090821        END-EXEC
> 090821
> 090821        IF WS-RESP-NORMAL
> 090821           AND save-acct-key(1:20) =
> 090821                       AM-CONTROL-PRIMARY (1:20)
> 090821           if ws-lo-acct-dt = low-values
> 090821              move am-effective-dt
> 090821                                 to ws-lo-acct-dt
> 090821           end-if
> 090821           if am-expiration-dt > ws-hi-acct-dt
> 090821              move am-expiration-dt
> 090821                                 to ws-hi-acct-dt
> 090821           end-if
> 090821           move am-status        to ws-acct-status
> 090821        else
> 090821           set i-say-stop to true
> 090821        end-if
> 090821     end-perform
> 090821
> 090821     if eracct-browse-started
> 090821        exec cics endbr
> 090821           dataset('ERACCT')
> 090821        end-exec
> 090821     end-if
> 090821
> 090821     perform 7900-READ-BENEFIT   thru 7900-exit
> 090821
> 090821     .
> 090821 7990-exit.
> 090821     exit.
> 
> 

</pre>
<h3><a name="EL156.cl2">EL156.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

74a75
> 090821* 090821  CR2021081200003  PEMA  Add error if inc > act cnc dt
676c677,678
< 00511      12  ER-1775                 PIC X(4)  VALUE '1775'.          EL156
---
> 090821     12  er-1681                 pic x(4)  value '1681'.
> 00511      12  ER-1775                 PIC X(4)  VALUE '1775'.
791a794,803
> 090821 01  filler.
> 090821     05  ws-eracct-startbr-ind   pic x  value spaces.
> 090821         88  eracct-browse-started  value 'Y'.
> 090821     05  ws-lo-acct-dt           pic xx value low-values.
> 090821     05  ws-hi-acct-dt           pic xx value low-values.
> 090821     05  ws-acct-status          pic x value spaces.
> 090821         88  acct-cancelled          value '3'.
> 090821     05  WS-I-SAY-STOP-IND       PIC X  VALUE ' '.
> 090821         88  i-say-STOP            value 'S'.
> 
2616c2628,2629
< 01919          MOVE ER-0458            TO EMI-ERROR                     EL156
---
> 090821         move er-1681            to emi-error
> 01919 *        MOVE ER-0458            TO EMI-ERROR                     EL156
2629c2642,2677
< 01925                                                                   EL156
---
> 
> 
> 090821     if cl-claim-type = PI-LIFE-OVERRIDE-L1 OR 'O'
> 090821        move cm-lf-benefit-cd    to ws-ben-cd
> 090821        move '4'                 to cntl-rec-type
> 090821     else
> 090821        move cm-ah-benefit-cd    to ws-ben-cd
> 090821        move '5'                 to cntl-rec-type
> 090821     end-if
> 090821     move ws-access              to cntl-access
> 090821     move pi-company-id          to cntl-comp-id
> 090821     move zeros                  to cntl-seq-no
> 090821     move 'BENE'                 to file-switch
> 090821     perform 7200-find-benefit   thru 7200-exit
> 090821     if not no-benefit-found
> 090821        move cf-special-calc-cd(sub-1)
> 090821                                 to ws-special-calc-cd
> 090821     end-if
> 090821
> 090821     perform 7990-get-lo-hi-acct-dates
> 090821                                 thru 7990-exit
> 090821     if (cl-incurred-dt >= ws-hi-acct-dt)
> 090821        and (acct-cancelled)
> 090821        and ((ws-special-calc-cd = 'O')
> 090821                 or
> 090821            (pi-company-id = 'DCC' AND cl-carrier = '7'))
> 090821        MOVE er-1681             TO EMI-ERROR
> 090821        PERFORM 1010-GENERAL-ERROR
> 090821                                 THRU 1010-EXIT
> 090821     end-if
> 090821
> 090821*    if (cl-incurred-dt < ws-lo-acct-dt)
> 090821*       MOVE er-1681             TO EMI-ERROR
> 090821*       PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
> 090821*    end-if
> 
3011c3059,3061
< 02244  1046-READNEXT-ERACCT.                                               CL*36
---
> 02244  1046-READNEXT-ERACCT.
> 
> 090821     set eracct-browse-started to true
3043c3093,3100
< 02276                                                                      CL*18
---
> 
> 090821     if eracct-browse-started
> 090821        exec cics endbr
> 090821           dataset('ERACCT')
> 090821        end-exec
> 090821        move spaces              to ws-eracct-startbr-ind
> 090821     end-if
> 
3992a4050
> 090821     move spaces to ws-eracct-startbr-ind
3998c4056,4059
< 03060                                                                   EL156
---
> 
> 090821     set eracct-browse-started to true
> 
>            .
4021c4082,4089
< 03083                                                                   EL156
---
> 
> 090821     if eracct-browse-started
> 090821        exec cics endbr
> 090821           dataset('ERACCT')
> 090821        end-exec
> 090821        move spaces to ws-eracct-startbr-ind
> 090821     end-if
> 
5367c5435,5442
< 04236                                                                   EL156
---
> 
> 090821     if eracct-browse-started
> 090821        exec cics endbr
> 090821           dataset('ERACCT')
> 090821        end-exec
> 090821        move spaces              to ws-eracct-startbr-ind
> 090821     end-if
> 
10858c10933,10991
< 07997      EJECT                                                        EL156
---
> 
> 090821 7990-get-lo-hi-acct-dates.
> 090821
> 090821     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
> 090821     MOVE PI-CARRIER          TO ACCT-CARRIER
> 090821     MOVE PI-GROUPING         TO ACCT-GROUPING
> 090821     MOVE PI-STATE            TO ACCT-STATE
> 090821     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
> 090821     MOVE low-values          TO ACCT-EXP-DT
> 090821     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
> 090821     move spaces              to ws-i-say-stop-ind
> 090821                                 ws-eracct-startbr-ind
> 090821                                 ws-acct-status
> 090821
> 090821     EXEC CICS STARTBR
> 090821          DATASET    ('ERACCT')
> 090821          RIDFLD     (ERACCT-KEY)
> 090821          GTEQ
> 090821          resp       (ws-response)
> 090821     END-EXEC
> 090821     if ws-resp-normal
> 090821        set eracct-browse-started to true
> 090821     end-if
> 090821
> 090821     perform until i-say-stop
> 090821        EXEC CICS READNEXT
> 090821           DATASET ('ERACCT')
> 090821           RIDFLD  (ERACCT-KEY)
> 090821           SET     (ADDRESS OF ACCOUNT-MASTER)
> 090821           resp    (WS-RESPONSE)
> 090821        END-EXEC
> 090821
> 090821        IF WS-RESP-NORMAL
> 090821           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
> 090821           if ws-lo-acct-dt = low-values
> 090821              move am-effective-dt
> 090821                                 to ws-lo-acct-dt
> 090821           end-if
> 090821           if am-expiration-dt > ws-hi-acct-dt
> 090821              move am-expiration-dt
> 090821                                 to ws-hi-acct-dt
> 090821           end-if
> 090821           move am-status        to ws-acct-status
> 090821        else
> 090821           set i-say-stop to true
> 090821        end-if
> 090821     end-perform
> 090821
> 090821     if eracct-browse-started
> 090821        exec cics endbr
> 090821           dataset('ERACCT')
> 090821        end-exec
> 090821        move spaces to ws-eracct-startbr-ind
> 090821     end-if
> 090821
> 090821     .
> 090821 7990-exit.
> 090821     exit.
> 

</pre>
</body></html>