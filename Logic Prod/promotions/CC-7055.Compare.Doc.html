<html>
<head>
<title>Compare Module List</title>
</head>
<body style="background-color:PowderBlue;"><div align="center"><h2>Compares for CC-7055-PEMA.ini</h2>
<h3>Processed on - 01/11/2019</h3></div>
<a name="topper"></a>
<a href="#inifile">INI File</a><br>
<a href="#EL677S.bms">EL677S.bms</a><br>
<a href="#EL677.cl2">EL677.cl2</a><br>
<h3>INI FILE As submitted by programmer, followed by log information <h3>
<pre>

[2018103100001]
[/apps/test/cid1s/jcl/daily_jobs/;/apps/prod/cid1p/jcl/daily_jobs/]
[/apps/test/cid1s/jcl/monthly_jobs/;/apps/prod/cid1p/jcl/monthly_jobs/]
[/apps/test/cid1s/jcl/quarterly_jobs/;/apps/prod/cid1p/jcl/quarterly_jobs/]
[/apps/test/cid1s/jcl/yearly_jobs/;/apps/prod/cid1p/jcl/yearly_jobs/]
[/export/home/pema/bin/;/export/home/mtpadmin/bin/]
[/data/test/seqfiles/;/data/seqfiles/]
[/apps/test/cid1s/sys/webroot/;/apps/prod/cid1p/sys/webroot/]
[/apps/test/cid1s/sys/webroot/balancesheet/;/apps/prod/cid1p/sys/webroot/balancesheet/]
[/apps/test/cid1s/sys/webroot/balancesheet/images/;/apps/prod/cid1p/sys/webroot/balancesheet/images/]
[/apps/test/cid1s/sys/webroot/balancesheet/javascript/;/apps/prod/cid1p/sys/webroot/balancesheet/javascript/]
[/apps/test/cid1s/sys/webroot/balancesheet/style/;/apps/prod/cid1p/sys/webroot/balancesheet/style/]
[/apps/test/cid1s/maps/;/apps/prod/cid1p/maps/]
EL677S.bms=
EL677S.map=
EL677S=
[/apps/test/cid1s/copy/;/apps/prod/cid1p/copy/]
[/apps/test/cid1s/emails/;/apps/prod/cid1p/emails/]
[/apps/test/cid1s/parmlib/;/apps/prod/cid1p/parmlib/]
[/apps/test/cid1s/src/batch/;/apps/prod/cid1p/src/batch/]
[/apps/test/cid1s/src/online/;/apps/prod/cid1p/src/online/]
EL677.cl2=
EL677.cbl=
EL677.lst=
[/apps/test/cid1s/exe/bat/;/apps/prod/cid1p/staging/exe_bat/]
[/apps/test/cid1s/exe/onl/;/apps/prod/cid1p/staging/exe_onl/]
EL677.gnt=
Archive Process Successfull using - perl /export/home/mtpadmin/bin/mtp_archive.pl CC-7055-PEMA.ini
Move Process Successfull using - perl /export/home/mtpadmin/bin/mtp_move.pl CC-7055-PEMA.ini
Promote process successfull and verified using - perl /export/home/mtpadmin/bin/mtp_verify.pl CC-7055-PEMA.ini
Archived module - /apps/prod/cid1p/maps/archive/EL677S.bms.20190111
Archived module - /apps/prod/cid1p/maps/archive/EL677S.map.20190111
Archived module - /apps/prod/cid1p/maps/archive/EL677S.20190111
Archived module - /apps/prod/cid1p/src/online/archive/EL677.cl2.20190111
Archived module - /apps/prod/cid1p/src/online/archive/EL677.cbl.20190111
Archived module - /apps/prod/cid1p/src/online/archive/EL677.lst.20190111
Archived module - /apps/prod/cid1p/exe/onl/archive/EL677.gnt.20190111
moved module - /apps/prod/cid1p/maps/EL677S.bms
moved module - /apps/prod/cid1p/maps/EL677S.map
moved module - /apps/prod/cid1p/maps/EL677S
moved module - /apps/prod/cid1p/src/online/EL677.cl2
moved module - /apps/prod/cid1p/src/online/EL677.cbl
moved module - /apps/prod/cid1p/src/online/EL677.lst
moved module - /apps/prod/cid1p/staging/exe_onl/EL677.gnt

</pre>
<h3><a name="EL677.cl2">EL677.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

38a39
> 111418* 111418  CR2018103100001  PEMA  ADD REISSUE CAPABILITY
51,52d51
<        77  s2                          pic s999 comp-3 value +0.
<        77  ws-display-amt              pic 9(9).99-.
72d70
< 021714 01  rc                          pic 9(9)  binary.
119,120d116
<        01  sqlcmd                      pic x(1024).
<        01  WS-MOE-DATE                 pic x(10).
150d145
<            05  nu-fincar               pic s9(4) comp value +0.
205,207d199
<            05  ws-ind                     pic s9(4) comp value +0.
<            05  ws-ind-red redefines ws-ind pic xx.
<            05  ws-display-ind             pic s9(7) value zeros.
218,220d209
<        01  ws-work-amt-alpha           pic x(10).
<        01  ws-work-amt-num redefines ws-work-amt-alpha
<                                        pic 9(8)v99.
238d226
< 00053      12  EL1273-TRANS-ID             PIC X(4)    VALUE 'EXX3'.    
262d249
< 00079      12  ERPNDM-FILE-ID              PIC X(8)    VALUE 'ERPNDM'.  
265d251
< 00083      12  WS-KEY-LENGTH               PIC S9(4)   VALUE +28   COMP.
282d267
< 00100      12  WS-AMT-PAID                 PIC S9(7)V99 VALUE +0.       
284,286d268
< 00104      12  WS-SV-CARRIER               PIC X       VALUE SPACES.    
< 00105      12  WS-SV-GROUPING              PIC X(6)    VALUE SPACES.    
< 00106      12  WS-SV-STATE                 PIC XX      VALUE SPACES.    
308,343d289
< 00127      12  WS-PY-ENTRY-COMMENT.                                     
< 00128          16  WS-PY-CURRENT-DATE      PIC X(6)    VALUE SPACES.    
< 00129          16  FILLER                  PIC X(13)   VALUE            
< 00130             ' MISC. CHECK '.                                      
< 00131          16  WS-PY-CURRENT-CERT      PIC X(10)   VALUE SPACES.    
< 00132          16  WS-PY-CURRENT-SUFFIX    PIC X       VALUE SPACE.     
< 00133      12  WS-PY-REF-COMMENT.                                       
< 00134          16  WS-PY-REF-DATE          PIC X(6)    VALUE SPACES.    
< 00135          16  FILLER                  PIC X(13)   VALUE            
< 00136             ' REFUND PYMT '.                                      
< 00137          16  WS-PY-REF-CERT          PIC X(10)   VALUE SPACES.    
< 00138          16  WS-PY-REF-SUFFIX        PIC X       VALUE SPACE.     
< 00139      12  WS-PY-END-COMMENT.                                       
< 00140          16  WS-PY-END-DATE          PIC X(6)    VALUE SPACES.    
< 00141          16  FILLER                  PIC X(13)   VALUE            
< 00142             ' ENDORSEMENT '.                                      
< 00143          16  WS-PY-END-CERT          PIC X(10)   VALUE SPACES.    
< 00144          16  WS-PY-END-SUFFIX        PIC X       VALUE SPACE.     
< 00145      12  WS-PY-DED-COMMENT.                                       
< 00146          16  WS-PY-DED-DATE          PIC X(6)    VALUE SPACES.    
< 00147          16  FILLER                  PIC X(13)   VALUE            
< 00148             ' STAT DEDUCT '.                                      
< 00149          16  WS-PY-DED-CERT          PIC X(10)   VALUE SPACES.    
< 00150          16  WS-PY-DED-SUFFIX        PIC X       VALUE SPACE.     
< 00151      12  WS-PY-ADDL-COMMENT.                                      
< 00152          16  WS-PY-ADDL-DATE         PIC X(6)    VALUE SPACES.    
< 00153          16  FILLER                  PIC X(13)   VALUE            
< 00154             ' ADDL CHARGE '.                                      
< 00155          16  WS-PY-ADDL-CERT         PIC X(10)   VALUE SPACES.    
< 00156          16  WS-PY-ADDL-SUFFIX       PIC X       VALUE SPACE.     
< 00157      12  WS-PY-REVERSAL-COMMENT.                                  
< 00158          16  WS-PY-REVERSAL-DATE     PIC X(6)    VALUE SPACES.    
< 00159          16  WS-PY-REVERSAL-TYPE     PIC X(13)   VALUE            
< 00160             ' VOID REFUND '.                                      
< 00161          16  WS-PY-REVERSAL-CERT     PIC X(10)   VALUE SPACES.    
< 00162          16  WS-PY-REVERSAL-SUFFIX   PIC X       VALUE SPACE.     
389,390d334
< 00203      12  ELCNTL-RECORD-LENGTH        PIC S9(4)   VALUE +750  COMP.
< 00204                                                                   
409,410d352
< 00223      12  ERACCT-RECORD-LENGTH        PIC S9(4)   VALUE +2000 COMP.
< 00224                                                                   
419,420d360
< 00233      12  ERCOMP-LENGTH               PIC S9(4)   VALUE +700  COMP.
< 00234                                                                   
431,432d370
< 00245      12  ELCERT-RECORD-LENGTH        PIC S9(4)   VALUE +450  COMP.
< 00246                                                                   
451,460d388
< 00265      12  ERPNDB-RECORD-LENGTH        PIC S9(4)   VALUE +585  COMP.
< 00266                                                                   
< 00267      12  ERPNDM-PRIMARY-KEY.                                      
< 00268          16 ERPNDM-COMPANY-CD        PIC X       VALUE SPACES.    
< 00269          16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.    
< 00270          16 ERPNDM-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
< 00271          16 ERPNDM-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
< 00272                                                                   
< 00273      12  ERPNDM-RECORD-LENGTH        PIC S9(4)   VALUE +250  COMP.
< 00274                                                                   
483,484d410
< 00310      12  ERPYAJ-RECORD-LENGTH        PIC S9(4)   VALUE +200  COMP.
< 00311                                                                   
486,543c412,459
< 00314      12  ER-0000                     PIC X(4)    VALUE '0000'.    
< 00315      12  ER-0004                     PIC X(4)    VALUE '0004'.    
< 00316      12  ER-0008                     PIC X(4)    VALUE '0008'.    
< 00317      12  ER-0013                     PIC X(4)    VALUE '0013'.    
< 00318      12  ER-0022                     PIC X(4)    VALUE '0022'.    
< 00319      12  ER-0023                     PIC X(4)    VALUE '0023'.    
< 00320      12  ER-0026                     PIC X(4)    VALUE '0026'.    
< 00321      12  ER-0029                     PIC X(4)    VALUE '0029'.    
< 00322      12  ER-0070                     PIC X(4)    VALUE '0070'.    
< 00323      12  ER-0194                     PIC X(4)    VALUE '0194'.    
< 00324      12  ER-0195                     PIC X(4)    VALUE '0195'.    
< 00325      12  ER-0196                     PIC X(4)    VALUE '0196'.    
< 00326      12  ER-0197                     PIC X(4)    VALUE '0197'.    
< 00327      12  ER-0203                     PIC X(4)    VALUE '0203'.    
< 00328      12  ER-0215                     PIC X(4)    VALUE '0215'.    
< 00329      12  ER-0216                     PIC X(4)    VALUE '0216'.    
< 00330      12  ER-0433                     PIC X(4)    VALUE '0433'.    
< 00331      12  ER-0565                     PIC X(4)    VALUE '0565'.    
< 00332      12  ER-1159                     PIC X(4)    VALUE '1159'.    
< 00333      12  ER-1162                     PIC X(4)    VALUE '1162'.    
< 00334      12  ER-2056                     PIC X(4)    VALUE '2056'.    
< 00335      12  ER-2208                     PIC X(4)    VALUE '2208'.    
< 00336      12  ER-2209                     PIC X(4)    VALUE '2209'.    
< 00337      12  ER-2210                     PIC X(4)    VALUE '2210'.    
< 00338      12  ER-2230                     PIC X(4)    VALUE '2230'.    
< 00339      12  ER-2237                     PIC X(4)    VALUE '2237'.    
< 00340      12  ER-2238                     PIC X(4)    VALUE '2238'.    
< 00341      12  ER-2294                     PIC X(4)    VALUE '2294'.    
< 00342      12  ER-2394                     PIC X(4)    VALUE '2394'.    
< 00343      12  ER-2438                     PIC X(4)    VALUE '2438'.    
< 00344      12  ER-2439                     PIC X(4)    VALUE '2439'.    
< 00345      12  ER-2583                     PIC X(4)    VALUE '2583'.    
< 00346      12  ER-2600                     PIC X(4)    VALUE '2600'.    
< 00347      12  ER-2726                     PIC X(4)    VALUE '2726'.    
< 00348      12  ER-2905                     PIC X(4)    VALUE '2905'.    
< 00349      12  ER-2906                     PIC X(4)    VALUE '2906'.    
< 00350      12  ER-2907                     PIC X(4)    VALUE '2907'.    
< 00351      12  ER-2908                     PIC X(4)    VALUE '2908'.    
< 00352      12  ER-2909                     PIC X(4)    VALUE '2909'.    
< 00353      12  ER-3044                     PIC X(4)    VALUE '3044'.    
< 00354      12  ER-3046                     PIC X(4)    VALUE '3046'.    
< 00355      12  ER-3047                     PIC X(4)    VALUE '3047'.    
< 00356      12  ER-3445                     PIC X(4)    VALUE '3445'.    
<            12  er-3450                     pic x(4)    value '3450'.
<            12  er-3451                     pic x(4)    value '3451'.
<            12  er-3452                     pic x(4)    value '3452'.
<            12  er-3453                     pic x(4)    value '3453'.
<            12  er-3454                     pic x(4)    value '3454'.
<            12  er-3455                     pic x(4)    value '3455'.
< 091615     12  er-3459                     pic x(4)    value '3459'.
< 00357      12  ER-7389                     PIC X(4)    VALUE '7389'.    
<            12  er-9999                     pic x(4)    value '9999'.
< 
< 00360                                      COPY ELCLOGOF.               
< 00362                                      COPY ELCDATE.                
< 00364                                      COPY ELCATTR.                
< 00366                                      COPY ELCEMIB.                
< 00368                                      COPY ELCINTF.                
---
> 00314      12  ER-0000                 PIC X(4)    VALUE '0000'.    
> 00315      12  ER-0004                 PIC X(4)    VALUE '0004'.    
> 00317      12  ER-0013                 PIC X(4)    VALUE '0013'.    
> 00318      12  ER-0022                 PIC X(4)    VALUE '0022'.    
> 00319      12  ER-0023                 PIC X(4)    VALUE '0023'.    
> 00321      12  ER-0029                 PIC X(4)    VALUE '0029'.    
> 00322      12  ER-0070                 PIC X(4)    VALUE '0070'.    
> 00323      12  ER-0194                 PIC X(4)    VALUE '0194'.    
> 00324      12  ER-0195                 PIC X(4)    VALUE '0195'.    
> 00325      12  ER-0196                 PIC X(4)    VALUE '0196'.    
> 00326      12  ER-0197                 PIC X(4)    VALUE '0197'.    
> 00327      12  ER-0203                 PIC X(4)    VALUE '0203'.    
> 00328      12  ER-0215                 PIC X(4)    VALUE '0215'.    
> 00329      12  ER-0216                 PIC X(4)    VALUE '0216'.    
> 00330      12  ER-0433                 PIC X(4)    VALUE '0433'.    
> 00332      12  ER-1159                 PIC X(4)    VALUE '1159'.    
> 00333      12  ER-1162                 PIC X(4)    VALUE '1162'.    
> 00334      12  ER-2056                 PIC X(4)    VALUE '2056'.    
> 00335      12  ER-2208                 PIC X(4)    VALUE '2208'.    
> 00336      12  ER-2209                 PIC X(4)    VALUE '2209'.    
> 00337      12  ER-2210                 PIC X(4)    VALUE '2210'.    
> 00338      12  ER-2230                 PIC X(4)    VALUE '2230'.    
> 00339      12  ER-2237                 PIC X(4)    VALUE '2237'.    
> 00340      12  ER-2238                 PIC X(4)    VALUE '2238'.    
> 00342      12  ER-2394                 PIC X(4)    VALUE '2394'.    
> 00345      12  ER-2583                 PIC X(4)    VALUE '2583'.    
> 00346      12  ER-2600                 PIC X(4)    VALUE '2600'.    
> 00347      12  ER-2726                 PIC X(4)    VALUE '2726'.    
> 00350      12  ER-2907                 PIC X(4)    VALUE '2907'.    
> 00351      12  ER-2908                 PIC X(4)    VALUE '2908'.    
> 00353      12  ER-3044                 PIC X(4)    VALUE '3044'.    
> 00354      12  ER-3046                 PIC X(4)    VALUE '3046'.    
> 111418     12  er-3274                 pic x(4)    value '3274'.
>            12  er-3450                 pic x(4)    value '3450'.
>            12  er-3451                 pic x(4)    value '3451'.
>            12  er-3452                 pic x(4)    value '3452'.
>            12  er-3453                 pic x(4)    value '3453'.
>            12  er-3454                 pic x(4)    value '3454'.
>            12  er-3455                 pic x(4)    value '3455'.
> 091615     12  er-3459                 pic x(4)    value '3459'.
> 111418     12  er-3460                 pic x(4)    value '3460'.
>            12  er-9999                 pic x(4)    value '9999'.
> 
> 00360                                  COPY ELCLOGOF.               
> 00362                                  COPY ELCDATE.                
> 00364                                  COPY ELCATTR.                
> 00366                                  COPY ELCEMIB.                
> 00368                                  COPY ELCINTF.
600c516,520
< 103116         16  FILLER                      PIC X(305). *> wass 311
---
> 111418         16  pi-void-reissue-pass        pic x.
> 111418             88  pi-void-complete           value '1'.
> 111418             88  pi-address-selected        value '2'.
> 111418         16  pi-void-reissue-amt         pic s9(7)v99 comp-3.
> 111418         16  FILLER                      PIC X(304). *> wass 311
617,625c537,545
< 00421                                      COPY ELCCNTL.                
< 00423                                      COPY ERCCHEK.                
< 00427                                      COPY ERCACCT.                
< 00429                                      COPY ERCCOMP.                
< 00431                                      COPY ELCCERT.                
< 00433                                      COPY ERCPNDB.                
< 00435                                      COPY ERCPNDM.                
< 00437                                      COPY ERCMAIL.                
< 00441                                      COPY ERCPYAJ.                
---
> 00421                                  COPY ELCCNTL.
> 00423                                  COPY ERCCHEK.
> 00427                                  COPY ERCACCT.
> 00429                                  COPY ERCCOMP.
> 00431                                  COPY ELCCERT.
> 00433                                  COPY ERCPNDB.
> 00435                                  COPY ERCPNDM.
> 00437                                  COPY ERCMAIL.
> 00441                                  COPY ERCPYAJ.
688d607
< 
718a638,639
> 111418         move ' '                to pi-void-reissue-pass
> 111418         move zeros              to pi-void-reissue-amt
833a755
> 111418        and (pi-void-reissue-pass not = '1' and '2')
873c795
< 00635      IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D'
---
> 111418     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D' or 'R'
875,876c797,798
< 00637          IF MAINTI = 'C' OR 'V'                                   
< 00638              IF PI-PREV-MAINT = 'S'  OR  'C'                      
---
> 111418         IF MAINTI = 'C' OR 'V' OR 'R'
> 111418             IF PI-PREV-MAINT = 'S'  OR  'C' or 'R'                      
906c828
<               and (MAINTI not = 'S' and 'V')
---
> 111418        and (MAINTI not = 'S' and 'V' and 'R' and 'D')
1049,1051c971,974
<            if mainti = 'V'
<               if (vreasonl > zeros)
<                  and (vreasoni (1:2) not = spaces)
---
> 111418     if mainti = 'V' or 'R'
>               if ((vreasonl > zeros)
>                  and (vreasoni (1:2) not = spaces))
> 111418             or (pi-void-reissue-pass = '1' or '2')
1080a1004,1049
> 111418     if (pi-void-reissue-pass = '1')
> 111418        and (mainti = 'R')
> 111418        if emi-error = zeros
> 111418           if eibaid = dfhpf5 or dfhpf6 or dfhpf7
> 111418              go to 7500-reissue-pass-1
> 111418           else
> 111418              if eibaid = dfhenter
> 111418                 move er-3460    to emi-error
> 111418                 move -1         to maintl
> 111418                 move al-uabon   to mainta
> 111418                 perform 9900-error-format
> 111418                                 thru 9900-exit
> 111418              end-if
> 111418           end-if
> 111418        end-if
> 111418     end-if
> 111418
> 111418     if (pi-void-reissue-pass = '2')
> 111418        and (mainti = 'R')
> 111418        if emi-error = zeros
> 111418           if eibaid = dfhpf5 or dfhpf6 or dfhpf7
> 111418              go to 7500-reissue-pass-1
> 111418           else
> 111418              if eibaid = dfhenter
> 111418                 go to 7510-reissue-pass-2
> 111418              end-if
> 111418           end-if
> 111418        end-if
> 111418     end-if
> 
>       *    if (pi-void-reissue-pass = '1')
>       *       and (mainti = 'R')
>       *       if emi-error = zeros
>       *          if eibaid = dfhpf5 or dfhpf6 or dfhpf7
>       *             go to 7500-reissue-pass-1
>       *          else
>       *             if eibaid = dfhenter
>       *                go to 7510-reissue-pass-2
>       *                move '2'        to pi-void-reissue-pass
>       *             end-if
>       *          end-if
>       *       end-if
>       *    end-if
> 
> 
> 
1082c1051
< 00788         IF EMI-ERROR = ZEROS                                      
---
> 00788         IF EMI-ERROR = ZEROS
1149c1118
< 00815      IF MAINTI = 'S' OR 'V'                                       
---
> 111418     IF MAINTI = 'S' OR 'V' or 'R' or 'D'
1267c1236
< 01013      IF MAINTI = 'V'                                       
---
> 111418     IF MAINTI = 'V' or 'R'                                
1347c1316
< 01116      IF MAINTI = 'A' OR 'V'                                
---
> 111418     IF MAINTI = 'A' OR 'V' or 'R'                         
1683,1684d1651
< 01386 *    PERFORM 2500-WRITE-PAY-ADJ  THRU  2590-EXIT.                 
< 01387                                                                   
1723,1911d1689
< 01425      EJECT                                                        
< 01426                                                                   
< 01427  2500-WRITE-PAY-ADJ.                                              
< 01428                                                                   
< 01429      PERFORM 2600-READ-CONTROL-FILE THRU 2600-EXIT.               
< 01430                                                                   
< 01431      IF CH-AMOUNT-PAID = ZEROS                                    
< 01432          GO TO 2510-CONTINUE.                                     
< 
< 01448      PERFORM 2550-BUILD-ERPYAJ-RECORD THRU 2559-BUILD-EXIT.       
< 01449      PERFORM 2570-WRITE-ERPYAJ-RECORD THRU 2579-WRITE-EXIT.       
< 01450                                                                   
< 01451  2510-CONTINUE.                                                   
< 01452                                                                   
< 01453      IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'                     
< 01454          GO TO 2580-HANDLE-ELCNTL-FILE.                           
< 01455                                                                   
< 01487  2550-BUILD-ERPYAJ-RECORD.                                        
< 01488                                                                   
< 01489      EXEC CICS GETMAIN                                            
< 01490          SET     (ADDRESS OF PENDING-PAY-ADJ)                     
< 01491          LENGTH  (200)                                            
< 01492          INITIMG (GETMAIN-SPACE)                                  
< 01493      END-EXEC.                                                    
< 01494                                                                   
< 01495      MOVE SPACES                 TO PENDING-PAY-ADJ.              
< 01496      MOVE 'PY'                   TO PY-RECORD-ID.                 
< 01497      MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.                
< 01498                                                                   
< 01499      MOVE CARRIERI               TO PY-CARRIER.                   
< 01500      IF PI-ZERO-CARRIER  OR                                       
< 01501         PI-ZERO-CAR-GROUP                                         
< 01502          MOVE ZERO               TO PY-CARRIER.                   
< 01503                                                                   
< 01504      MOVE GROUPI                 TO PY-GROUPING.                  
< 01505      IF PI-ZERO-GROUPING  OR                                      
< 01506         PI-ZERO-CAR-GROUP                                         
< 01507          MOVE ZERO               TO PY-GROUPING.                  
< 01508                                                                   
< 01509      MOVE PI-CR-FIN-RESP         TO PY-FIN-RESP.                  
< 01510      MOVE PI-CR-ACCOUNT          TO PY-ACCOUNT.                   
< 01511      MOVE 'C'                    TO PY-RECORD-TYPE.               
< 01512      MOVE EIBTIME                TO PY-FILE-SEQ-NO.               
< 01513                                                                   
< 01514      MOVE SAVE-CURRENT-DATE-MDY  TO WS-PY-CURRENT-DATE            
< 01515                                     WS-PY-REF-DATE                
< 01516                                     WS-PY-END-DATE                
< 01517                                     WS-PY-DED-DATE                
< 01518                                     WS-PY-ADDL-DATE.              
< 01519      MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.              
< 01520      MOVE CERTNOI                TO WS-PY-CURRENT-CERT            
< 01521                                     WS-PY-REF-CERT                
< 01522                                     WS-PY-END-CERT                
< 01523                                     WS-PY-DED-CERT                
< 01524                                     WS-PY-ADDL-CERT               
< 01525                                     WS-TMS-PY-CERT.               
< 01526      IF SFXI NOT = LOW-VALUES                                     
< 01527          MOVE SFXI               TO WS-PY-CURRENT-SUFFIX          
< 01528                                     WS-PY-REF-SUFFIX              
< 01529                                     WS-PY-END-SUFFIX              
< 01530                                     WS-PY-DED-SUFFIX              
< 01531                                     WS-PY-ADDL-SUFFIX             
< 01532      ELSE                                                         
< 01533          MOVE SPACE              TO WS-PY-CURRENT-SUFFIX          
< 01534                                     WS-PY-REF-SUFFIX              
< 01535                                     WS-PY-END-SUFFIX              
< 01536                                     WS-PY-DED-SUFFIX              
< 01537                                     WS-PY-ADDL-SUFFIX.            
< 01538                                                                   
< 01539      IF PI-COMPANY-ID EQUAL 'TMS' OR 'LGX'                        
< 01540          MOVE WS-TMS-ENTRY-COMMENT                                
< 01541                                  TO PY-ENTRY-COMMENT              
< 01542      ELSE                                                         
< 01543          IF TYPEI EQUAL 'R'                                       
< 01544              MOVE WS-PY-REF-COMMENT                               
< 01545                                  TO PY-ENTRY-COMMENT              
< 01546          ELSE                                                     
< 01547              IF TYPEI EQUAL 'E'                                   
< 01548                  MOVE WS-PY-END-COMMENT                           
< 01549                                  TO PY-ENTRY-COMMENT              
< 01550              ELSE                                                 
< 01551                  MOVE WS-PY-ENTRY-COMMENT                         
< 01552                                  TO PY-ENTRY-COMMENT.             
< 01553                                                                   
< 01554      MOVE CH-AMOUNT-PAID         TO PY-ENTRY-AMT.                 
< 01555                                                                   
< 01562      MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.             
< 01563      MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.         
< 01564      MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT              
< 01565                                     PY-INPUT-DT.                  
< 01566 *    MOVE +0                     TO PY-CHECK-QUE-CONTROL          
< 01567 *                                   PY-CHECK-QUE-SEQUENCE.        
< 01568      MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT           
< 01569                                     PY-REPORTED-DT                
< 01570                                     PY-CHECK-WRITTEN-DT           
< 01571                                     PY-BILLED-DATE                
< 01572                                     PY-AR-DATE                    
< 01573                                     PY-GL-DATE.                   
< 01574      MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.          
< 01575      MOVE TYPEI                  TO PY-CHECK-ORIGIN-SW.           
< 01576 *    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.                    
< 01577                                                                   
< 01578      IF PI-AR-PROCESSING                                          
< 01579          MOVE 'B'                TO PY-PYMT-TYPE                  
< 01580          MOVE 'A'                TO PY-PMT-APPLIED.               
< 01581                                                                   
< 01582  2559-BUILD-EXIT.                                                 
< 01583      EXIT.                                                        
< 01584                                                                   
< 01585  2570-WRITE-ERPYAJ-RECORD.                                        
< 01586                                                                   
< 01587      EXEC CICS HANDLE CONDITION                                   
< 01588          DUPREC (2577-DUPREC)                                     
< 01589      END-EXEC.                                                    
< 01590                                                                   
< 01591      EXEC CICS WRITE                                              
< 01592          DATASET (ERPYAJ-FILE-ID)                                 
< 01593          FROM    (PENDING-PAY-ADJ)                                
< 01594          RIDFLD  (PY-CONTROL-PRIMARY)                             
< 01595      END-EXEC.                                                    
< 01596                                                                   
< 01597      GO TO 2579-WRITE-EXIT.                                       
< 01598                                                                   
< 01599  2577-DUPREC.                                                     
< 01600      ADD +1 TO PY-FILE-SEQ-NO.                                    
< 01601                                                                   
< 01602      GO TO 2570-WRITE-ERPYAJ-RECORD.                              
< 01603                                                                   
< 01604  2579-WRITE-EXIT.                                                 
< 01605      EXIT.                                                        
< 01606                                                                   
< 01607  2580-HANDLE-ELCNTL-FILE.                                         
< 01608                                                                   
< 01609      IF CR-CHECK-NO-AUTO-SEQ                                      
< 01610          PERFORM 2650-REWRITE-CONTROL-FILE THRU 2650-EXIT         
< 01611      ELSE                                                         
< 01612          EXEC CICS UNLOCK                                         
< 01613              DATASET (ELCNTL-FILE-ID)                             
< 01614          END-EXEC.                                                
< 01615                                                                   
< 01616  2590-EXIT.                                                       
< 01617       EXIT.                                                       
< 01618                                                                   
< 01619      EJECT                                                        
< 01620                                                                   
< 01621  2600-READ-CONTROL-FILE.                                          
< 01622      MOVE SPACES                 TO ELCNTL-KEY.                   
< 01623      MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.               
< 01624      MOVE '1'                    TO ELCNTL-REC-TYPE.              
< 01625      MOVE +0                     TO ELCNTL-SEQ.                   
< 01626                                                                   
< 01627      EXEC CICS HANDLE CONDITION                                   
< 01628          NOTFND   (2600-NO-CO-MASTER)                             
< 01629      END-EXEC.                                                    
< 01630                                                                   
< 01631      EXEC CICS READ                                               
< 01632          DATASET   (ELCNTL-FILE-ID)                               
< 01633          SET       (ADDRESS OF CONTROL-FILE)                      
< 01634          RIDFLD    (ELCNTL-KEY)                                   
< 01635      END-EXEC.                                                    
< 01636                                                                   
< 01637      GO TO 2600-EXIT
< 01638                                                                   
<            .
< 01639  2600-NO-CO-MASTER.                                               
< 01640      MOVE ER-0022                TO  EMI-ERROR.                   
< 01641      MOVE -1                     TO  CARRIERL.                    
< 01642      MOVE AL-UABON               TO  CARRIERA.                    
< 01643      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
< 01644                                                                   
< 01645  2600-EXIT.                                                       
< 01646       EXIT.                                                       
< 01647                                                                   
< 01648      EJECT                                                        
< 01649  2650-REWRITE-CONTROL-FILE.                                       
< 01650      EXEC CICS READ                                               
< 01651          DATASET   (ELCNTL-FILE-ID)                               
< 01652          SET       (ADDRESS OF CONTROL-FILE)                      
< 01653          RIDFLD    (ELCNTL-KEY)                                   
< 01654          UPDATE                                                   
< 01655      END-EXEC.                                                    
< 01656                                                                   
< 01657      EXEC CICS REWRITE                                            
< 01658           DATASET (ELCNTL-FILE-ID)                                
< 01659           FROM    (CONTROL-FILE)                                  
< 01660       END-EXEC.                                                   
< 01661                                                                   
< 01662  2650-EXIT.                                                       
< 01663       EXIT.                                                       
2047a1826,1836
>       *    display ' about to insert '
>       *    display ' db-compid     ' db-compid
>       *    display ' db-carrier    ' db-carrier
>       *    display ' db-group      ' db-grouping
>       *    display ' db state      ' db-state
>       *    display ' accounbt      ' db-account
>       *    display ' effdt         ' db-effdate
>       *    display ' cert          ' db-certificate
>       *    display ' suffix        ' db-cert-sfx
>       *    display ' seq no        ' db-seq-no
>       *    display ' type          ' db-type
2100c1889
< 01690      IF MAINTI = 'V'
---
> 111418     IF MAINTI = 'V' or 'R'
2159,2162c1948,1949
< 01721 *      IF MANUAL-CHECK-WRITTEN                                    
< 01722 *          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT.    
< 01723                                                                   
< 01724      IF MAINTI = 'V'                                              
---
> 
> 111418     IF MAINTI = 'V' or 'R'                                       
2167d1953
< 01728 *          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT     
2205c1991,1998
< 01756                                                                   
---
> 
> 111418     if mainti = 'R'
> 111418        if pi-void-reissue-pass = ' '
> 111418           move '1'              to pi-void-reissue-pass
> 111418        MOVE ER-3274             TO EMI-ERROR
> 111418        end-if
> 111418     end-if
> 
2466,2468d2258
<       *    if sqlcode = 0
<       *       perform 4150-open-cursor    thru 4150-exit
<       *    end-if
2496,2546d2285
< 01995  3700-UPDATE-ERCHKQ.                                              
< 01996 *    MOVE CH-COMPANY-CD          TO CHKQ-COMPANY-CD.              
< 01997 *    MOVE CH-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NUMBER.          
< 01998 *    MOVE CH-CHECK-QUE-SEQUENCE  TO CHKQ-SEQUENCE-NUMBER.         
< 01999 *                                                                 
< 02000 *    EXEC CICS HANDLE CONDITION                                   
< 02001 *        NOTFND (3780-CHECK-NOTFND)                               
< 02002 *    END-EXEC.                                                    
< 02003 *                                                                 
< 02004 *    EXEC CICS READ                                               
< 02005 *        DATASET  (ERCHKQ-FILE-ID)                                
< 02006 *        SET      (ADDRESS OF CHECK-QUE)                          
< 02007 *        RIDFLD   (ERCHKQ-KEY)                                    
< 02008 *        UPDATE                                                   
< 02009 *    END-EXEC.                                                    
< 02010 *                                                                 
< 02011 *    IF MAINTI = 'C'                                              
< 02012 *        IF MANUAL-CHECK-WRITTEN                                  
< 02013 *            MOVE 'M'                 TO CQ-ENTRY-TYPE            
< 02014 *            MOVE +1                  TO CQ-TIMES-PRINTED         
< 02015 *            MOVE CH-CHECK-NO         TO CQ-CHECK-NUMBER          
< 02016 *            MOVE CH-AMOUNT-PAID      TO CQ-CHECK-AMOUNT          
< 02017 *            MOVE CH-CHECK-WRITTEN-DT TO CQ-CHECK-WRITTEN-DT.     
< 02018 *                                                                 
< 02019 *    IF MAINTI = 'V'                                              
< 02020 *        MOVE 'V'                TO CQ-ENTRY-TYPE                 
< 02021 *                                   CQ-VOID-INDICATOR             
< 02022 *        MOVE CH-VOID-DT         TO CQ-CHECK-VOIDED-DT.           
< 02023 *                                                                 
< 02024 *    MOVE CH-CHECK-REFERENCE     TO PI-REFERENCE.                 
< 02025 *                                                                 
< 02026 *    EXEC CICS REWRITE                                            
< 02027 *        DATASET  (ERCHKQ-FILE-ID)                                
< 02028 *        FROM     (CHECK-QUE)                                     
< 02029 *    END-EXEC.                                                    
< 02030 *                                                                 
< 02031 *    GO TO 3790-EXIT.                                             
< 02032 *                                                                 
< 02033 *3780-CHECK-NOTFND.                                               
< 02034 *    MOVE ER-2905                TO EMI-ERROR.                    
< 02035 *    MOVE -1                     TO CARRIERL                      
< 02036 *    MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA      
< 02037 *                                   ACCTA     EFFDTA  CERTNOA     
< 02038 *                                   SFXA      SEQA.               
< 02039 *    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
<            .
< 02041  3790-EXIT.                                                       
< 02042       EXIT.                                                       
< 02043                                                                   
< 02044      EJECT                                                        
< 02045                                                                   
2725,2791d2463
<        4150-open-cursor.
< 
<            move pi-company-id          to ws-compid
<            move ch-carrier             to ws-carrier
<            move ch-grouping            to ws-grouping
<            move ch-state               to ws-state
<            move ch-account             to ws-account
<            move ch-cert-eff-dt         to dc-bin-date-1
<            move ' '                    to dc-option-code
<            perform 8500-date-convert   thru 8500-exit
<            if no-conversion-error
<               move dc-greg-date-a-edit to ws-eff-date
<            end-if
<            move ch-cert-prime          to ws-certificate
<            move ch-cert-sfx            to ws-cert-sfx
<            move ch-sequence-no         to ws-seq-no
<            move '1'                    to ws-type
<                                           ws-check-sub-type
< 091615     if pi-check-type = 'C'
< 091615        move '2'                 to ws-check-sub-type
< 091615     end-if
< 
<            EXEC SQL
<               DECLARE
<                  checkapp cursor for
<               SELECT
<                  ApprovalStatus,
<                  MaintainedBy,
<                  MaintainedDate,
<                  ApprovalBatch
<               FROM
<                  ChkApp_Check
<               WHERE
<                  Company           = :ws-compid
<                  and CertCarrier   = :ws-carrier
<                  and CertGroup     = :ws-grouping
<                  and CertState     = :ws-state
<                  and CertAccount   = :ws-account
<                  and CertEffDate   = :ws-eff-date
<                  and CertNumber    = :ws-certificate
<                  and CertNumberSuf = :ws-cert-sfx
<                  and CheckSeqNbr   = :ws-seq-no
<                  and CheckType     = :ws-type
< 091615           and CheckSubType  = :ws-check-sub-type
<            END-EXEC
< 
<            if sqlcode not = 0
<               display "Error: cannot declare cursor "
<               display ' sql retrun code ' sqlcode
<               display ' sql err mess    ' sqlerrmc
<               go to 4150-exit
<            end-if
< 
<            EXEC SQL
<               open checkapp
<            END-EXEC
< 
<            if sqlcode not = 0
<               display "Error: cannot open cursor "
<               display ' sql retrun code ' sqlcode
<               display ' sql err mess    ' sqlerrmc
<            end-if
< 
<            .
<        4150-exit.
<            exit.
< 
3037c2709,2716
< 02267      MOVE 'S'                    TO  MAINTI   PI-PREV-MAINT.      
---
> 111418     if pi-void-reissue-pass = '1'
> 111418        move 'R'                 to mainti
> 111418                                    pi-prev-maint
> 111418     else
> 111418        MOVE 'S'                 TO MAINTI
> 111418                                    PI-PREV-MAINT
> 111418     end-if
> 
3132c2811,2812
< 02338      MOVE CH-AMOUNT-PAID         TO  AMOUNTO.                     
---
> 02338      MOVE CH-AMOUNT-PAID         TO  AMOUNTO
> 111418                                     pi-void-reissue-amt
4095d3774
< 
4166,4175c3845,4100
< 02916  8035-LETR-NOT-OPEN.                                              
< 02917                                                                   
< 02918      MOVE ER-0013                TO EMI-ERROR.                    
< 02919 *    MOVE -1                     TO LETTER1L                      
< 02920      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
< 02921      GO TO 8200-SEND-DATAONLY.                                    
< 02922                                                                   
< 02923  8035-EXIT.                                                       
< 02924      EXIT.                                                        
< 02925      EJECT                                                        
---
> 
> 111418 7500-reissue-pass-1.
> 111418
> 111418     move '2'                    to pi-void-reissue-pass
> 111418
> 111418     move pi-void-reissue-amt    to amounto
> 111418
> 111418     if eibaid = dfhpf5
> 111418        MOVE PI-AM-NAME          TO PAYTO1I
> 111418        MOVE SPACES              TO PAYTO2I
> 111418        MOVE PI-AM-ADDRS         TO PAYAD1I
> 111418        MOVE PI-AM-CITY          TO PAYCTYI
> 111418        move pi-am-st            to paysti
> 111418        MOVE PI-AM-ZIP-CODE      TO PTOZIPI
> 111418        move 'ACCT'              to payeeo
> 111418        move al-panon            to payeea
> 111418
> 111418        MOVE AL-UANON            TO PAYTO1A
> 111418                                    PAYTO2A
> 111418                                    PAYAD1A
> 111418                                    PAYCTYA
> 111418                                    paysta
> 111418                                    PTOZIPA
> 111418                                    payeea
> 111418        GO TO 8100-SEND-INITIAL-MAP
> 111418     end-if
> 111418
> 111418     perform 5700-get-elcert     thru 5700-exit
> 111418     move spaces                 to pi-table-name
> 111418     string cm-insured-last-name ', '
> 111418            cm-insured-first-name ' '
> 111418            cm-insured-initial2
> 111418        delimited by '  '
> 111418        into
> 111418           pi-table-name
> 111418     end-string
> 111418
> 111418     IF CM-INSURED-FIRST-NAME GREATER SPACES                      
> 111418         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME      
> 111418         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT      
> 111418     ELSE                                                         
> 111418         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME      
> 111418         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.     
> 111418                                                                  
> 111418     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.    
> 111418                                                                  
> 111418     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.                       
> 111418
> 111418     if eibaid = dfhpf7
> 111418        EXEC CICS READ                                               
> 111418            DATASET   (ERMAIL-FILE-ID)
> 111418            SET       (ADDRESS OF MAILING-DATA)
> 111418            RIDFLD    (ELCERT-KEY)
> 111418            resp      (ws-response)
> 111418        END-EXEC
> 111418        if resp-normal
> 111418           move spaces             to payto2i
> 111418           move ma-cred-bene-name  to payto1i
> 111418           MOVE MA-cred-bene-addr  TO PAYad1I
> 111418           MOVE MA-cred-bene-addr2 TO PAYad2I
> 111418           move ma-cred-bene-city  to payctyi
> 111418           move ma-cred-bene-state to paysti
> 111418           MOVE MA-cred-bene-zip   TO PTOZIPI
> 111418           move 'BENE'              to payeeo
> 111418           MOVE AL-UANON           TO payto1a
> 111418                                      PAYTO2A
> 111418                                      PAYad1A
> 111418                                      payad2a
> 111418                                      PAYctyA
> 111418                                      paysta
> 111418                                      PTOZIPA
> 111418                                      payeea
> 111418        end-if
> 111418     end-if
> 111418
> 111418     if eibaid = dfhpf6
> 111418        EXEC CICS READ
> 111418            DATASET   (ERMAIL-FILE-ID)
> 111418            SET       (ADDRESS OF MAILING-DATA)
> 111418            RIDFLD    (ELCERT-KEY)
> 111418            resp      (ws-response)
> 111418        END-EXEC
> 111418        if resp-normal
> 111418           move spaces            to payto2i
> 111418           move ws-name-work      to payto1i
> 111418           MOVE MA-ADDRESS-LINE-1 TO PAYAD1I
> 111418           MOVE MA-ADDRESS-LINE-2 TO PAYAD2I
> 111418           move ma-city           to payctyi
> 111418           move ma-addr-state     to paysti
> 111418           move 'INS'             to payeeo
> 111418           MOVE MA-ZIP            TO PTOZIPI
> 111418           MOVE AL-UANON          TO PAYAD1A
> 111418                                     PAYAD2A
> 111418                                     PAYctyA
> 111418                                     paysta
> 111418                                     PTOZIPA
> 111418                                     payto1a
> 111418                                     payeea
> 111418        end-if
> 111418     end-if
> 111418
> 111418     GO TO 8100-SEND-INITIAL-MAP
> 111418
> 111418     .
> 111418 7500-exit.
> 111418     exit.
> 111418
> 111418 7510-reissue-pass-2.
> 111418
> 111418     EXEC CICS READ
> 111418         DATASET  (ERCHEK-FILE-ID)
> 111418         SET      (ADDRESS OF CHECK-RECORDS)
> 111418         RIDFLD   (PI-ERCHEK-KEY)
> 111418         resp     (ws-response)
> 111418     END-EXEC
> 111418     display ' after read ' ws-response ' ' pi-erchek-key (2:19)
> 111418     ' ' pi-erchek-key (22:11) ' ' pi-chek-sequence
> 111418
> 111418     if not resp-normal
> 111418        go to 7510-exit
> 111418     end-if
> 111418
> 111418     if ch-void-dt not = save-bin-date
> 111418        display ' something went wrong here '
> 111418        go to 7510-exit
> 111418     end-if
> 111418
> 111418     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS
> 111418     MOVE save-bin-date          TO CH-RECORDED-DT
> 111418                                    ch-released-dt
> 111418     move pi-processor-id        to ch-recorded-by
> 111418                                    ch-released-by
> 111418     move spaces                 to ch-check-no
> 111418                                    ch-void-by
> 111418                                    ch-void-reason
> 111418                                    ch-approved-by
> 111418                                    
> 111418
> 111418     move 'P'                    to ch-approval-status
> 111418
> 111418     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT           
> 111418                                    CH-VOID-DT                    
> 111418                                    CH-CREDIT-ACCEPT-DT           
> 111418                                    ch-approval-dt
> 111418                                    ch-check-cashed-dt
> 111418     add +1 to ch-sequence-no
> 111418     if ch-check-origin-sw = 'R'
> 111418        move 'R'                 to pi-check-type
> 111418     else
> 111418        move 'C'                 to pi-check-type
> 111418     end-if
> 111418
> 111418     .
> 111418 7510-WRITE-RECORD.                                               
> 111418
> 111418     exec cics read
> 111418        dataset    (erchek-file-id)
> 111418        into       (ws-dummy-erchek)
> 111418        ridfld     (ch-control-primary)
> 111418        resp       (ws-response)
> 111418     end-exec
> 111418     display ' after read ' ws-response
> 111418     if RESP-NOTFND
> 111418        continue
> 111418     else
> 111418        add +1                   to ch-sequence-no
> 111418        add 1                    to seqi
> 111418        go to 7510-write-record
> 111418     end-if
> 111418
> 111418     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.                
> 111418     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL          
> 111418                                    CH-CHECK-QUE-SEQUENCE
> 111418
> 111418     IF PAYTO1L NOT = ZEROS                                      
> 111418        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
> 111418     END-IF
> 111418     IF PAYTO2L NOT = ZEROS                                       
> 111418        MOVE PAYTO2I             TO CH-PAYEE-NAME-2
> 111418     end-if
> 111418     IF PAYAD1L NOT = ZEROS                                       
> 111418        MOVE PAYAD1I             TO CH-PAYEE-ADDRESS-1
> 111418     end-if
> 111418     IF PAYAD2L NOT = ZEROS                                       
> 111418        MOVE PAYAD2I             TO CH-PAYEE-ADDRESS-2
> 111418     end-if
> 111418     IF PAYctyL NOT = ZEROS                                       
> 111418        MOVE payctyi             TO CH-PAYEE-CITY
> 111418     end-if
> 111418     IF PAYstL NOT = ZEROS                                       
> 111418        MOVE paysti              TO CH-PAYEE-state
> 111418     end-if
> 111418     IF PAYEEI GREATER SPACES                                     
> 111418        mOVE PAYEEI               TO CH-PAYEE-CODE
> 111418     end-if
> 111418     IF PTOZIPL  =  ZEROS                                         
> 111418        MOVE ZEROS               TO CH-PAYEE-ZIP-CODE
> 111418     else             
> 111418        MOVE PTOZIPI             TO WS-ZIP-CODE
> 111418        IF NOT WS-CANADIAN-POST-CODE                                 
> 111418           MOVE WS-ZIP-PRIME     TO CH-PAYEE-ZIP                  
> 111418           MOVE WS-ZIP-PLUS4     TO CH-PAYEE-ZIP-EXT
> 111418        end-if
> 111418     end-if
> 111418
> 111418     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
> 111418     display ' back from 2700- '
> 111418
> 111418     EXEC CICS WRITE                                              
> 111418         DATASET  (ERCHEK-FILE-ID)                                
> 111418         FROM     (CHECK-RECORDS)                                 
> 111418         RIDFLD   (CH-CONTROL-PRIMARY)                            
> 111418         resp     (ws-response)
> 111418     END-EXEC.                                                    
> 111418     display ' after write ' ws-response
> 111418     COMPUTE WS-JOURNAL-RECORD-LENGTH =                           
> 111418             ERCHEK-RECORD-LENGTH + 23.                           
> 111418
> 111418     IF EMI-NO-ERRORS                                             
> 111418        MOVE ER-0000             TO EMI-ERROR                     
> 111418     ELSE                                                         
> 111418        IF EMI-FORCABLE-CTR GREATER THAN +0  AND                 
> 111418           EIBAID = DFHPF4                                       
> 111418           MOVE ER-2600          TO EMI-ERROR
> 111418        end-if
> 111418     end-if
> 111418
> 111418     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
> 111418                                                                  
> 111418     MOVE LOW-VALUES             TO EL677AI.                      
> 111418                                                                  
> 111418     MOVE PI-CHEK-CARRIER        TO CARRIERO.                     
> 111418     MOVE PI-CHEK-GROUPING       TO GROUPO.                       
> 111418     MOVE PI-CHEK-STATE          TO STATEO.                       
> 111418     MOVE PI-CHEK-ACCOUNT        TO ACCTO.                        
> 111418                                                                  
> 111418     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.                
> 111418     MOVE SPACE                  TO DC-OPTION-CODE.               
> 111418     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    
> 111418     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.                       
> 111418                                                                  
> 111418     MOVE PI-CHEK-CERT-NO        TO CERTNOO.                      
> 111418     MOVE PI-CHEK-SUF-NO         TO SFXO.                         
> 111418     MOVE PI-CHEK-SEQUENCE       TO SEQO.                         
> 111418                                                                  
> 111418     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA      
> 111418                                    ACCTA     EFFDTA  CERTNOA     
> 111418                                    SFXA.                         
> 111418     MOVE AL-UNNON               TO SEQA
> 111418     move ' ' to pi-void-reissue-pass
> 111418     go to 5000-browse-file
> 111418
> 111418     .
> 111418 7510-exit.
> 111418     exit.
> 
4184,4186c4109,4114
<            if PI-TO-EL677-FROM-EL1273
<               move al-sadof            to pf357a
<                                           pf46a
---
>            if (PI-TO-EL677-FROM-EL1273)
>               and (pi-void-reissue-pass = ' ')
> 111418        move al-sadof            to pf3a
> 111418                                    pf4a
> 111418                                    pf57a
> 111418                                    pf6a
4197d4124
<                                           dmaint2a
4199c4126,4127
< 
---
> 111418        move 'VOID & REISSUE(R), DELETE(D)'
> 111418                                 TO dmaint2o
4201a4130,4148
> 111418     if (pi-to-el677-from-el1273)
> 111418        and (pi-void-reissue-pass = '1')
> 111418        move al-sadof            to pf3a
> 111418                                    pf4a
> 111418                                    dprema
> 111418                                    dcomma
> 111418                                    drefa
> 111418                                    duecomma
> 111418                                    dprepda
> 111418                                    prema
> 111418                                    isscomma
> 111418                                    refa
> 111418                                    uecomma
> 111418                                    prepda
> 111418        move ', VOID(V)'         to dmaint1o
> 111418        move 'VOID AND REISSUE(R)'
> 111418                                 TO dmaint2o
> 111418     end-if
> 
4220d4166
< 

</pre>
<h3><a name="EL677S.bms">EL677S.bms</a><br><a href="#topper">Back to Top</a><br><pre>

207,209c207,210
< PF357    DFHMDF POS=(23,23),LENGTH=050,ATTRB=(ASKIP,NORM),             -
<                INITIAL='PF3=CERT DISPLAY    PF5=ACCT ADDRS   PF7=BENE A-
<                DDR'
---
> PF3      DFHMDF POS=(23,23),LENGTH=016,ATTRB=(ASKIP,NORM),             -
>                INITIAL='PF3=CERT DISPLAY'
> PF57     DFHMDF POS=(23,43),LENGTH=030,ATTRB=(ASKIP,NORM),             -
>                INITIAL='PF5=ACCT ADDRS   PF7=BENE ADDR'
213,214c214,217
< PF46     DFHMDF POS=(24,23),LENGTH=033,ATTRB=(ASKIP,NORM),             -
<                INITIAL='PF4=FORCE ADD/ERRS  PF6=INS ADDRS'
---
> PF4      DFHMDF POS=(24,23),LENGTH=018,ATTRB=(ASKIP,NORM),             -
>                INITIAL='PF4=FORCE ADD/ERRS'
> PF6      DFHMDF POS=(24,43),LENGTH=013,ATTRB=(ASKIP,NORM),             -
>                INITIAL='PF6=INS ADDRS'

</pre>
</body></html>