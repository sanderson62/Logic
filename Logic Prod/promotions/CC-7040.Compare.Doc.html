<html>
<head>
<title>Compare Module List</title>
</head>
<body style="background-color:PowderBlue;"><div align="center"><h2>Compares for CC-7040-PEMA.ini</h2>
<h3>Processed on - 12/11/2018</h3></div>
<a name="topper"></a>
<a href="#inifile">INI File</a><br>
<a href="#EL614.cl2">EL614.cl2</a><br>
<h3>INI FILE As submitted by programmer, followed by log information <h3>
<pre>

[2018112800001]
[/apps/test/cid1s/jcl/daily_jobs/;/apps/prod/cid1p/jcl/daily_jobs/]
[/apps/test/cid1s/jcl/monthly_jobs/;/apps/prod/cid1p/jcl/monthly_jobs/]
[/apps/test/cid1s/jcl/quarterly_jobs/;/apps/prod/cid1p/jcl/quarterly_jobs/]
[/apps/test/cid1s/jcl/yearly_jobs/;/apps/prod/cid1p/jcl/yearly_jobs/]
[/export/home/pema/bin/;/export/home/mtpadmin/bin/]
[/data/test/seqfiles/;/data/seqfiles/]
[/apps/test/cid1s/sys/webroot/;/apps/prod/cid1p/sys/webroot/]
[/apps/test/cid1s/sys/webroot/balancesheet/;/apps/prod/cid1p/sys/webroot/balancesheet/]
[/apps/test/cid1s/sys/webroot/balancesheet/images/;/apps/prod/cid1p/sys/webroot/balancesheet/images/]
[/apps/test/cid1s/sys/webroot/balancesheet/javascript/;/apps/prod/cid1p/sys/webroot/balancesheet/javascript/]
[/apps/test/cid1s/sys/webroot/balancesheet/style/;/apps/prod/cid1p/sys/webroot/balancesheet/style/]
[/apps/test/cid1s/maps/;/apps/prod/cid1p/maps/]
[/apps/test/cid1s/copy/;/apps/prod/cid1p/copy/]
[/apps/test/cid1s/emails/;/apps/prod/cid1p/emails/]
[/apps/test/cid1s/parmlib/;/apps/prod/cid1p/parmlib/]
[/apps/test/cid1s/src/batch/;/apps/prod/cid1p/src/batch/]
[/apps/test/cid1s/src/online/;/apps/prod/cid1p/src/online/]
EL614.cl2=
EL614.cbl=
EL614.lst=
[/apps/test/cid1s/exe/bat/;/apps/prod/cid1p/staging/exe_bat/]
[/apps/test/cid1s/exe/onl/;/apps/prod/cid1p/staging/exe_onl/]
EL614.gnt=
Archive Process Successfull using - perl /export/home/mtpadmin/bin/mtp_archive.pl CC-7040-PEMA.ini
Move Process Successfull using - perl /export/home/mtpadmin/bin/mtp_move.pl CC-7040-PEMA.ini
Promote process successfull and verified using - perl /export/home/mtpadmin/bin/mtp_verify.pl CC-7040-PEMA.ini
Archived module - /apps/prod/cid1p/src/online/archive/EL614.cl2.20181211
Archived module - /apps/prod/cid1p/src/online/archive/EL614.cbl.20181211
Archived module - /apps/prod/cid1p/src/online/archive/EL614.lst.20181211
Archived module - /apps/prod/cid1p/exe/onl/archive/EL614.gnt.20181211
moved module - /apps/prod/cid1p/src/online/EL614.cl2
moved module - /apps/prod/cid1p/src/online/EL614.cbl
moved module - /apps/prod/cid1p/src/online/EL614.lst
moved module - /apps/prod/cid1p/staging/exe_onl/EL614.gnt

</pre>
<h3><a name="EL614.cl2">EL614.cl2</a><br><a href="#topper">Back to Top</a><br><pre>

54a55
> 120318* 120318  IR2018112800001  PEMA  Fix memory problem
64,65c65
<        77  CI1                PIC S999  COMP-3 VALUE +0.
<        77  B1                 PIC S999  COMP-3 VALUE +0.
---
>        77  i1                 pic s999  comp-3 value +0.
76,79c76,79
<        01  WS-DATE-AREA.                                                
<            05  SAVE-DATE           PIC X(8)    VALUE SPACES.            
<           05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.            
<                                                                         
---
>        01  WS-DATE-AREA.
>            05  SAVE-DATE               PIC X(8)    VALUE SPACES.
>            05  SAVE-BIN-DATE           PIC X(2)    VALUE SPACES.
> 
82,85c82,83
<                10  WS-SEL-EOB-CODE PIC XXXX.
<                10  FILLER          PIC X.
< 
< 
---
>                10  WS-SEL-EOB-CODE     PIC XXXX.
>                10  FILLER              PIC X.
88,96d85
<            05  WS-RECORD-COUNT             PIC S9(3)   VALUE ZERO.      
<            05  WS-READNEXT-SW              PIC S9      VALUE ZERO.      
<            05  WS-LAST-ERROR-COUNT         PIC S9(3)   VALUE ZERO.      
<            05  WS-UPDATE-SW                PIC S9      VALUE ZERO.      
<            05  WS-COMPLETED-SUCCESSFUL     PIC S9      VALUE ZERO.      
<              88  TRANSACTION-SUCCESSFUL                    VALUE +1.    
<              88  INITIAL-TRANSACTION                       VALUE +2.    
<              88  CHANGE-SUCCESSFUL                         VALUE +3.    
<                                                                         
100,104d88
< 112113
< 112113     05  WS-BUILD-FORWARD            PIC X       VALUE 'N'.
< 112113         88 NEEDTOBUILDFORWARD                   VALUE 'Y'.
< 112113     05  WS-CODE-LOADED              PIC X       VALUE 'N'.
< 112113         88 CODEALREADYLOADED                    VALUE 'Y'.
110,112c94
<            05  ELEOBC-LENGTH               PIC S9(4)   VALUE +350.
<            05  GETMAIN-SPACE               PIC  X      VALUE SPACE.
< 112113
---
> 
118d99
< 112113     05  MAX-LINES               PIC 999     VALUE 96.
120,121d100
< 112113     05  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 12.
< 112113     05  TS-GROUP-WORK           PIC 9(5)    VALUE 0  COMP-3.
123a103,104
>        01  ws-endbr-sw                 pic x value ' '.
>            88  true-endbr               value 'Y'.
125d105
<            05  SC-ITEM             PIC S9(4) COMP VALUE +1.             
154,156d133
<            05  WS-LOW-VALUES               PIC X VALUE LOW-VALUES.      
<            05  WS-SPACE                    PIC X       VALUE SPACE.     
<                                                                         
172,201c149,156
<                10  ER-0000                 PIC 9(4)   VALUE 0000.
<                10  ER-0004                 PIC 9(4)   VALUE 0004.
<                10  ER-0006                 PIC 9(4)   VALUE 0006.
<                10  ER-0008                 PIC 9(4)   VALUE 0008.
<                10  ER-0023                 PIC 9(4)   VALUE 0023.
<                10  ER-0029                 PIC 9(4)   VALUE 0029.
< 112113         10  ER-0033                 PIC 9(4)   VALUE 0033.
<                10  ER-0070                 PIC 9(4)   VALUE 0070.
<                10  ER-0150                 PIC 9(4)   VALUE 0150.
<                10  ER-0491                 PIC 9(4)   VALUE 0491.
<                10  ER-1079                 PIC 9(4)   VALUE 1079.
<                10  ER-1257                 PIC 9(4)   VALUE 1257.
<                10  ER-1258                 PIC 9(4)   VALUE 1258.
< 112113         10  ER-1698                 PIC 9(4)   VALUE 1698.
< 112113         10  ER-1699                 PIC 9(4)   VALUE 1699.
<                10  ER-2261                 PIC 9(4)   VALUE 2261.
<                10  ER-3800                 PIC 9(4)   VALUE 3800.
<                10  ER-3801                 PIC 9(4)   VALUE 3801.
<                10  ER-3802                 PIC 9(4)   VALUE 3802.
<                10  ER-3803                 PIC 9(4)   VALUE 3803.
<                10  ER-3804                 PIC 9(4)   VALUE 3804.
<                10  ER-3805                 PIC 9(4)   VALUE 3805.
<                10  ER-3806                 PIC 9(4)   VALUE 3806.
<                10  ER-3807                 PIC 9(4)   VALUE 3807.
<                10  ER-3840                 PIC 9(4)   VALUE 3840.
<                10  ER-3841                 PIC 9(4)   VALUE 3841.
<                10  ER-3842                 PIC 9(4)   VALUE 3842.
<                10  ER-7220                 PIC 9(4)   VALUE 7220.
<                10  ER-7698                 PIC 9(4)   VALUE 7698.
<                10  ER-9999                 PIC 9(4)   VALUE 9999.
---
>                10  ER-0004             PIC 9(4)   VALUE 0004.
>                10  ER-0006             PIC 9(4)   VALUE 0006.
>                10  ER-0008             PIC 9(4)   VALUE 0008.
>                10  ER-0023             PIC 9(4)   VALUE 0023.
>                10  ER-0029             PIC 9(4)   VALUE 0029.
> 112113         10  ER-0033             PIC 9(4)   VALUE 0033.
> 112113         10  ER-1698             PIC 9(4)   VALUE 1698.
> 112113         10  ER-1699             PIC 9(4)   VALUE 1699.
203c158
<            COPY ELCINTF.                                                
---
>                                        COPY ELCINTF.
225c180
< 112113         16  PI-TOTAL-LINES          PIC S9(3).
---
> 112113         16  PI-TOTAL-LINES          PIC S9(3)   comp-3.
233c188,189
< 121012         16  FILLER                  PIC X(1).
---
>                16  pi-6318-pass            PIC X.
>                16  filler                  pic x.
235c191
<            COPY EL614S.                                                 
---
>                                        COPY EL614S.
255,257d210
<                                                                         
<            COPY ELCJPFX.                                                
<                                            PIC X(750).                  
259c212,213
<                                        COPY ELCEOBC.
---
>                                        COPY ELCJPFX.
>                                        PIC X(750).
261,265c215,220
<            COPY ELCEMIB.                                                
<            COPY ELCDATE.                                                
<            COPY ELCLOGOF.                                               
<            COPY ELCATTR.                                                
<            COPY ELCAID.                                                 
---
>                                        COPY ELCEOBC.
>                                        COPY ELCEMIB.
>                                        COPY ELCDATE.
>                                        COPY ELCLOGOF.
>                                        COPY ELCATTR.
>                                        COPY ELCAID.
270,279d224
< 112113
< 
<        01  record-table pic x(93744).
<        01  rec-table redefines record-table.
<            12  ts-group occurs 28 times indexed by ts-indx pic x(3348).
< 112113 01  REC-ENTRIES REDEFINES RECORD-TABLE.
< 112113     12  REC-ENT OCCURS 336 TIMES INDEXED BY TB-INDX TB-INDX1.
< 112113         16  REC-EOB-CODE                PIC XXXX.
< 112113         16  REC-DESCRIPTION             PIC X(275).
< 
281,292c226
< 
< 
< 112113* 01  RECORD-TABLE                PIC X(26784) VALUE SPACES.
< 112113* 01  REC-TABLE  REDEFINES RECORD-TABLE.
< 112113*     12  TS-GROUP OCCURS 8 TIMES INDEXED BY TS-INDX PIC X(3348).
< 112113* 01  REC-ENTRIES REDEFINES RECORD-TABLE.
< 112113*     12  REC-ENT OCCURS 96 TIMES INDEXED BY TB-INDX TB-INDX1.
< 112113*         16  REC-EOB-CODE                PIC XXXX.
< 112113*         16  REC-DESCRIPTION             PIC X(275).
< 112113
< 112113 01  TS-WORK-AREA                        PIC X(3348).
< 112113
---
> 112113 01  TS-WORK-AREA                PIC X(3348).
295c229
<        01  DFHCOMMAREA                     PIC X(1024).                 
---
>        01  DFHCOMMAREA                 PIC X(1024).
346c280
<                                                                         
---
> 
492,494c426,427
< 112113        MOVE PI-TOP-LINE-NUM     TO PI-CURRENT-LINE
< 112113        PERFORM 7450-SET-INDX THRU 7450-EXIT
< 112113        GO TO 7050-FORMAT-LINES-FWD
---
>               move pi-dn-TOP-key    to WS-ELEOBC-KEY
>               GO TO 7000-browse-fwd
503,505c436,437
< 112113         MOVE PI-TOP-LINE-NUM TO PI-CURRENT-LINE
< 112113         PERFORM 7450-SET-INDX THRU 7450-EXIT
< 112113         GO TO 7050-FORMAT-LINES-FWD
---
>                move pi-dn-TOP-key    to WS-ELEOBC-KEY
>                GO TO 7000-browse-fwd
546,547c478,479
< 112113           PERFORM 7450-SET-INDX THRU 7450-EXIT
< 112113           GO TO 7150-FORMAT-LINES-BWD
---
>                  move pi-dn-top-key    to WS-ELEOBC-KEY
>                  GO TO 7150-browse-bwd
551,552c483,484
< 112113           PERFORM 7450-SET-INDX THRU 7450-EXIT
< 112113           GO TO 7050-FORMAT-LINES-FWD
---
>                  move pi-dn-bot-key    to WS-ELEOBC-KEY
>                  GO TO 7000-browse-fwd
588,589c520
< 112113
< 112113     SET TB-INDX TO 1.
---
> 
592c523,524
< 112113                                     PI-TEMP-STOR-ITEMS.
---
> 112113                                     PI-TEMP-STOR-ITEMS
>                                            i1
595,596c527,528
< 112113     MOVE LOW-VALUES             TO EL614AO
< 112113
---
>            move ' '                    to pi-6318-pass
> 
602a535,540
> 
>        7000-browse-fwd.
> 
>            set m1 to +1
>            move +1 to pi-browse-sw
>            move low-values to el614ao
626c564,579
< 112113
---
> 
>            perform varying s2 from +1 by +1 until
>               (s2 > +26)
>               or (WS-EOB-CODE(1:1) = pi-reason-code-flag (s2))
>            end-perform
>            if s2 <= +26
>               move '1'                 to pi-6318-pass
>            else
>               move '2'                 to pi-6318-pass
>            end-if
> 
>            if pi-6318-pass = '2'
>               go to 7010-NON-HIGHLIGHT-LOOP
>            end-if
> 
>            .
651,660c604,677
< 112113        S2 > +26
< 112113           IF EO-EOB-CODE (1:1) = PI-REASON-CODE-FLAG (S2)
< 112113              MOVE EO-EOB-CODE TO REC-EOB-CODE (TB-INDX)
< 112113              MOVE EO-DESCRIPTION TO REC-DESCRIPTION (TB-INDX)
< 112113              SET TB-INDX UP BY 1
< 112113           END-IF
< 112113     END-PERFORM
< 112113
< 112113     GO TO 7001-HIGHLIGHT-LOOP.
< 112113
---
> 112113        (S2 > +26)
>               or (eo-eob-code (1:1) = pi-reason-code-flag (s2))
>            end-perform
> 
>            if s2 > +26
>               go to 7001-highlight-loop
>            end-if
> 
>            MOVE eo-eob-code            TO WS-TABLE-CODE
>            MOVE WS-TAB-CODE-1          TO WS-SCR-CODE-4
>            MOVE WS-TAB-CODE-2-4        TO WS-SCR-CODE-1-3
>            MOVE WS-SCREEN-CODE         TO RCODEO (M1)
>            MOVE eo-DESCRIPTION         TO DESCO (M1)
>            MOVE AL-SABON               TO RCODEA (M1)
>            MOVE AL-SABOF               TO DESCA (M1)
> 
>            PERFORM VARYING E1 FROM +1 BY +1 UNTIL
>               E1 > +12
>               MOVE PI-EOB-CODE (E1)    TO WS-SCREEN-CODE
>               MOVE WS-SCR-CODE-1-3     TO WS-TAB-CODE-2-4
>               MOVE WS-SCR-CODE-4       TO WS-TAB-CODE-1
>               IF eo-EOB-CODE  = WS-TABLE-CODE
>                  MOVE 'S'              TO SELI (M1)
>                  MOVE +1               TO SELL (M1)
>               END-IF
>            END-PERFORM
> 
>            if m1 = +1
>               move ws-eleobc-key to pi-dn-top-key
>            else
>               move ws-eleobc-key to pi-dn-bot-key
>            end-if
> 
>            IF PI-EXPANDED-VIEW = 'Y' 
>                IF eo-DESCRIPTION (61:60) > SPACES 
>                  AND M1 < +17
>                    SET N1 TO M1
>                    SET M1 UP BY +1
>                    MOVE eo-DESCRIPTION (61:60) TO DESCO (M1)
>                    MOVE DESCA (N1)    TO DESCA (M1)
>                    MOVE AL-SADOF      TO SELA (M1)
>                END-IF
>                IF eo-DESCRIPTION (121:60) > SPACES 
>                  AND M1 < +17
>                    SET N1 TO M1
>                    SET M1 UP BY +1
>                    MOVE eo-DESCRIPTION (121:60) TO DESCO (M1)
>                    MOVE DESCA (N1)    TO DESCA (M1)
>                    MOVE AL-SADOF      TO SELA (M1)
>                END-IF
>                IF eo-DESCRIPTION (181:60) > SPACES
>                  AND M1 < +17
>                    SET N1 TO M1
>                    SET M1 UP BY +1
>                    MOVE eo-DESCRIPTION (181:60) TO DESCO (M1)
>                    MOVE DESCA (N1)    TO DESCA (M1)
>                    MOVE AL-SADOF      TO SELA (M1)
>                END-IF
>                IF Eo-DESCRIPTION (241:35) > SPACES
>                  AND M1 < +17
>                    SET N1 TO M1
>                    SET M1 UP BY +1
>                    MOVE eo-DESCRIPTION (241:35) TO DESCO (M1)
>                    MOVE DESCA (N1)    TO DESCA (M1)
>                    MOVE AL-SADOF      TO SELA (M1)
>                END-IF
>            END-IF
> 
>            if m1 < num-lines-per-screen
>               set m1 up by +1
>               go to 7001-HIGHLIGHT-LOOP
>            end-if
> 
>            .
661a679,685
> 
>            if m1 = num-lines-per-screen   *> filled up the screen
>               go to 7030-endbr
>            end-if
> 
>       *** did not fill up screen, now load non highlighted stuff
> 
664a689,690
> 
>            move '2'                    to pi-6318-pass
708d733
< 112113     MOVE 'N' TO WS-CODE-LOADED
710,713c735,736
< 112113        S2 > +26
< 112113           IF EO-EOB-CODE (1:1) = PI-REASON-CODE-FLAG (S2)
< 112113               SET CODEALREADYLOADED TO TRUE
< 112113           END-IF
---
> 112113        (S2 > +26)
>               or EO-EOB-CODE (1:1) = PI-REASON-CODE-FLAG (S2)
715,723c738,809
< 112113
< 112113     IF NOT CODEALREADYLOADED
< 112113        MOVE EO-EOB-CODE TO REC-EOB-CODE (TB-INDX)
< 112113        MOVE EO-DESCRIPTION TO REC-DESCRIPTION (TB-INDX)
< 112113        SET TB-INDX UP BY 1
< 112113     END-IF
< 112113
< 112113     GO TO 7010-NON-HIGHLIGHT-LOOP.
< 112113
---
> 
>            if s2 <= +26  *> found one previously loaded on screen
>               go to 7010-non-highlight-loop
>            end-if
> 
>            MOVE eo-eob-code            TO WS-TABLE-CODE
>            MOVE WS-TAB-CODE-1          TO WS-SCR-CODE-4
>            MOVE WS-TAB-CODE-2-4        TO WS-SCR-CODE-1-3
>            MOVE WS-SCREEN-CODE         TO RCODEO (M1)
>            MOVE eo-DESCRIPTION         TO DESCO (M1)
> 
>            PERFORM VARYING E1 FROM +1 BY +1 UNTIL
>               E1 > +12
>               MOVE PI-EOB-CODE (E1)    TO WS-SCREEN-CODE
>               MOVE WS-SCR-CODE-1-3     TO WS-TAB-CODE-2-4
>               MOVE WS-SCR-CODE-4       TO WS-TAB-CODE-1
>               IF eo-EOB-CODE  = WS-TABLE-CODE
>                  MOVE 'S'              TO SELI (M1)
>                  MOVE +1               TO SELL (M1)
>               END-IF
>            END-PERFORM
> 
>            if m1 = +1
>               move ws-eleobc-key to pi-dn-top-key
>            else
>               move ws-eleobc-key to pi-dn-bot-key
>            end-if
> 
>            IF PI-EXPANDED-VIEW = 'Y' 
>                IF eo-DESCRIPTION (61:60) > SPACES 
>                  AND M1 < +17
>                    SET N1 TO M1
>                    SET M1 UP BY +1
>                    MOVE eo-DESCRIPTION (61:60) TO DESCO (M1)
>                    MOVE DESCA (N1)    TO DESCA (M1)
>                    MOVE AL-SADOF      TO SELA (M1)
>                END-IF
>                IF eo-DESCRIPTION (121:60) > SPACES 
>                  AND M1 < +17
>                    SET N1 TO M1
>                    SET M1 UP BY +1
>                    MOVE eo-DESCRIPTION (121:60) TO DESCO (M1)
>                    MOVE DESCA (N1)    TO DESCA (M1)
>                    MOVE AL-SADOF      TO SELA (M1)
>                END-IF
>                IF eo-DESCRIPTION (181:60) > SPACES
>                  AND M1 < +17
>                    SET N1 TO M1
>                    SET M1 UP BY +1
>                    MOVE eo-DESCRIPTION (181:60) TO DESCO (M1)
>                    MOVE DESCA (N1)    TO DESCA (M1)
>                    MOVE AL-SADOF      TO SELA (M1)
>                END-IF
>                IF Eo-DESCRIPTION (241:35) > SPACES
>                  AND M1 < +17
>                    SET N1 TO M1
>                    SET M1 UP BY +1
>                    MOVE eo-DESCRIPTION (241:35) TO DESCO (M1)
>                    MOVE DESCA (N1)    TO DESCA (M1)
>                    MOVE AL-SADOF      TO SELA (M1)
>                END-IF
>            END-IF
> 
>            if m1 < num-lines-per-screen
>               set m1 up by +1
>               go to 7010-NON-HIGHLIGHT-LOOP
>            end-if
> 
>       ***  filled up the screen
>            go to 7030-endbr
> 
>            .
724a811
> 
746,751c833,926
< 112113
< 112113     MOVE EO-EOB-CODE TO REC-EOB-CODE (TB-INDX)
< 112113     MOVE EO-DESCRIPTION TO REC-DESCRIPTION (TB-INDX)
< 112113     SET TB-INDX UP BY 1
< 112113     GO TO 7020-LOOP.
< 112113
---
> 
>            IF PI-RETURN-TO-PROGRAM = 'EL6318'
>                MOVE eo-eob-code        TO WS-TABLE-CODE
>                MOVE WS-TAB-CODE-1      TO WS-SCR-CODE-4
>                MOVE WS-TAB-CODE-2-4    TO WS-SCR-CODE-1-3
>                MOVE WS-SCREEN-CODE     TO RCODEO (M1)
>            ELSE
>                MOVE eo-eob-code        TO RCODEO (M1)
>            END-IF
>            MOVE eo-DESCRIPTION         TO DESCO (M1)
>       
>       ** Highlighting done here I think
> 
>            IF PI-RETURN-TO-PROGRAM = 'EL6318'
>               PERFORM VARYING S2 FROM +1 BY +1 UNTIL
>                 S2 > +26
>                   IF RCODEO (M1)(4:1) = PI-REASON-CODE-FLAG (S2)
>                      MOVE AL-SABON TO RCODEA (M1)
>                      MOVE AL-SABOF TO DESCA (M1)
>                   END-IF
>               END-PERFORM
>            END-IF
> 
>            IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317'
>               OR 'EL6316'
>               PERFORM VARYING E1 FROM +1 BY +1 UNTIL
>                  E1 > +12
>                  IF EO-EOB-CODE = PI-EOB-CODE (E1)
>                     MOVE 'S'           TO SELI (M1)
>                     MOVE +1            TO SELL (M1)
>                  END-IF
>               END-PERFORM
>            END-IF
>       
>            IF PI-RETURN-TO-PROGRAM = 'EL6318'
>               PERFORM VARYING E1 FROM +1 BY +1 UNTIL
>                  E1 > +12
>                  MOVE PI-EOB-CODE (E1) TO WS-SCREEN-CODE
>                  MOVE WS-SCR-CODE-1-3  TO WS-TAB-CODE-2-4
>                  MOVE WS-SCR-CODE-4    TO WS-TAB-CODE-1
>                  IF eo-EOB-CODE  = WS-TABLE-CODE
>                     MOVE 'S'           TO SELI (M1)
>                     MOVE +1            TO SELL (M1)
>                  END-IF
>               END-PERFORM
>            END-IF
>       
>            if m1 = +1
>               move ws-eleobc-key to pi-dn-top-key
>            else
>               move ws-eleobc-key to pi-dn-bot-key
>            end-if
> 
>            IF PI-EXPANDED-VIEW = 'Y' 
>                IF eo-DESCRIPTION (61:60) > SPACES 
>                  AND M1 < +17
>                    SET N1 TO M1
>                    SET M1 UP BY +1
>                    MOVE eo-DESCRIPTION (61:60) TO DESCO (M1)
>                    MOVE DESCA (N1)    TO DESCA (M1)
>                    MOVE AL-SADOF      TO SELA (M1)
>                END-IF
>                IF eo-DESCRIPTION (121:60) > SPACES 
>                  AND M1 < +17
>                    SET N1 TO M1
>                    SET M1 UP BY +1
>                    MOVE eo-DESCRIPTION (121:60) TO DESCO (M1)
>                    MOVE DESCA (N1)    TO DESCA (M1)
>                    MOVE AL-SADOF      TO SELA (M1)
>                END-IF
>                IF eo-DESCRIPTION (181:60) > SPACES
>                  AND M1 < +17
>                    SET N1 TO M1
>                    SET M1 UP BY +1
>                    MOVE eo-DESCRIPTION (181:60) TO DESCO (M1)
>                    MOVE DESCA (N1)    TO DESCA (M1)
>                    MOVE AL-SADOF      TO SELA (M1)
>                END-IF
>                IF Eo-DESCRIPTION (241:35) > SPACES
>                  AND M1 < +17
>                    SET N1 TO M1
>                    SET M1 UP BY +1
>                    MOVE eo-DESCRIPTION (241:35) TO DESCO (M1)
>                    MOVE DESCA (N1)    TO DESCA (M1)
>                    MOVE AL-SADOF      TO SELA (M1)
>                END-IF
>            END-IF
> 
>            if m1 < num-lines-per-screen
>               set m1 up by +1
>               go to 7020-loop
>            end-if
> 
>            .
754,1041c929,1210
< 112113     IF TB-INDX = 1
< 112113         MOVE ER-0006            TO EMI-ERROR
< 112113         MOVE -1                 TO APFKL
< 112113         MOVE AL-UABOF           TO APFKA
< 112113         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
< 112113         MOVE ZEROS              TO PI-TOTAL-LINES
< 112113         GO TO 8100-SEND-INITIAL-MAP
< 112113     END-IF.
< 112113
< 112113     IF PI-BROWSE-SW = +1
< 112113        EXEC CICS ENDBR
< 112113           DATASET ('ELEOBC')
< 112113        END-EXEC
< 112113        MOVE +0                  TO PI-BROWSE-SW
< 112113     END-IF
< 112113
< 112113     SET TB-INDX DOWN BY 1.
< 112113     SET PI-TOTAL-LINES TO TB-INDX.
< 112113     MOVE 1                      TO PI-CURRENT-LINE.
< 112113     MOVE 1                      TO PI-TOP-LINE-NUM.
< 112113     SET TB-INDX                 TO PI-CURRENT-LINE.
< 112113
< 112113 7050-FORMAT-LINES-FWD.
< 112113     IF PI-CURRENT-LINE >= PI-TOTAL-LINES
< 112113        MOVE ER-1699             TO EMI-ERROR
< 112113        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
< 112113        MOVE PI-TOP-LINE-NUM TO PI-CURRENT-LINE
< 112113        PERFORM 7450-SET-INDX THRU 7450-EXIT
< 112113     END-IF.
< 112113
< 112113     MOVE LOW-VALUES             TO EL614AI.
< 112113     PERFORM 7100-FORMAT-SCREEN-FWD THRU 7100-EXIT
< 112113             VARYING M1 FROM 1
< 112113             BY 1 UNTIL M1 > NUM-LINES-PER-SCREEN.
< 112113     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
< 112113     GO TO 8100-SEND-INITIAL-MAP.
< 112113
< 112113 7100-FORMAT-SCREEN-FWD.
< 112113
< 112113     IF TB-INDX > PI-TOTAL-LINES
< 112113         GO TO 7100-EXIT
< 112113     END-IF.
< 112113
< 112113     IF PI-RETURN-TO-PROGRAM = 'EL6318'
< 112113         MOVE REC-EOB-CODE (TB-INDX) TO WS-TABLE-CODE
< 112113         MOVE WS-TAB-CODE-1      TO WS-SCR-CODE-4
< 112113         MOVE WS-TAB-CODE-2-4    TO WS-SCR-CODE-1-3
< 112113         MOVE WS-SCREEN-CODE     TO RCODEO (M1)
< 112113     ELSE
< 112113         MOVE REC-EOB-CODE (TB-INDX) TO RCODEO (M1)
< 112113     END-IF
< 112113     MOVE REC-DESCRIPTION (TB-INDX)  TO DESCO (M1)
< 112113
< 112113     IF PI-RETURN-TO-PROGRAM = 'EL6318'
< 112113        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
< 112113          S2 > +26
< 112113            IF RCODEO (M1)(4:1) = PI-REASON-CODE-FLAG (S2)
< 112113               MOVE AL-SABON TO RCODEA (M1)
< 112113               MOVE AL-SABOF TO DESCA (M1)
< 112113            END-IF
< 112113        END-PERFORM
< 112113     END-IF
< 112113
< 112113     IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317'
< 112113        OR 'EL6316'
< 112113        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
< 112113           E1 > +12
< 112113           IF REC-EOB-CODE (TB-INDX) = PI-EOB-CODE (E1)
< 112113              MOVE 'S'           TO SELI (M1)
< 112113              MOVE +1            TO SELL (M1)
< 112113           END-IF
< 112113        END-PERFORM
< 112113     END-IF
< 112113
< 112113     IF PI-RETURN-TO-PROGRAM = 'EL6318'
< 112113        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
< 112113           E1 > +12
< 112113           MOVE PI-EOB-CODE (E1) TO WS-SCREEN-CODE
< 112113           MOVE WS-SCR-CODE-1-3  TO WS-TAB-CODE-2-4
< 112113           MOVE WS-SCR-CODE-4    TO WS-TAB-CODE-1
< 112113           IF REC-EOB-CODE (TB-INDX) = WS-TABLE-CODE
< 112113              MOVE 'S'           TO SELI (M1)
< 112113              MOVE +1            TO SELL (M1)
< 112113           END-IF
< 112113        END-PERFORM
< 112113     END-IF
< 112113
< 112113     IF PI-EXPANDED-VIEW = 'Y' 
< 112113         IF REC-DESCRIPTION (TB-INDX) (61:60) > SPACES 
< 112113           AND M1 < +17
< 112113             SET N1 TO M1
< 112113             SET M1 UP BY +1
< 112113             MOVE REC-DESCRIPTION (TB-INDX)(61:60) TO DESCO (M1)
< 112113             MOVE DESCA (N1)    TO DESCA (M1)
< 112113             MOVE AL-SADOF      TO SELA (M1)
< 112113         END-IF
< 112113         IF REC-DESCRIPTION (TB-INDX) (121:60) > SPACES 
< 112113           AND M1 < +17
< 112113             SET N1 TO M1
< 112113             SET M1 UP BY +1
< 112113             MOVE REC-DESCRIPTION (TB-INDX)(121:60) TO DESCO (M1)
< 112113             MOVE DESCA (N1)    TO DESCA (M1)
< 112113             MOVE AL-SADOF      TO SELA (M1)
< 112113         END-IF
< 112113         IF REC-DESCRIPTION (TB-INDX) (181:60) > SPACES
< 112113           AND M1 < +17
< 112113             SET N1 TO M1
< 112113             SET M1 UP BY +1
< 112113             MOVE REC-DESCRIPTION (TB-INDX)(181:60) TO DESCO (M1)
< 112113             MOVE DESCA (N1)    TO DESCA (M1)
< 112113             MOVE AL-SADOF      TO SELA (M1)
< 112113         END-IF
< 112113         IF REC-DESCRIPTION (TB-INDX) (241:35) > SPACES
< 112113           AND M1 < +17
< 112113             SET N1 TO M1
< 112113             SET M1 UP BY +1
< 112113             MOVE REC-DESCRIPTION (TB-INDX)(241:35) TO DESCO (M1)
< 112113             MOVE DESCA (N1)    TO DESCA (M1)
< 112113             MOVE AL-SADOF      TO SELA (M1)
< 112113         END-IF
< 112113     END-IF
< 112113
< 112113     SET PI-BOT-LINE-NUM TO TB-INDX
< 112113     SET TB-INDX UP BY 1.
< 112113
< 112113 7100-EXIT.
< 112113      EXIT.
< 112113
< 112113
< 112113 7150-FORMAT-LINES-BWD.
< 112113     IF PI-CURRENT-LINE <= 1
< 112113        MOVE ER-1698             TO EMI-ERROR
< 112113        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
< 112113        MOVE PI-BOT-LINE-NUM TO PI-CURRENT-LINE
< 112113        PERFORM 7450-SET-INDX THRU 7450-EXIT
< 112113     END-IF.
< 112113
< 112113     MOVE LOW-VALUES             TO EL614AI.
< 112113     MOVE 'N' TO WS-BUILD-FORWARD.
< 112113     PERFORM 7150-FORMAT-SCREEN-BWD THRU 7150-EXIT
< 112113             VARYING M1 FROM 17
< 112113             BY -1 UNTIL M1 < 1 OR NEEDTOBUILDFORWARD.
< 112113     IF NEEDTOBUILDFORWARD
< 112113        PERFORM 7450-SET-INDX THRU 7450-EXIT
< 112113        GO TO 7050-FORMAT-LINES-FWD
< 112113     END-IF
< 112113     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
< 112113     GO TO 8100-SEND-INITIAL-MAP.
< 112113
< 112113 7150-FORMAT-SCREEN-BWD.
< 112113
< 112113     IF TB-INDX < 1
< 112113         GO TO 7150-END
< 112113     END-IF.
< 112113
< 112113     IF PI-EXPANDED-VIEW = 'Y'
< 112113         EVALUATE TRUE
< 112113           WHEN REC-DESCRIPTION (TB-INDX)(241:35) > SPACES
< 112113             IF M1 < +5
< 112113                 GO TO 7150-END
< 112113             ELSE
< 112113                 SET M1 DOWN BY +4
< 112113             END-IF
< 112113           WHEN REC-DESCRIPTION (TB-INDX)(181:60) > SPACES
< 112113             IF M1 < +4
< 112113                 GO TO 7150-END
< 112113             ELSE
< 112113                 SET M1 DOWN BY +3
< 112113             END-IF
< 112113           WHEN REC-DESCRIPTION (TB-INDX)(121:60) > SPACES
< 112113             IF M1 < +3
< 112113                 GO TO 7150-END
< 112113             ELSE
< 112113                 SET M1 DOWN BY +2
< 112113             END-IF
< 112113           WHEN REC-DESCRIPTION (TB-INDX)(61:60) > SPACES
< 112113             IF M1 < +2
< 112113                 GO TO 7150-END
< 112113             ELSE
< 112113                 SET M1 DOWN BY +1
< 112113             END-IF
< 112113         END-EVALUATE
< 112113     END-IF
< 112113
< 112113     IF PI-RETURN-TO-PROGRAM = 'EL6318'
< 112113         MOVE REC-EOB-CODE (TB-INDX) TO WS-TABLE-CODE
< 112113         MOVE WS-TAB-CODE-1      TO WS-SCR-CODE-4
< 112113         MOVE WS-TAB-CODE-2-4    TO WS-SCR-CODE-1-3
< 112113         MOVE WS-SCREEN-CODE     TO RCODEO (M1)
< 112113     ELSE
< 112113         MOVE REC-EOB-CODE (TB-INDX) TO RCODEO (M1)
< 112113     END-IF
< 112113     MOVE REC-DESCRIPTION (TB-INDX)  TO DESCO (M1)
< 112113
< 112113     IF PI-RETURN-TO-PROGRAM = 'EL6318'
< 112113        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
< 112113          S2 > +26
< 112113            IF RCODEO (M1)(4:1) = PI-REASON-CODE-FLAG (S2)
< 112113               MOVE AL-SABON TO RCODEA (M1)
< 112113               MOVE AL-SABOF TO DESCA (M1)
< 112113            END-IF
< 112113        END-PERFORM
< 112113     END-IF
< 112113
< 112113     IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317'
< 112113        OR 'EL6316'
< 112113        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
< 112113           E1 > +12
< 112113           IF REC-EOB-CODE (TB-INDX) = PI-EOB-CODE (E1)
< 112113              MOVE 'S'           TO SELI (M1)
< 112113              MOVE +1            TO SELL (M1)
< 112113           END-IF
< 112113        END-PERFORM
< 112113     END-IF
< 112113
< 112113     IF PI-RETURN-TO-PROGRAM = 'EL6318'
< 112113        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
< 112113           E1 > +12
< 112113           MOVE PI-EOB-CODE (E1) TO WS-SCREEN-CODE
< 112113           MOVE WS-SCR-CODE-1-3  TO WS-TAB-CODE-2-4
< 112113           MOVE WS-SCR-CODE-4    TO WS-TAB-CODE-1
< 112113           IF REC-EOB-CODE (TB-INDX) = WS-TABLE-CODE
< 112113              MOVE 'S'           TO SELI (M1)
< 112113              MOVE +1            TO SELL (M1)
< 112113           END-IF
< 112113        END-PERFORM
< 112113     END-IF
< 112113
< 112113     SET M2 TO M1
< 112113     IF PI-EXPANDED-VIEW = 'Y'
< 112113         IF REC-DESCRIPTION (TB-INDX) (61:60) > SPACES
< 112113             SET N1 TO M1
< 112113             SET M1 UP BY +1
< 112113             MOVE REC-DESCRIPTION (TB-INDX)(61:60) TO DESCO(M1)
< 112113             MOVE DESCA (N1)    TO DESCA (M1)
< 112113             MOVE AL-SADOF      TO SELA (M1)
< 112113         END-IF
< 112113         IF REC-DESCRIPTION (TB-INDX) (121:60) > SPACES
< 112113             SET N1 TO M1
< 112113             SET M1 UP BY +1
< 112113             MOVE REC-DESCRIPTION (TB-INDX)(121:60) TO DESCO(M1)
< 112113             MOVE DESCA (N1)    TO DESCA (M1)
< 112113             MOVE AL-SADOF      TO SELA (M1)
< 112113         END-IF
< 112113         IF REC-DESCRIPTION (TB-INDX) (181:60) > SPACES
< 112113             SET N1 TO M1
< 112113             SET M1 UP BY +1
< 112113             MOVE REC-DESCRIPTION (TB-INDX)(181:60) TO DESCO(M1)
< 112113             MOVE DESCA (N1)    TO DESCA (M1)
< 112113             MOVE AL-SADOF      TO SELA (M1)
< 112113         END-IF
< 112113         IF REC-DESCRIPTION (TB-INDX) (241:35) > SPACES
< 112113             SET N1 TO M1
< 112113             SET M1 UP BY +1
< 112113             MOVE REC-DESCRIPTION (TB-INDX)(241:35) TO DESCO(M1)
< 112113             MOVE DESCA (N1)    TO DESCA (M1)
< 112113             MOVE AL-SADOF      TO SELA (M1)
< 112113         END-IF
< 112113     END-IF
< 112113     SET M1 TO M2
< 112113
< 112113     SET PI-TOP-LINE-NUM TO TB-INDX
< 112113     SET TB-INDX DOWN BY 1.
< 112113     GO TO 7150-EXIT.
< 112113
< 112113 7150-END.
< 112113
< 112113     IF M1 >= +1
< 112113        MOVE 'Y' TO WS-BUILD-FORWARD
< 112113        IF TB-INDX < +1
< 112113           MOVE 1 TO PI-CURRENT-LINE PI-TOP-LINE-NUM
< 112113        ELSE
< 112113           MOVE PI-TOP-LINE-NUM TO PI-CURRENT-LINE
< 112113        END-IF
< 112113     END-IF.
< 112113
< 112113 7150-EXIT.
< 112113      EXIT.
< 112113
< 112113 7200-PUT-TEMP-STOR.
< 112113     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
< 112113     SET TS-INDX TO 1.
< 112113     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
< 112113     PERFORM 7300-WRITE-TS THRU 7399-EXIT
< 112113             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
< 112113             UNTIL TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
< 112113 7249-EXIT.
< 112113      EXIT.
---
>            IF PI-BROWSE-SW = +1
>               EXEC CICS ENDBR
>                  DATASET ('ELEOBC')
>               END-EXEC
>               MOVE +0                  TO PI-BROWSE-SW
>            END-IF
> 
>            IF m1 = 0
>                MOVE ER-0006            TO EMI-ERROR
>                MOVE -1                 TO APFKL
>                MOVE AL-UABOF           TO APFKA
>                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
>                MOVE ZEROS              TO PI-TOTAL-LINES
>                GO TO 8100-SEND-INITIAL-MAP
>            END-IF.
> 
>            IF m1 < num-lines-per-screen
>               MOVE ER-1699             TO EMI-ERROR
>               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
>            END-IF.
> 
>            go to 8100-send-initial-map
> 
>            .
>        7150-browse-bwd.
> 
>            set m1 to num-lines-per-screen
>            move +1 to pi-browse-sw
>            move low-values to el614ao
> 
>            EXEC CICS STARTBR
>                DATASET   ('ELEOBC')
>                RIDFLD    (WS-ELEOBC-KEY)
>                GTEQ
>                RESP      (WS-RESPONSE)
>            END-EXEC.
> 
>        7150-check-startbr.
> 
>            EVALUATE TRUE
>               WHEN RESP-ENDFILE
>                  GO TO 7180-ENDBR
>               WHEN RESP-NORMAL
>                  CONTINUE
>               WHEN RESP-NOTFND
>                  GO TO 7180-ENDBR
>            END-EVALUATE.
> 
>       *** 6318-pass is just if we came from 6318
>       *** pass one = highligted ones, pass two = all others
> 
>            IF PI-RETURN-TO-PROGRAM = 'EL6318'
>               PERFORM VARYING S2 FROM +1 BY +1 UNTIL
>                 (S2 > +26)
>                  or (ws-eob-code(1:1) = PI-REASON-CODE-FLAG (S2))
>               END-PERFORM
>               if s2 <= +26
>                  move '1'              to pi-6318-pass
>               end-if
>            END-IF
> 
>            .
>        7160-LOOP.
> 
>            EXEC CICS READPREV
>                INTO    (EOB-CODES)
>                DATASET ('ELEOBC')
>                RIDFLD  (WS-ELEOBC-KEY)
>                RESP    (WS-RESPONSE)
>            END-EXEC
>       
>            EVALUATE TRUE
>               WHEN RESP-ENDFILE
>                  set true-endbr to true
>                  GO TO 7180-ENDBR
>               WHEN (PI-COMPANY-CD NOT = WS-COMPANY-CD)
>                  OR ((PI-RECORD-TYPE NOT = EO-RECORD-TYPE)
>                      AND (PI-RECORD-TYPE NOT = SPACES))
>                  set true-endbr to true
>                  GO TO 7180-ENDBR
>               WHEN EO-COMPANY-CD NOT = PI-COMPANY-CD
>                  set true-endbr to true
>                  GO TO 7180-ENDBR
>               WHEN RESP-NORMAL
>                  CONTINUE
>               WHEN RESP-NOTFND
>                  set true-endbr to true
>                  GO TO 7180-ENDBR
>            END-EVALUATE
> 
>            IF PI-RETURN-TO-PROGRAM = 'EL6318'
>               PERFORM VARYING S2 FROM +1 BY +1 UNTIL
>                 (S2 > +26)
>                  or (eo-eob-code(1:1) = PI-REASON-CODE-FLAG (S2))
>               END-PERFORM
>               if s2 <= +26
>                  if pi-6318-pass = '1'
>                     continue
>                  else
>                     go to 7160-loop
>                  end-if
>               else
>                  if pi-6318-pass = '2'
>                     continue
>                  else
>                     go to 7160-loop
>                  end-if
>               end-if
>            end-if
> 
>            if m1 = num-lines-per-screen
>               move ws-eleobc-key to pi-dn-bot-key
>            else
>               move ws-eleobc-key to pi-dn-top-key
>            end-if
> 
>            IF PI-EXPANDED-VIEW = 'Y'
>               EVALUATE TRUE
>                 WHEN EO-DESCRIPTION (241:35) > SPACES
>                   IF M1 < +5
>                       GO TO 7180-ENDBR
>                   ELSE
>                       SET M1 DOWN BY +4
>                   END-IF
>                 WHEN EO-DESCRIPTION (181:60) > SPACES
>                   IF M1 < +4
>                       GO TO 7180-ENDBR
>                   ELSE
>                       SET M1 DOWN BY +3
>                   END-IF
>                 WHEN EO-DESCRIPTION (121:60) > SPACES
>                   IF M1 < +3
>                       GO TO 7180-ENDBR
>                   ELSE
>                       SET M1 DOWN BY +2
>                   END-IF
>                 WHEN EO-DESCRIPTION (61:60) > SPACES
>                   IF M1 < +2
>                       GO TO 7180-ENDBR
>                   ELSE
>                       SET M1 DOWN BY +1
>                   END-IF
>               END-EVALUATE
>            END-IF
> 
>            IF PI-RETURN-TO-PROGRAM = 'EL6318'
>                MOVE eo-eob-code        TO WS-TABLE-CODE
>                MOVE WS-TAB-CODE-1      TO WS-SCR-CODE-4
>                MOVE WS-TAB-CODE-2-4    TO WS-SCR-CODE-1-3
>                MOVE WS-SCREEN-CODE     TO RCODEO (M1)
>            ELSE
>                MOVE eo-eob-code        TO RCODEO (M1)
>            END-IF
>            MOVE eo-DESCRIPTION         TO DESCO (M1)
>            IF PI-RETURN-TO-PROGRAM = 'EL6318'
>               PERFORM VARYING S2 FROM +1 BY +1 UNTIL
>                 S2 > +26
>                   IF RCODEO (M1)(4:1) = PI-REASON-CODE-FLAG (S2)
>                      MOVE AL-SABON TO RCODEA (M1)
>                      MOVE AL-SABOF TO DESCA (M1)
>                   END-IF
>               END-PERFORM
>            END-IF
> 
>            IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317'
>               OR 'EL6316'
>               PERFORM VARYING E1 FROM +1 BY +1 UNTIL
>                  E1 > +12
>                  IF eo-EOB-CODE = PI-EOB-CODE (E1)
>                     MOVE 'S'           TO SELI (M1)
>                     MOVE +1            TO SELL (M1)
>                  END-IF
>               END-PERFORM
>            END-IF
>       
>            IF PI-RETURN-TO-PROGRAM = 'EL6318'
>               PERFORM VARYING E1 FROM +1 BY +1 UNTIL
>                  E1 > +12
>                  MOVE PI-EOB-CODE (E1) TO WS-SCREEN-CODE
>                  MOVE WS-SCR-CODE-1-3  TO WS-TAB-CODE-2-4
>                  MOVE WS-SCR-CODE-4    TO WS-TAB-CODE-1
>                  IF eo-EOB-CODE = WS-TABLE-CODE
>                     MOVE 'S'           TO SELI (M1)
>                     MOVE +1            TO SELL (M1)
>                  END-IF
>               END-PERFORM
>            END-IF
> 
>            SET M2 TO M1
>            IF PI-EXPANDED-VIEW = 'Y'
>               IF EO-DESCRIPTION (61:60) > SPACES
>                  SET N1 TO M1
>                  SET M1 UP BY +1
>                  MOVE EO-DESCRIPTION (61:60) TO DESCO(M1)
>                  MOVE DESCA (N1)       TO DESCA (M1)
>                  MOVE AL-SADOF         TO SELA (M1)
>               END-IF
>               IF EO-DESCRIPTION (121:60) > SPACES
>                  SET N1 TO M1
>                  SET M1 UP BY +1
>                  MOVE EO-DESCRIPTION (121:60) TO DESCO(M1)
>                  MOVE DESCA (N1)       TO DESCA (M1)
>                  MOVE AL-SADOF         TO SELA (M1)
>               END-IF
>               IF EO-DESCRIPTION (181:60) > SPACES
>                  SET N1 TO M1
>                  SET M1 UP BY +1
>                  MOVE EO-DESCRIPTION (181:60) TO DESCO(M1)
>                  MOVE DESCA (N1)       TO DESCA (M1)
>                  MOVE AL-SADOF         TO SELA (M1)
>               END-IF
>               IF EO-DESCRIPTION (241:35) > SPACES
>                  SET N1 TO M1
>                  SET M1 UP BY +1
>                  MOVE EO-DESCRIPTION (241:35) TO DESCO(M1)
>                  MOVE DESCA (N1)       TO DESCA (M1)
>                  MOVE AL-SADOF         TO SELA (M1)
>               END-IF
>            END-IF
>            SET M1 TO M2
> 
>            if m1 > +1
>               set m1 down by +1
>               go to 7160-loop
>            end-if
> 
>            .
> 112113 7180-ENDBR.
>            
>            if pi-return-to-program = 'EL6318'
>               if pi-6318-pass = '2'
>                  and true-endbr
>                  if m1 > +1
>                     move '1' to pi-6318-pass
>                     EXEC CICS ENDBR
>                        DATASET ('ELEOBC')
>                     END-EXEC
>                     MOVE +0            TO PI-BROWSE-SW
>                     move '4' to ws-eob-rec-type
>                     move spaces to ws-eob-code
>                     EXEC CICS STARTBR
>                         DATASET   ('ELEOBC')
>                         RIDFLD    (WS-ELEOBC-KEY)
>                         LTEQ
>                         RESP      (WS-RESPONSE)
>                     END-EXEC
>                     move ' ' to ws-endbr-sw
>                     go to 7150-check-startbr
>                  end-if
>               end-if
>            end-if
> 
>            IF PI-BROWSE-SW = +1
>               EXEC CICS ENDBR
>                  DATASET ('ELEOBC')
>               END-EXEC
>               MOVE +0                  TO PI-BROWSE-SW
>            END-IF
>       
>            IF m1 = 0
>                MOVE ER-0006            TO EMI-ERROR
>                MOVE -1                 TO APFKL
>                MOVE AL-UABOF           TO APFKA
>                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
>                MOVE ZEROS              TO PI-TOTAL-LINES
>                GO TO 8100-SEND-INITIAL-MAP
>            END-IF.
> 
>            if true-endbr
>               and pi-6318-pass not = '2'
>               MOVE ER-1698             TO EMI-ERROR
>               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
>            end-if
> 
>            IF m1 > +1
>               move pi-dn-top-key to ws-eleobc-key
>               go to 7000-browse-fwd
>            END-IF
> 
>            go to 8100-send-initial-map
> 
>            .
1052,1078d1220
< 112113 7300-WRITE-TS.
< 112113     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
< 112113     SET TS-INDX UP BY 1.
< 112113     ADD 1 TO PI-TEMP-STOR-ITEMS.
< 112113     EXEC CICS WRITEQ TS
< 112113          FROM(TS-WORK-AREA)
< 112113          QUEUE(QID)
< 112113          LENGTH(TS-LENGTH)
< 112113          ITEM(PI-TEMP-STOR-ITEMS)
< 112113     END-EXEC.
< 112113 7399-EXIT.
< 112113     EXIT.
< 112113
< 112113 7450-SET-INDX.
< 112113     IF PI-CURRENT-LINE = 0 AND PI-TOTAL-LINES = 0
< 112113        SET TB-INDX TO 1
< 112113     ELSE
< 112113        PERFORM 7500-READ-TS THRU 7599-EXIT
< 112113        IF PI-CURRENT-LINE = 0
< 112113           SET TB-INDX TO 1
< 112113        ELSE
< 112113           SET TB-INDX TO PI-CURRENT-LINE
< 112113        END-IF
< 112113     END-IF.
< 112113 7450-EXIT.
< 112113      EXIT.
< 112113
1084d1225
< 112113     SET TS-INDX TO 1.
1093,1094d1233
< 112113     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
< 112113     SET TS-INDX UP BY 1.
1118d1256
< 112113
1120d1257
<            .
1164,1165c1301
<                                                                         
<            EJECT                                                        
---
> 

</pre>
</body></html>