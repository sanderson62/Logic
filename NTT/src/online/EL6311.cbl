      *((program: EL6311.cl2))
000001 ID DIVISION.
000002
000003 PROGRAM-ID. EL6311.
000004*              PROGRAM CONVERTED BY
000005*              COBOL CONVERSION AID PO 5785-ABJ
000006*              CONVERSION DATE 04/20/94 16:50:32.
000007*                            VMOD=2.089.
000008*
000009*AUTHOR.     LOGIC,INC.
000010*            DALLAS, TEXAS.
000011
000012*DATE-COMPILED.
000013
000014*SECURITY.   *****************************************************
000015*            *                                                   *
000016*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
000017*            *                                                   *
000018*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
000019*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
000020*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
000021*            *                                                   *
000022*            *****************************************************
000023
000024*REMARKS.
000025*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
000026*                             ISSUES, CANCELS, AND BATCH HEADERS
000027******************************************************************
000028*                   C H A N G E   L O G
000029*
000030* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000031*-----------------------------------------------------------------
000032*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000033* EFFECTIVE    NUMBER
000034*-----------------------------------------------------------------
000035* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
000036* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
000037* 011904                   PEMA  ADD TOTAL FEE PROCESSING
000038* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
000039* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
000040* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
000041* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
000042* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
000043* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
000044* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
000045* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
000046* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
000047* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
000048* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
000049* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
000050* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
000051* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
000052* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
000053* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
000054* 010412  CR2011022800001  AJRA  NAPERSOFT
000055* 032612  CR2011110200001  PEMA  AHL CHANGES
000056* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
000057* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
000058* 091112  IR2012091100002  AJRA  FIX AKA
000059* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
000060* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
000061* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
000062* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
000063* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
000064* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
000065* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
000066* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
000067* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
000068* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
000069* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
000070* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
000071* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
000072* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
000073* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
000074* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
000075* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
000076* 091615  CR2015082000001  PEMA  add endorsement check processing
000077* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
000078* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
000079* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
000080* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
000081* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
000082* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
000083* 052918  CR2018040600002  PEMA  ADD REFUND DIRECT INDICATOR
000084* 021519  CR2019021100001  PEMA  non-monthly al calcs
000085* 012220  CR2018092700002  TANA  Add letter reqd field
000086* 012820  CR2020012800001  PEMA  Addd minimum term edit for extd t
000087* 031620  CR2019092700001  PEMA  Remove post card indicator
000088* 041320  CR2020040200001  PEMA  PENDING BUSINESS JOURNALING
000089* 041320  CR2020030500002  PEMA  Issue, cancel billing notes
000090* 052020  CR2019111300001  PEMA  Include all files in "K" trans
000091* 072120  CR2020072100002  PEMA  Allow deletion of dup pend iss re
000092* 102020 IR2020101300001   PEMA  Correct billing notes
000093* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
000094* 110921  CR2021051200001  PEMA  Onbase Workflow project
000095* 063022  CR2019012500003  PEMA  Migrate DB's to SQLSERVER 2016
000096* 070622  CR2020061200002  TANA  Add cancel reason logic
000097* 080522  CR2019120300001  PEMA  Prevent zero UE Commission.
000098******************************************************************
000099
000100 ENVIRONMENT DIVISION.
000101
000102     EJECT
000103 DATA DIVISION.
000104 WORKING-STORAGE SECTION.
       01  DFH-START PIC X(04).
000105 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
000106 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
000107 77  FILLER  PIC X(32)  VALUE '********************************'.
000108 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
000109 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
000110 77  A1                          PIC S999 COMP-3 VALUE +0.
000111 77  N1                          PIC S999 COMP-3 VALUE +0.
000112 77  N2                          PIC S999 COMP-3 VALUE +0.
000113 77  N3                          PIC S999 COMP-3 VALUE +0.
000114 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
000115 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
000116 77  WS-REVERSE-SW               PIC X VALUE 'N'.
000117     88  REVERSAL                    VALUE 'Y'.
000118 77  WS-NOTE-SW                  PIC X  VALUE ' '.
000119 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
000120 77  WS-END                      PIC S999 COMP-3 VALUE +0.
000121 77  WS-TALLY                    PIC 99  VALUE ZEROS.
000122 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
000123     88  ERMAIL-FOUND                 VALUE 'Y'.
000124 77  A2                          PIC S9(5) COMP-3 VALUE +0.
000125 77  M1                          PIC S9(5) COMP-3 VALUE +0.
000126 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
000127 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
000128     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
000129 77  ws-stop-sw                  pic x value ' '.
000130     88  i-say-stop                 value 'Y'.
000131 77  ws-check-sw                 pic x value ' '.
000132     88  i-have-checks              value 'Y'.
000133 77  ws-proc-check-sw            pic x value ' '.
000134     88  i-have-processed-checks    value 'Y'.
000135 77  ws-any-check-sw             pic x value ' '.
000136     88  i-have-a-check-period      value 'Y'.
000137 77  ws-chek-browse-sw           pic x value ' '.
000138 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
000139 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
000140 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
000141 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
000142 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
000143 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
000144 77  ws-elcrtt-update-sw         pic x value ' '.
000145     88  update-elcrtt              value 'Y'.
000146* EXEC SQL
000147*   INCLUDE SQLDA
000148*END-EXEC
000149
000152*EXEC SQL
      *   INCLUDE SQLCA
      *END-EXEC
      *>>((file: SQLCA))
000001****************************************************************<*
000002* Copyright (c) 2016-2021 NTT DATA, Inc. All rights reserved.  *<*
000003* Users of NTT DATA Enterprise COBOL may freely                *<*
000004* redistribute this copybook.                                  *<*
000005****************************************************************<*
000006
000007 01  SQLCA GLOBAL.
000008     05  SQLCAID                PIC X(8).
000009     05  SQLCABC                PIC S9(9) COMP-5.
000010     05  SQLCODE                PIC S9(9) COMP-5.
000011     05  SQLERRM.
000012         49  SQLERRML           PIC S9(4) COMP-5.
000013         49  SQLERRMC           PIC X(254).
000014     05  SQLERRP                PIC X(8).
000015     05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP-5.
000016     05  SQLWARN.
000017         10 SQLWARN0            PIC X(1).
000018         10 SQLWARN1            PIC X(1).
000019         10 SQLWARN2            PIC X(1).
000020         10 SQLWARN3            PIC X(1).
000021         10 SQLWARN4            PIC X(1).
000022         10 SQLWARN5            PIC X(1).
000023         10 SQLWARN6            PIC X(1).
000024         10 SQLWARN7            PIC X(1).
000025     05  SQLSTATE               PIC X(5).
000026     05  SQLEXT                 PIC S9(5) COMP-3 VALUE 1.
      *<<((file: SQLCA))
000153
000155 EXEC SQL
          BEGIN DECLARE SECTION
000156 END-EXEC
000157
000158 01  SQLCMD                      PIC X(1024).
000159 01  SVR                         PIC X(32).
000160 01  USR                         PIC X(32).
000161 01  PASS                        PIC X(32).
000162 01  USR-PASS                    PIC X(64).
000163
000164 01  WS-SQL-DATA.
000165     05  WS-CYCLE-DATE           PIC X(10).
000166     05  WS-NEXT-BUS-DT          PIC X(10).
000167     05  WS-LOOKUPID             PIC X(4).
000168     05  WS-LOOKUPNAME           PIC X(4).
000169     05  WS-LOOKUP-VALUE         PIC X(100).
000170     05  WS-CARRIER              PIC X.
000171     05  WS-GROUP                PIC X(6).
000172     05  WS-STATE                PIC XX.
000173     05  WS-ACCOUNT              PIC X(10).
000174     05  WS-EFF-DT               PIC XX.
000175     05  WS-CERT-NO              PIC X(10).
000176     05  WS-CERT-NO-SUF          PIC X(01).
000177
000179 EXEC SQL
          END DECLARE SECTION
000180 END-EXEC
000181
000182 01  P pointer.
000183 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
000184 01  KIXHOST                     pic x(9) value Z"HOSTNAME".
000185 01  var-ptr pointer.
000186 01  env-var-len                 pic 9(4)  binary.
000187 01  rc                          pic 9(9)  binary.
000188
000189 01  WS-KIXSYS.
000190     05  WS-KIX-FIL1             PIC X(10).
000191     05  WS-KIX-APPS             PIC X(10).
000192     05  WS-KIX-ENV              PIC X(10).
000193     05  WS-KIX-MYENV            PIC X(10).
000194     05  WS-KIX-SYS              PIC X(10).
000195 01  WS-KIXHOST                  PIC X(10).
000196
000197*    COPY ELCSCTM.
      *>>((file: ELCSCTM))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCSCTM                             *
000005*                            VMOD=2.001                          *
000006*                                                                *
000007*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
000008*                                                                *
000009******************************************************************
000010 01  SECURITY-MESSAGE.
000011     12  FILLER                          PIC X(30)
000012            VALUE '** LOGIC SECURITY VIOLATION -'.
000013     12  SM-READ                         PIC X(6).
000014     12  FILLER                          PIC X(5)
000015            VALUE ' PGM='.
000016     12  SM-PGM                          PIC X(6).
000017     12  FILLER                          PIC X(5)
000018            VALUE ' OPR='.
000019     12  SM-PROCESSOR-ID                 PIC X(4).
000020     12  FILLER                          PIC X(6)
000021            VALUE ' TERM='.
000022     12  SM-TERMID                       PIC X(4).
000023     12  FILLER                          PIC XX   VALUE SPACE.
000024     12  SM-JUL-DATE                     PIC 9(5).
000025     12  FILLER                          PIC X    VALUE SPACE.
000026     12  SM-TIME                         PIC 99.99.
000027
      *<<((file: ELCSCTM))
000198
000199*    COPY ELCSCRTY.
      *>>((file: ELCSCRTY))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCSCRTY                            *
000005*                            VMOD=2.001                          *
000006*                                                                *
000007*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
000008*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
000009*        SAVED IN PI-SECURITY-ADDRESS.                           *
000010*                                                                *
000011******************************************************************
000012 01  SECURITY-CONTROL.
000013     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
000014     12  FILLER                       PIC XX    VALUE 'SC'.
000015     12  SC-CREDIT-CODES.
000016         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
000017             20  SC-CREDIT-DISPLAY    PIC X.
000018             20  SC-CREDIT-UPDATE     PIC X.
000019     12  SC-CLAIMS-CODES.
000020         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
000021             20  SC-CLAIMS-DISPLAY    PIC X.
000022             20  SC-CLAIMS-UPDATE     PIC X.
      *<<((file: ELCSCRTY))
000200
000201 01  WS-VA-NO-COMM-MESS.
000202     12  FILLER                  PIC X(41) VALUE
000203        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
000204 01  WS-OC-MESSAGE.
000205     12  FILLER                  PIC X(43) VALUE
000206        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
000207     12  WS-OC-DIS-AMT           PIC -----9.99.
000208     12  FILLER                  PIC X(4) VALUE ' ON '.
000209     12  WS-OC-DATE              PIC X(10).
000210 01  WS-DATE-AREA.
000211     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
000212     12  WS-CURRENT-DT.
000213         16  FILLER              PIC X(6)    VALUE SPACES.
000214         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
000215     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
000216     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
000217     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
000218
000219 01  STANDARD-AREAS.
000220     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
000221     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
000222     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
000223     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
000224     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
000225     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
000226     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
000227     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
000228     12  PGM-NAME                PIC X(8).
000229     12  TIME-IN                 PIC S9(7).
000230     12  TIME-OUT-R  REDEFINES TIME-IN.
000231         16  FILLER              PIC X.
000232         16  TIME-OUT            PIC 99V99.
000233         16  FILLER              PIC XX.
000234     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
000235     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
000236     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
000237     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
000238     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
000239     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
000240     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
000241     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
000242     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
000243     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
000244     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
000245     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
000246     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
000247     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
000248     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
000249     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
000250     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
000251     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
000252     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
000253     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
000254     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
000255     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
000256     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
000257     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
000258     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
000259     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
000260     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
000261     12  FILE-ID                 PIC X(8).
000262     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
000263     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
000264     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
000265     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
000266     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
000267     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
000268     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
000269     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
000270     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
000271     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
000272     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
000273     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
000274     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
000275     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
000276     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
000277
000278 01  WS-PASS-AREA.
000279     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
000280     05  WS-PASS-VADS-REC    PIC X(350).
000281
000282
000283*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
000284*                                COPY ELCZREC.
      *>>((file: ELCZREC))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCZREC.                            *
000005*                                                                *
000006*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
000007*                                                                *
000008******************************************************************
000009*-----------------------------------------------------------------
000010*                   C H A N G E   L O G
000011*
000012* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000013*-----------------------------------------------------------------
000014*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000015* EFFECTIVE    NUMBER
000016*-----------------------------------------------------------------
000017* 122011    2011022800001  AJRA  NEW FILE
000018* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
000019* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
000020* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
000021* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
000022*-----------------------------------------------------------------
000023 01  W-Z-CONTROL-DATA.
000024     05  W-NUMBER-OF-COPIES      PIC  9.
000025     05  FILLER                  PIC  X.
000026     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
000027     05  FILLER                  PIC  X.
000028     05  W-DAYS-TO-RESEND        PIC  999.
000029     05  FILLER                  PIC  X.
000030     05  W-FORM-TO-RESEND        PIC  X(4).
000031     05  W-ADD-BAR-CODE          PIC  X.
000032     05  W-PROMPT-LETTER         PIC  X.
000033     05  W-HAS-RETURN-ENV        PIC  X.
000034     05  W-ENCLOSURE-CD          PIC  XXX.
000035     05  W-SIG-FLAG-DEFAULT      PIC  X.
000036     05  W-AUTO-CLOSE-IND        PIC  X.
000037     05  FILLER                  PIC  X.
000038     05  W-LETTER-TO-BENE        PIC  X.
000039     05  FILLER                  PIC  X.
000040     05  W-LETTER-TO-ACCT        PIC  X.
000041     05  FILLER                  PIC  X.
000042     05  W-LETTER-TYPE           PIC  X.
000043     05  FILLER                  PIC  X.
000044     05  W-PRINT-CERTIFICATE     PIC  X.
000045     05  FILLER                  PIC  X.
000046     05  W-REFUND-REQUIRED       PIC  X.
000047     05  FILLER                  PIC  X.
000048     05  W-ONBASE-CODE           PIC  XX.
000049     05  FILLER                  PIC  X.
000050     05  W-ACCT-SUMM             PIC  X.
000051     05  FILLER                  PIC  X.
000052     05  W-CSO-SUMM              PIC  X.
000053     05  FILLER                  PIC  X.
000054     05  W-REASONS-REQUIRED      PIC  X.
000055     05  FILLER                  PIC  X(29).
      *<<((file: ELCZREC))
000285
000286******************************************************************
000287*                                                                *
000288*              A C C E S S   K E Y S                             *
000289*                                                                *
000290******************************************************************
000291
000292 01  ACCESS-KEYS.
000293     12  ERPYAJ-KEY.
000294         16  ERPYAJ-COMPANY-CD       PIC X.
000295         16  ERPYAJ-CARRIER          PIC X.
000296         16  ERPYAJ-GROUPING         PIC X(6).
000297         16  ERPYAJ-FIN-RESP         PIC X(10).
000298         16  ERPYAJ-ACCOUNT          PIC X(10).
000299         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
000300         16  ERPYAJ-TYPE             PIC X.
000301     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
000302
000303     12  ELCERT-KEY.
000304         16  ELCERT-COMPANY-CD       PIC X.
000305         16  ELCERT-CARRIER          PIC X.
000306         16  ELCERT-GROUPING         PIC X(6).
000307         16  ELCERT-STATE            PIC XX.
000308         16  ELCERT-ACCOUNT          PIC X(10).
000309         16  ELCERT-CERT-EFF-DT      PIC XX.
000310         16  ELCERT-CERT-NO.
000311             20  ELCERT-CERT-PRIME   PIC X(10).
000312             20  ELCERT-CERT-SFX     PIC X.
000313
000314     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
000315     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
000316
000317     12  ELCRTO-KEY.
000318         16  ELCRTO-COMPANY-CD       PIC X.
000319         16  ELCRTO-CARRIER          PIC X.
000320         16  ELCRTO-GROUPING         PIC X(6).
000321         16  ELCRTO-STATE            PIC XX.
000322         16  ELCRTO-ACCOUNT          PIC X(10).
000323         16  ELCRTO-CERT-EFF-DT      PIC XX.
000324         16  ELCRTO-CERT-NO.
000325             20  ELCRTO-CERT-PRIME   PIC X(10).
000326             20  ELCRTO-CERT-SFX     PIC X.
000327         16  ELCRTO-RECORD-TYPE      PIC X.
000328         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
000329
000330     12  ELCRTT-KEY.
000331         16  ELCRTT-PRIMARY          PIC X(33).
000332         16  ELCRTT-REC-TYPE         PIC X(1).
000333     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
000334     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
000335
000336
000337     12  ERPNDB-KEY.
000338         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
000339         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
000340         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
000341         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
000342             ERPNDB-BATCH-SEQ-NO     PIC XX.
000343         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
000344
000345     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
000346     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
000347
000348     12  ERCHEK-KEY.
000349         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
000350         16  CHEK-CARRIER            PIC X       VALUE SPACE.
000351         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
000352         16  CHEK-STATE              PIC XX      VALUE SPACES.
000353         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
000354         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
000355         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
000356         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
000357         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
000358
000359     12  ELLETR-KEY.
000360         16  LETR-COMPANY-CD     PIC X.
000361         16  LETR-LETTER-ID      PIC X(4).
000362         16  LETR-FILLER         PIC X(8).
000363         16  LETR-SEQ-NO         PIC 9(4) BINARY.
000364
000365     12  ERPNDM-KEY.
000366         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
000367         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
000368         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
000369         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
000370
000371*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
000372     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
000373*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
000374     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
000375
000376     12  ERPNDB-ALT-KEY.
000377         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
000378         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
000379         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
000380         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
000381         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
000382         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
000383         16  ERPNDB-CERT-NO.
000384             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
000385             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
000386         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
000387         16  ERPNDB-RECORD-TYPE      PIC X.
000388
000389      12  ERPNDB-CSR-KEY.
000390          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
000391          20  ERPNDB-CSR-ID                PIC X(4).
000392          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
000393          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
000394          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
000395
000396     12  ERNOTE-KEY.
000397         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
000398         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
000399         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
000400         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
000401         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
000402         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
000403         16  ERNOTE-CERT-NO.
000404             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
000405             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
000406         16  ernote-record-type      pic x        value spaces.
000407
000408     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
000409     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
000410
000411     12  ERCNOT-KEY.
000412         16  ERCNOT-PART-KEY.
000413             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
000414             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
000415             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
000416             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
000417             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
000418             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
000419             20  ERCNOT-CERT-NO.
000420                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
000421                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
000422         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
000423         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
000424
000425     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
000426     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
000427
000428     12  ERMAIL-KEY.
000429         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
000430         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
000431         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
000432         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
000433         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
000434         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
000435         16  ERMAIL-CERT-NO.
000436             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
000437             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
000438
000439     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
000440     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
000441
000442     12  ERRQST-KEY.
000443         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
000444         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
000445
000446     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
000447     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
000448
000449     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
000450
000451     12  ERLOFC-KEY.
000452         16  ERLOFC-COMPANY-CD          PIC  X.
000453         16  ERLOFC-CARRIER             PIC  X.
000454         16  ERLOFC-GROUPING            PIC  X(6).
000455         16  ERLOFC-STATE               PIC  XX.
000456         16  ERLOFC-ACCOUNT             PIC  X(10).
000457         16  ERLOFC-OFFICER-CODE        PIC  X(5).
000458*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
000459
000460     12  ERACCT-KEY.
000461         16  ERACCT-COMPANY-CD          PIC  X.
000462         16  ERACCT-CARRIER             PIC  X.
000463         16  ERACCT-GROUPING            PIC  X(6).
000464         16  ERACCT-STATE               PIC  XX.
000465         16  ERACCT-ACCOUNT             PIC  X(10).
000466         16  ERACCT-EXP-DT.
000467             20  ERACCT-DT              PIC  XX.
000468             20  ERACCT-FILL            PIC  X(4).
000469
000470     12  ERACNT-KEY.
000471         16  ERACNT-COMPANY-CD          PIC  X.
000472         16  ERACNT-CARRIER             PIC  X.
000473         16  ERACNT-GROUPING            PIC  X(6).
000474         16  ERACNT-STATE               PIC  XX.
000475         16  ERACNT-ACCOUNT             PIC  X(10).
000476         16  ERACNT-REC-TYPE            PIC  X.
000477         16  ERACNT-SEQ-NO              PIC  S9(4) COMP.
000478
000479     12  ERENDT-KEY.
000480         16  ENDT-COMPANY-CD       PIC X.
000481         16  ENDT-CARRIER          PIC X.
000482         16  ENDT-GROUPING         PIC X(6).
000483         16  ENDT-STATE            PIC XX.
000484         16  ENDT-ACCOUNT          PIC X(10).
000485         16  ENDT-CERT-EFF-DT      PIC XX.
000486         16  ENDT-CERT-PRIME       PIC X(10).
000487         16  ENDT-CERT-SFX         PIC X.
000488         16  ENDT-RECORD-TYPE      PIC X.
000489         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
000490
000491 01  WS-ELMSTR-WORK.
000492     12  ELMSTR-KEY.
000493         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
000494         16  MSTR-CERT-NO.
000495             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
000496             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
000497     12  W-CLAIM-KEY.
000498         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
000499         16  W-CL-CERT-NO.
000500             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
000501             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
000502      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
000503
000504 01  EL055-PASS-AREA.
000505     05  PA-CURRENT-KEY          PIC X(11).
000506     05  PA-NEW-ALT-KEY          PIC X(36).
000507     05  PA-RETURN-AREA.
000508         10  ra-status-code      pic 9(4).
000509         10  ra-message          pic x(205).
000510
000511 01  CANCEL-GEN-PASS-AREA.
000512     05  CG-OPTION-CODE          PIC X.
000513         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
000514         88  CG-FLAT-CANCEL        VALUE '1'.
000515         88  CG-CANCEL             VALUE '2'.
000516         88  CG-CANCEL-REISSUE     VALUE '3'.
000517     05  CG-ERROR-CODE           PIC 99.
000518         88  CG-SUCCESS            VALUE 00.
000519         88  CG-DATE-ERROR         VALUE 01.
000520         88  CG-CERT-NOT-FOUND     VALUE 02.
000521         88  CG-AMOUNT-ERROR       VALUE 04.
000522         88  CG-OPTION-ERROR       VALUE 05.
000523         88  CG-PREV-CAN           VALUE 06.
000524         88  CG-INVALID-DATA       VALUE 07.
000525         88  CG-NO-ACCT-MSTR       VALUE 08.
000526         88  CG-SFX-A-EXIST        VALUE 09.
000527         88  CG-MISC-ERROR         VALUE 99.
000528     05  CG-COMPANY-ID           PIC XXX.
000529     05  CG-PROC-ID              PIC XXXX.
000530     05  CG-CURRENT-DT           PIC XX.
000531     05  CG-MONTH-END-DT         PIC XX.
000532     05  CG-CERT-KEY.
000533         10  CG-CERT-COMPANY-CD  PIC X.
000534         10  CG-CERT-CARRIER     PIC X.
000535         10  CG-CERT-GROUP       PIC X(6).
000536         10  CG-CERT-STATE       PIC XX.
000537         10  CG-CERT-ACCOUNT     PIC X(10).
000538         10  CG-CERT-EFF-DT      PIC XX.
000539         10  CG-CERT-CERT-NO     PIC X(11).
000540     05  CG-LF-CAN-DATA.
000541         10  CG-LF-CAN-DT        PIC XX.
000542         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
000543     05  CG-AH-CAN-DATA.
000544         10  CG-AH-CAN-DT        PIC XX.
000545         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
000546     05  CG-CERT-PROFILE-DATA.
000547         10  CG-INS-LNAME        PIC X(15).
000548         10  CG-INS-FNAME        PIC X(10).
000549         10  CG-INS-MID-INIT     PIC X.
000550         10  CG-INS-AGE          PIC 99.
000551         10  CG-JNT-LNAME        PIC X(15).
000552         10  CG-JNT-FNAME        PIC X(10).
000553         10  CG-JNT-MID-INIT     PIC X.
000554         10  CG-JNT-AGE          PIC 99.
000555     05  CG-LF-ISS-DATA.
000556         10  CG-LF-BENCD         PIC XX.
000557         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
000558         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
000559     05  CG-AH-ISS-DATA.
000560         10  CG-AH-BENCD         PIC XX.
000561         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
000562     05  CG-BATCH-NO             PIC X(6).
000563     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
000564     05  FILLER                  PIC X(306).
000565
000566
000567
000568******************************************************************
000569*                                                                *
000570*            G E N E R A L   W O R K   A R E A                   *
000571*                                                                *
000572******************************************************************
000573
000574 01  WORK-AREA.
000575     12  WS-RESPONSE             PIC S9(8)   COMP.
000576         88  RESP-NORMAL           VALUE +0.
000577         88  resp-file-notfnd      value +12.
000578         88  RESP-NOTFND           VALUE +13.
000579         88  resp-duprec           value +14.
000580         88  resp-dupkey           value +15.
000581         88  resp-invreq           value +16.
000582         88  RESP-NOTOPEN          VALUE +19.
000583         88  RESP-ENDFILE          VALUE +20.
000584         88  resp-lengtherr        value +22.
000585
000586     12  DEEDIT-FIELD            PIC X(15).
000587     12  FILLER          REDEFINES DEEDIT-FIELD.
000588         16  FILLER              PIC X(4).
000589         16  DEEDIT-FIELD-X11    PIC X(11).
000590     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
000591                                 PIC S9(15).
000592     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
000593                                 PIC S9(13)V99.
000594     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
000595                                 PIC S9(11)V9999.
000596     12  W-ONE                   PIC S9(4) COMP VALUE +1.
000597     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
000598     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
000599         16  WS-CALC-TERM-WHOLE  PIC S999.
000600         16  WS-CALC-TERM-REMAIN PIC SV9(5).
000601
000602     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
000603     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
000604         16  WS-HR-MINS          PIC 99V99.
000605         16  FILLER              PIC XX.
000606
000607     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
000608     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
000609
000610     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
000611     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
000612
000613     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
000614     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
000615     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
000616     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
000617     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
000618     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
000619     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
000620
000621     12  QID.
000622         16  QID-TERM            PIC X(4).
000623         16  FILLER              PIC X(4)    VALUE '607B'.
000624
000625     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
000626         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
000627
000628     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
000629         88  LOAN-OFFICER-FOUND      VALUE SPACE.
000630
000631     12  WS-MODE-CODE            PIC X     VALUE SPACE.
000632         88 WS-MODE-CODE-VALID     VALUE ' '
000633                                         'W'     *> Weekly
000634                                         'B'     *> Bi-weekly
000635                                         'S'     *> Semi-monthly
000636                                         'M'     *> Monthly (Def)
000637                                         'Q'     *> Quarterly
000638                                         'N'     *> Bi-Monthly??
000639                                         'T'     *> Semi-annual
000640                                         'A'. *> Annual Pay
000641
000642     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
000643
000644     12  WS-NUMERIC-SW           PIC X.
000645        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
000646
000647     12  WS-EDIT-CSO-FIELD.
000648         16  WS-EDIT-BYTE  OCCURS 9 TIMES
000649                                 PIC X.
000650     12  WS-SAVE-PEND-ISSUE          PIC X(375).
000651     12  WS-ARCHIVE-LETTER-SW    PIC X    VALUE 'N'.
000652        88  ARCHIVE-LETTER-RELEASED   VALUE 'Y'.
000653        88  CALLED-FROM-6315          VALUE '5'.
000654
000655     12  WS-SAVE-INPUT-FIELDS.
000656         16  WS-BAGE             PIC 99       VALUE ZERO.
000657*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
000658
000659         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
000660         16  FILLER REDEFINES WS-BAPR.
000661             20  WS-APR-WHOLE-NUM    PIC 99.
000662             20  WS-APR-DEC          PIC 9999.
000663
000664
000665         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
000666         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
000667
000668         16  WS-B-COVERAGE OCCURS 2 TIMES.
000669             20  WS-TERM-IN-DAYS-SW  PIC X.
000670                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
000671             20  WS-BTERM        PIC 999       COMP-3.
000672             20  WS-BALT-TERM    PIC 999       COMP-3.
000673             20  WS-BCRIT-PERD   PIC 99        COMP-3.
000674             20  WS-BBEN         PIC S9(10)V99 COMP-3.
000675             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
000676             20  WS-BPREM        PIC S9(7)V99  COMP-3.
000677             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
000678             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
000679
000680         16  WS-C-FIELDS COMP-3.
000681             20  WS-CLIVES       PIC S9(3)     VALUE +0.
000682             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
000683             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
000684
000685         16  WS-D-FIELDS COMP-3.
000686             20  WS-DRISS        PIC S9(5)    VALUE +0.
000687             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
000688             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
000689             20  WS-DRCANC       PIC S9(5)    VALUE +0.
000690             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
000691             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
000692
000693     12  WS-SAVE-BIRTH-DATE.
000694         16  FILLER              PIC X(4)   VALUE SPACES.
000695         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
000696
000697     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
000698     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
000699     12  FILLER REDEFINES WS-WORK-BIN-RED.
000700         16  FILLER              PIC X(02).
000701         16  WS-WORK-BIN-DT      PIC X(02).
000702     12  WS-SW-1                 PIC X     VALUE SPACE.
000703     12  WS-SW-2                 PIC X     VALUE SPACE.
000704     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
000705         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
000706     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
000707         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
000708
000709     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
000710     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
000711     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
000712     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
000713     12  WS-CONVERTED-CANCEL-DATES.
000714         16  WS-CONVERTED-CANDT1                  PIC XX.
000715         16  WS-CONVERTED-CANDT2                  PIC XX.
000716
000717     12  WS-EXP-DT-EDIT          PIC 99B99B99.
000718
000719     12  WS-REC-FOUND-SW         PIC X.
000720         88  RECORD-NOT-FOUND    VALUE 'N'.
000721
000722     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
000723         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
000724         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
000725
000726     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
000727         88  WS-ERRORS-PRESENT             VALUE 'Y'.
000728         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
000729
000730     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
000731         88  BROWSE-STARTED      VALUE 'Y'.
000732
000733     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
000734         88  FIRST-TIME          VALUE 'Y'.
000735
000736     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
000737         88  FIRST-ENTRY         VALUE 'Y'.
000738
000739     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
000740         88  REC-BILLED          VALUE 'Y'.
000741
000742     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
000743         88  NO-CURSOR-SET       VALUE +0.
000744         88  CURSOR-SET          VALUE +1.
000745
000746     12  WS-ERR-SW               PIC X.
000747         88  STD-ERRORS          VALUE 'S'.
000748         88  TRN-ERRORS          VALUE 'T'.
000749
000750     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
000751         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
000752
000753     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
000754         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
000755
000756     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
000757         88 CREATE-CANCEL-LETTER VALUE 'Y'.
000758
000759     12  WS-ERR-CODE.
000760         16  FILLER              PIC 99.
000761         16  WS-ERROR-SUB        PIC 99.
000762
000763     12  WS-DATE-WORK.
000764         16  WS-WORK-MM          PIC XX.
000765         16  WS-WORK-DD          PIC XX.
000766         16  WS-WORK-YY          PIC XX.
000767
000768     12  WS-MM-YY.
000769         16  WS-MM               PIC XX.
000770         16  FILLER              PIC X     VALUE '/'.
000771         16  WS-YY               PIC XX.
000772
000773     12  WS-CERT-EFF-DT          PIC XX.
000774
000775     12  WS-MEMBER-NO            PIC X(12).
000776     12  FILLER  REDEFINES  WS-MEMBER-NO.
000777         16  WS-MEMBER-NO-1-8    PIC 9(8).
000778         16  FILLER              PIC X(4).
000779
000780     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
000781
000782     12  WS-ERPNDB-ALT-KEY.
000783         16  WS-PB-COMPANY-CD-A1         PIC X.
000784         16  WS-PB-CARRIER               PIC X.
000785         16  WS-PB-GROUPING              PIC X(6).
000786         16  WS-PB-STATE                 PIC XX.
000787         16  WS-PB-ACCOUNT               PIC X(10).
000788         16  WS-PB-CERT-EFF-DT           PIC XX.
000789         16  WS-PB-CERT-NO.
000790             20  WS-PB-CERT-PRIME        PIC X(10).
000791             20  WS-PB-CERT-SFX          PIC X.
000792         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
000793         16  WS-PB-RECORD-TYPE           PIC X.
000794
000795     12  WS-SHOW-SAVE-AREAS.
000796         16  WS-NEW-CERT-NO.
000797             20  WS-NEW-PRIME    PIC X(10).
000798             20  WS-NEW-SUFFIX   PIC X.
000799         16  WS-NEW-CERT-EFF-DT  PIC XX.
000800         16  WS-NEW-RECORD-TYPE  PIC X.
000801         16  WS-SHOW-SW          PIC X   VALUE 'N'.
000802             88   SHOW-RECORD            VALUE 'Y'.
000803
000804     12  WS-SEQ-SAVE             PIC S9(4) COMP.
000805
000806     12  WS-BATCH-NO.
000807         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
000808         16  FILLER              PIC X(5) VALUE SPACES.
000809
000810     12  WS-FIRST-NAME.
000811         16  WS-1ST-INIT         PIC X.
000812         16  FILLER              PIC X(9).
000813
000814     12  WS-INITIALS.
000815         16  WS-INITIAL-1        PIC X.
000816         16  WS-INITIAL-2        PIC X.
000817
000818     12  WS-C-HDG.
000819         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
000820         16  FILLER              PIC X(4) VALUE '-REF'.
000821
000822     12  WS-D-PREM-HDG.
000823         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
000824         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
000825
000826     12  WS-D-REFUND-HDG.
000827         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
000828         16  FILLER                  PIC X(7) VALUE '-REFUND'.
000829
000830     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
000831
000832     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
000833     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
000834     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
000835     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
000836     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
000837     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
000838     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
000839
000840     12  WS-01-CANCEL-ERR        PIC X(25)
000841         VALUE 'CANCEL DATE ERROR'.
000842     12  WS-02-CANCEL-ERR        PIC X(25)
000843         VALUE 'CERT NOT FOUND'.
000844     12  WS-04-CANCEL-ERR        PIC X(25)
000845         VALUE 'CANCEL AMOUNT ERROR'.
000846     12  WS-05-CANCEL-ERR        PIC X(25)
000847         VALUE 'CANCEL OPTION ERROR'.
000848     12  WS-06-CANCEL-ERR        PIC X(25)
000849         VALUE 'PREVIOUSLY CANCELLED'.
000850     12  WS-07-CANCEL-ERR        PIC X(25)
000851         VALUE 'INVALID DATA'.
000852     12  WS-08-CANCEL-ERR        PIC X(25)
000853         VALUE 'NO ACCOUNT MASTER'.
000854     12  WS-09-CANCEL-ERR        PIC X(25)
000855         VALUE 'SUFFIX ALREADY EXISTS'.
000856     12  WS-99-CANCEL-ERR        PIC X(25)
000857         VALUE 'MISC CANCEL ERROR'.
000858
000859     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
000860     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
000861
000862     12  WS-AGE-FIELDS.
000863         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
000864         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
000865         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
000866         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
000867
000868
000869     EJECT
000870
000871******************************************************************
000872*                                                                *
000873*                 B A T C H   T O T A L S                        *
000874*                                                                *
000875******************************************************************
000876
000877     12  WS-BATCH-RECORD.
000878         16  FILLER                       PIC X(10).
000879         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
000880         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
000881         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
000882         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
000883         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
000884         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
000885         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
000886         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
000887         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
000888         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
000889         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
000890         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
000891         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
000892         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
000893         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
000894         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
000895         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
000896         16  WS-ACCOUNT-NAME              PIC X(30).
000897         16  FILLER                       PIC X.
000898         16  WS-REFERENCE                 PIC X(12).
000899         16  FILLER                       PIC X(197).
000900
000901     12  WS-BATCH-TOTALS.
000902         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
000903         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
000904         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
000905         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
000906         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
000907         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
000908         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
000909         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
000910         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
000911         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
000912         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
000913         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
000914         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
000915         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
000916         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
000917         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
000918         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
000919         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
000920         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
000921
000922     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
000923
000924 01  work-flow-pass-area.
000925     05  pa-rec-type             pic x(4).
000926     05  pa-company-id           pic xxx.
000927     05  pa-rest-of-record       pic x(600).
000928
000929******************************************************************
000930*                                                                *
000931*                E R R O R   M E S S A G E S                     *
000932*                                                                *
000933******************************************************************
000934
000935 01  ERROR-MESSAGES.
000936     12  ER-0004                 PIC  9(4) VALUE 0004.
000937     12  ER-0008                 PIC  9(4) VALUE 0008.
000938     12  ER-0023                 PIC  9(4) VALUE 0023.
000939     12  ER-0029                 PIC  9(4) VALUE 0029.
000940     12  ER-0033                 PIC  9(4) VALUE 0033.
000941     12  ER-0070                 PIC  9(4) VALUE 0070.
000942     12  ER-0220                 PIC  9(4) VALUE 0220.
000943     12  er-0229                 pic  9(4) value 0229.
000944     12  ER-0248                 PIC  9(4) VALUE 0248.
000945     12  ER-0280                 PIC  9(4) VALUE 0280.
000946     12  ER-0348                 PIC  9(4) VALUE 0348.
000947     12  ER-0582                 PIC  9(4) VALUE 0582.
000948     12  ER-0877                 PIC  9(4) VALUE 0877.
000949     12  ER-1236                 PIC  9(4) VALUE 1236.
000950     12  ER-1570                 PIC  9(4) VALUE 1570.
000951     12  ER-1575                 PIC  9(4) VALUE 1575.
000952     12  ER-1577                 PIC  9(4) VALUE 1577.
000953     12  ER-1584                 PIC  9(4) VALUE 1584.
000954     12  ER-1585                 PIC  9(4) VALUE 1585.
000955     12  ER-1590                 PIC  9(4) VALUE 1590.
000956     12  ER-1591                 PIC  9(4) VALUE 1591.
000957     12  ER-1609                 PIC  9(4) VALUE 1609.
000958     12  er-1762                 pic  9(4) value 1762.
000959     12  ER-1819                 PIC  9(4) VALUE 1819.
000960     12  ER-2077                 PIC  9(4) VALUE 2077.
000961     12  ER-2129                 PIC  9(4) VALUE 2129.
000962     12  ER-2188                 PIC  9(4) VALUE 2188.
000963     12  ER-2192                 PIC  9(4) VALUE 2192.
000964     12  ER-2196                 PIC  9(4) VALUE 2196.
000965     12  ER-2197                 PIC  9(4) VALUE 2197.
000966     12  ER-2198                 PIC  9(4) VALUE 2198.
000967     12  ER-2200                 PIC  9(4) VALUE 2200.
000968     12  ER-2212                 PIC  9(4) VALUE 2212.
000969     12  ER-2218                 PIC  9(4) VALUE 2218.
000970     12  ER-2220                 PIC  9(4) VALUE 2220.
000971     12  ER-2222                 PIC  9(4) VALUE 2222.
000972     12  ER-2223                 PIC  9(4) VALUE 2223.
000973     12  ER-2224                 PIC  9(4) VALUE 2224.
000974     12  ER-2225                 PIC  9(4) VALUE 2225.
000975     12  ER-2226                 PIC  9(4) VALUE 2226.
000976     12  ER-2227                 PIC  9(4) VALUE 2227.
000977     12  ER-2228                 PIC  9(4) VALUE 2228.
000978     12  ER-2240                 PIC  9(4) VALUE 2240.
000979     12  ER-2241                 PIC  9(4) VALUE 2241.
000980     12  ER-2242                 PIC  9(4) VALUE 2242.
000981     12  ER-2243                 PIC  9(4) VALUE 2243.
000982     12  ER-2244                 PIC  9(4) VALUE 2244.
000983     12  ER-2245                 PIC  9(4) VALUE 2245.
000984     12  ER-2246                 PIC  9(4) VALUE 2246.
000985     12  ER-2247                 PIC  9(4) VALUE 2247.
000986     12  ER-2251                 PIC  9(4) VALUE 2251.
000987     12  ER-2252                 PIC  9(4) VALUE 2252.
000988     12  ER-2253                 PIC  9(4) VALUE 2253.
000989     12  ER-2254                 PIC  9(4) VALUE 2254.
000990     12  ER-2255                 PIC  9(4) VALUE 2255.
000991     12  ER-2256                 PIC  9(4) VALUE 2256.
000992     12  ER-2257                 PIC  9(4) VALUE 2257.
000993     12  ER-2258                 PIC  9(4) VALUE 2258.
000994     12  ER-2259                 PIC  9(4) VALUE 2259.
000995     12  ER-2260                 PIC  9(4) VALUE 2260.
000996     12  ER-2261                 PIC  9(4) VALUE 2261.
000997     12  ER-2287                 PIC  9(4) VALUE 2287.
000998     12  ER-2336                 PIC  9(4) VALUE 2336.
000999     12  ER-2337                 PIC  9(4) VALUE 2337.
001000     12  ER-2437                 PIC  9(4) VALUE 2437.
001001     12  ER-2471                 PIC  9(4) VALUE 2471.
001002     12  ER-2530                 PIC  9(4) VALUE 2530.
001003     12  ER-2531                 PIC  9(4) VALUE 2531.
001004     12  ER-2532                 PIC  9(4) VALUE 2532.
001005     12  ER-2533                 PIC  9(4) VALUE 2533.
001006     12  ER-2547                 PIC  9(4) VALUE 2547.
001007     12  ER-2591                 PIC  9(4) VALUE 2591.
001008     12  ER-2592                 PIC  9(4) VALUE 2592.
001009     12  ER-2593                 PIC  9(4) VALUE 2593.
001010     12  ER-2600                 PIC  9(4) VALUE 2600.
001011     12  ER-2601                 PIC  9(4) VALUE 2601.
001012     12  ER-2604                 PIC  9(4) VALUE 2604.
001013     12  ER-2605                 PIC  9(4) VALUE 2605.
001014     12  ER-2606                 PIC  9(4) VALUE 2606.
001015     12  ER-2607                 PIC  9(4) VALUE 2607.
001016     12  ER-2622                 PIC  9(4) VALUE 2622.
001017     12  ER-2625                 PIC  9(4) VALUE 2625.
001018     12  ER-2626                 PIC  9(4) VALUE 2626.
001019     12  ER-2627                 PIC  9(4) VALUE 2627.
001020     12  ER-2628                 PIC  9(4) VALUE 2628.
001021     12  ER-2629                 PIC  9(4) VALUE 2629.
001022     12  ER-2630                 PIC  9(4) VALUE 2630.
001023     12  ER-2631                 PIC  9(4) VALUE 2631.
001024     12  ER-2632                 PIC  9(4) VALUE 2632.
001025     12  ER-2633                 PIC  9(4) VALUE 2633.
001026     12  ER-2634                 PIC  9(4) VALUE 2634.
001027     12  ER-2635                 PIC  9(4) VALUE 2635.
001028     12  ER-2636                 PIC  9(4) VALUE 2636.
001029     12  ER-2639                 PIC  9(4) VALUE 2639.
001030     12  ER-2640                 PIC  9(4) VALUE 2640.
001031     12  ER-2647                 PIC  9(4) VALUE 2647.
001032     12  ER-2648                 PIC  9(4) VALUE 2648.
001033     12  ER-2649                 PIC  9(4) VALUE 2649.
001034     12  ER-2650                 PIC  9(4) VALUE 2650.
001035     12  ER-2651                 PIC  9(4) VALUE 2651.
001036     12  ER-2653                 PIC  9(4) VALUE 2653.
001037     12  ER-2654                 PIC  9(4) VALUE 2654.
001038     12  ER-2655                 PIC  9(4) VALUE 2655.
001039     12  ER-2656                 PIC  9(4) VALUE 2656.
001040     12  ER-2657                 PIC  9(4) VALUE 2657.
001041     12  ER-2660                 PIC  9(4) VALUE 2660.
001042     12  ER-2661                 PIC  9(4) VALUE 2661.
001043     12  ER-2662                 PIC  9(4) VALUE 2662.
001044     12  ER-2663                 PIC  9(4) VALUE 2663.
001045     12  ER-2664                 PIC  9(4) VALUE 2664.
001046     12  ER-2667                 PIC  9(4) VALUE 2667.
001047     12  ER-2668                 PIC  9(4) VALUE 2668.
001048     12  ER-2669                 PIC  9(4) VALUE 2669.
001049     12  ER-2670                 PIC  9(4) VALUE 2670.
001050     12  ER-2671                 PIC  9(4) VALUE 2671.
001051     12  ER-2672                 PIC  9(4) VALUE 2672.
001052     12  ER-2673                 PIC  9(4) VALUE 2673.
001053     12  ER-2677                 PIC  9(4) VALUE 2677.
001054     12  ER-2678                 PIC  9(4) VALUE 2678.
001055     12  ER-2679                 PIC  9(4) VALUE 2679.
001056     12  ER-2680                 PIC  9(4) VALUE 2680.
001057     12  ER-2681                 PIC  9(4) VALUE 2681.
001058     12  ER-2682                 PIC  9(4) VALUE 2682.
001059     12  ER-2683                 PIC  9(4) VALUE 2683.
001060     12  ER-2684                 PIC  9(4) VALUE 2684.
001061     12  ER-2686                 PIC  9(4) VALUE 2686.
001062     12  ER-2689                 PIC  9(4) VALUE 2689.
001063     12  ER-2690                 PIC  9(4) VALUE 2690.
001064     12  ER-2693                 PIC  9(4) VALUE 2693.
001065     12  ER-2695                 PIC  9(4) VALUE 2695.
001066     12  ER-2701                 PIC  9(4) VALUE 2701.
001067     12  ER-2720                 PIC  9(4) VALUE 2720.
001068     12  ER-2709                 PIC  9(4) VALUE 2709.
001069     12  ER-2704                 PIC  9(4) VALUE 2704.
001070     12  ER-2725                 PIC  9(4) VALUE 2725.
001071     12  ER-2726                 PIC  9(4) VALUE 2726.
001072     12  ER-2728                 PIC  9(4) VALUE 2728.
001073     12  ER-2729                 PIC  9(4) VALUE 2729.
001074     12  ER-2731                 PIC  9(4) VALUE 2731.
001075     12  ER-2732                 PIC  9(4) VALUE 2732.
001076     12  ER-2733                 PIC  9(4) VALUE 2733.
001077     12  ER-2735                 PIC  9(4) VALUE 2735.
001078     12  ER-2738                 PIC  9(4) VALUE 2738.
001079     12  ER-2742                 PIC  9(4) VALUE 2742.
001080     12  ER-2743                 PIC  9(4) VALUE 2743.
001081     12  ER-2744                 PIC  9(4) VALUE 2744.
001082     12  ER-2747                 PIC  9(4) VALUE 2747.
001083     12  ER-2749                 PIC  9(4) VALUE 2749.
001084     12  ER-2753                 PIC  9(4) VALUE 2753.
001085     12  ER-2755                 PIC  9(4) VALUE 2755.
001086     12  ER-2757                 PIC  9(4) VALUE 2757.
001087     12  ER-2771                 PIC  9(4) VALUE 2771.
001088     12  ER-2774                 PIC  9(4) VALUE 2774.
001089     12  ER-2775                 PIC  9(4) VALUE 2775.
001090     12  ER-2776                 PIC  9(4) VALUE 2776.
001091     12  ER-2777                 PIC  9(4) VALUE 2777.
001092     12  ER-2794                 PIC  9(4) VALUE 2794.
001093     12  ER-2799                 PIC  9(4) VALUE 2799.
001094     12  er-2878                 pic  9(4) value 2878.
001095     12  ER-2900                 PIC  9(4) VALUE 2900.
001096     12  ER-2902                 PIC  9(4) VALUE 2902.
001097     12  ER-2945                 PIC  9(4) VALUE 2945.
001098     12  ER-3000                 PIC  9(4) VALUE 3000.
001099     12  ER-3006                 PIC  9(4) VALUE 3006.
001100     12  ER-3054                 PIC  9(4) VALUE 3054.
001101     12  er-3070                 pic  9(4) value 3070.
001102     12  ER-3224                 PIC  9(4) VALUE 3224.
001103     12  ER-3269                 PIC  9(4) VALUE 3269.
001104     12  er-3444                 pic  9(4) value 3444.
001105     12  er-3446                 pic  9(4) value 3446.
001106     12  er-3447                 pic  9(4) value 3447.
001107     12  er-3448                 pic  9(4) value 3448.
001108     12  er-3449                 pic  9(4) value 3449.
001109     12  ER-3456                 PIC  9(4) VALUE 3456.
001110     12  ER-3457                 PIC  9(4) VALUE 3457.
001111     12  ER-3458                 PIC  9(4) VALUE 3458.
001112     12  ER-3504                 PIC  9(4) VALUE 3504.
001113     12  ER-3513                 PIC  9(4) VALUE 3513.
001114     12  ER-3831                 PIC  9(4) VALUE 3831.
001115     12  ER-3834                 PIC  9(4) VALUE 3834.
001116     12  ER-3835                 PIC  9(4) VALUE 3835.
001117     12  ER-4005                 PIC  9(4) VALUE 4005.
001118     12  ER-7144                 PIC  9(4) VALUE 7144.
001119     12  ER-7401                 PIC  9(4) VALUE 7401.
001120     12  ER-7402                 PIC  9(4) VALUE 7402.
001121     12  ER-7403                 PIC  9(4) VALUE 7403.
001122     12  ER-7404                 PIC  9(4) VALUE 7404.
001123     12  ER-7423                 PIC  9(4) VALUE 7423.
001124     12  ER-7424                 PIC  9(4) VALUE 7424.
001125     12  ER-7433                 PIC  9(4) VALUE 7433.
001126     12  ER-7450                 PIC  9(4) VALUE 7450.
001127     12  ER-7451                 PIC  9(4) VALUE 7451.
001128     12  ER-7530                 PIC  9(4) VALUE 7530.
001129     12  ER-7573                 PIC  9(4) VALUE 7573.
001130     12  ER-7631                 PIC  9(4) VALUE 7631.
001131     12  ER-7632                 PIC  9(4) VALUE 7632.
001132     12  ER-7633                 PIC  9(4) VALUE 7633.
001133     12  ER-7537                 PIC  9(4) VALUE 7537.
001134     12  ER-7538                 PIC  9(4) VALUE 7538.
001135     12  ER-7574                 PIC  9(4) VALUE 7574.
001136     12  ER-7997                 PIC  9(4) VALUE 7997.
001137     12  ER-7998                 PIC  9(4) VALUE 7998.
001138     12  ER-8148                 PIC  9(4) VALUE 8148.
001139     12  ER-9063                 PIC  9(4) VALUE 9063.
001140     12  ER-9076                 PIC  9(4) VALUE 9076.
001141     12  ER-9618                 PIC  9(4) VALUE 9618.
001142     12  ER-9841                 PIC  9(4) VALUE 9841.
001143     12  er-9853                 pic  9(4) value 9853.
001144
001145
001146*                                COPY ELCTEXT.
      *>>((file: ELCTEXT))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCTEXT.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.008                          *
000007*                                                                *
000008*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
000009*                                     FORM LETTERS,              *
000010*                                     CERT FORM DISPLAY.
000011*                                                                *
000012*   FILE TYPE = VSAM,KSDS                                        *
000013*   RECORD SIZE = 100   RECFORM = FIXED                          *
000014*                                                                *
000015*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
000016*       ALTERNATE INDEX = NONE                                   *
000017*                                                                *
000018*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
000019*       ALTERNATE INDEX = NONE                                   *
000020*                                                                *
000021*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
000022*       ALTERNATE INDEX = NONE                                   *
000023*                                                                *
000024*   LOG = NO                                                     *
000025*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000026******************************************************************
000027 01  TEXT-FILES.
000028     12  TEXT-FILE-ID                PIC XX.
000029         88  FORMS-FILE-TEXT            VALUE 'TF'.
000030         88  LETTER-FILE-TEXT           VALUE 'TL'.
000031         88  HELP-FILE-TEXT             VALUE 'TH'.
000032
000033     12  TX-CONTROL-PRIMARY.
000034         16  TX-COMPANY-CD           PIC X.
000035             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
000036         16  TX-ACCESS-CD-GENL       PIC X(12).
000037
000038         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
000039             20  TX-LETTER-NO        PIC X(4).
000040             20  FILLER              PIC X(8).
000041
000042         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
000043             20  TX-FORM-NO          PIC X(12).
000044
000045         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
000046             20  TX-HELP-TYPE        PIC X.
000047                 88  HELP-FOR-GENERAL   VALUE ' '.
000048                 88  HELP-BY-SCREEN     VALUE 'S'.
000049                 88  HELP-BY-ERROR      VALUE 'E'.
000050             20  TX-SCREEN-OR-ERROR  PIC X(4).
000051                 88  GENERAL-INFO-HELP  VALUE '0000'.
000052             20  TX-HELP-FOR-COMPANY  PIC XXX.
000053                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
000054             20  FILLER              PIC X(4).
000055
000056         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
000057
000058     12  TX-PROCESS-CONTROL          PIC XX.
000059         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
000060
000061     12  TX-TEXT-LINE                PIC X(70).
000062
000063     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
000064         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
000065         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
000066         88  TX-VALID-FORM-SQUEEZE-VALUE
000067                                        VALUE 'Y' ' '.
000068
000069     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
000070         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
000071         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
000072         88  TX-DO-NOT-ADJUST           VALUE 'N'.
000073         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
000074         88  TX-NEW-PARAGRAPH           VALUE 'P'.
000075         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
000076         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
000077                                              'K' 'N' ' '
000078                                              'Z'.
000079
000080     12  TX-ARCHIVE-SW               PIC X.
000081         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
000082         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
000083         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
000084
000085     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
000086     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
000087
000088     12  TX-BSR-CODE                 PIC X.
000089         88  TX-BSR-LETTER              VALUE 'B'.
000090         88  TX-NON-BSR-LETTER          VALUE ' '.
000091
000092     12  FILLER                      PIC X.
000093*****************************************************************
      *<<((file: ELCTEXT))
001147*                                COPY ELCCRTO.
      *>>((file: ELCCRTO))
000001******************************************************************
000002*                                                                *
000003*                            ELCCRTO.                            *
000004*                                                                *
000005*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
000006*                                                                *
000007*   FILE TYPE = VSAM,KSDS                                        *
000008*   RECORD SIZE = 524  RECFORM = FIXED                           *
000009*                                                                *
000010*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
000011*                                                                *
000012*   LOG = YES                                                    *
000013*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000014******************************************************************
000015*                   C H A N G E   L O G
000016*
000017* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000018*-----------------------------------------------------------------
000019*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000020* EFFECTIVE    NUMBER
000021*-----------------------------------------------------------------
000022* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
000023* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
000024* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
000025* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
000026* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
000027******************************************************************
000028
000029 01  ORIGINAL-CERTIFICATE.
000030     12  OC-RECORD-ID                      PIC XX.
000031         88  VALID-OC-ID                      VALUE 'OC'.
000032
000033     12  OC-CONTROL-PRIMARY.
000034         16  OC-COMPANY-CD                 PIC X.
000035         16  OC-CARRIER                    PIC X.
000036         16  OC-GROUPING                   PIC X(6).
000037         16  OC-STATE                      PIC XX.
000038         16  OC-ACCOUNT                    PIC X(10).
000039         16  OC-CERT-EFF-DT                PIC XX.
000040         16  OC-CERT-NO.
000041             20  OC-CERT-PRIME             PIC X(10).
000042             20  OC-CERT-SFX               PIC X.
000043         16  OC-RECORD-TYPE                PIC X.
000044         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
000045
000046     12  OC-LAST-MAINT-DT                  PIC XX.
000047     12  OC-LAST-MAINT-BY                  PIC X(4).
000048     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
000049
000050     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
000051     12  FILLER                            PIC X(49).
000052
000053     12  OC-ORIG-REC.
000054         16  OC-INS-LAST-NAME              PIC X(15).
000055         16  OC-INS-FIRST-NAME             PIC X(10).
000056         16  OC-INS-MIDDLE-INIT            PIC X.
000057         16  OC-INS-AGE                    PIC S999     COMP-3.
000058         16  OC-JNT-LAST-NAME              PIC X(15).
000059         16  OC-JNT-FIRST-NAME             PIC X(10).
000060         16  OC-JNT-MIDDLE-INIT            PIC X.
000061         16  OC-JNT-AGE                    PIC S999     COMP-3.
000062         16  OC-LF-BENCD                   PIC XX.
000063         16  OC-LF-TERM                    PIC S999      COMP-3.
000064         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
000065         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
000066         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
000067         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
000068         16  OC-LF-EXP-DT                  PIC XX.
000069         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
000070         16  OC-LF-CANCEL-DT               PIC XX.
000071         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
000072         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
000073         16  OC-AH-BENCD                   PIC XX.
000074         16  OC-AH-TERM                    PIC S999      COMP-3.
000075         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
000076         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
000077         16  OC-AH-EXP-DT                  PIC XX.
000078         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
000079         16  OC-AH-CP                      PIC 99.
000080         16  OC-AH-CANCEL-DT               PIC XX.
000081         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
000082         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
000083         16  OC-CRED-BENE-NAME             PIC X(25).
000084         16  OC-1ST-PMT-DT                 PIC XX.
000085         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
000086         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
000087         16  OC-ISSUE-TRAN-IND             PIC X.
000088         16  OC-CANCEL-TRAN-IND            PIC X.
000089         16  FILLER                        PIC X(211).
000090
000091     12  FILLER                            PIC X(50).
000092
000093******************************************************************
      *<<((file: ELCCRTO))
001148*                                COPY ERCACCT.
      *>>((file: ERCACCT))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCACCT                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.031                          *
000007*                                                                *
000008*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
000009*                                                                *
000010*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
000011*   VSAM ACCOUNT MASTER FILES.                                   *
000012*                                                                *
000013*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
000014*                                                                *
000015*   FILE TYPE = VSAM,KSDS                                        *
000016*   RECORD SIZE = 2000  RECFORM = FIX                            *
000017*                                                                *
000018*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
000019*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
000020*                                                                *
000021*   LOG = NO                                                     *
000022*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000023*                                                                *
000024*                                                                *
000025******************************************************************
000026*                   C H A N G E   L O G
000027*
000028* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000029*-----------------------------------------------------------------
000030*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000031* EFFECTIVE    NUMBER
000032*-----------------------------------------------------------------
000033* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
000034* 092705    2005050300006  PEMA  ADD SPP LEASES
000035* 022808    2007083100002  PEMA  ADD FREEZE STATUS
000036* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
000037* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
000038* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
000039* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
000040* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
000041******************************************************************
000042
000043 01  ACCOUNT-MASTER.
000044     12  AM-RECORD-ID                      PIC XX.
000045         88  VALID-AM-ID                      VALUE 'AM'.
000046
000047     12  AM-CONTROL-PRIMARY.
000048         16  AM-COMPANY-CD                 PIC X.
000049         16  AM-MSTR-CNTRL.
000050             20  AM-CONTROL-A.
000051                 24  AM-CARRIER            PIC X.
000052                 24  AM-GROUPING.
000053                     28 AM-GROUPING-PREFIX PIC XXX.
000054                     28 AM-GROUPING-PRIME  PIC XXX.
000055                 24  AM-STATE              PIC XX.
000056                 24  AM-ACCOUNT.
000057                     28  AM-ACCOUNT-PREFIX PIC X(4).
000058                     28  AM-ACCOUNT-PRIME  PIC X(6).
000059             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
000060                                           PIC X(19).
000061             20  AM-CNTRL-B.
000062                 24  AM-EXPIRATION-DT      PIC XX.
000063                 24  FILLER                PIC X(4).
000064             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
000065                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
000066
000067     12  AM-CONTROL-BY-VAR-GRP.
000068         16  AM-COMPANY-CD-A1              PIC X.
000069         16  AM-VG-CARRIER                 PIC X.
000070         16  AM-VG-GROUPING                PIC X(6).
000071         16  AM-VG-STATE                   PIC XX.
000072         16  AM-VG-ACCOUNT                 PIC X(10).
000073         16  AM-VG-DATE.
000074             20  AM-VG-EXPIRATION-DT       PIC XX.
000075             20  FILLER                    PIC X(4).
000076         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
000077                                           PIC 9(11)      COMP-3.
000078     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
000079         16  FILLER                        PIC X(10).
000080         16  AM-VG-KEY3.
000081             20  AM-VG3-ACCOUNT            PIC X(10).
000082             20  AM-VG3-EXP-DT             PIC XX.
000083         16  FILLER                        PIC X(4).
000084     12  AM-MAINT-INFORMATION.
000085         16  AM-LAST-MAINT-DT              PIC XX.
000086         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
000087         16  AM-LAST-MAINT-USER            PIC X(4).
000088         16  FILLER                        PIC XX.
000089
000090     12  AM-EFFECTIVE-DT                   PIC XX.
000091     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
000092
000093     12  AM-PREV-DATES  COMP-3.
000094         16  AM-PREV-EXP-DT                PIC 9(11).
000095         16  AM-PREV-EFF-DT                PIC 9(11).
000096
000097     12  AM-REPORT-CODE-1                  PIC X(10).
000098     12  AM-REPORT-CODE-2                  PIC X(10).
000099
000100     12  AM-CITY-CODE                      PIC X(4).
000101     12  AM-COUNTY-PARISH                  PIC X(6).
000102
000103     12  AM-NAME                           PIC X(30).
000104     12  AM-PERSON                         PIC X(30).
000105     12  AM-ADDRS                          PIC X(30).
000106     12  AM-CITY.
000107         16  AM-ADDR-CITY                  PIC X(28).
000108         16  AM-ADDR-STATE                 PIC XX.
000109     12  AM-ZIP.
000110         16  AM-ZIP-PRIME.
000111             20  AM-ZIP-PRI-1ST            PIC X.
000112                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
000113             20  FILLER                    PIC X(4).
000114         16  AM-ZIP-PLUS4                  PIC X(4).
000115     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
000116         16  AM-CAN-POSTAL-1               PIC XXX.
000117         16  AM-CAN-POSTAL-2               PIC XXX.
000118         16  FILLER                        PIC XXX.
000119     12  AM-TEL-NO.
000120         16  AM-AREA-CODE                  PIC 999.
000121         16  AM-TEL-PRE                    PIC 999.
000122         16  AM-TEL-NBR                    PIC 9(4).
000123     12  AM-TEL-LOC                        PIC X.
000124         88  AM-TEL-AT-HOME                   VALUE 'H'.
000125         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
000126
000127     12  AM-COMM-STRUCTURE.
000128         16  AM-DEFN-1.
000129             20  AM-AGT-COMMS       OCCURS 10 TIMES.
000130                 24  AM-AGT.
000131                     28  AM-AGT-PREFIX     PIC X(4).
000132                     28  AM-AGT-PRIME      PIC X(6).
000133                 24  AM-COM-TYP            PIC X.
000134                 24  AM-L-COM              PIC SV9(5)     COMP-3.
000135                 24  AM-J-COM              PIC SV9(5)     COMP-3.
000136                 24  AM-A-COM              PIC SV9(5)     COMP-3.
000137                 24  AM-RECALC-LV-INDIC    PIC X.
000138                 24  AM-RETRO-LV-INDIC     PIC X.
000139                 24  AM-GL-CODES           PIC X.
000140                 24  AM-COMM-CHARGEBACK    PIC 9(02).
000141                 24  FILLER                PIC X(01).
000142         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
000143             20  AM-COM-TBLS        OCCURS 10 TIMES.
000144                 24  FILLER                PIC X(11).
000145                 24  AM-L-COMA             PIC XXX.
000146                 24  AM-J-COMA             PIC XXX.
000147                 24  AM-A-COMA             PIC XXX.
000148                 24  FILLER                PIC X(6).
000149
000150     12  AM-COMM-CHANGE-STATUS             PIC X.
000151         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
000152
000153     12  AM-CSR-CODE                       PIC X(4).
000154
000155     12  AM-BILLING-STATUS                 PIC X.
000156         88  AM-ACCOUNT-BILLED                VALUE 'B'.
000157         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
000158     12  AM-AUTO-REFUND-SW                 PIC X.
000159         88  AUTO-REFUNDS-USED                VALUE 'Y'.
000160         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
000161     12  AM-GPCD                           PIC 99.
000162     12  AM-IG                             PIC X.
000163         88  AM-HAS-INDIVIDUAL                VALUE '1'.
000164         88  AM-HAS-GROUP                     VALUE '2'.
000165     12  AM-STATUS                         PIC X.
000166         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
000167         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
000168         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
000169         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
000170         88  AM-ACCOUNT-FROZEN                VALUE '4'.
000171         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
000172         88  AM-ACCOUNT-DROPPED               VALUE '6'.
000173         88  AM-ACCOUNT-LAPSED                VALUE '7'.
000174         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
000175         88  AM-ACCOUNT-PENDING               VALUE '9'.
000176     12  AM-REMIT-TO                       PIC 99.
000177     12  AM-ID-NO                          PIC X(11).
000178
000179     12  AM-CAL-TABLE                      PIC XX.
000180     12  AM-LF-DEVIATION                   PIC XXX.
000181     12  AM-AH-DEVIATION                   PIC XXX.
000182     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
000183     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
000184     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
000185     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
000186     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
000187     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
000188
000189     12  AM-USER-FIELDS.
000190         16  AM-FLD-1                      PIC XX.
000191         16  AM-FLD-2                      PIC XX.
000192         16  AM-FLD-3                      PIC XX.
000193         16  AM-FLD-4                      PIC XX.
000194         16  AM-FLD-5                      PIC XX.
000195
000196     12  AM-1ST-PROD-DATE.
000197         16  AM-1ST-PROD-YR                PIC XX.
000198         16  AM-1ST-PROD-MO                PIC XX.
000199         16  AM-1ST-PROD-DA                PIC XX.
000200     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
000201     12  AM-CERTS-PURGED-DATE.
000202         16  AM-PUR-YR                     PIC XX.
000203         16  AM-PUR-MO                     PIC XX.
000204         16  AM-PUR-DA                     PIC XX.
000205     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
000206     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
000207     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
000208     12  AM-INACTIVE-DATE.
000209         16  AM-INA-MO                     PIC 99.
000210         16  AM-INA-DA                     PIC 99.
000211         16  AM-INA-YR                     PIC 99.
000212     12  AM-AR-HI-CERT-DATE                PIC XX.
000213
000214     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
000215     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
000216
000217     12  AM-OB-PAYMENT-MODE                PIC X.
000218         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
000219         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
000220         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
000221         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
000222
000223     12  AM-AH-ONLY-INDICATOR              PIC X.
000224         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
000225         88  AM-NO-AH-ONLY                    VALUE 'N'.
000226
000227     12  AM-EDIT-LOAN-OFC                  PIC X(01).
000228
000229     12  AM-OVER-SHORT.
000230         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
000231         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
000232
000233     12  AM-DCC-PRODUCT-CODE               PIC XXX.
000234     12  AM-DCC-CLP-STATE                  PIC XX.
000235
000236     12  AM-RECALC-COMM                    PIC X.
000237     12  AM-RECALC-REIN                    PIC X.
000238
000239     12  AM-REI-TABLE                      PIC XXX.
000240     12  AM-REI-ET-LF                      PIC X.
000241     12  AM-REI-ET-AH                      PIC X.
000242     12  AM-REI-PE-LF                      PIC X.
000243     12  AM-REI-PE-AH                      PIC X.
000244     12  AM-REI-PRT-ST                     PIC X.
000245     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
000246     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
000247     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
000248     12  AM-REI-GROUP-A                    PIC X(6).
000249     12  AM-REI-MORT                       PIC X(4).
000250     12  AM-REI-PRT-OW                     PIC X.
000251     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
000252     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
000253     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
000254     12  AM-REI-GROUP-B                    PIC X(6).
000255
000256     12  AM-TRUST-TYPE                     PIC X(2).
000257
000258     12  AM-EMPLOYER-STMT-USED             PIC X.
000259     12  AM-GROUPED-CHECKS-Y-N             PIC X.
000260
000261     12  AM-STD-AH-TYPE                    PIC XX.
000262     12  AM-EARN-METHODS.
000263         16  AM-EARN-METHOD-R              PIC X.
000264             88 AM-REF-RL-R78                 VALUE 'R'.
000265             88 AM-REF-RL-PR                  VALUE 'P'.
000266             88 AM-REF-RL-MEAN                VALUE 'M'.
000267             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
000268         16  AM-EARN-METHOD-L              PIC X.
000269             88 AM-REF-LL-R78                 VALUE 'R'.
000270             88 AM-REF-LL-PR                  VALUE 'P'.
000271             88 AM-REF-LL-MEAN                VALUE 'M'.
000272             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
000273         16  AM-EARN-METHOD-A              PIC X.
000274             88 AM-REF-AH-R78                 VALUE 'R'.
000275             88 AM-REF-AH-PR                  VALUE 'P'.
000276             88 AM-REF-AH-MEAN                VALUE 'M'.
000277             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
000278             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
000279             88 AM-REF-AH-NET                 VALUE 'N'.
000280
000281     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
000282     12  AM-TOL-REF                        PIC S999V99    COMP-3.
000283     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
000284
000285     12  AM-RET-Y-N                        PIC X.
000286     12  AM-RET-P-E                        PIC X.
000287     12  AM-LF-RET                         PIC S9V9999    COMP-3.
000288     12  AM-AH-RET                         PIC S9V9999    COMP-3.
000289     12  AM-RET-GRP                        PIC X(6).
000290     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
000291         16  AM-POOL-PRIME                 PIC XXX.
000292         16  AM-POOL-SUB                   PIC XXX.
000293     12  AM-RETRO-EARNINGS.
000294         16  AM-RET-EARN-R                 PIC X.
000295         16  AM-RET-EARN-L                 PIC X.
000296         16  AM-RET-EARN-A                 PIC X.
000297     12  AM-RET-ST-TAX-USE                 PIC X.
000298         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
000299         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
000300     12  AM-RETRO-BEG-EARNINGS.
000301         16  AM-RET-BEG-EARN-R             PIC X.
000302         16  AM-RET-BEG-EARN-L             PIC X.
000303         16  AM-RET-BEG-EARN-A             PIC X.
000304     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
000305     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
000306
000307     12  AM-USER-SELECT-OPTIONS.
000308         16  AM-USER-SELECT-1              PIC X(10).
000309         16  AM-USER-SELECT-2              PIC X(10).
000310         16  AM-USER-SELECT-3              PIC X(10).
000311         16  AM-USER-SELECT-4              PIC X(10).
000312         16  AM-USER-SELECT-5              PIC X(10).
000313
000314     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
000315
000316     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
000317
000318     12  AM-RPT045A-SWITCH                 PIC X.
000319         88  RPT045A-OFF                   VALUE 'N'.
000320
000321     12  AM-INSURANCE-LIMITS.
000322         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
000323         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
000324
000325     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
000326         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
000327
000328     12  AM-DISMBR-COVERAGE-SW             PIC X.
000329         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
000330         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
000331
000332     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
000333
000334     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
000335     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
000336     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
000337     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
000338     12  AM-DCC-UEF-STATE                  PIC XX.
000339     12  FILLER                            PIC XXX.
000340     12  AM-REPORT-CODE-3                  PIC X(10).
000341*    12  FILLER                            PIC X(22).
000342
000343     12  AM-RESERVE-DATE.
000344         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
000345         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
000346         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
000347
000348     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
000349     12  AM-NOTIFICATION-TYPES.
000350         16  AM-NOTIF-OF-LETTERS           PIC X.
000351         16  AM-NOTIF-OF-PAYMENTS          PIC X.
000352         16  AM-NOTIF-OF-REPORTS           PIC X.
000353         16  AM-NOTIF-OF-STATUS            PIC X.
000354
000355     12  AM-BENEFIT-TABLE-USAGE            PIC X.
000356         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
000357         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
000358         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
000359         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
000360
000361     12  AM-BENEFIT-CONTROLS.
000362         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
000363             20  AM-BENEFIT-CODE           PIC XX.
000364             20  AM-BENEFIT-TYPE           PIC X.
000365             20  AM-BENEFIT-REVISION       PIC XXX.
000366             20  AM-BENEFIT-REM-TERM       PIC X.
000367             20  AM-BENEFIT-RETRO-Y-N      PIC X.
000368             20  FILLER                    PIC XX.
000369         16  FILLER                        PIC X(80).
000370
000371     12  AM-TRANSFER-DATA.
000372         16  AM-TRANSFERRED-FROM.
000373             20  AM-TRNFROM-CARRIER        PIC X.
000374             20  AM-TRNFROM-GROUPING.
000375                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
000376                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
000377             20  AM-TRNFROM-STATE          PIC XX.
000378             20  AM-TRNFROM-ACCOUNT.
000379                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
000380                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
000381             20  AM-TRNFROM-DTE            PIC XX.
000382         16  AM-TRANSFERRED-TO.
000383             20  AM-TRNTO-CARRIER          PIC X.
000384             20  AM-TRNTO-GROUPING.
000385                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
000386                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
000387             20  AM-TRNTO-STATE            PIC XX.
000388             20  AM-TRNTO-ACCOUNT.
000389                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
000390                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
000391             20  AM-TRNTO-DTE              PIC XX.
000392         16  FILLER                        PIC X(10).
000393
000394     12  AM-SAVED-REMIT-TO                 PIC 99.
000395
000396     12  AM-COMM-STRUCTURE-SAVED.
000397         16  AM-DEFN-1-SAVED.
000398             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
000399                 24  AM-AGT-SV             PIC X(10).
000400                 24  AM-COM-TYP-SV         PIC X.
000401                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
000402                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
000403                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
000404                 24  AM-RECALC-LV-INDIC-SV PIC X.
000405                 24  FILLER                PIC X.
000406                 24  AM-GL-CODES-SV        PIC X.
000407                 24  AM-COM-CHARGEBACK-SV  PIC 99.
000408                 24  FILLER                PIC X.
000409         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
000410             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
000411                 24  FILLER                PIC X(11).
000412                 24  AM-L-COMA-SV          PIC XXX.
000413                 24  AM-J-COMA-SV          PIC XXX.
000414                 24  AM-A-COMA-SV          PIC XXX.
000415                 24  FILLER                PIC X(6).
000416
000417     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
000418         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
000419            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
000420            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
000421            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
000422
000423     12  AM-ORIG-DEALER-NO                 PIC X(10).
000424     12  FILLER                            PIC X(120).
000425
000426     12  AM-ACCOUNT-EXECUTIVE-DATA.
000427         16  AM-CONTROL-NAME               PIC X(30).
000428         16  AM-EXECUTIVE-ONE.
000429             20  AM-EXEC1-NAME             PIC X(15).
000430             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
000431                                                          COMP-3.
000432             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
000433                                                          COMP-3.
000434         16  AM-EXECUTIVE-TWO.
000435             20  AM-EXEC2-NAME             PIC X(15).
000436             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
000437                                                          COMP-3.
000438             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
000439                                                          COMP-3.
000440
000441     12  AM-RETRO-ADDITIONAL-DATA.
000442         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
000443         16  AM-RETRO-PREM-P-E             PIC X.
000444         16  AM-RETRO-CLMS-P-I             PIC X.
000445         16  AM-RETRO-RET-BRACKET-LF.
000446             20  AM-RETRO-RET-METHOD-LF    PIC X.
000447                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
000448                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
000449             20  AM-RETRO-RET-BASIS-LF     PIC X.
000450                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
000451                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
000452             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
000453                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
000454                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
000455         16  AM-RETRO-RET-BRACKET-AH.
000456             20  AM-RETRO-RET-METHOD-AH    PIC X.
000457                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
000458                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
000459                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
000460             20  AM-RETRO-RET-BASIS-AH     PIC X.
000461                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
000462                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
000463             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
000464                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
000465                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
000466
000467     12  AM-COMMENTS.
000468         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
000469
000470     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
000471         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
000472         16  AM-FLI-BILLING-CODE           PIC X.
000473         16  AM-FLI-ALT-STATE-CODE         PIC XX.
000474         16  AM-FLI-UNITED-IDENT           PIC X.
000475         16  AM-FLI-INTEREST-LOST-DATA.
000476             20  AM-FLI-BANK-NO            PIC X(5).
000477             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
000478             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
000479             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
000480         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
000481             20  AM-FLI-AGT                PIC X(9).
000482             20  AM-FLI-AGT-COMM-ACC       PIC X.
000483             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
000484         16  FILLER                        PIC X(102).
000485
000486     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
000487         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
000488             20  AM-BENEFIT-DMD-CODE         PIC XX.
000489             20  AM-BENEFIT-DMD-TYPE         PIC X.
000490             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
000491             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
000492             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
000493         16  FILLER                          PIC X(10).
000494******************************************************************
      *<<((file: ERCACCT))
001149*                                copy ERCACNT.
      *>>((file: ERCACNT))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCACNT.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.002                          *
000007*                                                                *
000008*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
000009*                                                                *
000010*   FILE TYPE = VSAM,KSDS                                        *
000011*   RECORD SIZE = 120   RECFORM = FIXED                          *
000012*                                                                *
000013*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
000014*       ALTERNATE INDEX = NONE                                   *
000015*                                                                *
000016*                                                                *
000017*   LOG = YES                                                    *
000018*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000019******************************************************************
000020*                   C H A N G E   L O G
000021*
000022* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000023*-----------------------------------------------------------------
000024*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000025* EFFECTIVE    NUMBER
000026*-----------------------------------------------------------------
000027* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
000028*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
000029******************************************************************
000030 01  NOTE-FILE.
000031     12  NT-FILE-ID                  PIC XX.
000032         88  VALID-NOTE-ID              VALUE 'NT'.
000033
000034     12  NT-CONTROL-PRIMARY.
000035         16  NT-COMPANY-CD           PIC X.
000036         16  NT-ACCT-NOTE-KEY.
000037             18  NT-CARRIER              PIC X.
000038             18  NT-GROUPING             PIC X(06).
000039             18  NT-STATE                PIC XX.
000040             18  NT-ACCOUNT              PIC X(10).
000041         16  NT-RECORD-TYPE          PIC X.
000042              88  ACCT-NOTE          VALUE '1'.
000043              88  ACCT-BRANCH-LOC    VALUE '2'.
000044              88  ACCT-SHIPPING-ADDR VALUE '3'.
000045         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
000046
000047     12  NT-LAST-MAINT-DT            PIC XX.
000048     12  NT-LAST-MAINT-BY            PIC X(4).
000049     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
000050
000051*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
000052*     SEQUENCE NUMBERS
000053     12  NT-NOTE-INFORMATION.
000054         16  NT-NOTE-LINE            PIC X(60).
000055         16  FILLER                  PIC X(25).
000056*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
000057     12  NT-LOCATION-INFORMATION REDEFINES
000058                         NT-NOTE-INFORMATION.
000059         16  NT-BRANCH-LOC-LINE      PIC X(60).
000060         16  FILLER                  PIC X(25).
000061* Account special indicator is record type '2', sequence 3
000062     12  filler REDEFINES NT-NOTE-INFORMATION.
000063         16  nt-account-special      PIC X.
000064         16  FILLER                  PIC X(84).
000065*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
000066*     SEQUENCE NUMBER 1 IS NAME LINE 1
000067*     SEQUENCE NUMBER 2 IS NAME LINE 2
000068*     SEQUENCE NUMBER 3 IS ADDR LINE 1
000069*     SEQUENCE NUMBER 4 IS ADDR LINE 2
000070*     SEQUENCE NUMBER 5 IS ADDR LINE 3
000071*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
000072     12  NT-SHIPPING-INFORMATION REDEFINES
000073                         NT-NOTE-INFORMATION.
000074         16  NT-SHIPPING-LINE        PIC X(60).
000075         16  NT-SHIP-STATE           PIC XX.
000076         16  NT-SHIP-ZIP             PIC X(10).
000077         16  FILLER                  PIC X(13).
000078*****************************************************************
      *<<((file: ERCACNT))
001150*                                COPY ELCVADS.
      *>>((file: ELCVADS))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCVADS.                            *
000005*                                                                *
000006*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
000007*   ELVADS                  LENGTH = 350                         *
000008******************************************************************
000009******************************************************************
000010*                   C H A N G E   L O G
000011*
000012* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000013*-----------------------------------------------------------------
000014*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000015* EFFECTIVE    NUMBER
000016*-----------------------------------------------------------------
000017* 100111    2011022800001  AJRA  NAPERSOFT
000018******************************************************************
000019
000020 01  VIRGINIA-DISCLOSURE.
000021     12  VD-COMPANY-CD              PIC X.
000022     12  VD-CARRIER                 PIC X.
000023     12  VD-GROUPING.
000024         20  VD-GROUPING-PREFIX     PIC XXX.
000025         20  VD-GROUPING-PRIME      PIC XXX.
000026     12  VD-STATE                   PIC XX.
000027     12  VD-ACCOUNT.
000028         20  VD-ACCOUNT-PREFIX      PIC X(4).
000029         20  VD-ACCOUNT-PRIME       PIC X(6).
000030     12  VD-CERT-EFF-DT             PIC XX.
000031     12  VD-CERT-NO.
000032         20  VD-CERT-PRIME          PIC X(10).
000033         20  VD-CERT-SFX            PIC X.
000034     12  VD-ENTRY-BATCH             PIC X(6).
000035     12  VD-CSR-ID                  PIC X(4).
000036     12  VD-NAME.
000037         20  VD-INSURED-LAST-NAME   PIC X(15).
000038         20  VD-INSURED-FIRST-NAME.
000039             24  VD-INSURED-1ST-INIT PIC X.
000040             24  FILLER             PIC X(9).
000041         20  VD-INSURED-MIDDLE-INIT PIC X.
000042     12  VD-JOINT-INSURED.
000043         20 VD-JOINT-LAST-NAME      PIC X(15).
000044         20 VD-JOINT-FIRST-NAME.
000045            24  VD-JOINT-FIRST-INIT PIC X.
000046            24  FILLER              PIC X(9).
000047         20 VD-JOINT-MIDDLE-INIT    PIC X.
000048     12  VD-INSURED-ADDRESS-1       PIC X(30).
000049     12  VD-INSURED-ADDRESS-2       PIC X(30).
000050     12  VD-INSURED-CITY-STATE.
000051         20  VD-INSURED-CITY        PIC X(28).
000052         20  VD-INSURED-STATE       PIC XX.
000053     12  VD-INSURED-ZIP-CODE.
000054         20  VD-INSURED-ZIP-PRIME.
000055             24  VD-INSURED-ZIP-1   PIC X.
000056                 88  VD-CANADIAN-POST-CODE
000057                                       VALUE 'A' THRU 'Z'.
000058             24  FILLER             PIC X(4).
000059         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
000060     12  VD-BENEFICIARY-NAME        PIC X(30).
000061     12  VD-ACCOUNT-NAME            PIC X(30).
000062     12  VD-LOAN-TERM               PIC S999   COMP-3.
000063     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
000064     12  VD-1ST-PMT-DT              PIC XX.
000065     12  VD-LIFE-BENEFIT-CD         PIC XX.
000066         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
000067         88  VD-INVALID-LIFE           VALUE '  ' '00'
000068                                             '90' THRU '99'.
000069     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
000070                                    PIC XX.
000071     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
000072     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
000073     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
000074     12  VD-LF-TERM                 PIC S999   COMP-3.
000075     12  VD-AH-BENEFIT-CD           PIC XX.
000076         88  VD-VALID-AH               VALUE '01' THRU '89'.
000077         88  VD-INVALID-AH             VALUE '  ' '00'
000078                                             '90' THRU '99'.
000079     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
000080     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
000081     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
000082     12  VD-AH-TERM                 PIC S999   COMP-3.
000083     12  VD-LETTER-ID               PIC X(4).
000084     12  VD-PROC-ID                 PIC X(4).
000085     12  VD-COMP-ID                 PIC X(3).
000086     12  VD-CURRENT-DATE            PIC XX.
000087     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
000088     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
000089     12  FILLER                     PIC X(32).
      *<<((file: ELCVADS))
001151
001152     EJECT
001153*    COPY ELCDATE.
      *>>((file: ELCDATE))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCDATE.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.003
000007*                                                                *
000008*                                                                *
000009*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
000010*                 LENGTH = 200                                   *
000011******************************************************************
000012
000013 01  DATE-CONVERSION-DATA.
000014     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
000015     12  DC-OPTION-CODE                PIC X.
000016         88  BIN-TO-GREG                VALUE ' '.
000017         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
000018         88  EDIT-GREG-TO-BIN           VALUE '2'.
000019         88  YMD-GREG-TO-BIN            VALUE '3'.
000020         88  MDY-GREG-TO-BIN            VALUE '4'.
000021         88  JULIAN-TO-BIN              VALUE '5'.
000022         88  BIN-PLUS-ELAPSED           VALUE '6'.
000023         88  FIND-CENTURY               VALUE '7'.
000024         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
000025         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
000026         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
000027         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
000028         88  JULIAN-TO-BIN-3            VALUE 'C'.
000029         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
000030         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
000031         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
000032         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
000033         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
000034         88  CHECK-LEAP-YEAR            VALUE 'H'.
000035         88  BIN-3-TO-GREG              VALUE 'I'.
000036         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
000037         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
000038         88  CYMD-GREG-TO-BIN           VALUE 'L'.
000039         88  MDCY-GREG-TO-BIN           VALUE 'M'.
000040         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
000041         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
000042         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
000043         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
000044         88  THREE-CHARACTER-BIN
000045                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
000046         88  GREGORIAN-TO-BIN
000047                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
000048         88  BIN-TO-GREGORIAN
000049                  VALUES ' ' '1' 'I' '8' 'G'.
000050         88  JULIAN-TO-BINARY
000051                  VALUES '5' 'C' 'E' 'F'.
000052     12  DC-ERROR-CODE                 PIC X.
000053         88  NO-CONVERSION-ERROR        VALUE ' '.
000054         88  DATE-CONVERSION-ERROR
000055                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
000056         88  DATE-IS-ZERO               VALUE '1'.
000057         88  DATE-IS-NON-NUMERIC        VALUE '2'.
000058         88  DATE-IS-INVALID            VALUE '3'.
000059         88  DATE1-GREATER-DATE2        VALUE '4'.
000060         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
000061         88  DATE-INVALID-OPTION        VALUE '9'.
000062         88  INVALID-CENTURY            VALUE 'A'.
000063         88  ONLY-CENTURY               VALUE 'B'.
000064         88  ONLY-LEAP-YEAR             VALUE 'C'.
000065         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
000066     12  DC-END-OF-MONTH               PIC X.
000067         88  CALCULATE-END-OF-MONTH     VALUE '1'.
000068     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
000069         88  USE-NORMAL-PROCESS         VALUE ' '.
000070         88  ADJUST-DOWN-100-YRS        VALUE '1'.
000071         88  ADJUST-UP-100-YRS          VALUE '2'.
000072     12  FILLER                        PIC X.
000073     12  DC-CONVERSION-DATES.
000074         16  DC-BIN-DATE-1             PIC XX.
000075         16  DC-BIN-DATE-2             PIC XX.
000076         16  DC-GREG-DATE-1-EDIT       PIC X(08).
000077         16  DC-GREG-DATE-1-EDIT-R REDEFINES
000078                       DC-GREG-DATE-1-EDIT.
000079             20  DC-EDIT1-MONTH        PIC 99.
000080             20  SLASH1-1              PIC X.
000081             20  DC-EDIT1-DAY          PIC 99.
000082             20  SLASH1-2              PIC X.
000083             20  DC-EDIT1-YEAR         PIC 99.
000084         16  DC-GREG-DATE-2-EDIT       PIC X(08).
000085         16  DC-GREG-DATE-2-EDIT-R REDEFINES
000086                     DC-GREG-DATE-2-EDIT.
000087             20  DC-EDIT2-MONTH        PIC 99.
000088             20  SLASH2-1              PIC X.
000089             20  DC-EDIT2-DAY          PIC 99.
000090             20  SLASH2-2              PIC X.
000091             20  DC-EDIT2-YEAR         PIC 99.
000092         16  DC-GREG-DATE-1-YMD        PIC 9(06).
000093         16  DC-GREG-DATE-1-YMD-R  REDEFINES
000094                     DC-GREG-DATE-1-YMD.
000095             20  DC-YMD-YEAR           PIC 99.
000096             20  DC-YMD-MONTH          PIC 99.
000097             20  DC-YMD-DAY            PIC 99.
000098         16  DC-GREG-DATE-1-MDY        PIC 9(06).
000099         16  DC-GREG-DATE-1-MDY-R REDEFINES
000100                      DC-GREG-DATE-1-MDY.
000101             20  DC-MDY-MONTH          PIC 99.
000102             20  DC-MDY-DAY            PIC 99.
000103             20  DC-MDY-YEAR           PIC 99.
000104         16  DC-GREG-DATE-1-ALPHA.
000105             20  DC-ALPHA-MONTH        PIC X(10).
000106             20  DC-ALPHA-DAY          PIC 99.
000107             20  FILLER                PIC XX.
000108             20  DC-ALPHA-CENTURY.
000109                 24 DC-ALPHA-CEN-N     PIC 99.
000110             20  DC-ALPHA-YEAR         PIC 99.
000111         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
000112         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
000113         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
000114         16  DC-JULIAN-DATE            PIC 9(05).
000115         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
000116                                       PIC 9(05).
000117         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
000118             20  DC-JULIAN-YEAR        PIC 99.
000119             20  DC-JULIAN-DAYS        PIC 999.
000120         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
000121         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
000122         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
000123     12  DATE-CONVERSION-VARIBLES.
000124         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
000125         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
000126             20  FILLER                PIC 9(3).
000127             20  HOLD-CEN-1-CCYY.
000128                 24  HOLD-CEN-1-CC     PIC 99.
000129                 24  HOLD-CEN-1-YY     PIC 99.
000130             20  HOLD-CEN-1-MO         PIC 99.
000131             20  HOLD-CEN-1-DA         PIC 99.
000132         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
000133             20  HOLD-CEN-1-R-MO       PIC 99.
000134             20  HOLD-CEN-1-R-DA       PIC 99.
000135             20  HOLD-CEN-1-R-CCYY.
000136                 24  HOLD-CEN-1-R-CC   PIC 99.
000137                 24  HOLD-CEN-1-R-YY   PIC 99.
000138             20  FILLER                PIC 9(3).
000139         16  HOLD-CENTURY-1-X.
000140             20  FILLER                PIC X(3)  VALUE SPACES.
000141             20  HOLD-CEN-1-X-CCYY.
000142                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
000143                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
000144             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
000145             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
000146         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
000147             20  HOLD-CEN-1-R-X-MO     PIC XX.
000148             20  HOLD-CEN-1-R-X-DA     PIC XX.
000149             20  HOLD-CEN-1-R-X-CCYY.
000150                 24  HOLD-CEN-1-R-X-CC PIC XX.
000151                 24  HOLD-CEN-1-R-X-YY PIC XX.
000152             20  FILLER                PIC XXX.
000153         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
000154         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
000155         16  DC-JULIAN-DATE-1          PIC 9(07).
000156         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
000157             20  DC-JULIAN-1-CCYY.
000158                 24  DC-JULIAN-1-CC    PIC 99.
000159                 24  DC-JULIAN-1-YR    PIC 99.
000160             20  DC-JULIAN-DA-1        PIC 999.
000161         16  DC-JULIAN-DATE-2          PIC 9(07).
000162         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
000163             20  DC-JULIAN-2-CCYY.
000164                 24  DC-JULIAN-2-CC    PIC 99.
000165                 24  DC-JULIAN-2-YR    PIC 99.
000166             20  DC-JULIAN-DA-2        PIC 999.
000167         16  DC-GREG-DATE-A-EDIT.
000168             20  DC-EDITA-MONTH        PIC 99.
000169             20  SLASHA-1              PIC X VALUE '/'.
000170             20  DC-EDITA-DAY          PIC 99.
000171             20  SLASHA-2              PIC X VALUE '/'.
000172             20  DC-EDITA-CCYY.
000173                 24  DC-EDITA-CENT     PIC 99.
000174                 24  DC-EDITA-YEAR     PIC 99.
000175         16  DC-GREG-DATE-B-EDIT.
000176             20  DC-EDITB-MONTH        PIC 99.
000177             20  SLASHB-1              PIC X VALUE '/'.
000178             20  DC-EDITB-DAY          PIC 99.
000179             20  SLASHB-2              PIC X VALUE '/'.
000180             20  DC-EDITB-CCYY.
000181                 24  DC-EDITB-CENT     PIC 99.
000182                 24  DC-EDITB-YEAR     PIC 99.
000183         16  DC-GREG-DATE-CYMD         PIC 9(08).
000184         16  DC-GREG-DATE-CYMD-R REDEFINES
000185                              DC-GREG-DATE-CYMD.
000186             20  DC-CYMD-CEN           PIC 99.
000187             20  DC-CYMD-YEAR          PIC 99.
000188             20  DC-CYMD-MONTH         PIC 99.
000189             20  DC-CYMD-DAY           PIC 99.
000190         16  DC-GREG-DATE-MDCY         PIC 9(08).
000191         16  DC-GREG-DATE-MDCY-R REDEFINES
000192                              DC-GREG-DATE-MDCY.
000193             20  DC-MDCY-MONTH         PIC 99.
000194             20  DC-MDCY-DAY           PIC 99.
000195             20  DC-MDCY-CEN           PIC 99.
000196             20  DC-MDCY-YEAR          PIC 99.
000197    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
000198        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
000199    12  DC-EL310-DATE                  PIC X(21).
000200    12  FILLER                         PIC X(28).
      *<<((file: ELCDATE))
001154
001155     EJECT
001156*    COPY ELCLOGOF.
      *>>((file: ELCLOGOF))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCLOGOF.                           *
000005*                            VMOD=2.001                          *
000006*                                                                *
000007*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
000008*                                                                *
000009******************************************************************
000010 01  CLASIC-LOGOFF.
000011     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
000012     12  LOGOFF-TEXT.
000013         16  FILLER          PIC X(5)    VALUE SPACES.
000014         16  LOGOFF-MSG.
000015             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
000016             20  FILLER      PIC X       VALUE SPACES.
000017             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
000018         16  FILLER          PIC X(80)
000019           VALUE '* YOU ARE NOW LOGGED OFF'.
000020         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
000021         16  FILLER          PIC X       VALUE QUOTE.
000022         16  LOGOFF-SYS-MSG  PIC X(17)
000023           VALUE 'S CLAS-IC SYSTEM '.
000024     12  TEXT-MESSAGES.
000025         16  UNACCESS-MSG    PIC X(29)
000026             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
000027         16  PGMIDERR-MSG    PIC X(17)
000028             VALUE 'PROGRAM NOT FOUND'.
      *<<((file: ELCLOGOF))
001157
001158     EJECT
001159*    COPY ELCATTR.
      *>>((file: ELCATTR))
000001******************************************************************
000002*                                                                *
000003*                            ELCATTR.                            *
000004*                            VMOD=2.001                          *
000005*                                                                *
000006*             LIST OF STANDARD ATTRIBUTE VALUES                  *
000007*                                                                *
000008*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
000009*                                                                *
000010*                   POS 1   P=PROTECTED                          *
000011*                           U=UNPROTECTED                        *
000012*                           S=ASKIP                              *
000013*                   POS 2   A=ALPHA/NUMERIC                      *
000014*                           N=NUMERIC                            *
000015*                   POS 3   N=NORMAL                             *
000016*                           B=BRIGHT                             *
000017*                           D=DARK                               *
000018*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
000019*                           OF=MODIFIED DATA TAG OFF             *
000020*                                                                *
000021*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
000022******************************************************************
000023 01  ATTRIBUTE-LIST.
000024     12  AL-PABOF            PIC X       VALUE 'Y'.
000025     12  AL-PABON            PIC X       VALUE 'Z'.
000026     12  AL-PADOF            PIC X       VALUE '%'.
000027     12  AL-PADON            PIC X       VALUE '_'.
000028     12  AL-PANOF            PIC X       VALUE '-'.
000029     12  AL-PANON            PIC X       VALUE '/'.
000030     12  AL-SABOF            PIC X       VALUE '8'.
000031     12  AL-SABON            PIC X       VALUE '9'.
000032     12  AL-SADOF            PIC X       VALUE '@'.
000033     12  AL-SADON            PIC X       VALUE QUOTE.
000034     12  AL-SANOF            PIC X       VALUE '0'.
000035     12  AL-SANON            PIC X       VALUE '1'.
000036     12  AL-UABOF            PIC X       VALUE 'H'.
000037     12  AL-UABON            PIC X       VALUE 'I'.
000038     12  AL-UADOF            PIC X       VALUE '<'.
000039     12  AL-UADON            PIC X       VALUE '('.
000040     12  AL-UANOF            PIC X       VALUE ' '.
000041     12  AL-UANON            PIC X       VALUE 'A'.
000042     12  AL-UNBOF            PIC X       VALUE 'Q'.
000043     12  AL-UNBON            PIC X       VALUE 'R'.
000044     12  AL-UNDOF            PIC X       VALUE '*'.
000045     12  AL-UNDON            PIC X       VALUE ')'.
000046     12  AL-UNNOF            PIC X       VALUE '&'.
000047     12  AL-UNNON            PIC X       VALUE 'J'.
      *<<((file: ELCATTR))
001160
001161     EJECT
001162*    COPY ELCEMIB.
      *>>((file: ELCEMIB))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCEMIB.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.005                          *
000007*                                                                *
000008*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
000009*                                                                *
000010******************************************************************
000011 01  ERROR-MESSAGE-INTERFACE-BLOCK.
000012     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
000013     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
000014     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
000015     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
000016     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
000017     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
000018     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
000019     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
000020     12  EMI-SWITCH1             PIC X        VALUE '1'.
000021         88  EMI-NO-ERRORS                    VALUE '1'.
000022         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
000023         88  EMI-ERRORS-COMPLETE              VALUE '3'.
000024     12  EMI-SWITCH2             PIC X        VALUE '1'.
000025         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
000026     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
000027         88  EMI-AREA1-EMPTY                  VALUE '1'.
000028         88  EMI-AREA1-FULL                   VALUE '2'.
000029     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
000030         88  EMI-AREA2-EMPTY                  VALUE '1'.
000031         88  EMI-AREA2-FULL                   VALUE '2'.
000032     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
000033         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
000034         88  EMI-BYPASS-NOTES                 VALUE 'N'.
000035         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
000036         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
000037         88  EMI-BYPASS-FATALS                VALUE 'X'.
000038     12  EMI-ERROR-LINES.
000039         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
000040         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
000041         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
000042         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
000043             20  EMI-ERR-CODES OCCURS 10 TIMES.
000044                 24  EMI-ERR-NUM         PIC X(4).
000045                 24  EMI-FILLER          PIC X.
000046                 24  EMI-SEV             PIC X.
000047                 24  FILLER              PIC X.
000048             20  FILLER                  PIC X(02).
000049     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
000050         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
000051             20  EMI-ERROR-NUMBER    PIC X(4).
000052             20  EMI-FILL            PIC X.
000053             20  EMI-SEVERITY        PIC X.
000054             20  FILLER              PIC X.
000055             20  EMI-ERROR-TEXT.
000056                 24  EMI-TEXT-VARIABLE   PIC X(10).
000057                 24  FILLER          PIC X(55).
000058     12  EMI-SEVERITY-SAVE           PIC X.
000059         88  EMI-NOTE                    VALUE 'N'.
000060         88  EMI-WARNING                 VALUE 'W'.
000061         88  EMI-FORCABLE                VALUE 'F'.
000062         88  EMI-FATAL                   VALUE 'X'.
000063     12  EMI-MESSAGE-FLAG            PIC X.
000064         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
000065         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
000066     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
000067     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
000068         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
000069         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
000070         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
000071     12  emi-claim-no                pic x(7).
000072     12  emi-claim-type              pic x(6).
000073     12  FILLER                      PIC X(124)  VALUE SPACES.
000074     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
000075     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
000076     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
000077     12  EMI-AH-OVERRIDE-L6          PIC X(6).
      *<<((file: ELCEMIB))
001163
001164     EJECT
001165*    COPY ELCINTF.
      *>>((file: ELCINTF))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCINTF.                            *
000005*                            VMOD=2.017                          *
000006*                                                                *
000007*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
000008*                                                                *
000009*       LENGTH = 1024                                            *
000010*                                                                *
000011******************************************************************
000012*                   C H A N G E   L O G
000013*
000014* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000015*-----------------------------------------------------------------
000016*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000017* EFFECTIVE    NUMBER
000018*-----------------------------------------------------------------
000019* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
000020******************************************************************
000021 01  PROGRAM-INTERFACE-BLOCK.
000022     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
000023     12  PI-CALLING-PROGRAM              PIC X(8).
000024     12  PI-SAVED-PROGRAM-1              PIC X(8).
000025     12  PI-SAVED-PROGRAM-2              PIC X(8).
000026     12  PI-SAVED-PROGRAM-3              PIC X(8).
000027     12  PI-SAVED-PROGRAM-4              PIC X(8).
000028     12  PI-SAVED-PROGRAM-5              PIC X(8).
000029     12  PI-SAVED-PROGRAM-6              PIC X(8).
000030     12  PI-RETURN-TO-PROGRAM            PIC X(8).
000031     12  PI-COMPANY-ID                   PIC XXX.
000032     12  PI-COMPANY-CD                   PIC X.
000033
000034     12  PI-COMPANY-PASSWORD             PIC X(8).
000035
000036     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
000037
000038     12  PI-CONTROL-IN-PROGRESS.
000039         16  PI-CARRIER                  PIC X.
000040         16  PI-GROUPING                 PIC X(6).
000041         16  PI-STATE                    PIC XX.
000042         16  PI-ACCOUNT                  PIC X(10).
000043         16  PI-PRODUCER REDEFINES PI-ACCOUNT
000044                                         PIC X(10).
000045         16  PI-CLAIM-CERT-GRP.
000046             20  PI-CLAIM-NO             PIC X(7).
000047             20  PI-CERT-NO.
000048                 25  PI-CERT-PRIME       PIC X(10).
000049                 25  PI-CERT-SFX         PIC X.
000050             20  PI-CERT-EFF-DT          PIC XX.
000051         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
000052             20  PI-PLAN-CODE            PIC X(2).
000053             20  PI-REVISION-NUMBER      PIC X(3).
000054             20  PI-PLAN-EFF-DT          PIC X(2).
000055             20  PI-PLAN-EXP-DT          PIC X(2).
000056             20  FILLER                  PIC X(11).
000057         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
000058             20  PI-OE-REFERENCE-1.
000059                 25  PI-OE-REF-1-PRIME   PIC X(18).
000060                 25  PI-OE-REF-1-SUFF    PIC XX.
000061
000062     12  PI-SESSION-IN-PROGRESS          PIC X.
000063         88  CLAIM-SESSION                   VALUE '1'.
000064         88  CREDIT-SESSION                  VALUE '2'.
000065         88  WARRANTY-SESSION                VALUE '3'.
000066         88  MORTGAGE-SESSION                VALUE '4'.
000067         88  GENERAL-LEDGER-SESSION          VALUE '5'.
000068
000069
000070*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
000071
000072     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
000073     12  PI-ORIGINAL-COMPANY-CD          PIC X.
000074
000075     12  PI-CREDIT-USER                  PIC X.
000076         88  PI-NOT-CREDIT-USER              VALUE 'N'.
000077         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
000078
000079     12  PI-CLAIM-USER                   PIC X.
000080         88  PI-NOT-CLAIM-USER               VALUE 'N'.
000081         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
000082
000083     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
000084         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
000085         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
000086         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
000087         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
000088         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
000089
000090     12  PI-PROCESSOR-ID                 PIC X(4).
000091
000092     12  PI-PROCESSOR-PASSWORD           PIC X(11).
000093
000094     12  PI-MEMBER-CAPTION               PIC X(10).
000095
000096     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
000097         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
000098
000099     12  PI-LIFE-OVERRIDE-L1             PIC X.
000100     12  PI-LIFE-OVERRIDE-L2             PIC XX.
000101     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
000102     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
000103
000104     12  PI-AH-OVERRIDE-L1               PIC X.
000105     12  PI-AH-OVERRIDE-L2               PIC XX.
000106     12  PI-AH-OVERRIDE-L6               PIC X(6).
000107     12  PI-AH-OVERRIDE-L12              PIC X(12).
000108
000109     12  PI-NEW-SYSTEM                   PIC X(2).
000110
000111     12  PI-PRIMARY-CERT-NO              PIC X(11).
000112     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
000113         88  PI-USES-PAID-TO                 VALUE '1'.
000114     12  PI-CRDTCRD-SYSTEM.
000115         16  PI-CRDTCRD-USER             PIC X.
000116             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
000117             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
000118         16  PI-CC-MONTH-END-DT          PIC XX.
000119     12  PI-PROCESSOR-PRINTER            PIC X(4).
000120
000121     12  PI-OE-REFERENCE-2.
000122         16  PI-OE-REF-2-PRIME           PIC X(10).
000123         16  PI-OE-REF-2-SUFF            PIC X.
000124
000125     12  PI-REM-TRM-CALC-OPTION          PIC X.
000126
000127     12  PI-LANGUAGE-TYPE                PIC X.
000128             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
000129             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
000130             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
000131
000132     12  PI-POLICY-LINKAGE-IND           PIC X.
000133         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
000134         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
000135                                                   LOW-VALUES.
000136
000137     12  PI-ALT-DMD-PRT-ID               PIC X(4).
000138     12  PI-CLAIM-PW-SESSION             PIC X(1).
000139         88  PI-CLAIM-CREDIT                 VALUE '1'.
000140         88  PI-CLAIM-CONVEN                 VALUE '2'.
000141
000142     12  PI-PROCESSOR-CSR-IND            PIC X.
000143         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
000144         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
000145
000146     12  FILLER                          PIC X(3).
000147
000148     12  PI-SYSTEM-LEVEL                 PIC X(145).
000149
000150     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
000151         PI-SYSTEM-LEVEL.
000152
000153         16  PI-ENTRY-CODES.
000154             20  PI-ENTRY-CD-1           PIC X.
000155             20  PI-ENTRY-CD-2           PIC X.
000156
000157         16  PI-RETURN-CODES.
000158             20  PI-RETURN-CD-1          PIC X.
000159             20  PI-RETURN-CD-2          PIC X.
000160
000161         16  PI-UPDATE-STATUS-SAVE.
000162             20  PI-UPDATE-BY            PIC X(4).
000163             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
000164
000165         16  PI-LOWER-CASE-LETTERS       PIC X.
000166             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
000167
000168*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
000169*            88  CLAIM-NO-UNIQUE             VALUE '1'.
000170*            88  CARRIER-CLM-CNTL            VALUE '2'.
000171
000172         16  PI-CERT-ACCESS-CONTROL      PIC X.
000173             88  ST-ACCNT-CNTL               VALUE ' '.
000174             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
000175             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
000176             88  ACCNT-CNTL                  VALUE '3'.
000177             88  CARR-ACCNT-CNTL             VALUE '4'.
000178
000179         16  PI-PROCESSOR-CAP-LIST.
000180             20  PI-SYSTEM-CONTROLS.
000181                24 PI-SYSTEM-DISPLAY     PIC X.
000182                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
000183                24 PI-SYSTEM-MODIFY      PIC X.
000184                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
000185             20  FILLER                  PIC XX.
000186             20  PI-DISPLAY-CAP          PIC X.
000187                 88  DISPLAY-CAP             VALUE 'Y'.
000188             20  PI-MODIFY-CAP           PIC X.
000189                 88  MODIFY-CAP              VALUE 'Y'.
000190             20  PI-MSG-AT-LOGON-CAP     PIC X.
000191                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
000192             20  PI-FORCE-CAP            PIC X.
000193                 88  FORCE-CAP               VALUE 'Y'.
000194
000195         16  PI-PROGRAM-CONTROLS.
000196             20  PI-PGM-PRINT-OPT        PIC X.
000197             20  PI-PGM-FORMAT-OPT       PIC X.
000198             20  PI-PGM-PROCESS-OPT      PIC X.
000199             20  PI-PGM-TOTALS-OPT       PIC X.
000200
000201         16  PI-HELP-INTERFACE.
000202             20  PI-LAST-ERROR-NO        PIC X(4).
000203             20  PI-CURRENT-SCREEN-NO    PIC X(4).
000204
000205         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
000206             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
000207
000208         16  PI-CR-CONTROL-IN-PROGRESS.
000209             20  PI-CR-CARRIER           PIC X.
000210             20  PI-CR-GROUPING          PIC X(6).
000211             20  PI-CR-STATE             PIC XX.
000212             20  PI-CR-ACCOUNT           PIC X(10).
000213             20  PI-CR-FIN-RESP          PIC X(10).
000214             20  PI-CR-TYPE              PIC X.
000215
000216         16  PI-CR-BATCH-NUMBER          PIC X(6).
000217
000218         16  PI-CR-MONTH-END-DT          PIC XX.
000219
000220         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
000221             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
000222             88  PI-ZERO-CARRIER             VALUE '1'.
000223             88  PI-ZERO-GROUPING            VALUE '2'.
000224             88  PI-ZERO-CAR-GROUP           VALUE '3'.
000225
000226         16  PI-CARRIER-SECURITY         PIC X.
000227             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
000228
000229         16  PI-ACCOUNT-SECURITY         PIC X(10).
000230             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
000231             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
000232
000233         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
000234             20  PI-ACCESS-CODE          OCCURS 10 TIMES
000235                                         INDEXED BY PI-ACCESS-NDX
000236                                         PIC X.
000237
000238         16  PI-GA-BILLING-CONTROL       PIC X.
000239             88  PI-GA-BILLING               VALUE '1'.
000240
000241         16  PI-MAIL-PROCESSING          PIC X.
000242             88  PI-MAIL-YES                 VALUE 'Y'.
000243
000244         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
000245
000246         16  PI-AR-SYSTEM.
000247             20  PI-AR-PROCESSING-CNTL   PIC X.
000248                 88  PI-AR-PROCESSING        VALUE 'Y'.
000249             20  PI-AR-SUMMARY-CODE      PIC X(6).
000250             20  PI-AR-MONTH-END-DT      PIC XX.
000251
000252         16  PI-MP-SYSTEM.
000253             20  PI-MORTGAGE-USER            PIC X.
000254                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
000255                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
000256             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
000257                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
000258                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
000259                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
000260                 88  PI-MP-PROD-CNTL                 VALUE '3'.
000261                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
000262             20  PI-MP-MONTH-END-DT          PIC XX.
000263             20  PI-MP-REFERENCE-NO.
000264                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
000265                 24  PI-MP-REFERENCE-SFX     PIC XX.
000266
000267         16  PI-LABEL-CONTROL            PIC X(01).
000268             88  PI-CREATE-LABELS                    VALUE 'Y'.
000269             88  PI-BYPASS-LABELS                    VALUE 'N'.
000270
000271         16  PI-BILL-GROUPING-CODE       PIC X(01).
000272             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
000273
000274         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
000275             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
000276             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
000277
000278         16  FILLER                      PIC X(14).
000279
000280     12  PI-PROGRAM-WORK-AREA            PIC X(640).
000281******************************************************************
      *<<((file: ELCINTF))
001166
001167     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
001168*    COPY ELC631PI.
      *>>((file: ELC631PI))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELC631PI                            *
000005*                            VMOD=2.012                          *
000006*                                                                *
000007*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
000008*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
000009*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
000010*                                                                *
000011*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
000012*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
000013*    BETWEEN PROGRAMS.                                           *
000014*                                                                *
000015*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
000016*                                                                *
000017*               EL631 - EL6311 - EL6312 - EL6313                 *
000018*                                                                *
000019******************************************************************
000020*                   C H A N G E   L O G
000021*
000022* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000023*-----------------------------------------------------------------
000024*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000025* EFFECTIVE    NUMBER
000026*-----------------------------------------------------------------
000027* 021414    2003053000001  PEMA  changes for auto chk request
000028*         CR2020061200002  TANA  ADD Cancel Reason Code
000029******************************************************************
000030
000031         16  PI-631-DATA.
000032             20  PI-ERPNDB-KEY.
000033                 24  PI-PB-COMPANY-CD     PIC X.
000034                 24  PI-PB-ENTRY-BATCH    PIC X(6).
000035                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
000036                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
000037
000038             20  PI-ERPNDB-ALT-KEY.
000039                 24  PI-PB-COMPANY-CD-A1  PIC X.
000040                 24  PI-PB-CARRIER        PIC X.
000041                 24  PI-PB-GROUPING       PIC X(6).
000042                 24  PI-PB-STATE          PIC XX.
000043                 24  PI-PB-ACCOUNT        PIC X(10).
000044                 24  PI-PB-CERT-EFF-DT    PIC XX.
000045                 24  PI-PB-CERT-NO.
000046                     28  PI-PB-CERT-PRIME PIC X(10).
000047                     28  PI-PB-CERT-SFX   PIC X.
000048                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
000049                 24  PI-PB-RECORD-TYPE    PIC X.
000050
000051             20  PI-ERPNDB-CSR-KEY.
000052                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
000053                 24  PI-PB-CSR-ID             PIC X(4).
000054                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
000055                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
000056                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
000057
000058             20  PI-BROWSE-TYPE               PIC X.
000059                 88  PI-FILE-BROWSE             VALUE ' '.
000060                 88  PI-PRIMARY-BROWSE          VALUE '1'.
000061                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
000062                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
000063                 88  PI-CSR-BROWSE              VALUE '4'.
000064
000065             20  PI-MAINT-FUNCTION            PIC X.
000066                 88  PI-ADD-FUNCTION            VALUE 'A'.
000067                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
000068                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
000069                 88  PI-DELETE-FUNCTION         VALUE 'D'.
000070                 88  PI-SHOW-FUNCTION           VALUE 'S'.
000071                 88  PI-PF5-FUNCTION            VALUE '5'.
000072                 88  PI-PF6-FUNCTION            VALUE '6'.
000073
000074             20  PI-FILE-SWITCHES.
000075                 24  PI-ALL-ISSUES-SW         PIC X.
000076                     88  ALL-ISSUES             VALUE 'Y'.
000077                 24  PI-ALL-CANCELS-SW        PIC X.
000078                     88  ALL-CANCELS            VALUE 'Y'.
000079                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
000080                     88  ISSUES-IN-ERROR        VALUE 'Y'.
000081                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
000082                     88  CANCEL-IN-ERROR        VALUE 'Y'.
000083                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
000084                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
000085                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
000086                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
000087                 24  PI-HOLD-REC-SW           PIC X.
000088                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
000089                 24  PI-CHANGE-REC-SW         PIC X.
000090                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
000091                 24  PI-CHK-REQ-REC-SW        PIC X.
000092                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
000093                 24  PI-ISSUE-WARNING-SW      PIC X.
000094                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
000095                 24  PI-CANCEL-WARNING-SW     PIC X.
000096                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
000097             20  PI-DISPLAY-SCREEN-SW         PIC X.
000098                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
000099             20  PI-ORIGINAL-BATCH-SW         PIC X.
000100                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
000101
000102             20  PI-MAP-NAME                  PIC X(8).
000103
000104             20  PI-CURSOR                    PIC S9(4) COMP.
000105
000106             20  PI-PREV-ALT-KEY              PIC X(36).
000107             20  PI-PREV-CSR-KEY              PIC X(15).
000108             20  PI-PREV-KEY.
000109                 24  PI-PREV-COMPANY-CD       PIC X.
000110                 24  PI-PREV-BATCH            PIC X(6).
000111                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
000112                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
000113             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
000114             20  PI-BROWSE-SW                 PIC X.
000115                 88  PI-GOOD-BROWSE             VALUE 'Y'.
000116                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
000117             20  PI-SV-CARRIER                PIC X.
000118             20  PI-SV-GROUPING               PIC X(6).
000119             20  PI-SV-STATE                  PIC XX.
000120             20  PI-EDIT-SW                   PIC X.
000121             20  PI-DISPLAY-SW                PIC XX.
000122                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
000123                 88 PI-DISPLAY-AH          VALUE 'AH'.
000124             20  PI-CRITERIA-DATA             PIC X(350).
000125             20  PI-BMODE                     PIC X.
000126             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
000127             20  PI-BPMTS                     PIC S999     COMP-3.
000128             20  PI-BTYPE                     PIC XXX OCCURS 2.
000129             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
000130             20  PI-CSR-SESSION-SW            PIC X.
000131                 88  CSR-EDIT-SESSION           VALUE 'Y'.
000132             20  PI-ERRORS-SW                 PIC X.
000133                 88  FATAL-ERRORS               VALUE 'X'.
000134*                88  FATAL-OR-UNFORCED          VALUE 'X'.
000135             20  pi-unforced-sw               pic x.
000136                 88  unforced-errors            value 'X'.
000137             20  PI-CANCEL-REASON-631         PIC X.
000138             20  FILLER                       PIC X(3).
000139
      *<<((file: ELC631PI))
001169        16  pi-6311-fatal-ctr    pic s999 comp-3.
001170        16  FILLER             PIC X(92).
001171
001172 01  W-LETTER-COMMUNICATION-AREAS.
001173*    COPY ELC1042.
      *>>((file: ELC1042))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                           ELC1042                              *
000005*                            VMOD=2.002                          *
000006*                                                                *
000007*    NOTE                                                        *
000008*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
000009*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
000010*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
000011*        TO THESE PROGRAMS.                                      *
000012*                                                                *
000013*    NOTE                                                        *
000014*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
000015*        USE ONLY!                                               *
000016*                                                                *
000017******************************************************************
000018
000019         16  PI-1042-WA.
000020             20  PI-ACTION       PIC  X(01).
000021                 88 PI-SHOW-MODE           VALUE '1'.
000022                 88 PI-CLEAR-MODE          VALUE '2'.
000023                 88 PI-CREATE-MODE         VALUE '3'.
000024             20  PI-COMM-CONTROL PIC  X(12).
000025             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
000026             20  PI-EOF-SW       PIC  X(01).
000027                 88  PI-FILE-EOF           VALUE 'Y'.
000028             20  PI-FILETYP      PIC  X(01).
000029             20  PI-FORM-SQUEEZE-CONTROL
000030                                 PIC  X(01).
000031                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
000032                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
000033             20  PI-LAST-CONTROL PIC  X(12).
000034             20  PI-TEMP-STOR-ITEMS
000035                                 PIC S9(04) COMP.
000036             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
000037             20  PI-UPDATE-SW    PIC  9(01).
000038                 88 ANY-UPDATES            VALUE 1.
000039             20  PI-104-SCREEN-SENT-IND
000040                                 PIC  X(01).
000041                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
000042                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
000043             20  PI-1042-SCREEN-SENT-IND
000044                                 PIC  X(01).
000045                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
000046                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
000047             20  PI-1042-ARCHIVE-IND
000048                                 PIC  X(01).
000049                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
000050             20  FILLER          PIC  X(29).
      *<<((file: ELC1042))
001174*    COPY ELC689PI.
      *>>((file: ELC689PI))
000001******************************************************************
000002*                                                                *
000003*                            ELC689PI                            *
000004*                            VMOD=2.003                          *
000005*                                                                *
000006*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
000007*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
000008*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
000009*                                                                *
000010*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
000011*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
000012*    BETWEEN PROGRAMS.                                           *
000013*                                                                *
000014*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
000015*                                                                *
000016*               EL631 - EL689  - EL6891 - EL6892                 *
000017*                                                                *
000018******************************************************************
000019*                   C H A N G E   L O G
000020*
000021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000022*-----------------------------------------------------------------
000023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000024* EFFECTIVE    NUMBER
000025*-----------------------------------------------------------------
000026* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
000027* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
000028* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
000029******************************************************************
000030
000031
000032         16  PI-689-WORK-AREA.
000033             20  PI-689-ALT-PRINTER-ID
000034                                 PIC  X(04).
000035             20  PI-689-ARCHIVE-NUMBER
000036                                 PIC  9(08).
000037             20  PI-689-ARCHIVE-SW
000038                                 PIC  X(01).
000039                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
000040             20  PI-689-DATA-SOURCE
000041                                 PIC  X(01).
000042                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
000043                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
000044                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
000045                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
000046                 88  PI-689-SRC-CHECKS         VALUE '5'.
000047             20  PI-689-ERROR-IND
000048                                 PIC  X(01).
000049                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
000050             20  PI-689-ERROR    PIC  9(04).
000051                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
000052                 88  PI-689-FATAL-ERROR
000053                     VALUES 0004 0006 0008 0013 0023 0029 0033
000054                            0042 0047 0051 0066 0067 0070
000055                            0168 0169 0174 0175 0176 0177 0179
000056                            0180 0181 0182 0184 0185 0189 0190
000057                            0191
000058                            0215 0279 0280
000059                            0412 0413 0454
000060                            0533 0537
000061                            2055 2114 2208 2209 2216 2232 2369
000062                            2398 2433 2908 2999
000063                            3000 3770 3771 3775
000064                            7250 7365 7367 7368 7369 7370 7371
000065                            7272 7373 7374 7376 7377 7378 7379
000066                            7381 7388 7390 7393 7395 7396 7398
000067                            9095 9096 9281 9298 9299 9320 9327
000068                            9426 9427.
000069                 88  PI-689-STOP-ERROR
000070                     VALUES 0004 0008 0013 0023 0029 0033
000071                            0042 0047 0066 0067 0070
000072                            0168 0169 0174 0175 0176 0177
000073                            0181 0182 0184 0185 0189 0190
000074                            0279 0280
000075                            0412 0413 0454
000076                            2055 2208 2209 2216 2232
000077                            2398 2999
000078                            3000 3770 3771 3775
000079                            7250 7365 7369 7370 7371
000080                            7272 7373 7374 7376 7377 7378 7379
000081                            7381 7388 7390 7393 7396 7398
000082                            9095 9096 9299 9320 9426.
000083             20  PI-689-FOLLOW-UP-DATE
000084                                 PIC  X(02).
000085             20  PI-689-FORM-NUMBER
000086                                 PIC  X(04).
000087             20  PI-689-LABEL-SOURCE
000088                                 PIC X(01).
000089                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
000090                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
000091                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
000092                 88  PI-689-SOURCE-COMP     VALUE '4'.
000093                 88  PI-689-SOURCE-MAIL     VALUE '5'.
000094                 88  PI-689-SOURCE-CHECK    VALUE '6'.
000095                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
000096             20  PI-689-NUMBER-COPIES
000097                                 PIC  9(01).
000098             20  PI-689-NUMBER-LABEL-LINES
000099                                 PIC  9(01).
000100             20  PI-689-NUMBER-TEXT-RECORDS
000101                                 PIC  9(03).
000102             20  PI-689-PRINT-ORDER-SW
000103                                 PIC  X(01).
000104                 88  PI-689-PRINT-FIRST     VALUE '1'.
000105                 88  PI-689-PRINT-SECOND    VALUE '2'.
000106                 88  PI-689-PRINT-LATER     VALUE '3'.
000107                 88  PI-689-PRINT-ONLY      VALUE '4'.
000108             20  PI-689-PRINT-RESTRICTION
000109                                 PIC  X(01).
000110                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
000111                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
000112                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
000113             20  PI-689-PRINT-SW PIC  X(01).
000114                 88  PI-689-PRINT-PERFORMED VALUE '1'.
000115             20  PI-689-RESEND-DATE-1
000116                                 PIC  X(02).
000117             20  PI-689-RESEND-LETR-1
000118                                 PIC X(4).
000119             20  PI-689-TEMP-STOR-ID
000120                                 PIC  X(08).
000121             20  PI-689-USE-SCREEN-IND
000122                                 PIC  X(01).
000123                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
000124             20  PI-689-ARCH-POINTER
000125                                 PIC S9(08) COMP.
000126                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
000127             20  PI-689-ARCT-POINTER
000128                                 PIC S9(08) COMP.
000129                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
000130             20  PI-689-VARIABLE-DATA-GRP.
000131                 24  PI-689-VARIABLE-DATA-1
000132                                 PIC  X(30).
000133                 24  PI-689-VARIABLE-DATA-2
000134                                 PIC  X(30).
000135                 24  PI-689-VARIABLE-DATA-3
000136                                 PIC  X(30).
000137                 24  PI-689-VARIABLE-DATA-4
000138                                 PIC  X(30).
000139
000140         16  PI-689-KEY-DATA-FIELDS.
000141             20  PI-689-ACCOUNT  PIC  X(10).
000142             20  PI-689-CARRIER  PIC  X(01).
000143             20  PI-689-CERT-NO.
000144                 24  PI-689-CERT-PRIME
000145                                 PIC  X(10).
000146                 24  PI-689-CERT-SFX
000147                                 PIC  X(01).
000148             20  PI-689-CHG-SEQ-NO
000149                                 PIC S9(04)    COMP.
000150             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
000151                                 PIC  X(02).
000152             20  PI-689-ENTRY-BATCH
000153                                 PIC  X(06).
000154             20  PI-689-EFF-DATE PIC  X(02).
000155             20  PI-689-EXP-DATE PIC  X(02).
000156             20  PI-689-GROUPING PIC  X(06).
000157             20  PI-689-RESP-PERSON
000158                                 PIC  X(10).
000159             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
000160             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
000161                                 PIC  X(04).
000162             20  PI-689-STATE    PIC  X(02).
000163             20  PI-689-TYPE     PIC  X(01).
000164             20  PI-689-CONTROL  PIC S9(08)    COMP.
000165             20  PI-689-ALT-SEQ-NO
000166                                 PIC S9(04)    COMP.
000167         16  PI-689-DATE-EDIT    PIC  X(08).
000168         16  PI-689-FOLLOW-UP-EDIT
000169                                 PIC  X(08).
000170         16  PI-689-RESEND1-EDIT PIC  X(08).
000171         16  PI-689-SEQ-EDIT     PIC  X(08).
000172         16  PI-689-BCSEQ-EDIT   PIC  X(04).
000173         16  PI-689-LBL-OVERRIDE PIC  X(01).
000174             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
000175         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
000176         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
      *<<((file: ELC689PI))
001175     EJECT
001176
001177 01  WS-EL6315-PASS-AREA.
001178        16  PI-6315-ISS-CAN-SW      PIC X.
001179        16  FILLER                  PIC X(120).
001180        16  PI-RES-REF-CLM-TYPE     PIC X.
001181        16  FILLER                  PIC X.
001182        16  PI-6315-PASS-AREA.
001183            20 FILLER               PIC X(236).
001184            20 PI-6315-FINALIZED    PIC X.
001185            20 FILLER               PIC X(280).
001186
001187 01  WS-EL6316-PASS-AREA.
001188        16  PI-ISS-CAN-SW           PIC X.
001189        16  FILLER                  PIC X(121).
001190        16  PI-CLM-RESC-IND         PIC X.
001191        16  PI-6316-PASS-AREA.
001192            20 FILLER               PIC X(236).
001193            20 PI-6316-FINALIZED    PIC X.
001194            20 FILLER               PIC X(280).
001195
001196******************************************************************
001197*                                                                *
001198*         P A S S   A R E A   F O R   E D I T                    *
001199*                                                                *
001200******************************************************************
001201
001202 01  PASSED-RECORD.
001203     12  RECORD-SAVE                  PIC X(585).
001204* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
001206*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
      *                    BY  WK-CURRENT-DATE.
      *>>((file: ELC50W1))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                             ELC50W1                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.004                          *
000007*                                                                *
000008*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
000009*                                                                *
000010*                                                                *
000011******************************************************************
000012
000013     12  WK-WORK-AREA.
000014         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
000015         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
000016         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
000017         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
000018         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
000019         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
000020         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
000021         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
000022         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
000023         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
000024         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
000025         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
000026         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
000027         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
000028         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
000029         16  WK-CREDIT-EDIT-CONTROLS.
000030             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
000031             20  WK-MIN-AGE           PIC 99  VALUE 00.
000032             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
000033             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
000034             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
000035             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
000036         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
000037         16  WK-SAVE-REIN-DATA.
000038             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
000039             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
000040             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
000041         16  WK-ENTRY-SW              PIC X    VALUE ' '.
000042             88  ENTRY-FROM-EL6311       VALUE '6'.
000043         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
000044         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
000045     12  WK-RECORD-ADDRESSES.
000046         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
000047         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
000048         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
000049         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
000050         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
000051         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
000052         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
000053         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
000054     12  WK-OVER-SHORT-AREA.
000055         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
000056         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
000057         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
000058             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
000059         16  FILLER                   PIC X(5) VALUE SPACES.
      *<<((file: ELC50W1))
001207     EJECT
001208
001209*    COPY ELCEDITC.
      *>>((file: ELCEDITC))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCEDITC                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.012                          *
000007*                                                                *
000008*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
000009*                     EL6313, EL050 AND EL517.                   *
000010*                                                                *
000011******************************************************************
000012******************************************************************
000013*                   C H A N G E   L O G
000014*
000015* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000016*-----------------------------------------------------------------
000017*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000018* EFFECTIVE    NUMBER
000019*-----------------------------------------------------------------
000020* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
000021******************************************************************
000022
000023     12  EDIT-CRITERIA-DATA.
000024         16  EC-CO-MONTH-END-DT       PIC XX.
000025         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
000026         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
000027         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
000028         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
000029         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
000030         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
000031         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
000032         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
000033         16  EC-CO-REM-TERM-CALC      PIC X.
000034               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
000035               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
000036               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
000037               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
000038
000039         16  EC-BR-LF-EARNINGS-CALC    PIC X.
000040               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
000041               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
000042               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
000043               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
000044               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
000045               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
000046               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
000047               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
000048               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
000049               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
000050
000051         16  EC-BR-AH-EARNINGS-CALC    PIC X.
000052               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
000053               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
000054               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
000055               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
000056               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
000057               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
000058               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
000059               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
000060
000061         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
000062                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
000063                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
000064
000065         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
000066                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
000067                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
000068                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
000069                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
000070                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
000071                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
000072                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
000073                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
000074
000075         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
000076               88  EC-BR-REDUCING                   VALUE 'R'.
000077               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
000078
000079         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
000080         16  EC-BR-LF-DESC             PIC X(10).
000081         16  EC-BR-AH-DESC             PIC X(10).
000082         16  EC-BR-LF-COMMENT          PIC X(10).
000083         16  EC-BR-AH-COMMENT          PIC X(10).
000084
000085         16  EC-BR-LF-REM-TERM-CALC    PIC X.
000086               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
000087               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
000088               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
000089               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
000090
000091         16  EC-BR-AH-REM-TERM-CALC    PIC X.
000092               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
000093               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
000094               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
000095               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
000096
000097         16  EC-BR-LF-REFUND-CALC      PIC X.
000098                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
000099                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
000100                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
000101                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
000102                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
000103                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
000104                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
000105
000106         16  EC-BR-AH-REFUND-CALC      PIC X.
000107                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
000108                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
000109                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
000110                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
000111                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
000112                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
000113                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
000114                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
000115
000116         16  EC-BR-LF-BEN-I-G-CD       PIC X.
000117                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
000118                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
000119                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
000120
000121         16  EC-BR-AH-BEN-I-G-CD       PIC X.
000122                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
000123                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
000124                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
000125
000126         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
000127         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
000128         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
000129         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
000130
000131         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
000132         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
000133                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
000134                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
000135                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
000136                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
000137
000138         16  EC-ST-LF-REM-TERM-CALC    PIC X.
000139               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
000140               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
000141               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
000142               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
000143               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
000144
000145         16  EC-ST-AH-REM-TERM-CALC    PIC X.
000146               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
000147               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
000148               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
000149               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
000150               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
000151
000152         16  EC-ST-LF-REFUND-CALC      PIC X.
000153                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
000154                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
000155                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
000156                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
000157                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
000158                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
000159                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
000160                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
000161
000162         16  EC-ST-AH-REFUND-CALC      PIC X.
000163                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
000164                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
000165                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
000166                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
000167                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
000168                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
000169                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
000170                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
000171
000172         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
000173         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
000174         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
000175         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
000176         16  EC-AM-EXPIRATION-DT       PIC XX.
000177         16  EC-AM-EFFECTIVE-DT        PIC XX.
000178         16  EC-AM-CLASS-CD            PIC XX.
000179         16  EC-AM-LF-DEVIATION        PIC XXX.
000180         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
000181         16  EC-AM-AH-DEVIATION        PIC XXX.
000182         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
000183         16  EC-AM-PHONE-NO            PIC X(10).
000184
000185         16  EC-AM-LF-REFUND-CALC      PIC X.
000186                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
000187                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
000188                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
000189                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
000190                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
000191                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
000192                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
000193
000194         16  EC-AM-AH-REFUND-CALC      PIC X.
000195                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
000196                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
000197                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
000198                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
000199                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
000200                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
000201                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
000202
000203         16  EC-AM-BEN-I-G-CD          PIC X.
000204                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
000205                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
000206                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
000207
000208         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
000209         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
000210         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
000211         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
000212         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
000213         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
000214         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
000215         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
000216         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
000217
000218         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
000219         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
000220         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
000221         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
000222         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
000223         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
000224         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
000225         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
000226         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
000227         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
000228         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
000229         16  EC-RT-LF-NSP-ST           PIC XX.
000230         16  EC-RT-AH-NSP-ST           PIC XX.
000231         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
000232         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
000233
000234         16  EC-CM-LF-PRIOR-STATUS     PIC X.
000235             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
000236                                             'M' '5' '9' '2'.
000237             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
000238             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
000239             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
000240             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
000241             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
000242             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
000243             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
000244             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
000245             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
000246             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
000247
000248         16  EC-CM-AH-PRIOR-STATUS     PIC X.
000249             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
000250                                             'M' '5' '9' '2'.
000251             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
000252             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
000253             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
000254             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
000255             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
000256             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
000257             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
000258             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
000259             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
000260             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
000261
000262         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
000263         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
000264         16  EC-CM-LF-CANCEL-DT        PIC XX.
000265         16  EC-CM-AH-CANCEL-DT        PIC XX.
000266         16  EC-CM-DEATH-DT            PIC XX.
000267
000268*DMD CUSTOM CODING FIELDS BELOW
000269*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
000270         16  EC-BR-DMD-RATING-SW       PIC X.
000271                 88  EC-DMD-AH-RATING            VALUE 'Y'.
000272                 88  EC-DMD-LF-RATING            VALUE 'Y'.
000273                 88  NO-DMD-RATING               VALUE 'N'.
000274
000275         16  EC-NEW-CERT               PIC X(11).
000276         16  EC-NEW-STATE              PIC XX.
000277         16  FILLER                    PIC X.
000278*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
000279         16  OVER-SHORT-EDIT-FIELDS.
000280             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
000281             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
000282             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
000283             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
000284             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
000285             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
000286             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
000287             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
000288             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
000289         16  FILLER                    PIC X(71).
      *<<((file: ELCEDITC))
001210
001211******************************************************************
001212
001213     EJECT
001214
001215*    COPY ELCJPFX.
      *>>((file: ELCJPFX))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCJPFX.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.002                          *
000007*                                                                *
000008*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
000009*                                                                *
000010*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
000011*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
000012*        ELCNTL - CONTROL FILE                                   *
000013*        ELMSTR - CLAIM MASTERS                                  *
000014*        ELTRLR - ACTIVITY TRAILERS                              *
000015*        ELCHKQ - CHECK QUE                                      *
000016******************************************************************
000017 01  JOURNAL-RECORD.
000018     12  jp-date                     pic s9(5) comp-3.
000019     12  jp-time                     pic s9(7) comp-3.
000020     12  JP-USER-ID                  PIC X(4).
000021     12  JP-FILE-ID                  PIC X(8).
000022     12  JP-PROGRAM-ID               PIC X(8).
000023     12  JP-RECORD-TYPE              PIC X.
000024         88 JP-ADD              VALUE 'A'.
000025         88 JP-BEFORE-CHANGE    VALUE 'B'.
000026         88 JP-AFTER-CHANGE     VALUE 'C'.
000027         88 JP-DELETE           VALUE 'D'.
000028         88 JP-GENERIC-DELETE   VALUE 'G'.
000029         88 JP-KEY-CHG-DELETE   VALUE 'K'.
000030         88 JP-KEY-CHG-ADD      VALUE 'N'.
000031     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
000032     12  JP-RECORD-AREA
000033
000034
      *<<((file: ELCJPFX))
001216                             PIC X(825).
001217     EJECT
001218*    COPY ELCAID.
      *>>((file: ELCAID))
000001******************************************************************
000002*                                                                *
000003*                            ELCAID.                             *
000004*                            VMOD=2.001                          *
000005*                                                                *
000006*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
000007*                                                                *
000008*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
000009*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
000010******************************************************************
000011
000012 01  DFHAID.
000013   02  DFHNULL   PIC  X  VALUE  ' '.
000014   02  DFHENTER  PIC  X  VALUE  QUOTE.
000015   02  DFHCLEAR  PIC  X  VALUE  '_'.
000016   02  DFHPEN    PIC  X  VALUE  '='.
000017   02  DFHOPID   PIC  X  VALUE  'W'.
000018   02  DFHPA1    PIC  X  VALUE  '%'.
000019   02  DFHPA2    PIC  X  VALUE  '>'.
000020   02  DFHPA3    PIC  X  VALUE  ','.
000021   02  DFHPF1    PIC  X  VALUE  '1'.
000022   02  DFHPF2    PIC  X  VALUE  '2'.
000023   02  DFHPF3    PIC  X  VALUE  '3'.
000024   02  DFHPF4    PIC  X  VALUE  '4'.
000025   02  DFHPF5    PIC  X  VALUE  '5'.
000026   02  DFHPF6    PIC  X  VALUE  '6'.
000027   02  DFHPF7    PIC  X  VALUE  '7'.
000028   02  DFHPF8    PIC  X  VALUE  '8'.
000029   02  DFHPF9    PIC  X  VALUE  '9'.
000030   02  DFHPF10   PIC  X  VALUE  ':'.
000031   02  DFHPF11   PIC  X  VALUE  '#'.
000032   02  DFHPF12   PIC  X  VALUE  '@'.
000033   02  DFHPF13   PIC  X  VALUE  'A'.
000034   02  DFHPF14   PIC  X  VALUE  'B'.
000035   02  DFHPF15   PIC  X  VALUE  'C'.
000036   02  DFHPF16   PIC  X  VALUE  'D'.
000037   02  DFHPF17   PIC  X  VALUE  'E'.
000038   02  DFHPF18   PIC  X  VALUE  'F'.
000039   02  DFHPF19   PIC  X  VALUE  'G'.
000040   02  DFHPF20   PIC  X  VALUE  'H'.
000041   02  DFHPF21   PIC  X  VALUE  'I'.
000042*00039    02  DFHPF22   PIC  X  VALUE  ''.
000043   02  DFHPF22   PIC  X  VALUE  '['.
000044   02  DFHPF23   PIC  X  VALUE  '.'.
000045   02  DFHPF24   PIC  X  VALUE  '<'.
000046   02  DFHMSRE   PIC  X  VALUE  'X'.
000047   02  DFHSTRF   PIC  X  VALUE  'h'.
000048   02  DFHTRIG   PIC  X  VALUE  '"'.
      *<<((file: ELCAID))
001219
001220 01  FILLER    REDEFINES DFHAID.
001221     12  FILLER              PIC X(8).
001222     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
001223
001224     EJECT
001225*    COPY EL6311S.
      *>>((file: EL6311S))
000001 01  EL631BI.
000002     05  FILLER            PIC  X(0012).
000003*    -------------------------------
000004     05  BDATEL PIC S9(0004) COMP.
000005     05  BDATEF PIC  X(0001).
000006     05  FILLER REDEFINES BDATEF.
000007         10  BDATEA PIC  X(0001).
000008     05  BDATEI PIC  X(0008).
000009*    -------------------------------
000010     05  BTIMEL PIC S9(0004) COMP.
000011     05  BTIMEF PIC  X(0001).
000012     05  FILLER REDEFINES BTIMEF.
000013         10  BTIMEA PIC  X(0001).
000014     05  BTIMEI PIC  X(0005).
000015*    -------------------------------
000016     05  BHEADL PIC S9(0004) COMP.
000017     05  BHEADF PIC  X(0001).
000018     05  FILLER REDEFINES BHEADF.
000019         10  BHEADA PIC  X(0001).
000020     05  BHEADI PIC  X(0038).
000021*    -------------------------------
000022     05  BNCERTLL PIC S9(0004) COMP.
000023     05  BNCERTLF PIC  X(0001).
000024     05  FILLER REDEFINES BNCERTLF.
000025         10  BNCERTLA PIC  X(0001).
000026     05  BNCERTLI PIC  X(0008).
000027*    -------------------------------
000028     05  BNCERTL PIC S9(0004) COMP.
000029     05  BNCERTF PIC  X(0001).
000030     05  FILLER REDEFINES BNCERTF.
000031         10  BNCERTA PIC  X(0001).
000032     05  BNCERTI PIC  X(0011).
000033*    -------------------------------
000034     05  BNSTATLL PIC S9(0004) COMP.
000035     05  BNSTATLF PIC  X(0001).
000036     05  FILLER REDEFINES BNSTATLF.
000037         10  BNSTATLA PIC  X(0001).
000038     05  BNSTATLI PIC  X(0009).
000039*    -------------------------------
000040     05  BNSTATL PIC S9(0004) COMP.
000041     05  BNSTATF PIC  X(0001).
000042     05  FILLER REDEFINES BNSTATF.
000043         10  BNSTATA PIC  X(0001).
000044     05  BNSTATI PIC  X(0002).
000045*    -------------------------------
000046     05  BCHGTL PIC S9(0004) COMP.
000047     05  BCHGTF PIC  X(0001).
000048     05  FILLER REDEFINES BCHGTF.
000049         10  BCHGTA PIC  X(0001).
000050     05  BCHGTI PIC  X(0004).
000051*    -------------------------------
000052     05  BCHGL PIC S9(0004) COMP.
000053     05  BCHGF PIC  X(0001).
000054     05  FILLER REDEFINES BCHGF.
000055         10  BCHGA PIC  X(0001).
000056     05  BCHGI PIC  X(0004).
000057*    -------------------------------
000058     05  BCOMPIDL PIC S9(0004) COMP.
000059     05  BCOMPIDF PIC  X(0001).
000060     05  FILLER REDEFINES BCOMPIDF.
000061         10  BCOMPIDA PIC  X(0001).
000062     05  BCOMPIDI PIC  X(0003).
000063*    -------------------------------
000064     05  BREGIONL PIC S9(0004) COMP.
000065     05  BREGIONF PIC  X(0001).
000066     05  FILLER REDEFINES BREGIONF.
000067         10  BREGIONA PIC  X(0001).
000068     05  BREGIONI PIC  X(0006).
000069*    -------------------------------
000070     05  BUSERL PIC S9(0004) COMP.
000071     05  BUSERF PIC  X(0001).
000072     05  FILLER REDEFINES BUSERF.
000073         10  BUSERA PIC  X(0001).
000074     05  BUSERI PIC  X(0004).
000075*    -------------------------------
000076     05  BMAINTL PIC S9(0004) COMP.
000077     05  BMAINTF PIC  X(0001).
000078     05  FILLER REDEFINES BMAINTF.
000079         10  BMAINTA PIC  X(0001).
000080     05  BMAINTI PIC  X(0001).
000081*    -------------------------------
000082     05  BMANTBYL PIC S9(0004) COMP.
000083     05  BMANTBYF PIC  X(0001).
000084     05  FILLER REDEFINES BMANTBYF.
000085         10  BMANTBYA PIC  X(0001).
000086     05  BMANTBYI PIC  X(0004).
000087*    -------------------------------
000088     05  BCHGHDGL PIC S9(0004) COMP.
000089     05  BCHGHDGF PIC  X(0001).
000090     05  FILLER REDEFINES BCHGHDGF.
000091         10  BCHGHDGA PIC  X(0001).
000092     05  BCHGHDGI PIC  X(0003).
000093*    -------------------------------
000094     05  BMANTDTL PIC S9(0004) COMP.
000095     05  BMANTDTF PIC  X(0001).
000096     05  FILLER REDEFINES BMANTDTF.
000097         10  BMANTDTA PIC  X(0001).
000098     05  BMANTDTI PIC  X(0008).
000099*    -------------------------------
000100     05  BMANTATL PIC S9(0004) COMP.
000101     05  BMANTATF PIC  X(0001).
000102     05  FILLER REDEFINES BMANTATF.
000103         10  BMANTATA PIC  X(0001).
000104     05  BMANTATI PIC  X(0005).
000105*    -------------------------------
000106     05  BCSRL PIC S9(0004) COMP.
000107     05  BCSRF PIC  X(0001).
000108     05  FILLER REDEFINES BCSRF.
000109         10  BCSRA PIC  X(0001).
000110     05  BCSRI PIC  X(0004).
000111*    -------------------------------
000112     05  BBATCHL PIC S9(0004) COMP.
000113     05  BBATCHF PIC  X(0001).
000114     05  FILLER REDEFINES BBATCHF.
000115         10  BBATCHA PIC  X(0001).
000116     05  BBATCHI PIC  X(0006).
000117*    -------------------------------
000118     05  BSEQL PIC S9(0004) COMP.
000119     05  BSEQF PIC  X(0001).
000120     05  FILLER REDEFINES BSEQF.
000121         10  BSEQA PIC  X(0001).
000122     05  BSEQI PIC  X(0004).
000123*    -------------------------------
000124     05  BMOENDTL PIC S9(0004) COMP.
000125     05  BMOENDTF PIC  X(0001).
000126     05  FILLER REDEFINES BMOENDTF.
000127         10  BMOENDTA PIC  X(0001).
000128     05  BMOENDTI PIC  X(0008).
000129*    -------------------------------
000130     05  BCARRL PIC S9(0004) COMP.
000131     05  BCARRF PIC  X(0001).
000132     05  FILLER REDEFINES BCARRF.
000133         10  BCARRA PIC  X(0001).
000134     05  BCARRI PIC  X(0001).
000135*    -------------------------------
000136     05  BGROUPL PIC S9(0004) COMP.
000137     05  BGROUPF PIC  X(0001).
000138     05  FILLER REDEFINES BGROUPF.
000139         10  BGROUPA PIC  X(0001).
000140     05  BGROUPI PIC  X(0006).
000141*    -------------------------------
000142     05  BSTATEL PIC S9(0004) COMP.
000143     05  BSTATEF PIC  X(0001).
000144     05  FILLER REDEFINES BSTATEF.
000145         10  BSTATEA PIC  X(0001).
000146     05  BSTATEI PIC  X(0002).
000147*    -------------------------------
000148     05  BACCTL PIC S9(0004) COMP.
000149     05  BACCTF PIC  X(0001).
000150     05  FILLER REDEFINES BACCTF.
000151         10  BACCTA PIC  X(0001).
000152     05  BACCTI PIC  X(0010).
000153*    -------------------------------
000154     05  BVINHL PIC S9(0004) COMP.
000155     05  BVINHF PIC  X(0001).
000156     05  FILLER REDEFINES BVINHF.
000157         10  BVINHA PIC  X(0001).
000158     05  BVINHI PIC  X(0004).
000159*    -------------------------------
000160     05  BVINL PIC S9(0004) COMP.
000161     05  BVINF PIC  X(0001).
000162     05  FILLER REDEFINES BVINF.
000163         10  BVINA PIC  X(0001).
000164     05  BVINI PIC  X(0017).
000165*    -------------------------------
000166     05  BREFHDGL PIC S9(0004) COMP.
000167     05  BREFHDGF PIC  X(0001).
000168     05  FILLER REDEFINES BREFHDGF.
000169         10  BREFHDGA PIC  X(0001).
000170     05  BREFHDGI PIC  X(0004).
000171*    -------------------------------
000172     05  BREFL PIC S9(0004) COMP.
000173     05  BREFF PIC  X(0001).
000174     05  FILLER REDEFINES BREFF.
000175         10  BREFA PIC  X(0001).
000176     05  BREFI PIC  X(0012).
000177*    -------------------------------
000178     05  LETRREQL PIC S9(0004) COMP.
000179     05  LETRREQF PIC  X(0001).
000180     05  FILLER REDEFINES LETRREQF.
000181         10  LETRREQA PIC  X(0001).
000182     05  LETRREQI PIC  X(0001).
000183*    -------------------------------
000184     05  BAGEDEFL PIC S9(0004) COMP.
000185     05  BAGEDEFF PIC  X(0001).
000186     05  FILLER REDEFINES BAGEDEFF.
000187         10  BAGEDEFA PIC  X(0001).
000188     05  BAGEDEFI PIC  X(0004).
000189*    -------------------------------
000190     05  BCERTNOL PIC S9(0004) COMP.
000191     05  BCERTNOF PIC  X(0001).
000192     05  FILLER REDEFINES BCERTNOF.
000193         10  BCERTNOA PIC  X(0001).
000194     05  BCERTNOI PIC  X(0010).
000195*    -------------------------------
000196     05  BSUFIXL PIC S9(0004) COMP.
000197     05  BSUFIXF PIC  X(0001).
000198     05  FILLER REDEFINES BSUFIXF.
000199         10  BSUFIXA PIC  X(0001).
000200     05  BSUFIXI PIC  X(0001).
000201*    -------------------------------
000202     05  BEFFDTL PIC S9(0004) COMP.
000203     05  BEFFDTF PIC  X(0001).
000204     05  FILLER REDEFINES BEFFDTF.
000205         10  BEFFDTA PIC  X(0001).
000206     05  BEFFDTI PIC  X(0008).
000207*    -------------------------------
000208     05  BLSTNML PIC S9(0004) COMP.
000209     05  BLSTNMF PIC  X(0001).
000210     05  FILLER REDEFINES BLSTNMF.
000211         10  BLSTNMA PIC  X(0001).
000212     05  BLSTNMI PIC  X(0015).
000213*    -------------------------------
000214     05  B1STNML PIC S9(0004) COMP.
000215     05  B1STNMF PIC  X(0001).
000216     05  FILLER REDEFINES B1STNMF.
000217         10  B1STNMA PIC  X(0001).
000218     05  B1STNMI PIC  X(0010).
000219*    -------------------------------
000220     05  BINITL PIC S9(0004) COMP.
000221     05  BINITF PIC  X(0001).
000222     05  FILLER REDEFINES BINITF.
000223         10  BINITA PIC  X(0001).
000224     05  BINITI PIC  X(0001).
000225*    -------------------------------
000226     05  BSEXL PIC S9(0004) COMP.
000227     05  BSEXF PIC  X(0001).
000228     05  FILLER REDEFINES BSEXF.
000229         10  BSEXA PIC  X(0001).
000230     05  BSEXI PIC  X(0001).
000231*    -------------------------------
000232     05  BAGEL PIC S9(0004) COMP.
000233     05  BAGEF PIC  X(0001).
000234     05  FILLER REDEFINES BAGEF.
000235         10  BAGEA PIC  X(0001).
000236     05  BAGEI PIC  X(0002).
000237*    -------------------------------
000238     05  BBIRTHL PIC S9(0004) COMP.
000239     05  BBIRTHF PIC  X(0001).
000240     05  FILLER REDEFINES BBIRTHF.
000241         10  BBIRTHA PIC  X(0001).
000242     05  BBIRTHI PIC  X(0008).
000243*    -------------------------------
000244     05  B1STPMTL PIC S9(0004) COMP.
000245     05  B1STPMTF PIC  X(0001).
000246     05  FILLER REDEFINES B1STPMTF.
000247         10  B1STPMTA PIC  X(0001).
000248     05  B1STPMTI PIC  X(0008).
000249*    -------------------------------
000250     05  BDAYSL PIC S9(0004) COMP.
000251     05  BDAYSF PIC  X(0001).
000252     05  FILLER REDEFINES BDAYSF.
000253         10  BDAYSA PIC  X(0001).
000254     05  BDAYSI PIC  X(0003).
000255*    -------------------------------
000256     05  BLNTRML PIC S9(0004) COMP.
000257     05  BLNTRMF PIC  X(0001).
000258     05  FILLER REDEFINES BLNTRMF.
000259         10  BLNTRMA PIC  X(0001).
000260     05  BLNTRMI PIC  X(0003).
000261*    -------------------------------
000262     05  BLNOFCRL PIC S9(0004) COMP.
000263     05  BLNOFCRF PIC  X(0001).
000264     05  FILLER REDEFINES BLNOFCRF.
000265         10  BLNOFCRA PIC  X(0001).
000266     05  BLNOFCRI PIC  X(0005).
000267*    -------------------------------
000268     05  BMODEL PIC S9(0004) COMP.
000269     05  BMODEF PIC  X(0001).
000270     05  FILLER REDEFINES BMODEF.
000271         10  BMODEA PIC  X(0001).
000272     05  BMODEI PIC  X(0001).
000273*    -------------------------------
000274     05  BFREQL PIC S9(0004) COMP.
000275     05  BFREQF PIC  X(0001).
000276     05  FILLER REDEFINES BFREQF.
000277         10  BFREQA PIC  X(0001).
000278     05  BFREQI PIC  X(0002).
000279*    -------------------------------
000280     05  BPMTSL PIC S9(0004) COMP.
000281     05  BPMTSF PIC  X(0001).
000282     05  FILLER REDEFINES BPMTSF.
000283         10  BPMTSA PIC  X(0001).
000284     05  BPMTSI PIC  999.
000285*    -------------------------------
000286     05  BPMTAMTL PIC S9(0004) COMP.
000287     05  BPMTAMTF PIC  X(0001).
000288     05  FILLER REDEFINES BPMTAMTF.
000289         10  BPMTAMTA PIC  X(0001).
000290     05  BPMTAMTI PIC  9(7)V99.
000291*    -------------------------------
000292     05  BAPRL PIC S9(0004) COMP.
000293     05  BAPRF PIC  X(0001).
000294     05  FILLER REDEFINES BAPRF.
000295         10  BAPRA PIC  X(0001).
000296     05  BAPRI PIC  X(7).
000297*    -------------------------------
000298     05  BLIVESL PIC S9(0004) COMP.
000299     05  BLIVESF PIC  X(0001).
000300     05  FILLER REDEFINES BLIVESF.
000301         10  BLIVESA PIC  X(0001).
000302     05  BLIVESI PIC  X(0009).
000303*    -------------------------------
000304     05  BMEMCAPL PIC S9(0004) COMP.
000305     05  BMEMCAPF PIC  X(0001).
000306     05  FILLER REDEFINES BMEMCAPF.
000307         10  BMEMCAPA PIC  X(0001).
000308     05  BMEMCAPI PIC  X(0011).
000309*    -------------------------------
000310     05  BORIGHDL PIC S9(0004) COMP.
000311     05  BORIGHDF PIC  X(0001).
000312     05  FILLER REDEFINES BORIGHDF.
000313         10  BORIGHDA PIC  X(0001).
000314     05  BORIGHDI PIC  X(0009).
000315*    -------------------------------
000316     05  DMDBILL PIC S9(0004) COMP.
000317     05  DMDBILF PIC  X(0001).
000318     05  FILLER REDEFINES DMDBILF.
000319         10  DMDBILA PIC  X(0001).
000320     05  DMDBILI PIC  X(0006).
000321*    -------------------------------
000322     05  BFORCEL PIC S9(0004) COMP.
000323     05  BFORCEF PIC  X(0001).
000324     05  FILLER REDEFINES BFORCEF.
000325         10  BFORCEA PIC  X(0001).
000326     05  BFORCEI PIC  X(0001).
000327*    -------------------------------
000328     05  BENTRYL PIC S9(0004) COMP.
000329     05  BENTRYF PIC  X(0001).
000330     05  FILLER REDEFINES BENTRYF.
000331         10  BENTRYA PIC  X(0001).
000332     05  BENTRYI PIC  X(0001).
000333*    -------------------------------
000334     05  BREINL PIC S9(0004) COMP.
000335     05  BREINF PIC  X(0001).
000336     05  FILLER REDEFINES BREINF.
000337         10  BREINA PIC  X(0001).
000338     05  BREINI PIC  X(0001).
000339*    -------------------------------
000340     05  BBILCDL PIC S9(0004) COMP.
000341     05  BBILCDF PIC  X(0001).
000342     05  FILLER REDEFINES BBILCDF.
000343         10  BBILCDA PIC  X(0001).
000344     05  BBILCDI PIC  X(0001).
000345*    -------------------------------
000346     05  BUNWRITL PIC S9(0004) COMP.
000347     05  BUNWRITF PIC  X(0001).
000348     05  FILLER REDEFINES BUNWRITF.
000349         10  BUNWRITA PIC  X(0001).
000350     05  BUNWRITI PIC  X(0001).
000351*    -------------------------------
000352     05  BSKPCDL PIC S9(0004) COMP.
000353     05  BSKPCDF PIC  X(0001).
000354     05  FILLER REDEFINES BSKPCDF.
000355         10  BSKPCDA PIC  X(0001).
000356     05  BSKPCDI PIC  X(0001).
000357*    -------------------------------
000358     05  BINDGRPL PIC S9(0004) COMP.
000359     05  BINDGRPF PIC  X(0001).
000360     05  FILLER REDEFINES BINDGRPF.
000361         10  BINDGRPA PIC  X(0001).
000362     05  BINDGRPI PIC  X(0001).
000363*    -------------------------------
000364     05  BSIGL PIC S9(0004) COMP.
000365     05  BSIGF PIC  X(0001).
000366     05  FILLER REDEFINES BSIGF.
000367         10  BSIGA PIC  X(0001).
000368     05  BSIGI PIC  X(0001).
000369*    -------------------------------
000370     05  BRTCLSL PIC S9(0004) COMP.
000371     05  BRTCLSF PIC  X(0001).
000372     05  FILLER REDEFINES BRTCLSF.
000373         10  BRTCLSA PIC  X(0001).
000374     05  BRTCLSI PIC  X(0002).
000375*    -------------------------------
000376     05  BCHGCNTL PIC S9(0004) COMP.
000377     05  BCHGCNTF PIC  X(0001).
000378     05  FILLER REDEFINES BCHGCNTF.
000379         10  BCHGCNTA PIC  X(0001).
000380     05  BCHGCNTI PIC  X(0003).
000381*    -------------------------------
000382     05  BMEMBERL PIC S9(0004) COMP.
000383     05  BMEMBERF PIC  X(0001).
000384     05  FILLER REDEFINES BMEMBERF.
000385         10  BMEMBERA PIC  X(0001).
000386     05  BMEMBERI PIC  X(0012).
000387*    -------------------------------
000388     05  BORGNOL PIC S9(0004) COMP.
000389     05  BORGNOF PIC  X(0001).
000390     05  FILLER REDEFINES BORGNOF.
000391         10  BORGNOA PIC  X(0001).
000392     05  BORGNOI PIC  X(0006).
000393*    -------------------------------
000394     05  BORGSEQL PIC S9(0004) COMP.
000395     05  BORGSEQF PIC  X(0001).
000396     05  FILLER REDEFINES BORGSEQF.
000397         10  BORGSEQA PIC  X(0001).
000398     05  BORGSEQI PIC  X(0004).
000399*    -------------------------------
000400     05  BBILLEDL PIC S9(0004) COMP.
000401     05  BBILLEDF PIC  X(0001).
000402     05  FILLER REDEFINES BBILLEDF.
000403         10  BBILLEDA PIC  X(0001).
000404     05  BBILLEDI PIC  9(9).
000405*    -------------------------------
000406     05  BKIND1L PIC S9(0004) COMP.
000407     05  BKIND1F PIC  X(0001).
000408     05  FILLER REDEFINES BKIND1F.
000409         10  BKIND1A PIC  X(0001).
000410     05  BKIND1I PIC  X(0002).
000411*    -------------------------------
000412     05  BTYPE1L PIC S9(0004) COMP.
000413     05  BTYPE1F PIC  X(0001).
000414     05  FILLER REDEFINES BTYPE1F.
000415         10  BTYPE1A PIC  X(0001).
000416     05  BTYPE1I PIC  X(0003).
000417*    -------------------------------
000418     05  BTERM1L PIC S9(0004) COMP.
000419     05  BTERM1F PIC  X(0001).
000420     05  FILLER REDEFINES BTERM1F.
000421         10  BTERM1A PIC  X(0001).
000422     05  BTERM1I PIC  X(0003).
000423*    -------------------------------
000424     05  BBEN1L PIC S9(0004) COMP.
000425     05  BBEN1F PIC  X(0001).
000426     05  FILLER REDEFINES BBEN1F.
000427         10  BBEN1A PIC  X(0001).
000428     05  BBEN1I PIC  X(0012).
000429*    -------------------------------
000430     05  BPREM1L PIC S9(0004) COMP.
000431     05  BPREM1F PIC  X(0001).
000432     05  FILLER REDEFINES BPREM1F.
000433         10  BPREM1A PIC  X(0001).
000434     05  BPREM1I PIC  X(0011).
000435*    -------------------------------
000436     05  BEXPIR1L PIC S9(0004) COMP.
000437     05  BEXPIR1F PIC  X(0001).
000438     05  FILLER REDEFINES BEXPIR1F.
000439         10  BEXPIR1A PIC  X(0001).
000440     05  BEXPIR1I PIC  X(0008).
000441*    -------------------------------
000442     05  BCP1L PIC S9(0004) COMP.
000443     05  BCP1F PIC  X(0001).
000444     05  FILLER REDEFINES BCP1F.
000445         10  BCP1A PIC  X(0001).
000446     05  BCP1I PIC  X(0002).
000447*    -------------------------------
000448     05  BALTBN1L PIC S9(0004) COMP.
000449     05  BALTBN1F PIC  X(0001).
000450     05  FILLER REDEFINES BALTBN1F.
000451         10  BALTBN1A PIC  X(0001).
000452     05  BALTBN1I PIC  X(0012).
000453*    -------------------------------
000454     05  BALTPR1L PIC S9(0004) COMP.
000455     05  BALTPR1F PIC  X(0001).
000456     05  FILLER REDEFINES BALTPR1F.
000457         10  BALTPR1A PIC  X(0001).
000458     05  BALTPR1I PIC  X(0011).
000459*    -------------------------------
000460     05  BBNCD1L PIC S9(0004) COMP.
000461     05  BBNCD1F PIC  X(0001).
000462     05  FILLER REDEFINES BBNCD1F.
000463         10  BBNCD1A PIC  X(0001).
000464     05  BBNCD1I PIC  X(0003).
000465*    -------------------------------
000466     05  BCPRM1L PIC S9(0004) COMP.
000467     05  BCPRM1F PIC  X(0001).
000468     05  FILLER REDEFINES BCPRM1F.
000469         10  BCPRM1A PIC  X(0001).
000470     05  BCPRM1I PIC  X(0011).
000471*    -------------------------------
000472     05  BCAPRM1L PIC S9(0004) COMP.
000473     05  BCAPRM1F PIC  X(0001).
000474     05  FILLER REDEFINES BCAPRM1F.
000475         10  BCAPRM1A PIC  X(0001).
000476     05  BCAPRM1I PIC  X(0011).
000477*    -------------------------------
000478     05  BENABR1L PIC S9(0004) COMP.
000479     05  BENABR1F PIC  X(0001).
000480     05  FILLER REDEFINES BENABR1F.
000481         10  BENABR1A PIC  X(0001).
000482     05  BENABR1I PIC  X(0005).
000483*    -------------------------------
000484     05  BDIFF1L PIC S9(0004) COMP.
000485     05  BDIFF1F PIC  X(0001).
000486     05  FILLER REDEFINES BDIFF1F.
000487         10  BDIFF1A PIC  X(0001).
000488     05  BDIFF1I PIC  X(0011).
000489*    -------------------------------
000490     05  BBILIT1L PIC S9(0004) COMP.
000491     05  BBILIT1F PIC  X(0001).
000492     05  FILLER REDEFINES BBILIT1F.
000493         10  BBILIT1A PIC  X(0001).
000494     05  BBILIT1I PIC  X(0008).
000495*    -------------------------------
000496     05  BADIFF1L PIC S9(0004) COMP.
000497     05  BADIFF1F PIC  X(0001).
000498     05  FILLER REDEFINES BADIFF1F.
000499         10  BADIFF1A PIC  X(0001).
000500     05  BADIFF1I PIC  X(0011).
000501*    -------------------------------
000502     05  BKIND2L PIC S9(0004) COMP.
000503     05  BKIND2F PIC  X(0001).
000504     05  FILLER REDEFINES BKIND2F.
000505         10  BKIND2A PIC  X(0001).
000506     05  BKIND2I PIC  X(0002).
000507*    -------------------------------
000508     05  BTYPE2L PIC S9(0004) COMP.
000509     05  BTYPE2F PIC  X(0001).
000510     05  FILLER REDEFINES BTYPE2F.
000511         10  BTYPE2A PIC  X(0001).
000512     05  BTYPE2I PIC  X(0003).
000513*    -------------------------------
000514     05  BTERM2L PIC S9(0004) COMP.
000515     05  BTERM2F PIC  X(0001).
000516     05  FILLER REDEFINES BTERM2F.
000517         10  BTERM2A PIC  X(0001).
000518     05  BTERM2I PIC  X(0003).
000519*    -------------------------------
000520     05  BBEN2L PIC S9(0004) COMP.
000521     05  BBEN2F PIC  X(0001).
000522     05  FILLER REDEFINES BBEN2F.
000523         10  BBEN2A PIC  X(0001).
000524     05  BBEN2I PIC  X(0012).
000525*    -------------------------------
000526     05  BPREM2L PIC S9(0004) COMP.
000527     05  BPREM2F PIC  X(0001).
000528     05  FILLER REDEFINES BPREM2F.
000529         10  BPREM2A PIC  X(0001).
000530     05  BPREM2I PIC  X(0011).
000531*    -------------------------------
000532     05  BEXPIR2L PIC S9(0004) COMP.
000533     05  BEXPIR2F PIC  X(0001).
000534     05  FILLER REDEFINES BEXPIR2F.
000535         10  BEXPIR2A PIC  X(0001).
000536     05  BEXPIR2I PIC  X(0008).
000537*    -------------------------------
000538     05  BCP2L PIC S9(0004) COMP.
000539     05  BCP2F PIC  X(0001).
000540     05  FILLER REDEFINES BCP2F.
000541         10  BCP2A PIC  X(0001).
000542     05  BCP2I PIC  X(0002).
000543*    -------------------------------
000544     05  BALTBN2L PIC S9(0004) COMP.
000545     05  BALTBN2F PIC  X(0001).
000546     05  FILLER REDEFINES BALTBN2F.
000547         10  BALTBN2A PIC  X(0001).
000548     05  BALTBN2I PIC  X(0012).
000549*    -------------------------------
000550     05  BALTPR2L PIC S9(0004) COMP.
000551     05  BALTPR2F PIC  X(0001).
000552     05  FILLER REDEFINES BALTPR2F.
000553         10  BALTPR2A PIC  X(0001).
000554     05  BALTPR2I PIC  X(0011).
000555*    -------------------------------
000556     05  BBNCD2L PIC S9(0004) COMP.
000557     05  BBNCD2F PIC  X(0001).
000558     05  FILLER REDEFINES BBNCD2F.
000559         10  BBNCD2A PIC  X(0001).
000560     05  BBNCD2I PIC  X(0003).
000561*    -------------------------------
000562     05  BCPRM2L PIC S9(0004) COMP.
000563     05  BCPRM2F PIC  X(0001).
000564     05  FILLER REDEFINES BCPRM2F.
000565         10  BCPRM2A PIC  X(0001).
000566     05  BCPRM2I PIC  X(0011).
000567*    -------------------------------
000568     05  BCAPRM2L PIC S9(0004) COMP.
000569     05  BCAPRM2F PIC  X(0001).
000570     05  FILLER REDEFINES BCAPRM2F.
000571         10  BCAPRM2A PIC  X(0001).
000572     05  BCAPRM2I PIC  X(0011).
000573*    -------------------------------
000574     05  BENABR2L PIC S9(0004) COMP.
000575     05  BENABR2F PIC  X(0001).
000576     05  FILLER REDEFINES BENABR2F.
000577         10  BENABR2A PIC  X(0001).
000578     05  BENABR2I PIC  X(0005).
000579*    -------------------------------
000580     05  BDIFF2L PIC S9(0004) COMP.
000581     05  BDIFF2F PIC  X(0001).
000582     05  FILLER REDEFINES BDIFF2F.
000583         10  BDIFF2A PIC  X(0001).
000584     05  BDIFF2I PIC  X(0011).
000585*    -------------------------------
000586     05  BBILIT2L PIC S9(0004) COMP.
000587     05  BBILIT2F PIC  X(0001).
000588     05  FILLER REDEFINES BBILIT2F.
000589         10  BBILIT2A PIC  X(0001).
000590     05  BBILIT2I PIC  X(0008).
000591*    -------------------------------
000592     05  BADIFF2L PIC S9(0004) COMP.
000593     05  BADIFF2F PIC  X(0001).
000594     05  FILLER REDEFINES BADIFF2F.
000595         10  BADIFF2A PIC  X(0001).
000596     05  BADIFF2I PIC  X(0011).
000597*    -------------------------------
000598     05  BERMSG1L PIC S9(0004) COMP.
000599     05  BERMSG1F PIC  X(0001).
000600     05  FILLER REDEFINES BERMSG1F.
000601         10  BERMSG1A PIC  X(0001).
000602     05  BERMSG1I PIC  X(0078).
000603*    -------------------------------
000604     05  BERMSG2L PIC S9(0004) COMP.
000605     05  BERMSG2F PIC  X(0001).
000606     05  FILLER REDEFINES BERMSG2F.
000607         10  BERMSG2A PIC  X(0001).
000608     05  BERMSG2I PIC  X(0078).
000609*    -------------------------------
000610     05  BERMSG3L PIC S9(0004) COMP.
000611     05  BERMSG3F PIC  X(0001).
000612     05  FILLER REDEFINES BERMSG3F.
000613         10  BERMSG3A PIC  X(0001).
000614     05  BERMSG3I PIC  X(0078).
000615*    -------------------------------
000616     05  BPFENTRL PIC S9(0004) COMP.
000617     05  BPFENTRF PIC  X(0001).
000618     05  FILLER REDEFINES BPFENTRF.
000619         10  BPFENTRA PIC  X(0001).
000620     05  BPFENTRI PIC  9(2).
000621*    -------------------------------
000622     05  BPF5HDRL PIC S9(0004) COMP.
000623     05  BPF5HDRF PIC  X(0001).
000624     05  FILLER REDEFINES BPF5HDRF.
000625         10  BPF5HDRA PIC  X(0001).
000626     05  BPF5HDRI PIC  X(0005).
000627*    -------------------------------
000628     05  BPF4HDRL PIC S9(0004) COMP.
000629     05  BPF4HDRF PIC  X(0001).
000630     05  FILLER REDEFINES BPF4HDRF.
000631         10  BPF4HDRA PIC  X(0001).
000632     05  BPF4HDRI PIC  X(0013).
000633*    -------------------------------
000634     05  BF15HDRL PIC S9(0004) COMP.
000635     05  BF15HDRF PIC  X(0001).
000636     05  FILLER REDEFINES BF15HDRF.
000637         10  BF15HDRA PIC  X(0001).
000638     05  BF15HDRI PIC  X(0010).
000639 01  EL631BO REDEFINES EL631BI.
000640     05  FILLER            PIC  X(0012).
000641*    -------------------------------
000642     05  FILLER            PIC  X(0003).
000643     05  BDATEO PIC  X(0008).
000644*    -------------------------------
000645     05  FILLER            PIC  X(0003).
000646     05  BTIMEO PIC  99.99.
000647*    -------------------------------
000648     05  FILLER            PIC  X(0003).
000649     05  BHEADO PIC  X(0038).
000650*    -------------------------------
000651     05  FILLER            PIC  X(0003).
000652     05  BNCERTLO PIC  X(0008).
000653*    -------------------------------
000654     05  FILLER            PIC  X(0003).
000655     05  BNCERTO PIC  X(0011).
000656*    -------------------------------
000657     05  FILLER            PIC  X(0003).
000658     05  BNSTATLO PIC  X(0009).
000659*    -------------------------------
000660     05  FILLER            PIC  X(0003).
000661     05  BNSTATO PIC  X(0002).
000662*    -------------------------------
000663     05  FILLER            PIC  X(0003).
000664     05  BCHGTO PIC  X(0004).
000665*    -------------------------------
000666     05  FILLER            PIC  X(0003).
000667     05  BCHGO PIC  ZZZ9.
000668*    -------------------------------
000669     05  FILLER            PIC  X(0003).
000670     05  BCOMPIDO PIC  X(0003).
000671*    -------------------------------
000672     05  FILLER            PIC  X(0003).
000673     05  BREGIONO PIC  X(0006).
000674*    -------------------------------
000675     05  FILLER            PIC  X(0003).
000676     05  BUSERO PIC  X(0004).
000677*    -------------------------------
000678     05  FILLER            PIC  X(0003).
000679     05  BMAINTO PIC  X(0001).
000680*    -------------------------------
000681     05  FILLER            PIC  X(0003).
000682     05  BMANTBYO PIC  X(0004).
000683*    -------------------------------
000684     05  FILLER            PIC  X(0003).
000685     05  BCHGHDGO PIC  X(0003).
000686*    -------------------------------
000687     05  FILLER            PIC  X(0003).
000688     05  BMANTDTO PIC  X(0008).
000689*    -------------------------------
000690     05  FILLER            PIC  X(0003).
000691     05  BMANTATO PIC  99.99.
000692*    -------------------------------
000693     05  FILLER            PIC  X(0003).
000694     05  BCSRO PIC  X(0004).
000695*    -------------------------------
000696     05  FILLER            PIC  X(0003).
000697     05  BBATCHO PIC  X(0006).
000698*    -------------------------------
000699     05  FILLER            PIC  X(0003).
000700     05  BSEQO PIC  X(0004).
000701*    -------------------------------
000702     05  FILLER            PIC  X(0003).
000703     05  BMOENDTO PIC  X(0008).
000704*    -------------------------------
000705     05  FILLER            PIC  X(0003).
000706     05  BCARRO PIC  X(0001).
000707*    -------------------------------
000708     05  FILLER            PIC  X(0003).
000709     05  BGROUPO PIC  X(0006).
000710*    -------------------------------
000711     05  FILLER            PIC  X(0003).
000712     05  BSTATEO PIC  X(0002).
000713*    -------------------------------
000714     05  FILLER            PIC  X(0003).
000715     05  BACCTO PIC  X(0010).
000716*    -------------------------------
000717     05  FILLER            PIC  X(0003).
000718     05  BVINHO PIC  X(0004).
000719*    -------------------------------
000720     05  FILLER            PIC  X(0003).
000721     05  BVINO PIC  X(0017).
000722*    -------------------------------
000723     05  FILLER            PIC  X(0003).
000724     05  BREFHDGO PIC  X(0004).
000725*    -------------------------------
000726     05  FILLER            PIC  X(0003).
000727     05  BREFO PIC  X(0012).
000728*    -------------------------------
000729     05  FILLER            PIC  X(0003).
000730     05  LETRREQO PIC  X(0001).
000731*    -------------------------------
000732     05  FILLER            PIC  X(0003).
000733     05  BAGEDEFO PIC  X(0004).
000734*    -------------------------------
000735     05  FILLER            PIC  X(0003).
000736     05  BCERTNOO PIC  X(0010).
000737*    -------------------------------
000738     05  FILLER            PIC  X(0003).
000739     05  BSUFIXO PIC  X(0001).
000740*    -------------------------------
000741     05  FILLER            PIC  X(0003).
000742     05  BEFFDTO PIC  X(0008).
000743*    -------------------------------
000744     05  FILLER            PIC  X(0003).
000745     05  BLSTNMO PIC  X(0015).
000746*    -------------------------------
000747     05  FILLER            PIC  X(0003).
000748     05  B1STNMO PIC  X(0010).
000749*    -------------------------------
000750     05  FILLER            PIC  X(0003).
000751     05  BINITO PIC  X(0001).
000752*    -------------------------------
000753     05  FILLER            PIC  X(0003).
000754     05  BSEXO PIC  X(0001).
000755*    -------------------------------
000756     05  FILLER            PIC  X(0003).
000757     05  BAGEO PIC  X(0002).
000758*    -------------------------------
000759     05  FILLER            PIC  X(0003).
000760     05  BBIRTHO PIC  X(0008).
000761*    -------------------------------
000762     05  FILLER            PIC  X(0003).
000763     05  B1STPMTO PIC  X(0008).
000764*    -------------------------------
000765     05  FILLER            PIC  X(0003).
000766     05  BDAYSO PIC  X(0003).
000767*    -------------------------------
000768     05  FILLER            PIC  X(0003).
000769     05  BLNTRMO PIC  X(0003).
000770*    -------------------------------
000771     05  FILLER            PIC  X(0003).
000772     05  BLNOFCRO PIC  X(0005).
000773*    -------------------------------
000774     05  FILLER            PIC  X(0003).
000775     05  BMODEO PIC  X(0001).
000776*    -------------------------------
000777     05  FILLER            PIC  X(0003).
000778     05  BFREQO PIC  X(0002).
000779*    -------------------------------
000780     05  FILLER            PIC  X(0003).
000781     05  BPMTSO PIC  X(0003).
000782*    -------------------------------
000783     05  FILLER            PIC  X(0003).
000784     05  BPMTAMTO PIC  ZZZZZ9.99.
000785*    -------------------------------
000786     05  FILLER            PIC  X(0003).
000787     05  BAPRO PIC  99.9999.
000788*    -------------------------------
000789     05  FILLER            PIC  X(0003).
000790     05  BLIVESO PIC  Z,ZZZ,ZZZ.
000791*    -------------------------------
000792     05  FILLER            PIC  X(0003).
000793     05  BMEMCAPO PIC  X(0011).
000794*    -------------------------------
000795     05  FILLER            PIC  X(0003).
000796     05  BORIGHDO PIC  X(0009).
000797*    -------------------------------
000798     05  FILLER            PIC  X(0003).
000799     05  DMDBILO PIC  X(0006).
000800*    -------------------------------
000801     05  FILLER            PIC  X(0003).
000802     05  BFORCEO PIC  X(0001).
000803*    -------------------------------
000804     05  FILLER            PIC  X(0003).
000805     05  BENTRYO PIC  X(0001).
000806*    -------------------------------
000807     05  FILLER            PIC  X(0003).
000808     05  BREINO PIC  X(0001).
000809*    -------------------------------
000810     05  FILLER            PIC  X(0003).
000811     05  BBILCDO PIC  X(0001).
000812*    -------------------------------
000813     05  FILLER            PIC  X(0003).
000814     05  BUNWRITO PIC  X(0001).
000815*    -------------------------------
000816     05  FILLER            PIC  X(0003).
000817     05  BSKPCDO PIC  X(0001).
000818*    -------------------------------
000819     05  FILLER            PIC  X(0003).
000820     05  BINDGRPO PIC  X(0001).
000821*    -------------------------------
000822     05  FILLER            PIC  X(0003).
000823     05  BSIGO PIC  X(0001).
000824*    -------------------------------
000825     05  FILLER            PIC  X(0003).
000826     05  BRTCLSO PIC  X(0002).
000827*    -------------------------------
000828     05  FILLER            PIC  X(0003).
000829     05  BCHGCNTO PIC  X(0003).
000830*    -------------------------------
000831     05  FILLER            PIC  X(0003).
000832     05  BMEMBERO PIC  X(0012).
000833*    -------------------------------
000834     05  FILLER            PIC  X(0003).
000835     05  BORGNOO PIC  X(0006).
000836*    -------------------------------
000837     05  FILLER            PIC  X(0003).
000838     05  BORGSEQO PIC  X(0004).
000839*    -------------------------------
000840     05  FILLER            PIC  X(0003).
000841     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
000842*    -------------------------------
000843     05  FILLER            PIC  X(0003).
000844     05  BKIND1O PIC  X(0002).
000845*    -------------------------------
000846     05  FILLER            PIC  X(0003).
000847     05  BTYPE1O PIC  X(0003).
000848*    -------------------------------
000849     05  FILLER            PIC  X(0003).
000850     05  BTERM1O PIC  X(0003).
000851*    -------------------------------
000852     05  FILLER            PIC  X(0003).
000853     05  BBEN1O PIC  X(0012).
000854*    -------------------------------
000855     05  FILLER            PIC  X(0003).
000856     05  BPREM1O PIC  X(0011).
000857*    -------------------------------
000858     05  FILLER            PIC  X(0003).
000859     05  BEXPIR1O PIC  X(0008).
000860*    -------------------------------
000861     05  FILLER            PIC  X(0003).
000862     05  BCP1O PIC  X(0002).
000863*    -------------------------------
000864     05  FILLER            PIC  X(0003).
000865     05  BALTBN1O PIC  X(0012).
000866*    -------------------------------
000867     05  FILLER            PIC  X(0003).
000868     05  BALTPR1O PIC  X(0011).
000869*    -------------------------------
000870     05  FILLER            PIC  X(0003).
000871     05  BBNCD1O PIC  X(0003).
000872*    -------------------------------
000873     05  FILLER            PIC  X(0003).
000874     05  BCPRM1O PIC  X(0011).
000875*    -------------------------------
000876     05  FILLER            PIC  X(0003).
000877     05  BCAPRM1O PIC  X(0011).
000878*    -------------------------------
000879     05  FILLER            PIC  X(0003).
000880     05  BENABR1O PIC  X(0005).
000881*    -------------------------------
000882     05  FILLER            PIC  X(0003).
000883     05  BDIFF1O PIC  X(0011).
000884*    -------------------------------
000885     05  FILLER            PIC  X(0003).
000886     05  BBILIT1O PIC  X(0008).
000887*    -------------------------------
000888     05  FILLER            PIC  X(0003).
000889     05  BADIFF1O PIC  X(0011).
000890*    -------------------------------
000891     05  FILLER            PIC  X(0003).
000892     05  BKIND2O PIC  X(0002).
000893*    -------------------------------
000894     05  FILLER            PIC  X(0003).
000895     05  BTYPE2O PIC  X(0003).
000896*    -------------------------------
000897     05  FILLER            PIC  X(0003).
000898     05  BTERM2O PIC  X(0003).
000899*    -------------------------------
000900     05  FILLER            PIC  X(0003).
000901     05  BBEN2O PIC  X(0012).
000902*    -------------------------------
000903     05  FILLER            PIC  X(0003).
000904     05  BPREM2O PIC  X(0011).
000905*    -------------------------------
000906     05  FILLER            PIC  X(0003).
000907     05  BEXPIR2O PIC  X(0008).
000908*    -------------------------------
000909     05  FILLER            PIC  X(0003).
000910     05  BCP2O PIC  X(0002).
000911*    -------------------------------
000912     05  FILLER            PIC  X(0003).
000913     05  BALTBN2O PIC  X(0012).
000914*    -------------------------------
000915     05  FILLER            PIC  X(0003).
000916     05  BALTPR2O PIC  X(0011).
000917*    -------------------------------
000918     05  FILLER            PIC  X(0003).
000919     05  BBNCD2O PIC  X(0003).
000920*    -------------------------------
000921     05  FILLER            PIC  X(0003).
000922     05  BCPRM2O PIC  X(0011).
000923*    -------------------------------
000924     05  FILLER            PIC  X(0003).
000925     05  BCAPRM2O PIC  X(0011).
000926*    -------------------------------
000927     05  FILLER            PIC  X(0003).
000928     05  BENABR2O PIC  X(0005).
000929*    -------------------------------
000930     05  FILLER            PIC  X(0003).
000931     05  BDIFF2O PIC  X(0011).
000932*    -------------------------------
000933     05  FILLER            PIC  X(0003).
000934     05  BBILIT2O PIC  X(0008).
000935*    -------------------------------
000936     05  FILLER            PIC  X(0003).
000937     05  BADIFF2O PIC  X(0011).
000938*    -------------------------------
000939     05  FILLER            PIC  X(0003).
000940     05  BERMSG1O PIC  X(0078).
000941*    -------------------------------
000942     05  FILLER            PIC  X(0003).
000943     05  BERMSG2O PIC  X(0078).
000944*    -------------------------------
000945     05  FILLER            PIC  X(0003).
000946     05  BERMSG3O PIC  X(0078).
000947*    -------------------------------
000948     05  FILLER            PIC  X(0003).
000949     05  BPFENTRO PIC  X(0002).
000950*    -------------------------------
000951     05  FILLER            PIC  X(0003).
000952     05  BPF5HDRO PIC  X(0005).
000953*    -------------------------------
000954     05  FILLER            PIC  X(0003).
000955     05  BPF4HDRO PIC  X(0013).
000956*    -------------------------------
000957     05  FILLER            PIC  X(0003).
000958     05  BF15HDRO PIC  X(0010).
000959*    -------------------------------
000960 01  EL631CI REDEFINES EL631BI.
000961     05  FILLER            PIC  X(0012).
000962*    -------------------------------
000963     05  CDATEL PIC S9(0004) COMP.
000964     05  CDATEF PIC  X(0001).
000965     05  FILLER REDEFINES CDATEF.
000966         10  CDATEA PIC  X(0001).
000967     05  CDATEI PIC  X(0008).
000968*    -------------------------------
000969     05  CTIMEL PIC S9(0004) COMP.
000970     05  CTIMEF PIC  X(0001).
000971     05  FILLER REDEFINES CTIMEF.
000972         10  CTIMEA PIC  X(0001).
000973     05  CTIMEI PIC  X(0005).
000974*    -------------------------------
000975     05  CHEADL PIC S9(0004) COMP.
000976     05  CHEADF PIC  X(0001).
000977     05  FILLER REDEFINES CHEADF.
000978         10  CHEADA PIC  X(0001).
000979     05  CHEADI PIC  X(0038).
000980*    -------------------------------
000981     05  CCHGTL PIC S9(0004) COMP.
000982     05  CCHGTF PIC  X(0001).
000983     05  FILLER REDEFINES CCHGTF.
000984         10  CCHGTA PIC  X(0001).
000985     05  CCHGTI PIC  X(0004).
000986*    -------------------------------
000987     05  CCHGL PIC S9(0004) COMP.
000988     05  CCHGF PIC  X(0001).
000989     05  FILLER REDEFINES CCHGF.
000990         10  CCHGA PIC  X(0001).
000991     05  CCHGI PIC  X(0004).
000992*    -------------------------------
000993     05  CMAINTL PIC S9(0004) COMP.
000994     05  CMAINTF PIC  X(0001).
000995     05  FILLER REDEFINES CMAINTF.
000996         10  CMAINTA PIC  X(0001).
000997     05  CMAINTI PIC  X(0001).
000998*    -------------------------------
000999     05  CMANTBYL PIC S9(0004) COMP.
001000     05  CMANTBYF PIC  X(0001).
001001     05  FILLER REDEFINES CMANTBYF.
001002         10  CMANTBYA PIC  X(0001).
001003     05  CMANTBYI PIC  X(0004).
001004*    -------------------------------
001005     05  CCHGHDGL PIC S9(0004) COMP.
001006     05  CCHGHDGF PIC  X(0001).
001007     05  FILLER REDEFINES CCHGHDGF.
001008         10  CCHGHDGA PIC  X(0001).
001009     05  CCHGHDGI PIC  X(0003).
001010*    -------------------------------
001011     05  CMANTDTL PIC S9(0004) COMP.
001012     05  CMANTDTF PIC  X(0001).
001013     05  FILLER REDEFINES CMANTDTF.
001014         10  CMANTDTA PIC  X(0001).
001015     05  CMANTDTI PIC  X(0008).
001016*    -------------------------------
001017     05  CMANTATL PIC S9(0004) COMP.
001018     05  CMANTATF PIC  X(0001).
001019     05  FILLER REDEFINES CMANTATF.
001020         10  CMANTATA PIC  X(0001).
001021     05  CMANTATI PIC  X(0005).
001022*    -------------------------------
001023     05  CCSRL PIC S9(0004) COMP.
001024     05  CCSRF PIC  X(0001).
001025     05  FILLER REDEFINES CCSRF.
001026         10  CCSRA PIC  X(0001).
001027     05  CCSRI PIC  X(0004).
001028*    -------------------------------
001029     05  CBATCHL PIC S9(0004) COMP.
001030     05  CBATCHF PIC  X(0001).
001031     05  FILLER REDEFINES CBATCHF.
001032         10  CBATCHA PIC  X(0001).
001033     05  CBATCHI PIC  X(0006).
001034*    -------------------------------
001035     05  CSEQL PIC S9(0004) COMP.
001036     05  CSEQF PIC  X(0001).
001037     05  FILLER REDEFINES CSEQF.
001038         10  CSEQA PIC  X(0001).
001039     05  CSEQI PIC  X(0004).
001040*    -------------------------------
001041     05  CMOENDTL PIC S9(0004) COMP.
001042     05  CMOENDTF PIC  X(0001).
001043     05  FILLER REDEFINES CMOENDTF.
001044         10  CMOENDTA PIC  X(0001).
001045     05  CMOENDTI PIC  X(0008).
001046*    -------------------------------
001047     05  CCARRL PIC S9(0004) COMP.
001048     05  CCARRF PIC  X(0001).
001049     05  FILLER REDEFINES CCARRF.
001050         10  CCARRA PIC  X(0001).
001051     05  CCARRI PIC  X(0001).
001052*    -------------------------------
001053     05  CGROUPL PIC S9(0004) COMP.
001054     05  CGROUPF PIC  X(0001).
001055     05  FILLER REDEFINES CGROUPF.
001056         10  CGROUPA PIC  X(0001).
001057     05  CGROUPI PIC  X(0006).
001058*    -------------------------------
001059     05  CSTATEL PIC S9(0004) COMP.
001060     05  CSTATEF PIC  X(0001).
001061     05  FILLER REDEFINES CSTATEF.
001062         10  CSTATEA PIC  X(0001).
001063     05  CSTATEI PIC  X(0002).
001064*    -------------------------------
001065     05  CACCTL PIC S9(0004) COMP.
001066     05  CACCTF PIC  X(0001).
001067     05  FILLER REDEFINES CACCTF.
001068         10  CACCTA PIC  X(0001).
001069     05  CACCTI PIC  X(0010).
001070*    -------------------------------
001071     05  CORIGHDL PIC S9(0004) COMP.
001072     05  CORIGHDF PIC  X(0001).
001073     05  FILLER REDEFINES CORIGHDF.
001074         10  CORIGHDA PIC  X(0001).
001075     05  CORIGHDI PIC  X(0011).
001076*    -------------------------------
001077     05  CORGNOL PIC S9(0004) COMP.
001078     05  CORGNOF PIC  X(0001).
001079     05  FILLER REDEFINES CORGNOF.
001080         10  CORGNOA PIC  X(0001).
001081     05  CORGNOI PIC  X(0006).
001082*    -------------------------------
001083     05  CORGSEQL PIC S9(0004) COMP.
001084     05  CORGSEQF PIC  X(0001).
001085     05  FILLER REDEFINES CORGSEQF.
001086         10  CORGSEQA PIC  X(0001).
001087     05  CORGSEQI PIC  X(0004).
001088*    -------------------------------
001089     05  CREFHDGL PIC S9(0004) COMP.
001090     05  CREFHDGF PIC  X(0001).
001091     05  FILLER REDEFINES CREFHDGF.
001092         10  CREFHDGA PIC  X(0001).
001093     05  CREFHDGI PIC  X(0010).
001094*    -------------------------------
001095     05  CREFL PIC S9(0004) COMP.
001096     05  CREFF PIC  X(0001).
001097     05  FILLER REDEFINES CREFF.
001098         10  CREFA PIC  X(0001).
001099     05  CREFI PIC  X(0012).
001100*    -------------------------------
001101     05  CNHINTL PIC S9(0004) COMP.
001102     05  CNHINTF PIC  X(0001).
001103     05  FILLER REDEFINES CNHINTF.
001104         10  CNHINTA PIC  X(0001).
001105     05  CNHINTI PIC  9(7)V99.
001106*    -------------------------------
001107     05  CCERTNOL PIC S9(0004) COMP.
001108     05  CCERTNOF PIC  X(0001).
001109     05  FILLER REDEFINES CCERTNOF.
001110         10  CCERTNOA PIC  X(0001).
001111     05  CCERTNOI PIC  X(0010).
001112*    -------------------------------
001113     05  CSUFIXL PIC S9(0004) COMP.
001114     05  CSUFIXF PIC  X(0001).
001115     05  FILLER REDEFINES CSUFIXF.
001116         10  CSUFIXA PIC  X(0001).
001117     05  CSUFIXI PIC  X(0001).
001118*    -------------------------------
001119     05  CEFFDTL PIC S9(0004) COMP.
001120     05  CEFFDTF PIC  X(0001).
001121     05  FILLER REDEFINES CEFFDTF.
001122         10  CEFFDTA PIC  X(0001).
001123     05  CEFFDTI PIC  X(0008).
001124*    -------------------------------
001125     05  CLSTNML PIC S9(0004) COMP.
001126     05  CLSTNMF PIC  X(0001).
001127     05  FILLER REDEFINES CLSTNMF.
001128         10  CLSTNMA PIC  X(0001).
001129     05  CLSTNMI PIC  X(0015).
001130*    -------------------------------
001131     05  CINAMEL PIC S9(0004) COMP.
001132     05  CINAMEF PIC  X(0001).
001133     05  FILLER REDEFINES CINAMEF.
001134         10  CINAMEA PIC  X(0001).
001135     05  CINAMEI PIC  X(0015).
001136*    -------------------------------
001137     05  CINITSL PIC S9(0004) COMP.
001138     05  CINITSF PIC  X(0001).
001139     05  FILLER REDEFINES CINITSF.
001140         10  CINITSA PIC  X(0001).
001141     05  CINITSI PIC  X(0010).
001142*    -------------------------------
001143     05  CCANREAL PIC S9(0004) COMP.
001144     05  CCANREAF PIC  X(0001).
001145     05  FILLER REDEFINES CCANREAF.
001146         10  CCANREAA PIC  X(0001).
001147     05  CCANREAI PIC  X(0001).
001148*    -------------------------------
001149     05  ACTSPCL PIC S9(0004) COMP.
001150     05  ACTSPCF PIC  X(0001).
001151     05  FILLER REDEFINES ACTSPCF.
001152         10  ACTSPCA PIC  X(0001).
001153     05  ACTSPCI PIC  X(0001).
001154*    -------------------------------
001155     05  CKIND1L PIC S9(0004) COMP.
001156     05  CKIND1F PIC  X(0001).
001157     05  FILLER REDEFINES CKIND1F.
001158         10  CKIND1A PIC  X(0001).
001159     05  CKIND1I PIC  X(0002).
001160*    -------------------------------
001161     05  CCANDT1L PIC S9(0004) COMP.
001162     05  CCANDT1F PIC  X(0001).
001163     05  FILLER REDEFINES CCANDT1F.
001164         10  CCANDT1A PIC  X(0001).
001165     05  CCANDT1I PIC  X(0008).
001166*    -------------------------------
001167     05  CREFND1L PIC S9(0004) COMP.
001168     05  CREFND1F PIC  X(0001).
001169     05  FILLER REDEFINES CREFND1F.
001170         10  CREFND1A PIC  X(0001).
001171     05  CREFND1I PIC  S9(9)V99.
001172*    -------------------------------
001173     05  CMTHD1L PIC S9(0004) COMP.
001174     05  CMTHD1F PIC  X(0001).
001175     05  FILLER REDEFINES CMTHD1F.
001176         10  CMTHD1A PIC  X(0001).
001177     05  CMTHD1I PIC  X(0001).
001178*    -------------------------------
001179     05  CKIND2L PIC S9(0004) COMP.
001180     05  CKIND2F PIC  X(0001).
001181     05  FILLER REDEFINES CKIND2F.
001182         10  CKIND2A PIC  X(0001).
001183     05  CKIND2I PIC  X(0002).
001184*    -------------------------------
001185     05  CCANDT2L PIC S9(0004) COMP.
001186     05  CCANDT2F PIC  X(0001).
001187     05  FILLER REDEFINES CCANDT2F.
001188         10  CCANDT2A PIC  X(0001).
001189     05  CCANDT2I PIC  X(0008).
001190*    -------------------------------
001191     05  CREFND2L PIC S9(0004) COMP.
001192     05  CREFND2F PIC  X(0001).
001193     05  FILLER REDEFINES CREFND2F.
001194         10  CREFND2A PIC  X(0001).
001195     05  CREFND2I PIC  S9(9)V99.
001196*    -------------------------------
001197     05  CMTHD2L PIC S9(0004) COMP.
001198     05  CMTHD2F PIC  X(0001).
001199     05  FILLER REDEFINES CMTHD2F.
001200         10  CMTHD2A PIC  X(0001).
001201     05  CMTHD2I PIC  X(0001).
001202*    -------------------------------
001203     05  CLIVESL PIC S9(0004) COMP.
001204     05  CLIVESF PIC  X(0001).
001205     05  FILLER REDEFINES CLIVESF.
001206         10  CLIVESA PIC  X(0001).
001207     05  CLIVESI PIC  X(0003).
001208*    -------------------------------
001209     05  CFORCEL PIC S9(0004) COMP.
001210     05  CFORCEF PIC  X(0001).
001211     05  FILLER REDEFINES CFORCEF.
001212         10  CFORCEA PIC  X(0001).
001213     05  CFORCEI PIC  X(0001).
001214*    -------------------------------
001215     05  CBILCDL PIC S9(0004) COMP.
001216     05  CBILCDF PIC  X(0001).
001217     05  FILLER REDEFINES CBILCDF.
001218         10  CBILCDA PIC  X(0001).
001219     05  CBILCDI PIC  X(0001).
001220*    -------------------------------
001221     05  CCRFND1L PIC S9(0004) COMP.
001222     05  CCRFND1F PIC  X(0001).
001223     05  FILLER REDEFINES CCRFND1F.
001224         10  CCRFND1A PIC  X(0001).
001225     05  CCRFND1I PIC  X(0011).
001226*    -------------------------------
001227     05  CCRFND2L PIC S9(0004) COMP.
001228     05  CCRFND2F PIC  X(0001).
001229     05  FILLER REDEFINES CCRFND2F.
001230         10  CCRFND2A PIC  X(0001).
001231     05  CCRFND2I PIC  X(0011).
001232*    -------------------------------
001233     05  CBILIT1L PIC S9(0004) COMP.
001234     05  CBILIT1F PIC  X(0001).
001235     05  FILLER REDEFINES CBILIT1F.
001236         10  CBILIT1A PIC  X(0001).
001237     05  CBILIT1I PIC  X(0008).
001238*    -------------------------------
001239     05  CDRFND1L PIC S9(0004) COMP.
001240     05  CDRFND1F PIC  X(0001).
001241     05  FILLER REDEFINES CDRFND1F.
001242         10  CDRFND1A PIC  X(0001).
001243     05  CDRFND1I PIC  X(0011).
001244*    -------------------------------
001245     05  CBILIT2L PIC S9(0004) COMP.
001246     05  CBILIT2F PIC  X(0001).
001247     05  FILLER REDEFINES CBILIT2F.
001248         10  CBILIT2A PIC  X(0001).
001249     05  CBILIT2I PIC  X(0008).
001250*    -------------------------------
001251     05  CDRFND2L PIC S9(0004) COMP.
001252     05  CDRFND2F PIC  X(0001).
001253     05  FILLER REDEFINES CDRFND2F.
001254         10  CDRFND2A PIC  X(0001).
001255     05  CDRFND2I PIC  X(0011).
001256*    -------------------------------
001257     05  CCANTXTL PIC S9(0004) COMP.
001258     05  CCANTXTF PIC  X(0001).
001259     05  FILLER REDEFINES CCANTXTF.
001260         10  CCANTXTA PIC  X(0001).
001261     05  CCANTXTI PIC  X(0005).
001262*    -------------------------------
001263     05  CCANFEEL PIC S9(0004) COMP.
001264     05  CCANFEEF PIC  X(0001).
001265     05  FILLER REDEFINES CCANFEEF.
001266         10  CCANFEEA PIC  X(0001).
001267     05  CCANFEEI PIC  X(0002).
001268*    -------------------------------
001269     05  CTERM1L PIC S9(0004) COMP.
001270     05  CTERM1F PIC  X(0001).
001271     05  FILLER REDEFINES CTERM1F.
001272         10  CTERM1A PIC  X(0001).
001273     05  CTERM1I PIC  X(0003).
001274*    -------------------------------
001275     05  CRTERM1L PIC S9(0004) COMP.
001276     05  CRTERM1F PIC  X(0001).
001277     05  FILLER REDEFINES CRTERM1F.
001278         10  CRTERM1A PIC  X(0001).
001279     05  CRTERM1I PIC  X(0003).
001280*    -------------------------------
001281     05  CPREM1L PIC S9(0004) COMP.
001282     05  CPREM1F PIC  X(0001).
001283     05  FILLER REDEFINES CPREM1F.
001284         10  CPREM1A PIC  X(0001).
001285     05  CPREM1I PIC  X(0011).
001286*    -------------------------------
001287     05  CTERM2L PIC S9(0004) COMP.
001288     05  CTERM2F PIC  X(0001).
001289     05  FILLER REDEFINES CTERM2F.
001290         10  CTERM2A PIC  X(0001).
001291     05  CTERM2I PIC  X(0003).
001292*    -------------------------------
001293     05  CRTERM2L PIC S9(0004) COMP.
001294     05  CRTERM2F PIC  X(0001).
001295     05  FILLER REDEFINES CRTERM2F.
001296         10  CRTERM2A PIC  X(0001).
001297     05  CRTERM2I PIC  X(0003).
001298*    -------------------------------
001299     05  CPREM2L PIC S9(0004) COMP.
001300     05  CPREM2F PIC  X(0001).
001301     05  FILLER REDEFINES CPREM2F.
001302         10  CPREM2A PIC  X(0001).
001303     05  CPREM2I PIC  X(0011).
001304*    -------------------------------
001305     05  CENTRDTL PIC S9(0004) COMP.
001306     05  CENTRDTF PIC  X(0001).
001307     05  FILLER REDEFINES CENTRDTF.
001308         10  CENTRDTA PIC  X(0001).
001309     05  CENTRDTI PIC  X(0008).
001310*    -------------------------------
001311     05  CPAYEEL PIC S9(0004) COMP.
001312     05  CPAYEEF PIC  X(0001).
001313     05  FILLER REDEFINES CPAYEEF.
001314         10  CPAYEEA PIC  X(0001).
001315     05  CPAYEEI PIC  X(0006).
001316*    -------------------------------
001317     05  CRFNDSWL PIC S9(0004) COMP.
001318     05  CRFNDSWF PIC  X(0001).
001319     05  FILLER REDEFINES CRFNDSWF.
001320         10  CRFNDSWA PIC  X(0001).
001321     05  CRFNDSWI PIC  X(0003).
001322*    -------------------------------
001323     05  CLFHDGL PIC S9(0004) COMP.
001324     05  CLFHDGF PIC  X(0001).
001325     05  FILLER REDEFINES CLFHDGF.
001326         10  CLFHDGA PIC  X(0001).
001327     05  CLFHDGI PIC  X(0006).
001328*    -------------------------------
001329     05  CAHHDGL PIC S9(0004) COMP.
001330     05  CAHHDGF PIC  X(0001).
001331     05  FILLER REDEFINES CAHHDGF.
001332         10  CAHHDGA PIC  X(0001).
001333     05  CAHHDGI PIC  X(0006).
001334*    -------------------------------
001335     05  CENTDTL PIC S9(0004) COMP.
001336     05  CENTDTF PIC  X(0001).
001337     05  FILLER REDEFINES CENTDTF.
001338         10  CENTDTA PIC  X(0001).
001339     05  CENTDTI PIC  X(0008).
001340*    -------------------------------
001341     05  CENTBYL PIC S9(0004) COMP.
001342     05  CENTBYF PIC  X(0001).
001343     05  FILLER REDEFINES CENTBYF.
001344         10  CENTBYA PIC  X(0001).
001345     05  CENTBYI PIC  X(0004).
001346*    -------------------------------
001347     05  CCHGCNTL PIC S9(0004) COMP.
001348     05  CCHGCNTF PIC  X(0001).
001349     05  FILLER REDEFINES CCHGCNTF.
001350         10  CCHGCNTA PIC  X(0001).
001351     05  CCHGCNTI PIC  X(0003).
001352*    -------------------------------
001353     05  CLFREFNL PIC S9(0004) COMP.
001354     05  CLFREFNF PIC  X(0001).
001355     05  FILLER REDEFINES CLFREFNF.
001356         10  CLFREFNA PIC  X(0001).
001357     05  CLFREFNI PIC  X(0006).
001358*    -------------------------------
001359     05  CAHREFNL PIC S9(0004) COMP.
001360     05  CAHREFNF PIC  X(0001).
001361     05  FILLER REDEFINES CAHREFNF.
001362         10  CAHREFNA PIC  X(0001).
001363     05  CAHREFNI PIC  X(0006).
001364*    -------------------------------
001365     05  CREINCDL PIC S9(0004) COMP.
001366     05  CREINCDF PIC  X(0001).
001367     05  FILLER REDEFINES CREINCDF.
001368         10  CREINCDA PIC  X(0001).
001369     05  CREINCDI PIC  X(0003).
001370*    -------------------------------
001371     05  CAEFFDTL PIC S9(0004) COMP.
001372     05  CAEFFDTF PIC  X(0001).
001373     05  FILLER REDEFINES CAEFFDTF.
001374         10  CAEFFDTA PIC  X(0001).
001375     05  CAEFFDTI PIC  X(0008).
001376*    -------------------------------
001377     05  CAEXPDTL PIC S9(0004) COMP.
001378     05  CAEXPDTF PIC  X(0001).
001379     05  FILLER REDEFINES CAEXPDTF.
001380         10  CAEXPDTA PIC  X(0001).
001381     05  CAEXPDTI PIC  X(0008).
001382*    -------------------------------
001383     05  COMMLFL PIC S9(0004) COMP.
001384     05  COMMLFF PIC  X(0001).
001385     05  FILLER REDEFINES COMMLFF.
001386         10  COMMLFA PIC  X(0001).
001387     05  COMMLFI PIC  X(0006).
001388*    -------------------------------
001389     05  COMMAHL PIC S9(0004) COMP.
001390     05  COMMAHF PIC  X(0001).
001391     05  FILLER REDEFINES COMMAHF.
001392         10  COMMAHA PIC  X(0001).
001393     05  COMMAHI PIC  X(0006).
001394*    -------------------------------
001395     05  CERMSG1L PIC S9(0004) COMP.
001396     05  CERMSG1F PIC  X(0001).
001397     05  FILLER REDEFINES CERMSG1F.
001398         10  CERMSG1A PIC  X(0001).
001399     05  CERMSG1I PIC  X(0078).
001400*    -------------------------------
001401     05  CERMSG2L PIC S9(0004) COMP.
001402     05  CERMSG2F PIC  X(0001).
001403     05  FILLER REDEFINES CERMSG2F.
001404         10  CERMSG2A PIC  X(0001).
001405     05  CERMSG2I PIC  X(0078).
001406*    -------------------------------
001407     05  CERMSG3L PIC S9(0004) COMP.
001408     05  CERMSG3F PIC  X(0001).
001409     05  FILLER REDEFINES CERMSG3F.
001410         10  CERMSG3A PIC  X(0001).
001411     05  CERMSG3I PIC  X(0078).
001412*    -------------------------------
001413     05  CPFENTRL PIC S9(0004) COMP.
001414     05  CPFENTRF PIC  X(0001).
001415     05  FILLER REDEFINES CPFENTRF.
001416         10  CPFENTRA PIC  X(0001).
001417     05  CPFENTRI PIC  9(2).
001418*    -------------------------------
001419     05  CPF5HDRL PIC S9(0004) COMP.
001420     05  CPF5HDRF PIC  X(0001).
001421     05  FILLER REDEFINES CPF5HDRF.
001422         10  CPF5HDRA PIC  X(0001).
001423     05  CPF5HDRI PIC  X(0005).
001424*    -------------------------------
001425     05  CPF4HDRL PIC S9(0004) COMP.
001426     05  CPF4HDRF PIC  X(0001).
001427     05  FILLER REDEFINES CPF4HDRF.
001428         10  CPF4HDRA PIC  X(0001).
001429     05  CPF4HDRI PIC  X(0013).
001430*    -------------------------------
001431     05  CF15HDRL PIC S9(0004) COMP.
001432     05  CF15HDRF PIC  X(0001).
001433     05  FILLER REDEFINES CF15HDRF.
001434         10  CF15HDRA PIC  X(0001).
001435     05  CF15HDRI PIC  X(0022).
001436 01  EL631CO REDEFINES EL631BI.
001437     05  FILLER            PIC  X(0012).
001438*    -------------------------------
001439     05  FILLER            PIC  X(0003).
001440     05  CDATEO PIC  X(0008).
001441*    -------------------------------
001442     05  FILLER            PIC  X(0003).
001443     05  CTIMEO PIC  99.99.
001444*    -------------------------------
001445     05  FILLER            PIC  X(0003).
001446     05  CHEADO PIC  X(0038).
001447*    -------------------------------
001448     05  FILLER            PIC  X(0003).
001449     05  CCHGTO PIC  X(0004).
001450*    -------------------------------
001451     05  FILLER            PIC  X(0003).
001452     05  CCHGO PIC  ZZZ9.
001453*    -------------------------------
001454     05  FILLER            PIC  X(0003).
001455     05  CMAINTO PIC  X(0001).
001456*    -------------------------------
001457     05  FILLER            PIC  X(0003).
001458     05  CMANTBYO PIC  X(0004).
001459*    -------------------------------
001460     05  FILLER            PIC  X(0003).
001461     05  CCHGHDGO PIC  X(0003).
001462*    -------------------------------
001463     05  FILLER            PIC  X(0003).
001464     05  CMANTDTO PIC  X(0008).
001465*    -------------------------------
001466     05  FILLER            PIC  X(0003).
001467     05  CMANTATO PIC  99.99.
001468*    -------------------------------
001469     05  FILLER            PIC  X(0003).
001470     05  CCSRO PIC  X(0004).
001471*    -------------------------------
001472     05  FILLER            PIC  X(0003).
001473     05  CBATCHO PIC  X(0006).
001474*    -------------------------------
001475     05  FILLER            PIC  X(0003).
001476     05  CSEQO PIC  X(0004).
001477*    -------------------------------
001478     05  FILLER            PIC  X(0003).
001479     05  CMOENDTO PIC  X(0008).
001480*    -------------------------------
001481     05  FILLER            PIC  X(0003).
001482     05  CCARRO PIC  X(0001).
001483*    -------------------------------
001484     05  FILLER            PIC  X(0003).
001485     05  CGROUPO PIC  X(0006).
001486*    -------------------------------
001487     05  FILLER            PIC  X(0003).
001488     05  CSTATEO PIC  X(0002).
001489*    -------------------------------
001490     05  FILLER            PIC  X(0003).
001491     05  CACCTO PIC  X(0010).
001492*    -------------------------------
001493     05  FILLER            PIC  X(0003).
001494     05  CORIGHDO PIC  X(0011).
001495*    -------------------------------
001496     05  FILLER            PIC  X(0003).
001497     05  CORGNOO PIC  X(0006).
001498*    -------------------------------
001499     05  FILLER            PIC  X(0003).
001500     05  CORGSEQO PIC  X(0004).
001501*    -------------------------------
001502     05  FILLER            PIC  X(0003).
001503     05  CREFHDGO PIC  X(0010).
001504*    -------------------------------
001505     05  FILLER            PIC  X(0003).
001506     05  CREFO PIC  X(0012).
001507*    -------------------------------
001508     05  FILLER            PIC  X(0003).
001509     05  CNHINTO PIC  ZZZZZ9.99.
001510*    -------------------------------
001511     05  FILLER            PIC  X(0003).
001512     05  CCERTNOO PIC  X(0010).
001513*    -------------------------------
001514     05  FILLER            PIC  X(0003).
001515     05  CSUFIXO PIC  X(0001).
001516*    -------------------------------
001517     05  FILLER            PIC  X(0003).
001518     05  CEFFDTO PIC  X(0008).
001519*    -------------------------------
001520     05  FILLER            PIC  X(0003).
001521     05  CLSTNMO PIC  X(0015).
001522*    -------------------------------
001523     05  FILLER            PIC  X(0003).
001524     05  CINAMEO PIC  X(0015).
001525*    -------------------------------
001526     05  FILLER            PIC  X(0003).
001527     05  CINITSO PIC  X(0010).
001528*    -------------------------------
001529     05  FILLER            PIC  X(0003).
001530     05  CCANREAO PIC  X(0001).
001531*    -------------------------------
001532     05  FILLER            PIC  X(0003).
001533     05  ACTSPCO PIC  X(0001).
001534*    -------------------------------
001535     05  FILLER            PIC  X(0003).
001536     05  CKIND1O PIC  X(0002).
001537*    -------------------------------
001538     05  FILLER            PIC  X(0003).
001539     05  CCANDT1O PIC  X(0008).
001540*    -------------------------------
001541     05  FILLER            PIC  X(0003).
001542     05  CREFND1O PIC  Z(7).99-.
001543*    -------------------------------
001544     05  FILLER            PIC  X(0003).
001545     05  CMTHD1O PIC  X(0001).
001546*    -------------------------------
001547     05  FILLER            PIC  X(0003).
001548     05  CKIND2O PIC  X(0002).
001549*    -------------------------------
001550     05  FILLER            PIC  X(0003).
001551     05  CCANDT2O PIC  X(0008).
001552*    -------------------------------
001553     05  FILLER            PIC  X(0003).
001554     05  CREFND2O PIC  Z(7).99-.
001555*    -------------------------------
001556     05  FILLER            PIC  X(0003).
001557     05  CMTHD2O PIC  X(0001).
001558*    -------------------------------
001559     05  FILLER            PIC  X(0003).
001560     05  CLIVESO PIC  X(0003).
001561*    -------------------------------
001562     05  FILLER            PIC  X(0003).
001563     05  CFORCEO PIC  X(0001).
001564*    -------------------------------
001565     05  FILLER            PIC  X(0003).
001566     05  CBILCDO PIC  X(0001).
001567*    -------------------------------
001568     05  FILLER            PIC  X(0003).
001569     05  CCRFND1O PIC  Z(7).99-.
001570*    -------------------------------
001571     05  FILLER            PIC  X(0003).
001572     05  CCRFND2O PIC  Z(7).99-.
001573*    -------------------------------
001574     05  FILLER            PIC  X(0003).
001575     05  CBILIT1O PIC  X(0008).
001576*    -------------------------------
001577     05  FILLER            PIC  X(0003).
001578     05  CDRFND1O PIC  Z(7).99-.
001579*    -------------------------------
001580     05  FILLER            PIC  X(0003).
001581     05  CBILIT2O PIC  X(0008).
001582*    -------------------------------
001583     05  FILLER            PIC  X(0003).
001584     05  CDRFND2O PIC  Z(7).99-.
001585*    -------------------------------
001586     05  FILLER            PIC  X(0003).
001587     05  CCANTXTO PIC  X(0005).
001588*    -------------------------------
001589     05  FILLER            PIC  X(0003).
001590     05  CCANFEEO PIC  Z9.
001591*    -------------------------------
001592     05  FILLER            PIC  X(0003).
001593     05  CTERM1O PIC  ZZ9.
001594*    -------------------------------
001595     05  FILLER            PIC  X(0003).
001596     05  CRTERM1O PIC  ZZ9.
001597*    -------------------------------
001598     05  FILLER            PIC  X(0003).
001599     05  CPREM1O PIC  ZZZZZZ9.99-.
001600*    -------------------------------
001601     05  FILLER            PIC  X(0003).
001602     05  CTERM2O PIC  ZZ9.
001603*    -------------------------------
001604     05  FILLER            PIC  X(0003).
001605     05  CRTERM2O PIC  ZZ9.
001606*    -------------------------------
001607     05  FILLER            PIC  X(0003).
001608     05  CPREM2O PIC  ZZZZZZ9.99-.
001609*    -------------------------------
001610     05  FILLER            PIC  X(0003).
001611     05  CENTRDTO PIC  X(0008).
001612*    -------------------------------
001613     05  FILLER            PIC  X(0003).
001614     05  CPAYEEO PIC  X(0006).
001615*    -------------------------------
001616     05  FILLER            PIC  X(0003).
001617     05  CRFNDSWO PIC  X(0003).
001618*    -------------------------------
001619     05  FILLER            PIC  X(0003).
001620     05  CLFHDGO PIC  X(0006).
001621*    -------------------------------
001622     05  FILLER            PIC  X(0003).
001623     05  CAHHDGO PIC  X(0006).
001624*    -------------------------------
001625     05  FILLER            PIC  X(0003).
001626     05  CENTDTO PIC  X(0008).
001627*    -------------------------------
001628     05  FILLER            PIC  X(0003).
001629     05  CENTBYO PIC  X(0004).
001630*    -------------------------------
001631     05  FILLER            PIC  X(0003).
001632     05  CCHGCNTO PIC  X(0003).
001633*    -------------------------------
001634     05  FILLER            PIC  X(0003).
001635     05  CLFREFNO PIC  X(0006).
001636*    -------------------------------
001637     05  FILLER            PIC  X(0003).
001638     05  CAHREFNO PIC  X(0006).
001639*    -------------------------------
001640     05  FILLER            PIC  X(0003).
001641     05  CREINCDO PIC  X(0003).
001642*    -------------------------------
001643     05  FILLER            PIC  X(0003).
001644     05  CAEFFDTO PIC  X(0008).
001645*    -------------------------------
001646     05  FILLER            PIC  X(0003).
001647     05  CAEXPDTO PIC  X(0008).
001648*    -------------------------------
001649     05  FILLER            PIC  X(0003).
001650     05  COMMLFO PIC  .99999.
001651*    -------------------------------
001652     05  FILLER            PIC  X(0003).
001653     05  COMMAHO PIC  .99999.
001654*    -------------------------------
001655     05  FILLER            PIC  X(0003).
001656     05  CERMSG1O PIC  X(0078).
001657*    -------------------------------
001658     05  FILLER            PIC  X(0003).
001659     05  CERMSG2O PIC  X(0078).
001660*    -------------------------------
001661     05  FILLER            PIC  X(0003).
001662     05  CERMSG3O PIC  X(0078).
001663*    -------------------------------
001664     05  FILLER            PIC  X(0003).
001665     05  CPFENTRO PIC  X(0002).
001666*    -------------------------------
001667     05  FILLER            PIC  X(0003).
001668     05  CPF5HDRO PIC  X(0005).
001669*    -------------------------------
001670     05  FILLER            PIC  X(0003).
001671     05  CPF4HDRO PIC  X(0013).
001672*    -------------------------------
001673     05  FILLER            PIC  X(0003).
001674     05  CF15HDRO PIC  X(0022).
001675*    -------------------------------
001676 01  EL631DI REDEFINES EL631BI.
001677     05  FILLER            PIC  X(0012).
001678*    -------------------------------
001679     05  DDATEL PIC S9(0004) COMP.
001680     05  DDATEF PIC  X(0001).
001681     05  FILLER REDEFINES DDATEF.
001682         10  DDATEA PIC  X(0001).
001683     05  DDATEI PIC  X(0008).
001684*    -------------------------------
001685     05  DTIMEL PIC S9(0004) COMP.
001686     05  DTIMEF PIC  X(0001).
001687     05  FILLER REDEFINES DTIMEF.
001688         10  DTIMEA PIC  X(0001).
001689     05  DTIMEI PIC  X(0005).
001690*    -------------------------------
001691     05  DHEADL PIC S9(0004) COMP.
001692     05  DHEADF PIC  X(0001).
001693     05  FILLER REDEFINES DHEADF.
001694         10  DHEADA PIC  X(0001).
001695     05  DHEADI PIC  X(0038).
001696*    -------------------------------
001697     05  DLDATEL PIC S9(0004) COMP.
001698     05  DLDATEF PIC  X(0001).
001699     05  FILLER REDEFINES DLDATEF.
001700         10  DLDATEA PIC  X(0001).
001701     05  DLDATEI PIC  X(0010).
001702*    -------------------------------
001703     05  DBATCHL PIC S9(0004) COMP.
001704     05  DBATCHF PIC  X(0001).
001705     05  FILLER REDEFINES DBATCHF.
001706         10  DBATCHA PIC  X(0001).
001707     05  DBATCHI PIC  X(0011).
001708*    -------------------------------
001709     05  DACCTNML PIC S9(0004) COMP.
001710     05  DACCTNMF PIC  X(0001).
001711     05  FILLER REDEFINES DACCTNMF.
001712         10  DACCTNMA PIC  X(0001).
001713     05  DACCTNMI PIC  X(0030).
001714*    -------------------------------
001715     05  DPROCDTL PIC S9(0004) COMP.
001716     05  DPROCDTF PIC  X(0001).
001717     05  FILLER REDEFINES DPROCDTF.
001718         10  DPROCDTA PIC  X(0001).
001719     05  DPROCDTI PIC  X(0008).
001720*    -------------------------------
001721     05  DINPUTL PIC S9(0004) COMP.
001722     05  DINPUTF PIC  X(0001).
001723     05  FILLER REDEFINES DINPUTF.
001724         10  DINPUTA PIC  X(0001).
001725     05  DINPUTI PIC  X(0008).
001726*    -------------------------------
001727     05  DMAINDTL PIC S9(0004) COMP.
001728     05  DMAINDTF PIC  X(0001).
001729     05  FILLER REDEFINES DMAINDTF.
001730         10  DMAINDTA PIC  X(0001).
001731     05  DMAINDTI PIC  X(0008).
001732*    -------------------------------
001733     05  DCARRL PIC S9(0004) COMP.
001734     05  DCARRF PIC  X(0001).
001735     05  FILLER REDEFINES DCARRF.
001736         10  DCARRA PIC  X(0001).
001737     05  DCARRI PIC  X(0001).
001738*    -------------------------------
001739     05  DGROUPL PIC S9(0004) COMP.
001740     05  DGROUPF PIC  X(0001).
001741     05  FILLER REDEFINES DGROUPF.
001742         10  DGROUPA PIC  X(0001).
001743     05  DGROUPI PIC  X(0006).
001744*    -------------------------------
001745     05  DSTATEL PIC S9(0004) COMP.
001746     05  DSTATEF PIC  X(0001).
001747     05  FILLER REDEFINES DSTATEF.
001748         10  DSTATEA PIC  X(0001).
001749     05  DSTATEI PIC  X(0002).
001750*    -------------------------------
001751     05  DACCTL PIC S9(0004) COMP.
001752     05  DACCTF PIC  X(0001).
001753     05  FILLER REDEFINES DACCTF.
001754         10  DACCTA PIC  X(0001).
001755     05  DACCTI PIC  X(0010).
001756*    -------------------------------
001757     05  DRECVDTL PIC S9(0004) COMP.
001758     05  DRECVDTF PIC  X(0001).
001759     05  FILLER REDEFINES DRECVDTF.
001760         10  DRECVDTA PIC  X(0001).
001761     05  DRECVDTI PIC  X(0008).
001762*    -------------------------------
001763     05  DCSRL PIC S9(0004) COMP.
001764     05  DCSRF PIC  X(0001).
001765     05  FILLER REDEFINES DCSRF.
001766         10  DCSRA PIC  X(0001).
001767     05  DCSRI PIC  X(0004).
001768*    -------------------------------
001769     05  DREFHDGL PIC S9(0004) COMP.
001770     05  DREFHDGF PIC  X(0001).
001771     05  FILLER REDEFINES DREFHDGF.
001772         10  DREFHDGA PIC  X(0001).
001773     05  DREFHDGI PIC  X(0010).
001774*    -------------------------------
001775     05  DREFL PIC S9(0004) COMP.
001776     05  DREFF PIC  X(0001).
001777     05  FILLER REDEFINES DREFF.
001778         10  DREFA PIC  X(0001).
001779     05  DREFI PIC  X(0012).
001780*    -------------------------------
001781     05  DLFPHDGL PIC S9(0004) COMP.
001782     05  DLFPHDGF PIC  X(0001).
001783     05  FILLER REDEFINES DLFPHDGF.
001784         10  DLFPHDGA PIC  X(0001).
001785     05  DLFPHDGI PIC  X(0010).
001786*    -------------------------------
001787     05  DAHPHDGL PIC S9(0004) COMP.
001788     05  DAHPHDGF PIC  X(0001).
001789     05  FILLER REDEFINES DAHPHDGF.
001790         10  DAHPHDGA PIC  X(0001).
001791     05  DAHPHDGI PIC  X(0010).
001792*    -------------------------------
001793     05  DLFRHDGL PIC S9(0004) COMP.
001794     05  DLFRHDGF PIC  X(0001).
001795     05  FILLER REDEFINES DLFRHDGF.
001796         10  DLFRHDGA PIC  X(0001).
001797     05  DLFRHDGI PIC  X(0009).
001798*    -------------------------------
001799     05  DAHRHDGL PIC S9(0004) COMP.
001800     05  DAHRHDGF PIC  X(0001).
001801     05  FILLER REDEFINES DAHRHDGF.
001802         10  DAHRHDGA PIC  X(0001).
001803     05  DAHRHDGI PIC  X(0009).
001804*    -------------------------------
001805     05  DRISSL PIC S9(0004) COMP.
001806     05  DRISSF PIC  X(0001).
001807     05  FILLER REDEFINES DRISSF.
001808         10  DRISSA PIC  X(0001).
001809     05  DRISSI PIC  X(0005).
001810*    -------------------------------
001811     05  DRLFPRML PIC S9(0004) COMP.
001812     05  DRLFPRMF PIC  X(0001).
001813     05  FILLER REDEFINES DRLFPRMF.
001814         10  DRLFPRMA PIC  X(0001).
001815     05  DRLFPRMI PIC  S9(9)V99.
001816*    -------------------------------
001817     05  DRAHPRML PIC S9(0004) COMP.
001818     05  DRAHPRMF PIC  X(0001).
001819     05  FILLER REDEFINES DRAHPRMF.
001820         10  DRAHPRMA PIC  X(0001).
001821     05  DRAHPRMI PIC  S9(9)V99.
001822*    -------------------------------
001823     05  DRCANCL PIC S9(0004) COMP.
001824     05  DRCANCF PIC  X(0001).
001825     05  FILLER REDEFINES DRCANCF.
001826         10  DRCANCA PIC  X(0001).
001827     05  DRCANCI PIC  X(0005).
001828*    -------------------------------
001829     05  DRLFRFDL PIC S9(0004) COMP.
001830     05  DRLFRFDF PIC  X(0001).
001831     05  FILLER REDEFINES DRLFRFDF.
001832         10  DRLFRFDA PIC  X(0001).
001833     05  DRLFRFDI PIC  S9(9)V99.
001834*    -------------------------------
001835     05  DRAHRFDL PIC S9(0004) COMP.
001836     05  DRAHRFDF PIC  X(0001).
001837     05  FILLER REDEFINES DRAHRFDF.
001838         10  DRAHRFDA PIC  X(0001).
001839     05  DRAHRFDI PIC  S9(9)V99.
001840*    -------------------------------
001841     05  DEISSL PIC S9(0004) COMP.
001842     05  DEISSF PIC  X(0001).
001843     05  FILLER REDEFINES DEISSF.
001844         10  DEISSA PIC  X(0001).
001845     05  DEISSI PIC  X(0005).
001846*    -------------------------------
001847     05  DELFPRML PIC S9(0004) COMP.
001848     05  DELFPRMF PIC  X(0001).
001849     05  FILLER REDEFINES DELFPRMF.
001850         10  DELFPRMA PIC  X(0001).
001851     05  DELFPRMI PIC  X(0011).
001852*    -------------------------------
001853     05  DEAHPRML PIC S9(0004) COMP.
001854     05  DEAHPRMF PIC  X(0001).
001855     05  FILLER REDEFINES DEAHPRMF.
001856         10  DEAHPRMA PIC  X(0001).
001857     05  DEAHPRMI PIC  X(0011).
001858*    -------------------------------
001859     05  DECANCL PIC S9(0004) COMP.
001860     05  DECANCF PIC  X(0001).
001861     05  FILLER REDEFINES DECANCF.
001862         10  DECANCA PIC  X(0001).
001863     05  DECANCI PIC  X(0005).
001864*    -------------------------------
001865     05  DELFRFDL PIC S9(0004) COMP.
001866     05  DELFRFDF PIC  X(0001).
001867     05  FILLER REDEFINES DELFRFDF.
001868         10  DELFRFDA PIC  X(0001).
001869     05  DELFRFDI PIC  X(0011).
001870*    -------------------------------
001871     05  DEAHRFDL PIC S9(0004) COMP.
001872     05  DEAHRFDF PIC  X(0001).
001873     05  FILLER REDEFINES DEAHRFDF.
001874         10  DEAHRFDA PIC  X(0001).
001875     05  DEAHRFDI PIC  X(0011).
001876*    -------------------------------
001877     05  DCISSL PIC S9(0004) COMP.
001878     05  DCISSF PIC  X(0001).
001879     05  FILLER REDEFINES DCISSF.
001880         10  DCISSA PIC  X(0001).
001881     05  DCISSI PIC  X(0005).
001882*    -------------------------------
001883     05  DCLFPRML PIC S9(0004) COMP.
001884     05  DCLFPRMF PIC  X(0001).
001885     05  FILLER REDEFINES DCLFPRMF.
001886         10  DCLFPRMA PIC  X(0001).
001887     05  DCLFPRMI PIC  X(0011).
001888*    -------------------------------
001889     05  DCAHPRML PIC S9(0004) COMP.
001890     05  DCAHPRMF PIC  X(0001).
001891     05  FILLER REDEFINES DCAHPRMF.
001892         10  DCAHPRMA PIC  X(0001).
001893     05  DCAHPRMI PIC  X(0011).
001894*    -------------------------------
001895     05  DCCANCL PIC S9(0004) COMP.
001896     05  DCCANCF PIC  X(0001).
001897     05  FILLER REDEFINES DCCANCF.
001898         10  DCCANCA PIC  X(0001).
001899     05  DCCANCI PIC  X(0005).
001900*    -------------------------------
001901     05  DCLFRFDL PIC S9(0004) COMP.
001902     05  DCLFRFDF PIC  X(0001).
001903     05  FILLER REDEFINES DCLFRFDF.
001904         10  DCLFRFDA PIC  X(0001).
001905     05  DCLFRFDI PIC  X(0011).
001906*    -------------------------------
001907     05  DCAHRFDL PIC S9(0004) COMP.
001908     05  DCAHRFDF PIC  X(0001).
001909     05  FILLER REDEFINES DCAHRFDF.
001910         10  DCAHRFDA PIC  X(0001).
001911     05  DCAHRFDI PIC  X(0011).
001912*    -------------------------------
001913     05  DOISSL PIC S9(0004) COMP.
001914     05  DOISSF PIC  X(0001).
001915     05  FILLER REDEFINES DOISSF.
001916         10  DOISSA PIC  X(0001).
001917     05  DOISSI PIC  X(0005).
001918*    -------------------------------
001919     05  DOLFPRML PIC S9(0004) COMP.
001920     05  DOLFPRMF PIC  X(0001).
001921     05  FILLER REDEFINES DOLFPRMF.
001922         10  DOLFPRMA PIC  X(0001).
001923     05  DOLFPRMI PIC  X(0011).
001924*    -------------------------------
001925     05  DOAHPRML PIC S9(0004) COMP.
001926     05  DOAHPRMF PIC  X(0001).
001927     05  FILLER REDEFINES DOAHPRMF.
001928         10  DOAHPRMA PIC  X(0001).
001929     05  DOAHPRMI PIC  X(0011).
001930*    -------------------------------
001931     05  DOCANCL PIC S9(0004) COMP.
001932     05  DOCANCF PIC  X(0001).
001933     05  FILLER REDEFINES DOCANCF.
001934         10  DOCANCA PIC  X(0001).
001935     05  DOCANCI PIC  X(0005).
001936*    -------------------------------
001937     05  DOLFRFDL PIC S9(0004) COMP.
001938     05  DOLFRFDF PIC  X(0001).
001939     05  FILLER REDEFINES DOLFRFDF.
001940         10  DOLFRFDA PIC  X(0001).
001941     05  DOLFRFDI PIC  X(0011).
001942*    -------------------------------
001943     05  DOAHRFDL PIC S9(0004) COMP.
001944     05  DOAHRFDF PIC  X(0001).
001945     05  FILLER REDEFINES DOAHRFDF.
001946         10  DOAHRFDA PIC  X(0001).
001947     05  DOAHRFDI PIC  X(0011).
001948*    -------------------------------
001949     05  DITOTALL PIC S9(0004) COMP.
001950     05  DITOTALF PIC  X(0001).
001951     05  FILLER REDEFINES DITOTALF.
001952         10  DITOTALA PIC  X(0001).
001953     05  DITOTALI PIC  X(0005).
001954*    -------------------------------
001955     05  DIFATALL PIC S9(0004) COMP.
001956     05  DIFATALF PIC  X(0001).
001957     05  FILLER REDEFINES DIFATALF.
001958         10  DIFATALA PIC  X(0001).
001959     05  DIFATALI PIC  X(0005).
001960*    -------------------------------
001961     05  DIFORCEL PIC S9(0004) COMP.
001962     05  DIFORCEF PIC  X(0001).
001963     05  FILLER REDEFINES DIFORCEF.
001964         10  DIFORCEA PIC  X(0001).
001965     05  DIFORCEI PIC  X(0005).
001966*    -------------------------------
001967     05  DIHOLDL PIC S9(0004) COMP.
001968     05  DIHOLDF PIC  X(0001).
001969     05  FILLER REDEFINES DIHOLDF.
001970         10  DIHOLDA PIC  X(0001).
001971     05  DIHOLDI PIC  X(0005).
001972*    -------------------------------
001973     05  DIAVAILL PIC S9(0004) COMP.
001974     05  DIAVAILF PIC  X(0001).
001975     05  FILLER REDEFINES DIAVAILF.
001976         10  DIAVAILA PIC  X(0001).
001977     05  DIAVAILI PIC  X(0005).
001978*    -------------------------------
001979     05  DIGPREML PIC S9(0004) COMP.
001980     05  DIGPREMF PIC  X(0001).
001981     05  FILLER REDEFINES DIGPREMF.
001982         10  DIGPREMA PIC  X(0001).
001983     05  DIGPREMI PIC  X(0011).
001984*    -------------------------------
001985     05  DIBPREML PIC S9(0004) COMP.
001986     05  DIBPREMF PIC  X(0001).
001987     05  FILLER REDEFINES DIBPREMF.
001988         10  DIBPREMA PIC  X(0001).
001989     05  DIBPREMI PIC  X(0011).
001990*    -------------------------------
001991     05  DCTOTALL PIC S9(0004) COMP.
001992     05  DCTOTALF PIC  X(0001).
001993     05  FILLER REDEFINES DCTOTALF.
001994         10  DCTOTALA PIC  X(0001).
001995     05  DCTOTALI PIC  X(0005).
001996*    -------------------------------
001997     05  DCFATALL PIC S9(0004) COMP.
001998     05  DCFATALF PIC  X(0001).
001999     05  FILLER REDEFINES DCFATALF.
002000         10  DCFATALA PIC  X(0001).
002001     05  DCFATALI PIC  X(0005).
002002*    -------------------------------
002003     05  DCFORCEL PIC S9(0004) COMP.
002004     05  DCFORCEF PIC  X(0001).
002005     05  FILLER REDEFINES DCFORCEF.
002006         10  DCFORCEA PIC  X(0001).
002007     05  DCFORCEI PIC  X(0005).
002008*    -------------------------------
002009     05  DCHOLDL PIC S9(0004) COMP.
002010     05  DCHOLDF PIC  X(0001).
002011     05  FILLER REDEFINES DCHOLDF.
002012         10  DCHOLDA PIC  X(0001).
002013     05  DCHOLDI PIC  X(0005).
002014*    -------------------------------
002015     05  DCAVAILL PIC S9(0004) COMP.
002016     05  DCAVAILF PIC  X(0001).
002017     05  FILLER REDEFINES DCAVAILF.
002018         10  DCAVAILA PIC  X(0001).
002019     05  DCAVAILI PIC  X(0005).
002020*    -------------------------------
002021     05  DCGPREML PIC S9(0004) COMP.
002022     05  DCGPREMF PIC  X(0001).
002023     05  FILLER REDEFINES DCGPREMF.
002024         10  DCGPREMA PIC  X(0001).
002025     05  DCGPREMI PIC  X(0011).
002026*    -------------------------------
002027     05  DCBPREML PIC S9(0004) COMP.
002028     05  DCBPREMF PIC  X(0001).
002029     05  FILLER REDEFINES DCBPREMF.
002030         10  DCBPREMA PIC  X(0001).
002031     05  DCBPREMI PIC  X(0011).
002032*    -------------------------------
002033     05  DNTOTALL PIC S9(0004) COMP.
002034     05  DNTOTALF PIC  X(0001).
002035     05  FILLER REDEFINES DNTOTALF.
002036         10  DNTOTALA PIC  X(0001).
002037     05  DNTOTALI PIC  X(0005).
002038*    -------------------------------
002039     05  DNFATALL PIC S9(0004) COMP.
002040     05  DNFATALF PIC  X(0001).
002041     05  FILLER REDEFINES DNFATALF.
002042         10  DNFATALA PIC  X(0001).
002043     05  DNFATALI PIC  X(0005).
002044*    -------------------------------
002045     05  DNFORCEL PIC S9(0004) COMP.
002046     05  DNFORCEF PIC  X(0001).
002047     05  FILLER REDEFINES DNFORCEF.
002048         10  DNFORCEA PIC  X(0001).
002049     05  DNFORCEI PIC  X(0005).
002050*    -------------------------------
002051     05  DNHOLDL PIC S9(0004) COMP.
002052     05  DNHOLDF PIC  X(0001).
002053     05  FILLER REDEFINES DNHOLDF.
002054         10  DNHOLDA PIC  X(0001).
002055     05  DNHOLDI PIC  X(0005).
002056*    -------------------------------
002057     05  DNAVAILL PIC S9(0004) COMP.
002058     05  DNAVAILF PIC  X(0001).
002059     05  FILLER REDEFINES DNAVAILF.
002060         10  DNAVAILA PIC  X(0001).
002061     05  DNAVAILI PIC  X(0005).
002062*    -------------------------------
002063     05  DNGPREML PIC S9(0004) COMP.
002064     05  DNGPREMF PIC  X(0001).
002065     05  FILLER REDEFINES DNGPREMF.
002066         10  DNGPREMA PIC  X(0001).
002067     05  DNGPREMI PIC  X(0011).
002068*    -------------------------------
002069     05  DNBPREML PIC S9(0004) COMP.
002070     05  DNBPREMF PIC  X(0001).
002071     05  FILLER REDEFINES DNBPREMF.
002072         10  DNBPREMA PIC  X(0001).
002073     05  DNBPREMI PIC  X(0011).
002074*    -------------------------------
002075     05  DERMSGL PIC S9(0004) COMP.
002076     05  DERMSGF PIC  X(0001).
002077     05  FILLER REDEFINES DERMSGF.
002078         10  DERMSGA PIC  X(0001).
002079     05  DERMSGI PIC  X(0075).
002080*    -------------------------------
002081     05  DPFENTRL PIC S9(0004) COMP.
002082     05  DPFENTRF PIC  X(0001).
002083     05  FILLER REDEFINES DPFENTRF.
002084         10  DPFENTRA PIC  X(0001).
002085     05  DPFENTRI PIC  9(2).
002086 01  EL631DO REDEFINES EL631BI.
002087     05  FILLER            PIC  X(0012).
002088*    -------------------------------
002089     05  FILLER            PIC  X(0003).
002090     05  DDATEO PIC  X(0008).
002091*    -------------------------------
002092     05  FILLER            PIC  X(0003).
002093     05  DTIMEO PIC  99.99.
002094*    -------------------------------
002095     05  FILLER            PIC  X(0003).
002096     05  DHEADO PIC  X(0038).
002097*    -------------------------------
002098     05  FILLER            PIC  X(0003).
002099     05  DLDATEO PIC  X(0010).
002100*    -------------------------------
002101     05  FILLER            PIC  X(0003).
002102     05  DBATCHO PIC  X(0011).
002103*    -------------------------------
002104     05  FILLER            PIC  X(0003).
002105     05  DACCTNMO PIC  X(0030).
002106*    -------------------------------
002107     05  FILLER            PIC  X(0003).
002108     05  DPROCDTO PIC  X(0008).
002109*    -------------------------------
002110     05  FILLER            PIC  X(0003).
002111     05  DINPUTO PIC  X(0008).
002112*    -------------------------------
002113     05  FILLER            PIC  X(0003).
002114     05  DMAINDTO PIC  X(0008).
002115*    -------------------------------
002116     05  FILLER            PIC  X(0003).
002117     05  DCARRO PIC  X(0001).
002118*    -------------------------------
002119     05  FILLER            PIC  X(0003).
002120     05  DGROUPO PIC  X(0006).
002121*    -------------------------------
002122     05  FILLER            PIC  X(0003).
002123     05  DSTATEO PIC  X(0002).
002124*    -------------------------------
002125     05  FILLER            PIC  X(0003).
002126     05  DACCTO PIC  X(0010).
002127*    -------------------------------
002128     05  FILLER            PIC  X(0003).
002129     05  DRECVDTO PIC  X(0008).
002130*    -------------------------------
002131     05  FILLER            PIC  X(0003).
002132     05  DCSRO PIC  X(0004).
002133*    -------------------------------
002134     05  FILLER            PIC  X(0003).
002135     05  DREFHDGO PIC  X(0010).
002136*    -------------------------------
002137     05  FILLER            PIC  X(0003).
002138     05  DREFO PIC  X(0012).
002139*    -------------------------------
002140     05  FILLER            PIC  X(0003).
002141     05  DLFPHDGO PIC  X(0010).
002142*    -------------------------------
002143     05  FILLER            PIC  X(0003).
002144     05  DAHPHDGO PIC  X(0010).
002145*    -------------------------------
002146     05  FILLER            PIC  X(0003).
002147     05  DLFRHDGO PIC  X(0009).
002148*    -------------------------------
002149     05  FILLER            PIC  X(0003).
002150     05  DAHRHDGO PIC  X(0009).
002151*    -------------------------------
002152     05  FILLER            PIC  X(0003).
002153     05  DRISSO PIC  ZZ99-.
002154*    -------------------------------
002155     05  FILLER            PIC  X(0003).
002156     05  DRLFPRMO PIC  ZZZZZZ9.99-.
002157*    -------------------------------
002158     05  FILLER            PIC  X(0003).
002159     05  DRAHPRMO PIC  ZZZZZZ9.99-.
002160*    -------------------------------
002161     05  FILLER            PIC  X(0003).
002162     05  DRCANCO PIC  ZZ99-.
002163*    -------------------------------
002164     05  FILLER            PIC  X(0003).
002165     05  DRLFRFDO PIC  ZZZZZZ9.99-.
002166*    -------------------------------
002167     05  FILLER            PIC  X(0003).
002168     05  DRAHRFDO PIC  ZZZZZZ9.99-.
002169*    -------------------------------
002170     05  FILLER            PIC  X(0003).
002171     05  DEISSO PIC  ZZ99-.
002172*    -------------------------------
002173     05  FILLER            PIC  X(0003).
002174     05  DELFPRMO PIC  ZZZZZZ9.99-.
002175*    -------------------------------
002176     05  FILLER            PIC  X(0003).
002177     05  DEAHPRMO PIC  ZZZZZZ9.99-.
002178*    -------------------------------
002179     05  FILLER            PIC  X(0003).
002180     05  DECANCO PIC  ZZ99-.
002181*    -------------------------------
002182     05  FILLER            PIC  X(0003).
002183     05  DELFRFDO PIC  ZZZZZZ9.99-.
002184*    -------------------------------
002185     05  FILLER            PIC  X(0003).
002186     05  DEAHRFDO PIC  ZZZZZZ9.99-.
002187*    -------------------------------
002188     05  FILLER            PIC  X(0003).
002189     05  DCISSO PIC  ZZ99-.
002190*    -------------------------------
002191     05  FILLER            PIC  X(0003).
002192     05  DCLFPRMO PIC  ZZZZZZ9.99-.
002193*    -------------------------------
002194     05  FILLER            PIC  X(0003).
002195     05  DCAHPRMO PIC  ZZZZZZ9.99-.
002196*    -------------------------------
002197     05  FILLER            PIC  X(0003).
002198     05  DCCANCO PIC  ZZ99-.
002199*    -------------------------------
002200     05  FILLER            PIC  X(0003).
002201     05  DCLFRFDO PIC  ZZZZZZ9.99-.
002202*    -------------------------------
002203     05  FILLER            PIC  X(0003).
002204     05  DCAHRFDO PIC  ZZZZZZ9.99-.
002205*    -------------------------------
002206     05  FILLER            PIC  X(0003).
002207     05  DOISSO PIC  ZZ99-.
002208*    -------------------------------
002209     05  FILLER            PIC  X(0003).
002210     05  DOLFPRMO PIC  ZZZZZZ9.99-.
002211*    -------------------------------
002212     05  FILLER            PIC  X(0003).
002213     05  DOAHPRMO PIC  ZZZZZZ9.99-.
002214*    -------------------------------
002215     05  FILLER            PIC  X(0003).
002216     05  DOCANCO PIC  ZZ99-.
002217*    -------------------------------
002218     05  FILLER            PIC  X(0003).
002219     05  DOLFRFDO PIC  ZZZZZZ9.99-.
002220*    -------------------------------
002221     05  FILLER            PIC  X(0003).
002222     05  DOAHRFDO PIC  ZZZZZZ9.99-.
002223*    -------------------------------
002224     05  FILLER            PIC  X(0003).
002225     05  DITOTALO PIC  ZZZ99.
002226*    -------------------------------
002227     05  FILLER            PIC  X(0003).
002228     05  DIFATALO PIC  ZZZ99.
002229*    -------------------------------
002230     05  FILLER            PIC  X(0003).
002231     05  DIFORCEO PIC  ZZZ99.
002232*    -------------------------------
002233     05  FILLER            PIC  X(0003).
002234     05  DIHOLDO PIC  ZZZ99.
002235*    -------------------------------
002236     05  FILLER            PIC  X(0003).
002237     05  DIAVAILO PIC  ZZZ99.
002238*    -------------------------------
002239     05  FILLER            PIC  X(0003).
002240     05  DIGPREMO PIC  ZZZZZZZ9.99.
002241*    -------------------------------
002242     05  FILLER            PIC  X(0003).
002243     05  DIBPREMO PIC  ZZZZZZZ9.99.
002244*    -------------------------------
002245     05  FILLER            PIC  X(0003).
002246     05  DCTOTALO PIC  ZZZ99.
002247*    -------------------------------
002248     05  FILLER            PIC  X(0003).
002249     05  DCFATALO PIC  ZZZ99.
002250*    -------------------------------
002251     05  FILLER            PIC  X(0003).
002252     05  DCFORCEO PIC  ZZZ99.
002253*    -------------------------------
002254     05  FILLER            PIC  X(0003).
002255     05  DCHOLDO PIC  ZZZ99.
002256*    -------------------------------
002257     05  FILLER            PIC  X(0003).
002258     05  DCAVAILO PIC  ZZZ99.
002259*    -------------------------------
002260     05  FILLER            PIC  X(0003).
002261     05  DCGPREMO PIC  ZZZZZZZ9.99.
002262*    -------------------------------
002263     05  FILLER            PIC  X(0003).
002264     05  DCBPREMO PIC  ZZZZZZZ9.99.
002265*    -------------------------------
002266     05  FILLER            PIC  X(0003).
002267     05  DNTOTALO PIC  ---99.
002268*    -------------------------------
002269     05  FILLER            PIC  X(0003).
002270     05  DNFATALO PIC  ---99.
002271*    -------------------------------
002272     05  FILLER            PIC  X(0003).
002273     05  DNFORCEO PIC  ---99.
002274*    -------------------------------
002275     05  FILLER            PIC  X(0003).
002276     05  DNHOLDO PIC  ---99.
002277*    -------------------------------
002278     05  FILLER            PIC  X(0003).
002279     05  DNAVAILO PIC  ---99.
002280*    -------------------------------
002281     05  FILLER            PIC  X(0003).
002282     05  DNGPREMO PIC  -------9.99.
002283*    -------------------------------
002284     05  FILLER            PIC  X(0003).
002285     05  DNBPREMO PIC  -------9.99.
002286*    -------------------------------
002287     05  FILLER            PIC  X(0003).
002288     05  DERMSGO PIC  X(0075).
002289*    -------------------------------
002290     05  FILLER            PIC  X(0003).
002291     05  DPFENTRO PIC  X(0002).
002292*    -------------------------------
      *<<((file: EL6311S))
001226     EJECT
001227 01  MAP-B REDEFINES EL631BI.
001228     12  FILLER                  PIC X(595).
001229*    12  FILLER                  PIC X(591).
001230*    12  FILLER                  PIC X(512).
001231*    12  FILLER                  PIC X(510).
001232     12  MAP-B-COVERAGE OCCURS 2 TIMES.
001233         16  BKIND-LEN               PIC S9(4)  COMP.
001234         16  BKIND-ATTRB             PIC X.
001235         16  BKIND                   PIC XX.
001236         16  BTYPE-LEN               PIC S9(4)  COMP.
001237         16  BTYPE-ATTRB             PIC X.
001238         16  BTYPE                   PIC X(3).
001239         16  BTERM-LEN               PIC S9(4)  COMP.
001240         16  BTERM-ATTRB             PIC X.
001241         16  BTERMI                  PIC 999.
001242         16  BTERMO REDEFINES BTERMI PIC ZZZ.
001243         16  BBEN-LEN                PIC S9(4)  COMP.
001244         16  BBEN-ATTRB              PIC X.
001245         16  BBENI                   PIC 9(10)V99.
001246*        16  BBENI                   PIC 9(12).
001247         16  BBENO REDEFINES BBENI   PIC Z(9).99.
001248         16  BPREM-LEN               PIC S9(4)  COMP.
001249         16  BPREM-ATTRB             PIC X.
001250         16  BPREMI                  PIC S9(9)V99.
001251*        16  BPREMI                  PIC 9(11).
001252         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
001253         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
001254         16  BEXPIRE-LEN             PIC S9(4)  COMP.
001255         16  BEXPIRE-ATTRB           PIC X.
001256         16  BEXPIRE                 PIC X(8).
001257         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
001258         16  BCRIT-PERD-ATTRB        PIC X.
001259         16  BCRIT-PERDI             PIC 99.
001260         16  BCRIT-PERDO REDEFINES
001261                         BCRIT-PERDI PIC ZZ.
001262         16  BALT-BEN-LEN            PIC S9(4)  COMP.
001263         16  BALT-BEN-ATTRB          PIC X.
001264         16  BALT-BENI               PIC 9(10)V99.
001265*        16  BALT-BENI               PIC 9(12).
001266         16  BALT-BENO REDEFINES
001267                           BALT-BENI PIC Z(9).ZZ.
001268         16  BALT-PREM-LEN           PIC S9(4)  COMP.
001269         16  BALT-PREM-ATTRB         PIC X.
001270         16  BALT-PREMI              PIC 9(9)V99.
001271*        16  BALT-PREMI              PIC 9(11).
001272         16  BALT-PREMO REDEFINES
001273                          BALT-PREMI PIC Z(7).ZZ-.
001274         16  BBEN-CD-LEN             PIC S9(4)  COMP.
001275         16  BBEN-CD-ATTRB           PIC X.
001276         16  BBEN-CD                 PIC XXX.
001277         16  BCPREM-LEN              PIC S9(4)  COMP.
001278         16  BCPREM-ATTRB            PIC X.
001279         16  BCPREMI                 PIC S9(9)V99.
001280*        16  BCPREMI                 PIC X(11).
001281         16  BCPREMO REDEFINES BCPREMI
001282                                     PIC Z(7).99-.
001283         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
001284         16  BCALT-PREM-ATTRB        PIC X.
001285         16  BCALT-PREM              PIC Z(7).99-.
001286         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
001287         16  BBEN-ABBR-ATTRB         PIC X.
001288         16  BBEN-ABBR               PIC X(5).
001289         16  BDIFF-LEN               PIC S9(4)  COMP.
001290         16  BDIFF-ATTRB             PIC X.
001291         16  BDIFFO                  PIC Z(7).99-.
001292         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
001293         16  BBILL-LIT-ATTRB         PIC X.
001294         16  BBILL-LIT               PIC X(8).
001295         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
001296         16  BDALT-PREM-ATTRB        PIC X.
001297         16  BDALT-PREM              PIC Z(7).99-.
001298
001299     EJECT
001300
      ****************************************************************
      *                                                               
      * Copyright (c) 2016-2020 NTT DATA, Inc.                        
      * All rights reserved.                                          
      *                                                               
      ****************************************************************
       01  DFHEIV.                                                    
         02  DFHEIV0               PIC X(35).                         
         02  DFHEIV1               PIC X(08).                         
         02  DFHEIV2               PIC X(08).                         
         02  DFHEIV3               PIC X(08).                         
         02  DFHEIV4               PIC X(06).                         
         02  DFHEIV5               PIC X(04).                         
         02  DFHEIV6               PIC X(04).                         
         02  DFHEIV7               PIC X(02).                         
         02  DFHEIV8               PIC X(02).                         
         02  DFHEIV9               PIC X(01).                         
         02  DFHEIV10              PIC S9(7) COMP-3.                  
         02  DFHEIV11              PIC S9(4) COMP SYNC.               
         02  DFHEIV12              PIC S9(4) COMP SYNC.               
         02  DFHEIV13              PIC S9(4) COMP SYNC.               
         02  DFHEIV14              PIC S9(4) COMP SYNC.               
         02  DFHEIV15              PIC S9(4) COMP SYNC.               
         02  DFHEIV16              PIC S9(9) COMP SYNC.               
         02  DFHEIV17              PIC X(04).                         
         02  DFHEIV18              PIC X(04).                         
         02  DFHEIV19              PIC X(04).                         
         02  DFHEIV20              USAGE IS POINTER.                  
         02  DFHEIV21              USAGE IS POINTER.                  
         02  DFHEIV22              USAGE IS POINTER.                  
         02  DFHEIV23              USAGE IS POINTER.                  
         02  DFHEIV24              USAGE IS POINTER.                  
         02  DFHEIV25              PIC S9(9) COMP SYNC.               
         02  DFHEIV26              PIC S9(9) COMP SYNC.               
         02  DFHEIV27              PIC S9(9) COMP SYNC.               
         02  DFHEIV28              PIC S9(9) COMP SYNC.               
         02  DFHEIV29              PIC S9(9) COMP SYNC.               
         02  DFHEIV30              PIC S9(9) COMP SYNC.               
         02  DFHEIV31              PIC S9(9) COMP SYNC.               
         02  DFHEIV32              PIC S9(4) COMP SYNC.               
         02  DFHEIV33              PIC S9(4) COMP SYNC.               
         02  DFHEIV34              PIC S9(4) COMP SYNC.               
         02  DFHEIV35              PIC S9(4) COMP SYNC.               
         02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.       
         02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.    
         02  FILLER                PIC X(02).                         
         02  DFHEIV99              PIC X(08) VALUE SPACE.             
         02  DFHEIVL0              PIC X(48) VALUE SPACE.             
         02  DFHEIVL1              PIC X(48) VALUE SPACE.             
         02  DFHEIVL2              PIC X(48) VALUE SPACE.             
         02  DFHEIVL3              PIC X(48) VALUE SPACE.             
         02  DFHEIVL4              PIC X(255) VALUE SPACE.            
         02  DFHEIVL5              PIC X(255) VALUE SPACE.            
       LINKAGE  SECTION.
      *****************************************************************
      *                                                               *
      * Copyright (c) 2016-2020 NTT DATA, Inc.                        *
      * All rights reserved.                                          *
      *                                                               *
      *****************************************************************
       01  dfheiblk.
           02  eibtime          pic s9(7) comp-3.
           02  eibdate          pic s9(7) comp-3.
           02  eibtrnid         pic x(4).
           02  eibtaskn         pic s9(7) comp-3.
           02  eibtrmid         pic x(4).
           02  dfheigdi         pic s9(4) comp.
           02  eibcposn         pic s9(4) comp.
           02  eibcalen         pic s9(4) comp.
           02  eibaid           pic x(1).
           02  eibfiller1       pic x(1).
           02  eibfn            pic x(2).
           02  eibfiller2       pic x(2).
           02  eibrcode         pic x(6).
           02  eibfiller3       pic x(2).
           02  eibds            pic x(8).
           02  eibreqid         pic x(8).
           02  eibrsrce         pic x(8).
           02  eibsync          pic x(1).
           02  eibfree          pic x(1).
           02  eibrecv          pic x(1).
           02  eibsend          pic x(1).
           02  eibatt           pic x(1).
           02  eibeoc           pic x(1).
           02  eibfmh           pic x(1).
           02  eibcompl         pic x(1).
           02  eibsig           pic x(1).
           02  eibconf          pic x(1).
           02  eiberr           pic x(1).
           02  eibrldbk         pic x(1).
           02  eiberrcd         pic x(4).
           02  eibsynrb         pic x(1).
           02  eibnodat         pic x(1).
           02  eibfiller5       pic x(2).
           02  eibresp          pic s9(8) comp.
           02  eibresp2         pic s9(8) comp.
           02  dfheigdj         pic s9(4) comp.
           02  dfheigdk         pic s9(4) comp.
001302 01  DFHCOMMAREA                 PIC X(1300).
001303
001304*                                COPY ERCPNDB.
      *>>((file: ERCPNDB))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCPNDB.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.025                          *
000007*                                                                *
000008*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
000009*                                                                *
000010******************************************************************
000011*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
000012*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
000013******************************************************************
000014*                                                                *
000015*                                                                *
000016*   FILE TYPE = VSAM,KSDS                                        *
000017*   RECORD SIZE = 585  RECFORM = FIXED                           *
000018*                                                                *
000019*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
000020*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
000021*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
000022*                                                 RKP=13,LEN=36  *
000023*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
000024*                                      AND CHG-SEQ.)             *
000025*                                                RKP=49,LEN=11   *
000026*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
000027*                                      AND CHG-SEQ.)             *
000028*                                                RKP=60,LEN=15   *
000029*                                                                *
000030*   LOG = NO                                                     *
000031*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000032******************************************************************
000033******************************************************************
000034*                   C H A N G E   L O G
000035*
000036* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000037*-----------------------------------------------------------------
000038*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000039* EFFECTIVE    NUMBER
000040*-----------------------------------------------------------------
000041* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
000042* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
000043* 011904                   PEMA  ADD TOTAL FEE PROCESSING
000044* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
000045* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
000046* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
000047* 032306                   PEMA  ADD BOW LOAN NUMBER
000048* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
000049* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
000050* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
000051* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
000052* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
000053* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
000054* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
000055* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
000056* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
000057* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
000058* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
000059* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
000060* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
000061******************************************************************
000062
000063 01  PENDING-BUSINESS.
000064     12  PB-RECORD-ID                     PIC XX.
000065         88  VALID-PB-ID                        VALUE 'PB'.
000066
000067     12  PB-CONTROL-PRIMARY.
000068         16  PB-COMPANY-CD                PIC X.
000069         16  PB-ENTRY-BATCH               PIC X(6).
000070         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
000071         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
000072
000073     12  PB-CONTROL-BY-ACCOUNT.
000074         16  PB-COMPANY-CD-A1             PIC X.
000075         16  PB-CARRIER                   PIC X.
000076         16  PB-GROUPING.
000077             20  PB-GROUPING-PREFIX       PIC XXX.
000078             20  PB-GROUPING-PRIME        PIC XXX.
000079         16  PB-STATE                     PIC XX.
000080         16  PB-ACCOUNT.
000081             20  PB-ACCOUNT-PREFIX        PIC X(4).
000082             20  PB-ACCOUNT-PRIME         PIC X(6).
000083         16  PB-CERT-EFF-DT               PIC XX.
000084         16  PB-CERT-NO.
000085             20  PB-CERT-PRIME            PIC X(10).
000086             20  PB-CERT-SFX              PIC X.
000087         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
000088
000089         16  PB-RECORD-TYPE               PIC X.
000090             88  PB-MAILING-DATA                VALUE '0'.
000091             88  PB-ISSUE                       VALUE '1'.
000092             88  PB-CANCELLATION                VALUE '2'.
000093             88  PB-BATCH-TRAILER               VALUE '9'.
000094
000095     12  PB-CONTROL-BY-ORIG-BATCH.
000096         16  PB-ORIGINAL-COMPANY-CD       PIC X.
000097         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
000098         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
000099         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
000100
000101     12  PB-CONTROL-BY-CSR.
000102         16  PB-CSR-COMPANY-CD            PIC X.
000103         16  PB-CSR-ID                    PIC X(4).
000104         16  PB-CSR-ENTRY-BATCH           PIC X(6).
000105         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
000106         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
000107******************************************************************
000108*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
000109******************************************************************
000110
000111     12  PB-LAST-MAINT-DT                 PIC XX.
000112     12  PB-LAST-MAINT-BY                 PIC X(4).
000113     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
000114
000115     12  PB-RECORD-BODY                   PIC X(375).
000116
000117     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
000118         16  PB-CERT-ORIGIN               PIC X.
000119             88  CLASIC-CREATED-CERT         VALUE '1'.
000120         16  PB-I-NAME.
000121             20  PB-I-INSURED-LAST-NAME   PIC X(15).
000122             20  PB-I-INSURED-FIRST-NAME.
000123                 24  PB-I-INSURED-1ST-INIT PIC X.
000124                 24  FILLER                PIC X(9).
000125             20  PB-I-INSURED-MIDDLE-INIT PIC X.
000126         16  PB-I-AGE                     PIC S99   COMP-3.
000127         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
000128         16  PB-I-BIRTHDAY                PIC XX.
000129         16  PB-I-INSURED-SEX             PIC X.
000130             88  PB-SEX-MALE     VALUE 'M'.
000131             88  PB-SEX-FEMALE   VALUE 'F'.
000132
000133         16  PB-I-LF-TERM                 PIC S999   COMP-3.
000134         16  PB-I-AH-TERM                 PIC S999   COMP-3.
000135         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
000136         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
000137         16  PB-I-SKIP-CODE               PIC X.
000138             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
000139             88  PB-SKIP-JULY              VALUE '1'.
000140             88  PB-SKIP-AUGUST            VALUE '2'.
000141             88  PB-SKIP-SEPTEMBER         VALUE '3'.
000142             88  PB-SKIP-JULY-AUG          VALUE '4'.
000143             88  PB-SKIP-AUG-SEPT          VALUE '5'.
000144             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
000145             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
000146             88  PB-SKIP-JUNE              VALUE '8'.
000147             88  PB-SKIP-JUNE-JULY         VALUE '9'.
000148             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
000149             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
000150         16  PB-I-TERM-TYPE               PIC X.
000151             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
000152             88  PB-PAID-WEEKLY            VALUE 'W'.
000153             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
000154             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
000155             88  PB-PAID-13-YEARLY         VALUE 'T'.
000156         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
000157         16  PB-I-POLICY-FORM-NO          PIC X(12).
000158         16  PB-I-DATA-ENTRY-SW           PIC X.
000159             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
000160             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
000161             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
000162             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
000163         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
000164         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
000165*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
000166         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
000167         16  PB-I-LETTER-REQD             PIC X.
000168
000169         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
000170             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
000171             88  PB-INVALID-LIFE             VALUE '  ' '00'
000172                                                   '90' THRU '99'.
000173         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
000174                                          PIC XX.
000175         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
000176         16  PB-I-AMOUNT-FINANCED REDEFINES
000177                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
000178         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
000179         16  PB-I-UNPAID-CASH-PRICE REDEFINES
000180                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
000181         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
000182         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
000183         16  PB-I-CLP-AMOUNT REDEFINES
000184                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
000185         16  PB-I-LF-CALC-FLAG            PIC X.
000186             88 PB-COMP-LF-PREM               VALUE '?'.
000187         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
000188         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
000189         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
000190         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
000191         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
000192         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
000193         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
000194         16  PB-I-LF-ABBR                 PIC XXX.
000195         16  PB-I-LF-INPUT-CD             PIC XX.
000196
000197         16  PB-I-AH-BENEFIT-CD           PIC XX.
000198             88  PB-VALID-AH                 VALUE '01' THRU '89'.
000199             88  PB-INVALID-AH               VALUE '  ' '00'
000200                                                   '90' THRU '99'.
000201         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
000202         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
000203         16  PB-I-AH-CALC-FLAG            PIC X.
000204             88 PB-COMP-AH-PREM                  VALUE '?'.
000205         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
000206         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
000207         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
000208         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
000209         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
000210         16  PB-I-AH-ABBR                 PIC XXX.
000211         16  PB-I-AH-INPUT-CD             PIC XXX.
000212
000213         16  PB-I-SPECIAL-REIN-CODE       PIC X.
000214         16  PB-I-REIN-TABLE              PIC XXX.
000215         16  PB-I-BUSINESS-TYPE           PIC 99.
000216         16  PB-I-INDV-GRP-CD             PIC X.
000217         16  PB-I-MORT-CODE.
000218             20  PB-I-TABLE               PIC X.
000219             20  PB-I-INTEREST            PIC XX.
000220             20  PB-I-MORT-TYP            PIC X.
000221         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
000222         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
000223         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
000224         16  PB-I-INDV-GRP-OVRD           PIC X.
000225         16  PB-I-RATE-CLASS-OVRD         PIC XX.
000226         16  PB-I-SIG-SW                  PIC X.
000227             88  PB-POLICY-SIGNED             VALUE 'Y'.
000228         16  PB-I-RATE-CLASS              PIC XX.
000229         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
000230         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
000231         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
000232         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
000233         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
000234         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
000235         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
000236         16  PB-I-BENEFIT-TYPE            PIC XXX.
000237         16  PB-I-OB-FLAG                 PIC X.
000238             88  PB-I-OB                      VALUE 'B'.
000239             88  PB-I-SUMMARY                 VALUE 'Z'.
000240         16  PB-I-ENTRY-STATUS            PIC X.
000241             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
000242                                              'M' '5' '9' '2'.
000243             88  PB-I-NORMAL-ENTRY            VALUE '1'.
000244             88  PB-I-POLICY-PENDING          VALUE '2'.
000245             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
000246             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
000247             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
000248             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
000249             88  PB-I-REIN-ONLY               VALUE '9'.
000250             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
000251             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
000252             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
000253             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
000254         16  PB-I-INT-CODE                PIC X.
000255             88  PB-ADD-ON-INTEREST           VALUE 'A'.
000256             88  PB-SIMPLE-INTEREST           VALUE 'S'.
000257         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
000258         16  PB-I-SOC-SEC-NO              PIC X(11).
000259         16  PB-I-MEMBER-NO               PIC X(12).
000260         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
000261*        16  PB-I-LOAN-OFFICER            PIC XXX.
000262         16  PB-I-OLD-LOF                 PIC XXX.
000263         16  PB-I-LF-EXPIRE-DT            PIC XX.
000264         16  PB-I-AH-EXPIRE-DT            PIC XX.
000265         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
000266         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
000267         16  PB-I-LIFE-INDICATOR          PIC X.
000268             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
000269         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
000270         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
000271                                          PIC S9(5)V99    COMP-3.
000272         16  PB-I-MAIL-ADDRS-SW           PIC X.
000273             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
000274             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
000275         16  PB-I-1ST-PMT-DT              PIC XX.
000276         16  PB-I-JOINT-INSURED.
000277             20 PB-I-JOINT-LAST-NAME      PIC X(15).
000278             20 PB-I-JOINT-FIRST-NAME.
000279                24  PB-I-JOINT-FIRST-INIT PIC X.
000280                24  FILLER                PIC X(9).
000281             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
000282*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
000283         16  PB-I-BENEFICIARY-NAME.
000284             20  PB-I-BANK-NUMBER         PIC X(10).
000285             20  FILLER                   PIC X(15).
000286         16  PB-I-LAST-ADD-ON-DT          PIC XX.
000287         16  PB-I-REFERENCE               PIC X(12).
000288         16  FILLER REDEFINES PB-I-REFERENCE.
000289             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
000290             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
000291             20  PB-I-CLP-STATE           PIC XX.
000292         16  PB-I-UNDERWRITING-STATUS     PIC X.
000293             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
000294             88  PB-I-POLICY-DECLINED         VALUE 'D'.
000295             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
000296         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
000297         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
000298         16  PB-I-RESIDENT-STATE          PIC XX.
000299         16  PB-I-RATE-CODE               PIC X(4).
000300         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
000301         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
000302         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
000303         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
000304         16  PB-I-BANK-NOCHRGB            PIC 99.
000305         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
000306         16  PB-I-JOINT-BIRTHDAY          PIC XX.
000307
000308     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
000309         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
000310             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
000311         16  PB-C-CANCEL-ORIGIN           PIC X.
000312             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
000313         16  PB-C-LF-CANCEL-DT            PIC XX.
000314         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
000315         16  PB-C-LF-CALC-REQ             PIC X.
000316             88 PB-COMP-LF-CANCEL            VALUE '?'.
000317         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
000318         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
000319         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
000320             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
000321         16  PB-C-AH-CANCEL-DT            PIC XX.
000322         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
000323         16  PB-C-AH-CALC-REQ             PIC X.
000324             88 PB-COMP-AH-CANCEL            VALUE '?'.
000325         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
000326         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
000327         16  PB-C-LAST-NAME               PIC X(15).
000328         16  PB-C-REFUND-SW               PIC X.
000329             88  PB-C-REFUND-CREATED          VALUE 'Y'.
000330             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
000331         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
000332         16  PB-C-PAYEE-CODE              PIC X(6).
000333         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
000334         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
000335         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
000336         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
000337         16  PB-C-REFERENCE               PIC X(12).
000338         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
000339         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
000340         16  PB-C-POST-CARD-IND           PIC X.
000341         16  PB-C-CANCEL-REASON           PIC X.
000342         16  PB-C-REF-INTERFACE-SW        PIC X.
000343         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
000344         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
000345         16  FILLER                       PIC X(01).
000346*        16  FILLER                       PIC X(18).
000347         16  PB-C-POLICY-FORM-NO          PIC X(12).
000348*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
000349         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
000350         16  PB-CANCELED-CERT-DATA.
000351             20  PB-CI-INSURED-NAME.
000352                 24  PB-CI-LAST-NAME      PIC X(15).
000353                 24  PB-CI-INITIALS       PIC XX.
000354             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
000355             20  PB-CI-INSURED-SEX        PIC X.
000356             20  PB-CI-LF-TERM            PIC S999        COMP-3.
000357             20  PB-CI-LF-BENEFIT-CD      PIC XX.
000358             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
000359             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
000360             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
000361             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
000362             20  PB-CI-AH-TERM            PIC S999        COMP-3.
000363             20  PB-CI-AH-BENEFIT-CD      PIC XX.
000364             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
000365             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
000366             20  PB-CI-RATE-CLASS         PIC XX.
000367             20  PB-CI-RATE-DEV-LF        PIC XXX.
000368             20  PB-CI-RATE-DEV-AH        PIC XXX.
000369             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
000370             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
000371             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
000372             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
000373             20  PB-CI-LF-ABBR            PIC X(3).
000374             20  PB-CI-AH-ABBR            PIC X(3).
000375             20  PB-CI-OB-FLAG            PIC X.
000376                 88  PB-CI-OB                VALUE 'B'.
000377             20  PB-CI-LF-POLICY-STATUS   PIC X.
000378                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
000379                                           'M' '4' '5' '9' '2'.
000380                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
000381                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
000382                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
000383                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
000384                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
000385                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
000386                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
000387                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
000388                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
000389                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
000390                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
000391                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
000392                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
000393             20  PB-CI-AH-POLICY-STATUS   PIC X.
000394                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
000395                                           'M' '4' '5' '9' '2'.
000396                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
000397                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
000398                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
000399                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
000400                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
000401                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
000402                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
000403                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
000404                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
000405                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
000406                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
000407                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
000408                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
000409             20  PB-CI-PAY-FREQUENCY      PIC 99.
000410             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
000411             20  PB-CI-SOC-SEC-NO         PIC X(11).
000412             20  PB-CI-MEMBER-NO          PIC X(12).
000413             20  PB-CI-INT-CODE           PIC X.
000414                 88  PB-CI-ADD-ON                  VALUE 'A'.
000415                 88  PB-CI-SIMPLE                  VALUE 'S'.
000416             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
000417             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
000418             20  PB-CI-COMP-EXCP-SW       PIC X.
000419                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
000420                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
000421             20  PB-CI-ENTRY-STATUS       PIC X.
000422             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
000423             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
000424             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
000425             20  PB-CI-DEATH-DT           PIC XX.
000426             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
000427             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
000428             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
000429             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
000430             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
000431             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
000432             20  PB-CI-ENTRY-DT              PIC XX.
000433             20  PB-CI-ENTRY-BATCH           PIC X(6).
000434             20  PB-CI-LF-EXPIRE-DT          PIC XX.
000435             20  PB-CI-AH-EXPIRE-DT          PIC XX.
000436             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
000437             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
000438             20  PB-CI-OLD-LOF               PIC XXX.
000439*            20  PB-CI-LOAN-OFFICER          PIC XXX.
000440             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
000441             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
000442             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
000443             20  PB-CI-INDV-GRP-CD           PIC X.
000444             20  PB-CI-BENEFICIARY-NAME.
000445                 24  PB-CI-BANK-NUMBER       PIC X(10).
000446                 24  FILLER                  PIC X(15).
000447             20  PB-CI-NOTE-SW               PIC X.
000448             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
000449             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
000450             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
000451             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
000452             20  PB-CI-LOAN-OFFICER          PIC X(5).
000453             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
000454             20  PB-CI-FIRST-NAME            PIC X(10).
000455             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
000456
000457         16  FILLER                       PIC X(13).
000458*032306  16  FILLER                       PIC X(27).
000459*        16  FILLER                       PIC X(46).
000460
000461     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
000462         16  FILLER                       PIC X(10).
000463         16  PB-M-INSURED-LAST-NAME       PIC X(15).
000464         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
000465         16  PB-M-INSURED-MID-INIT        PIC X.
000466         16  PB-M-INSURED-AGE             PIC 99.
000467         16  PB-M-INSURED-BIRTHDAY        PIC XX.
000468         16  PB-M-INSURED-SEX             PIC X.
000469         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
000470         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
000471         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
000472         16  PB-M-INSURED-CITY-STATE.
000473             20  PB-M-INSURED-CITY        PIC X(28).
000474             20  PB-M-INSURED-STATE       PIC XX.
000475         16  PB-M-INSURED-ZIP-CODE.
000476             20  PB-M-INSURED-ZIP-PRIME.
000477                 24  PB-M-INSURED-ZIP-1   PIC X.
000478                     88  PB-M-CANADIAN-POST-CODE
000479                                             VALUE 'A' THRU 'Z'.
000480                 24  FILLER               PIC X(4).
000481             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
000482         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
000483                                        PB-M-INSURED-ZIP-CODE.
000484             20  PM-M-INS-CAN-POST1       PIC XXX.
000485             20  PM-M-INS-CAN-POST2       PIC XXX.
000486             20  FILLER                   PIC XXX.
000487         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
000488         16  PB-M-JOINT-BIRTHDAY          PIC XX.
000489         16  PB-M-CRED-BENE-NAME          PIC X(30).
000490         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
000491         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
000492         16  PB-M-CRED-BENE-CITYST.
000493             20  PB-M-CRED-BENE-CITY      PIC X(28).
000494             20  PB-M-CRED-BENE-STATE     PIC XX.
000495
000496         16  FILLER                       PIC X(92).
000497
000498     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
000499         16  FILLER                       PIC X(10).
000500         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
000501         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
000502         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
000503         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
000504         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
000505         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
000506         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
000507         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
000508         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
000509         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
000510         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
000511         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
000512         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
000513         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
000514         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
000515         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
000516         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
000517         16  PB-ACCOUNT-NAME              PIC X(30).
000518         16  PB-PREM-REF-RPT-FLAG         PIC X.
000519         16  PB-REFERENCE                 PIC X(12).
000520         16  PB-B-RECEIVED-DT             PIC XX.
000521         16  FILLER                       PIC X(234).
000522
000523     12  PB-RECORD-STATUS.
000524         16  PB-CREDIT-SELECT-DT          PIC XX.
000525         16  PB-CREDIT-ACCEPT-DT          PIC XX.
000526         16  PB-BILLED-DT                 PIC XX.
000527         16  PB-BILLING-STATUS            PIC X.
000528             88  PB-ENTRY-REVERSED            VALUE 'R'.
000529             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
000530             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
000531         16  PB-RECORD-BILL               PIC X.
000532             88  PB-RECORD-ON-HOLD            VALUE 'H'.
000533             88  PB-RECORD-RETURNED           VALUE 'R'.
000534             88  PB-RECORD-ENDORSED           VALUE 'E'.
000535             88  PB-OVERRIDE-LIFE             VALUE 'L'.
000536             88  PB-OVERRIDE-AH               VALUE 'A'.
000537             88  PB-OVERRIDE-BOTH             VALUE 'B'.
000538         16  PB-BATCH-ENTRY               PIC X.
000539             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
000540             88  PB-REIN-ONLY-CERT            VALUE 'R'.
000541             88  PB-REISSUED-CERT             VALUE 'E'.
000542             88  PB-CASH-CERT                 VALUE 'C'.
000543             88  PB-MONTHLY-CERT              VALUE 'M'.
000544             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
000545             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
000546             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
000547         16  PB-FORCE-CODE                PIC X.
000548             88  PB-FORCE-OFF                 VALUE ' ' '0'.
000549             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
000550             88  PB-CANCEL-FORCE              VALUE '8'.
000551             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
000552             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
000553             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
000554             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
000555             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
000556             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
000557             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
000558             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
000559         16  PB-FATAL-FLAG                PIC X.
000560             88  PB-FATAL-ERRORS              VALUE 'X'.
000561         16  PB-FORCE-ER-CD               PIC X.
000562             88  PB-FORCE-ERRORS              VALUE 'F'.
000563             88  PB-UNFORCED-ERRORS           VALUE 'X'.
000564         16  PB-WARN-ER-CD                PIC X.
000565             88  PB-WARNING-ERRORS            VALUE 'W'.
000566         16  FILLER                       PIC X.
000567         16  PB-OUT-BAL-CD                PIC X.
000568             88  PB-OUT-OF-BAL                VALUE 'O'.
000569         16  PB-LIFE-OVERRIDE-L1          PIC X.
000570         16  PB-AH-OVERRIDE-L1            PIC X.
000571         16  PB-INPUT-DT                  PIC XX.
000572         16  PB-INPUT-BY                  PIC X(4).
000573         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
000574         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
000575         16  PB-TOLERANCE-REJECT-SW       PIC X.
000576         16  PB-LF-EARNING-METHOD         PIC X.
000577         16  PB-AH-EARNING-METHOD         PIC X.
000578         16  PB-LF-TERM-CALC-METHOD       PIC X.
000579         16  PB-AH-TERM-CALC-METHOD       PIC X.
000580         16  PB-REIN-CD                   PIC XXX.
000581         16  PB-LF-REFUND-TYPE            PIC X.
000582         16  PB-AH-REFUND-TYPE            PIC X.
000583         16  PB-ACCT-EFF-DT               PIC XX.
000584         16  PB-ACCT-EXP-DT               PIC XX.
000585         16  PB-COMPANY-ID                PIC X(3).
000586         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
000587         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
000588         16  PB-SV-CARRIER                PIC X.
000589         16  PB-SV-GROUPING               PIC X(6).
000590         16  PB-SV-STATE                  PIC XX.
000591         16  PB-CONFIRMATION-REPT-DT      PIC XX.
000592         16  PB-GA-BILLING-INFO.
000593             20  PB-GA-BILL-DT OCCURS 5 TIMES
000594                                          PIC XX.
000595         16  PB-SV-REMIT-TO  REDEFINES
000596             PB-GA-BILLING-INFO           PIC X(10).
000597         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
000598         16  PB-I-LOAN-OFFICER            PIC X(5).
000599         16  PB-I-VIN                     PIC X(17).
000600
000601         16  FILLER                       PIC X(04).
000602         16  IMNET-BYPASS-SW              PIC X.
000603
000604******************************************************************
000605*                COMMON EDIT ERRORS                              *
000606******************************************************************
000607
000608     12  PB-COMMON-ERRORS.
000609         16  PB-COMMON-ERROR    OCCURS 10 TIMES
000610                                           PIC S9(4)     COMP.
000611
000612******************************************************************
      *<<((file: ERCPNDB))
001305*                                COPY ELCCERT.
      *>>((file: ELCCERT))
000001******************************************************************
000002*                                                                *
000003*                            ELCCERT.                            *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000005*                            VMOD=2.013                          *
000006*                                                                *
000007*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
000008*                                                                *
000009*   FILE TYPE = VSAM,KSDS                                        *
000010*   RECORD SIZE = 450  RECFORM = FIXED                           *
000011*                                                                *
000012*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
000013*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
000014*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
000015*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
000016*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
000017*                                                                *
000018*   LOG = YES                                                    *
000019*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000020******************************************************************
000021*                   C H A N G E   L O G
000022*
000023* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000024*-----------------------------------------------------------------
000025*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000026* EFFECTIVE    NUMBER
000027*-----------------------------------------------------------------
000028* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
000029* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
000030* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
000031* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
000032* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
000033* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
000034* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
000035* 032612  CR2011110200001  PEMA  AHL CHANGES
000036* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
000037* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
000038* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
000039******************************************************************
000040
000041 01  CERTIFICATE-MASTER.
000042     12  CM-RECORD-ID                      PIC XX.
000043         88  VALID-CM-ID                      VALUE 'CM'.
000044
000045     12  CM-CONTROL-PRIMARY.
000046         16  CM-COMPANY-CD                 PIC X.
000047         16  CM-CARRIER                    PIC X.
000048         16  CM-GROUPING.
000049             20  CM-GROUPING-PREFIX        PIC X(3).
000050             20  CM-GROUPING-PRIME         PIC X(3).
000051         16  CM-STATE                      PIC XX.
000052         16  CM-ACCOUNT.
000053             20  CM-ACCOUNT-PREFIX         PIC X(4).
000054             20  CM-ACCOUNT-PRIME          PIC X(6).
000055         16  CM-CERT-EFF-DT                PIC XX.
000056         16  CM-CERT-NO.
000057             20  CM-CERT-PRIME             PIC X(10).
000058             20  CM-CERT-SFX               PIC X.
000059
000060     12  CM-CONTROL-BY-NAME.
000061         16  CM-COMPANY-CD-A1              PIC X.
000062         16  CM-INSURED-LAST-NAME          PIC X(15).
000063         16  CM-INSURED-INITIALS.
000064             20  CM-INSURED-INITIAL1       PIC X.
000065             20  CM-INSURED-INITIAL2       PIC X.
000066
000067     12  CM-CONTROL-BY-SSN.
000068         16  CM-COMPANY-CD-A2              PIC X.
000069         16  CM-SOC-SEC-NO.
000070             20  CM-SSN-STATE              PIC XX.
000071             20  CM-SSN-ACCOUNT            PIC X(6).
000072             20  CM-SSN-LN3.
000073                 25  CM-INSURED-INITIALS-A2.
000074                     30 CM-INSURED-INITIAL1-A2   PIC X.
000075                     30 CM-INSURED-INITIAL2-A2   PIC X.
000076                 25 CM-PART-LAST-NAME-A2         PIC X.
000077
000078     12  CM-CONTROL-BY-CERT-NO.
000079         16  CM-COMPANY-CD-A4              PIC X.
000080         16  CM-CERT-NO-A4                 PIC X(11).
000081
000082     12  CM-CONTROL-BY-MEMB.
000083         16  CM-COMPANY-CD-A5              PIC X.
000084         16  CM-MEMBER-NO.
000085             20  CM-MEMB-STATE             PIC XX.
000086             20  CM-MEMB-ACCOUNT           PIC X(6).
000087             20  CM-MEMB-LN4.
000088                 25  CM-INSURED-INITIALS-A5.
000089                     30 CM-INSURED-INITIAL1-A5   PIC X.
000090                     30 CM-INSURED-INITIAL2-A5   PIC X.
000091                 25 CM-PART-LAST-NAME-A5         PIC XX.
000092
000093     12  CM-INSURED-PROFILE-DATA.
000094         16  CM-INSURED-FIRST-NAME.
000095             20  CM-INSURED-1ST-INIT       PIC X.
000096             20  FILLER                    PIC X(9).
000097         16  CM-INSURED-ISSUE-AGE          PIC 99.
000098         16  CM-INSURED-SEX                PIC X.
000099             88  CM-SEX-MALE                  VALUE 'M'.
000100             88  CM-SEX-FEMAL                 VALUE 'F'.
000101         16  CM-INSURED-JOINT-AGE          PIC 99.
000102         16  CM-JOINT-INSURED-NAME.
000103             20  CM-JT-LAST-NAME           PIC X(15).
000104             20  CM-JT-FIRST-NAME.
000105                 24  CM-JT-1ST-INIT        PIC X.
000106                 24  FILLER                PIC X(9).
000107             20  CM-JT-INITIAL             PIC X.
000108
000109     12  CM-LIFE-DATA.
000110         16  CM-LF-BENEFIT-CD              PIC XX.
000111         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
000112         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
000113         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
000114         16  CM-LF-DEV-CODE                PIC XXX.
000115         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
000116         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
000117         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
000118         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
000119         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
000120         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
000121         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
000122         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
000123         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
000124         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
000125         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
000126         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
000127         16  cm-temp-epiq                  pic xx.
000128             88  EPIQ-CLASS                  value 'EQ'.
000129*        16  FILLER                        PIC XX.
000130
000131     12  CM-AH-DATA.
000132         16  CM-AH-BENEFIT-CD              PIC XX.
000133         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
000134         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
000135         16  CM-AH-DEV-CODE                PIC XXX.
000136         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
000137         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
000138         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
000139         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
000140         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
000141         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
000142         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
000143         16  CM-AH-PAID-THRU-DT            PIC XX.
000144             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
000145         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
000146         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
000147         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
000148         16  FILLER                        PIC X.
000149
000150     12  CM-LOAN-INFORMATION.
000151         16  CM-LIVES                      PIC S9(7)     COMP-3.
000152         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
000153                                           PIC S9(5)V99  COMP-3.
000154         16  CM-BILLED                     PIC S9(7)     COMP-3.
000155         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
000156         16  CM-PAY-FREQUENCY              PIC S99.
000157         16  CM-LOAN-TERM                  PIC S999      COMP-3.
000158         16  CM-RATE-CLASS                 PIC XX.
000159         16  CM-BENEFICIARY                PIC X(25).
000160         16  CM-POLICY-FORM-NO             PIC X(12).
000161         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
000162         16  CM-LAST-ADD-ON-DT             PIC XX.
000163         16  CM-DEDUCTIBLE-AMOUNTS.
000164             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
000165             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
000166         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
000167             20  CM-RESIDENT-STATE         PIC XX.
000168             20  CM-RATE-CODE              PIC X(4).
000169             20  FILLER                    PIC XX.
000170         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
000171             20  CM-LOAN-OFFICER           PIC X(5).
000172             20  FILLER                    PIC XXX.
000173         16  CM-CSR-CODE                   PIC XXX.
000174         16  CM-UNDERWRITING-CODE          PIC X.
000175             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
000176         16  CM-POST-CARD-IND              PIC X.
000177         16  CM-REF-INTERFACE-SW           PIC X.
000178         16  CM-PREMIUM-TYPE               PIC X.
000179             88  CM-SING-PRM                  VALUE '1'.
000180             88  CM-O-B-COVERAGE              VALUE '2'.
000181             88  CM-OPEN-END                  VALUE '3'.
000182         16  CM-IND-GRP-TYPE               PIC X.
000183             88  CM-INDIVIDUAL                VALUE 'I'.
000184             88  CM-GROUP                     VALUE 'G'.
000185         16  CM-SKIP-CODE                  PIC X.
000186             88  NO-MONTHS-SKIPPED            VALUE SPACE.
000187             88  SKIP-JULY                    VALUE '1'.
000188             88  SKIP-AUGUST                  VALUE '2'.
000189             88  SKIP-SEPTEMBER               VALUE '3'.
000190             88  SKIP-JULY-AUG                VALUE '4'.
000191             88  SKIP-AUG-SEPT                VALUE '5'.
000192             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
000193             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
000194             88  SKIP-JUNE                    VALUE '8'.
000195             88  SKIP-JUNE-JULY               VALUE '9'.
000196             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
000197             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
000198         16  CM-PAYMENT-MODE               PIC X.
000199             88  PAY-MONTHLY                  VALUE SPACE.
000200             88  PAY-WEEKLY                   VALUE '1'.
000201             88  PAY-SEMI-MONTHLY             VALUE '2'.
000202             88  PAY-BI-WEEKLY                VALUE '3'.
000203             88  PAY-SEMI-ANUALLY             VALUE '4'.
000204         16  CM-LOAN-NUMBER                PIC X(8).
000205         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
000206         16  CM-OLD-LOF                    PIC XXX.
000207*        16  CM-LOAN-OFFICER               PIC XXX.
000208         16  CM-REIN-TABLE                 PIC XXX.
000209         16  CM-SPECIAL-REIN-CODE          PIC X.
000210         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
000211         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
000212         16  CM-LOAN-1ST-PMT-DT            PIC XX.
000213
000214     12  CM-STATUS-DATA.
000215         16  CM-ENTRY-STATUS               PIC X.
000216         16  CM-ENTRY-DT                   PIC XX.
000217
000218         16  CM-LF-STATUS-AT-CANCEL        PIC X.
000219         16  CM-LF-CANCEL-DT               PIC XX.
000220         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
000221
000222         16  CM-LF-STATUS-AT-DEATH         PIC X.
000223         16  CM-LF-DEATH-DT                PIC XX.
000224         16  CM-LF-DEATH-EXIT-DT           PIC XX.
000225
000226         16  CM-LF-CURRENT-STATUS          PIC X.
000227             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
000228                                                'M' '4' '5' '9'.
000229             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
000230             88  CM-LF-POLICY-PENDING         VALUE '2'.
000231             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
000232             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
000233             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
000234             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
000235             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
000236             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
000237             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
000238             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
000239             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
000240             88  CM-LF-DECLINED               VALUE 'D'.
000241             88  CM-LF-VOIDED                 VALUE 'V'.
000242
000243         16  CM-AH-STATUS-AT-CANCEL        PIC X.
000244         16  CM-AH-CANCEL-DT               PIC XX.
000245         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
000246
000247         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
000248         16  CM-AH-SETTLEMENT-DT           PIC XX.
000249         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
000250
000251         16  CM-AH-CURRENT-STATUS          PIC X.
000252             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
000253                                                'M' '4' '5' '9'.
000254             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
000255             88  CM-AH-POLICY-PENDING         VALUE '2'.
000256             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
000257             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
000258             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
000259             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
000260             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
000261             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
000262             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
000263             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
000264             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
000265             88  CM-AH-DECLINED               VALUE 'D'.
000266             88  CM-AH-VOIDED                 VALUE 'V'.
000267
000268         16  CM-CLAIM-INTERFACE-SW         PIC X.
000269             88  NO-CLAIM-ATTACHED            VALUE SPACE.
000270             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
000271             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
000272         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
000273
000274         16  CM-ENTRY-BATCH                PIC X(6).
000275         16  CM-LF-EXIT-BATCH              PIC X(6).
000276         16  CM-AH-EXIT-BATCH              PIC X(6).
000277         16  CM-LAST-MONTH-END             PIC XX.
000278
000279     12  CM-NOTE-SW                        PIC X.
000280         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
000281         88  CERT-NOTES-PRESENT               VALUE '1'.
000282         88  BILLING-NOTES-PRESENT            VALUE '2'.
000283         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
000284         88  CLAIM-NOTES-PRESENT              VALUE '4'.
000285         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
000286         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
000287         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
000288     12  CM-COMP-EXCP-SW                   PIC X.
000289         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
000290         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
000291     12  CM-INSURED-ADDRESS-SW             PIC X.
000292         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
000293         88  INSURED-ADDR-PRESENT             VALUE '1'.
000294
000295*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
000296     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
000297     12  FILLER                            PIC X.
000298
000299*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
000300     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
000301     12  FILLER                            PIC X.
000302*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
000303     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
000304
000305     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
000306         88  CERT-ADDED-BATCH                 VALUE ' '.
000307         88  CERT-ADDED-ONLINE                VALUE '1'.
000308         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
000309         88  CERT-PURGED-OFFLINE              VALUE '3'.
000310         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
000311     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
000312         88  CERT-AS-LOADED                   VALUE ' '.
000313         88  CERT-CANCELLED-ONLINE            VALUE '1'.
000314         88  CERT-CLAIM-ONLINE                VALUE '2'.
000315         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
000316         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
000317         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
000318         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
000319         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
000320
000321     12  CM-ACCOUNT-COMM-PCTS.
000322         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
000323         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
000324
000325     12  CM-USER-FIELD                     PIC X.
000326     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
000327     12  CM-CLP-STATE                      PIC XX.
000328     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
000329     12  CM-USER-RESERVED                  PIC XXX.
000330     12  FILLER REDEFINES CM-USER-RESERVED.
000331         16  CM-AH-CLASS-CD                PIC XX.
000332         16  F                             PIC X.
000333******************************************************************
      *<<((file: ELCCERT))
001306*                                COPY ERCNOTE.
      *>>((file: ERCNOTE))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCNOTE                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.003                          *
000007*                                                                *
000008*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
000009*                                                                *
000010*        FILE TYPE= VSAM,KSDS                                    *
000011*        RECORD SIZE = 825    RECFORM = FIXED                    *
000012*                                                                *
000013*        BASE CLUSTER = ERNOTE        RKP=2,LEN=34               *
000014*                                                                *
000015*        LOG = YES                                               *
000016*        SERVREQ = DELETE,UPDATE,NEWREC                          *
000017*                                                                *
000018******************************************************************
000019*                   C H A N G E   L O G
000020*
000021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000022*-----------------------------------------------------------------
000023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000024* EFFECTIVE    NUMBER
000025*-----------------------------------------------------------------
000026* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
000027*                                FILE WILL CONTAIN BILLING NOTES O
000028* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
000029******************************************************************
000030
000031 01  CERTIFICATE-NOTE.
000032     12  CN-RECORD-ID                PIC  XX.
000033         88  VALID-CN-ID                  VALUE 'CN'.
000034
000035     12  CN-CONTROL-PRIMARY.
000036         16  CN-COMPANY-CD           PIC X.
000037         16  CN-CARRIER              PIC X.
000038         16  CN-GROUPING.
000039             20 CN-GROUPING-PREFIX   PIC XXX.
000040             20 CN-GROUPING-PRIME    PIC XXX.
000041         16  CN-STATE                PIC XX.
000042         16  CN-ACCOUNT.
000043             20 CN-ACCOUNT-PREFIX    PIC X(4).
000044             20 CN-ACCOUNT-PRIME     PIC X(6).
000045         16  CN-CERT-EFF-DT          PIC XX.
000046         16  CN-CERT-NO.
000047             20  CN-CERT-PRIME       PIC X(10).
000048             20  CN-CERT-SFX         PIC X.
000049         16  CN-RECORD-TYPE          PIC X.
000050             88  CN-ISSUE-BILLING-NOTE    VALUE '1'.
000051             88  CN-CANCEL-BILLING-NOTE   VALUE '2'.
000052     12  CN-BILLING-START-LINE-NO    PIC 99.
000053     12  CN-BILLING-END-LINE-NO      PIC 99.
000054
000055     12  CN-LINES.
000056         16  CN-LINE OCCURS 10       PIC X(77).
000057
000058     12  CN-LAST-MAINT-DT            PIC XX.
000059     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
000060     12  CN-LAST-MAINT-USER          PIC X(4).
000061     12  FILLER                      PIC X(5).
000062******************************************************************
      *<<((file: ERCNOTE))
001307*                                COPY ERCPNDM.
      *>>((file: ERCPNDM))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCPNDM                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.003                          *
000007*                                                                *
000008*   FILE DESCRIPTION = PENDING MAILING DATA                      *
000009*                                                                *
000010*   FILE TYPE = VSAM,KSDS                                        *
000011*   RECORD SIZE = 374   RECFORM = FIX                            *
000012*                                                                *
000013*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
000014*   ALTERNATE PATH    = NOT USED                                 *
000015*                                                                *
000016*   LOG = YES                                                    *
000017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000018******************************************************************
000019*                   C H A N G E   L O G
000020*
000021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000022*-----------------------------------------------------------------
000023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000024* EFFECTIVE    NUMBER
000025*-----------------------------------------------------------------
000026* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
000027* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
000028* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
000029* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
000030******************************************************************
000031
000032 01  PENDING-MAILING-DATA.
000033     12  PM-RECORD-ID                      PIC XX.
000034         88  VALID-MA-ID                       VALUE 'PM'.
000035
000036     12  PM-CONTROL-PRIMARY.
000037         16  PM-COMPANY-CD                 PIC X.
000038         16  PM-ENTRY-BATCH                PIC X(6).
000039         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
000040         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
000041
000042     12  FILLER                            PIC X(14).
000043
000044     12  PM-ACCESS-CONTROL.
000045         16  PM-SOURCE-SYSTEM              PIC XX.
000046             88  PM-FROM-CREDIT                VALUE 'CR'.
000047             88  PM-FROM-VSI                   VALUE 'VS'.
000048             88  PM-FROM-WARRANTY              VALUE 'WA'.
000049             88  PM-FROM-OTHER                 VALUE 'OT'.
000050         16  PM-RECORD-ADD-DT              PIC XX.
000051         16  PM-RECORD-ADDED-BY            PIC XXXX.
000052         16  PM-LAST-MAINT-DT              PIC XX.
000053         16  PM-LAST-MAINT-BY              PIC XXXX.
000054         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
000055
000056     12  PM-PROFILE-INFO.
000057         16  PM-QUALIFY-CODE-1             PIC XX.
000058         16  PM-QUALIFY-CODE-2             PIC XX.
000059         16  PM-QUALIFY-CODE-3             PIC XX.
000060         16  PM-QUALIFY-CODE-4             PIC XX.
000061         16  PM-QUALIFY-CODE-5             PIC XX.
000062
000063         16  PM-INSURED-LAST-NAME          PIC X(15).
000064         16  PM-INSURED-FIRST-NAME         PIC X(10).
000065         16  PM-INSURED-MIDDLE-INIT        PIC X.
000066         16  PM-INSURED-ISSUE-AGE          PIC 99.
000067         16  PM-INSURED-BIRTH-DT           PIC XX.
000068         16  PM-INSURED-SEX                PIC X.
000069             88  PM-SEX-MALE                   VALUE 'M'.
000070             88  PM-SEX-FEMALE                 VALUE 'F'.
000071         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
000072
000073         16  PM-ADDRESS-CORRECTED          PIC X.
000074         16  PM-JOINT-BIRTH-DT             PIC XX.
000075*        16  FILLER                        PIC X(12).
000076
000077         16  PM-ADDRESS-LINE-1             PIC X(30).
000078         16  PM-ADDRESS-LINE-2             PIC X(30).
000079         16  PM-CITY-STATE.
000080             20  PM-CITY                   PIC X(28).
000081             20  PM-STATE                  PIC XX.
000082         16  PM-ZIP.
000083             20  PM-ZIP-CODE.
000084                 24  PM-ZIP-1              PIC X.
000085                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
000086                 24  FILLER                PIC X(4).
000087             20  PM-ZIP-PLUS4              PIC X(4).
000088         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
000089             20  PM-CAN-POST1              PIC XXX.
000090             20  PM-CAN-POST2              PIC XXX.
000091             20  FILLER                    PIC XXX.
000092
000093         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
000094         16  pm-city-st-zip-verified       pic x.
000095         16  FILLER                        PIC XX.
000096
000097     12  PM-CRED-BENE-INFO.
000098         16  PM-CRED-BENE-NAME             PIC X(25).
000099         16  PM-CRED-BENE-ADDR             PIC X(30).
000100         16  PM-CRED-BENE-ADDR2            PIC X(30).
000101         16  PM-CRED-BENE-CTYST.
000102             20  PM-CRED-BENE-CITY         PIC X(28).
000103             20  PM-CRED-BENE-STATE        PIC XX.
000104         16  PM-CRED-BENE-ZIP.
000105             20  PM-CB-ZIP-CODE.
000106                 24  PM-CB-ZIP-1           PIC X.
000107                     88  PM-CB-CANADIAN-POST-CODE
000108                                  VALUE 'A' THRU 'Z'.
000109                 24  FILLER                PIC X(4).
000110             20  PM-CB-ZIP-PLUS4           PIC X(4).
000111         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
000112             20  PM-CB-CAN-POST1           PIC XXX.
000113             20  PM-CB-CAN-POST2           PIC XXX.
000114             20  FILLER                    PIC XXX.
000115     12  PM-POST-CARD-MAIL-DATA.
000116         16  PM-MAIL-DATA OCCURS 7.
000117             20  PM-MAIL-TYPE              PIC X.
000118                 88  PM-12MO-MAILING           VALUE '1'.
000119                 88  PM-EXP-MAILING            VALUE '2'.
000120             20  PM-MAIL-STATUS            PIC X.
000121                 88  PM-MAIL-ST-MAILED         VALUE '1'.
000122                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
000123                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
000124             20  PM-MAIL-DATE              PIC XX.
000125     12  FILLER                            PIC XX.
000126     12  FILLER                            PIC X(12).
000127*    12  FILLER                            PIC X(30).
000128
000129******************************************************************
      *<<((file: ERCPNDM))
001308*                                COPY ERCMAIL.
      *>>((file: ERCMAIL))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCMAIL                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.003                          *
000007*                                                                *
000008*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
000009*                                                                *
000010*   FILE TYPE = VSAM,KSDS                                        *
000011*   RECORD SIZE = 374   RECFORM = FIX                            *
000012*                                                                *
000013*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
000014*   ALTERNATE PATH    = NOT USED                                 *
000015*                                                                *
000016*   LOG = YES                                                    *
000017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000018******************************************************************
000019*                   C H A N G E   L O G
000020*
000021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000022*-----------------------------------------------------------------
000023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000024* EFFECTIVE    NUMBER
000025*-----------------------------------------------------------------
000026* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
000027* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
000028* 111108                   PEMA  ADD CRED BENE ADDR2
000029******************************************************************
000030
000031 01  MAILING-DATA.
000032     12  MA-RECORD-ID                      PIC XX.
000033         88  VALID-MA-ID                       VALUE 'MA'.
000034
000035     12  MA-CONTROL-PRIMARY.
000036         16  MA-COMPANY-CD                 PIC X.
000037         16  MA-CARRIER                    PIC X.
000038         16  MA-GROUPING.
000039             20  MA-GROUPING-PREFIX        PIC XXX.
000040             20  MA-GROUPING-PRIME         PIC XXX.
000041         16  MA-STATE                      PIC XX.
000042         16  MA-ACCOUNT.
000043             20  MA-ACCOUNT-PREFIX         PIC X(4).
000044             20  MA-ACCOUNT-PRIME          PIC X(6).
000045         16  MA-CERT-EFF-DT                PIC XX.
000046         16  MA-CERT-NO.
000047             20  MA-CERT-PRIME             PIC X(10).
000048             20  MA-CERT-SFX               PIC X.
000049
000050     12  FILLER                            PIC XX.
000051
000052     12  MA-ACCESS-CONTROL.
000053         16  MA-SOURCE-SYSTEM              PIC XX.
000054             88  MA-FROM-CREDIT                VALUE 'CR'.
000055             88  MA-FROM-VSI                   VALUE 'VS'.
000056             88  MA-FROM-WARRANTY              VALUE 'WA'.
000057             88  MA-FROM-OTHER                 VALUE 'OT'.
000058         16  MA-RECORD-ADD-DT              PIC XX.
000059         16  MA-RECORD-ADDED-BY            PIC XXXX.
000060         16  MA-LAST-MAINT-DT              PIC XX.
000061         16  MA-LAST-MAINT-BY              PIC XXXX.
000062         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
000063
000064     12  MA-PROFILE-INFO.
000065         16  MA-QUALIFY-CODE-1             PIC XX.
000066         16  MA-QUALIFY-CODE-2             PIC XX.
000067         16  MA-QUALIFY-CODE-3             PIC XX.
000068         16  MA-QUALIFY-CODE-4             PIC XX.
000069         16  MA-QUALIFY-CODE-5             PIC XX.
000070
000071         16  MA-INSURED-LAST-NAME          PIC X(15).
000072         16  MA-INSURED-FIRST-NAME         PIC X(10).
000073         16  MA-INSURED-MIDDLE-INIT        PIC X.
000074         16  MA-INSURED-ISSUE-AGE          PIC 99.
000075         16  MA-INSURED-BIRTH-DT           PIC XX.
000076         16  MA-INSURED-SEX                PIC X.
000077             88  MA-SEX-MALE                   VALUE 'M'.
000078             88  MA-SEX-FEMALE                 VALUE 'F'.
000079         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
000080
000081         16  MA-ADDRESS-CORRECTED          PIC X.
000082         16  MA-JOINT-BIRTH-DT             PIC XX.
000083*        16  FILLER                        PIC X(12).
000084
000085         16  MA-ADDRESS-LINE-1             PIC X(30).
000086         16  MA-ADDRESS-LINE-2             PIC X(30).
000087         16  MA-CITY-STATE.
000088             20  MA-CITY                   PIC X(28).
000089             20  MA-ADDR-STATE             PIC XX.
000090         16  MA-ZIP.
000091             20  MA-ZIP-CODE.
000092                 24  MA-ZIP-CODE-1ST       PIC X(1).
000093                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
000094                 24  FILLER                PIC X(4).
000095             20  MA-ZIP-PLUS4              PIC X(4).
000096         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
000097             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
000098             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
000099             20  FILLER                    PIC X(3).
000100
000101         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
000102
000103         16  FILLER                        PIC XXX.
000104*        16  FILLER                        PIC X(10).
000105
000106
000107     12  MA-CRED-BENE-INFO.
000108         16  MA-CRED-BENE-NAME                 PIC X(25).
000109         16  MA-CRED-BENE-ADDR                 PIC X(30).
000110         16  MA-CRED-BENE-ADDR2                PIC X(30).
000111         16  MA-CRED-BENE-CTYST.
000112             20  MA-CRED-BENE-CITY             PIC X(28).
000113             20  MA-CRED-BENE-STATE            PIC XX.
000114         16  MA-CRED-BENE-ZIP.
000115             20  MA-CB-ZIP-CODE.
000116                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
000117                     88  MA-CB-CANADIAN-POST-CODE
000118                                           VALUE 'A' THRU 'Z'.
000119                 24  FILLER                    PIC X(4).
000120             20  MA-CB-ZIP-PLUS4               PIC X(4).
000121         16  MA-CB-CANADIAN-POSTAL-CODE
000122                            REDEFINES MA-CRED-BENE-ZIP.
000123             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
000124             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
000125             20  FILLER                        PIC X(3).
000126     12  MA-POST-CARD-MAIL-DATA.
000127         16  MA-MAIL-DATA OCCURS 7.
000128             20  MA-MAIL-TYPE              PIC X.
000129                 88  MA-12MO-MAILING           VALUE '1'.
000130                 88  MA-EXP-MAILING            VALUE '2'.
000131             20  MA-MAIL-STATUS            PIC X.
000132                 88  MA-MAIL-ST-MAILED         VALUE '1'.
000133                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
000134                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
000135             20  MA-MAIL-DATE              PIC XX.
000136     12  FILLER                            PIC XX.
000137     12  FILLER                            PIC XX.
000138*    12  FILLER                            PIC X(30).
000139******************************************************************
      *<<((file: ERCMAIL))
001309*                                COPY ERCRQST.
      *>>((file: ERCRQST))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCRQST.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.002                          *
000007*                                                                *
000008*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
000009*                                                                *
000010*   FILE TYPE = VSAM,KSDS                                        *
000011*   RECORD SIZE = 200  RECFORM = FIXED                           *
000012*                                                                *
000013*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
000014*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
000015*                                   ACCOUNT, REF, BATCH)         *
000016*                                                RKP=9, LEN=38   *
000017*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
000018*                                   ACCOUNT, REF, BATCH)         *
000019*                                                RKP=47, LEN=46  *
000020*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
000021*                                   BATCH)                       *
000022*                                                RKP=93, LEN=24  *
000023*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
000024*                                   REF, BATCH)                  *
000025*                                                RKP=117, LEN=35 *
000026*   LOG = NO                                                     *
000027*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000028******************************************************************
000029
000030 01  AR-REQUEST-RECORD.
000031     12  RQ-RECORD-ID                     PIC XX.
000032         88  VALID-RQ-ID                        VALUE 'RQ'.
000033
000034     12  RQ-CONTROL-PRIMARY.
000035         16  RQ-COMPANY-CD                PIC X.
000036         16  RQ-ENTRY-BATCH               PIC X(6).
000037
000038     12  RQ-CONTROL-BY-ACCT-REF.
000039         16  RQ-COMPANY-CD-A1             PIC X.
000040         16  RQ-CARRIER-A1                PIC X.
000041         16  RQ-GROUPING-A1               PIC X(6).
000042         16  RQ-STATE-A1                  PIC XX.
000043         16  RQ-ACCOUNT-A1                PIC X(10).
000044         16  RQ-REFERENCE-A1              PIC X(12).
000045         16  RQ-BATCH-A1                  PIC X(6).
000046
000047     12  RQ-CONTROL-BY-FIN-RESP.
000048         16  RQ-COMPANY-CD-A2             PIC X.
000049         16  RQ-CARRIER-A2                PIC X.
000050         16  RQ-GROUPING-A2               PIC X(6).
000051         16  RQ-FIN-RESP-A2               PIC X(10).
000052         16  RQ-ACCT-AGENT-A2             PIC X(10).
000053         16  RQ-REFERENCE-A2              PIC X(12).
000054         16  RQ-BATCH-A2                  PIC X(6).
000055
000056     12  RQ-CONTROL-BY-ACCT-AGENT.
000057         16  RQ-COMPANY-CD-A3             PIC X.
000058         16  RQ-CARRIER-A3                PIC X.
000059         16  RQ-GROUPING-A3               PIC X(6).
000060         16  RQ-ACCT-AGENT-A3             PIC X(10).
000061         16  RQ-BATCH-A3                  PIC X(6).
000062
000063     12  RQ-CONTROL-BY-SUMMARY.
000064         16  RQ-COMPANY-CD-A4             PIC X.
000065         16  RQ-SUMMARY-CODE              PIC X(6).
000066         16  RQ-ACCOUNT-A4                PIC X(10).
000067         16  RQ-REFERENCE-A4              PIC X(12).
000068         16  RQ-BATCH-A4                  PIC X(6).
000069
000070     12  RQ-REQUEST-METHOD                PIC X.
000071         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
000072         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
000073         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
000074         88 RQ-BATCH-REQUEST                  VALUE 'B'.
000075     12  FILLER                           PIC X.
000076     12  RQ-STATUS                        PIC X.
000077         88  RQ-REQUEST-ERROR                 VALUE 'E'.
000078         88  RQ-RESUBMIT                      VALUE 'R'.
000079     12  RQ-PROCESSOR-ID                  PIC X(4).
000080     12  RQ-ENTRY-DT                      PIC XX.
000081     12  RQ-MO-END-DT                     PIC XX.
000082     12  RQ-REQUEST-DT                    PIC XX.
000083     12  RQ-STMT-DT                       PIC XX.
000084     12  RQ-REVERSAL-DT                   PIC XX.
000085     12  RQ-CREDIT-SELECT-DT              PIC XX.
000086     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
000087
000088     12  FILLER                           PIC X(27).
000089
000090******************************************************************
000091
      *<<((file: ERCRQST))
001310*                                COPY ERCLOFC.
      *>>((file: ERCLOFC))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCLOFC                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.003                          *
000007*                                                                *
000008*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
000009*                                                                *
000010*   FILE TYPE = VSAM,KSDS                                        *
000011*   RECORD SIZE = 670   RECFORM = FIX                            *
000012*                                                                *
000013*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
000014*                                                                *
000015*   LOG = YES                                                    *
000016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000017*                                                                *
000018******************************************************************
000019
000020 01  LOAN-OFFICER-MASTER.
000021     12  LO-RECORD-ID                PIC XX.
000022         88  VALID-LO-ID                VALUE 'LO'.
000023
000024     12  LO-CONTROL-PRIMARY.
000025         16  LO-COMPANY-CD           PIC X.
000026         16  LO-CARRIER              PIC X.
000027         16  LO-GROUPING.
000028             20  LO-GROUPING-PREFIX  PIC XXX.
000029             20  LO-GROUPING-PRIME   PIC XXX.
000030         16  LO-STATE                PIC XX.
000031         16  LO-ACCOUNT.
000032             20  LO-ACCOUNT-PREFIX   PIC X(4).
000033             20  LO-ACCOUNT-PRIME    PIC X(6).
000034         16  LO-OFFICER-CODE         PIC X(5).
000035
000036     12  LO-OFFICER-NAME             PIC X(30).
000037
000038     12  LO-LAST-MAINT-DT            PIC XX.
000039     12  LO-LAST-USER                PIC X(4).
000040     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
000041
000042     12  LO-COMP-CONTROL             PIC X.
000043             88  LO-SHOW-COMP           VALUE 'Y'.
000044             88  LO-SUPPRESS-COMP       VALUE 'N'.
000045     12  LO-DETAIL-CONTROL           PIC X.
000046             88  LO-PRINT-DETAIL        VALUE 'D'.
000047             88  LO-PRINT-SUMMARY       VALUE 'S'.
000048
000049     12  LO-SV-CARRIER               PIC X.
000050     12  LO-SV-GROUPING              PIC X(6).
000051     12  LO-SV-STATE                 PIC XX.
000052
000053     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
000054     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
000055
000056     12  LO-OFFICER-INFO.
000057         16  FILLER OCCURS 12 TIMES.
000058             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
000059             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
000060             20  LO-LF-COUNT         PIC S9(5) COMP-3.
000061             20  LO-LF-PREM          PIC S9(7) COMP-3.
000062             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
000063             20  LO-AH-COUNT         PIC S9(5) COMP-3.
000064             20  LO-AH-PREM          PIC S9(7) COMP-3.
000065             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
000066     12  FILLER                      PIC X(198).
000067******************************************************************
      *<<((file: ERCLOFC))
001311*                                COPY ERCPYAJ.
      *>>((file: ERCPYAJ))
000001******************************************************************
000002*                                                                *
000003*                            ERCPYAJ                             *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000005*                            VMOD=2.015                          *
000006*                                                                *
000007*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
000008*                                                                *
000009*                                                                *
000010*   FILE TYPE = VSAM,KSDS                                        *
000011*   RECORD SIZE = 200  RECFORM = FIXED                           *
000012*                                                                *
000013*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
000014*       ALTERNATE PATHS = NONE                                   *
000015*                                                                *
000016*   LOG = YES                                                    *
000017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000018******************************************************************
000019******************************************************************
000020*                   C H A N G E   L O G
000021*
000022* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000023*-----------------------------------------------------------------
000024*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000025* EFFECTIVE    NUMBER
000026*-----------------------------------------------------------------
000027* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
000028* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
000029******************************************************************
000030
000031 01  PENDING-PAY-ADJ.
000032     12  PY-RECORD-ID                     PIC XX.
000033         88  VALID-PY-ID                        VALUE 'PY'.
000034
000035     12  PY-CONTROL-PRIMARY.
000036         16  PY-COMPANY-CD                PIC X.
000037         16  PY-CARRIER                   PIC X.
000038         16  PY-GROUPING                  PIC X(6).
000039         16  PY-FIN-RESP                  PIC X(10).
000040         16  PY-ACCOUNT                   PIC X(10).
000041         16  PY-PRODUCER REDEFINES PY-ACCOUNT
000042                                          PIC X(10).
000043         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
000044         16  PY-RECORD-TYPE               PIC X.
000045             88  PY-REMIT-RECEIVED            VALUE 'R'.
000046             88  PY-DEPOSIT                   VALUE 'D'.
000047             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
000048             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
000049             88  PY-ADJ-DEPOSIT               VALUE 'T'.
000050             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
000051             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
000052             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
000053             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
000054             88  PY-FICA-ENTRY                VALUE 'F'.
000055             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
000056             88  PY-POLICY-FEE                VALUE 'W'.
000057             88  PY-DUE-PREM-ADJ              VALUE 'P'.
000058
000059     12  PY-PYMT-TYPE                     PIC X.
000060             88  PY-NEW-BUS-PYMT              VALUE 'B'.
000061             88  PY-REINS-PYMT                VALUE 'R'.
000062             88  PY-EXP-PYMT                  VALUE 'E'.
000063
000064     12  PY-BIL-INV                       PIC X(6).
000065     12  PY-REF-NO                        PIC X(12).
000066
000067     12  PY-LAST-MAINT-DT                 PIC XX.
000068     12  PY-LAST-MAINT-BY                 PIC X(4).
000069     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
000070
000071     12  PY-PYADJ-RECORD.
000072         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
000073         16  PY-ENTRY-COMMENT             PIC X(30).
000074         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
000075             20  PY-GL-ACCOUNT            PIC X(10).
000076             20  PY-GL-STATE              PIC X(02).
000077             20  PY-GL-CANC-SW            PIC X(01).
000078                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
000079                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
000080             20  PY-GL-COMMENT            PIC X(10).
000081             20  FILLER      REDEFINES PY-GL-COMMENT.
000082                 24  PY-GL-CHECK-NO       PIC 9(06).
000083                 24  FILLER               PIC X(04).
000084             20  FILLER                   PIC X(07).
000085         16  PY-SAVE-ACCOUNT              PIC X(10).
000086         16  PY-SAVE-TYPE                 PIC X(01).
000087
000088         16  PY-LETTERS.
000089             20  PY-LETTER OCCURS 3 TIMES
000090                           INDEXED BY PY-LET-NDX
000091                                          PIC X(04).
000092
000093         16  PY-ERCOMP-TYPE               PIC X.
000094             88  PY-ACCOUNT-TYPE              VALUE 'A'.
000095             88  PY-GA-TYPE                   VALUE 'G'.
000096             88  PY-BANK-TYPE                 VALUE 'B'.
000097         16  FILLER                       PIC X(05).
000098
000099     12  PY-RECORD-STATUS.
000100         16  PY-CREDIT-SELECT-DT          PIC XX.
000101         16  PY-CREDIT-ACCEPT-DT          PIC XX.
000102         16  PY-BILLED-DATE               PIC XX.
000103         16  PY-REPORTED-DT               PIC XX.
000104         16  PY-PMT-APPLIED               PIC X.
000105             88  PY-ACCOUNT-PMT               VALUE 'A'.
000106             88  PY-GA-PMT                    VALUE 'G'.
000107             88  PY-OVWRITE-PMT               VALUE 'O'.
000108             88  PY-NON-AR-PMT                VALUE 'N'.
000109         16  FILLER                       PIC X(5).
000110         16  PY-INPUT-DT                  PIC XX.
000111         16  PY-CHECK-NUMBER              PIC X(6).
000112         16  PY-VOID-SW                   PIC X.
000113             88  PY-CHECK-VOIDED              VALUE 'V'.
000114         16  PY-CHECK-ORIGIN-SW           PIC X.
000115             88  PY-BILLING-CHECK             VALUE 'B'.
000116             88  PY-REFUND-CHECK              VALUE 'R'.
000117             88  PY-GA-CHECK                  VALUE 'G'.
000118             88  PY-CHECK-WRITTEN             VALUE 'W'.
000119             88  PY-CHECK-REVERSAL            VALUE 'V'.
000120         16  PY-CHECK-WRITTEN-DT          PIC XX.
000121         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
000122         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
000123         16  PY-BILL-FLAG                 PIC X.
000124             88  PY-BILLED                    VALUE 'B'.
000125         16  PY-AR-FLAG                   PIC X.
000126             88  PY-AR-CYCLE                  VALUE 'C'.
000127             88  PY-AR-MONTH-END              VALUE 'M'.
000128         16  PY-AR-DATE                   PIC XX.
000129
000130     12  PY-GL-CODES.
000131         16  PY-GL-DB                     PIC X(14).
000132         16  PY-GL-CR                     PIC X(14).
000133         16  PY-GL-FLAG                   PIC X.
000134         16  PY-GL-DATE                   PIC XX.
000135
000136     12  PY-CANCEL-FEE-FLAG               PIC X(2).
000137     12  FILLER                           PIC X(3).
000138******************************************************************
000139
      *<<((file: ERCPYAJ))
001312*                                COPY ERCCNOT.
      *>>((file: ERCCNOT))
000001******************************************************************
000002*                                                                *
000003*                            ERCCNOT                             *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000005*                            VMOD=2.003                          *
000006*                                                                *
000007*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
000008*                                                                *
000009*        FILE TYPE= VSAM,KSDS                                    *
000010*        RECORD SIZE = 150    RECFORM = FIXED                    *
000011*                                                                *
000012*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
000013*                                                                *
000014*        LOG = YES                                               *
000015*        SERVREQ = DELETE,UPDATE,NEWREC                          *
000016*                                                                *
000017******************************************************************
000018*                   C H A N G E   L O G
000019*
000020* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000021*-----------------------------------------------------------------
000022*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000023* EFFECTIVE    NUMBER
000024*-----------------------------------------------------------------
000025* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
000026******************************************************************
000027
000028 01  CERT-NOTE-FILE.
000029     12  CZ-RECORD-ID                PIC  XX.
000030         88  VALID-CZ-ID                  VALUE 'CZ'.
000031
000032     12  CZ-CONTROL-PRIMARY.
000033         16  CZ-COMPANY-CD           PIC X.
000034         16  CZ-CARRIER              PIC X.
000035         16  CZ-GROUPING.
000036             20 CZ-GROUPING-PREFIX   PIC XXX.
000037             20 CZ-GROUPING-PRIME    PIC XXX.
000038         16  CZ-STATE                PIC XX.
000039         16  CZ-ACCOUNT.
000040             20 CZ-ACCOUNT-PREFIX    PIC X(4).
000041             20 CZ-ACCOUNT-PRIME     PIC X(6).
000042         16  CZ-CERT-EFF-DT          PIC XX.
000043         16  CZ-CERT-NO.
000044             20  CZ-CERT-PRIME       PIC X(10).
000045             20  CZ-CERT-SFX         PIC X.
000046         16  CZ-RECORD-TYPE          PIC X.
000047             88  CERT-NOTE           VALUE '1'.
000048             88  CLAIM-CERT-NOTE     VALUE '2'.
000049         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
000050
000051     12  CZ-LAST-MAINT-DT            PIC XX.
000052     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
000053     12  CZ-LAST-MAINT-USER          PIC X(4).
000054
000055     12  CZ-NOTE-INFORMATION.
000056         16  CZ-NOTE                 PIC X(63).
000057         16  FILLER                  PIC X(39).
000058******************************************************************
      *<<((file: ERCCNOT))
001313*                                COPY ELCMSTR.
      *>>((file: ELCMSTR))
000001******************************************************************
000002*                                                                *
000003*                            ELCMSTR.                            *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000005*                            VMOD=2.012                          *
000006*                                                                *
000007*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
000008*                                                                *
000009*   FILE TYPE = VSAM,KSDS                                        *
000010*   RECORD SIZE = 350  RECFORM = FIXED                           *
000011*                                                                *
000012*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
000013*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
000014*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
000015*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
000016*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
000017*                                                 RKP=75,LEN=21  *
000018*                                                                *
000019*   **** NOTE ****                                               *
000020*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
000021*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
000022*                                                                *
000023*   LOG = YES                                                    *
000024*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000025******************************************************************
000026*                   C H A N G E   L O G
000027*
000028* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000029*-----------------------------------------------------------------
000030*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000031* EFFECTIVE    NUMBER
000032*-----------------------------------------------------------------
000033* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
000034* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
000035* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
000036* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
000037* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
000038* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
000039* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
000040******************************************************************
000041 01  CLAIM-MASTER.
000042     12  CL-RECORD-ID                PIC XX.
000043         88  VALID-CL-ID         VALUE 'CL'.
000044
000045     12  CL-CONTROL-PRIMARY.
000046         16  CL-COMPANY-CD           PIC X.
000047         16  CL-CARRIER              PIC X.
000048         16  CL-CLAIM-NO             PIC X(7).
000049         16  CL-CERT-NO.
000050             20  CL-CERT-PRIME       PIC X(10).
000051             20  CL-CERT-SFX         PIC X.
000052
000053     12  CL-CONTROL-BY-NAME.
000054         16  CL-COMPANY-CD-A1        PIC X.
000055         16  CL-INSURED-LAST-NAME    PIC X(15).
000056         16  CL-INSURED-NAME.
000057             20  CL-INSURED-1ST-NAME PIC X(12).
000058             20  CL-INSURED-MID-INIT PIC X.
000059
000060     12  CL-CONTROL-BY-SSN.
000061         16  CL-COMPANY-CD-A2        PIC X.
000062         16  CL-SOC-SEC-NO.
000063             20  CL-SSN-STATE        PIC XX.
000064             20  CL-SSN-ACCOUNT      PIC X(6).
000065             20  CL-SSN-LN3          PIC X(3).
000066
000067     12  CL-CONTROL-BY-CERT-NO.
000068         16  CL-COMPANY-CD-A4        PIC X.
000069         16  CL-CERT-NO-A4.
000070             20  CL-CERT-A4-PRIME    PIC X(10).
000071             20  CL-CERT-A4-SFX      PIC X.
000072
000073     12  CL-CONTROL-BY-CCN.
000074         16  CL-COMPANY-CD-A5        PIC X.
000075         16  CL-CCN-A5.
000076             20  CL-CCN.
000077                 24  CL-CCN-PREFIX-A5 PIC X(4).
000078                 24  CL-CCN-PRIME-A5 PIC X(12).
000079             20  CL-CCN-FILLER-A5    PIC X(4).
000080
000081     12  CL-INSURED-PROFILE-DATA.
000082         16  CL-INSURED-BIRTH-DT     PIC XX.
000083         16  CL-INSURED-SEX-CD       PIC X.
000084             88  INSURED-IS-MALE        VALUE 'M'.
000085             88  INSURED-IS-FEMALE      VALUE 'F'.
000086             88  INSURED-SEX-UNKNOWN    VALUE ' '.
000087         16  CL-INSURED-OCC-CD       PIC X(6).
000088         16  FILLER                  PIC X(5).
000089
000090     12  CL-PROCESSING-INFO.
000091         16  CL-PROCESSOR-ID         PIC X(4).
000092         16  CL-CLAIM-STATUS         PIC X.
000093             88  CLAIM-IS-OPEN          VALUE 'O'.
000094             88  CLAIM-IS-CLOSED        VALUE 'C'.
000095         16  CL-CLAIM-TYPE           PIC X.
000096*            88  AH-CLAIM               VALUE 'A'.
000097*            88  LIFE-CLAIM             VALUE 'L'.
000098*            88  PROPERTY-CLAIM         VALUE 'P'.
000099*            88  IUI-CLAIM              VALUE 'I'.
000100*            88  GAP-CLAIM              VALUE 'G'.
000101*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
000102*            88  OTHER-CLAIM            VALUE 'O'.
000103         16  CL-CLAIM-PREM-TYPE      PIC X.
000104             88  SINGLE-PREMIUM         VALUE '1'.
000105             88  O-B-COVERAGE           VALUE '2'.
000106             88  OPEN-END-COVERAGE      VALUE '3'.
000107         16  CL-INCURRED-DT          PIC XX.
000108         16  CL-REPORTED-DT          PIC XX.
000109         16  CL-FILE-ESTABLISH-DT    PIC XX.
000110         16  CL-EST-END-OF-DISAB-DT  PIC XX.
000111         16  CL-LAST-PMT-DT          PIC XX.
000112         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
000113         16  CL-PAID-THRU-DT         PIC XX.
000114         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
000115         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
000116         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
000117         16  CL-PMT-CALC-METHOD      PIC X.
000118             88  CL-360-DAY-YR          VALUE '1'.
000119             88  CL-365-DAY-YR          VALUE '2'.
000120             88  CL-FULL-MONTHS         VALUE '3'.
000121         16  CL-CAUSE-CD             PIC X(6).
000122
000123         16  CL-PRIME-CERT-NO.
000124             20  CL-PRIME-CERT-PRIME PIC X(10).
000125             20  CL-PRIME-CERT-SFX   PIC X.
000126
000127         16  CL-SYSTEM-IDENTIFIER    PIC XX.
000128             88  CL-CREDIT-CLAIM        VALUE 'CR'.
000129             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
000130
000131         16  CL-MICROFILM-NO         PIC X(10).
000132         16  FILLER REDEFINES CL-MICROFILM-NO.
000133             20  CL-BENEFIT-PERIOD   PIC 99.
000134             20  FILLER              PIC X(8).
000135         16  CL-PROG-FORM-TYPE       PIC X.
000136         16  CL-LAST-ADD-ON-DT       PIC XX.
000137
000138         16  CL-LAST-REOPEN-DT       PIC XX.
000139         16  CL-LAST-CLOSE-DT        PIC XX.
000140         16  CL-LAST-CLOSE-REASON    PIC X(01).
000141             88  FINAL-PAID             VALUE '1'.
000142             88  CLAIM-DENIED           VALUE '2'.
000143             88  AUTO-CLOSE             VALUE '3'.
000144             88  MANUAL-CLOSE           VALUE '4'.
000145             88  BENEFITS-CHANGED       VALUE 'C'.
000146             88  SETUP-ERRORS           VALUE 'E'.
000147         16  CL-ASSOC-CERT-SEQU      PIC S99.
000148         16  CL-ASSOC-CERT-TOTAL     PIC S99.
000149         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
000150             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
000151         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
000152         16  FILLER                  PIC X.
000153
000154     12  CL-CERTIFICATE-DATA.
000155         16  CL-CERT-ORIGIN          PIC X.
000156             88  CERT-WAS-ONLINE        VALUE '1'.
000157             88  CERT-WAS-CREATED       VALUE '2'.
000158             88  COVERAGE-WAS-ADDED     VALUE '3'.
000159         16  CL-CERT-KEY-DATA.
000160             20  CL-CERT-CARRIER     PIC X.
000161             20  CL-CERT-GROUPING    PIC X(6).
000162             20  CL-CERT-STATE       PIC XX.
000163             20  CL-CERT-ACCOUNT.
000164                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
000165                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
000166             20  CL-CERT-EFF-DT      PIC XX.
000167
000168     12  CL-STATUS-CONTROLS.
000169         16  CL-PRIORITY-CD          PIC X.
000170             88  CONFIDENTIAL-DATA      VALUE '8'.
000171             88  HIGHEST-PRIORITY       VALUE '9'.
000172         16  CL-SUPV-ATTN-CD         PIC X.
000173             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
000174             88  SUPV-IS-REQUIRED       VALUE 'Y'.
000175         16  CL-PURGED-DT            PIC XX.
000176         16  CL-RESTORED-DT          PIC XX.
000177         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
000178         16  CL-NEXT-RESEND-DT       PIC XX.
000179         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
000180         16  CL-CRITICAL-PERIOD      PIC 99.
000181*        16  FILLER                  PIC XX.
000182         16  CL-LAST-MAINT-DT        PIC XX.
000183         16  CL-LAST-MAINT-USER      PIC X(4).
000184         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
000185         16  CL-LAST-MAINT-TYPE      PIC X.
000186             88  CLAIM-SET-UP           VALUE ' '.
000187             88  PAYMENT-MADE           VALUE '1'.
000188             88  LETTER-SENT            VALUE '2'.
000189             88  MASTER-WAS-ALTERED     VALUE '3'.
000190             88  MASTER-WAS-RESTORED    VALUE '4'.
000191             88  INCURRED-DATE-CHANGED  VALUE '5'.
000192             88  FILE-CONVERTED         VALUE '6'.
000193             88  CHANGE-OF-BENEFITS     VALUE 'C'.
000194             88  ERROR-CORRECTION       VALUE 'E'.
000195         16  CL-RELATED-CLAIM-NO     PIC X(7).
000196         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
000197         16  CL-BENEFICIARY          PIC X(10).
000198         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
000199         16  CL-DENIAL-TYPE          PIC X.
000200             88  CL-TYPE-DENIAL          VALUE '1'.
000201             88  CL-TYPE-RESCISSION      VALUE '2'.
000202             88  CL-TYPE-REFORMATION     VALUE '3'.
000203             88  CL-TYPE-REF-TO-RES      VALUE '4'.
000204             88  CL-TYPE-RECONSIDERED    VALUE '5'.
000205         16  CL-NO-OF-EXTENSIONS     PIC 99.
000206
000207         16  filler                  pic x(3).
000208*        16  CL-CRIT-PER-RECURRENT   PIC X.
000209*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
000210*        16  CL-RTW-DT               PIC XX.
000211
000212     12  CL-TRAILER-CONTROLS.
000213         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
000214             88  CL-1ST-TRL-AVAIL       VALUE +4095.
000215             88  CL-LAST-TRL-AVAIL      VALUE +100.
000216             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
000217         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
000218         16  FILLER                  PIC XX.
000219         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
000220         16  CL-ADDRESS-TRAILER-CNT.
000221             20  CL-INSURED-ADDR-CNT  PIC S9(1).
000222                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
000223             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
000224                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
000225             20  CL-BENIF-ADDR-CNT    PIC S9(1).
000226                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
000227             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
000228                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
000229             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
000230                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
000231             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
000232                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
000233             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
000234                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
000235
000236     12  CL-CV-REFERENCE-NO.
000237         16  CL-CV-REFNO-PRIME       PIC X(18).
000238         16  CL-CV-REFNO-SFX         PIC XX.
000239
000240     12  CL-FILE-LOCATION            PIC X(4).
000241
000242     12  CL-PROCESS-ERRORS.
000243         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
000244             88  NO-FATAL-ERRORS        VALUE ZERO.
000245         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
000246             88  NO-FORCABLE-ERRORS     VALUE ZERO.
000247
000248     12  CL-PRODUCT-CD               PIC X.
000249
000250     12  CL-CURRENT-KEY-DATA.
000251         16  CL-CURRENT-CARRIER      PIC X.
000252         16  CL-CURRENT-GROUPING     PIC X(6).
000253         16  CL-CURRENT-STATE        PIC XX.
000254         16  CL-CURRENT-ACCOUNT      PIC X(10).
000255
000256     12  CL-ASSOCIATES               PIC X.
000257         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
000258         88  CL-ASSOC-INTERFACE         VALUE 'I'.
000259         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
000260         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
000261
000262     12  CL-ACTIVITY-CODE            PIC 99.
000263     12  CL-ACTIVITY-MAINT-DT        PIC XX.
000264     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
000265
000266     12  CL-LAPSE-REPORT-CODE        PIC 9.
000267     12  CL-LAG-REPORT-CODE          PIC 9.
000268     12  CL-LOAN-TYPE                PIC XX.
000269     12  CL-LEGAL-STATE              PIC XX.
000270
000271     12  CL-YESNOSW                  PIC X.
000272     12  CL-ACCIDENT-CLAIM-SW        PIC X.
000273         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
000274         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
000275         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
000276     12  cl-insured-type             pic x.
000277         88  cl-claim-on-primary         value 'P'.
000278         88  cl-claim-on-co-borrower     value 'C'.
000279     12  cl-benefit-expiration-dt    PIC XX.
      *<<((file: ELCMSTR))
001314*                                COPY ERCENDT.
      *>>((file: ERCENDT))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCENDT.                            *
000005*                            VMOD=2.001                          *
000006*                                                                *
000007*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
000008*                                                                *
000009*   FILE TYPE = VSAM,KSDS                                        *
000010*   RECORD SIZE = 579  RECFORM = FIXED                           *
000011*                                                                *
000012*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
000013*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
000014*                                                                *
000015*   LOG = NO                                                     *
000016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000017******************************************************************
000018*-----------------------------------------------------------------
000019*                   C H A N G E   L O G
000020*
000021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000022*-----------------------------------------------------------------
000023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000024* EFFECTIVE    NUMBER
000025*-----------------------------------------------------------------
000026* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
000027*                                WITH OPEN CLAIMS
000028* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
000029* 110612    2012101700002  AJRA  ADD NEW FIELDS
000030* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
000031* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
000032*-----------------------------------------------------------------
000033
000034 01  ENDORSEMENT-RECORD.
000035     12  EN-RECORD-ID                PIC XX.
000036         88  VALID-EN-ID                VALUE 'EN'.
000037
000038     12  EN-CONTROL-PRIMARY.
000039         16  EN-COMPANY-CD           PIC X.
000040         16  EN-CARRIER              PIC X.
000041         16  EN-GROUPING             PIC X(6).
000042         16  EN-STATE                PIC XX.
000043         16  EN-ACCOUNT              PIC X(10).
000044         16  EN-CERT-EFF-DT          PIC XX.
000045         16  EN-CERT-NO.
000046             20  EN-CERT-PRIME       PIC X(10).
000047             20  EN-CERT-SFX         PIC X.
000048         16  EN-REC-TYPE             PIC X.
000049             88  EN-ISSUE               VALUE 'I'.
000050             88  EN-CANCELLATION        VALUE 'C'.
000051         16  EN-SEQ-NO               PIC 9(04) BINARY.
000052
000053     12  EN-CONTROL-BY-ARCH-NO.
000054         16  EN-COMPANY-CD-A1              PIC X.
000055         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
000056
000057     12  EN-LAST-MAINT-DT            PIC XX.
000058     12  EN-LAST-MAINT-BY            PIC X(4).
000059     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
000060
000061     12  EN-ENDORSEMENT-RECORD       PIC X(329).
000062
000063     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
000064         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
000065         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
000066         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
000067         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
000068         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
000069         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
000070         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
000071         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
000072         16  EN-LF-ORIG-BENCD        PIC XX.
000073         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
000074         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
000075         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
000076         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
000077         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
000078         16  EN-LF-ORIG-EXP-DT       PIC XX.
000079*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
000080         16  EN-ORIG-CRED-BENE       PIC X(25).
000081         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
000082         16  FILLER                  PIC X.
000083         16  EN-AH-ORIG-BENCD        PIC XX.
000084         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
000085         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
000086         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
000087         16  EN-AH-ORIG-EXP-DT       PIC XX.
000088*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
000089*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
000090         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
000091         16  F                       PIC X(09).
000092         16  EN-AH-ORIG-CP           PIC 99.
000093
000094         16  EN-INS-NEW-LAST-NAME    PIC X(15).
000095         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
000096         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
000097         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
000098         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
000099         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
000100         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
000101         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
000102         16  EN-LF-NEW-BENCD         PIC XX.
000103         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
000104         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
000105         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
000106         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
000107         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
000108         16  EN-LF-NEW-EXP-DT        PIC XX.
000109         16  EN-NEW-CRED-BENE        PIC X(25).
000110         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
000111         16  FILLER                  PIC X.
000112         16  EN-AH-NEW-BENCD         PIC XX.
000113         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
000114         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
000115         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
000116         16  EN-AH-NEW-EXP-DT        PIC XX.
000117*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
000118*        16  EN-AH-NEW-WAIT-PER      PIC 99.
000119*        16  F                       PIC X(12).
000120         16  EN-AH-NEW-CP            PIC 99.
000121         16  EN-SIG-SW               PIC X.
000122         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
000123         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
000124         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
000125         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
000126         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
000127         16  FILLER                  PIC X(33).
000128     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
000129         16  EN-LF-ORIG-REF-DT       PIC XX.
000130         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
000131         16  EN-AH-ORIG-REF-DT       PIC XX.
000132         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
000133         16  EN-LF-NEW-REF-DT        PIC XX.
000134         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
000135         16  EN-AH-NEW-REF-DT        PIC XX.
000136         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
000137         16  EN-FLAG-CERT            PIC X.
000138         16  EN-INS-LAST-NAME        PIC X(15).
000139         16  EN-INS-FIRST-NAME       PIC X(10).
000140         16  EN-INS-MIDDLE-INIT      PIC X.
000141         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
000142         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
000143         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
000144         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
000145         16  FILLER                  PIC X(262).
000146
000147     12  EN-MONEY-SW             PIC X.
000148     12  EN-HEALTH-APP           PIC X.
000149     12  EN-VOUCHER-SW           PIC X.
000150     12  EN-PAYEE                PIC X(14).
000151     12  EN-INPUT-DT             PIC XX.
000152     12  EN-PROCESS-DT           PIC XX.
000153     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
000154     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
000155
000156     12  EN-REASON-CODES.
000157         16  F OCCURS 12.
000158             20  EN-REASON-CODE  PIC X(4).
000159     12  EN-TEMPLATE-USED        PIC X(8).
000160     12  EN-DOCU-TYPE            PIC X.
000161         88  EN-VERI-DOCU          VALUE 'V'.
000162         88  EN-GCE-DOCU           VALUE 'G'.
000163         88  EN-CANC-DOCU          VALUE 'C'.
000164     12  EN-COMMENTS1            PIC X(13).
000165     12  EN-COMMENTS2            PIC X(70).
000166     12  EN-COMM-CHGBK           PIC X.
000167         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
000168         88  EN-CHG-ACCT           VALUE 'Y'.
000169     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
000170     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
000171     12  EN-BATCH-NUMBER         PIC X(6).
000172     12  EN-ACCT-SUMM            PIC X.
000173     12  EN-CSO-SUMM             PIC X.
000174     12  en-check-type           pic x.
000175     12  FILLER                  PIC X(12).
000176
000177******************************************************************
000178
      *<<((file: ERCENDT))
001315*                                COPY ELCCRTT.
      *>>((file: ELCCRTT))
000001******************************************************************
000002*                                                                *
000003*                            ELCCRTT.                            *
000004*                                                                *
000005*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
000006*                                                                *
000007*   FILE TYPE = VSAM,KSDS                                        *
000008*   RECORD SIZE = 552  RECFORM = FIXED                           *
000009*                                                                *
000010*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
000011*                                                                *
000012*   LOG = YES                                                    *
000013*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000014******************************************************************
000015*                   C H A N G E   L O G
000016*
000017* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000018*-----------------------------------------------------------------
000019*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000020* EFFECTIVE    NUMBER
000021*-----------------------------------------------------------------
000022* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
000023* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
000024* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
000025* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
000026* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
000027* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
000028* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
000029* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
000030* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
000031* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
000032* 091318  CR2018073000001  PEMA  ADD Refund methods
000033* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
000034******************************************************************
000035
000036 01  CERTIFICATE-TRAILERS.
000037     12  CS-RECORD-ID                      PIC XX.
000038         88  VALID-CS-ID                      VALUE 'CS'.
000039
000040     12  CS-CONTROL-PRIMARY.
000041         16  CS-COMPANY-CD                 PIC X.
000042         16  CS-CARRIER                    PIC X.
000043         16  CS-GROUPING                   PIC X(6).
000044         16  CS-STATE                      PIC XX.
000045         16  CS-ACCOUNT                    PIC X(10).
000046         16  CS-CERT-EFF-DT                PIC XX.
000047         16  CS-CERT-NO.
000048             20  CS-CERT-PRIME             PIC X(10).
000049             20  CS-CERT-SFX               PIC X.
000050         16  CS-TRAILER-TYPE               PIC X.
000051             88  COMM-TRLR           VALUE 'A'.
000052             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
000053             88  CERT-DATA-TRLR      VALUE 'C'.
000054
000055     12  CS-DATA-AREA                      PIC X(516).
000056
000057     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
000058         16  CS-BANK-COMMISSION-AREA.
000059             20  CS-BANK-COMMS       OCCURS 10.
000060                 24  CS-AGT                PIC X(10).
000061                 24  CS-COM-TYP            PIC X.
000062                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
000063                 24  CS-RECALC-LV-INDIC    PIC X.
000064                 24  FILLER                PIC X(10).
000065
000066         16  FILLER                        PIC X(256).
000067
000068     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
000069****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
000070
000071         16  CS-MB-CLAIM-DATA OCCURS 24.
000072             20  CS-CLAIM-NO               PIC X(7).
000073             20  CS-CLAIM-TYPE             PIC X.
000074                 88  CS-AH-CLM               VALUE 'A'.
000075                 88  CS-IU-CLM               VALUE 'I'.
000076                 88  CS-GP-CLM               VALUE 'G'.
000077                 88  CS-LF-CLM               VALUE 'L'.
000078                 88  CS-PR-CLM               VALUE 'P'.
000079                 88  CS-FL-CLM               VALUE 'F'.
000080                 88  CS-OT-CLM               VALUE 'O'.
000081             20  CS-INSURED-TYPE           PIC X.
000082                 88  CS-PRIM-INSURED          VALUE 'P'.
000083                 88  CS-CO-BORROWER           VALUE 'C'.
000084             20  CS-BENEFIT-PERIOD         PIC 99.
000085             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
000086             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
000087             20  CS-REMAINING-BENS         PIC S999 COMP-3.
000088         16  FILLER                        PIC X(12).
000089
000090     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
000091         16  CS-VIN-NUMBER                 PIC X(17).
000092         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
000093         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
000094         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
000095         16  cs-agent-name.
000096             20  cs-agent-fname            pic x(20).
000097             20  cs-agent-mi               pic x.
000098             20  cs-agent-lname            pic x(25).
000099         16  cs-license-no                 pic x(15).
000100         16  cs-npn-number                 pic x(10).
000101         16  cs-agent-edit-status          pic x.
000102             88  cs-ae-refer-to-manager      value 'M'.
000103             88  cs-ae-cover-sheet           value 'C'.
000104             88  cs-ae-sig-form              value 'S'.
000105             88  cs-ae-verified              value 'V'.
000106             88  cs-unidentified-signature   value 'U'.
000107             88  cs-cert-returned            value 'R'.
000108             88  cs-accept-no-commission     value 'N'.
000109         16  cs-year                       pic 9999.
000110         16  cs-make                       pic x(20).
000111         16  cs-model                      pic x(20).
000112         16  cs-future                     pic x(20).
000113         16  cs-vehicle-odometer           pic s9(7) comp-3.
000114         16  cs-claim-verification-status  pic x.
000115             88  cs-clm-ver-eligible         value 'A'.
000116             88  cs-clm-ver-partial-elig     value 'B'.
000117             88  cs-clm-ver-not-eligible     value 'C'.
000118             88  cs-clm-ver-not-elig-opn-clm value 'D'.
000119             88  cs-clm-ver-not-part-elig-rw value 'E'.
000120             88  cs-clm-ver-ND-CERT          value 'F'.
000121             88  cs-clm-ver-spec-other       value 'G'.
000122             88  cs-clam-ver-pratial-corrected
000123                                             value 'H'.
000124             88  cs-clm-ver-no-matches       value 'I'.
000125             88  cs-clm-ver-not-elig-corrected
000126                                             value 'J'.
000127             88  cs-clm-ver-needs-review     value 'R'.
000128             88  cs-clm-ver-sent-to-claims   value 'W'.
000129         16  CS-LF-REFUND-METHOD           PIC X.
000130         16  CS-AH-REFUND-METHOD           PIC X.
000131         16  FILLER                        PIC X(353). *> was 420
000132*        16  FILLER                        PIC X(496).
      *<<((file: ELCCRTT))
001316*                                COPY ERCCHEK.
      *>>((file: ERCCHEK))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCCHEK                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.008                          *
000007*                                                                *
000008*   FILE DESCRIPTION = CHECK RECORDS                             *
000009*                                                                *
000010*   FILE TYPE = VSAM,KSDS                                        *
000011*   RECORD SIZE = 600    RECFORM = FIXED                         *
000012*                                                                *
000013*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
000014*       ALTERNATE INDEX = NONE                                   *
000015*                                                                *
000016*   LOG = YES                                                    *
000017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000018******************************************************************
000019*                   C H A N G E   L O G
000020*
000021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000022*-----------------------------------------------------------------
000023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000024* EFFECTIVE    NUMBER
000025*-----------------------------------------------------------------
000026* 021414    2003053000001  PEMA  changes for auto chk request
000027******************************************************************
000028 01  CHECK-RECORDS.
000029     12  CH-RECORD-ID                      PIC XX.
000030         88  VALID-CH-ID                      VALUE 'CH'.
000031
000032     12  CH-CONTROL-PRIMARY.
000033         16  CH-COMPANY-CD                 PIC X.
000034         16  CH-CARRIER                    PIC X.
000035         16  CH-GROUPING                   PIC X(6).
000036         16  CH-STATE                      PIC XX.
000037         16  CH-ACCOUNT                    PIC X(10).
000038         16  CH-CERT-EFF-DT                PIC XX.
000039         16  CH-CERT-NO.
000040             20  CH-CERT-PRIME             PIC X(10).
000041             20  CH-CERT-SFX               PIC X.
000042         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
000043
000044     12  CH-RECORDED-DT                    PIC XX.
000045     12  CH-RECORDED-BY                    PIC X(4).
000046     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
000047
000048     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
000049     12  CH-CHECK-NO                       PIC X(7).
000050     12  CH-REASON-FOR-CHECK               PIC X(25).
000051     12  CH-CHECK-WRITTEN-DT               PIC XX.
000052     12  FILLER                            PIC X.
000053
000054     12  CH-PAYEE-INFO.
000055         16  CH-PAYEE-NAME-1               PIC X(30).
000056         16  CH-PAYEE-NAME-2               PIC X(30).
000057         16  CH-PAYEE-ADDRESS-1            PIC X(30).
000058         16  CH-PAYEE-ADDRESS-2            PIC X(30).
000059         16  CH-PAYEE-CITY-ST.
000060             20  CH-PAYEE-CITY             PIC X(28).
000061             20  CH-PAYEE-STATE            PIC XX.
000062         16  CH-PAYEE-ZIP-CODE.
000063             20  CH-PAYEE-ZIP.
000064                 24  CH-ZIP-PRI-1ST        PIC X.
000065                     88  CH-CANADIAN-POST-CODE
000066                                           VALUES 'A' THRU 'Z'.
000067                 24  FILLER                PIC X(4).
000068             20  CH-PAYEE-ZIP-EXT          PIC X(4).
000069         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
000070             20  CH-CAN-POSTAL-1           PIC XXX.
000071             20  CH-CAN-POSTAL-2           PIC XXX.
000072             20  FILLER                    PIC XXX.
000073
000074     12  CH-CHECK-STUB-TEXT.
000075         16  CH-STUB-LINE-1                PIC X(30).
000076         16  CH-TEXT-LINE-1                PIC X(50).
000077         16  CH-TEXT-LINE-2                PIC X(50).
000078         16  CH-TEXT-LINE-3                PIC X(40).
000079     12  CH-RETURN-TO                      PIC X(30).
000080
000081     12  CH-COMPENSATION-CONTROL.
000082         16  CH-COMP-CARRIER               PIC X.
000083         16  CH-COMP-GROUPING              PIC X(6).
000084         16  CH-COMP-FIN-RESP              PIC X(10).
000085         16  CH-COMP-ACCOUNT               PIC X(10).
000086
000087     12  CH-CREDIT-SELECT-DT               PIC XX.
000088     12  CH-CREDIT-ACCEPT-DT               PIC XX.
000089     12  CH-PAYEE-CODE                     PIC X(6).
000090
000091     12  CH-VOID-DATA.
000092         20  CH-VOID-DT                    PIC XX.
000093         20  CH-VOID-BY                    PIC X(4).
000094         20  CH-VOID-REASON                PIC X(25).
000095
000096     12  CH-APPROVAL-DATA.
000097         20  CH-APPROVAL-DT                PIC XX.
000098         20  CH-APPROVAL-STATUS            PIC X.
000099             88  CH-IN-LIMBO                  VALUE ' '.
000100             88  CH-APPROV-PENDING            VALUE 'P' '2'.
000101             88  CH-APPROVED                  VALUE 'A'.
000102             88  CH-DENIED                    VALUE 'D'.
000103         20  CH-APPROVED-BY                PIC XXXX.
000104     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
000105             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
000106     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
000107
000108     12  ch-released-dt                    pic xx.
000109     12  ch-check-cashed-dt                pic xx.
000110     12  FILLER                            PIC X.
000111*    12  CH-CHECK-REFERENCE                PIC X(12).
000112     12  CH-CHECK-ORIGIN-SW                PIC X.
000113             88  CH-REFUND-CHECK              VALUE 'R'.
000114             88  CH-MAINT-CHECK               VALUE 'M'.
000115
000116     12  CH-CANC-DT                        PIC XX.
000117     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
000118     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
000119
000120     12  CH-INSURED-NAME                   PIC X(28).
000121
000122     12  ch-released-by                    pic x(4).
000123     12  ch-csr                            pic x(4).
000124     12  ch-deduct-commission              pic x.
000125         88  ch-deduct-comm                  value 'Y'.
000126         88  ch-do-not-deduct-comm           value 'N'.
000127
000128     12  FILLER                            PIC X(11).
000129*    12  CH-LETTER-TABLE.
000130*        16  CH-LETTERS OCCURS 3 TIMES
000131*                       INDEXED BY CH-LT-NDX
000132*                                          PIC X(04).
000133
000134     12  FILLER                            PIC X(07).
000135
      *<<((file: ERCCHEK))
001317 01  var                         pic x(30).
001318
       PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
       0000-DFHEXIT SECTION.
           MOVE FUNCTION WHEN-COMPILED TO DFHEIVL0(1:21).
           MOVE '9#                    %   ' TO DFHEIV0.
           MOVE 'EL6311' TO DFHEIV1.
           CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1
                DFHEIVL0.
001319 VCOBOL-DUMMY-PROCEDURE.
001320
001321     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
001322     MOVE EIBTRMID               TO QID-TERM.
001323     MOVE 3                      TO EMI-NUMBER-OF-LINES.
001324     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
001325     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
001326     MOVE 2                      TO EMI-SWITCH2.
001327
001328     move spaces to ws-kix-myenv
001329     set P to address of KIXSYS
001330     CALL "getenv" using by value P returning var-ptr
001331     if var-ptr = null then
001332        display ' kixsys not set '
001333     else
001334        set address of var to var-ptr
001335        move 0 to env-var-len
001336        inspect var tallying env-var-len
001337          for characters before X'00'
001338        unstring var (1:env-var-len) delimited by '/'
001339           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
001340              WS-KIX-SYS
001341        end-unstring
001342     end-if
001343     perform varying a1 from +1 by +1 until a1 > +10
001344        if ws-kix-myenv (a1:1) = low-values or high-values
001345           display ' found low or hi val '
001346           move spaces to ws-kix-myenv (a1:1)
001347        end-if
001348     end-perform
001349
001350     set P to address of KIXHOST
001351     CALL "getenv" using by value P returning var-ptr
001352     if var-ptr = null then
001353        display ' kixhost not set '
001354     else
001355        set address of var to var-ptr
001356        move 0 to env-var-len
001357        inspect var tallying env-var-len
001358          for characters before X'00'
001359        MOVE var(1:env-var-len)  to ws-kixhost
001360        DISPLAY ' WS KIX HOST ' WS-KIXHOST
001361     end-if.
001362
001363*    display ' env *' ws-kix-myenv '*'
001364
001365     IF EIBCALEN = 0
001366         GO TO 8800-UNAUTHORIZED-ACCESS.
001367
001368     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
001369     MOVE '5'                   TO DC-OPTION-CODE.
001370     PERFORM 9700-DATE-LINK.
001371     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
001372     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
001373
001374     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
001375     MOVE SPACE                  TO DC-OPTION-CODE.
001376     PERFORM 9700-DATE-LINK.
001377     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
001378     MOVE LOW-VALUES             TO EL631BI.
001379
001380     
      * EXEC CICS HANDLE CONDITION
001381*        PGMIDERR  (9600-PGMID-ERROR)
001382*        ERROR     (9990-ABEND)
001383*        INVREQ    (9990-ABEND)
001384*        QIDERR    (0010-MAIN-LOGIC)
001385*    END-EXEC.
      *    MOVE '"$L.8N                ! " #00008601' TO DFHEIV0
           MOVE X'22244C2E384E202020202020' &
                X'202020202020202020202120' &
                X'2220233030303038363031' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001386
001387     IF PI-CALLING-PROGRAM NOT = THIS-PGM
001388         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
001389             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
001390             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
001391             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
001392             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
001393             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
001394             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
001395             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
001396             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
001397
001398             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
001399                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
001400
001401             ELSE
001402                 NEXT SENTENCE
001403
001404         ELSE
001405             IF PI-CALLING-PROGRAM = 'EL6315'
001406                SET CALLED-FROM-6315 TO TRUE
001407             END-IF
001408             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
001409             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
001410             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
001411             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
001412             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
001413             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
001414             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
001415             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
001416             MOVE SPACES               TO PI-SAVED-PROGRAM-6
001417             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
001418             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
001419             GO TO 3900-RE-DISPLAY-RECORD
001420     ELSE
001421         GO TO 0020-MAIN-LOGIC.
001422
001423 0010-MAIN-LOGIC.
001424     MOVE 'Y'                    TO WS-FIRST-TIME-SW
001425                                    WS-FIRST-ENTRY-SW.
001426
001427     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
001428
001429     MOVE LOW-VALUES             TO EC-NEW-CERT
001430                                    EC-NEW-STATE.
001431
001432     IF PI-DISPLAY-ORIGINAL-BATCH
001433         NEXT SENTENCE
001434     ELSE
001435         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
001436             GO TO 5000-BROWSE-BATCH-HEADERS.
001437
001438     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
001439         GO TO 4100-BROWSE-PRIMARY-FORWARD.
001440
001441     IF PI-CSR-BROWSE
001442        GO TO 4200-BROWSE-CSR-FORWARD.
001443
001444     IF PI-FILE-BROWSE
001445         GO TO 4300-BROWSE-FILE-FORWARD.
001446
001447     GO TO 4000-BROWSE-DETAIL-FORWARD.
001448
001449 0020-MAIN-LOGIC.
001450     IF EIBAID = DFHCLEAR
001451         GO TO 9400-CLEAR.
001452
001453     MOVE LOW-VALUES             TO EC-NEW-CERT
001454                                    EC-NEW-STATE.
001455
001456     EJECT
001457
001458******************************************************************
001459*                                                                *
001460*              R E C E I V E   M A P                             *
001461*                                                                *
001462******************************************************************
001463
001464 0200-RECEIVE.
001465     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
001466         MOVE ER-0008            TO EMI-ERROR
001467         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001468         IF PI-MAP-NAME = EL631B
001469             MOVE -1                 TO BMAINTL
001470             GO TO 8200-SEND-DATAONLY
001471         ELSE
001472             IF PI-MAP-NAME = EL631C
001473                 MOVE -1                 TO CMAINTL
001474                 GO TO 8200-SEND-DATAONLY
001475             ELSE
001476                 IF PI-MAP-NAME = EL631D
001477                     MOVE -1                 TO DPFENTRL
001478                     GO TO 8200-SEND-DATAONLY.
001479
001480     
      * EXEC CICS RECEIVE
001481*        MAP      (PI-MAP-NAME)
001482*        MAPSET   (MAPSET-EL6311S)
001483*        INTO     (EL631BI)
001484*    END-EXEC.
           MOVE LENGTH OF
            EL631BI
             TO DFHEIV11
      *    MOVE '8"T I  L              ''   #00008701' TO DFHEIV0
           MOVE X'382254204920204C20202020' &
                X'202020202020202020202720' &
                X'2020233030303038373031' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PI-MAP-NAME, 
                 EL631BI, 
                 DFHEIV11, 
                 MAPSET-EL6311S, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001485
001486******************************************************************
001487*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
001488******************************************************************
001489
001490     IF BTYPE-LEN (1) EQUAL +3
001491        IF BTYPE (1) EQUAL ALL ' '
001492            MOVE 'Y' TO WS-REMOVE-LF-SW.
001493
001494     IF BTYPE-LEN (2) EQUAL +3
001495        IF BTYPE (2) EQUAL ALL ' '
001496            MOVE 'Y' TO WS-REMOVE-AH-SW.
001497
001498     INSPECT EL631BI CONVERTING '_' TO ' '.
001499
001500     IF PI-MAP-NAME = EL631B
001501         IF BPFENTRL GREATER THAN ZEROS
001502             IF EIBAID NOT = DFHENTER
001503                 MOVE ER-0004       TO EMI-ERROR
001504                 MOVE -1            TO BPFENTRL
001505                 MOVE AL-UNBOF      TO BPFENTRA
001506                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001507                 GO TO 8200-SEND-DATAONLY
001508             ELSE
001509                 IF BPFENTRI NUMERIC AND
001510                   (BPFENTRI GREATER 0 AND LESS 25)
001511                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
001512                 ELSE
001513                     MOVE ER-0029  TO EMI-ERROR
001514                     MOVE AL-UNBON TO BPFENTRA
001515                     MOVE -1       TO BPFENTRL
001516                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001517                     GO TO 8200-SEND-DATAONLY
001518         ELSE
001519             NEXT SENTENCE
001520     ELSE
001521         IF PI-MAP-NAME = EL631C
001522            IF CPFENTRL GREATER THAN ZEROS
001523                IF EIBAID NOT = DFHENTER
001524                 MOVE ER-0004         TO EMI-ERROR
001525                 MOVE -1              TO CPFENTRL
001526                 MOVE AL-UNBOF        TO CPFENTRA
001527                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001528                 GO TO 8200-SEND-DATAONLY
001529             ELSE
001530                 IF CPFENTRI NUMERIC AND
001531                   (CPFENTRI GREATER 0 AND LESS 25)
001532                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
001533                 ELSE
001534                     MOVE ER-0029      TO EMI-ERROR
001535                     MOVE AL-UNBON     TO CPFENTRA
001536                     MOVE -1           TO CPFENTRL
001537                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001538                     GO TO 8200-SEND-DATAONLY
001539         ELSE
001540             NEXT SENTENCE
001541     ELSE
001542     IF PI-MAP-NAME = EL631D
001543         IF DPFENTRL GREATER THAN ZEROS
001544             IF EIBAID NOT = DFHENTER
001545                 MOVE ER-0004         TO EMI-ERROR
001546                 MOVE -1              TO DPFENTRL
001547                 MOVE AL-UNBOF        TO DPFENTRA
001548                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001549                 GO TO 8200-SEND-DATAONLY
001550             ELSE
001551                 IF DPFENTRI NUMERIC AND
001552                   (DPFENTRI GREATER 0 AND LESS 25)
001553                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
001554                 ELSE
001555                     MOVE ER-0029      TO EMI-ERROR
001556                     MOVE AL-UNBON     TO DPFENTRA
001557                     MOVE -1           TO DPFENTRL
001558                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001559                     GO TO 8200-SEND-DATAONLY.
001560
001561     IF EIBAID = DFHPF23
001562         GO TO 8810-PF23.
001563
001564     IF EIBAID = DFHPF24
001565         GO TO 9200-RETURN-MAIN-MENU.
001566
001567     IF EIBAID = DFHPF12
001568         GO TO 9500-PF12.
001569
001570     IF PI-MAP-NAME = EL631B
001571        GO TO 0300-CHECK-ISSUE-PF-KEYS.
001572
001573     IF PI-MAP-NAME = EL631C
001574        GO TO 0400-CHECK-CANCEL-PF-KEYS.
001575
001576     IF PI-MAP-NAME = EL631D
001577        GO TO 0500-CHECK-BATCH-PF-KEYS.
001578
001579     EJECT
001580
001581******************************************************************
001582*                                                                *
001583*      ISSUE SCREEN PF KEY CHECKING                              *
001584*                                                                *
001585******************************************************************
001586
001587******************************************************************
001588*                                                                *
001589*      PF KEY FUNCTIONS:                                         *
001590*                                                                *
001591*      PF1  = BROWSE FORWARD                                     *
001592*      PF2  = BROWSE BACKWARD                                    *
001593*      PF3  = CERTIFICATE LOOKUP                                 *
001594*      PF4  = DISPLAY BATCH HEADER                               *
001595*      PF5  = ADD ISSUE  SCREEN                                  *
001596*      PF6  = ADD CANCEL SCREEN                                  *
001597*      PF7  = CERTIFICATE DISPLAY                                *
001598*      PF8  = CERTIFICATE NOTES                                  *
001599*      PF9  = EDIT CONTROL                                       *
001600*      PF10 = DISPLAY LETTER SCREEN                              *
001601*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
001602*      PF12 = HELP SCREEN                                        *
001603*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
001604*      PF14 = ACCOUNT MASTER                                     *
001605*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
001606*      PF16 = DISPLAY LETTER REVIEW                              *
001607*                                                                *
001608******************************************************************
001609
001610 0300-CHECK-ISSUE-PF-KEYS.
001611     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
001612        MOVE ER-2337            TO EMI-ERROR
001613        MOVE -1                  TO BMAINTL
001614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001615        GO TO 8200-SEND-DATAONLY.
001616
001617     IF EIBAID = DFHPF1
001618        MOVE '0'                TO PI-EDIT-SW
001619        IF PI-PRIMARY-BROWSE
001620           GO TO 4100-BROWSE-PRIMARY-FORWARD
001621        ELSE
001622           IF PI-PRIMARY-WITH-SELECT
001623              GO TO 4100-BROWSE-PRIMARY-FORWARD
001624           ELSE
001625              IF PI-FILE-BROWSE
001626                 GO TO 4300-BROWSE-FILE-FORWARD
001627              ELSE
001628                 IF PI-CSR-BROWSE
001629                    GO TO 4200-BROWSE-CSR-FORWARD
001630                 ELSE
001631                    GO TO 4000-BROWSE-DETAIL-FORWARD.
001632
001633     IF EIBAID = DFHPF2
001634        MOVE '0'                TO PI-EDIT-SW
001635        IF PI-PRIMARY-BROWSE
001636           GO TO 4600-BROWSE-PRIMARY-BACKWARD
001637        ELSE
001638           IF PI-PRIMARY-WITH-SELECT
001639              GO TO 4600-BROWSE-PRIMARY-BACKWARD
001640           ELSE
001641              IF PI-FILE-BROWSE
001642                 GO TO 4800-BROWSE-FILE-BACKWARD
001643              ELSE
001644                 IF PI-CSR-BROWSE
001645                    GO TO 4900-BROWSE-CSR-BACKWARD
001646                 ELSE
001647                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
001648
001649     IF EIBAID = DFHPF3
001650        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
001651        MOVE XCTL-EL127         TO PGM-NAME
001652        GO TO 9300-XCTL.
001653
001654     IF (EIBAID = DFHPF15 OR DFHPF6)
001655        AND (CSR-EDIT-SESSION)
001656*       AND (FATAL-OR-UNFORCED)
001657*       AND (FATAL-ERRORS)
001658        and (pi-6311-fatal-ctr <> +0)
001659        MOVE ER-1819             TO EMI-ERROR
001660        MOVE -1                  TO BMAINTL
001661        MOVE AL-UANON            TO BMAINTA
001662        PERFORM 9900-ERROR-FORMAT
001663                                 THRU 9900-EXIT
001664        GO TO 8200-SEND-DATAONLY
001665     END-IF
001666
001667     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
001668      OR (EIBAID = DFHPF10)
001669        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
001670        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
001671        IF (RESP-NORMAL)
001672           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
001673              AM-CONTROL-PRIMARY (1:20))
001674            IF AM-NAME NOT GREATER THAN SPACES OR
001675               AM-ADDRS NOT GREATER THAN SPACES  OR
001676               AM-ADDR-CITY NOT GREATER THAN SPACES OR
001677               AM-ADDR-STATE NOT GREATER THAN SPACES OR
001678               AM-ZIP NOT GREATER THAN SPACES
001679               MOVE ER-3834             TO EMI-ERROR
001680               MOVE -1                  TO BMAINTL
001681               MOVE AL-UANON            TO BMAINTA
001682               PERFORM 9900-ERROR-FORMAT
001683                                 THRU 9900-EXIT
001684               GO TO 8200-SEND-DATAONLY
001685            END-IF
001686        ELSE
001687           MOVE ER-1609             TO EMI-ERROR
001688           MOVE -1                  TO BMAINTL
001689           MOVE AL-UANON            TO BMAINTA
001690           PERFORM 9900-ERROR-FORMAT
001691                                THRU 9900-EXIT
001692           GO TO 8200-SEND-DATAONLY
001693        END-IF
001694
001695        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
001696        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
001697        IF (ERMAIL-FOUND)
001698            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
001699               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
001700               MA-CITY NOT GREATER THAN SPACES OR
001701               MA-ADDR-STATE NOT GREATER THAN SPACES OR
001702               MA-ZIP-CODE NOT GREATER THAN SPACES
001703               MOVE ER-3835             TO EMI-ERROR
001704               MOVE -1                  TO BMAINTL
001705               MOVE AL-UANON            TO BMAINTA
001706               PERFORM 9900-ERROR-FORMAT
001707                                 THRU 9900-EXIT
001708               GO TO 8200-SEND-DATAONLY
001709            END-IF
001710        ELSE
001711           MOVE ER-3000             TO EMI-ERROR
001712           MOVE -1                  TO BMAINTL
001713           MOVE AL-UANON            TO BMAINTA
001714           PERFORM 9900-ERROR-FORMAT
001715                                THRU 9900-EXIT
001716           GO TO 8200-SEND-DATAONLY
001717        END-IF
001718
001719     END-IF
001720
001721     IF (EIBAID = DFHPF15)
001722        AND (CSR-EDIT-SESSION)
001723        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
001724        MOVE PI-SV-CARRIER       TO PI-CARRIER
001725        MOVE PI-SV-GROUPING      TO PI-GROUPING
001726        MOVE PI-SV-STATE         TO PI-STATE
001727        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
001728        MOVE BCERTNOI            TO PI-CERT-PRIME
001729        MOVE BSUFIXI             TO PI-CERT-SFX
001730        MOVE BEFFDTI             TO DEEDIT-FIELD
001731        PERFORM 8600-DEEDIT
001732        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
001733        MOVE '4'                 TO DC-OPTION-CODE
001734        PERFORM 9700-DATE-LINK
001735        IF DATE-CONVERSION-ERROR
001736           MOVE ER-0348          TO EMI-ERROR
001737           MOVE -1               TO BEFFDTL
001738           MOVE AL-UABON         TO BEFFDTA
001739           PERFORM 9900-ERROR-FORMAT
001740                                 THRU 9900-EXIT
001741           GO TO 8200-SEND-DATAONLY
001742        ELSE
001743           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
001744           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
001745           MOVE XCTL-EL6315      TO PGM-NAME
001746           MOVE '1'              TO PI-6315-ISS-CAN-SW
001747           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
001748           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
001749           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
001750           GO TO 9300-XCTL
001751        END-IF
001752     END-IF
001753
001754     IF EIBAID = DFHPF4
001755        MOVE '0'                TO PI-EDIT-SW
001756        IF PI-DISPLAY-ORIGINAL-BATCH
001757           NEXT SENTENCE
001758        ELSE
001759           GO TO 7200-DISPLAY-BATCHES.
001760
001761     IF EIBAID = DFHPF5
001762        MOVE ER-0029                TO EMI-ERROR
001763        MOVE -1                     TO BPFENTRL
001764        MOVE AL-UNBON               TO BPFENTRA
001765        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001766        GO TO 8200-SEND-DATAONLY.
001767*        MOVE '0'                TO PI-EDIT-SW
001768*        IF PI-DISPLAY-ORIGINAL-BATCH
001769*           NEXT SENTENCE
001770*        ELSE
001771*           MOVE EL631B              TO PI-MAP-NAME
001772*           MOVE LOW-VALUES          TO EL631BI
001773*           MOVE 'A'                 TO BMAINTO
001774*           MOVE AL-UANON            TO BMAINTA
001775*           MOVE -1                  TO BMAINTL
001776*           MOVE '5'                 TO PI-MAINT-FUNCTION
001777*           GO TO 8100-SEND-INITIAL-MAP.
001778
001779     IF EIBAID = DFHPF6
001780        IF NOT CSR-EDIT-SESSION
001781           MOVE ER-0029                TO EMI-ERROR
001782           MOVE -1                     TO BPFENTRL
001783           MOVE AL-UNBON               TO BPFENTRA
001784           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001785           GO TO 8200-SEND-DATAONLY
001786*           MOVE '0'              TO PI-EDIT-SW
001787*           IF PI-DISPLAY-ORIGINAL-BATCH
001788*              NEXT SENTENCE
001789*           ELSE
001790*              MOVE EL631C        TO PI-MAP-NAME
001791*              MOVE LOW-VALUES    TO EL631CI
001792*              MOVE 'A'           TO CMAINTO
001793*              MOVE AL-UANON      TO CMAINTA
001794*              MOVE -1            TO CMAINTL
001795*              MOVE '6'           TO PI-MAINT-FUNCTION
001796*              GO TO 8100-SEND-INITIAL-MAP
001797*           END-IF
001798        ELSE
001799           PERFORM 5100-PROCESS-POL-RESC
001800                                 THRU 5100-EXIT
001801           MOVE  PI-PREV-CONTROL-PRIMARY
001802                                 TO ERPNDB-KEY
001803           
      * EXEC CICS READ
001804*              SET     (ADDRESS OF PENDING-BUSINESS)
001805*              DATASET (FILE-ID-ERPNDB)
001806*              RIDFLD  (ERPNDB-KEY)
001807*              resp    (WS-RESPONSE)
001808*          END-EXEC
      *    MOVE '&"S        E          (  N#00009024' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303039303234' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
001809           PERFORM 9800-LINK-PENDING-EDIT
001810                                 THRU 9800-EXIT
001811
001812           MOVE  PI-PREV-CONTROL-PRIMARY
001813                                 TO ERPNDB-KEY
001814           move cg-batch-seq-no  to ERPNDB-BATCH-SEQ-NO
001815           
      * EXEC CICS READ
001816*              SET     (ADDRESS OF PENDING-BUSINESS)
001817*              DATASET (FILE-ID-ERPNDB)
001818*              RIDFLD  (ERPNDB-KEY)
001819*              resp    (WS-RESPONSE)
001820*          END-EXEC
      *    MOVE '&"S        E          (  N#00009036' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303039303336' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
001821
001822           PERFORM 9800-LINK-PENDING-EDIT
001823                                 THRU 9800-EXIT
001824
001825           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
001826           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
001827                                    PI-PREV-SEQ-NO
001828           MOVE 'Y'              TO WS-FIRST-TIME-SW
001829*                                    WS-CANCEL-LETTER-SW
001830                                    PI-ALL-ISSUES-SW
001831                                    PI-ALL-CANCELS-SW
001832           GO TO 4100-BROWSE-PRIMARY-FORWARD
001833        END-IF
001834     END-IF
001835
001836     IF EIBAID = DFHPF7
001837        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
001838        MOVE PI-SV-CARRIER          TO PI-CARRIER
001839        MOVE PI-SV-GROUPING         TO PI-GROUPING
001840        MOVE PI-SV-STATE            TO PI-STATE
001841        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
001842        MOVE BCERTNOI               TO PI-CERT-PRIME
001843        MOVE BSUFIXI                TO PI-CERT-SFX
001844        MOVE BEFFDTI                TO DEEDIT-FIELD
001845        PERFORM 8600-DEEDIT
001846        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
001847        MOVE '4'                    TO DC-OPTION-CODE
001848        PERFORM 9700-DATE-LINK
001849        IF DATE-CONVERSION-ERROR
001850           MOVE ER-0348            TO EMI-ERROR
001851           MOVE -1                  TO BEFFDTL
001852           MOVE AL-UABON            TO BEFFDTA
001853           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001854           GO TO 8200-SEND-DATAONLY
001855        ELSE
001856           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
001857           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
001858           MOVE XCTL-EL1273        TO PGM-NAME
001859           GO TO 9300-XCTL.
001860
001861     IF EIBAID = DFHPF8
001862        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
001863        MOVE PI-SV-CARRIER          TO PI-CARRIER
001864        MOVE PI-SV-GROUPING         TO PI-GROUPING
001865        MOVE PI-SV-STATE            TO PI-STATE
001866        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
001867        MOVE BCERTNOI               TO PI-CERT-PRIME
001868        MOVE BSUFIXI                TO PI-CERT-SFX
001869        MOVE BEFFDTI                TO DEEDIT-FIELD
001870        PERFORM 8600-DEEDIT
001871        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
001872        MOVE '4'                    TO DC-OPTION-CODE
001873        PERFORM 9700-DATE-LINK
001874        IF DATE-CONVERSION-ERROR
001875           MOVE ER-0348            TO EMI-ERROR
001876           MOVE -1                  TO BEFFDTL
001877           MOVE AL-UABON            TO BEFFDTA
001878           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001879           GO TO 8200-SEND-DATAONLY
001880        ELSE
001881           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
001882           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
001883           move ERPNDB-RECORD-TYPE to pi-program-work-area(1:1)
001884           IF PI-COMPANY-ID = 'DMD'
001885               MOVE XCTL-EL401DMD      TO PGM-NAME
001886             ELSE
001887               MOVE XCTL-EL1279        TO PGM-NAME
001888           END-IF
001889           GO TO 9300-XCTL.
001890
001891     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
001892        MOVE XCTL-EL6312         TO PGM-NAME
001893        
      * EXEC CICS XCTL
001894*           PROGRAM   (PGM-NAME)
001895*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
001896*           LENGTH    (WS-COMM-LENGTH)
001897*       END-EXEC
      *    MOVE '.$C                   %   #00009114' TO DFHEIV0
           MOVE X'2E2443202020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303039313134' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PGM-NAME, 
                 PROGRAM-INTERFACE-BLOCK, 
                 WS-COMM-LENGTH, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
001898     ELSE
001899        MOVE '0'                 TO  PI-EDIT-SW.
001900
001901     IF  EIBAID = DFHPF10
001902         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
001903         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
001904         MOVE LOW-VALUES         TO PI-689-WORK-AREA
001905                                    PI-1042-WA
001906         MOVE 4                  TO PI-689-DATA-SOURCE
001907         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
001908         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
001909         MOVE PI-SV-STATE        TO PI-689-STATE
001910         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
001911         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
001912         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
001913         MOVE PI-PB-ALT-CHG-SEQ-NO
001914                                 TO PI-689-ALT-SEQ-NO
001915         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
001916         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
001917         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
001918         MOVE +0                 TO PI-689-CONTROL
001919         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
001920                                    PI-689-EXP-DATE
001921                                    PI-689-RESP-PERSON
001922                                    PI-689-TYPE
001923                                    PI-689-FOLLOW-UP-EDIT
001924                                    PI-689-RESEND1-EDIT
001925                                    PI-689-SEQ-EDIT
001926                                    PI-689-BCSEQ-EDIT
001927                                    PI-689-LBL-OVERRIDE
001928         MOVE W-LETTER-COMMUNICATION-AREAS
001929                                 TO PI-PROGRAM-WORK-AREA
001930         MOVE XCTL-EL689         TO PGM-NAME
001931         GO TO 9300-XCTL.
001932
001933     IF  EIBAID = DFHPF16
001934         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
001935         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
001936         MOVE LOW-VALUES         TO PI-689-WORK-AREA
001937                                    PI-1042-WA
001938         MOVE 4                  TO PI-689-DATA-SOURCE
001939         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
001940         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
001941         MOVE PI-SV-STATE        TO PI-689-STATE
001942         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
001943         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
001944         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
001945         MOVE PI-PB-ALT-CHG-SEQ-NO
001946                                 TO PI-689-ALT-SEQ-NO
001947         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
001948         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
001949         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
001950         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
001951         move '1'                to PI-689-CHG-SEQ-NOX
001952         MOVE W-LETTER-COMMUNICATION-AREAS
001953                                 TO PI-PROGRAM-WORK-AREA
001954         MOVE XCTL-EL690         TO PGM-NAME
001955         GO TO 9300-XCTL.
001956
001957     IF EIBAID = DFHPF13
001958         MOVE XCTL-EL6313        TO PGM-NAME
001959         GO TO 9300-XCTL.
001960
001961     IF EIBAID = DFHPF17
001962        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
001963        IF (PB-I-LOAN-APR numeric)
001964           and (pb-i-loan-apr < 99.9999)
001965           AND (PB-I-BENEFICIARY-NAME NOT
001966              = SPACES AND LOW-VALUES)
001967
001968           MOVE LINK-ELVADS          TO PGM-NAME
001969           
      * EXEC CICS LINK
001970*              PROGRAM    (PGM-NAME)
001971*              COMMAREA   (WS-PASS-AREA)
001972*              LENGTH     (WS-PASS-AREA-LENGTH)
001973*          END-EXEC
      *    MOVE '."C                   (   #00009190' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303039313930' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PGM-NAME, 
                 WS-PASS-AREA, 
                 WS-PASS-AREA-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
001974
001975           MOVE 0000             TO EMI-ERROR
001976           MOVE -1               TO BMAINTL
001977           PERFORM 9900-ERROR-FORMAT
001978                                 THRU 9900-EXIT
001979           GO TO 8200-SEND-DATAONLY
001980        ELSE
001981           MOVE ER-0877            TO EMI-ERROR
001982           MOVE -1                  TO BEFFDTL
001983           MOVE AL-UABON            TO BEFFDTA
001984           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001985           GO TO 8200-SEND-DATAONLY
001986        END-IF
001987     END-IF
001988
001989     IF EIBAID = DFHPF14
001990        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
001991        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
001992        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
001993        MOVE PI-SV-STATE            TO PI-CR-STATE
001994        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
001995        MOVE SPACE                  TO PI-EDIT-SW
001996        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
001997        MOVE XCTL-EL650             TO PGM-NAME
001998        GO TO 9300-XCTL.
001999
002000     IF EIBAID = DFHPF15
002001        IF PI-COMPANY-ID  =  'HER'
002002            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
002003            MOVE XCTL-EL680         TO PGM-NAME
002004            GO TO 9300-XCTL.
002005
002006     IF EIBAID = DFHENTER OR DFHPF11
002007        GO TO 1000-ISSUE-MAINLINE.
002008
002009     MOVE ER-0029                TO EMI-ERROR
002010     MOVE -1                     TO BPFENTRL
002011     MOVE AL-UNBON               TO BPFENTRA
002012     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002013     GO TO 8200-SEND-DATAONLY.
002014
002015     EJECT
002016
002017******************************************************************
002018*                                                                *
002019*      CANCEL SCREEN PF KEY CHECKING                             *
002020*                                                                *
002021******************************************************************
002022
002023******************************************************************
002024*                                                                *
002025*      PF KEY FUNCTIONS:                                         *
002026*                                                                *
002027*      PF1  = BROWSE FORWARD                                     *
002028*      PF2  = BROWSE BACKWARD                                    *
002029*      PF3  = CERTIFICATE LOOKUP                                 *
002030*      PF4  = DISPLAY BATCH HEADER                               *
002031*      PF5  = ADD ISSUE SCREEN                                   *
002032*      PF6  = ADD CANCEL SCREEN                                  *
002033*      PF7  = CERTIFICATE DISPLAY                                *
002034*      PF8  = CERTIFICATE NOTES                                  *
002035*      PF9  = EDIT CONTROL                                       *
002036*      PF10 = DISPLAY LETTER SCREEN                              *
002037*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
002038*      PF12 = DISPLAY HELP SCREEN                                *
002039*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
002040*      PF14 = ACCOUNT MASTER                                     *
002041*      PF16 = LETTER REVIEW                                      *
002042*                                                                *
002043******************************************************************
002044
002045 0400-CHECK-CANCEL-PF-KEYS.
002046     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
002047        MOVE ER-2337             TO EMI-ERROR
002048        MOVE -1                  TO CMAINTL
002049        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002050        GO TO 8200-SEND-DATAONLY.
002051
002052     IF EIBAID = DFHPF1
002053        MOVE '0'                TO PI-EDIT-SW
002054        IF PI-PRIMARY-BROWSE
002055           GO TO 4100-BROWSE-PRIMARY-FORWARD
002056        ELSE
002057           IF PI-PRIMARY-WITH-SELECT
002058              GO TO 4100-BROWSE-PRIMARY-FORWARD
002059           ELSE
002060              IF PI-FILE-BROWSE
002061                 GO TO 4300-BROWSE-FILE-FORWARD
002062              ELSE
002063                 IF PI-CSR-BROWSE
002064                    GO TO 4200-BROWSE-CSR-FORWARD
002065                 ELSE
002066                    GO TO 4000-BROWSE-DETAIL-FORWARD.
002067
002068     IF EIBAID = DFHPF2
002069        MOVE '0'                TO PI-EDIT-SW
002070        IF PI-PRIMARY-BROWSE
002071           GO TO 4600-BROWSE-PRIMARY-BACKWARD
002072        ELSE
002073           IF PI-PRIMARY-WITH-SELECT
002074              GO TO 4600-BROWSE-PRIMARY-BACKWARD
002075           ELSE
002076              IF PI-FILE-BROWSE
002077                 GO TO 4800-BROWSE-FILE-BACKWARD
002078              ELSE
002079                 IF PI-CSR-BROWSE
002080                    GO TO 4900-BROWSE-CSR-BACKWARD
002081                 ELSE
002082                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
002083
002084     IF EIBAID = DFHPF3
002085        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
002086        MOVE XCTL-EL127         TO PGM-NAME
002087        GO TO 9300-XCTL.
002088
002089     IF (EIBAID = DFHPF15 OR DFHPF17)
002090        AND (CSR-EDIT-SESSION)
002091*       AND (FATAL-OR-UNFORCED)
002092        AND (FATAL-ERRORS)
002093        MOVE ER-1819             TO EMI-ERROR
002094        MOVE -1                  TO CMAINTL
002095        MOVE AL-UANON            TO CMAINTA
002096        PERFORM 9900-ERROR-FORMAT
002097                                 THRU 9900-EXIT
002098        GO TO 8200-SEND-DATAONLY
002099     END-IF
002100
002101     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
002102       AND (CSR-EDIT-SESSION)
002103        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
002104        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
002105        IF (RESP-NORMAL)
002106           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
002107              AM-CONTROL-PRIMARY (1:20))
002108            IF AM-NAME NOT GREATER THAN SPACES OR
002109               AM-ADDRS NOT GREATER THAN SPACES  OR
002110               AM-ADDR-CITY NOT GREATER THAN SPACES OR
002111               AM-ADDR-STATE NOT GREATER THAN SPACES OR
002112               AM-ZIP NOT GREATER THAN SPACES
002113               MOVE ER-3834             TO EMI-ERROR
002114               MOVE -1                  TO BMAINTL
002115               MOVE AL-UANON            TO BMAINTA
002116               PERFORM 9900-ERROR-FORMAT
002117                                 THRU 9900-EXIT
002118               GO TO 8200-SEND-DATAONLY
002119            END-IF
002120        ELSE
002121           MOVE ER-1609             TO EMI-ERROR
002122           MOVE -1                  TO BMAINTL
002123           MOVE AL-UANON            TO BMAINTA
002124           PERFORM 9900-ERROR-FORMAT
002125                                THRU 9900-EXIT
002126           GO TO 8200-SEND-DATAONLY
002127        END-IF
002128
002129        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
002130        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
002131        IF (ERMAIL-FOUND)
002132            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
002133               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
002134               MA-CITY NOT GREATER THAN SPACES OR
002135               MA-ADDR-STATE NOT GREATER THAN SPACES OR
002136               MA-ZIP-CODE NOT GREATER THAN SPACES
002137               MOVE ER-3835             TO EMI-ERROR
002138               MOVE -1                  TO BMAINTL
002139               MOVE AL-UANON            TO BMAINTA
002140               PERFORM 9900-ERROR-FORMAT
002141                                 THRU 9900-EXIT
002142               GO TO 8200-SEND-DATAONLY
002143            END-IF
002144        ELSE
002145           MOVE ER-3000             TO EMI-ERROR
002146           MOVE -1                  TO BMAINTL
002147           MOVE AL-UANON            TO BMAINTA
002148           PERFORM 9900-ERROR-FORMAT
002149                                THRU 9900-EXIT
002150           GO TO 8200-SEND-DATAONLY
002151        END-IF
002152
002153     END-IF
002154
002155     IF (EIBAID = DFHPF15 OR DFHPF17)
002156        AND (CSR-EDIT-SESSION)
002157        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
002158        MOVE PI-SV-CARRIER       TO PI-CARRIER
002159        MOVE PI-SV-GROUPING      TO PI-GROUPING
002160        MOVE PI-SV-STATE         TO PI-STATE
002161        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
002162        MOVE CCERTNOI            TO PI-CERT-PRIME
002163        MOVE CSUFIXI             TO PI-CERT-SFX
002164        MOVE CEFFDTI             TO DEEDIT-FIELD
002165        PERFORM 8600-DEEDIT
002166        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
002167        MOVE '4'                 TO DC-OPTION-CODE
002168        PERFORM 9700-DATE-LINK
002169        IF DATE-CONVERSION-ERROR
002170           MOVE ER-0348          TO EMI-ERROR
002171           MOVE -1               TO CEFFDTL
002172           MOVE AL-UABON         TO CEFFDTA
002173           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002174           GO TO 8200-SEND-DATAONLY
002175        ELSE
002176           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
002177           PERFORM 6000-CREATE-TEMP-STORAGE
002178                                 THRU 6000-EXIT
002179           IF EIBAID = DFHPF17
002180               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
002181                                  THRU 6400-EXIT
002182               IF PI-RES-REF-CLM-TYPE NOT EQUAL
002183                                 '2' AND '3' AND '4'
002184                  MOVE ER-3831     TO  EMI-ERROR
002185                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002186                  GO TO 8200-SEND-DATAONLY
002187               END-IF
002188               MOVE 'Y'          TO PI-CLM-RESC-IND
002189           ELSE
002190               MOVE 'N'          TO PI-CLM-RESC-IND
002191           END-IF
002192           MOVE XCTL-EL6316      TO PGM-NAME
002193           MOVE '2'              TO PI-ISS-CAN-SW
002194           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
002195           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
002196           GO TO 9300-XCTL
002197        END-IF
002198     END-IF
002199
002200     IF EIBAID = DFHPF4
002201        MOVE '0'                TO PI-EDIT-SW
002202        IF PI-DISPLAY-ORIGINAL-BATCH
002203           NEXT SENTENCE
002204        ELSE
002205           GO TO 7200-DISPLAY-BATCHES.
002206
002207     IF EIBAID = DFHPF5
002208        MOVE ER-0029                TO EMI-ERROR
002209        MOVE -1                     TO BPFENTRL
002210        MOVE AL-UNBON               TO BPFENTRA
002211        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002212        GO TO 8200-SEND-DATAONLY.
002213*        MOVE '0'                TO PI-EDIT-SW
002214*        IF PI-DISPLAY-ORIGINAL-BATCH
002215*           NEXT SENTENCE
002216*        ELSE
002217*           MOVE EL631B              TO PI-MAP-NAME
002218*           MOVE LOW-VALUES          TO EL631BI
002219*           MOVE 'A'                 TO BMAINTO
002220*           MOVE AL-UANON            TO BMAINTA
002221*           MOVE -1                  TO BMAINTL
002222*           MOVE '5'                 TO PI-MAINT-FUNCTION
002223*           GO TO 8100-SEND-INITIAL-MAP.
002224
002225     IF EIBAID = DFHPF6
002226        MOVE ER-0029                TO EMI-ERROR
002227        MOVE -1                     TO BPFENTRL
002228        MOVE AL-UNBON               TO BPFENTRA
002229        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002230        GO TO 8200-SEND-DATAONLY.
002231*        MOVE '0'                TO PI-EDIT-SW
002232*        IF PI-DISPLAY-ORIGINAL-BATCH
002233*           NEXT SENTENCE
002234*        ELSE
002235*           MOVE EL631C              TO PI-MAP-NAME
002236*           MOVE LOW-VALUES          TO EL631CI
002237*           MOVE 'A'                 TO CMAINTO
002238*           MOVE AL-UANON            TO CMAINTA
002239*           MOVE -1                  TO CMAINTL
002240*           MOVE '6'                 TO PI-MAINT-FUNCTION
002241*           GO TO 8100-SEND-INITIAL-MAP.
002242
002243     IF EIBAID = DFHPF7
002244        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
002245        MOVE PI-SV-CARRIER          TO PI-CARRIER
002246        MOVE PI-SV-GROUPING         TO PI-GROUPING
002247        MOVE PI-SV-STATE            TO PI-STATE
002248        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
002249        MOVE CCERTNOI               TO PI-CERT-PRIME
002250        MOVE CSUFIXI                TO PI-CERT-SFX
002251        MOVE CEFFDTI                TO DEEDIT-FIELD
002252        PERFORM 8600-DEEDIT
002253        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
002254        MOVE '4'                    TO DC-OPTION-CODE
002255        PERFORM 9700-DATE-LINK
002256        IF DATE-CONVERSION-ERROR
002257           MOVE ER-0348            TO EMI-ERROR
002258           MOVE -1                  TO BEFFDTL
002259           MOVE AL-UABON            TO BEFFDTA
002260           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002261           GO TO 8200-SEND-DATAONLY
002262        ELSE
002263           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
002264           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
002265           MOVE XCTL-EL1273        TO PGM-NAME
002266           GO TO 9300-XCTL.
002267
002268     IF EIBAID = DFHPF8
002269        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
002270        MOVE PI-SV-CARRIER          TO PI-CARRIER
002271        MOVE PI-SV-GROUPING         TO PI-GROUPING
002272        MOVE PI-SV-STATE            TO PI-STATE
002273        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
002274        MOVE CCERTNOI               TO PI-CERT-PRIME
002275        MOVE CSUFIXI                TO PI-CERT-SFX
002276        MOVE CEFFDTI                TO DEEDIT-FIELD
002277        PERFORM 8600-DEEDIT
002278        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
002279        MOVE '4'                    TO DC-OPTION-CODE
002280        PERFORM 9700-DATE-LINK
002281        IF DATE-CONVERSION-ERROR
002282           MOVE ER-0348             TO EMI-ERROR
002283           MOVE -1                  TO BEFFDTL
002284           MOVE AL-UABON            TO BEFFDTA
002285           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002286           GO TO 8200-SEND-DATAONLY
002287        ELSE
002288           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
002289           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
002290           move ERPNDB-RECORD-TYPE to pi-program-work-area(1:1)
002291           IF PI-COMPANY-ID = 'DMD'
002292               MOVE XCTL-EL401DMD      TO PGM-NAME
002293             ELSE
002294               MOVE XCTL-EL1279        TO PGM-NAME
002295           END-IF
002296           GO TO 9300-XCTL.
002297
002298     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
002299        MOVE XCTL-EL6312     TO PGM-NAME
002300        
      * EXEC CICS XCTL
002301*           PROGRAM  (PGM-NAME)
002302*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
002303*           LENGTH   (WS-COMM-LENGTH)
002304*       END-EXEC
      *    MOVE '.$C                   %   #00009521' TO DFHEIV0
           MOVE X'2E2443202020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303039353231' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PGM-NAME, 
                 PROGRAM-INTERFACE-BLOCK, 
                 WS-COMM-LENGTH, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
002305     ELSE
002306        MOVE '0'                 TO  PI-EDIT-SW.
002307
002308     IF EIBAID = DFHPF10
002309         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
002310         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
002311         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
002312         MOVE LOW-VALUES         TO PI-689-WORK-AREA
002313                                    PI-1042-WA
002314         MOVE 4                  TO PI-689-DATA-SOURCE
002315         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
002316         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
002317         MOVE PI-SV-STATE        TO PI-689-STATE
002318         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
002319         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
002320         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
002321         MOVE PI-PB-ALT-CHG-SEQ-NO
002322                                 TO PI-689-ALT-SEQ-NO
002323         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
002324         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
002325         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
002326         MOVE +0                 TO PI-689-CONTROL
002327         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
002328                                    PI-689-EXP-DATE
002329                                    PI-689-RESP-PERSON
002330                                    PI-689-TYPE
002331                                    PI-689-FOLLOW-UP-EDIT
002332                                    PI-689-RESEND1-EDIT
002333                                    PI-689-SEQ-EDIT
002334                                    PI-689-BCSEQ-EDIT
002335                                    PI-689-LBL-OVERRIDE
002336         MOVE W-LETTER-COMMUNICATION-AREAS
002337                                 TO PI-PROGRAM-WORK-AREA
002338         MOVE XCTL-EL689         TO PGM-NAME
002339         GO TO 9300-XCTL.
002340
002341     IF  EIBAID = DFHPF16
002342         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
002343         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
002344         MOVE LOW-VALUES         TO PI-689-WORK-AREA
002345                                    PI-1042-WA
002346         MOVE 4                  TO PI-689-DATA-SOURCE
002347         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
002348         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
002349         MOVE PI-SV-STATE        TO PI-689-STATE
002350         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
002351         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
002352         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
002353         MOVE PI-PB-ALT-CHG-SEQ-NO
002354                                 TO PI-689-ALT-SEQ-NO
002355         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
002356         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
002357         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
002358         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
002359         move '2'                to PI-689-CHG-SEQ-NOX
002360         MOVE W-LETTER-COMMUNICATION-AREAS
002361                                 TO PI-PROGRAM-WORK-AREA
002362         MOVE XCTL-EL690         TO PGM-NAME
002363         GO TO 9300-XCTL.
002364
002365     IF (EIBAID = DFHPF13)
002366        if (not fatal-errors)
002367           and (not unforced-errors)
002368           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
002369           MOVE PI-SV-CARRIER    TO PI-CARRIER
002370           MOVE PI-SV-GROUPING   TO PI-GROUPING
002371           MOVE PI-SV-STATE      TO PI-STATE
002372           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
002373           MOVE CCERTNOI         TO PI-CERT-PRIME
002374           MOVE CSUFIXI          TO PI-CERT-SFX
002375           MOVE CEFFDTI          TO DEEDIT-FIELD
002376           PERFORM 8600-DEEDIT
002377           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
002378           MOVE '4'              TO DC-OPTION-CODE
002379           PERFORM 9700-DATE-LINK
002380           IF DATE-CONVERSION-ERROR
002381              MOVE ER-0348       TO EMI-ERROR
002382              MOVE -1            TO CEFFDTL
002383              MOVE AL-UABON      TO CEFFDTA
002384              PERFORM 9900-ERROR-FORMAT
002385                                 THRU 9900-EXIT
002386              GO TO 8200-SEND-DATAONLY
002387           ELSE
002388              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
002389              MOVE AL-UANON      TO CEFFDTA
002390              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
002391              PERFORM 6000-CREATE-TEMP-STORAGE
002392                                 THRU 6000-EXIT
002393              MOVE XCTL-EL677    TO PGM-NAME
002394              GO TO 9300-XCTL
002395           end-if
002396        else
002397           MOVE ER-3444          TO EMI-ERROR
002398           MOVE -1               TO CPFENTRL
002399           MOVE AL-UNBON         TO CPFENTRA
002400           PERFORM 9900-ERROR-FORMAT
002401                                 THRU 9900-EXIT
002402           GO TO 8200-SEND-DATAONLY
002403        end-if
002404     end-if
002405
002406     IF EIBAID = DFHPF14
002407        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
002408        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
002409        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
002410        MOVE PI-SV-STATE            TO PI-CR-STATE
002411        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
002412        MOVE SPACE                  TO PI-EDIT-SW
002413        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
002414        MOVE XCTL-EL650             TO PGM-NAME
002415        GO TO 9300-XCTL.
002416
002417     IF EIBAID = DFHENTER OR DFHPF11
002418        GO TO 2000-CANCEL-MAINLINE.
002419
002420     MOVE ER-0029                TO EMI-ERROR.
002421     MOVE -1                     TO CPFENTRL.
002422     MOVE AL-UNBON               TO CPFENTRA.
002423     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002424     GO TO 8200-SEND-DATAONLY.
002425
002426     EJECT
002427
002428******************************************************************
002429*                                                                *
002430*      BATCH SCREEN PF KEY CHECKING                              *
002431*                                                                *
002432******************************************************************
002433
002434******************************************************************
002435*                                                                *
002436*      PF KEY FUNCTIONS:                                         *
002437*                                                                *
002438*      PF1 = BROWSE FORWARD                                      *
002439*      PF2 = BROWSE BACKWARD                                     *
002440*      PF3 = DISPLAY PREMIUM TOTALS                              *
002441*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
002442*                                                                *
002443*                                                                *
002444******************************************************************
002445
002446 0500-CHECK-BATCH-PF-KEYS.
002447     IF EIBAID = DFHPF1
002448        MOVE '0'                TO PI-EDIT-SW
002449        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
002450           GO TO 5000-BROWSE-BATCH-HEADERS
002451        ELSE
002452           IF PI-GOOD-BROWSE
002453              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
002454                 GO TO 4100-BROWSE-PRIMARY-FORWARD
002455              ELSE
002456                 IF PI-FILE-BROWSE
002457                    GO TO 4300-BROWSE-FILE-FORWARD
002458                 ELSE
002459                    IF PI-CSR-BROWSE
002460                       GO TO 4200-BROWSE-CSR-FORWARD
002461                    ELSE
002462                       GO TO 4000-BROWSE-DETAIL-FORWARD
002463           ELSE
002464              GO TO 0800-BROWSE-ERROR.
002465
002466     IF EIBAID = DFHPF2
002467        MOVE '0'                TO PI-EDIT-SW
002468        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
002469           GO TO 5500-BROWSE-BATCH-BACKWARD
002470        ELSE
002471           IF PI-GOOD-BROWSE
002472              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
002473                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
002474              ELSE
002475                 IF PI-FILE-BROWSE
002476                    GO TO 4800-BROWSE-FILE-BACKWARD
002477                 ELSE
002478                    IF PI-CSR-BROWSE
002479                       GO TO 4900-BROWSE-CSR-BACKWARD
002480                    ELSE
002481                       GO TO 4500-BROWSE-DETAIL-BACKWARD
002482           ELSE
002483              GO TO 0800-BROWSE-ERROR.
002484
002485     IF EIBAID = DFHPF3
002486        GO TO 3000-BATCH-MAINLINE.
002487
002488     IF  EIBAID = DFHPF4
002489        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
002490        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
002491        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
002492        MOVE PI-SV-STATE            TO PI-CR-STATE
002493        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
002494                                       PI-CR-FIN-RESP
002495        MOVE 'A'                    TO PI-CR-TYPE
002496        MOVE SPACE                  TO PI-EDIT-SW
002497        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
002498        MOVE XCTL-EL640             TO PGM-NAME
002499        GO TO 9300-XCTL.
002500
002501     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
002502       AND
002503        (EIBAID = DFHENTER)
002504           GO TO 3500-EDIT-BATCH-DATA.
002505
002506     IF EIBAID = DFHENTER
002507        GO TO 3500-EDIT-BATCH-DATA.
002508
002509     MOVE ER-0029             TO EMI-ERROR.
002510     MOVE -1                  TO DPFENTRL.
002511     MOVE AL-UNBON            TO DPFENTRA.
002512     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002513     GO TO 8200-SEND-DATAONLY.
002514
002515 0800-BROWSE-ERROR.
002516     MOVE ER-2258                TO EMI-ERROR.
002517     MOVE -1                     TO DPFENTRL.
002518     MOVE AL-UNBON               TO DPFENTRA.
002519     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002520     GO TO 8200-SEND-DATAONLY.
002521
002522     EJECT
002523
002524******************************************************************
002525*                                                                *
002526*                I S S U E   M A I N L I N E                     *
002527*                                                                *
002528******************************************************************
002529
002530 1000-ISSUE-MAINLINE.
002531     IF PI-DISPLAY-ORIGINAL-BATCH
002532        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
002533           MOVE ER-0023             TO EMI-ERROR
002534           MOVE -1                  TO BMAINTL
002535           MOVE AL-UABON            TO BMAINTA
002536           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002537           GO TO 8200-SEND-DATAONLY
002538        ELSE
002539           NEXT SENTENCE
002540     ELSE
002541        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
002542           MOVE ER-0023             TO EMI-ERROR
002543           MOVE -1                  TO BMAINTL
002544           MOVE AL-UABON            TO BMAINTA
002545           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002546           GO TO 8200-SEND-DATAONLY.
002547
002548     IF BMAINTI = 'S'
002549        GO TO 1100-SHOW-REQUEST.
002550
002551     IF NOT MODIFY-CAP
002552         MOVE 'UPDATE'       TO SM-READ
002553         PERFORM 9995-SECURITY-VIOLATION
002554         MOVE ER-0070        TO EMI-ERROR
002555         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002556         GO TO 8100-SEND-INITIAL-MAP.
002557
002558     IF BMAINTL GREATER THAN ZEROS
002559        IF PI-PF5-FUNCTION
002560           IF BMAINTI NOT = 'A'
002561              MOVE AL-UABON  TO BMAINTA
002562              MOVE -1        TO BMAINTL
002563              MOVE ER-2260   TO EMI-ERROR
002564              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002565              GO TO 8200-SEND-DATAONLY.
002566
002567     IF BCERTNOL = ZEROS
002568       AND (BMAINTI = 'C' OR 'K' OR 'D')
002569         NEXT SENTENCE
002570     ELSE
002571         IF BCERTNOL NOT = ZEROS
002572             MOVE AL-UANON       TO BCERTNOA
002573         ELSE
002574             MOVE -1             TO BCERTNOL
002575             MOVE  1             TO SET-CURSOR-SW
002576             MOVE ER-2218        TO EMI-ERROR
002577             MOVE AL-UABON       TO BCERTNOA
002578             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002579
002580     IF BSUFIXL NOT = ZEROS
002581         MOVE AL-UANON       TO BSUFIXA
002582     ELSE
002583         MOVE AL-SANOF       TO BSUFIXA.
002584
002585     
      * EXEC CICS READ
002586*        set     (address of pending-business)
002587*        DATASET (FILE-ID-ERPNDB)
002588*        INTO    (PENDING-BUSINESS)
002589*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
002590*    END-EXEC.
      *    MOVE '&"S        E          (   #00009806' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303039383036' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 PI-PREV-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF pending-business TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002591
002592     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
002593        NEXT SENTENCE
002594     ELSE
002595        IF BEFFDTL NOT = ZEROS
002596           MOVE AL-UNNON             TO BEFFDTA
002597           MOVE BEFFDTI              TO DEEDIT-FIELD
002598           PERFORM 8600-DEEDIT
002599           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
002600           MOVE 4                    TO DC-OPTION-CODE
002601           PERFORM 9700-DATE-LINK
002602           IF NO-CONVERSION-ERROR
002603              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
002604              ELSE
002605              MOVE -1                TO BEFFDTL
002606              MOVE  1                TO SET-CURSOR-SW
002607              MOVE ER-2226           TO EMI-ERROR
002608              MOVE AL-UNBON          TO BEFFDTA
002609              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002610           ELSE
002611              MOVE -1                TO BEFFDTL
002612              MOVE  1                TO SET-CURSOR-SW
002613              MOVE ER-2220           TO EMI-ERROR
002614              MOVE AL-UNBON          TO BEFFDTA
002615              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002616
002617     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
002618
002619     IF BCERTNOL NOT = ZEROS
002620        MOVE BCERTNOI                TO WS-NEW-PRIME
002621     ELSE
002622        MOVE SPACES                  TO WS-NEW-PRIME.
002623
002624     IF BSUFIXL NOT = ZEROS
002625        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
002626     ELSE
002627        MOVE SPACE                   TO WS-NEW-SUFFIX.
002628
002629     IF BEFFDTL NOT = ZEROS
002630        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
002631     ELSE
002632        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
002633
002634     IF BMAINTI = 'A' OR 'K' OR 'S'
002635        NEXT SENTENCE
002636     ELSE
002637        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
002638        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
002639           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
002640           WS-PB-RECORD-TYPE NOT = '1'
002641           IF BMAINTI = 'C'
002642               MOVE ER-2287          TO EMI-ERROR
002643               MOVE -1               TO BCERTNOL
002644               MOVE AL-UABON         TO BCERTNOA BEFFDTA
002645               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002646               GO TO 8200-SEND-DATAONLY
002647             ELSE
002648               MOVE ER-2260          TO EMI-ERROR
002649               MOVE -1               TO BCERTNOL
002650               MOVE AL-UABON         TO BCERTNOA
002651               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002652               GO TO 8200-SEND-DATAONLY.
002653
002654     IF BMAINTI = 'D'
002655         GO TO 1400-DELETE-ISSUE-ROUTINE.
002656
002657*    IF BMICRNOL  NOT =  ZEROS
002658*        IF BMICRNOI  NUMERIC
002659*            MOVE AL-UNNON       TO  BMICRNOA
002660*        ELSE
002661*            MOVE -1             TO  BMICRNOL
002662*            MOVE 1              TO  SET-CURSOR-SW
002663*            MOVE AL-UNBON       TO  BMICRNOA
002664*            MOVE ER-2701        TO  EMI-ERROR
002665*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002666
002667     IF BVINL NOT = ZEROS
002668        MOVE AL-UANON            TO BVINA
002669     END-IF
002670
002671     IF LETRREQL   GREATER THAN ZEROS
002672        IF LETRREQI = 'Y'
002673          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
002674           CONTINUE
002675        ELSE
002676        IF LETRREQI = 'N'
002677          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
002678           CONTINUE
002679        ELSE
002680           MOVE -1               TO LETRREQL
002681           MOVE ER-1585          TO EMI-ERROR
002682           MOVE AL-UABON         TO LETRREQA
002683           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002684        END-IF
002685     END-IF.
002686
002687     IF B1STNML NOT = ZEROS
002688         MOVE AL-UANON                TO B1STNMA.
002689
002690     IF BINITL  NOT = ZEROS
002691        MOVE AL-UANON                TO BINITA.
002692
002693     IF BSEXL NOT = ZEROS
002694        IF BSEXI = 'M' OR 'F'
002695           MOVE AL-UANON             TO BSEXA
002696        ELSE
002697           MOVE -1               TO BSEXL
002698           MOVE ER-2629          TO EMI-ERROR
002699           MOVE AL-UABON         TO BSEXA
002700           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002701
002702     IF BAGEL NOT = ZEROS
002703         IF BAGEI NUMERIC
002704             MOVE BAGEI              TO WS-BAGE
002705             MOVE AL-UNNON           TO BAGEA
002706         ELSE
002707             MOVE -1                 TO BAGEL
002708             MOVE  1                 TO SET-CURSOR-SW
002709             MOVE ER-2223            TO EMI-ERROR
002710             MOVE AL-UNBON           TO BAGEA
002711             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002712
002713     IF BLSTNML NOT = ZERO  OR
002714        B1STNML NOT = ZERO  OR
002715        BINITL NOT = ZERO
002716         IF BAGEL = ZEROS
002717             MOVE -1                 TO BAGEL
002718             MOVE  1                 TO SET-CURSOR-SW
002719             MOVE ER-3269            TO EMI-ERROR
002720             MOVE AL-UNBON           TO BAGEA
002721             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002722         END-IF
002723     END-IF.
002724
002725     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
002726
002727     IF (BBIRTHL GREATER THAN +0) AND
002728        (BBIRTHI NOT EQUAL SPACES)
002729        NEXT SENTENCE
002730     ELSE
002731        GO TO 1010-CHECK-AGE.
002732
002733     MOVE BBIRTHI                TO DEEDIT-FIELD.
002734     PERFORM 8600-DEEDIT.
002735     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
002736     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
002737     MOVE AL-UNNON               TO BBIRTHA.
002738     MOVE '4'                    TO DC-OPTION-CODE.
002739     PERFORM 9700-DATE-LINK.
002740     IF DATE-CONVERSION-ERROR
002741        MOVE -1                  TO BBIRTHL
002742        MOVE  1                  TO SET-CURSOR-SW
002743        MOVE ER-2228             TO EMI-ERROR
002744        MOVE AL-UNBON            TO BBIRTHA
002745        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002746        GO TO 1010-CHECK-AGE.
002747
002748     IF (NO-CONVERSION-ERROR) AND
002749        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
002750        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
002751        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
002752        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
002753                                    WS-CONVERTED-BIRTH
002754        MOVE AL-UANON            TO BBIRTHA
002755     ELSE
002756        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
002757        MOVE AL-UANON            TO BBIRTHA.
002758
002759 1010-CHECK-AGE.
002760
002761*    IF BAGEL = ZERO
002762*       IF BBIRTHL GREATER THAN ZERO
002763*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
002764
002765     IF B1STPMTL NOT = ZEROS
002766        IF B1STPMTI = SPACES
002767           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
002768        ELSE
002769           MOVE B1STPMTI             TO DEEDIT-FIELD
002770           PERFORM 8600-DEEDIT
002771           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
002772           MOVE AL-UNNON             TO B1STPMTA
002773           MOVE 4                    TO DC-OPTION-CODE
002774           PERFORM 9700-DATE-LINK
002775           IF NO-CONVERSION-ERROR
002776              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
002777              MOVE AL-UANON          TO B1STPMTA
002778           ELSE
002779              MOVE -1                TO B1STPMTL
002780              MOVE  1                TO SET-CURSOR-SW
002781              MOVE ER-2200           TO EMI-ERROR
002782              MOVE AL-UNBON          TO B1STPMTA
002783              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002784
002785     IF BDAYSL NOT = ZEROS
002786         IF BDAYSI NUMERIC
002787             MOVE AL-UNNON           TO BDAYSA
002788         ELSE
002789             MOVE -1                 TO BDAYSL
002790             MOVE ER-2530            TO EMI-ERROR
002791             MOVE AL-UNBON           TO BDAYSA
002792             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002793
002794     IF BLNTRML NOT = ZEROS
002795         IF BLNTRMI NUMERIC
002796             MOVE AL-UNNON       TO BLNTRMA
002797         ELSE
002798             MOVE -1             TO BLNTRML
002799             MOVE ER-2533        TO EMI-ERROR
002800             MOVE AL-UNBON       TO BLNTRMA
002801             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002802
002803**   IF PI-COMPANY-ID = 'DMD'
002804     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL' or 'FNL'
002805        NEXT SENTENCE
002806     ELSE
002807         IF BLNOFCRL NOT = ZEROS
002808            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
002809            IF LOAN-OFFICER-FOUND
002810                MOVE AL-UANON        TO BLNOFCRA
002811             ELSE
002812                 MOVE SPACE          TO WS-LOAN-OFFICER
002813                 MOVE -1             TO BLNOFCRL
002814                 MOVE  1             TO SET-CURSOR-SW
002815                 MOVE ER-3006        TO EMI-ERROR
002816                 MOVE AL-UNBON       TO BLNOFCRA
002817                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002818
002819     IF BFREQL NOT = ZEROS
002820         IF BFREQI NUMERIC
002821             MOVE AL-UNNON       TO BFREQA
002822         ELSE
002823             MOVE -1             TO BFREQL
002824             MOVE  1             TO SET-CURSOR-SW
002825             MOVE ER-2223        TO EMI-ERROR
002826             MOVE AL-UNBON       TO BFREQA
002827             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002828
002829     IF BMODEL NOT = ZEROS
002830         MOVE BMODEI             TO WS-MODE-CODE
002831                                    PI-BMODE
002832         IF WS-MODE-CODE-VALID
002833             MOVE AL-UANON       TO BMODEA
002834         ELSE
002835             MOVE -1             TO BMODEL
002836             MOVE ER-2591        TO EMI-ERROR
002837             MOVE AL-UABON       TO BMODEA
002838             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002839
002840     IF BPMTSL NOT = ZEROS
002841         IF BPMTSI NUMERIC
002842             MOVE AL-UNNON           TO BPMTSA
002843             MOVE BPMTSI             TO PI-BPMTS
002844         ELSE
002845             MOVE -1                 TO BPMTSL
002846             MOVE ER-2592            TO EMI-ERROR
002847             MOVE AL-UNBON           TO BPMTSA
002848             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002849
002850     IF BPMTAMTL NOT = ZEROS
002851        
      * EXEC CICS BIF DEEDIT
002852*            FIELD  (BPMTAMTI)
002853*            LENGTH (9)
002854*       END-EXEC
           MOVE 9
             TO DFHEIV11
      *    MOVE '@"L                   #   #00010072' TO DFHEIV0
           MOVE X'40224C202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303130303732' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 BPMTAMTI, 
                 DFHEIV11
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
002855        MOVE BPMTAMTI           TO PI-BPMTAMT.
002856
002857*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
002858*        PERFORM 8600-DEEDIT
002859*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
002860
002861*    IF BAPRL NOT = ZEROS
002862*        EXEC CICS BIF DEEDIT
002863*            FIELD  (BAPRI)
002864*            LENGTH (7)
002865*        END-EXEC
002866*        MOVE BAPRI              TO WS-BAPR.
002867
002868
002869     IF BAPRL > 0
002870        MOVE +0                  TO  WS-BAPR
002871        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
002872           (WS-SUB > 7)
002873           OR (BAPRI (WS-SUB:1) NUMERIC)
002874           OR (BAPRI (WS-SUB:1) = '.')
002875        END-PERFORM
002876        IF WS-SUB > 7
002877           MOVE ER-2471       TO EMI-ERROR
002878           MOVE -1            TO BAPRL
002879           MOVE AL-UNBON      TO BAPRA
002880           PERFORM 9900-ERROR-FORMAT
002881                                 THRU 9900-EXIT
002882        ELSE
002883           IF BAPRI (WS-SUB:1) NUMERIC
002884              MOVE WS-SUB           TO WS-BEG
002885              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
002886                 (WS-SUB > 7)
002887                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
002888              END-PERFORM
002889              COMPUTE WS-END = WS-SUB - WS-BEG
002890              MOVE BAPRI (WS-BEG:WS-END)
002891                                 TO WS-APR-WHOLE-NUM
002892           END-IF
002893           IF BAPRI (WS-SUB:1) = '.'
002894              COMPUTE WS-BEG = WS-SUB + 1
002895              IF (WS-BEG < 8)
002896                 AND (BAPRI (WS-BEG:1) NUMERIC)
002897                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
002898                    (WS-SUB > 7)
002899                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
002900                 END-PERFORM
002901                 COMPUTE WS-END = WS-SUB - WS-BEG
002902                 MOVE BAPRI (WS-BEG:WS-END)
002903                                 TO WS-APR-DEC (1:WS-END)
002904              END-IF
002905           END-IF
002906           MOVE AL-UNNON      TO BAPRA
002907           MOVE WS-BAPR       TO BAPRO
002908        END-IF
002909     END-IF
002910
002911*     IF BAPRL NOT = ZEROS
002912*        MOVE BAPRI              TO DEEDIT-FIELD-V4
002913*        PERFORM 8600-DEEDIT
002914*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
002915
002916     IF BLIVESL NOT = ZEROS
002917        MOVE BLIVESI             TO DEEDIT-FIELD
002918        PERFORM 8600-DEEDIT
002919        IF DEEDIT-FIELD-V0 NUMERIC
002920           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
002921           MOVE AL-UNNON         TO BLIVESA
002922        ELSE
002923           MOVE -1               TO BLIVESL
002924           MOVE AL-UNBON         TO BLIVESA
002925           MOVE ER-2223          TO EMI-ERROR
002926           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002927
002928*DMD CUSTOM CODING*************START
002929*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
002930     IF PI-COMPANY-ID NOT = 'DMD'
002931         MOVE ZEROS               TO BBILLEDL
002932         GO TO 1010-EDIT-CONT.
002933
002934     IF BBILLEDL NOT = ZEROS
002935        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
002936        MOVE 'Y'                 TO WS-NUMERIC-SW
002937        MOVE +1                  TO WS-CSO-SUB
002938        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
002939        IF CSO-NUMERIC-FIELD
002940           
      * EXEC CICS BIF DEEDIT
002941*              FIELD  (BBILLEDI)
002942*              LENGTH (9)
002943*          END-EXEC
           MOVE 9
             TO DFHEIV11
      *    MOVE '@"L                   #   #00010161' TO DFHEIV0
           MOVE X'40224C202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303130313631' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 BBILLEDI, 
                 DFHEIV11
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
002944           MOVE BBILLEDI         TO WS-BILLED
002945           MOVE AL-UNNON         TO BBILLEDA
002946        ELSE
002947           MOVE -1               TO BBILLEDL
002948           MOVE AL-UNBON         TO BBILLEDA
002949           MOVE ER-2547          TO EMI-ERROR
002950           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002951     ELSE
002952        IF BMAINTI EQUAL 'A'
002953           MOVE -1               TO BBILLEDL
002954           MOVE AL-UNBON         TO BBILLEDA
002955           MOVE ER-8148          TO EMI-ERROR
002956           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002957
002958 1010-EDIT-CONT.
002959
002960     IF BFORCEL  NOT = ZEROS
002961         IF FORCE-CAP
002962            MOVE AL-UANON            TO BFORCEA
002963         ELSE
002964            MOVE ER-2945             TO EMI-ERROR
002965            MOVE AL-UABON            TO BFORCEA
002966            MOVE -1                  TO BFORCEL
002967            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002968
002969     if (bforcel not = zeros)
002970        and (bforcei = 'L')
002971        and (not csr-edit-session)
002972        and (emi-error <> er-2945)
002973        MOVE ER-2670             TO EMI-ERROR
002974        MOVE AL-UABON            TO BFORCEA
002975        MOVE -1                  TO BFORCEL
002976        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002977     end-if
002978
002979     IF BENTRYL NOT = ZEROS
002980        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
002981                 'C' and 'D' AND 'V' AND 'U' AND 'M'
002982           MOVE ER-2224              TO EMI-ERROR
002983           MOVE AL-UABON             TO BENTRYA
002984           MOVE -1                   TO BENTRYL
002985           MOVE  1                   TO SET-CURSOR-SW
002986           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002987        ELSE
002988           MOVE AL-UANON             TO BENTRYA.
002989
002990     IF BUNWRITL NOT = ZEROS
002991        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
002992           MOVE ER-7574              TO EMI-ERROR
002993           MOVE AL-UABON             TO BUNWRITA
002994           MOVE -1                   TO BUNWRITL
002995           MOVE  1                   TO SET-CURSOR-SW
002996           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002997        ELSE
002998           MOVE AL-UANON             TO BUNWRITA.
002999
003000     IF BREINL  NOT = ZEROS
003001         MOVE AL-UANON               TO BREINA.
003002
003003     IF BBILCDL NOT = ZEROS
003004        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
003005                             AND 'A' AND 'B' AND 'E'
003006           MOVE ER-2225              TO EMI-ERROR
003007           MOVE AL-UABON             TO BBILCDA
003008           MOVE -1                   TO BBILCDL
003009           MOVE  1                   TO SET-CURSOR-SW
003010           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003011        ELSE
003012           MOVE AL-UANON             TO BBILCDA.
003013
003014     IF BSKPCDL NOT = ZEROS
003015         MOVE AL-UANON               TO BSKPCDA.
003016
003017     IF BINDGRPL NOT = ZEROS
003018         MOVE AL-UANON               TO BINDGRPA.
003019
003020     IF BSIGL   NOT = ZEROS
003021         MOVE AL-UANON               TO BSIGA.
003022
003023     IF BRTCLSL NOT = ZEROS
003024         MOVE AL-UANON               TO BRTCLSA.
003025
003026     IF BMEMBERL NOT = ZEROS
003027         MOVE AL-UANON               TO BMEMBERA.
003028
003029     MOVE +0                         TO WS-SUB1.
003030
003031     EJECT
003032
003033******************************************************************
003034*                                                                *
003035*           E D I T   I S S U E   C O V E R A G E S              *
003036*                                                                *
003037******************************************************************
003038
003039 1020-EDIT-COVERAGES.
003040     ADD +1                      TO WS-SUB1.
003041
003042     IF WS-SUB1 GREATER +2
003043        GO TO 1025-EDIT-CONTINUE
003044     END-IF
003045
003046     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
003047       IF (BMODEL   GREATER ZERO  OR
003048            BPMTSL   GREATER ZERO  OR
003049            BPMTAMTL GREATER ZERO)
003050          AND
003051            BTYPE-LEN (WS-SUB1) GREATER THAN +0
003052               GO TO 1021-CONT-EDIT.
003053
003054     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
003055        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
003056        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
003057        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
003058        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
003059        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
003060        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
003061        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
003062        NEXT SENTENCE
003063         ELSE
003064            GO TO 1020-EDIT-COVERAGES.
003065
003066 1021-CONT-EDIT.
003067
003068     IF BMAINTI = 'A'
003069        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
003070           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
003071        ELSE
003072           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
003073           MOVE ER-7404          TO EMI-ERROR
003074           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
003075           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003076     ELSE
003077        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
003078           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
003079
003080     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
003081        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
003082        PERFORM 8600-DEEDIT
003083        IF DEEDIT-FIELD-V0 NUMERIC
003084           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
003085        ELSE
003086           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
003087
003088     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
003089*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
003090        IF BMODEL  GREATER THAN ZEROS  AND
003091           BPMTSL  GREATER THAN ZEROS
003092           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
003093
003094     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
003095         IF BMODEL   GREATER THAN ZEROS  OR
003096            BPMTSL   GREATER THAN ZEROS  OR
003097            BPMTAMTL GREATER THAN ZEROS
003098             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
003099
003100     IF BMAINTI = ('C' OR 'K')
003101        IF BTERM-LEN (WS-SUB1)  = ZEROS
003102           NEXT SENTENCE
003103        ELSE
003104           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
003105           PERFORM 8600-DEEDIT
003106           IF DEEDIT-FIELD-V0 NUMERIC
003107              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
003108              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
003109                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
003110              ELSE
003111                    MOVE ER-2241      TO EMI-ERROR
003112                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
003113                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
003114                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003115           ELSE
003116              MOVE ER-2223          TO EMI-ERROR
003117              MOVE -1               TO BTERM-LEN     (WS-SUB1)
003118              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
003119              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003120     ELSE
003121        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
003122            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
003123            PERFORM 8600-DEEDIT
003124            IF DEEDIT-FIELD-V0      NUMERIC
003125               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
003126                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
003127                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
003128               ELSE
003129                  MOVE ER-2241         TO EMI-ERROR
003130                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
003131                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
003132                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003133            ELSE
003134              MOVE ER-2223             TO EMI-ERROR
003135              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
003136              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
003137              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003138        ELSE
003139            MOVE ER-2240               TO EMI-ERROR
003140            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
003141            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003142*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
003143*        IF BMODEL  GREATER THAN ZEROS  AND
003144*           BPMTSL  GREATER THAN ZEROS
003145*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
003146
003147     IF BBEN-LEN (WS-SUB1) = ZEROS
003148        AND BMAINTI = ('C' OR 'K')
003149           NEXT SENTENCE
003150     ELSE
003151        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
003152           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
003153           
      * EXEC CICS BIF DEEDIT
003154*              FIELD  (BBENI (WS-SUB1))
003155*              LENGTH (12)
003156*          END-EXEC
           MOVE 12
             TO DFHEIV11
      *    MOVE '@"L                   #   #00010374' TO DFHEIV0
           MOVE X'40224C202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303130333734' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 BBENI(WS-SUB1), 
                 DFHEIV11
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
003157           IF BBENI (WS-SUB1)  NUMERIC
003158              IF BBENI (WS-SUB1) GREATER THAN ZEROS
003159                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
003160*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
003161*          PERFORM 8600-DEEDIT
003162*          IF DEEDIT-FIELD-V2  NUMERIC
003163*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
003164*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
003165              ELSE
003166                 MOVE ER-7632    TO EMI-ERROR
003167                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
003168                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
003169                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003170           ELSE
003171              MOVE ER-2223         TO EMI-ERROR
003172              MOVE -1              TO BBEN-LEN   (WS-SUB1)
003173              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
003174              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003175        ELSE
003176           MOVE ER-7632    TO EMI-ERROR
003177           MOVE -1         TO BBEN-LEN   (WS-SUB1)
003178           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
003179           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003180
003181     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
003182        AND (BMAINTI = ('C' OR 'K'))
003183        CONTINUE
003184     ELSE
003185        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
003186           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
003187           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
003188              FOR ALL '.'
003189           IF WS-TALLY > 1
003190              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
003191                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
003192              END-PERFORM
003193              IF A1 < 9
003194                 ADD 3 TO A1
003195                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
003196              END-IF
003197           ELSE
003198              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
003199                (A1 > 11)
003200                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
003201                  LOW-VALUES OR SPACES)
003202              END-PERFORM
003203              IF A1 > 1 AND < 12
003204                 MOVE SPACES
003205                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
003206              END-IF
003207           END-IF
003208
003209           
      * EXEC CICS BIF DEEDIT
003210*              FIELD  (BPREMI (WS-SUB1))
003211*              LENGTH (11)
003212*          END-EXEC
           MOVE 11
             TO DFHEIV11
      *    MOVE '@"L                   #   #00010430' TO DFHEIV0
           MOVE X'40224C202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303130343330' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 BPREMI(WS-SUB1), 
                 DFHEIV11
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
003213           IF BPREMI (WS-SUB1) NUMERIC
003214              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
003215                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
003216*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
003217*          PERFORM 8600-DEEDIT
003218*          IF DEEDIT-FIELD-V2  NUMERIC
003219*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
003220*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
003221              ELSE
003222                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
003223                    MOVE ER-7633    TO EMI-ERROR
003224                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
003225                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
003226                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003227                 END-IF
003228              END-IF
003229           ELSE
003230              MOVE ER-2223         TO EMI-ERROR
003231              MOVE -1              TO BPREM-LEN   (WS-SUB1)
003232              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
003233              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003234           END-IF
003235        ELSE
003236           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
003237              MOVE ER-7633         TO EMI-ERROR
003238              MOVE -1              TO BPREM-LEN   (WS-SUB1)
003239              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
003240              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003241           END-IF
003242        END-IF
003243     END-IF
003244
003245     IF BCPREM-LEN   (WS-SUB1) = ZEROS
003246        NEXT SENTENCE
003247     ELSE
003248        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
003249        
      * EXEC CICS BIF DEEDIT
003250*           FIELD  (BCPREMI (WS-SUB1))
003251*           LENGTH (11)
003252*       END-EXEC
           MOVE 11
             TO DFHEIV11
      *    MOVE '@"L                   #   #00010470' TO DFHEIV0
           MOVE X'40224C202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303130343730' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 BCPREMI(WS-SUB1), 
                 DFHEIV11
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
003253        IF BCPREMI (WS-SUB1) NUMERIC
003254           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
003255*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
003256*       PERFORM 8600-DEEDIT
003257*       IF DEEDIT-FIELD-V2  NUMERIC
003258*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
003259        ELSE
003260           MOVE ER-2223         TO EMI-ERROR
003261           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
003262           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
003263           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003264
003265     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
003266        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
003267        PERFORM 8600-DEEDIT
003268        IF DEEDIT-FIELD-V0 NUMERIC
003269           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
003270           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
003271         ELSE
003272           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
003273           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
003274           MOVE ER-2223              TO EMI-ERROR
003275           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003276
003277     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
003278        IF BEXPIRE   (WS-SUB1) = SPACES
003279           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
003280        ELSE
003281           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
003282           PERFORM 8600-DEEDIT
003283           IF DEEDIT-FIELD-V0        NUMERIC
003284              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
003285              MOVE 4                TO DC-OPTION-CODE
003286              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
003287              PERFORM 9700-DATE-LINK
003288              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
003289                                                        (WS-SUB1)
003290              IF NO-CONVERSION-ERROR
003291                 NEXT SENTENCE
003292              ELSE
003293                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
003294                 MOVE ER-2531    TO EMI-ERROR
003295                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
003296                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003297           ELSE
003298             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
003299             MOVE ER-2532        TO EMI-ERROR
003300             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
003301             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003302
003303     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
003304        NEXT SENTENCE
003305     ELSE
003306        
      * EXEC CICS BIF DEEDIT
003307*           FIELD  (BALT-BENI (WS-SUB1))
003308*           LENGTH (12)
003309*       END-EXEC
           MOVE 12
             TO DFHEIV11
      *    MOVE '@"L                   #   #00010527' TO DFHEIV0
           MOVE X'40224C202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303130353237' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 BALT-BENI(WS-SUB1), 
                 DFHEIV11
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
003310        IF BALT-BENI (WS-SUB1) NUMERIC
003311           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
003312*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
003313*       PERFORM 8600-DEEDIT
003314*       IF DEEDIT-FIELD-V0 NUMERIC
003315*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
003316        ELSE
003317           MOVE ER-2223         TO EMI-ERROR
003318           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
003319           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
003320           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003321
003322     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
003323        NEXT SENTENCE
003324     ELSE
003325        
      * EXEC CICS BIF DEEDIT
003326*           FIELD  (BALT-PREMI (WS-SUB1))
003327*           LENGTH (11)
003328*       END-EXEC
           MOVE 11
             TO DFHEIV11
      *    MOVE '@"L                   #   #00010546' TO DFHEIV0
           MOVE X'40224C202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303130353436' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 BALT-PREMI(WS-SUB1), 
                 DFHEIV11
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
003329        IF BALT-PREMI (WS-SUB1) NUMERIC
003330           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
003331*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
003332*       PERFORM 8600-DEEDIT
003333*       IF DEEDIT-FIELD-V0 NUMERIC
003334*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
003335        ELSE
003336           MOVE ER-2223         TO EMI-ERROR
003337           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
003338           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
003339           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003340
003341      GO TO 1020-EDIT-COVERAGES.
003342
003343     .
003344 1025-edit-continue.
003345
003346     IF PI-COMPANY-ID  =  'DMD'
003347        MOVE LOW-VALUES             TO BNCERTI
003348                                       BNSTATI.
003349
003350     IF EMI-ERROR = ZEROS
003351         NEXT SENTENCE
003352     ELSE
003353         GO TO 8200-SEND-DATAONLY.
003354
003355     IF BMAINTI = 'A'
003356         GO TO 1200-ADD-ISSUE-ROUTINE.
003357
003358     IF BMAINTI = 'C'
003359         GO TO 1300-CHANGE-ISSUE-ROUTINE.
003360
003361**  This must be a 'K' transaction A,C,S & D spoke for
003362
003363     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
003364
003365     EJECT
003366
003367 1030-EDIT-FOR-NUMERICS.
003368     IF WS-CSO-SUB EQUAL 10
003369        GO TO 1030-EDIT-EXIT.
003370
003371     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
003372        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
003373        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
003374           ADD +1               TO WS-CSO-SUB
003375           GO TO 1030-EDIT-FOR-NUMERICS.
003376
003377     MOVE 'N'                   TO WS-NUMERIC-SW.
003378
003379 1030-EDIT-EXIT.
003380******************************************************************
003381*                                                                *
003382*                 C A L C U L A T E   A G E                      *
003383*                                                                *
003384******************************************************************
003385
003386
003387 1095-CALC-AGE.
003388
003389     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
003390     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
003391     MOVE 1                  TO DC-OPTION-CODE.
003392     PERFORM 9700-DATE-LINK
003393     IF NO-CONVERSION-ERROR
003394         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
003395         MOVE WS-BAGE            TO BAGEI
003396         MOVE +2                 TO BAGEL
003397         MOVE AL-UNNON TO BAGEA.
003398
003399 1099-EXIT.
003400     EXIT.
003401
003402     EJECT
003403
003404******************************************************************
003405*                                                                *
003406*                   S H O W   I S S U E                          *
003407*                                                                *
003408******************************************************************
003409
003410 1100-SHOW-REQUEST.
003411     MOVE 'S'                    TO PI-MAINT-FUNCTION.
003412
003413     IF BCERTNOL = ZEROS AND
003414        BEFFDTL  = ZEROS
003415        MOVE -1                  TO BMAINTL
003416        GO TO 8200-SEND-DATAONLY.
003417
003418     MOVE BCERTNOI               TO WS-NEW-PRIME.
003419
003420     IF BSUFIXL NOT = ZEROS
003421        MOVE BSUFIXI             TO WS-NEW-SUFFIX
003422     ELSE
003423        MOVE SPACE               TO WS-NEW-SUFFIX.
003424
003425     MOVE BEFFDTI                TO DEEDIT-FIELD.
003426     PERFORM 8600-DEEDIT.
003427     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
003428     MOVE '4'                    TO DC-OPTION-CODE.
003429     PERFORM 9700-DATE-LINK.
003430     IF DATE-CONVERSION-ERROR
003431        MOVE ER-0348             TO EMI-ERROR
003432        MOVE -1                  TO BEFFDTL
003433        MOVE AL-UABON            TO BEFFDTA
003434        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003435        GO TO 8200-SEND-DATAONLY
003436     ELSE
003437        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
003438        MOVE AL-UANON            TO BEFFDTA
003439        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
003440
003441     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
003442
003443     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
003444        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
003445          MOVE 'Y'                    TO WS-SHOW-SW
003446          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
003447             GO TO 4100-BROWSE-PRIMARY-FORWARD
003448           ELSE
003449             IF PI-FILE-BROWSE
003450                GO TO 4300-BROWSE-FILE-FORWARD
003451              ELSE
003452                IF PI-CSR-BROWSE
003453                   GO TO 4200-BROWSE-CSR-FORWARD
003454                ELSE
003455                   GO TO 4000-BROWSE-DETAIL-FORWARD
003456        ELSE
003457           GO TO 3900-RE-DISPLAY-RECORD.
003458
003459     EJECT
003460
003461******************************************************************
003462*                                                                *
003463*            A D D   I S S U E   R O U T I N E                   *
003464*                                                                *
003465******************************************************************
003466
003467***************************************************************
003468*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
003469*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
003470*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
003471*     4. LINK TO THE EDIT ROUTINE.                            *
003472*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
003473*     6. WRITE THE NEW ISSUE RECORD.                          *
003474*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
003475*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
003476*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
003477*        ELSE                                                 *
003478*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
003479***************************************************************
003480
003481 1200-ADD-ISSUE-ROUTINE.
003482     MOVE 'A'                    TO PI-MAINT-FUNCTION.
003483
003484     
      * EXEC CICS GETMAIN
003485*        SET     (ADDRESS OF PENDING-BUSINESS)
003486*        LENGTH  (ERPNDB-RECORD-LENGTH)
003487*    END-EXEC.
      *    MOVE '," L                  $   #00010705' TO DFHEIV0
           MOVE X'2C22204C2020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303130373035' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 ERPNDB-RECORD-LENGTH, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
003488
003489     
      * EXEC CICS HANDLE CONDITION
003490*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
003491*    END-EXEC.
      *    MOVE '"$I                   ! # #00010710' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'2320233030303130373130' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
003492
003493     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
003494     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
003495     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
003496
003497     
      * EXEC CICS READ
003498*        INTO    (PENDING-BUSINESS)
003499*        DATASET (FILE-ID-ERPNDB)
003500*        RIDFLD  (ERPNDB-KEY)
003501*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&"IL       E          (   #00010718' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303130373138' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
003502
003503     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
003504
003505     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
003506     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
003507     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
003508     MOVE SPACES                 TO PENDING-BUSINESS.
003509     MOVE 'PB'                   TO PB-RECORD-ID.
003510     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
003511     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
003512     MOVE SPACES                 TO PB-CERT-SFX.
003513     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
003514     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
003515                                    PB-ALT-CHG-SEQ-NO.
003516
003517     MOVE BCERTNOI               TO PB-CERT-PRIME.
003518     MOVE '1'                    TO PB-RECORD-TYPE.
003519
003520     IF BSUFIXL NOT = ZEROS
003521        MOVE BSUFIXI             TO PB-CERT-SFX.
003522
003523     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
003524
003525     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
003526     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
003527
003528     MOVE ZEROS                  TO PB-I-LOAN-TERM
003529                                    PB-I-LF-PREM-CALC
003530                                    PB-I-LF-ALT-PREM-CALC
003531                                    PB-I-LF-RATE
003532                                    PB-I-LF-ALT-RATE
003533                                    PB-I-LF-REI-RATE
003534                                    PB-I-LF-ALT-REI-RATE
003535                                    PB-I-RATE-DEV-PCT-LF
003536                                    PB-I-AH-PREM-CALC
003537                                    PB-I-AH-RATE
003538                                    PB-I-AH-REI-RATE
003539                                    PB-I-AH-RATE-TRM
003540                                    PB-I-RATE-DEV-PCT-AH
003541                                    PB-I-BUSINESS-TYPE
003542                                    PB-I-LIFE-COMMISSION
003543                                    PB-I-JOINT-COMMISSION
003544                                    PB-I-JOINT-AGE
003545                                    PB-I-AH-COMMISSION
003546                                    PB-I-CURR-SEQ
003547                                    PB-CHG-COUNT
003548                                    PB-LF-BILLED-AMTS
003549                                    PB-AH-BILLED-AMTS
003550                                    PB-CALC-TOLERANCE
003551                                    PB-I-EXTENTION-DAYS
003552*                                   PB-I-MICROFILM-NO
003553                                    PB-I-TERM-IN-DAYS.
003554
003555     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
003556                                    PB-I-LF-EXPIRE-DT
003557                                    PB-I-AH-EXPIRE-DT
003558                                    PB-BILLED-DT
003559                                    PB-ACCT-EFF-DT
003560                                    PB-ACCT-EXP-DT
003561                                    PB-I-1ST-PMT-DT.
003562
003563     MOVE 'X'                    TO PB-FATAL-FLAG.
003564
003565     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
003566
003567     IF BLSTNML GREATER THAN ZEROS
003568         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
003569
003570*    IF BMICRNOL  GREATER  ZEROS
003571*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
003572*    ELSE
003573*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
003574
003575     IF BVINL > ZEROS
003576        MOVE BVINI               TO PB-I-VIN
003577     END-IF
003578
003579     IF B1STNML GREATER THAN ZEROS
003580         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
003581
003582     IF BINITL  GREATER THAN ZEROS
003583         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
003584
003585     IF BBIRTHL GREATER THAN ZERO
003586         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
003587     ELSE
003588         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
003589
003590     IF B1STPMTL GREATER THAN ZERO
003591         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
003592     ELSE
003593         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
003594
003595     IF BAGEL    GREATER THAN ZEROS
003596         MOVE BAGEI              TO PB-I-AGE
003597        ELSE
003598         MOVE ZEROS              TO PB-I-AGE.
003599
003600     IF BSEXL    GREATER THAN ZEROS
003601         MOVE BSEXI              TO PB-I-INSURED-SEX.
003602
003603     IF BTERM-LEN (1) GREATER THAN ZEROS
003604        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
003605     ELSE
003606        MOVE ZEROS               TO PB-I-LF-TERM.
003607
003608     IF BTERM-LEN (2) GREATER THAN ZEROS
003609        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
003610     ELSE
003611        MOVE ZEROS               TO PB-I-AH-TERM.
003612
003613     IF BLNTRML       GREATER THAN ZEROS
003614         MOVE BLNTRMI            TO PB-I-LOAN-TERM
003615        ELSE
003616         MOVE ZEROS              TO PB-I-LOAN-TERM.
003617
003618     IF BFREQL        GREATER THAN ZEROS
003619         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
003620        ELSE
003621         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
003622
003623     IF BSKPCDL       GREATER THAN ZEROS
003624         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
003625
003626     IF BMODEL        GREATER THAN ZEROS
003627         MOVE BMODEI             TO PB-I-TERM-TYPE
003628                                    PI-BMODE.
003629
003630     IF BPMTSL        GREATER THAN ZEROS
003631         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
003632                                    PI-BPMTS
003633        ELSE
003634         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
003635                                    PI-BPMTS.
003636
003637     IF BPMTAMTL      GREATER THAN ZEROS
003638         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
003639        ELSE
003640         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
003641
003642     IF BTYPE-LEN (1)   GREATER THAN ZEROS
003643        IF BTYPE  (1)   NOT = ZEROS
003644           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
003645                                    PI-BTYPE (1)
003646           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
003647           MOVE SPACES           TO PB-I-LF-ABBR
003648        ELSE
003649           MOVE SPACES           TO PB-I-LF-INPUT-CD
003650                                    PB-I-LF-ABBR
003651           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
003652     ELSE
003653        MOVE SPACES              TO PB-I-LF-INPUT-CD
003654                                    PB-I-LF-ABBR
003655        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
003656
003657     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
003658         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
003659     ELSE
003660         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
003661
003662     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
003663         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
003664     ELSE
003665         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
003666
003667     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
003668         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
003669            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
003670            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
003671         ELSE
003672            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
003673*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
003674*           MOVE '?'             TO PB-I-LF-CALC-FLAG
003675         END-IF
003676     ELSE
003677         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
003678
003679     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
003680         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
003681
003682     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
003683         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
003684         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
003685     ELSE
003686         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
003687
003688     IF  BALT-PREM-LEN     (2) > ZEROS
003689         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
003690     ELSE
003691         MOVE ZEROS            TO PB-I-TOT-FEES.
003692
003693     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
003694        IF BTYPE      (2)   NOT = ZEROS
003695           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
003696                                  PI-BTYPE (2)
003697           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
003698           MOVE SPACES         TO PB-I-AH-ABBR
003699        ELSE
003700           MOVE SPACES         TO PB-I-AH-INPUT-CD
003701                                  PB-I-AH-ABBR
003702           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
003703     ELSE
003704        MOVE SPACES            TO PB-I-AH-INPUT-CD
003705                                  PB-I-AH-ABBR
003706        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
003707
003708     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
003709         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
003710     ELSE
003711         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
003712
003713     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
003714         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
003715            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
003716            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
003717         ELSE
003718            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
003719*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
003720*           MOVE '?'             TO PB-I-AH-CALC-FLAG
003721         END-IF
003722     ELSE
003723         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
003724
003725     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
003726         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
003727
003728     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
003729        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
003730     ELSE
003731        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
003732
003733     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
003734        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
003735     ELSE
003736        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
003737
003738     IF BINDGRPL  GREATER THAN ZEROS
003739         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
003740
003741     IF BRTCLSL   GREATER THAN ZEROS
003742         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
003743
003744     IF BSIGL     GREATER THAN ZEROS
003745         MOVE BSIGI              TO PB-I-SIG-SW.
003746
003747     IF BAPRL > ZEROS
003748         MOVE WS-BAPR            TO PB-I-LOAN-APR
003749     ELSE
003750        if pi-company-id = 'CID'
003751           move +99.9999         to pb-i-loan-apr
003752        else
003753           MOVE ZEROS            TO PB-I-LOAN-APR
003754        end-if
003755     end-if
003756
003757     IF BMEMBERL  GREATER THAN ZEROS
003758         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
003759
003760     IF BLNOFCRL  GREATER THAN ZEROS
003761         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
003762
003763     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
003764        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
003765     ELSE
003766        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
003767
003768     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
003769        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
003770     ELSE
003771        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
003772
003773     IF BDAYSL   GREATER THAN ZEROS
003774        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
003775                                    PB-I-EXTENTION-DAYS
003776     ELSE
003777        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
003778                                    PB-I-EXTENTION-DAYS.
003779
003780     IF BDAYSL GREATER THAN ZEROS
003781        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
003782
003783     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
003784        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
003785           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
003786
003787     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
003788        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
003789           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
003790
003791     IF B1STPMTL GREATER THAN ZEROS
003792        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
003793
003794     IF PB-EXT-DAYS-PROCESSING
003795        IF PB-I-EXTENTION-DAYS = ZEROS
003796           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
003797
003798     IF PB-EXPIRE-DT-PROCESSING
003799        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
003800           PB-I-AH-EXPIRE-DT = LOW-VALUES
003801             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
003802
003803     IF PB-1ST-PMT-DT-PROCESSING
003804        IF PB-I-1ST-PMT-DT = LOW-VALUES
003805           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
003806
003807     IF BREINL GREATER THAN ZEROS
003808        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
003809
003810     IF BENTRYL NOT = ZEROS
003811        MOVE BENTRYI             TO PB-BATCH-ENTRY
003812        IF PI-COMPANY-ID = 'CID'
003813           AND (PB-BATCH-ENTRY = 'P')
003814           AND (PB-STATE = 'VA')
003815           PERFORM 1500-UPDATE-ERNOTE
003816                                 THRU 1500-EXIT
003817        END-IF
003818     END-IF
003819
003820     IF BUNWRITL NOT = ZEROS
003821        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
003822
003823     IF BFORCEL NOT = ZEROS
003824        MOVE BFORCEI             TO PB-FORCE-CODE.
003825
003826     IF BBILCDL NOT = ZEROS
003827        MOVE BBILCDI             TO PB-RECORD-BILL.
003828
003829     IF BLIVESL GREATER THAN ZEROS
003830        MOVE WS-BLIVES           TO PB-I-LIVES
003831     ELSE
003832        MOVE ZEROS               TO PB-I-LIVES.
003833
003834     IF BBILLEDL GREATER THAN ZEROS
003835        MOVE WS-BILLED           TO PB-I-NUM-BILLED
003836     ELSE
003837        MOVE ZEROS               TO PB-I-NUM-BILLED.
003838
003839*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
003840
003841 1260-WRITE-PB-RECORD.
003842     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
003843                                    PB-INPUT-BY.
003844     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
003845     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
003846                                    PB-INPUT-DT.
003847
003848     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
003849     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
003850                                    PB-CONTROL-BY-ORIG-BATCH.
003851
003852
003853     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
003854     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
003855     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
003856     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
003857     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
003858
003859     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
003860
003861     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
003862
003863     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
003864     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
003865     MOVE PB-SV-STATE            TO PI-SV-STATE.
003866
003867     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
003868     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
003869
003870 1275-WRITE-PENDING-BUSINESS.
003871     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
003872     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
003873     MOVE 'A'                    TO JP-RECORD-TYPE.
003874     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
003875
003876     
      * EXEC CICS HANDLE CONDITION
003877*        DUPREC (1290-DUPLICATE-ALT-INDEX)
003878*    END-EXEC.
      *    MOVE '"$%                   ! $ #00011097' TO DFHEIV0
           MOVE X'222425202020202020202020' &
                X'202020202020202020202120' &
                X'2420233030303131303937' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
003879
003880     move 'CERT'                 to pa-rec-type
003881     move pi-company-id          to pa-company-id
003882     move pending-business       to pa-rest-of-record
003883
003884     
      * EXEC CICS LINK
003885*        PROGRAM  ('WF001')
003886*        COMMAREA (work-flow-pass-area)
003887*        LENGTH   (604)
003888*    END-EXEC
           MOVE 'WF001' TO DFHEIV1
           MOVE 604
             TO DFHEIV11
      *    MOVE '."C                   (   #00011105' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303131313035' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 work-flow-pass-area, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
003889
003890     
      * EXEC CICS WRITE
003891*        DATASET (FILE-ID-ERPNDB)
003892*        FROM    (PENDING-BUSINESS)
003893*        RIDFLD  (PB-CONTROL-PRIMARY)
003894*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00011111' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'2020233030303131313131' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 PB-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
003895
003896     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
003897
003898     PERFORM 8400-LOG-JOURNAL-RECORD *> New Issue record
003899
003900******************************************************************
003901*       A D D  O R I G I N A L  C E R T  I N F O                 *
003902******************************************************************
003903
003904*    display ' made it to add orig cert '
003905
003906     MOVE ELCERT-KEY             TO ERMAIL-KEY
003907     MOVE ' '                    TO WS-ERMAIL-SW
003908
003909     
      * EXEC CICS READ
003910*       DATASET   (FILE-ID-ERMAIL)
003911*       SET       (ADDRESS OF MAILING-DATA)
003912*       RIDFLD    (ERMAIL-KEY)
003913*       RESP      (WS-RESPONSE)
003914*    END-EXEC
      *    MOVE '&"S        E          (  N#00011130' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303131313330' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERMAIL, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERMAIL-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF MAILING-DATA TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
003915
003916     IF RESP-NORMAL
003917        SET ERMAIL-FOUND TO TRUE
003918     END-IF
003919
003920     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
003921
003922     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
003923     MOVE 'OC'                   TO OC-RECORD-ID
003924     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
003925                                 TO OC-CONTROL-PRIMARY (1:33)
003926     MOVE 'I'                    TO OC-RECORD-TYPE
003927     MOVE +4096                  TO OC-KEY-SEQ-NO
003928     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
003929     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
003930     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
003931
003932     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
003933     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
003934     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
003935     MOVE PB-I-AGE               TO OC-INS-AGE
003936     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
003937     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
003938     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
003939     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
003940     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
003941     MOVE PB-I-LF-TERM           TO OC-LF-TERM
003942     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
003943     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
003944     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
003945     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
003946     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
003947     IF PB-I-JOINT-COMMISSION > +0
003948         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
003949     ELSE
003950         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
003951     END-IF
003952     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
003953     MOVE +0                     TO OC-LF-CANCEL-AMT
003954                                    OC-LF-ITD-CANCEL-AMT
003955     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
003956     MOVE PB-I-AH-TERM           TO OC-AH-TERM
003957     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
003958     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
003959     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
003960     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
003961     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
003962     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
003963     MOVE +0                     TO OC-AH-CANCEL-AMT
003964                                    OC-AH-ITD-CANCEL-AMT
003965     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
003966     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
003967     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
003968
003969     IF ERMAIL-FOUND
003970        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
003971     END-IF
003972     IF NOT CERT-TRL-REC-NOT-FOUND
003973        MOVE CS-INS-AGE-DEFAULT-FLAG TO
003974                           OC-INS-AGE-DEFAULT-FLAG
003975        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
003976                           OC-JNT-AGE-DEFAULT-FLAG
003977     END-IF
003978     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
003979     .
003980 1275-WRITE-ELCRTO.
003981
003982     
      * EXEC CICS WRITE
003983*       DATASET   ('ELCRTO')
003984*       FROM      (ORIGINAL-CERTIFICATE)
003985*       RIDFLD    (OC-CONTROL-PRIMARY)
003986*       RESP      (WS-RESPONSE)
003987*    END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&$ L                  ''  N#00011203' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'204E233030303131323033' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 OC-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
003988
003989*    display ' just wrote 1275 ' ws-response
003990     IF RESP-DUPKEY
003991        SUBTRACT +1              FROM OC-KEY-SEQ-NO
003992        GO TO 1275-WRITE-ELCRTO
003993     ELSE
003994        IF NOT RESP-NORMAL
003995           MOVE -1               TO BMAINTL
003996           MOVE ER-7450          TO EMI-ERROR
003997           PERFORM 9900-ERROR-FORMAT
003998                                 THRU 9900-EXIT
003999           GO TO 8200-SEND-DATAONLY
004000        END-IF
004001     END-IF
004002
004003******************************************************************
004004*       U P D A T E   T H E   B A T C H   H E A D E R            *
004005******************************************************************
004006
004007     
      * EXEC CICS READ
004008*        INTO    (PENDING-BUSINESS)
004009*        DATASET (FILE-ID-ERPNDB)
004010*        RIDFLD  (ERPNDB-KEY)
004011*        UPDATE
004012*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00011228' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303131323238' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
004013
004014     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
004015     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
004016     MOVE 'B'                    TO JP-RECORD-TYPE.
004017     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
004018
004019     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
004020
004021     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
004022
004023     
      * EXEC CICS REWRITE
004024*        DATASET (FILE-ID-ERPNDB)
004025*        FROM    (PENDING-BUSINESS)
004026*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00011244' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303131323434' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
004027
004028     MOVE 'C'                    TO JP-RECORD-TYPE.
004029     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
004030
004031     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
004032
004033     IF WS-ERRORS-PRESENT
004034         GO TO 3900-RE-DISPLAY-RECORD.
004035
004036     MOVE ZEROS                  TO EMI-ERROR.
004037     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004038     MOVE LOW-VALUES             TO EL631BI.
004039     MOVE  -1                    TO BMAINTL.
004040     GO TO 8100-SEND-INITIAL-MAP.
004041
004042 1280-BATCH-HDR-NOT-FOUND.
004043     MOVE -1                     TO BMAINTL.
004044     MOVE ER-7450                TO EMI-ERROR.
004045     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004046     GO TO 8200-SEND-DATAONLY.
004047
004048 1290-DUPLICATE-ALT-INDEX.
004049
004050******************************************************************
004051*                                                                *
004052*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
004053*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
004054*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
004055*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
004056*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
004057*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
004058*                                                                *
004059******************************************************************
004060
004061     IF LCP-ONCTR-01 =  0
004062         ADD 1 TO LCP-ONCTR-01
004063        MOVE +0                  TO WS-SEQ-NO-COUNTER.
004064
004065     ADD +1                      TO WS-SEQ-NO-COUNTER.
004066
004067     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
004068         NEXT SENTENCE
004069     ELSE
004070         ADD +1 TO PB-BATCH-SEQ-NO
004071                   PB-CSR-BATCH-SEQ-NO
004072         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
004073         GO TO 1275-WRITE-PENDING-BUSINESS.
004074
004075     MOVE -1                     TO BCERTNOL.
004076     MOVE AL-UABON               TO BCERTNOA.
004077     MOVE AL-UNBON               TO BEFFDTA.
004078
004079     MOVE 1                      TO EMI-SUB
004080                                    EMI-SWITCH1
004081                                    EMI-SWITCH-AREA-1
004082                                    EMI-SWITCH-AREA-2.
004083
004084     MOVE SPACES                 TO EMI-ERROR-LINES.
004085
004086     
      * EXEC CICS SYNCPOINT ROLLBACK
004087*    END-EXEC.
      *    MOVE '6"R                   !   #00011307' TO DFHEIV0
           MOVE X'362252202020202020202020' &
                X'202020202020202020202120' &
                X'2020233030303131333037' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
004088
004089     MOVE ER-2247                TO EMI-ERROR.
004090     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004091     GO TO 8200-SEND-DATAONLY.
004092
004093     EJECT
004094
004095
004096 1295-READ-CERT-TRAILER.
004097
004098     
      * EXEC CICS GETMAIN
004099*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
004100*        LENGTH  (ELCRTT-RECORD-LENGTH)
004101*        INITIMG (GETMAIN-SPACE)
004102*    END-EXEC
      *    MOVE ',"IL                  $   #00011319' TO DFHEIV0
           MOVE X'2C22494C2020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303131333139' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 ELCRTT-RECORD-LENGTH, 
                 GETMAIN-SPACE
           SET ADDRESS OF CERTIFICATE-TRAILERS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
004103
004104     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
004105     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
004106     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
004107
004108     
      * EXEC CICS HANDLE CONDITION
004109*        NOTFND (1295-CERT-TRL-REC-NOTFND)
004110*    END-EXEC.
      *    MOVE '"$I                   ! % #00011329' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'2520233030303131333239' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
004111
004112     
      * EXEC CICS READ
004113*        DATASET  (CRTT-ID)
004114*        RIDFLD   (ELCRTT-KEY)
004115*        INTO     (CERTIFICATE-TRAILERS)
004116*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&"IL       E          (   #00011333' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303131333333' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
004117
004118     GO TO 1295-EXIT.
004119
004120 1295-CERT-TRL-REC-NOTFND.
004121     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
004122
004123 1295-EXIT.
004124     EXIT.
004125
004126******************************************************************
004127*                                                                *
004128*          C H A N G E   I S S U E   R O U T I N E               *
004129*                                                                *
004130******************************************************************
004131
004132***************************************************************
004133*                                                             *
004134*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
004135*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
004136*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
004137*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
004138*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
004139*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
004140*     5. LINK TO THE EDIT ROUTINE.                            *
004141*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
004142*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
004143*              THE EDIT ROUTINE.                              *
004144*     7. REWRITE THE NEW ISSUE                                *
004145*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
004146*                                                             *
004147***************************************************************
004148
004149 1300-CHANGE-ISSUE-ROUTINE.
004150     MOVE 'C'                    TO PI-MAINT-FUNCTION.
004151
004152     IF BCHGL NOT = ZEROS
004153        MOVE ER-2196             TO EMI-ERROR
004154        MOVE AL-UABON            TO BMAINTA
004155        MOVE -1                  TO BMAINTL
004156        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004157        GO TO 8200-SEND-DATAONLY.
004158
004159     MOVE BCERTNOI               TO WS-NEW-PRIME.
004160
004161     IF BSUFIXL NOT = ZEROS
004162        MOVE BSUFIXI             TO WS-NEW-SUFFIX
004163     ELSE
004164        MOVE SPACE               TO WS-NEW-SUFFIX.
004165
004166     MOVE BEFFDTI                TO DEEDIT-FIELD.
004167     PERFORM 8600-DEEDIT.
004168     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
004169     MOVE '4'                    TO DC-OPTION-CODE.
004170     PERFORM 9700-DATE-LINK.
004171     IF DATE-CONVERSION-ERROR
004172        MOVE ER-0348             TO EMI-ERROR
004173        MOVE -1                  TO BEFFDTL
004174        MOVE AL-UABON            TO BEFFDTA
004175        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004176        GO TO 8200-SEND-DATAONLY
004177     ELSE
004178        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
004179        MOVE AL-UANON            TO BEFFDTA
004180        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
004181
004182 1325-PROCESS-ISSUE-CHANGES.
004183     
      * EXEC CICS HANDLE CONDITION
004184*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
004185*    END-EXEC.
      *    MOVE '"$I                   ! & #00011404' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'2620233030303131343034' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
004186
004187     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
004188     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
004189     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
004190
004191     
      * EXEC CICS GETMAIN
004192*        SET      (ADDRESS OF PENDING-BUSINESS)
004193*        LENGTH   (ERPNDB-RECORD-LENGTH)
004194*        INITIMG  (GETMAIN-SPACE)
004195*     END-EXEC.
      *    MOVE ',"IL                  $   #00011412' TO DFHEIV0
           MOVE X'2C22494C2020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303131343132' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 ERPNDB-RECORD-LENGTH, 
                 GETMAIN-SPACE
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
004196
004197     
      * EXEC CICS READ
004198*        INTO    (PENDING-BUSINESS)
004199*        DATASET (FILE-ID-ERPNDB)
004200*        RIDFLD  (ERPNDB-KEY)
004201*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&"IL       E          (   #00011418' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303131343138' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
004202
004203     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
004204
004205     
      * EXEC CICS HANDLE CONDITION
004206*         NOTFND     (1385-REC-NOT-FOUND)
004207*    END-EXEC.
      *    MOVE '"$I                   ! '' #00011426' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'2720233030303131343236' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
004208
004209**********************************************************
004210*      DONT READ THE RECORD FOR UPDATE UNTIL             *
004211*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
004212**********************************************************
004213
004214     
      * EXEC CICS READ
004215*        DATASET (FILE-ID-ERPNDB)
004216*        INTO    (PENDING-BUSINESS)
004217*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
004218*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&"IL       E          (   #00011435' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303131343335' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 PI-PREV-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
004219
004220********** DO NOT ALLOW CHANGES IF THRU A/R
004221     IF BMAINTI = 'C'
004222         IF PB-EL860-INTERNAL-PROCESS
004223             MOVE ER-4005          TO EMI-ERROR
004224             MOVE -1               TO BMAINTL
004225             MOVE AL-UABON         TO BMAINTA
004226             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004227             GO TO 8200-SEND-DATAONLY.
004228**********
004229     MOVE PB-ISSUE-RECORD TO WS-SAVE-PEND-ISSUE
004230
004231     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
004232        MOVE -1                 TO BMAINTL
004233        MOVE ER-2197            TO EMI-ERROR
004234        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004235        GO TO 8200-SEND-DATAONLY.
004236
004237     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
004238        MOVE ER-2196             TO EMI-ERROR
004239        MOVE AL-UABON            TO BMAINTA
004240        MOVE -1                  TO BMAINTL
004241        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004242        GO TO 8200-SEND-DATAONLY.
004243
004244     MOVE ZEROS                  TO WS-SEQ-SAVE.
004245
004246     IF PB-BILLED-DT = LOW-VALUES AND
004247        PB-CHG-COUNT = ZEROS
004248        NEXT SENTENCE
004249     ELSE
004250        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
004251            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
004252           OR
004253           (BPREM-LEN (2) GREATER THAN ZEROS AND
004254            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
004255           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
004256
004257     move zeros                  to ws-check-amts
004258     move ' '                    to ws-stop-sw
004259                                    ws-check-sw
004260                                    ws-proc-check-sw
004261                                    ws-any-check-sw
004262                                    ws-chek-browse-sw
004263
004264     perform 2500-browse-checks  thru 2500-exit
004265
004266     if i-have-processed-checks
004267        or i-have-checks
004268        continue
004269     else
004270        go to 1330-continue
004271     end-if
004272
004273     compute ws-tot-orig-prem =
004274        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
004275        pb-i-lf-alt-premium-amt
004276
004277     if bprem1l <> zeros
004278        MOVE AL-UNNON            TO bprem1a
004279        move ws-bprem (1)        to ws-new-iss-total
004280     else
004281        move pb-i-lf-premium-amt to ws-new-iss-total
004282     end-if
004283
004284     if baltpr1l <> zeros
004285        MOVE AL-UNNON            TO baltpr1a
004286        compute ws-new-iss-total =
004287           ws-new-iss-total + ws-balt-prem(1)
004288     else
004289        compute ws-new-iss-total =
004290           ws-new-iss-total + pb-i-lf-alt-premium-amt
004291     end-if
004292
004293     if bprem2l <> zeros
004294        MOVE AL-UNNON            TO bprem2a
004295        compute ws-new-iss-total = ws-new-iss-total +
004296           ws-bprem (2)
004297     else
004298        compute ws-new-iss-total = ws-new-iss-total +
004299           pb-i-ah-premium-amt
004300     end-if
004301
004302     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
004303        if ((bprem1l <> zeros)
004304           and (ws-bprem (1) <> pb-i-lf-premium-amt))
004305                      or
004306           ((bprem2l <> zeros)
004307           and (ws-bprem (2) <> pb-i-ah-premium-amt))
004308           move er-3456          to emi-error
004309           perform 9900-error-format
004310                                 thru 9900-exit
004311           go to 1330-continue
004312        end-if
004313     end-if
004314
004315     if ws-new-iss-total > ws-tot-orig-prem
004316        move er-3458             to emi-error
004317        perform 9900-error-format thru 9900-exit
004318        move al-uabon            to bmainta
004319        move -1                  to bmaintl
004320        go to 8200-send-dataonly
004321     end-if
004322
004323     if ws-new-iss-total < ws-tot-orig-prem
004324        move er-3457             to emi-error
004325        move al-uabon            to bprem1a
004326                                    bprem2a
004327        move +0 to bprem1l bprem2l
004328        perform 9900-error-format thru 9900-exit
004329        move -1                  to bmaintl
004330        go to 1330-continue
004331     end-if
004332
004333     .
004334 1330-continue.
004335
004336     
      * EXEC CICS READ
004337*        DATASET (FILE-ID-ERPNDB)
004338*        INTO    (PENDING-BUSINESS)
004339*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
004340*        UPDATE
004341*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00011557' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303131353537' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 PI-PREV-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
004342
004343     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
004344     MOVE 'B'                    TO JP-RECORD-TYPE
004345     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
004346     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
004347
004348*    PERFORM 8400-LOG-JOURNAL-RECORD. *> move closer to rewite
004349
004350     IF PB-BILLED-DT NOT = LOW-VALUES OR
004351        PB-CHG-COUNT NOT = ZEROS
004352        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
004353            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
004354           OR
004355           (BPREM-LEN (2) GREATER THAN ZEROS AND
004356            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
004357            MOVE LOW-VALUES             TO PB-BILLED-DT
004358            ADD +1                      TO PB-CHG-COUNT.
004359
004360     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
004361     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
004362     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
004363     MOVE '5'                    TO DC-OPTION-CODE.
004364     PERFORM 9700-DATE-LINK
004365     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
004366
004367*    IF BMICRNOL  GREATER  ZEROS
004368*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
004369
004370
004371     IF BVINL > ZEROS
004372        MOVE BVINI               TO PB-I-VIN
004373     END-IF
004374
004375     IF (BFORCEL NOT = ZEROS)
004376        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
004377        AND (BFORCEI = ' ')
004378        AND (PB-FORCE-CODE = 'O')
004379        COMPUTE PB-I-AH-PREMIUM-AMT =
004380           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
004381        PERFORM 1800-REMOVE-CERT-NOTES
004382                                 THRU 1800-EXIT
004383        PERFORM 1900-DELETE-ERPYAJ
004384                                 THRU 1900-EXIT
004385        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
004386     END-IF
004387
004388     IF (BFORCEL NOT = ZEROS)
004389        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
004390        AND (BFORCEI = 'O')
004391        AND (PB-FORCE-CODE NOT = 'O')
004392        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
004393           PB-I-AH-PREM-CALC
004394        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
004395        MOVE SPACE               TO DC-OPTION-CODE
004396        PERFORM 9700-DATE-LINK
004397        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
004398        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
004399        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
004400        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
004401        PERFORM 1500-UPDATE-ERNOTE
004402                                 THRU 1500-EXIT
004403        PERFORM 1600-UPDATE-ERPYAJ
004404                                 THRU 1600-EXIT
004405     END-IF
004406
004407     IF BLSTNML  GREATER THAN ZEROS
004408         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
004409
004410     IF B1STNML  GREATER THAN ZEROS
004411         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
004412
004413     IF BINITL   GREATER THAN ZEROS
004414         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
004415
004416     IF BBIRTHL  GREATER THAN ZERO
004417         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
004418
004419     IF B1STPMTL GREATER THAN ZERO
004420         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
004421
004422     IF BAGEL    GREATER THAN ZEROS
004423         MOVE BAGEI              TO PB-I-AGE.
004424
004425     MOVE 'N'                    TO WS-INS-AGE-SET
004426                                    WS-JNT-AGE-SET.
004427     IF BAGEL    GREATER THAN ZEROS
004428        MOVE 'Y'                TO WS-INS-AGE-SET
004429        IF BAGEI = ZERO AND
004430             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
004431           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
004432           MOVE 'AGE*'          TO BAGEDEFO
004433        ELSE
004434           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
004435           MOVE 'AGE '          TO BAGEDEFO
004436        END-IF
004437        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
004438     END-IF.
004439
004440     IF BSEXL    GREATER THAN ZEROS
004441         MOVE BSEXI              TO PB-I-INSURED-SEX.
004442
004443     IF LETRREQL   GREATER THAN ZEROS
004444        MOVE LETRREQI TO PB-I-LETTER-REQD
004445     END-IF.
004446
004447     IF BTERM-LEN (1)   GREATER THAN ZEROS
004448        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
004449
004450     IF BTERM-LEN (2)   GREATER THAN ZEROS
004451        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
004452
004453     IF BLNTRML  GREATER THAN ZEROS
004454         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
004455
004456     IF BFREQL   GREATER THAN ZEROS
004457         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
004458
004459     IF BSKPCDL  GREATER THAN ZEROS
004460         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
004461
004462     IF BMODEL   GREATER THAN ZEROS
004463         MOVE BMODEI             TO PB-I-TERM-TYPE
004464                                    PI-BMODE.
004465
004466     IF BPMTSL   GREATER THAN ZEROS
004467         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
004468                                    PI-BPMTS.
004469
004470     IF BPMTAMTL GREATER THAN ZEROS
004471         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
004472
004473     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
004474         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
004475
004476     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
004477         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
004478
004479     MOVE SPACE TO PB-I-LF-CALC-FLAG.
004480
004481     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
004482         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
004483            SUBTRACT PB-I-LF-PREMIUM-AMT
004484                     FROM WS-B-LF-ISS-PRM-ENTERED
004485            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
004486            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
004487            MOVE SPACE           TO PB-I-LF-CALC-FLAG
004488         ELSE
004489            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
004490*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
004491*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
004492         END-IF
004493     END-IF.
004494
004495     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
004496            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
004497                     FROM WS-B-LF-ISS-PRM-ENTERED
004498         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
004499         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
004500
004501     IF  BALT-PREM-LEN     (2)  > ZEROS
004502         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
004503
004504     IF  BBEN-LEN (2)  GREATER THAN ZEROS
004505         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
004506
004507     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
004508         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
004509            SUBTRACT PB-I-AH-PREMIUM-AMT
004510                     FROM WS-B-AH-ISS-PRM-ENTERED
004511            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
004512            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
004513            MOVE SPACE           TO PB-I-AH-CALC-FLAG
004514         ELSE
004515            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
004516*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
004517*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
004518         END-IF
004519     END-IF
004520
004521     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
004522        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
004523
004524     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
004525        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
004526
004527     IF BINDGRPL            GREATER THAN ZEROS
004528         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
004529
004530     IF BRTCLSL             GREATER THAN ZEROS
004531         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
004532
004533     IF BSIGL               GREATER THAN ZEROS
004534         MOVE BSIGI              TO PB-I-SIG-SW.
004535
004536     IF BAPRL               GREATER THAN ZEROS
004537         MOVE WS-BAPR            TO PB-I-LOAN-APR.
004538
004539     IF BMEMBERL            GREATER THAN ZEROS
004540         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
004541
004542     IF BLNOFCRL            GREATER THAN ZEROS
004543         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
004544
004545     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
004546        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
004547
004548     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
004549        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
004550
004551     IF BDAYSL              GREATER THAN ZEROS
004552        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
004553                                    PB-I-EXTENTION-DAYS.
004554
004555     IF BDAYSL GREATER THAN ZEROS
004556        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
004557
004558     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
004559        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
004560           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
004561
004562     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
004563        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
004564           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
004565
004566     IF B1STPMTL GREATER THAN ZEROS
004567        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
004568
004569     IF PB-EXT-DAYS-PROCESSING
004570        IF PB-I-EXTENTION-DAYS = ZEROS
004571           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
004572
004573     IF PB-EXPIRE-DT-PROCESSING
004574        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
004575           PB-I-AH-EXPIRE-DT = LOW-VALUES
004576             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
004577
004578     IF PB-1ST-PMT-DT-PROCESSING
004579        IF PB-I-1ST-PMT-DT = LOW-VALUES
004580           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
004581
004582     IF BREINL GREATER THAN ZEROS
004583        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
004584
004585     IF BFORCEL NOT = ZEROS
004586        MOVE BFORCEI             TO PB-FORCE-CODE.
004587
004588     IF (BENTRYL NOT = ZEROS)
004589        AND (PB-COMPANY-ID = 'CID')
004590        AND (PB-STATE = 'VA')
004591        AND (BENTRYI NOT = 'P')
004592        AND (PB-BATCH-ENTRY = 'P')
004593        PERFORM 1800-REMOVE-CERT-NOTES
004594                                 THRU 1800-EXIT
004595     END-IF
004596
004597     IF BENTRYL NOT = ZEROS
004598        MOVE BENTRYI             TO PB-BATCH-ENTRY
004599        IF PI-COMPANY-ID = 'CID'
004600           AND (PB-BATCH-ENTRY = 'P')
004601           AND (PB-STATE = 'VA')
004602           PERFORM 1500-UPDATE-ERNOTE
004603                                 THRU 1500-EXIT
004604        END-IF
004605     END-IF
004606
004607     IF BUNWRITL NOT = ZEROS
004608        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
004609
004610     IF BBILCDL NOT = ZEROS
004611        MOVE BBILCDI             TO PB-RECORD-BILL.
004612
004613     IF BLIVESL GREATER THAN ZEROS
004614        MOVE WS-BLIVES           TO PB-I-LIVES.
004615
004616
004617*DMD CUSTOM CODING*************START
004618     IF PI-COMPANY-ID NOT = 'DMD'
004619         MOVE ZEROS               TO BBILLEDL.
004620*DMD CUSTOM CODING*************END
004621
004622     IF BBILLEDL GREATER THAN ZEROS
004623        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
004624
004625
004626*****************************************************************
004627*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
004628*****************************************************************
004629
004630     IF BTYPE-LEN (1)   GREATER THAN ZEROS
004631        IF BTYPE  (1)   = ZEROS OR SPACES
004632           IF REMOVE-LF-COVERAGE
004633               MOVE SPACES           TO PB-I-LF-INPUT-CD
004634                                        PI-BTYPE (1)
004635               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
004636                                        WS-B-LF-ISS-PRM-ENTERED
004637               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
004638                                        WS-B-LF-ISS-PRM-ENTERED
004639               SUBTRACT PB-I-LF-PREM-CALC FROM
004640                                        WS-B-LF-ISS-PRM-COMPUTED
004641               MOVE ZEROS            TO PB-I-LF-TERM
004642                                        PB-I-LF-BENEFIT-AMT
004643                                        PB-I-LF-PREMIUM-AMT
004644                                        PB-I-LF-BENEFIT-CD
004645                                        PB-I-LF-PREM-CALC
004646                                        PB-I-LF-CRIT-PER
004647                                        PB-I-LF-ALT-BENEFIT-AMT
004648                                        PB-I-LF-ALT-PREMIUM-AMT
004649               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
004650           ELSE
004651               NEXT SENTENCE
004652        ELSE
004653           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
004654                                    PI-BTYPE (1).
004655     IF BTYPE-LEN (2)   GREATER THAN ZEROS
004656        IF BTYPE  (2)   = ZEROS OR SPACES
004657           IF  REMOVE-AH-COVERAGE
004658               MOVE SPACES           TO PB-I-AH-INPUT-CD
004659                                        PI-BTYPE (2)
004660               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
004661                                        WS-B-AH-ISS-PRM-ENTERED
004662               SUBTRACT PB-I-AH-PREM-CALC FROM
004663                                        WS-B-AH-ISS-PRM-COMPUTED
004664               MOVE ZEROS            TO PB-I-AH-TERM
004665                                        PB-I-AH-BENEFIT-AMT
004666                                        PB-I-AH-PREMIUM-AMT
004667                                        PB-I-AH-BENEFIT-CD
004668                                        PB-I-AH-PREM-CALC
004669                                        PB-I-AH-CRIT-PER
004670               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
004671           ELSE
004672               NEXT SENTENCE
004673        ELSE
004674           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
004675                                    PI-BTYPE (2).
004676 1360-REWRITE-PB-RECORD.
004677     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
004678
004679     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
004680     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
004681
004682     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
004683
004684     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
004685     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
004686
004687     IF BCPREM-LEN (1)  GREATER THAN ZEROS
004688         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
004689
004690     IF BCPREM-LEN (2)  GREATER THAN ZEROS
004691         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
004692
004693     IF CSR-EDIT-SESSION
004694        PERFORM 139A-SET-LETTER-REQD THRU 139A-EXIT
004695     END-IF.
004696
004697     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
004698
004699     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
004700
004701     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
004702
004703     IF ARCHIVE-LETTER-RELEASED
004704        MOVE 'C' TO PB-I-LETTER-REQD
004705        PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT
004706        PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT
004707     END-IF
004708
004709     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
004710     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
004711     MOVE PB-SV-STATE            TO PI-SV-STATE.
004712
004713     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
004714     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
004715
004716 1375-REWRITE-PB-RECORD.
004717
004718     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before Issue image
004719
004720     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
004721     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
004722     MOVE 'C'                    TO JP-RECORD-TYPE.
004723     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
004724
004725     if bmainti = 'K'
004726        move 'CERT'              to pa-rec-type
004727        move pi-company-id       to pa-company-id
004728        move pending-business    to pa-rest-of-record
004729        
      * EXEC CICS LINK
004730*           PROGRAM  ('WF001')
004731*           COMMAREA (work-flow-pass-area)
004732*           LENGTH   (604)
004733*       END-EXEC
           MOVE 'WF001' TO DFHEIV1
           MOVE 604
             TO DFHEIV11
      *    MOVE '."C                   (   #00011950' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303131393530' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 work-flow-pass-area, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
004734     end-if
004735
004736     
      * EXEC CICS REWRITE
004737*        DATASET (FILE-ID-ERPNDB)
004738*        FROM    (PENDING-BUSINESS)
004739*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00011957' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303131393537' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
004740
004741     PERFORM 8400-LOG-JOURNAL-RECORD  *> After Issue Image
004742
004743******************************************************************
004744*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
004745******************************************************************
004746
004747     MOVE ELCERT-KEY             TO ERMAIL-KEY
004748     MOVE ' '                    TO WS-ERMAIL-SW
004749
004750     
      * EXEC CICS READ
004751*       DATASET   (FILE-ID-ERMAIL)
004752*       SET       (ADDRESS OF MAILING-DATA)
004753*       RIDFLD    (ERMAIL-KEY)
004754*       RESP      (WS-RESPONSE)
004755*    END-EXEC
      *    MOVE '&"S        E          (  N#00011971' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303131393731' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERMAIL, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERMAIL-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF MAILING-DATA TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
004756
004757     IF RESP-NORMAL
004758        SET ERMAIL-FOUND TO TRUE
004759     END-IF
004760
004761     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
004762
004763     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
004764                                 TO ELCRTO-KEY
004765     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
004766     MOVE +0                     TO ELCRTO-SEQ-NO
004767
004768     
      * EXEC CICS READ
004769*       DATASET   ('ELCRTO')
004770*       INTO      (ORIGINAL-CERTIFICATE)
004771*       RIDFLD    (ELCRTO-KEY)
004772*       GTEQ
004773*       RESP      (WS-RESPONSE)
004774*    END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&"IL       G          (  N#00011989' TO DFHEIV0
           MOVE X'2622494C2020202020202047' &
                X'202020202020202020202820' &
                X'204E233030303131393839' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 ELCRTO-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
004775
004776*    display ' just read gteq ' ws-response
004777     IF RESP-NORMAL
004778        AND (OC-CONTROL-PRIMARY (1:33) =
004779                 PB-CONTROL-BY-ACCOUNT (1:33))
004780        AND (OC-RECORD-TYPE = 'I')
004781*       display ' resp norm, key =, type i '
004782        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
004783*          display ' end proc blank '
004784*          display ' csr edit session ' PI-CSR-SESSION-SW
004785           IF NOT CSR-EDIT-SESSION
004786              
      * EXEC CICS READ
004787*                DATASET   ('ELCRTO')
004788*                INTO      (ORIGINAL-CERTIFICATE)
004789*                RIDFLD    (OC-CONTROL-PRIMARY)
004790*                UPDATE
004791*                RESP      (WS-RESPONSE)
004792*             END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&"IL       EU         (  N#00012007' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'204E233030303132303037' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 OC-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
004793              IF RESP-NORMAL
004794                 MOVE PB-I-INSURED-LAST-NAME TO
004795                         OC-INS-LAST-NAME
004796                 MOVE PB-I-INSURED-FIRST-NAME TO
004797                         OC-INS-FIRST-NAME
004798                 MOVE PB-I-INSURED-MIDDLE-INIT TO
004799                         OC-INS-MIDDLE-INIT
004800                 MOVE PB-I-AGE         TO OC-INS-AGE
004801                 MOVE PB-I-JOINT-LAST-NAME   TO
004802                         OC-JNT-LAST-NAME
004803                 MOVE PB-I-JOINT-FIRST-NAME  TO
004804                         OC-JNT-FIRST-NAME
004805                 MOVE PB-I-JOINT-MIDDLE-INIT TO
004806                         OC-JNT-MIDDLE-INIT
004807                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
004808                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
004809                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
004810                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
004811                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
004812                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
004813                         OC-LF-ALT-BEN-AMT
004814                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
004815                         OC-LF-ALT-PRM-AMT
004816                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
004817                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
004818                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
004819                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
004820                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
004821                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
004822                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
004823                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
004824                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
004825                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
004826                 IF OC-CANCEL-TRAN-IND = 'N'
004827                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
004828                    MOVE +0            TO OC-LF-CANCEL-AMT
004829                                          OC-LF-ITD-CANCEL-AMT
004830                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
004831                    MOVE +0            TO OC-AH-CANCEL-AMT
004832                                          OC-AH-ITD-CANCEL-AMT
004833                 END-IF
004834                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
004835
004836                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
004837                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
004838                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
004839                 IF ERMAIL-FOUND
004840                    MOVE MA-CRED-BENE-NAME
004841                                 TO OC-CRED-BENE-NAME
004842                 END-IF
004843                 IF NOT CERT-TRL-REC-NOT-FOUND
004844                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
004845                           OC-INS-AGE-DEFAULT-FLAG
004846                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
004847                           OC-JNT-AGE-DEFAULT-FLAG
004848                 END-IF
004849                 
      * EXEC CICS REWRITE
004850*                   DATASET   ('ELCRTO')
004851*                   FROM      (ORIGINAL-CERTIFICATE)
004852*                   RESP      (WS-RESPONSE)
004853*                END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&& L                  %  N#00012070' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'204E233030303132303730' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
004854              END-IF
004855           END-IF
004856        ELSE
004857           SUBTRACT +1 FROM OC-KEY-SEQ-NO
004858           MOVE 'OC'             TO OC-RECORD-ID
004859           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
004860           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
004861           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
004862           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
004863           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
004864           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
004865           MOVE PB-I-AGE         TO OC-INS-AGE
004866           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
004867           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
004868           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
004869           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
004870           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
004871           MOVE PB-I-LF-TERM     TO OC-LF-TERM
004872           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
004873           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
004874           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
004875           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
004876           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
004877           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
004878           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
004879           MOVE +0               TO OC-LF-CANCEL-AMT
004880                                    OC-LF-ITD-CANCEL-AMT
004881           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
004882           MOVE PB-I-AH-TERM     TO OC-AH-TERM
004883           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
004884           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
004885           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
004886           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
004887           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
004888           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
004889           MOVE +0               TO OC-AH-CANCEL-AMT
004890                                    OC-AH-ITD-CANCEL-AMT
004891           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
004892           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
004893           MOVE 'N'              TO OC-CANCEL-TRAN-IND
004894           IF ERMAIL-FOUND
004895              MOVE MA-CRED-BENE-NAME
004896                                 TO OC-CRED-BENE-NAME
004897           END-IF
004898           IF NOT CERT-TRL-REC-NOT-FOUND
004899              MOVE CS-INS-AGE-DEFAULT-FLAG TO
004900                           OC-INS-AGE-DEFAULT-FLAG
004901              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
004902                           OC-JNT-AGE-DEFAULT-FLAG
004903           END-IF
004904           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
004905           
      * EXEC CICS WRITE
004906*             DATASET   ('ELCRTO')
004907*             FROM      (ORIGINAL-CERTIFICATE)
004908*             RIDFLD    (OC-CONTROL-PRIMARY)
004909*             RESP      (WS-RESPONSE)
004910*          END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&$ L                  ''  N#00012126' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'204E233030303132313236' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 OC-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
004911        END-IF
004912     ELSE
004913        MOVE SPACES              TO ORIGINAL-CERTIFICATE
004914        MOVE 'OC'                TO OC-RECORD-ID
004915        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
004916                                 TO OC-CONTROL-PRIMARY (1:33)
004917        MOVE 'I'                 TO OC-RECORD-TYPE
004918        MOVE +4096               TO OC-KEY-SEQ-NO
004919        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
004920        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
004921        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
004922        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
004923        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
004924        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
004925        MOVE PB-I-AGE            TO OC-INS-AGE
004926        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
004927        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
004928        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
004929        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
004930        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
004931        MOVE PB-I-LF-TERM        TO OC-LF-TERM
004932        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
004933        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
004934        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
004935        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
004936        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
004937        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
004938        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
004939        MOVE +0                  TO OC-LF-CANCEL-AMT
004940                                    OC-LF-ITD-CANCEL-AMT
004941        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
004942        MOVE PB-I-AH-TERM        TO OC-AH-TERM
004943        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
004944        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
004945        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
004946        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
004947        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
004948        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
004949        MOVE +0                  TO OC-AH-CANCEL-AMT
004950                                    OC-AH-ITD-CANCEL-AMT
004951        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
004952        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
004953        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
004954        IF ERMAIL-FOUND
004955           MOVE MA-CRED-BENE-NAME
004956                                 TO OC-CRED-BENE-NAME
004957        END-IF
004958        IF NOT CERT-TRL-REC-NOT-FOUND
004959           MOVE CS-INS-AGE-DEFAULT-FLAG TO
004960                           OC-INS-AGE-DEFAULT-FLAG
004961           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
004962                           OC-JNT-AGE-DEFAULT-FLAG
004963        END-IF
004964        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
004965
004966        
      * EXEC CICS WRITE
004967*          DATASET   ('ELCRTO')
004968*          FROM      (ORIGINAL-CERTIFICATE)
004969*          RIDFLD    (OC-CONTROL-PRIMARY)
004970*          RESP      (WS-RESPONSE)
004971*       END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&$ L                  ''  N#00012187' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'204E233030303132313837' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 OC-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
004972     END-IF
004973
004974******************************************************************
004975*       U P D A T E   T H E   B A T C H   H E A D E R            *
004976******************************************************************
004977
004978     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
004979     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
004980
004981     
      * EXEC CICS READ
004982*        INTO    (PENDING-BUSINESS)
004983*        DATASET (FILE-ID-ERPNDB)
004984*        RIDFLD  (ERPNDB-KEY)
004985*        UPDATE
004986*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00012202' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303132323032' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
004987
004988     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
004989     MOVE 'B'                    TO JP-RECORD-TYPE.
004990     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
004991
004992     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
004993
004994     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
004995
004996     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
004997
004998     MOVE 'C'                    TO JP-RECORD-TYPE.
004999     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
005000
005001     
      * EXEC CICS REWRITE
005002*        DATASET    (FILE-ID-ERPNDB)
005003*        FROM       (PENDING-BUSINESS)
005004*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00012222' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303132323232' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005005
005006     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
005007
005008     IF WS-ERRORS-PRESENT
005009        GO TO 3900-RE-DISPLAY-RECORD.
005010
005011     MOVE ZEROS                  TO EMI-ERROR.
005012     MOVE -1                     TO BMAINTL.
005013     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005014     GO TO 3900-RE-DISPLAY-RECORD.
005015
005016 1380-BATCH-HDR-NOT-FOUND.
005017     MOVE -1                     TO BMAINTL.
005018     MOVE ER-7450                TO EMI-ERROR.
005019     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005020     GO TO 8200-SEND-DATAONLY.
005021
005022 1385-REC-NOT-FOUND.
005023     MOVE -1                     TO BMAINTL.
005024     MOVE ER-7451                TO EMI-ERROR.
005025     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005026     GO TO 8200-SEND-DATAONLY.
005027
005028     EJECT
005029
005030 1386-UPDATE-AGE-FLAGS.
005031
005032     
      * EXEC CICS GETMAIN
005033*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
005034*        LENGTH  (ELCRTT-RECORD-LENGTH)
005035*        INITIMG (GETMAIN-SPACE)
005036*    END-EXEC
      *    MOVE ',"IL                  $   #00012253' TO DFHEIV0
           MOVE X'2C22494C2020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303132323533' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 ELCRTT-RECORD-LENGTH, 
                 GETMAIN-SPACE
           SET ADDRESS OF CERTIFICATE-TRAILERS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005037
005038     
      * EXEC CICS HANDLE CONDITION
005039*        NOTFND   (1386-NOTFND)
005040*    END-EXEC.
      *    MOVE '"$I                   ! ( #00012259' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'2820233030303132323539' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005041
005042     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
005043     MOVE 'C'                TO ELCRTT-REC-TYPE
005044
005045     
      * EXEC CICS READ
005046*        UPDATE
005047*        DATASET  (CRTT-ID)
005048*        RIDFLD   (ELCRTT-KEY)
005049*        INTO     (CERTIFICATE-TRAILERS)
005050*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00012266' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303132323636' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005051
005052     IF WS-INS-AGE-SET = 'Y'
005053        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
005054     END-IF
005055     IF WS-JNT-AGE-SET = 'Y'
005056        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
005057     END-IF
005058
005059     
      * EXEC CICS REWRITE
005060*       DATASET  (CRTT-ID)
005061*       FROM     (CERTIFICATE-TRAILERS)
005062*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00012280' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303132323830' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005063
005064     GO TO 1386-EXIT.
005065
005066 1386-NOTFND.
005067
005068     MOVE SPACES       TO CERTIFICATE-TRAILERS.
005069     MOVE 'CS'         TO CS-RECORD-ID.
005070     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
005071     MOVE 'C'          TO ELCRTT-REC-TYPE.
005072     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
005073     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
005074     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
005075     
      * EXEC CICS WRITE
005076*       DATASET  (CRTT-ID)
005077*       RIDFLD   (ELCRTT-KEY)
005078*       FROM     (CERTIFICATE-TRAILERS)
005079*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00012296' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'2020233030303132323936' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005080
005081 1386-EXIT.
005082     EXIT.
005083
005084 1390-UPDATE-ERPNDM.
005085
005086     
      * EXEC CICS HANDLE CONDITION
005087*        NOTFND (1399-EXIT)
005088*    END-EXEC.
      *    MOVE '"$I                   ! ) #00012307' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'2920233030303132333037' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005089
005090     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
005091
005092     
      * EXEC CICS READ
005093*        SET     (ADDRESS OF PENDING-MAILING-DATA)
005094*        DATASET (FILE-ID-ERPNDM)
005095*        RIDFLD  (ERPNDM-KEY)
005096*        UPDATE
005097*    END-EXEC.
      *    MOVE '&"S        EU         (   #00012313' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303132333133' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDM, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDM-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-MAILING-DATA TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005098
005099     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
005100     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
005101     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
005102
005103     IF BLSTNML GREATER THAN ZEROS
005104         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
005105
005106     IF B1STNML GREATER  THAN ZEROS
005107         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
005108
005109     IF BINITL GREATER THAN ZEROS
005110         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
005111
005112     IF BAGEL GREATER THAN ZEROS
005113         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
005114
005115     IF BBIRTHL GREATER THAN ZEROS
005116         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
005117
005118     IF BSEXL GREATER THAN ZEROS
005119         MOVE  BSEXI             TO PM-INSURED-SEX.
005120
005121     
      * EXEC CICS REWRITE
005122*        DATASET (FILE-ID-ERPNDM)
005123*        FROM    (PENDING-MAILING-DATA)
005124*    END-EXEC.
           MOVE LENGTH OF
            PENDING-MAILING-DATA
             TO DFHEIV11
      *    MOVE '&& L                  %   #00012342' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303132333432' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDM, 
                 PENDING-MAILING-DATA, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005125
005126 1399-EXIT.
005127     EXIT.
005128 139A-SET-LETTER-REQD.
005129*  COMPARE BEFORE AND AFTER CHANGE
005130     IF PB-ISSUE-RECORD = WS-SAVE-PEND-ISSUE
005131        GO TO 139A-EXIT
005132     END-IF
005133
005134*  READ ELCRTO
005135     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
005136                                 TO ELCRTO-KEY
005137     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
005138     MOVE +0                     TO ELCRTO-SEQ-NO
005139
005140     
      * EXEC CICS READ
005141*       DATASET   ('ELCRTO')
005142*       INTO      (ORIGINAL-CERTIFICATE)
005143*       RIDFLD    (ELCRTO-KEY)
005144*       GTEQ
005145*       RESP      (WS-RESPONSE)
005146*    END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&"IL       G          (  N#00012361' TO DFHEIV0
           MOVE X'2622494C2020202020202047' &
                X'202020202020202020202820' &
                X'204E233030303132333631' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 ELCRTO-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005147
005148*    display ' just read gteq ' ws-response
005149     IF RESP-NORMAL
005150        AND (OC-CONTROL-PRIMARY (1:33) =
005151                 PB-CONTROL-BY-ACCOUNT (1:33))
005152        AND (OC-RECORD-TYPE = 'I')
005153*      compare individual fields
005154        IF LETRREQL   GREATER THAN ZEROS
005155           CONTINUE
005156        ELSE
005157        IF OC-CERT-NO = PB-CERT-NO
005158          AND OC-CERT-EFF-DT = PB-CERT-EFF-DT
005159          AND OC-INS-LAST-NAME = PB-I-INSURED-LAST-NAME
005160          AND OC-INS-FIRST-NAME = PB-I-INSURED-FIRST-NAME
005161          AND OC-INS-MIDDLE-INIT =  PB-I-INSURED-MIDDLE-INIT
005162          AND OC-INS-AGE = PB-I-AGE
005163          AND OC-LF-BENCD = PB-I-LIFE-BENEFIT-CD
005164          AND OC-LF-TERM = PB-I-LF-TERM
005165          AND OC-LF-BEN-AMT = PB-I-LF-BENEFIT-AMT
005166          AND OC-LF-PRM-AMT = PB-I-LF-PREMIUM-AMT
005167          AND OC-LF-EXP-DT = PB-I-LF-EXPIRE-DT
005168          AND OC-LF-ALT-BEN-AMT = PB-I-LF-ALT-BENEFIT-AMT
005169          AND PB-I-LF-ALT-PREMIUM-AMT = OC-LF-ALT-PRM-AMT
005170          AND PB-I-LF-EXPIRE-DT = OC-LF-EXP-DT
005171          AND PB-I-AH-BENEFIT-CD     = OC-AH-BENCD
005172          AND PB-I-AH-TERM           = OC-AH-TERM
005173          AND PB-I-AH-BENEFIT-AMT    = OC-AH-BEN-AMT
005174          AND PB-I-AH-PREMIUM-AMT    = OC-AH-PRM-AMT
005175          AND PB-I-AH-EXPIRE-DT      = OC-AH-EXP-DT
005176          AND PB-I-AH-COMMISSION     = OC-AH-COMM-PCT
005177          AND PB-I-AH-CRIT-PER       = OC-AH-CP
005178           MOVE SPACE TO PB-I-LETTER-REQD
005179        ELSE
005180           MOVE 'Y' TO PB-I-LETTER-REQD
005181        END-IF
005182     END-IF.
005183
005184 139A-EXIT.
005185     EXIT.
005186
005187******************************************************************
005188*                                                                *
005189*          D E L E T E   I S S U E   R O U T I N E               *
005190*                                                                *
005191******************************************************************
005192
005193 1400-DELETE-ISSUE-ROUTINE.
005194     MOVE 'D'                    TO PI-MAINT-FUNCTION.
005195
005196     IF BCHGL NOT = ZEROS
005197        MOVE ER-2196             TO EMI-ERROR
005198        MOVE AL-UABON            TO BMAINTA
005199        MOVE -1                  TO BMAINTL
005200        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005201        GO TO 8200-SEND-DATAONLY.
005202
005203     
      * EXEC CICS HANDLE CONDITION
005204*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
005205*    END-EXEC.
      *    MOVE '"$I                   ! * #00012424' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'2A20233030303132343234' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005206
005207     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
005208     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
005209     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
005210
005211     
      * EXEC CICS READ
005212*        SET     (ADDRESS OF PENDING-BUSINESS)
005213*        DATASET (FILE-ID-ERPNDB)
005214*        RIDFLD  (ERPNDB-KEY)
005215*    END-EXEC.
      *    MOVE '&"S        E          (   #00012432' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303132343332' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005216
005217     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
005218
005219     MOVE BCERTNOI               TO WS-NEW-PRIME.
005220
005221     IF BSUFIXL NOT = ZEROS
005222        MOVE BSUFIXI             TO WS-NEW-SUFFIX
005223     ELSE
005224        MOVE SPACE               TO WS-NEW-SUFFIX.
005225
005226     MOVE BEFFDTI                TO DEEDIT-FIELD.
005227     PERFORM 8600-DEEDIT.
005228     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
005229     MOVE '4'                    TO DC-OPTION-CODE.
005230     PERFORM 9700-DATE-LINK.
005231     IF DATE-CONVERSION-ERROR
005232        MOVE ER-0348             TO EMI-ERROR
005233        MOVE -1                  TO BEFFDTL
005234        MOVE AL-UABON            TO BEFFDTA
005235        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005236        GO TO 8200-SEND-DATAONLY
005237     ELSE
005238        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
005239        MOVE AL-UANON            TO BEFFDTA
005240        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
005241
005242     
      * EXEC CICS HANDLE CONDITION
005243*         NOTFND    (1490-RECORD-NOT-FOUND)
005244*    END-EXEC.
      *    MOVE '"$I                   ! + #00012463' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'2B20233030303132343633' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005245
005246     
      * EXEC CICS READ
005247*        SET     (ADDRESS OF PENDING-BUSINESS)
005248*        DATASET (FILE-ID-ERPNDB)
005249*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
005250*        UPDATE
005251*    END-EXEC.
      *    MOVE '&"S        EU         (   #00012467' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303132343637' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 PI-PREV-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005252
005253     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
005254        MOVE -1                 TO BMAINTL
005255        MOVE ER-2197            TO EMI-ERROR
005256        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005257        GO TO 8200-SEND-DATAONLY.
005258
005259     IF PB-BILLED-DT NOT = LOW-VALUES
005260        MOVE -1                 TO BMAINTL
005261        MOVE ER-2129            TO EMI-ERROR
005262        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005263        GO TO 8200-SEND-DATAONLY.
005264
005265     IF PB-CHG-COUNT NOT = ZEROS
005266        MOVE ER-2336            TO EMI-ERROR
005267        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005268        MOVE AL-UABON            TO BMAINTA
005269        MOVE -1                  TO BMAINTL
005270        GO TO 8200-SEND-DATAONLY.
005271
005272     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
005273        PB-CHG-COUNT NOT = ZEROS
005274        MOVE ER-2196             TO EMI-ERROR
005275        MOVE AL-UABON            TO BMAINTA
005276        MOVE -1                  TO BMAINTL
005277        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005278        GO TO 8200-SEND-DATAONLY.
005279
005280******************************************************************
005281*                                                                *
005282*       Determine if this is a dup and we should allow the       *
005283*       user to delete the pending issue record only.            *
005284*                                                                *
005285******************************************************************
005286
005287     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
005288                                 TO ELCERT-KEY
005289     
      * EXEC CICS READ
005290*        SET     (ADDRESS OF CERTIFICATE-MASTER)
005291*        DATASET (FILE-ID-ELCERT)
005292*        RIDFLD  (ELCERT-KEY)
005293*        RESP    (WS-RESPONSE)
005294*    END-EXEC
      *    MOVE '&"S        E          (  N#00012510' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303132353130' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CERTIFICATE-MASTER TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005295
005296     if (resp-normal)
005297        and (cert-added-batch)
005298        and (valid-cm-id)
005299        go to 1420-CONTINUE-DELETE
005300     end-if
005301
005302******************************************************************
005303*                                                                *
005304*       Determine if there have been any checks created          *
005305*                                                                *
005306******************************************************************
005307
005308     perform 2500-browse-checks  thru 2500-exit
005309
005310     if i-have-processed-checks
005311        or i-have-checks
005312        or i-have-a-check-period
005313        move er-3446             to emi-error
005314        perform 9900-error-format thru 9900-exit
005315        move al-uabon            to bmainta
005316        move -1                  to bmaintl
005317        go to 8200-send-dataonly
005318     end-if
005319
005320******************************************************************
005321*                                                                *
005322*       DELETE ORIGINAL CERTIFICATE INFO                         *
005323*                                                                *
005324******************************************************************
005325
005326     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
005327     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
005328     MOVE +0                     TO ELCRTO-SEQ-NO
005329
005330     
      * EXEC CICS READ
005331*       DATASET   ('ELCRTO')
005332*       INTO      (ORIGINAL-CERTIFICATE)
005333*       RIDFLD    (ELCRTO-KEY)
005334*       GTEQ
005335*       RESP      (WS-RESPONSE)
005336*    END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&"IL       G          (  N#00012551' TO DFHEIV0
           MOVE X'2622494C2020202020202047' &
                X'202020202020202020202820' &
                X'204E233030303132353531' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 ELCRTO-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005337
005338     IF RESP-NORMAL
005339        AND (OC-CONTROL-PRIMARY (1:33) =
005340                 PB-CONTROL-BY-ACCOUNT (1:33))
005341        AND (OC-RECORD-TYPE = 'I')
005342        
      * EXEC CICS READ
005343*          DATASET   ('ELCRTO')
005344*          INTO      (ORIGINAL-CERTIFICATE)
005345*          RIDFLD    (ELCRTO-KEY)
005346*          UPDATE
005347*          RESP      (WS-RESPONSE)
005348*       END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&"IL       EU         (  N#00012563' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'204E233030303132353633' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 ELCRTO-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005349        IF RESP-NORMAL
005350           
      * EXEC CICS DELETE
005351*             DATASET   ('ELCRTO')
005352*          END-EXEC
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&(                    &   #00012571' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'2020233030303132353731' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ELCRTO-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005353        END-IF
005354     END-IF
005355
005356******************************************************************
005357*                                                                *
005358*       DELETE PENDING MAILING ADDRESS RECORDS                   *
005359*                                                                *
005360******************************************************************
005361
005362     
      * EXEC CICS HANDLE CONDITION
005363*        NOTFND    (1405-DELETE-CERTIFICATE)
005364*    END-EXEC.
      *    MOVE '"$I                   ! , #00012583' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'2C20233030303132353833' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005365
005366     
      * EXEC CICS READ
005367*        EQUAL
005368*        DATASET   (FILE-ID-ERPNDM)
005369*        SET       (ADDRESS OF PENDING-MAILING-DATA)
005370*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
005371*        UPDATE
005372*    END-EXEC.
      *    MOVE '&"S        EU         (   #00012587' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303132353837' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDM, 
                 DFHEIV20, 
                 DFHEIV99, 
                 PI-PREV-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-MAILING-DATA TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005373
005374     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
005375     MOVE 'D'                    TO  JP-RECORD-TYPE.
005376     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
005377
005378     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
005379
005380     
      * EXEC CICS DELETE
005381*        DATASET   (FILE-ID-ERPNDM)
005382*    END-EXEC.
      *    MOVE '&(                    &   #00012601' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'2020233030303132363031' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDM, 
                 PI-PREV-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005383
005384******************************************************************
005385*                PROCESS   CERTIFICATE                           *
005386******************************************************************
005387
005388 1405-DELETE-CERTIFICATE.
005389     
      * EXEC CICS HANDLE CONDITION
005390*         NOTFND  (1420-CONTINUE-DELETE)
005391*    END-EXEC.
      *    MOVE '"$I                   ! - #00012610' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'2D20233030303132363130' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005392
005393     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
005394     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
005395     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
005396     MOVE PB-SV-STATE            TO ELCERT-STATE.
005397
005398     
      * EXEC CICS READ
005399*        SET     (ADDRESS OF CERTIFICATE-MASTER)
005400*        DATASET (FILE-ID-ELCERT)
005401*        RIDFLD  (ELCERT-KEY)
005402*        UPDATE
005403*    END-EXEC.
      *    MOVE '&"S        EU         (   #00012619' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303132363139' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CERTIFICATE-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005404
005405     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
005406
005407     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
005408     MOVE 'B'                    TO JP-RECORD-TYPE
005409     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
005410
005411     PERFORM 8400-LOG-JOURNAL-RECORD.
005412
005413     IF CERT-NOTES-ARE-NOT-PRESENT
005414        MOVE ' '                 TO WS-CERT-NOTE-SW
005415     ELSE
005416        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
005417
005418     IF INSURED-ADDR-PRESENT
005419        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
005420
005421******************************************************************
005422******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
005423******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
005424******************************************************************
005425******************************************************************
005426
005427     IF CERT-ADDED-BATCH AND
005428        (NOT NO-CLAIM-ATTACHED
005429         OR
005430         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
005431        GO TO 1410-REWRITE-CERT.
005432
005433******************************************************************
005434******************************************************************
005435
005436     IF CERT-ADDED-BATCH  AND
005437        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
005438        GO TO 1410-REWRITE-CERT.
005439
005440     IF NO-CLAIM-ATTACHED
005441        NEXT SENTENCE
005442     ELSE
005443        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
005444        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
005445        GO TO 1410-REWRITE-CERT.
005446
005447     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
005448     MOVE 'D'                      TO JP-RECORD-TYPE.
005449     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
005450
005451     
      * EXEC CICS DELETE
005452*         DATASET    (FILE-ID-ELCERT)
005453*    END-EXEC.
      *    MOVE '&(                    &   #00012672' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'2020233030303132363732' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005454
005455     PERFORM 8400-LOG-JOURNAL-RECORD.
005456
005457******************************************************************
005458*                                                                *
005459*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
005460*                                                                *
005461******************************************************************
005462
005463     IF  CERT-NOTES-ARE-PRESENT
005464         NEXT SENTENCE
005465     ELSE
005466         GO TO 1407-DELETE-MAILING.
005467
005468     
      * EXEC CICS HANDLE CONDITION
005469*         NOTFND  (1406-DELETE-ERNOTE)
005470*    END-EXEC.
      *    MOVE '"$I                   ! . #00012689' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'2E20233030303132363839' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005471
005472     MOVE ELCERT-KEY            TO ERCNOT-KEY.
005473     MOVE '0'                   TO ERCNOT-REC-TYPE.
005474     MOVE 0                     TO ERCNOT-SEQUENCE.
005475
005476 1406-DELETE-ERCNOT-LOOP.
005477
005478     
      * EXEC CICS READ
005479*        GTEQ
005480*        DATASET   (FILE-ID-ERCNOT)
005481*        SET       (ADDRESS OF CERT-NOTE-FILE)
005482*        RIDFLD    (ERCNOT-KEY)
005483*    END-EXEC.
      *    MOVE '&"S        G          (   #00012699' TO DFHEIV0
           MOVE X'262253202020202020202047' &
                X'202020202020202020202820' &
                X'2020233030303132363939' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERCNOT, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERCNOT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CERT-NOTE-FILE TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005484
005485     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
005486     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
005487         GO TO 1406-DELETE-ERNOTE
005488     END-IF.
005489
005490     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
005491     MOVE 'D'                    TO  JP-RECORD-TYPE.
005492     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
005493
005494     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
005495
005496     
      * EXEC CICS DELETE
005497*        DATASET   (FILE-ID-ERCNOT)
005498*        RIDFLD    (ERCNOT-KEY)
005499*        END-EXEC.
      *    MOVE '&(  R                 &   #00012717' TO DFHEIV0
           MOVE X'262820205220202020202020' &
                X'202020202020202020202620' &
                X'2020233030303132373137' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERCNOT, 
                 ERCNOT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005500
005501     PERFORM 8400-LOG-JOURNAL-RECORD.
005502
005503     GO TO 1406-DELETE-ERCNOT-LOOP.
005504
005505 1406-DELETE-ERNOTE.
005506
005507     
      * EXEC CICS HANDLE CONDITION
005508*         NOTFND  (1407-DELETE-MAILING)
005509*    END-EXEC.
      *    MOVE '"$I                   ! / #00012728' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'2F20233030303132373238' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005510
005511*    EXEC CICS READ
005512*        EQUAL
005513*        DATASET   (FILE-ID-ERNOTE)
005514*        SET       (ADDRESS OF CERTIFICATE-NOTE)
005515*        RIDFLD    (ELCERT-KEY)
005516*        UPDATE
005517*    END-EXEC.
005518
005519     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
005520     MOVE 'D'                    TO  JP-RECORD-TYPE.
005521     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
005522
005523     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
005524
005525     
      * exec cics delete
005526*       dataset       ('ERNOTE')
005527*       keylength     (33)
005528*       ridfld        (elcert-key)
005529*       generic
005530*    end-exec
           MOVE 'ERNOTE' TO DFHEIV1
           MOVE 33
             TO DFHEIV11
      *    MOVE '&(  RKG               &   #00012746' TO DFHEIV0
           MOVE X'26282020524B472020202020' &
                X'202020202020202020202620' &
                X'2020233030303132373436' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 elcert-key, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005531
005532*    EXEC CICS DELETE
005533*        DATASET   (FILE-ID-ERNOTE)
005534*        END-EXEC.
005535
005536     PERFORM 8400-LOG-JOURNAL-RECORD.
005537
005538******************************************************************
005539*                                                                *
005540*                DELETE MAILING ADDRESS RECORDS                  *
005541*                                                                *
005542******************************************************************
005543
005544 1407-DELETE-MAILING.
005545     IF CERT-ADDRESS-PRESENT
005546        NEXT SENTENCE
005547     ELSE
005548        GO TO 1420-CONTINUE-DELETE.
005549
005550     
      * EXEC CICS HANDLE CONDITION
005551*         NOTFND  (1420-CONTINUE-DELETE)
005552*    END-EXEC.
      *    MOVE '"$I                   ! 0 #00012771' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3020233030303132373731' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005553
005554     
      * EXEC CICS READ
005555*        EQUAL
005556*        DATASET   (FILE-ID-ERMAIL)
005557*        SET       (ADDRESS OF MAILING-DATA)
005558*        RIDFLD    (ELCERT-KEY)
005559*        UPDATE
005560*    END-EXEC.
      *    MOVE '&"S        EU         (   #00012775' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303132373735' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERMAIL, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF MAILING-DATA TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005561
005562     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
005563     MOVE 'D'                    TO  JP-RECORD-TYPE.
005564     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
005565
005566     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
005567
005568     
      * EXEC CICS DELETE
005569*        DATASET   (FILE-ID-ERMAIL)
005570*    END-EXEC.
      *    MOVE '&(                    &   #00012789' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'2020233030303132373839' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERMAIL, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005571
005572     GO TO 1420-CONTINUE-DELETE.
005573
005574 1410-REWRITE-CERT.
005575     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
005576     MOVE 'C'                      TO JP-RECORD-TYPE.
005577     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
005578     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
005579
005580     
      * EXEC CICS REWRITE
005581*         DATASET    (FILE-ID-ELCERT)
005582*         FROM       (CERTIFICATE-MASTER)
005583*         END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV11
      *    MOVE '&& L                  %   #00012801' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303132383031' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 CERTIFICATE-MASTER, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005584
005585     PERFORM 8400-LOG-JOURNAL-RECORD.
005586
005587 1420-CONTINUE-DELETE.
005588     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
005589     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
005590
005591     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
005592     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
005593
005594     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
005595
005596 1450-DELETE-PB-RECORD.
005597     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
005598     MOVE 'D'                      TO JP-RECORD-TYPE
005599     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
005600
005601     
      * EXEC CICS DELETE
005602*        DATASET    (FILE-ID-ERPNDB)
005603*    END-EXEC.
      *    MOVE '&(                    &   #00012822' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'2020233030303132383232' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005604
005605     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
005606
005607     PERFORM 8400-LOG-JOURNAL-RECORD *> Journal Delete
005608
005609     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
005610     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
005611     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
005612
005613     
      * EXEC CICS HANDLE CONDITION
005614*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
005615*    END-EXEC.
      *    MOVE '"$I                   ! 1 #00012834' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3120233030303132383334' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005616
005617     
      * EXEC CICS READ
005618*        SET     (ADDRESS OF PENDING-BUSINESS)
005619*        DATASET (FILE-ID-ERPNDB)
005620*        RIDFLD  (ERPNDB-KEY)
005621*        UPDATE
005622*    END-EXEC.
      *    MOVE '&"S        EU         (   #00012838' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303132383338' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005623
005624     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
005625
005626     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
005627
005628     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
005629        WS-B-CANCEL-CNT-ENTERED = ZEROS
005630        MOVE 'D'                   TO JP-RECORD-TYPE
005631        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
005632        
      * EXEC CICS DELETE
005633*            DATASET    (FILE-ID-ERPNDB)
005634*       END-EXEC
      *    MOVE '&(                    &   #00012853' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'2020233030303132383533' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005635        PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Delete
005636     ELSE
005637        MOVE 'B'                 TO JP-RECORD-TYPE
005638        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
005639        PERFORM 8400-LOG-JOURNAL-RECORD  *> Before Image
005640        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
005641        MOVE 'C'                 TO JP-RECORD-TYPE
005642        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
005643        
      * EXEC CICS REWRITE
005644*            DATASET    (FILE-ID-ERPNDB)
005645*            FROM       (PENDING-BUSINESS)
005646*       END-EXEC
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00012864' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303132383634' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005647        PERFORM 8400-LOG-JOURNAL-RECORD  *> After Image
005648     end-if
005649
005650******************************************************************
005651*                                                                *
005652*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
005653*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
005654*                                                                *
005655******************************************************************
005656
005657     IF NOT PI-AR-PROCESSING
005658        GO TO 1475-DELETE-FINISHED.
005659
005660     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
005661        WS-B-CANCEL-CNT-ENTERED = ZEROS
005662        NEXT SENTENCE
005663     ELSE
005664        GO TO 1475-DELETE-FINISHED.
005665
005666     
      * EXEC CICS HANDLE CONDITION
005667*         NOTFND    (1475-DELETE-FINISHED)
005668*         END-EXEC.
      *    MOVE '"$I                   ! 2 #00012887' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3220233030303132383837' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005669
005670     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
005671     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
005672
005673     
      * EXEC CICS READ
005674*        SET     (ADDRESS OF AR-REQUEST-RECORD)
005675*        DATASET (FILE-ID-ERRQST)
005676*        RIDFLD  (ERRQST-KEY)
005677*        UPDATE
005678*    END-EXEC.
      *    MOVE '&"S        EU         (   #00012894' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303132383934' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRQST, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERRQST-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF AR-REQUEST-RECORD TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005679
005680     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
005681
005682     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
005683
005684     MOVE 'D'                      TO JP-RECORD-TYPE.
005685     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
005686
005687     
      * EXEC CICS DELETE
005688*         DATASET    (FILE-ID-ERRQST)
005689*    END-EXEC.
      *    MOVE '&(                    &   #00012908' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'2020233030303132393038' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRQST, 
                 ERRQST-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
005690
005691     PERFORM 8400-LOG-JOURNAL-RECORD.
005692
005693 1475-DELETE-FINISHED.
005694     MOVE ZEROS                  TO EMI-ERROR.
005695     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005696     MOVE LOW-VALUES             TO EL631BI.
005697     MOVE -1                     TO BMAINTL.
005698     GO TO 8100-SEND-INITIAL-MAP.
005699
005700 1480-BATCH-HDR-NOT-FOUND.
005701     MOVE -1                     TO BMAINTL.
005702     MOVE ER-7450                TO EMI-ERROR.
005703     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005704     GO TO 8200-SEND-DATAONLY.
005705
005706 1490-RECORD-NOT-FOUND.
005707     MOVE -1                     TO BMAINTL.
005708     MOVE ER-7451                TO EMI-ERROR.
005709     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005710     GO TO 8200-SEND-DATAONLY.
005711
005712******************************************************************
005713*            O V E R   C H A R G E   P R O C E S S I N G         *
005714******************************************************************
005715 1500-UPDATE-ERNOTE.
005716
005717     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
005718     MOVE 'A'                    TO WS-NOTE-SW
005719     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
005720
005721     .
005722 1500-EXIT.
005723     EXIT.
005724
005725 1510-ADD-ERNOTE-REC.
005726
005727     
      * EXEC CICS GETMAIN
005728*        SET     (ADDRESS OF CERTIFICATE-NOTE)
005729*        LENGTH  (ERNOTE-RECORD-LENGTH)
005730*        INITIMG (GETMAIN-SPACE)
005731*    END-EXEC
      *    MOVE ',"IL                  $   #00012948' TO DFHEIV0
           MOVE X'2C22494C2020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303132393438' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 ERNOTE-RECORD-LENGTH, 
                 GETMAIN-SPACE
           SET ADDRESS OF CERTIFICATE-NOTE TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005732
005733     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
005734                                 TO ERNOTE-KEY
005735     move '1'                    to ernote-record-type
005736
005737     
      * EXEC CICS READ
005738*       DATASET    (FILE-ID-ERNOTE)
005739*       RIDFLD     (ERNOTE-KEY)
005740*       INTO       (CERTIFICATE-NOTE)
005741*       RESP       (WS-RESPONSE)
005742*       UPDATE
005743*    END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-NOTE
             TO DFHEIV11
      *    MOVE '&"IL       EU         (  N#00012958' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'204E233030303132393538' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERNOTE, 
                 CERTIFICATE-NOTE, 
                 DFHEIV11, 
                 ERNOTE-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005744
005745     IF RESP-NORMAL
005746        IF CN-BILLING-START-LINE-NO NOT NUMERIC
005747           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
005748        END-IF
005749        IF CN-BILLING-END-LINE-NO NOT NUMERIC
005750           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
005751        END-IF
005752        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
005753           (N1 > +10)
005754           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
005755           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
005756        END-PERFORM
005757        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
005758          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
005759           
      * EXEC CICS UNLOCK
005760*            DATASET    (FILE-ID-ERNOTE)
005761*          END-EXEC
      *    MOVE '&*                    #   #00012980' TO DFHEIV0
           MOVE X'262A20202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303132393830' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERNOTE, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005762        ELSE
005763          PERFORM VARYING N1 FROM +1 BY +1
005764           UNTIL (N1 > +10)
005765           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
005766          END-PERFORM
005767          IF (N1 < +11)
005768            IF N1 >= CN-BILLING-START-LINE-NO AND
005769              N1 <= CN-BILLING-END-LINE-NO
005770              IF PI-COMPANY-ID = 'DCC' or 'VPP'
005771                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
005772              ELSE
005773                 MOVE WS-VA-NO-COMM-MESS
005774                                    TO CN-LINE (N1)
005775              END-IF
005776            ELSE
005777              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
005778               (N1 = (CN-BILLING-END-LINE-NO + +1))
005779                IF PI-COMPANY-ID = 'DCC' or 'VPP'
005780                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
005781                ELSE
005782                  MOVE WS-VA-NO-COMM-MESS
005783                                    TO CN-LINE (N1)
005784                END-IF
005785                MOVE N1             TO CN-BILLING-END-LINE-NO
005786              ELSE
005787                IF (CN-BILLING-END-LINE-NO = ZEROS)
005788                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
005789                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
005790                  ELSE
005791                     MOVE WS-VA-NO-COMM-MESS
005792                                    TO CN-LINE (N1)
005793                  END-IF
005794                  MOVE N1            TO CN-BILLING-END-LINE-NO
005795                                      CN-BILLING-START-LINE-NO
005796                ELSE
005797                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
005798                    (N1 = (CN-BILLING-START-LINE-NO - +1))
005799                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
005800                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
005801                     ELSE
005802                       MOVE WS-VA-NO-COMM-MESS
005803                                    TO CN-LINE (N1)
005804                     END-IF
005805                     MOVE N1         TO CN-BILLING-START-LINE-NO
005806                  ELSE
005807                     PERFORM 1700-SQUEEZE-IT-IN
005808                                 THRU 1700-EXIT
005809                  END-IF
005810                END-IF
005811              END-IF
005812            END-IF
005813            MOVE 'E631'              TO CN-LAST-MAINT-USER
005814            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
005815            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
005816            
      * EXEC CICS REWRITE
005817*              DATASET    (FILE-ID-ERNOTE)
005818*              FROM       (CERTIFICATE-NOTE)
005819*              RESP       (WS-RESPONSE)
005820*           END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-NOTE
             TO DFHEIV11
      *    MOVE '&& L                  %  N#00013037' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'204E233030303133303337' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERNOTE, 
                 CERTIFICATE-NOTE, 
                 DFHEIV11, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005821          END-IF
005822        END-IF
005823     ELSE
005824        MOVE SPACES              TO CERTIFICATE-NOTE
005825        MOVE 'CN'                TO CN-RECORD-ID
005826        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
005827                                 TO CN-CONTROL-PRIMARY
005828                                    ERNOTE-KEY
005829        move '1'                 to cn-record-type
005830                                    ernote-record-type
005831        MOVE 01                  TO CN-BILLING-START-LINE-NO
005832                                    CN-BILLING-END-LINE-NO
005833        IF PI-COMPANY-ID = 'DCC' or 'VPP'
005834           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
005835        ELSE
005836           MOVE WS-VA-NO-COMM-MESS
005837                                 TO CN-LINE (1)
005838        END-IF
005839        MOVE 'E631'              TO CN-LAST-MAINT-USER
005840        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
005841        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
005842        
      * EXEC CICS WRITE
005843*          DATASET    (FILE-ID-ERNOTE)
005844*          FROM       (CERTIFICATE-NOTE)
005845*          RIDFLD     (ERNOTE-KEY)
005846*          RESP       (WS-RESPONSE)
005847*       END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-NOTE
             TO DFHEIV11
      *    MOVE '&$ L                  ''  N#00013063' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'204E233030303133303633' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERNOTE, 
                 CERTIFICATE-NOTE, 
                 DFHEIV11, 
                 ERNOTE-KEY, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005848     END-IF
005849
005850     .
005851 1510-EXIT.
005852     EXIT.
005853
005854 1520-UPDATE-ELCERT.
005855
005856     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
005857                                 TO ELCERT-KEY
005858     
      * EXEC CICS READ
005859*        SET     (ADDRESS OF CERTIFICATE-MASTER)
005860*        DATASET (FILE-ID-ELCERT)
005861*        RIDFLD  (ELCERT-KEY)
005862*        UPDATE
005863*        RESP    (WS-RESPONSE)
005864*    END-EXEC
      *    MOVE '&"S        EU         (  N#00013079' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'204E233030303133303739' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CERTIFICATE-MASTER TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005865
005866     IF RESP-NORMAL
005867        IF WS-NOTE-SW = 'A'
005868           IF CM-NOTE-SW = ' '
005869              MOVE '2'             TO CM-NOTE-SW
005870           ELSE
005871             IF CM-NOTE-SW = '1'
005872                MOVE '3'           TO CM-NOTE-SW
005873             ELSE
005874               IF CM-NOTE-SW = '4'
005875                  MOVE '6'         TO CM-NOTE-SW
005876               ELSE
005877                 IF CM-NOTE-SW = '5'
005878                    MOVE '7'       TO CM-NOTE-SW
005879                 END-IF
005880               END-IF
005881             END-IF
005882           END-IF
005883        ELSE
005884           IF CM-NOTE-SW = '2'
005885              MOVE ' '             TO CM-NOTE-SW
005886           ELSE
005887             IF CM-NOTE-SW = '3'
005888                MOVE '1'           TO CM-NOTE-SW
005889             ELSE
005890               IF CM-NOTE-SW = '6'
005891                  MOVE '4'         TO CM-NOTE-SW
005892               ELSE
005893                 IF CM-NOTE-SW = '7'
005894                    MOVE '5'       TO CM-NOTE-SW
005895                 END-IF
005896               END-IF
005897             END-IF
005898           END-IF
005899        END-IF
005900        
      * EXEC CICS REWRITE
005901*          DATASET    (FILE-ID-ELCERT)
005902*          FROM       (CERTIFICATE-MASTER)
005903*          RESP       (WS-RESPONSE)
005904*       END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV11
      *    MOVE '&& L                  %  N#00013121' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'204E233030303133313231' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 CERTIFICATE-MASTER, 
                 DFHEIV11, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005905        IF RESP-NORMAL
005906           CONTINUE
005907        ELSE
005908           MOVE WS-RESPONSE TO EMI-ERROR
005909           PERFORM 9900-ERROR-FORMAT
005910                                 THRU 9900-EXIT
005911           GO TO 8200-SEND-DATAONLY
005912        END-IF
005913     ELSE
005914        MOVE -1                  TO BMAINTL
005915        MOVE 0249                TO EMI-ERROR
005916        PERFORM 9900-ERROR-FORMAT
005917                                 THRU 9900-EXIT
005918        GO TO 8200-SEND-DATAONLY
005919     END-IF
005920
005921     .
005922 1520-EXIT.
005923     EXIT.
005924
005925 1600-UPDATE-ERPYAJ.
005926
005927     PERFORM 1610-ADD-ERPYAJ-BANK-REC
005928                                 THRU 1610-EXIT
005929     PERFORM 1620-ADD-ERPYAJ-DLR-REC
005930                                 THRU 1620-EXIT
005931
005932     .
005933 1600-EXIT.
005934     EXIT.
005935
005936 1610-ADD-ERPYAJ-BANK-REC.
005937
005938     
      * EXEC CICS GETMAIN
005939*        SET     (ADDRESS OF PENDING-PAY-ADJ)
005940*        LENGTH  (ERPYAJ-RECORD-LENGTH)
005941*        INITIMG (GETMAIN-SPACE)
005942*    END-EXEC
      *    MOVE ',"IL                  $   #00013159' TO DFHEIV0
           MOVE X'2C22494C2020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303133313539' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 ERPYAJ-RECORD-LENGTH, 
                 GETMAIN-SPACE
           SET ADDRESS OF PENDING-PAY-ADJ TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005943
005944     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
005945     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
005946     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
005947     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
005948     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
005949     MOVE +10                    TO ERPYAJ-SEQ-NO
005950     MOVE 'R'                    TO ERPYAJ-TYPE
005951     IF REVERSAL
005952        MOVE 'C'                 TO ERPYAJ-TYPE
005953     END-IF
005954     MOVE SPACES                 TO PENDING-PAY-ADJ
005955     MOVE 'PY'                   TO PY-RECORD-ID
005956     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
005957     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
005958     IF REVERSAL
005959        MOVE PB-I-DCC-OVER-CHG-AMT
005960                                 TO PY-ENTRY-AMT
005961     END-IF
005962     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
005963                                    PY-INPUT-DT
005964*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
005965*                                   PY-INPUT-DT
005966     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
005967     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
005968     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
005969     MOVE 'B'                    TO PY-ERCOMP-TYPE
005970     IF PB-CARRIER = '2'
005971        MOVE '2725040330'        TO PY-GL-ACCOUNT
005972     ELSE
005973        MOVE '2725040130'        TO PY-GL-ACCOUNT
005974     END-IF
005975     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
005976                                    PY-BILLED-DATE
005977                                    PY-AR-DATE
005978                                    PY-REPORTED-DT
005979                                    PY-CHECK-WRITTEN-DT
005980     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
005981                                    PY-CHECK-QUE-SEQUENCE
005982     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
005983     PERFORM WITH TEST AFTER
005984        UNTIL (NOT RESP-DUPKEY)
005985           AND (NOT RESP-DUPREC)
005986        
      * EXEC CICS WRITE
005987*          DATASET    (FILE-ID-ERPYAJ)
005988*          FROM       (PENDING-PAY-ADJ)
005989*          RIDFLD     (ERPYAJ-KEY)
005990*          RESP       (WS-RESPONSE)
005991*       END-EXEC
           MOVE LENGTH OF
            PENDING-PAY-ADJ
             TO DFHEIV11
      *    MOVE '&$ L                  ''  N#00013207' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'204E233030303133323037' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPYAJ, 
                 PENDING-PAY-ADJ, 
                 DFHEIV11, 
                 ERPYAJ-KEY, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
005992        IF RESP-DUPKEY OR RESP-DUPREC
005993           ADD +1                TO ERPYAJ-SEQ-NO
005994           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
005995        END-IF
005996     END-PERFORM
005997
005998     .
005999 1610-EXIT.
006000     EXIT.
006001
006002 1620-ADD-ERPYAJ-DLR-REC.
006003
006004     MOVE 'C'                    TO ERPYAJ-TYPE
006005     IF REVERSAL
006006        MOVE 'R'                 TO ERPYAJ-TYPE
006007     END-IF
006008     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
006009                                    ERPYAJ-ACCOUNT
006010     ADD +1                      TO ERPYAJ-SEQ-NO
006011     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
006012     MOVE 'A'                    TO PY-ERCOMP-TYPE
006013     IF PB-CARRIER = '2'
006014        MOVE '2725040330'        TO PY-GL-ACCOUNT
006015     ELSE
006016        MOVE '2725040130'        TO PY-GL-ACCOUNT
006017     END-IF
006018
006019     PERFORM WITH TEST AFTER
006020        UNTIL (NOT RESP-DUPKEY)
006021           AND (NOT RESP-DUPREC)
006022        
      * EXEC CICS WRITE
006023*          DATASET    (FILE-ID-ERPYAJ)
006024*          FROM       (PENDING-PAY-ADJ)
006025*          RIDFLD     (ERPYAJ-KEY)
006026*          RESP       (WS-RESPONSE)
006027*       END-EXEC
           MOVE LENGTH OF
            PENDING-PAY-ADJ
             TO DFHEIV11
      *    MOVE '&$ L                  ''  N#00013243' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'204E233030303133323433' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPYAJ, 
                 PENDING-PAY-ADJ, 
                 DFHEIV11, 
                 ERPYAJ-KEY, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006028        IF RESP-DUPKEY OR RESP-DUPREC
006029           ADD +1                TO ERPYAJ-SEQ-NO
006030           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
006031        END-IF
006032     END-PERFORM
006033
006034     .
006035 1620-EXIT.
006036     EXIT.
006037
006038 1700-SQUEEZE-IT-IN.
006039
006040     IF (N1 > CN-BILLING-END-LINE-NO)
006041        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
006042           N1 = +1
006043           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
006044           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
006045              IF PI-COMPANY-ID = 'DCC' or 'VPP'
006046                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
006047              ELSE
006048                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
006049              END-IF
006050              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
006051              MOVE +2 TO N1
006052           END-IF
006053        END-PERFORM
006054     ELSE
006055        IF (N1 < CN-BILLING-START-LINE-NO)
006056           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
006057              N1 = +10
006058              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
006059              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
006060                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
006061                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
006062                 ELSE
006063                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
006064                 END-IF
006065                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
006066                 MOVE +9 TO N1
006067              END-IF
006068           END-PERFORM
006069        END-IF
006070     END-IF
006071
006072     .
006073 1700-EXIT.
006074     EXIT.
006075
006076 1800-REMOVE-CERT-NOTES.
006077
006078     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
006079                                 TO ERNOTE-KEY
006080     move '1'                    to ernote-record-type
006081
006082     
      * EXEC CICS READ
006083*       SET        (ADDRESS OF CERTIFICATE-NOTE)
006084*       DATASET    (FILE-ID-ERNOTE)
006085*       RIDFLD     (ERNOTE-KEY)
006086*       RESP       (WS-RESPONSE)
006087*       UPDATE
006088*    END-EXEC
      *    MOVE '&"S        EU         (  N#00013303' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'204E233030303133333033' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERNOTE, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERNOTE-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CERTIFICATE-NOTE TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006089
006090     IF RESP-NORMAL
006091        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
006092           (N1 > +10)
006093           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
006094           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
006095        END-PERFORM
006096        IF N1 < +11
006097           MOVE SPACES              TO CN-LINE (N1)
006098           IF N1 >= CN-BILLING-START-LINE-NO  AND
006099              N1 <= CN-BILLING-END-LINE-NO
006100              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
006101              IF CN-BILLING-END-LINE-NO <
006102                               CN-BILLING-START-LINE-NO
006103                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
006104                                     CN-BILLING-START-LINE-NO
006105              END-IF
006106              PERFORM 1820-SQUEEZE-ERNOTE
006107                                  THRU 1820-EXIT
006108           END-IF
006109           IF CN-LINES = SPACES
006110              
      * EXEC CICS DELETE
006111*                DATASET    (FILE-ID-ERNOTE)
006112*                RESP       (WS-RESPONSE)
006113*             END-EXEC
      *    MOVE '&(                    &  N#00013331' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'204E233030303133333331' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERNOTE, 
                 ERNOTE-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006114              IF RESP-NORMAL
006115                 MOVE 'D'        TO WS-NOTE-SW
006116                 PERFORM 1520-UPDATE-ELCERT
006117                                 THRU 1520-EXIT
006118              END-IF
006119           ELSE
006120              
      * EXEC CICS REWRITE
006121*                DATASET    (FILE-ID-ERNOTE)
006122*                FROM       (CERTIFICATE-NOTE)
006123*                RESP       (WS-RESPONSE)
006124*             END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-NOTE
             TO DFHEIV11
      *    MOVE '&& L                  %  N#00013341' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'204E233030303133333431' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERNOTE, 
                 CERTIFICATE-NOTE, 
                 DFHEIV11, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006125           END-IF
006126        END-IF
006127     END-IF
006128
006129     .
006130 1800-EXIT.
006131     EXIT.
006132
006133 1820-SQUEEZE-ERNOTE.
006134
006135     MOVE CN-BILLING-START-LINE-NO TO N2
006136     IF N2 = 0
006137         MOVE +1                 TO N2
006138     END-IF
006139     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
006140        (N1 > +9)
006141        IF CN-LINE (N1) = SPACES
006142           MOVE CN-LINE (N1 + +1)
006143                                 TO CN-LINE (N1)
006144           MOVE SPACES           TO CN-LINE (N1 + +1)
006145        END-IF
006146     END-PERFORM
006147
006148     .
006149 1820-EXIT.
006150     EXIT.
006151
006152 1900-DELETE-ERPYAJ.
006153
006154     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
006155     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
006156     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
006157     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
006158     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
006159     MOVE +10                    TO ERPYAJ-SEQ-NO
006160     MOVE 'R'                    TO ERPYAJ-TYPE
006161
006162     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
006163
006164     
      * EXEC CICS STARTBR
006165*       DATASET    (FILE-ID-ERPYAJ)
006166*       RIDFLD     (ERPYAJ-KEY)
006167*       RESP       (WS-RESPONSE)
006168*    END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &  N#00013385' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'204E233030303133333835' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPYAJ, 
                 ERPYAJ-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006169
006170     IF RESP-NORMAL
006171        CONTINUE
006172     ELSE
006173        GO TO 1900-GET-DEALER
006174     END-IF
006175
006176     .
006177 1900-READNEXT-ERPYAJ-B.
006178
006179*  GET THE BANK ERPYAJ RECORD
006180     
      * EXEC CICS READNEXT
006181*       DATASET    (FILE-ID-ERPYAJ)
006182*       RIDFLD     (ERPYAJ-KEY)
006183*       SET        (ADDRESS OF PENDING-PAY-ADJ)
006184*       RESP       (WS-RESPONSE)
006185*    END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )  N#00013401' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'204E233030303133343031' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPYAJ, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPYAJ-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-PAY-ADJ TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006186
006187     IF RESP-NORMAL
006188        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
006189           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
006190              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
006191                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
006192                 
      * EXEC CICS READ
006193*                   DATASET    (FILE-ID-ERPYAJ)
006194*                   RIDFLD     (ERPYAJ-KEY)
006195*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
006196*                   RESP       (WS-RESPONSE)
006197*                   UPDATE
006198*                END-EXEC
      *    MOVE '&"S        EU         (  N#00013413' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'204E233030303133343133' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPYAJ, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPYAJ-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-PAY-ADJ TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006199                 IF RESP-NORMAL
006200                    
      * EXEC CICS DELETE
006201*                      DATASET   (FILE-ID-ERPYAJ)
006202*                      RESP      (WS-RESPONSE)
006203*                   END-EXEC
      *    MOVE '&(                    &  N#00013421' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'204E233030303133343231' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPYAJ, 
                 ERPYAJ-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006204                 END-IF
006205              ELSE
006206                 SET REVERSAL    TO TRUE
006207                 PERFORM 1600-UPDATE-ERPYAJ
006208                                 THRU 1600-EXIT
006209                 GO TO 1900-EXIT
006210              END-IF
006211           ELSE
006212              GO TO 1900-READNEXT-ERPYAJ-B
006213           END-IF
006214        END-IF
006215        
      * EXEC CICS ENDBR
006216*          DATASET   (FILE-ID-ERPYAJ)
006217*       END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00013436' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303133343336' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPYAJ, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006218     END-IF
006219
006220     .
006221 1900-GET-DEALER.
006222
006223     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
006224     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
006225     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
006226     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
006227     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
006228     MOVE +10                    TO ERPYAJ-SEQ-NO
006229     MOVE 'C'                    TO ERPYAJ-TYPE
006230
006231     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
006232
006233     
      * EXEC CICS STARTBR
006234*       DATASET    (FILE-ID-ERPYAJ)
006235*       RIDFLD     (ERPYAJ-KEY)
006236*       RESP       (WS-RESPONSE)
006237*    END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &  N#00013454' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'204E233030303133343534' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPYAJ, 
                 ERPYAJ-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006238
006239     IF RESP-NORMAL
006240        CONTINUE
006241     ELSE
006242        GO TO 1900-EXIT
006243     END-IF
006244
006245     .
006246 1900-READNEXT-ERPYAJ-D.
006247
006248*  GET THE DEALER ERPYAJ RECORD
006249     
      * EXEC CICS READNEXT
006250*       DATASET    (FILE-ID-ERPYAJ)
006251*       RIDFLD     (ERPYAJ-KEY)
006252*       SET        (ADDRESS OF PENDING-PAY-ADJ)
006253*       RESP       (WS-RESPONSE)
006254*    END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )  N#00013470' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'204E233030303133343730' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPYAJ, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPYAJ-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-PAY-ADJ TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006255
006256     IF RESP-NORMAL
006257        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
006258           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
006259              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
006260                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
006261                 
      * EXEC CICS READ
006262*                   DATASET    (FILE-ID-ERPYAJ)
006263*                   RIDFLD     (ERPYAJ-KEY)
006264*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
006265*                   RESP       (WS-RESPONSE)
006266*                   UPDATE
006267*                END-EXEC
      *    MOVE '&"S        EU         (  N#00013482' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'204E233030303133343832' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPYAJ, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPYAJ-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-PAY-ADJ TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006268                 IF RESP-NORMAL
006269                    
      * EXEC CICS DELETE
006270*                      DATASET   (FILE-ID-ERPYAJ)
006271*                      RESP      (WS-RESPONSE)
006272*                   END-EXEC
      *    MOVE '&(                    &  N#00013490' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'204E233030303133343930' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPYAJ, 
                 ERPYAJ-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006273                 END-IF
006274              ELSE
006275                 SET REVERSAL    TO TRUE
006276              END-IF
006277           ELSE
006278              GO TO 1900-READNEXT-ERPYAJ-D
006279           END-IF
006280        END-IF
006281        
      * EXEC CICS ENDBR
006282*          DATASET   (FILE-ID-ERPYAJ)
006283*       END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00013502' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303133353032' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPYAJ, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006284     END-IF
006285
006286     .
006287 1900-EXIT.
006288     EXIT.
006289
006290******************************************************************
006291*            C A N C E L   M A I N L I N E                       *
006292******************************************************************
006293
006294 2000-CANCEL-MAINLINE.
006295     IF PI-DISPLAY-ORIGINAL-BATCH
006296        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
006297           MOVE ER-0023             TO EMI-ERROR
006298           MOVE -1                  TO CMAINTL
006299           MOVE AL-UABON            TO CMAINTA
006300           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006301           GO TO 8200-SEND-DATAONLY
006302        ELSE
006303           NEXT SENTENCE
006304     ELSE
006305        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
006306           MOVE ER-0023             TO EMI-ERROR
006307           MOVE -1                  TO CMAINTL
006308           MOVE AL-UABON            TO CMAINTA
006309           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006310           GO TO 8200-SEND-DATAONLY.
006311
006312     IF CMAINTI = 'S'
006313        GO TO 2100-SHOW-REQUEST.
006314
006315     IF NOT MODIFY-CAP
006316         MOVE 'UPDATE'       TO SM-READ
006317         PERFORM 9995-SECURITY-VIOLATION
006318         MOVE ER-0070        TO EMI-ERROR
006319         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006320         GO TO 8100-SEND-INITIAL-MAP.
006321
006322     IF CMAINTL GREATER THAN ZEROS
006323        IF PI-PF6-FUNCTION
006324           IF CMAINTI NOT = 'A'
006325              MOVE AL-UABON  TO CMAINTA
006326              MOVE -1        TO CMAINTL
006327              MOVE ER-2260   TO EMI-ERROR
006328              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006329              GO TO 8200-SEND-DATAONLY.
006330
006331     IF CCERTNOL = ZEROS
006332       AND (CMAINTI = 'C' OR 'K' OR 'D')
006333         NEXT SENTENCE
006334     ELSE
006335         IF CCERTNOL NOT = ZEROS
006336             MOVE AL-UANON       TO CCERTNOA
006337         ELSE
006338             MOVE -1             TO CCERTNOL
006339             MOVE  1             TO SET-CURSOR-SW
006340             MOVE ER-2218       TO EMI-ERROR
006341             MOVE AL-UABON       TO CCERTNOA
006342             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006343
006344     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
006345        NEXT SENTENCE
006346     ELSE
006347        IF CEFFDTL NOT = ZEROS
006348           MOVE AL-UNNON         TO CEFFDTA
006349           MOVE CEFFDTI TO DEEDIT-FIELD
006350           PERFORM 8600-DEEDIT
006351           MOVE 4                TO DC-OPTION-CODE
006352           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
006353           PERFORM 9700-DATE-LINK
006354           IF NO-CONVERSION-ERROR
006355              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
006356              ELSE
006357              MOVE -1            TO CEFFDTL
006358              MOVE  1            TO SET-CURSOR-SW
006359              MOVE ER-2226      TO EMI-ERROR
006360              MOVE AL-UNBON      TO CEFFDTA
006361              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006362          ELSE
006363          MOVE -1                 TO CEFFDTL
006364          MOVE  1                 TO SET-CURSOR-SW
006365          MOVE ER-2220            TO EMI-ERROR
006366          MOVE AL-UNBON           TO CEFFDTA
006367          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006368
006369     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
006370
006371     IF CCERTNOL NOT = ZEROS
006372        MOVE CCERTNOI                TO WS-NEW-PRIME
006373     ELSE
006374        MOVE SPACES                  TO WS-NEW-PRIME.
006375
006376     IF CSUFIXL NOT = ZEROS
006377        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
006378     ELSE
006379        MOVE SPACE                   TO WS-NEW-SUFFIX.
006380
006381     IF CEFFDTL NOT = ZEROS
006382        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
006383     ELSE
006384        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
006385
006386     IF CMAINTI = 'A' OR 'K' OR 'S'
006387        NEXT SENTENCE
006388     ELSE
006389        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
006390        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
006391           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
006392           WS-PB-RECORD-TYPE NOT = '2'
006393           IF CMAINTI = 'C'
006394              MOVE ER-2287          TO EMI-ERROR
006395              MOVE -1               TO CCERTNOL
006396              MOVE AL-UABON         TO CCERTNOA CEFFDTA
006397              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006398              GO TO 8200-SEND-DATAONLY
006399             ELSE
006400              MOVE ER-2260          TO EMI-ERROR
006401              MOVE -1               TO CCERTNOL
006402              MOVE AL-UABON         TO CCERTNOA
006403              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006404              GO TO 8200-SEND-DATAONLY.
006405
006406     IF CMAINTI = 'D'
006407        GO TO 2400-DELETE-CANCEL-ROUTINE.
006408
006409     IF CLSTNML GREATER THAN ZEROS
006410         MOVE AL-UANON           TO CLSTNMA.
006411
006412     EJECT
006413
006414******************************************************************
006415*                                                                *
006416*           E D I T   C A N C E L   C O V E R A G E S            *
006417*                                                                *
006418******************************************************************
006419
006420 2015-EDIT-COVERAGES.
006421     IF CCANDT1L      GREATER THAN ZEROS OR
006422        CREFND1L      GREATER THAN ZEROS OR
006423        CCANDT2L      GREATER THAN ZEROS OR
006424        CREFND2L      GREATER THAN ZEROS OR
006425        CMTHD1L       GREATER THAN ZEROS OR
006426        CMTHD2L       GREATER THAN ZEROS OR
006427        CLIVESL       GREATER THAN ZEROS OR
006428        CPAYEEL       GREATER THAN ZEROS OR
006429        CFORCEL       GREATER THAN ZEROS OR
006430        CBILCDL       GREATER THAN ZEROS OR
006431        CCANREAL      GREATER THAN ZEROS
006432            NEXT SENTENCE
006433         ELSE
006434            GO TO 2030-EDIT-COMPLETE.
006435
006436     IF CCANDT1L = ZEROS
006437        AND (CMAINTI = 'C' OR 'K')
006438        NEXT SENTENCE
006439     ELSE
006440        IF CCANDT1L      GREATER THAN ZEROS
006441            MOVE AL-UNNON            TO CCANDT1A
006442            IF CCANDT1I = SPACES
006443               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
006444            ELSE
006445               MOVE CCANDT1I            TO DEEDIT-FIELD
006446               PERFORM 8600-DEEDIT
006447               IF DEEDIT-FIELD-V0   NUMERIC
006448                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
006449                  MOVE 4                TO DC-OPTION-CODE
006450                  PERFORM 9700-DATE-LINK
006451                  IF NO-CONVERSION-ERROR
006452                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
006453                  ELSE
006454                      MOVE -1        TO CCANDT1L
006455                      MOVE ER-2227   TO EMI-ERROR
006456                      MOVE AL-UNBON  TO CCANDT1A
006457                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006458               ELSE
006459                  MOVE -1         TO CCANDT1L
006460                  MOVE ER-2223    TO EMI-ERROR
006461                  MOVE AL-UNBON   TO CCANDT1A
006462                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006463        ELSE
006464            IF CREFND1L GREATER THAN ZEROS
006465               MOVE -1             TO CCANDT1L
006466               MOVE ER-2222        TO EMI-ERROR
006467               MOVE AL-UNBOF       TO CCANDT1A
006468               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006469
006470     IF CREFND1L = ZEROS
006471        AND (CMAINTI = 'C' OR 'K')
006472         NEXT SENTENCE
006473     ELSE
006474         IF CREFND1L NOT = ZEROS
006475            MOVE AL-UNNON        TO CREFND1A
006476            
      * EXEC CICS BIF DEEDIT
006477*               FIELD  (CREFND1I)
006478*               LENGTH (11)
006479*           END-EXEC
           MOVE 11
             TO DFHEIV11
      *    MOVE '@"L                   #   #00013697' TO DFHEIV0
           MOVE X'40224C202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303133363937' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CREFND1I, 
                 DFHEIV11
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006480            MOVE CREFND1I        TO WS-CREFND1
006481*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
006482*           PERFORM 8600-DEEDIT
006483*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
006484            IF WS-CREFND1  = ZEROS
006485               AND CMAINTI = 'A'
006486             MOVE ER-2437        TO EMI-ERROR
006487             MOVE -1             TO CREFND1L
006488             MOVE AL-UNBON       TO CREFND1A
006489             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006490
006491     IF CCANREAL > +0
006492        MOVE AL-UANON            TO CCANREAA
006493        MOVE CCANREAI            TO PI-CANCEL-REASON-631
006494*       IF CCANREAI = 'R' OR ' '
006495*          CONTINUE
006496*       ELSE
006497*          MOVE ER-9841        TO EMI-ERROR
006498*          MOVE -1             TO CCANREAL
006499*          MOVE AL-UABON       TO CCANREAA
006500*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006501*       END-IF
006502     END-IF
006503
006504     IF CMTHD1L EQUAL +0
006505        NEXT SENTENCE
006506     ELSE
006507        IF CMTHD1L NOT = +0
006508           MOVE AL-UNNON        TO CMTHD1A
006509           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
006510                         OR '5' OR '6' OR '8' OR '9'
006511                         OR 'R' OR ' '
006512              NEXT SENTENCE
006513           ELSE
006514              MOVE ER-0582        TO EMI-ERROR
006515              MOVE -1             TO CMTHD1L
006516              MOVE AL-UNBON       TO CMTHD1A
006517              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006518
006519     IF CCANDT2L = ZEROS
006520        AND (CMAINTI = 'C' OR 'K')
006521         NEXT SENTENCE
006522     ELSE
006523         IF CCANDT2L  GREATER THAN ZEROS
006524             MOVE AL-UNNON       TO CCANDT2A
006525             IF CCANDT2I = SPACES
006526                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
006527             ELSE
006528                MOVE CCANDT2I       TO DEEDIT-FIELD
006529                PERFORM 8600-DEEDIT
006530                IF DEEDIT-FIELD-V0   NUMERIC
006531                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
006532                   MOVE 4                TO DC-OPTION-CODE
006533                   PERFORM 9700-DATE-LINK
006534                   IF NO-CONVERSION-ERROR
006535                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
006536                   ELSE
006537                      MOVE -1       TO CCANDT2L
006538                      MOVE ER-2227  TO EMI-ERROR
006539                      MOVE AL-UNBON TO CCANDT2A
006540                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006541                ELSE
006542                   MOVE -1         TO CCANDT2L
006543                   MOVE ER-2223    TO EMI-ERROR
006544                   MOVE AL-UNBON   TO CCANDT2A
006545                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006546         ELSE
006547            IF CREFND2L GREATER THAN ZEROS
006548               MOVE -1             TO CCANDT2L
006549               MOVE ER-2222        TO EMI-ERROR
006550               MOVE AL-UNBOF       TO CCANDT2A
006551               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006552
006553     IF CREFND2L = ZEROS
006554        AND (CMAINTI = 'C' OR 'K')
006555         NEXT SENTENCE
006556     ELSE
006557         IF CREFND2L NOT = ZEROS
006558            MOVE AL-UNNON        TO CREFND2A
006559            
      * EXEC CICS BIF DEEDIT
006560*               FIELD  (CREFND2I)
006561*               LENGTH (11)
006562*           END-EXEC
           MOVE 11
             TO DFHEIV11
      *    MOVE '@"L                   #   #00013780' TO DFHEIV0
           MOVE X'40224C202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303133373830' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CREFND2I, 
                 DFHEIV11
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
006563            MOVE CREFND2I        TO WS-CREFND2
006564*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
006565*           PERFORM 8600-DEEDIT
006566*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
006567            IF WS-CREFND2  = ZEROS
006568               AND CMAINTI = 'A'
006569             MOVE ER-2437        TO EMI-ERROR
006570             MOVE -1             TO CREFND2L
006571             MOVE AL-UNBON       TO CREFND2A
006572             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006573
006574     IF CMTHD2L EQUAL +0
006575        NEXT SENTENCE
006576     ELSE
006577        IF CMTHD2L NOT = +0
006578           MOVE AL-UNNON        TO CMTHD2A
006579           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
006580                         OR '5' OR '6' OR '8' OR '9'
006581                         OR ' ' OR 'R'
006582              NEXT SENTENCE
006583           ELSE
006584              MOVE ER-0582        TO EMI-ERROR
006585              MOVE -1             TO CMTHD2L
006586              MOVE AL-UNBON       TO CMTHD2A
006587              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006588
006589     IF CLIVESL GREATER THAN ZEROS
006590         MOVE CLIVESI            TO DEEDIT-FIELD
006591         PERFORM 8600-DEEDIT
006592         IF DEEDIT-FIELD-V0 NUMERIC
006593             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
006594             MOVE AL-UNNON       TO CLIVESA
006595         ELSE
006596             MOVE -1             TO CLIVESL
006597             MOVE AL-UNBON       TO CLIVESA
006598             MOVE ER-2223        TO EMI-ERROR
006599             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006600
006601     IF CFORCEL  NOT = ZEROS
006602         IF FORCE-CAP
006603            MOVE AL-UANON            TO CFORCEA
006604         ELSE
006605            MOVE ER-2945             TO EMI-ERROR
006606            MOVE AL-UABON            TO CFORCEA
006607            MOVE -1                  TO CFORCEL
006608            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006609
006610     IF CPAYEEL GREATER THAN ZEROS
006611        MOVE AL-UANON            TO CPAYEEA.
006612
006613     IF CBILCDL NOT = ZEROS
006614        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
006615                             AND 'A' AND 'B' AND 'E'
006616           MOVE ER-2225              TO EMI-ERROR
006617           MOVE AL-UABON             TO CBILCDA
006618           MOVE -1                   TO CBILCDL
006619           MOVE  1                   TO SET-CURSOR-SW
006620           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006621        ELSE
006622           MOVE AL-UANON             TO CBILCDA.
006623
006624 2030-EDIT-COMPLETE.
006625     IF PI-CANCEL-REASON-631 > SPACES
006626        PERFORM 2050-CHECK-CANCEL-REASON THRU 2050-EXIT
006627     ELSE
006628        MOVE ER-1591        TO EMI-ERROR
006629        MOVE -1             TO CCANREAL
006630        MOVE AL-UABON       TO CCANREAA
006631        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006632     END-IF
006633
006634     IF EMI-ERROR = ZEROS
006635         NEXT SENTENCE
006636     ELSE
006637         GO TO 8200-SEND-DATAONLY.
006638
006639     IF CMAINTI = 'A'
006640        GO TO 2200-ADD-CANCEL-ROUTINE.
006641
006642     IF CMAINTI = 'C'
006643        GO TO 2300-CHANGE-CANCEL-ROUTINE.
006644
006645     GO TO 2900-REWRITE-CAN-CERT-KEY.
006646
006647     EJECT
006648 2050-CHECK-CANCEL-REASON.
006649
006650*      Read Napersoft CancelReasons Lookup Table
006651     MOVE 'naperadmin'           TO USR
006652     MOVE 'cCm8naper'            TO PASS
006653     IF WS-KIXHOST = 'logictest'
006654        MOVE 'HOVTSTDB01_NaperRepo'
006655                                 TO SVR
006656        MOVE '1029'              TO WS-LOOKUPID
006657     ELSE
006658        MOVE 'SDVDB01_NaperRepo' TO SVR
006659        MOVE '1029'              TO WS-LOOKUPID
006660     END-IF
006661
006662     MOVE SPACES                 TO WS-LOOKUP-VALUE
006663
006664     PERFORM 9000-CONNECT-TO-DB  THRU 9000-EXIT
006665     MOVE PI-CANCEL-REASON-631 TO WS-LOOKUPNAME
006666
006668     EXEC SQL
                 SELECT LOOKUPVALUE
006669             INTO :WS-LOOKUP-VALUE
006670             FROM LOOKUPVALUES
006671               WHERE LOOKUPID = :WS-LOOKUPID
006672                 AND LOOKUPNAME = :WS-LOOKUPNAME
006673     END-EXEC
006674
006675     IF SQLCODE = 0
006676        CONTINUE
006677     ELSE
006678     IF SQLCODE = 100
006679        MOVE ER-1590        TO EMI-ERROR
006680        MOVE -1             TO CCANREAL
006681        MOVE AL-UABON       TO CCANREAA
006682        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006683     ELSE
006684        DISPLAY "ERROR: INVALID CancelReasons Lookup Table SELECT"
006685        DISPLAY ' SQL RETURN CODE ' SQLCODE
006686        DISPLAY ' SQL ERR MESS    ' SQLERRMC
006687     END-IF.
006688
006689     PERFORM 9050-DISCONNECT THRU 9050-EXIT.
006690
006691 2050-EXIT.
006692     EXIT.
006693
006694******************************************************************
006695*                                                                *
006696*                   S H O W   C A N C E L                        *
006697*                                                                *
006698******************************************************************
006699
006700 2100-SHOW-REQUEST.
006701     MOVE 'S'                    TO PI-MAINT-FUNCTION.
006702
006703     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
006704        MOVE -1                  TO CMAINTL
006705        GO TO 8200-SEND-DATAONLY.
006706
006707     MOVE CCERTNOI            TO WS-NEW-PRIME.
006708
006709     IF CSUFIXL NOT = ZEROS
006710        MOVE CSUFIXI          TO WS-NEW-SUFFIX
006711       ELSE
006712        MOVE SPACE            TO WS-NEW-SUFFIX.
006713
006714     MOVE CEFFDTI                TO DEEDIT-FIELD.
006715     PERFORM 8600-DEEDIT.
006716     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
006717     MOVE '4'                    TO DC-OPTION-CODE.
006718     PERFORM 9700-DATE-LINK.
006719     IF DATE-CONVERSION-ERROR
006720        MOVE ER-0348             TO EMI-ERROR
006721        MOVE -1                  TO CEFFDTL
006722        MOVE AL-UABON            TO CEFFDTA
006723        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006724        GO TO 8200-SEND-DATAONLY
006725     ELSE
006726        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
006727        MOVE AL-UANON            TO CEFFDTA
006728        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
006729
006730     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
006731
006732     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
006733        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
006734        MOVE 'Y'                    TO WS-SHOW-SW
006735        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
006736           GO TO 4100-BROWSE-PRIMARY-FORWARD
006737        ELSE
006738           IF PI-FILE-BROWSE
006739              GO TO 4300-BROWSE-FILE-FORWARD
006740           ELSE
006741              IF PI-CSR-BROWSE
006742                 GO TO 4200-BROWSE-CSR-FORWARD
006743              ELSE
006744                 GO TO 4000-BROWSE-DETAIL-FORWARD
006745     ELSE
006746        GO TO 3900-RE-DISPLAY-RECORD.
006747
006748     EJECT
006749
006750
006751******************************************************************
006752*                                                                *
006753*            A D D   C A N C E L   R O U T I N E                 *
006754*                                                                *
006755******************************************************************
006756
006757 2200-ADD-CANCEL-ROUTINE.
006758     MOVE 'A'                    TO PI-MAINT-FUNCTION.
006759
006760     
      * EXEC CICS GETMAIN
006761*        SET     (ADDRESS OF PENDING-BUSINESS)
006762*        LENGTH  (ERPNDB-RECORD-LENGTH)
006763*    END-EXEC.
      *    MOVE '," L                  $   #00013981' TO DFHEIV0
           MOVE X'2C22204C2020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303133393831' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 ERPNDB-RECORD-LENGTH, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
006764
006765     
      * EXEC CICS HANDLE CONDITION
006766*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
006767*    END-EXEC.
      *    MOVE '"$I                   ! 3 #00013986' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3320233030303133393836' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
006768
006769     MOVE PI-PREV-KEY            TO ERPNDB-KEY
006770     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
006771     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
006772
006773     
      * EXEC CICS READ
006774*        INTO    (PENDING-BUSINESS)
006775*        DATASET (FILE-ID-ERPNDB)
006776*        RIDFLD  (ERPNDB-KEY)
006777*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&"IL       E          (   #00013994' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303133393934' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
006778
006779     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
006780
006781     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
006782     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
006783     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
006784     MOVE SPACES                 TO PENDING-BUSINESS.
006785     MOVE 'PB'                   TO PB-RECORD-ID.
006786     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
006787     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
006788     MOVE SPACES                 TO PB-CERT-SFX.
006789     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
006790     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
006791                                    PB-ALT-CHG-SEQ-NO.
006792
006793     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
006794     MOVE CCERTNOI               TO PB-CERT-PRIME.
006795     MOVE '2'                    TO PB-RECORD-TYPE.
006796
006797     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
006798     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
006799
006800
006801     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
006802                                    PB-ALT-CHG-SEQ-NO
006803                                    PB-C-LF-REF-CALC
006804                                    PB-C-AH-REF-CALC
006805                                    PB-C-LF-RFND-CLP
006806                                    PB-C-AH-RFND-CLP
006807                                    PB-CI-INSURED-AGE
006808                                    PB-CI-LF-TERM
006809                                    PB-CI-AH-TERM
006810                                    PB-CI-LF-BENEFIT-CD
006811                                    PB-CI-LF-BENEFIT-AMT
006812                                    PB-CI-LF-ALT-BENEFIT-AMT
006813                                    PB-CI-LF-PREMIUM-AMT
006814                                    PB-CI-LF-ALT-PREMIUM-AMT
006815                                    PB-CI-AH-BENEFIT-CD
006816                                    PB-CI-AH-BENEFIT-AMT
006817                                    PB-CI-AH-PREMIUM-AMT
006818                                    PB-CI-PAY-FREQUENCY
006819                                    PB-CI-LOAN-APR
006820                                    PB-CI-LOAN-TERM
006821                                    PB-CI-LIFE-COMMISSION
006822                                    PB-CI-AH-COMMISSION
006823                                    PB-CI-CURR-SEQ
006824                                    PB-CI-AH-CANCEL-AMT
006825                                    PB-CI-LF-CANCEL-AMT
006826                                    PB-CI-RATE-DEV-PCT-LF
006827                                    PB-CI-RATE-DEV-PCT-AH
006828                                    PB-CI-EXTENTION-DAYS
006829                                    PB-CI-TERM-IN-DAYS
006830                                    PB-CI-LIVES
006831                                    PB-CI-LF-CRIT-PER
006832                                    PB-CI-AH-CRIT-PER
006833                                    PB-C-LF-REM-TERM
006834                                    PB-C-AH-REM-TERM
006835                                    PB-CHG-COUNT
006836                                    PB-LF-BILLED-AMTS
006837                                    PB-AH-BILLED-AMTS
006838                                    PB-C-INT-ON-REFS
006839*                                   PB-C-MICROFILM-NO
006840                                    PB-CALC-TOLERANCE.
006841
006842     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
006843                                    PB-CI-AH-SETTLEMENT-DT
006844                                    PB-CI-DEATH-DT
006845                                    PB-CI-LF-PRIOR-CANCEL-DT
006846                                    PB-CI-AH-PRIOR-CANCEL-DT
006847                                    PB-CI-ENTRY-DT
006848                                    PB-CI-LF-EXPIRE-DT
006849                                    PB-CI-AH-EXPIRE-DT
006850                                    PB-CI-LOAN-1ST-PMT-DT
006851                                    PB-C-LF-CANCEL-DT
006852                                    PB-C-AH-CANCEL-DT
006853                                    PB-CREDIT-ACCEPT-DT
006854                                    PB-BILLED-DT
006855                                    PB-ACCT-EFF-DT
006856                                    PB-ACCT-EXP-DT.
006857
006858     MOVE 'X'                    TO PB-FATAL-FLAG.
006859
006860     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
006861
006862     IF CSUFIXL     GREATER THAN ZEROS
006863        MOVE CSUFIXI             TO PB-CERT-SFX.
006864
006865*    IF CMICRNOL  GREATER  ZEROS
006866*        IF CMICRNOI  NUMERIC
006867*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
006868*            MOVE AL-UNNON       TO  CMICRNOA
006869*        ELSE
006870*            MOVE -1             TO  CMICRNOL
006871*            MOVE AL-UNBON       TO  CMICRNOA
006872*            MOVE ER-2701        TO  EMI-ERROR
006873*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006874
006875     IF CLSTNML     GREATER THAN ZEROS
006876        MOVE CLSTNMI             TO PB-C-LAST-NAME.
006877
006878
006879     IF CCANREAL > ZEROS
006880        MOVE CCANREAI            TO PB-C-CANCEL-REASON
006881        MOVE CCANREAI            TO PI-CANCEL-REASON-631
006882     END-IF
006883
006884     IF CCANDT1L    GREATER THAN ZEROS
006885        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
006886
006887     IF CCANDT2L    GREATER THAN ZEROS
006888        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
006889
006890     IF CMTHD1L    GREATER THAN +0
006891        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
006892
006893     IF CMTHD2L    GREATER THAN +0
006894        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
006895
006896     IF CREFND1L    GREATER THAN ZEROS
006897        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
006898        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
006899     ELSE
006900        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
006901
006902     IF CREFND2L    GREATER THAN ZEROS
006903        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
006904        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
006905     ELSE
006906        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
006907
006908     IF CLIVESL     GREATER THAN ZEROS
006909        MOVE WS-CLIVES           TO PB-C-LIVES
006910     ELSE
006911        MOVE ZEROS               TO PB-C-LIVES.
006912
006913     IF CPAYEEL     GREATER THAN ZEROS
006914        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
006915
006916     IF CFORCEL     GREATER THAN ZEROS
006917        MOVE CFORCEI             TO PB-FORCE-CODE.
006918
006919     IF CBILCDL     GREATER THAN ZEROS
006920        MOVE CBILCDI             TO PB-RECORD-BILL.
006921
006922*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
006923
006924 2260-WRITE-PB-RECORD.
006925     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
006926                                    PB-INPUT-BY.
006927     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
006928     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
006929                                    PB-INPUT-DT.
006930
006931     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
006932     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
006933                                    PB-CONTROL-BY-ORIG-BATCH.
006934
006935     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
006936     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
006937     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
006938     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
006939     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
006940
006941     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
006942
006943     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
006944
006945     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
006946     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
006947     MOVE PB-SV-STATE            TO PI-SV-STATE.
006948
006949     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
006950     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
006951
006952 2275-WRITE-PENDING-BUSINESS.
006953     MOVE 'A'                    TO JP-RECORD-TYPE.
006954     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
006955     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
006956     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
006957
006958     
      * EXEC CICS HANDLE CONDITION
006959*        DUPREC (2290-DUPLICATE-ALT-INDEX)
006960*    END-EXEC.
      *    MOVE '"$%                   ! 4 #00014179' TO DFHEIV0
           MOVE X'222425202020202020202020' &
                X'202020202020202020202120' &
                X'3420233030303134313739' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
006961
006962     
      * EXEC CICS WRITE
006963*        DATASET (FILE-ID-ERPNDB)
006964*        FROM    (PENDING-BUSINESS)
006965*        RIDFLD  (PB-CONTROL-PRIMARY)
006966*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00014183' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'2020233030303134313833' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 PB-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
006967
006968     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
006969
006970     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Add
006971
006972******************************************************************
006973*       A D D  O R I G I N A L  C E R T  I N F O                 *
006974******************************************************************
006975
006976*    display ' made it to add orig CANCEL cert '
006977     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
006978     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
006979     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
006980     MOVE PB-SV-STATE            TO ELCERT-STATE.
006981
006982     
      * EXEC CICS READ
006983*        SET     (ADDRESS OF CERTIFICATE-MASTER)
006984*        DATASET (FILE-ID-ELCERT)
006985*        RIDFLD  (ELCERT-KEY)
006986*        RESP    (WS-RESPONSE)
006987*    END-EXEC.
      *    MOVE '&"S        E          (  N#00014203' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303134323033' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CERTIFICATE-MASTER TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
006988
006989     IF NOT RESP-NORMAL
006990        GO TO 2276-BYPASS-CRTO
006991     END-IF
006992
006993     MOVE ELCERT-KEY             TO ERMAIL-KEY
006994     MOVE ' '                    TO WS-ERMAIL-SW
006995
006996     
      * EXEC CICS READ
006997*       DATASET   (FILE-ID-ERMAIL)
006998*       SET       (ADDRESS OF MAILING-DATA)
006999*       RIDFLD    (ERMAIL-KEY)
007000*       RESP      (WS-RESPONSE)
007001*    END-EXEC
      *    MOVE '&"S        E          (  N#00014217' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303134323137' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERMAIL, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERMAIL-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF MAILING-DATA TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
007002
007003     IF RESP-NORMAL
007004        SET ERMAIL-FOUND TO TRUE
007005     END-IF
007006
007007     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
007008
007009     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
007010     MOVE 'OC'                   TO OC-RECORD-ID
007011     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
007012                                 TO OC-CONTROL-PRIMARY (1:33)
007013     MOVE 'I'                    TO OC-RECORD-TYPE
007014     MOVE +4096                  TO OC-KEY-SEQ-NO
007015     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
007016     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
007017     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
007018
007019     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
007020     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
007021     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
007022     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
007023     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
007024     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
007025     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
007026     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
007027     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
007028     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
007029     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
007030     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
007031     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
007032     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
007033     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
007034     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
007035     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
007036     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
007037     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
007038     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
007039     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
007040     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
007041     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
007042     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
007043     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
007044     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
007045     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
007046     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
007047     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
007048     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
007049     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
007050     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
007051
007052     IF ERMAIL-FOUND
007053        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
007054     END-IF
007055     IF NOT CERT-TRL-REC-NOT-FOUND
007056        MOVE CS-INS-AGE-DEFAULT-FLAG TO
007057                           OC-INS-AGE-DEFAULT-FLAG
007058        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
007059                           OC-JNT-AGE-DEFAULT-FLAG
007060     END-IF
007061     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
007062     .
007063 2275-WRITE-ELCRTO.
007064
007065     
      * EXEC CICS WRITE
007066*       DATASET   ('ELCRTO')
007067*       FROM      (ORIGINAL-CERTIFICATE)
007068*       RIDFLD    (OC-CONTROL-PRIMARY)
007069*       RESP      (WS-RESPONSE)
007070*    END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&$ L                  ''  N#00014286' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'204E233030303134323836' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 OC-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
007071
007072*    display ' just wrote 2275 ' ws-response
007073     IF RESP-DUPKEY
007074        SUBTRACT +1              FROM OC-KEY-SEQ-NO
007075        GO TO 2275-WRITE-ELCRTO
007076     ELSE
007077        IF NOT RESP-NORMAL
007078           MOVE -1               TO BMAINTL
007079           MOVE ER-7450          TO EMI-ERROR
007080           PERFORM 9900-ERROR-FORMAT
007081                                 THRU 9900-EXIT
007082           GO TO 8200-SEND-DATAONLY
007083        END-IF
007084     END-IF.
007085
007086 2276-BYPASS-CRTO.
007087******************************************************************
007088*       U P D A T E   T H E   B A T C H   H E A D E R            *
007089******************************************************************
007090
007091     
      * EXEC CICS READ
007092*        INTO    (PENDING-BUSINESS)
007093*        DATASET (FILE-ID-ERPNDB)
007094*        RIDFLD  (ERPNDB-KEY)
007095*        UPDATE
007096*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00014312' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303134333132' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007097
007098     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
007099     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
007100     MOVE 'B'                    TO JP-RECORD-TYPE.
007101     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
007102
007103     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
007104
007105     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
007106
007107     
      * EXEC CICS REWRITE
007108*        DATASET (FILE-ID-ERPNDB)
007109*        FROM    (PENDING-BUSINESS)
007110*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00014328' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303134333238' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007111
007112     MOVE 'C'                    TO JP-RECORD-TYPE.
007113     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
007114
007115     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
007116
007117     IF WS-ERRORS-PRESENT
007118        GO TO 3900-RE-DISPLAY-RECORD.
007119
007120     MOVE ZEROS                  TO EMI-ERROR.
007121     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007122     MOVE LOW-VALUES             TO EL631CI.
007123     MOVE  -1                    TO CMAINTL.
007124     GO TO 8100-SEND-INITIAL-MAP.
007125
007126 2280-BATCH-HDR-NOT-FOUND.
007127     MOVE -1                     TO BMAINTL.
007128     MOVE ER-7450                TO EMI-ERROR.
007129     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007130     GO TO 8200-SEND-DATAONLY.
007131
007132 2290-DUPLICATE-ALT-INDEX.
007133
007134******************************************************************
007135*                                                                *
007136*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
007137*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
007138*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
007139*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
007140*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
007141*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
007142*                                                                *
007143******************************************************************
007144
007145     IF LCP-ONCTR-02 =  0
007146         ADD 1 TO LCP-ONCTR-02
007147        MOVE +0                  TO WS-SEQ-NO-COUNTER.
007148
007149     ADD +1                      TO WS-SEQ-NO-COUNTER.
007150
007151     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
007152         NEXT SENTENCE
007153     ELSE
007154         ADD +1 TO PB-BATCH-SEQ-NO
007155                   PB-CSR-BATCH-SEQ-NO
007156         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
007157         GO TO 2275-WRITE-PENDING-BUSINESS.
007158
007159     MOVE -1                     TO CCERTNOL.
007160     MOVE AL-UABON               TO CCERTNOA.
007161     MOVE AL-UNBON               TO CEFFDTA.
007162
007163     MOVE 1                      TO EMI-SUB
007164                                    EMI-SWITCH1
007165                                    EMI-SWITCH-AREA-1
007166                                    EMI-SWITCH-AREA-2.
007167
007168     MOVE SPACES                 TO EMI-ERROR-LINES.
007169
007170     
      * EXEC CICS SYNCPOINT ROLLBACK
007171*    END-EXEC.
      *    MOVE '6"R                   !   #00014391' TO DFHEIV0
           MOVE X'362252202020202020202020' &
                X'202020202020202020202120' &
                X'2020233030303134333931' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007172
007173     MOVE ER-2247                TO EMI-ERROR.
007174     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007175     GO TO 8200-SEND-DATAONLY.
007176
007177     EJECT
007178
007179******************************************************************
007180*                                                                *
007181*          C H A N G E   C A N C E L   R O U T I N E             *
007182*                                                                *
007183******************************************************************
007184
007185***************************************************************
007186*                                                             *
007187*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
007188*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
007189*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
007190*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
007191*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
007192*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
007193*     5. LINK TO THE EDIT ROUTINE.                            *
007194*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
007195*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
007196*              THE EDIT ROUTINE.                              *
007197*     7. REWRITE THE NEW ISSUE                                *
007198*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
007199*                                                             *
007200***************************************************************
007201 2300-CHANGE-CANCEL-ROUTINE.
007202     MOVE 'C'                    TO PI-MAINT-FUNCTION.
007203
007204     IF CCHGL NOT = ZEROS
007205        MOVE ER-2196             TO EMI-ERROR
007206        MOVE AL-UABON            TO CMAINTA
007207        MOVE -1                  TO CMAINTL
007208        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007209        GO TO 8200-SEND-DATAONLY.
007210
007211     MOVE CCERTNOI               TO WS-NEW-PRIME.
007212
007213     IF CSUFIXL NOT = ZEROS
007214        MOVE CSUFIXI             TO WS-NEW-SUFFIX
007215     ELSE
007216        MOVE SPACE               TO WS-NEW-SUFFIX.
007217
007218     MOVE CEFFDTI                TO DEEDIT-FIELD.
007219     PERFORM 8600-DEEDIT.
007220     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
007221     MOVE '4'                    TO DC-OPTION-CODE.
007222
007223     PERFORM 9700-DATE-LINK.
007224
007225     IF DATE-CONVERSION-ERROR
007226        MOVE ER-0348             TO EMI-ERROR
007227        MOVE -1                  TO CEFFDTL
007228        MOVE AL-UABON            TO CEFFDTA
007229        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007230        GO TO 8200-SEND-DATAONLY
007231     ELSE
007232        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
007233        MOVE AL-UANON            TO CEFFDTA
007234        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
007235
007236 2325-PROCESS-CANCEL-CHANGES.
007237     
      * EXEC CICS HANDLE CONDITION
007238*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
007239*    END-EXEC.
      *    MOVE '"$I                   ! 5 #00014458' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3520233030303134343538' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007240
007241     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
007242     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
007243     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
007244
007245     
      * EXEC CICS GETMAIN
007246*        SET      (ADDRESS OF PENDING-BUSINESS)
007247*        LENGTH   (ERPNDB-RECORD-LENGTH)
007248*        INITIMG  (GETMAIN-SPACE)
007249*     END-EXEC.
      *    MOVE ',"IL                  $   #00014466' TO DFHEIV0
           MOVE X'2C22494C2020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303134343636' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 ERPNDB-RECORD-LENGTH, 
                 GETMAIN-SPACE
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007250
007251     
      * EXEC CICS READ
007252*        INTO    (PENDING-BUSINESS)
007253*        DATASET (FILE-ID-ERPNDB)
007254*        RIDFLD  (ERPNDB-KEY)
007255*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&"IL       E          (   #00014472' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303134343732' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007256
007257     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
007258
007259     
      * EXEC CICS HANDLE CONDITION
007260*         NOTFND     (2385-REC-NOT-FOUND)
007261*    END-EXEC.
      *    MOVE '"$I                   ! 6 #00014480' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3620233030303134343830' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007262
007263**********************************************************
007264*      DONT READ THE RECORD FOR UPDATE UNTIL             *
007265*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
007266**********************************************************
007267
007268     
      * EXEC CICS READ
007269*        DATASET (FILE-ID-ERPNDB)
007270*        INTO    (PENDING-BUSINESS)
007271*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
007272*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&"IL       E          (   #00014489' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303134343839' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 PI-PREV-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007273
007274********** DO NOT ALLOW CHANGES IF THRU A/R
007275     IF BMAINTI = 'C'
007276         IF PB-EL860-INTERNAL-PROCESS
007277             MOVE ER-4005          TO EMI-ERROR
007278             MOVE -1               TO BMAINTL
007279             MOVE AL-UABON         TO BMAINTA
007280             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007281             GO TO 8200-SEND-DATAONLY.
007282**********
007283
007284     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
007285        MOVE -1                 TO CMAINTL
007286        MOVE ER-2197            TO EMI-ERROR
007287        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007288        GO TO 8200-SEND-DATAONLY.
007289
007290     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
007291        MOVE ER-2196             TO EMI-ERROR
007292        MOVE AL-UABON            TO CMAINTA
007293        MOVE -1                  TO CMAINTL
007294        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007295        GO TO 8200-SEND-DATAONLY.
007296
007297     MOVE ZEROS                  TO WS-SEQ-SAVE.
007298
007299     IF PB-BILLED-DT = LOW-VALUES AND
007300        PB-CHG-COUNT = ZEROS
007301        NEXT SENTENCE
007302     ELSE
007303        IF (CREFND1L GREATER THAN ZEROS AND
007304            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
007305           OR
007306           (CREFND2L GREATER THAN ZEROS AND
007307            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
007308           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
007309
007310     if ((crefnd1l <> zeros)
007311        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
007312                      or
007313        ((crefnd2l <> zeros)
007314        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
007315        continue
007316     else
007317        go to 2330-continue-change
007318     end-if
007319
007320     move zeros                  to ws-check-amts
007321     move ' '                    to ws-stop-sw
007322                                    ws-check-sw
007323                                    ws-any-check-sw
007324                                    ws-proc-check-sw
007325                                    ws-chek-browse-sw
007326
007327     perform 2500-browse-checks  thru 2500-exit
007328
007329     if i-have-processed-checks
007330        or i-have-checks
007331        continue
007332     else
007333        go to 2330-continue-change
007334     end-if
007335
007336     if crefnd1l <> zeros
007337        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
007338        move ws-crefnd1 to ws-new-ref-total
007339     else
007340        move pb-c-lf-cancel-amt  to ws-new-ref-total
007341     end-if
007342     if crefnd2l <> zeros
007343        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
007344        compute ws-new-ref-total = ws-new-ref-total +
007345           ws-crefnd2
007346     else
007347        compute ws-new-ref-total = ws-new-ref-total +
007348           pb-c-ah-cancel-amt
007349     end-if
007350
007351     if zeros = (ws-lf-diff + ws-ah-diff)
007352        move er-3449             to emi-error
007353        perform 9900-error-format thru 9900-exit
007354        go to 2330-continue-change
007355     end-if
007356
007357     if (ws-new-ref-total < ws-check-amts)
007358        and (pb-c-refund-sw = 'Y')
007359        move er-3447             to emi-error
007360        perform 9900-error-format thru 9900-exit
007361        move al-uabon            to cmainta
007362        move -1                  to cmaintl
007363        go to 8200-send-dataonly
007364     end-if
007365
007366     if (ws-new-ref-total > ws-check-amts)
007367        and (ws-check-amts not = zeros)
007368        move er-3448             to emi-error
007369        move al-uabon            to crefnd1a
007370                                    crefnd2a
007371        perform 9900-error-format thru 9900-exit
007372     end-if
007373
007374*     if (ws-lf-diff + ws-ah-diff) < zeros
007375*        move er-3447             to emi-error
007376*        perform 9900-error-format thru 9900-exit
007377*        move al-uabon            to cmainta
007378*        move -1                  to cmaintl
007379*        go to 8200-send-dataonly
007380*     end-if
007381
007382     .
007383 2330-continue-change.
007384
007385     
      * EXEC CICS READ
007386*        DATASET (FILE-ID-ERPNDB)
007387*        INTO    (PENDING-BUSINESS)
007388*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
007389*        UPDATE
007390*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00014606' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303134363036' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 PI-PREV-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007391
007392     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
007393     MOVE 'B'                    TO JP-RECORD-TYPE
007394     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
007395     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
007396
007397*    PERFORM 8400-LOG-JOURNAL-RECORD  *>Move closer to rewrite
007398
007399     IF PB-BILLED-DT NOT = LOW-VALUES OR
007400          PB-CHG-COUNT NOT = ZEROS
007401        IF (CREFND1L GREATER THAN ZEROS AND
007402            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
007403           OR
007404           (CREFND2L GREATER THAN ZEROS AND
007405            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
007406            ADD +1                      TO PB-CHG-COUNT
007407            MOVE LOW-VALUES             TO PB-BILLED-DT.
007408
007409*    IF CMICRNOL  GREATER  ZEROS
007410*        IF CMICRNOI  NUMERIC
007411*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
007412*            MOVE AL-UNNON       TO  CMICRNOA
007413*        ELSE
007414*            MOVE -1             TO  CMICRNOL
007415*            MOVE AL-UNBON       TO  CMICRNOA
007416*            MOVE ER-2701        TO  EMI-ERROR
007417*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007418
007419     IF CSUFIXL GREATER THAN ZEROS
007420        MOVE CSUFIXI             TO PB-CERT-SFX.
007421
007422     IF CLSTNML GREATER THAN ZEROS
007423         MOVE CLSTNMI            TO PB-C-LAST-NAME.
007424
007425
007426     IF CCANREAL > ZEROS
007427        MOVE CCANREAI            TO PB-C-CANCEL-REASON
007428        MOVE CCANREAI            TO PI-CANCEL-REASON-631
007429     END-IF
007430
007431     IF CCANDT1L    GREATER THAN ZEROS
007432        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
007433
007434     IF CCANDT2L    GREATER THAN ZEROS
007435        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
007436
007437     IF CMTHD1L    GREATER THAN +0
007438        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
007439
007440     IF CMTHD2L    GREATER THAN +0
007441        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
007442
007443     IF CREFND1L    GREATER THAN ZEROS
007444        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
007445        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
007446        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
007447        MOVE SPACE               TO PB-C-LF-CALC-REQ.
007448
007449     IF CREFND2L    GREATER THAN ZEROS
007450        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
007451        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
007452        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
007453        MOVE SPACE               TO PB-C-AH-CALC-REQ.
007454
007455     IF CLIVESL     GREATER THAN ZEROS
007456        MOVE WS-CLIVES           TO PB-C-LIVES.
007457
007458     IF CPAYEEL     GREATER THAN ZEROS
007459        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
007460
007461     IF CFORCEL     GREATER THAN ZEROS
007462        MOVE CFORCEI             TO PB-FORCE-CODE.
007463
007464     IF CBILCDL     GREATER THAN ZEROS
007465        MOVE CBILCDI             TO PB-RECORD-BILL.
007466
007467 2360-REWRITE-PB-RECORD.
007468     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
007469     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
007470     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
007471*    MOVE 'C'                    TO JP-RECORD-TYPE.
007472*    MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
007473     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
007474*    MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
007475
007476     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
007477
007478     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
007479     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
007480
007481     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
007482
007483     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
007484
007485     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
007486     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
007487     MOVE PB-SV-STATE            TO PI-SV-STATE.
007488
007489     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
007490     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
007491
007492 2375-REWRITE-PENDING-BUSINESS.
007493
007494     PERFORM 8400-LOG-JOURNAL-RECORD  *>Before Cancel Image
007495
007496     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
007497     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
007498     MOVE 'C'                    TO JP-RECORD-TYPE.
007499     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
007500
007501     
      * EXEC CICS REWRITE
007502*        DATASET (FILE-ID-ERPNDB)
007503*        FROM    (PENDING-BUSINESS)
007504*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00014722' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303134373232' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007505
007506     PERFORM 8400-LOG-JOURNAL-RECORD  *> After Cancel Image
007507
007508******************************************************************
007509*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
007510******************************************************************
007511
007512     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
007513     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
007514     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
007515     MOVE PB-SV-STATE            TO ELCERT-STATE.
007516
007517     
      * EXEC CICS READ
007518*        SET     (ADDRESS OF CERTIFICATE-MASTER)
007519*        DATASET (FILE-ID-ELCERT)
007520*        RIDFLD  (ELCERT-KEY)
007521*        RESP    (WS-RESPONSE)
007522*    END-EXEC.
      *    MOVE '&"S        E          (  N#00014738' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303134373338' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CERTIFICATE-MASTER TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007523
007524     IF NOT RESP-NORMAL
007525        GO TO 2376-BYPASS-CRTO
007526     END-IF
007527
007528
007529     MOVE ELCERT-KEY             TO ERMAIL-KEY
007530     MOVE ' '                    TO WS-ERMAIL-SW
007531
007532     
      * EXEC CICS READ
007533*       DATASET   (FILE-ID-ERMAIL)
007534*       SET       (ADDRESS OF MAILING-DATA)
007535*       RIDFLD    (ERMAIL-KEY)
007536*       RESP      (WS-RESPONSE)
007537*    END-EXEC
      *    MOVE '&"S        E          (  N#00014753' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303134373533' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERMAIL, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERMAIL-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF MAILING-DATA TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
007538
007539     IF RESP-NORMAL
007540        SET ERMAIL-FOUND TO TRUE
007541     END-IF
007542
007543     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
007544
007545     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
007546                                 TO ELCRTO-KEY
007547     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
007548     MOVE +0                     TO ELCRTO-SEQ-NO
007549
007550     
      * EXEC CICS READ
007551*       DATASET   ('ELCRTO')
007552*       INTO      (ORIGINAL-CERTIFICATE)
007553*       RIDFLD    (ELCRTO-KEY)
007554*       GTEQ
007555*       RESP      (WS-RESPONSE)
007556*    END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&"IL       G          (  N#00014771' TO DFHEIV0
           MOVE X'2622494C2020202020202047' &
                X'202020202020202020202820' &
                X'204E233030303134373731' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 ELCRTO-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
007557
007558     IF RESP-NORMAL
007559        AND (OC-CONTROL-PRIMARY (1:33) =
007560                 PB-CONTROL-BY-ACCOUNT (1:33))
007561        AND (OC-RECORD-TYPE = 'I')
007562*       display ' resp norm, key =, type i '
007563        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
007564*          display ' end proc blank '
007565*          display ' csr edit session ' PI-CSR-SESSION-SW
007566           IF NOT CSR-EDIT-SESSION
007567              
      * EXEC CICS READ
007568*                DATASET   ('ELCRTO')
007569*                INTO      (ORIGINAL-CERTIFICATE)
007570*                RIDFLD    (OC-CONTROL-PRIMARY)
007571*                UPDATE
007572*                RESP      (WS-RESPONSE)
007573*             END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&"IL       EU         (  N#00014788' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'204E233030303134373838' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 OC-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
007574              IF RESP-NORMAL
007575                 IF OC-ISSUE-TRAN-IND = 'N'
007576                    MOVE CM-INSURED-LAST-NAME   TO
007577                         OC-INS-LAST-NAME
007578                    MOVE CM-INSURED-FIRST-NAME  TO
007579                         OC-INS-FIRST-NAME
007580                    MOVE CM-INSURED-INITIAL2    TO
007581                         OC-INS-MIDDLE-INIT
007582                    MOVE CM-INSURED-ISSUE-AGE   TO
007583                         OC-INS-AGE
007584                    MOVE CM-JT-LAST-NAME        TO
007585                         OC-JNT-LAST-NAME
007586                    MOVE CM-JT-FIRST-NAME       TO
007587                         OC-JNT-FIRST-NAME
007588                    MOVE CM-JT-INITIAL          TO
007589                         OC-JNT-MIDDLE-INIT
007590                    MOVE CM-INSURED-JOINT-AGE   TO
007591                         OC-JNT-AGE
007592                    MOVE CM-LF-BENEFIT-CD       TO
007593                         OC-LF-BENCD
007594                    MOVE CM-LF-ORIG-TERM        TO
007595                         OC-LF-TERM
007596                    MOVE CM-LF-BENEFIT-AMT      TO
007597                         OC-LF-BEN-AMT
007598                    MOVE CM-LF-PREMIUM-AMT      TO
007599                         OC-LF-PRM-AMT
007600                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
007601                         OC-LF-ALT-BEN-AMT
007602                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
007603                         OC-LF-ALT-PRM-AMT
007604                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
007605                         OC-LF-EXP-DT
007606                    MOVE CM-LIFE-COMM-PCT       TO
007607                         OC-LF-COMM-PCT
007608                    MOVE CM-AH-BENEFIT-CD       TO
007609                         OC-AH-BENCD
007610                    MOVE CM-AH-ORIG-TERM        TO
007611                         OC-AH-TERM
007612                    MOVE CM-AH-BENEFIT-AMT      TO
007613                         OC-AH-BEN-AMT
007614                    MOVE CM-AH-PREMIUM-AMT      TO
007615                         OC-AH-PRM-AMT
007616                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
007617                         OC-AH-EXP-DT
007618                    MOVE CM-AH-COMM-PCT         TO
007619                         OC-AH-COMM-PCT
007620                    MOVE CM-AH-CRITICAL-PERIOD  TO
007621                         OC-AH-CP
007622                    MOVE CM-LOAN-1ST-PMT-DT     TO
007623                         OC-1ST-PMT-DT
007624                 END-IF
007625                 MOVE PB-C-LF-CANCEL-DT      TO
007626                         OC-LF-CANCEL-DT
007627                 MOVE PB-C-LF-CANCEL-AMT     TO
007628                         OC-LF-CANCEL-AMT
007629                 MOVE CM-LF-ITD-CANCEL-AMT   TO
007630                         OC-LF-ITD-CANCEL-AMT
007631                 MOVE PB-C-AH-CANCEL-DT      TO
007632                         OC-AH-CANCEL-DT
007633                 MOVE PB-C-AH-CANCEL-AMT     TO
007634                         OC-AH-CANCEL-AMT
007635                 MOVE CM-AH-ITD-CANCEL-AMT   TO
007636                         OC-AH-ITD-CANCEL-AMT
007637                 MOVE 'Y'                    TO
007638                         OC-CANCEL-TRAN-IND
007639                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
007640                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
007641                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
007642                 IF ERMAIL-FOUND
007643                    MOVE MA-CRED-BENE-NAME
007644                                 TO OC-CRED-BENE-NAME
007645                 END-IF
007646                 IF NOT CERT-TRL-REC-NOT-FOUND
007647                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
007648                           OC-INS-AGE-DEFAULT-FLAG
007649                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
007650                           OC-JNT-AGE-DEFAULT-FLAG
007651                 END-IF
007652                 
      * EXEC CICS REWRITE
007653*                   DATASET   ('ELCRTO')
007654*                   FROM      (ORIGINAL-CERTIFICATE)
007655*                   RESP      (WS-RESPONSE)
007656*                END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&& L                  %  N#00014873' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'204E233030303134383733' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
007657              END-IF
007658           END-IF
007659        ELSE
007660           SUBTRACT +1 FROM OC-KEY-SEQ-NO
007661           MOVE 'OC'             TO OC-RECORD-ID
007662           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
007663           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
007664           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
007665           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
007666           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
007667           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
007668           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
007669           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
007670           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
007671           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
007672           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
007673           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
007674           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
007675           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
007676           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
007677           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
007678           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
007679           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
007680           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
007681           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
007682           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
007683           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
007684           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
007685           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
007686           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
007687           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
007688           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
007689           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
007690           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
007691           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
007692           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
007693           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
007694           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
007695           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
007696           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
007697           IF ERMAIL-FOUND
007698              MOVE MA-CRED-BENE-NAME
007699                                 TO OC-CRED-BENE-NAME
007700           END-IF
007701           IF NOT CERT-TRL-REC-NOT-FOUND
007702              MOVE CS-INS-AGE-DEFAULT-FLAG TO
007703                           OC-INS-AGE-DEFAULT-FLAG
007704              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
007705                           OC-JNT-AGE-DEFAULT-FLAG
007706           END-IF
007707           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
007708           
      * EXEC CICS WRITE
007709*             DATASET   ('ELCRTO')
007710*             FROM      (ORIGINAL-CERTIFICATE)
007711*             RIDFLD    (OC-CONTROL-PRIMARY)
007712*             RESP      (WS-RESPONSE)
007713*          END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&$ L                  ''  N#00014929' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'204E233030303134393239' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 OC-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
007714        END-IF
007715     ELSE
007716        MOVE SPACES              TO ORIGINAL-CERTIFICATE
007717        MOVE 'OC'                TO OC-RECORD-ID
007718        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
007719                                 TO OC-CONTROL-PRIMARY (1:33)
007720        MOVE 'I'                 TO OC-RECORD-TYPE
007721        MOVE +4096               TO OC-KEY-SEQ-NO
007722        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
007723        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
007724        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
007725        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
007726        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
007727        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
007728        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
007729        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
007730        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
007731        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
007732        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
007733        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
007734        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
007735        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
007736        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
007737        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
007738        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
007739        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
007740        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
007741        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
007742        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
007743        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
007744        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
007745        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
007746        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
007747        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
007748        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
007749        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
007750        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
007751        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
007752        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
007753        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
007754        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
007755        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
007756        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
007757        IF ERMAIL-FOUND
007758           MOVE MA-CRED-BENE-NAME
007759                                 TO OC-CRED-BENE-NAME
007760        END-IF
007761        IF NOT CERT-TRL-REC-NOT-FOUND
007762           MOVE CS-INS-AGE-DEFAULT-FLAG TO
007763                           OC-INS-AGE-DEFAULT-FLAG
007764           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
007765                           OC-JNT-AGE-DEFAULT-FLAG
007766        END-IF
007767        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
007768
007769        
      * EXEC CICS WRITE
007770*          DATASET   ('ELCRTO')
007771*          FROM      (ORIGINAL-CERTIFICATE)
007772*          RIDFLD    (OC-CONTROL-PRIMARY)
007773*          RESP      (WS-RESPONSE)
007774*       END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&$ L                  ''  N#00014990' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'204E233030303134393930' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 OC-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
007775     END-IF.
007776
007777 2376-BYPASS-CRTO.
007778******************************************************************
007779*       U P D A T E   T H E   B A T C H   H E A D E R            *
007780******************************************************************
007781
007782     
      * EXEC CICS HANDLE CONDITION
007783*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
007784*    END-EXEC.
      *    MOVE '"$I                   ! 7 #00015003' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3720233030303135303033' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007785
007786     
      * EXEC CICS READ
007787*        INTO    (PENDING-BUSINESS)
007788*        DATASET (FILE-ID-ERPNDB)
007789*        RIDFLD  (ERPNDB-KEY)
007790*        UPDATE
007791*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00015007' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303135303037' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007792
007793     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
007794     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
007795     MOVE 'B'                    TO JP-RECORD-TYPE.
007796     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
007797
007798     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
007799
007800     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
007801
007802     
      * EXEC CICS REWRITE
007803*        DATASET (FILE-ID-ERPNDB)
007804*        FROM    (PENDING-BUSINESS)
007805*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00015023' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303135303233' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007806
007807     MOVE 'C'                    TO JP-RECORD-TYPE.
007808     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
007809
007810     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
007811
007812     IF WS-ERRORS-PRESENT
007813         GO TO 3900-RE-DISPLAY-RECORD.
007814
007815     MOVE ZEROS                  TO EMI-ERROR
007816     MOVE -1                     TO CMAINTL
007817     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007818     GO TO 3900-RE-DISPLAY-RECORD.
007819
007820 2380-BATCH-HDR-NOT-FOUND.
007821     MOVE -1                     TO BMAINTL.
007822     MOVE ER-7450                TO EMI-ERROR.
007823     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007824     GO TO 8200-SEND-DATAONLY.
007825
007826 2385-REC-NOT-FOUND.
007827     MOVE -1                     TO BMAINTL.
007828     MOVE ER-7451                TO EMI-ERROR.
007829     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007830     GO TO 8200-SEND-DATAONLY.
007831
007832     EJECT
007833
007834******************************************************************
007835*                                                                *
007836*          D E L E T E   C A N C E L   R O U T I N E             *
007837*                                                                *
007838******************************************************************
007839
007840 2400-DELETE-CANCEL-ROUTINE.
007841     MOVE 'D'                    TO PI-MAINT-FUNCTION.
007842
007843     IF CCHGL NOT = ZEROS
007844        MOVE ER-2196             TO EMI-ERROR
007845        MOVE AL-UABON            TO CMAINTA
007846        MOVE -1                  TO CMAINTL
007847        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007848        GO TO 8200-SEND-DATAONLY.
007849
007850     
      * EXEC CICS HANDLE CONDITION
007851*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
007852*    END-EXEC.
      *    MOVE '"$I                   ! 8 #00015071' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3820233030303135303731' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007853
007854     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
007855     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
007856     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
007857
007858     
      * EXEC CICS READ
007859*        SET     (ADDRESS OF PENDING-BUSINESS)
007860*        DATASET (FILE-ID-ERPNDB)
007861*        RIDFLD  (ERPNDB-KEY)
007862*    END-EXEC.
      *    MOVE '&"S        E          (   #00015079' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303135303739' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007863
007864     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
007865
007866     MOVE CCERTNOI               TO WS-NEW-PRIME.
007867
007868     IF CSUFIXL NOT = ZEROS
007869        MOVE CSUFIXI             TO WS-NEW-SUFFIX
007870     ELSE
007871        MOVE SPACE               TO WS-NEW-SUFFIX.
007872
007873     MOVE CEFFDTI                TO DEEDIT-FIELD.
007874
007875     PERFORM 8600-DEEDIT.
007876     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
007877     MOVE '4'                    TO DC-OPTION-CODE.
007878     PERFORM 9700-DATE-LINK.
007879
007880     IF DATE-CONVERSION-ERROR
007881        MOVE ER-0348             TO EMI-ERROR
007882        MOVE -1                  TO CEFFDTL
007883        MOVE AL-UABON            TO CEFFDTA
007884        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007885        GO TO 8200-SEND-DATAONLY
007886     ELSE
007887        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
007888        MOVE AL-UANON            TO CEFFDTA
007889        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
007890
007891     
      * EXEC CICS HANDLE CONDITION
007892*         NOTFND    (2490-RECORD-NOT-FOUND)
007893*    END-EXEC.
      *    MOVE '"$I                   ! 9 #00015112' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3920233030303135313132' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007894
007895     
      * EXEC CICS READ
007896*        SET     (ADDRESS OF PENDING-BUSINESS)
007897*        DATASET (FILE-ID-ERPNDB)
007898*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
007899*        UPDATE
007900*    END-EXEC.
      *    MOVE '&"S        EU         (   #00015116' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303135313136' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 PI-PREV-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007901
007902     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
007903        MOVE -1                 TO CMAINTL
007904        MOVE ER-2197            TO EMI-ERROR
007905        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007906        GO TO 8200-SEND-DATAONLY.
007907
007908     IF PB-BILLED-DT NOT = LOW-VALUES
007909        MOVE -1                 TO CMAINTL
007910        MOVE ER-2129            TO EMI-ERROR
007911        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007912        GO TO 8200-SEND-DATAONLY.
007913
007914     IF PB-CHG-COUNT NOT = ZEROS
007915        MOVE ER-2336            TO EMI-ERROR
007916        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007917        MOVE AL-UABON            TO CMAINTA
007918        MOVE -1                  TO CMAINTL
007919        GO TO 8200-SEND-DATAONLY.
007920
007921     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
007922        PB-CHG-COUNT NOT = ZEROS
007923        MOVE ER-2196             TO EMI-ERROR
007924        MOVE AL-UABON            TO CMAINTA
007925        MOVE -1                  TO CMAINTL
007926        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007927        GO TO 8200-SEND-DATAONLY.
007928
007929     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
007930        MOVE ER-2900 TO EMI-ERROR
007931        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007932        MOVE AL-UABON         TO CMAINTA
007933        MOVE -1               TO CMAINTL
007934        GO TO 8200-SEND-DATAONLY.
007935
007936     move ' '                    to ws-stop-sw
007937                                    ws-check-sw
007938                                    ws-any-check-sw
007939                                    ws-proc-check-sw
007940                                    ws-chek-browse-sw
007941
007942     perform 2500-browse-checks  thru 2500-exit
007943     if (i-have-processed-checks)
007944        and (pb-c-refund-sw = 'Y')
007945        move er-3446             to emi-error
007946        perform 9900-error-format thru 9900-exit
007947        move al-uabon            to cmainta
007948        move -1                  to cmaintl
007949        go to 8200-send-dataonly
007950     end-if
007951
007952     
      * EXEC CICS HANDLE CONDITION
007953*         NOTFND  (2475-CONTINUE-DELETE)
007954*    END-EXEC
      *    MOVE '"$I                   ! : #00015173' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3A20233030303135313733' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
007955
007956     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
007957     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
007958     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
007959     MOVE PB-SV-STATE            TO ELCERT-STATE.
007960
007961     
      * EXEC CICS READ
007962*        SET     (ADDRESS OF CERTIFICATE-MASTER)
007963*        DATASET (FILE-ID-ELCERT)
007964*        RIDFLD  (ELCERT-KEY)
007965*        UPDATE
007966*    END-EXEC.
      *    MOVE '&"S        EU         (   #00015182' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303135313832' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CERTIFICATE-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
007967
007968     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
007969
007970     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
007971     MOVE 'B'                    TO JP-RECORD-TYPE.
007972     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
007973     PERFORM 8400-LOG-JOURNAL-RECORD.
007974
007975     IF PB-CI-LIVES NOT NUMERIC
007976         MOVE ZERO                    TO PB-CI-LIVES.
007977
007978     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
007979        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
007980           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
007981           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
007982           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
007983                                            CM-LF-CANCEL-DT
007984           MOVE SPACE                    TO CM-LF-EXIT-BATCH
007985        ELSE
007986           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
007987           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
007988           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
007989           MOVE PB-CI-LIVES              TO CM-LIVES.
007990
007991     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
007992        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
007993           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
007994               MOVE CM-LF-STATUS-AT-CANCEL
007995                                        TO CM-LF-CURRENT-STATUS
007996               MOVE SPACE
007997                                        TO CM-LF-STATUS-AT-CANCEL
007998           ELSE
007999               MOVE PB-CI-LF-POLICY-STATUS
008000                                        TO CM-LF-CURRENT-STATUS
008001        ELSE
008002           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
008003
008004
008005     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
008006        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
008007           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
008008           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
008009           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
008010                                            CM-AH-CANCEL-DT
008011           MOVE SPACE                    TO CM-AH-EXIT-BATCH
008012        ELSE
008013           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
008014           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
008015           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
008016           MOVE PB-CI-LIVES              TO CM-LIVES.
008017
008018     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
008019        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
008020           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
008021               MOVE CM-AH-STATUS-AT-CANCEL
008022                                        TO CM-AH-CURRENT-STATUS
008023               MOVE SPACE
008024                                        TO CM-AH-STATUS-AT-CANCEL
008025           ELSE
008026               MOVE PB-CI-AH-POLICY-STATUS
008027                                        TO CM-AH-CURRENT-STATUS
008028        ELSE
008029           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
008030
008031 2450-REWRITE-CERT.
008032     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
008033     MOVE 'C'                      TO JP-RECORD-TYPE.
008034     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
008035
008036     
      * EXEC CICS REWRITE
008037*        DATASET  (FILE-ID-ELCERT)
008038*        FROM     (CERTIFICATE-MASTER)
008039*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV11
      *    MOVE '&& L                  %   #00015257' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303135323537' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 CERTIFICATE-MASTER, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008040
008041     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
008042
008043     PERFORM 8400-LOG-JOURNAL-RECORD.
008044
008045
008046     move ' '                    to ws-stop-sw
008047                                    ws-any-check-sw
008048                                    ws-proc-check-sw
008049                                    ws-chek-browse-sw
008050
008051     if i-have-checks
008052        perform until i-say-stop
008053           perform 2510-startbr-erchek
008054                                 thru 2510-exit
008055           if resp-normal
008056              perform 2520-readnext-erchek
008057                                 thru 2520-exit
008058           end-if
008059           if (not resp-normal)
008060              or (pb-control-by-account (1:33) not =
008061                 ch-control-primary (1:33))
008062                 set i-say-stop to true
008063           else
008064              perform 2530-readupd-erchek
008065                                 thru 2530-exit
008066              if resp-normal
008067                 perform 2540-delete-erchek
008068                                 thru 2540-exit
008069              end-if
008070              if ws-chek-browse-sw = 'Y'
008071                 perform 2525-endbr-erchek
008072                                 thru 2525-exit
008073                 move ' '        to ws-chek-browse-sw
008074              end-if
008075           end-if
008076        end-perform
008077     end-if
008078
008079     if ws-chek-browse-sw = 'Y'
008080        perform 2525-endbr-erchek thru 2525-exit
008081     end-if
008082
008083     .
008084 2475-CONTINUE-DELETE.
008085     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
008086     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
008087
008088     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
008089     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
008090
008091     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
008092
008093     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
008094     MOVE 'D'                    TO JP-RECORD-TYPE
008095     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
008096
008097     
      * EXEC CICS DELETE
008098*        DATASET    (FILE-ID-ERPNDB)
008099*    END-EXEC.
      *    MOVE '&(                    &   #00015318' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'2020233030303135333138' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008100
008101     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
008102
008103     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Delete
008104
008105     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
008106     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
008107
008108     
      * EXEC CICS HANDLE CONDITION
008109*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
008110*    END-EXEC.
      *    MOVE '"$I                   ! ; #00015329' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3B20233030303135333239' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008111
008112     
      * EXEC CICS READ
008113*        SET     (ADDRESS OF PENDING-BUSINESS)
008114*        DATASET (FILE-ID-ERPNDB)
008115*        RIDFLD  (ERPNDB-KEY)
008116*        UPDATE
008117*    END-EXEC.
      *    MOVE '&"S        EU         (   #00015333' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303135333333' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008118
008119     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
008120     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
008121
008122     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
008123        WS-B-CANCEL-CNT-ENTERED = ZEROS
008124        MOVE 'D'                 TO JP-RECORD-TYPE
008125        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
008126        
      * EXEC CICS DELETE
008127*            DATASET    (FILE-ID-ERPNDB)
008128*       END-EXEC
      *    MOVE '&(                    &   #00015347' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'2020233030303135333437' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
008129        PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal BHDR Delete
008130     ELSE
008131        MOVE 'B'                 TO JP-RECORD-TYPE
008132        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
008133        PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
008134        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
008135        MOVE 'C'                 TO JP-RECORD-TYPE
008136        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
008137        
      * EXEC CICS REWRITE
008138*            DATASET    (FILE-ID-ERPNDB)
008139*            FROM       (PENDING-BUSINESS)
008140*       END-EXEC
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00015358' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303135333538' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
008141        PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
008142     end-if
008143
008144******************************************************************
008145*                                                                *
008146*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
008147*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
008148*                                                                *
008149******************************************************************
008150
008151     IF NOT PI-AR-PROCESSING
008152        GO TO 2480-DELETE-FINISHED.
008153
008154     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
008155        WS-B-CANCEL-CNT-ENTERED = ZEROS
008156        NEXT SENTENCE
008157     ELSE
008158        GO TO 2480-DELETE-FINISHED.
008159
008160     
      * EXEC CICS HANDLE CONDITION
008161*         NOTFND    (2480-DELETE-FINISHED)
008162*    END-EXEC.
      *    MOVE '"$I                   ! < #00015381' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3C20233030303135333831' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008163
008164     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
008165     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
008166
008167     
      * EXEC CICS READ
008168*        SET     (ADDRESS OF AR-REQUEST-RECORD)
008169*        DATASET (FILE-ID-ERRQST)
008170*        RIDFLD  (ERRQST-KEY)
008171*        UPDATE
008172*    END-EXEC.
      *    MOVE '&"S        EU         (   #00015388' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303135333838' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRQST, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERRQST-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF AR-REQUEST-RECORD TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008173
008174     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
008175
008176     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
008177
008178     MOVE 'D'                      TO JP-RECORD-TYPE.
008179     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
008180
008181     
      * EXEC CICS DELETE
008182*         DATASET    (FILE-ID-ERRQST)
008183*    END-EXEC.
      *    MOVE '&(                    &   #00015402' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'2020233030303135343032' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRQST, 
                 ERRQST-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008184
008185     PERFORM 8400-LOG-JOURNAL-RECORD.
008186
008187 2480-DELETE-FINISHED.
008188     MOVE ZEROS                  TO EMI-ERROR.
008189     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008190     MOVE LOW-VALUES             TO EL631CI.
008191     MOVE -1                     TO CMAINTL.
008192     GO TO 8100-SEND-INITIAL-MAP.
008193
008194 2485-BATCH-HDR-NOT-FOUND.
008195     MOVE -1                     TO CMAINTL
008196     MOVE AL-UABON               TO CMAINTA.
008197     MOVE ER-7450                TO EMI-ERROR.
008198     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008199     GO TO 8200-SEND-DATAONLY.
008200
008201 2490-RECORD-NOT-FOUND.
008202     MOVE -1                     TO CMAINTL
008203     MOVE AL-UABON               TO CMAINTA.
008204     MOVE ER-7451                TO EMI-ERROR.
008205     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008206     GO TO 8200-SEND-DATAONLY.
008207
008208***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
008209***                                                            ***
008210***     2500  B R O W S E   C H E C K S                        ***
008211***  We perform this routine from 2 different places.          ***
008212***  1. If the user changes the refund amount on a cancel, we  ***
008213***    want to.........                                        ***
008214***    a. determine if prior checks have been processed        ***
008215***    b. If the amt is larger, display message instructing    ***
008216***     them to create another check to make up the difference.***
008217***    c. If the amt is less, do not allow the change and      ***
008218***     display a FATAL error suggesting they deal with check  ***
008219***     records befor continuing.                              ***
008220***  2. If the user wants to delete a cancel record we......   ***
008221***    a. browse through all the checks and if there is a      ***
008222***     processed check, send FATAL message.                   ***
008223***    b. If there is a non-released check, then delete that   ***
008224***     check after you delete the pending cancel record.      ***
008225***                                                            ***
008226***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
008227
008228 2500-browse-checks.
008229
008230     perform 2510-startbr-erchek thru 2510-exit
008231
008232     if not resp-normal
008233        go to 2500-exit
008234     end-if
008235
008236     perform until i-say-stop
008237        perform 2520-readnext-erchek
008238                                 thru 2520-exit
008239        if (not resp-normal)
008240           or (pb-control-by-account (1:33) not =
008241              ch-control-primary (1:33))
008242              set i-say-stop to true
008243        else
008244           set i-have-a-check-period to true
008245           if (ch-approval-status) = ' '
008246              and (ch-void-dt = low-values)
008247              and (ch-released-dt = low-values)
008248              set i-have-checks to true
008249           else
008250              if ch-void-dt = low-values
008251                 set i-have-processed-checks to true
008252              end-if
008253           end-if
008254           if (ch-credit-accept-dt = low-values)
008255              and (ch-void-dt = low-values)
008256              and (ch-approval-status = ' ' OR 'P' OR 'A')
008257              if (ch-check-origin-sw not = 'R')
008258                 and (pb-record-type = '2')
008259                 continue
008260              else
008261                 compute ws-check-amts =
008262                    ws-check-amts + ch-amount-paid
008263              end-if
008264           end-if
008265        end-if
008266     end-perform
008267
008268     if ws-chek-browse-sw = 'Y'
008269        perform 2525-endbr-erchek thru 2525-exit
008270     end-if
008271
008272    .
008273 2500-exit.
008274     exit.
008275
008276 2510-startbr-erchek.
008277
008278     move pb-control-by-account  to erchek-key
008279     move +0                     to chek-record-seq
008280
008281     
      * exec cics startbr
008282*       dataset   ('ERCHEK')
008283*       ridfld    (erchek-key)
008284*       gteq
008285*       resp      (ws-response)
008286*    end-exec
           MOVE 'ERCHEK' TO DFHEIV1
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &  N#00015502' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'204E233030303135353032' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 erchek-key, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           MOVE EIBRESP  TO ws-response
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
008287
008288     IF RESP-NORMAL
008289        move 'Y'                 to ws-chek-browse-sw
008290     end-if
008291
008292     .
008293 2510-exit.
008294     exit.
008295
008296 2520-readnext-erchek.
008297
008298     
      * EXEC CICS READNEXT
008299*       SET     (ADDRESS OF CHECK-RECORDS)
008300*       DATASET ('ERCHEK')
008301*       RIDFLD  (ERCHEK-KEY)
008302*       RESP    (WS-RESPONSE)
008303*    END-EXEC
           MOVE 'ERCHEK' TO DFHEIV1
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )  N#00015519' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'204E233030303135353139' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERCHEK-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CHECK-RECORDS TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
008304
008305     .
008306 2520-exit.
008307     exit.
008308
008309 2525-endbr-erchek.
008310
008311     
      * exec cics endbr
008312*       dataset  ('ERCHEK')
008313*    end-exec
           MOVE 'ERCHEK' TO DFHEIV1
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00015532' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303135353332' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
008314
008315     .
008316 2525-exit.
008317     exit.
008318
008319 2530-readupd-erchek.
008320
008321     
      * EXEC CICS READ
008322*       UPDATE
008323*       SET     (ADDRESS OF CHECK-RECORDS)
008324*       DATASET ('ERCHEK')
008325*       RIDFLD  (ERCHEK-KEY)
008326*       RESP    (WS-RESPONSE)
008327*    END-EXEC
           MOVE 'ERCHEK' TO DFHEIV1
      *    MOVE '&"S        EU         (  N#00015542' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'204E233030303135353432' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERCHEK-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CHECK-RECORDS TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
008328
008329     .
008330 2530-exit.
008331     exit.
008332
008333 2540-delete-erchek.
008334
008335     
      * EXEC CICS DELETE
008336*       DATASET ('ERCHEK')
008337*       RESP    (WS-RESPONSE)
008338*    END-EXEC
           MOVE 'ERCHEK' TO DFHEIV1
      *    MOVE '&(                    &  N#00015556' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'204E233030303135353536' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ERCHEK-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
008339
008340     .
008341 2540-exit.
008342     exit.
008343
008344
008345***************************************************************
008346*                                                             *
008347*       B U I L D   C O R R E C T I O N   R E C O R D         *
008348*                                                             *
008349***************************************************************
008350
008351***************************************************************
008352*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
008353*     AN ALREADY BILLED RECORD.                               *
008354***************************************************************
008355
008356 2700-BUILD-CORRECTION-RECORD.
008357     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
008358     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
008359     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
008360     MOVE '5'                    TO DC-OPTION-CODE.
008361     PERFORM 9700-DATE-LINK.
008362     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
008363
008364     IF PB-CHG-COUNT = ZEROS
008365        MOVE +1                  TO WS-SEQ-SAVE
008366     ELSE
008367        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
008368
008369     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
008370     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
008371
008372     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
008373
008374     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
008375     MOVE 'A'                    TO JP-RECORD-TYPE.
008376     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
008377
008378     
      * EXEC CICS WRITE
008379*        DATASET    (FILE-ID-ERPNDB)
008380*        FROM       (PENDING-BUSINESS)
008381*        RIDFLD     (PB-CONTROL-PRIMARY)
008382*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00015599' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'2020233030303135353939' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 PB-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008383
008384     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
008385
008386     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Add
008387
008388     .
008389 2799-EXIT.
008390      EXIT.
008391
008392     EJECT
008393
008394******************************************************************
008395*                                                                *
008396*        R E W R I T E   I S S U E   C E R T.   K E Y            *
008397*                 'K' transaction                                *
008398******************************************************************
008399
008400 2800-REWRITE-ISSUE-CERT-KEY.
008401
008402     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
008403
008404     IF  BCERTNOL GREATER THAN ZEROS
008405         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
008406
008407     IF  BSUFIXL  GREATER THAN ZEROS
008408         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
008409
008410     IF  BEFFDTL  GREATER THAN ZEROS
008411         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
008412
008413     move pi-prev-control-primary to pa-current-key
008414     move erpndb-alt-key          to pa-new-alt-key
008415     move spaces                  to pa-return-area
008416
008417     
      * EXEC CICS LINK
008418*       PROGRAM   ('EL055')
008419*       COMMAREA  (EL055-PASS-AREA)
008420*       LENGTH    (256)
008421*    END-EXEC
           MOVE 'EL055' TO DFHEIV1
           MOVE 256
             TO DFHEIV11
      *    MOVE '."C                   (   #00015638' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303135363338' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 EL055-PASS-AREA, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
008422
008423     if ra-status-code = +99  *> found a claim
008424        move -1                  to bmaintl
008425        move al-uabon            to bmainta
008426        move er-2878             to emi-error
008427        perform 9900-error-format thru 9900-exit
008428        go to 8200-send-dataonly
008429     end-if
008430
008431     if ra-status-code = +88  *> found dup cert
008432        move -1                  to bmaintl
008433        move al-uabon            to bmainta
008434        move er-0229             to emi-error
008435        perform 9900-error-format thru 9900-exit
008436        go to 8200-send-dataonly
008437     end-if
008438
008439     GO TO 1325-PROCESS-ISSUE-CHANGES
008440
008441     .
008442******************************************************************
008443*                                                                *
008444*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
008445*                                                                *
008446******************************************************************
008447
008448 2900-REWRITE-CAN-CERT-KEY.
008449     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
008450
008451     IF  CCERTNOL GREATER THAN ZEROS
008452         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
008453
008454     IF  CSUFIXL  GREATER THAN ZEROS
008455         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
008456
008457     IF  CEFFDTL  GREATER THAN ZEROS
008458         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
008459
008460 2910-READ-BY-ACCOUNT.
008461     
      * EXEC CICS HANDLE CONDITION
008462*         NOTFND    (2920-PROCESS-REWRITE)
008463*    END-EXEC.
      *    MOVE '"$I                   ! = #00015682' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3D20233030303135363832' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008464
008465     
      * EXEC CICS READ
008466*        SET     (ADDRESS OF PENDING-BUSINESS)
008467*        DATASET (FILE-ID-ERPNDB2)
008468*        RIDFLD  (ERPNDB-ALT-KEY)
008469*    END-EXEC.
      *    MOVE '&"S        E          (   #00015686' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303135363836' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB2, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-ALT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008470
008471     GO TO 2990-DUPLICATE-RECORD.
008472
008473  2920-PROCESS-REWRITE.
008474     
      * EXEC CICS HANDLE CONDITION
008475*         NOTFND    (2985-RECORD-MISSING)
008476*    END-EXEC.
      *    MOVE '"$I                   ! > #00015695' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3E20233030303135363935' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008477
008478     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
008479
008480     
      * EXEC CICS READ
008481*        SET     (ADDRESS OF PENDING-BUSINESS)
008482*        DATASET (FILE-ID-ERPNDB)
008483*        RIDFLD  (ERPNDB-KEY)
008484*        UPDATE
008485*    END-EXEC.
      *    MOVE '&"S        EU         (   #00015701' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303135373031' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008486
008487     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
008488     MOVE 'D'                    TO JP-RECORD-TYPE.
008489     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
008490     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
008491
008492     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
008493
008494     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
008495     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
008496     MOVE PB-SV-STATE            TO ELCERT-STATE.
008497
008498     
      * EXEC CICS DELETE
008499*        DATASET    (FILE-ID-ERPNDB)
008500*    END-EXEC.
      *    MOVE '&(                    &   #00015719' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'2020233030303135373139' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008501
008502     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Delete
008503
008504     
      * EXEC CICS GETMAIN
008505*        SET      (ADDRESS OF PENDING-BUSINESS)
008506*        LENGTH   (ERPNDB-RECORD-LENGTH)
008507*        INITIMG  (GETMAIN-SPACE)
008508*    END-EXEC.
      *    MOVE ',"IL                  $   #00015725' TO DFHEIV0
           MOVE X'2C22494C2020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303135373235' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 ERPNDB-RECORD-LENGTH, 
                 GETMAIN-SPACE
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008509
008510     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
008511
008512 2950-PROCESS-CANCELS.
008513
008514     
      * EXEC CICS HANDLE CONDITION
008515*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
008516*    END-EXEC.
      *    MOVE '"$I                   ! ? #00015735' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3F20233030303135373335' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008517
008518     
      * EXEC CICS READ
008519*        SET     (ADDRESS OF CERTIFICATE-MASTER)
008520*        DATASET (FILE-ID-ELCERT)
008521*        RIDFLD  (ELCERT-KEY)
008522*        UPDATE
008523*    END-EXEC.
      *    MOVE '&"S        EU         (   #00015739' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303135373339' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CERTIFICATE-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008524
008525     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
008526
008527     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
008528     MOVE 'B'                      TO JP-RECORD-TYPE.
008529     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
008530     PERFORM 8400-LOG-JOURNAL-RECORD.
008531
008532     IF PB-CI-LIVES NOT NUMERIC
008533         MOVE ZERO                    TO PB-CI-LIVES.
008534
008535     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
008536        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
008537        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
008538        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
008539                                         CM-LF-CANCEL-DT
008540     ELSE
008541        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
008542        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
008543        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
008544        MOVE PB-CI-LIVES              TO CM-LIVES.
008545
008546     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
008547        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
008548            MOVE CM-LF-STATUS-AT-CANCEL
008549                                     TO CM-LF-CURRENT-STATUS
008550            MOVE SPACE
008551                                     TO CM-LF-STATUS-AT-CANCEL
008552        ELSE
008553            MOVE PB-CI-LF-POLICY-STATUS
008554                                     TO CM-LF-CURRENT-STATUS
008555     ELSE
008556        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
008557
008558     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
008559        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
008560        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
008561        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
008562                                         CM-AH-CANCEL-DT
008563     ELSE
008564        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
008565        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
008566        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
008567        MOVE PB-CI-LIVES              TO CM-LIVES.
008568
008569     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
008570        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
008571            MOVE CM-AH-STATUS-AT-CANCEL
008572                                     TO CM-AH-CURRENT-STATUS
008573            MOVE SPACE
008574                                     TO CM-AH-STATUS-AT-CANCEL
008575        ELSE
008576            MOVE PB-CI-AH-POLICY-STATUS
008577                                     TO CM-AH-CURRENT-STATUS
008578     ELSE
008579        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
008580
008581 2975-REWRITE-CERT.
008582     MOVE 'C'                      TO JP-RECORD-TYPE.
008583     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
008584
008585     
      * EXEC CICS REWRITE
008586*        DATASET    (FILE-ID-ELCERT)
008587*        FROM       (CERTIFICATE-MASTER)
008588*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV11
      *    MOVE '&& L                  %   #00015806' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303135383036' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 CERTIFICATE-MASTER, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008589
008590     PERFORM 8400-LOG-JOURNAL-RECORD.
008591
008592 2960-BUILD-NEW-CANCEL-RECORD.
008593     IF  CCERTNOL GREATER THAN ZEROS
008594         MOVE CCERTNOI            TO PB-CERT-PRIME.
008595
008596     IF  CSUFIXL  GREATER THAN ZEROS
008597         MOVE CSUFIXI             TO PB-CERT-SFX.
008598
008599     IF  CEFFDTL  GREATER  THAN ZEROS
008600         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
008601
008602 2970-WRITE-PENDING-BUSINESS.
008603     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
008604     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
008605     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
008606     MOVE '5'                    TO DC-OPTION-CODE.
008607     PERFORM 9700-DATE-LINK.
008608     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
008609
008610     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
008611
008612     MOVE SPACES                 TO PB-CI-INSURED-NAME
008613                                    PB-CI-INSURED-SEX
008614                                    PB-CI-LF-BENEFIT-CD
008615                                    PB-CI-AH-BENEFIT-CD
008616                                    PB-CI-RATE-CLASS
008617                                    PB-CI-RATE-DEV-LF
008618                                    PB-CI-RATE-DEV-AH
008619                                    PB-CI-LF-ABBR
008620                                    PB-CI-AH-ABBR
008621                                    PB-CI-OB-FLAG
008622                                    PB-CI-LF-POLICY-STATUS
008623                                    PB-CI-AH-POLICY-STATUS
008624                                    PB-CI-INDV-GRP-CD
008625                                    PB-CI-BENEFICIARY-NAME
008626                                    PB-CI-NOTE-SW
008627                                    PB-CI-SOC-SEC-NO
008628                                    PB-CI-MEMBER-NO
008629                                    PB-CI-INT-CODE
008630                                    PB-CI-COMP-EXCP-SW
008631                                    PB-CI-ENTRY-STATUS
008632                                    PB-CI-CREDIT-INTERFACE-SW-1
008633                                    PB-CI-CREDIT-INTERFACE-SW-2
008634                                    PB-CI-ENTRY-BATCH.
008635
008636     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
008637                                    PB-CI-AH-SETTLEMENT-DT
008638                                    PB-CI-DEATH-DT
008639                                    PB-CI-LF-PRIOR-CANCEL-DT
008640                                    PB-CI-AH-PRIOR-CANCEL-DT
008641                                    PB-CI-LOAN-1ST-PMT-DT
008642                                    PB-CI-ENTRY-DT
008643                                    PB-CI-LF-EXPIRE-DT
008644                                    PB-CI-AH-EXPIRE-DT.
008645
008646     MOVE ZEROS                  TO PB-CI-INSURED-AGE
008647                                    PB-CI-LF-TERM
008648                                    PB-CI-LF-BENEFIT-AMT
008649                                    PB-CI-LF-ALT-BENEFIT-AMT
008650                                    PB-CI-LF-PREMIUM-AMT
008651                                    PB-CI-LF-ALT-PREMIUM-AMT
008652                                    PB-CI-AH-TERM
008653                                    PB-CI-AH-BENEFIT-AMT
008654                                    PB-CI-AH-PREMIUM-AMT
008655                                    PB-CI-RATE-DEV-PCT-LF
008656                                    PB-CI-RATE-DEV-PCT-AH
008657                                    PB-CI-LIFE-COMMISSION
008658                                    PB-CI-AH-COMMISSION
008659                                    PB-CI-PAY-FREQUENCY
008660                                    PB-CI-LOAN-APR
008661                                    PB-CI-LOAN-TERM
008662                                    PB-CI-CURR-SEQ
008663                                    PB-CI-AH-CANCEL-AMT
008664                                    PB-CI-LF-CANCEL-AMT
008665                                    PB-CI-EXTENTION-DAYS
008666                                    PB-CI-TERM-IN-DAYS
008667                                    PB-CI-LOAN-OFFICER
008668                                    PB-CI-LIVES
008669                                    PB-CI-LF-CRIT-PER
008670                                    PB-CI-AH-CRIT-PER
008671                                    PB-C-LF-REM-TERM
008672                                    PB-C-AH-REM-TERM.
008673
008674     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
008675     MOVE 'A'                    TO JP-RECORD-TYPE.
008676     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
008677
008678     
      * EXEC CICS HANDLE CONDITION
008679*        DUPREC   (2990-DUPLICATE-RECORD)
008680*    END-EXEC.
      *    MOVE '"$%                   ! @ #00015899' TO DFHEIV0
           MOVE X'222425202020202020202020' &
                X'202020202020202020202120' &
                X'4020233030303135383939' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008681
008682     
      * EXEC CICS WRITE
008683*        DATASET  (FILE-ID-ERPNDB)
008684*        FROM     (PENDING-BUSINESS)
008685*        RIDFLD   (PB-CONTROL-PRIMARY)
008686*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00015903' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'2020233030303135393033' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 PB-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008687
008688     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
008689
008690     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Add
008691
008692     GO TO 2325-PROCESS-CANCEL-CHANGES.
008693
008694 2985-RECORD-MISSING.
008695     MOVE -1                     TO CMAINTL
008696     MOVE AL-UABON               TO CMAINTA.
008697
008698     MOVE ER-2902                TO EMI-ERROR.
008699     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008700     GO TO 8200-SEND-DATAONLY.
008701
008702 2990-DUPLICATE-RECORD.
008703     MOVE SPACE                  TO CMAINTI.
008704     MOVE -1                     TO CMAINTL.
008705     MOVE AL-UABON               TO CCERTNOA.
008706     MOVE AL-UNBON               TO CEFFDTA.
008707
008708     MOVE 1                      TO EMI-SUB
008709                                    EMI-SWITCH1
008710                                    EMI-SWITCH-AREA-1
008711                                    EMI-SWITCH-AREA-2.
008712     MOVE SPACES                 TO EMI-ERROR-LINES.
008713
008714     
      * EXEC CICS SYNCPOINT ROLLBACK
008715*    END-EXEC.
      *    MOVE '6"R                   !   #00015935' TO DFHEIV0
           MOVE X'362252202020202020202020' &
                X'202020202020202020202120' &
                X'2020233030303135393335' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008716
008717     MOVE ER-2247                TO EMI-ERROR.
008718     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008719     GO TO 8200-SEND-DATAONLY.
008720
008721     EJECT
008722
008723***************************************************************
008724*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
008725*     PREMIUM FOR A SINGLE BATCH.                             *
008726*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
008727***************************************************************
008728
008729 3000-BATCH-MAINLINE.
008730     IF PI-PREV-KEY NOT = SPACES
008731         MOVE PI-PREV-KEY        TO ERPNDB-KEY
008732     ELSE
008733         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
008734
008735     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
008736
008737 3010-READNEXT.
008738     
      * EXEC CICS READ
008739*         DATASET    (FILE-ID-ERPNDB)
008740*         SET        (ADDRESS OF PENDING-BUSINESS)
008741*         RIDFLD     (ERPNDB-KEY)
008742*         GTEQ
008743*    END-EXEC.
      *    MOVE '&"S        G          (   #00015959' TO DFHEIV0
           MOVE X'262253202020202020202047' &
                X'202020202020202020202820' &
                X'2020233030303135393539' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008744
008745     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
008746        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
008747          GO TO 3030-END-BATCH.
008748
008749     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
008750
008751     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
008752        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
008753          GO TO 3020-BUMP-SEQ.
008754
008755     IF PB-ISSUE
008756        ADD +1                   TO WS-ISS-TOTAL-CNT
008757        IF PB-FATAL-ERRORS
008758           ADD +1                      TO WS-ISS-FATAL-CNT
008759           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
008760           GO TO 3020-BUMP-SEQ
008761        ELSE
008762           IF PB-UNFORCED-ERRORS
008763              ADD +1                      TO WS-ISS-FORCE-CNT
008764              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
008765              GO TO 3020-BUMP-SEQ
008766           ELSE
008767              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
008768                 ADD +1                      TO WS-ISS-HOLD-CNT
008769                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
008770                 GO TO 3020-BUMP-SEQ
008771              ELSE
008772                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
008773                     THRU  3299-EXIT
008774                 GO TO 3020-BUMP-SEQ.
008775
008776     IF PB-CANCELLATION
008777        ADD +1                   TO WS-CAN-TOTAL-CNT
008778        IF PB-FATAL-ERRORS
008779           ADD +1                 TO WS-CAN-FATAL-CNT
008780           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
008781           GO TO 3020-BUMP-SEQ
008782        ELSE
008783           IF PB-UNFORCED-ERRORS
008784              ADD +1                 TO WS-CAN-FORCE-CNT
008785              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
008786              GO TO 3020-BUMP-SEQ
008787           ELSE
008788              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
008789                 ADD +1                 TO WS-CAN-HOLD-CNT
008790                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
008791                 GO TO 3020-BUMP-SEQ
008792              ELSE
008793                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
008794                     THRU  3499-EXIT
008795                 GO TO 3020-BUMP-SEQ.
008796
008797     IF PB-BATCH-TRAILER
008798         GO TO 3030-END-BATCH.
008799
008800 3020-BUMP-SEQ.
008801     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
008802     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
008803     GO TO 3010-READNEXT.
008804
008805 3030-END-BATCH.
008806     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
008807     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
008808     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
008809     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
008810
008811     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
008812                                          - WS-ISS-FORCE-CNT
008813                                          - WS-ISS-HOLD-CNT).
008814
008815     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
008816     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
008817
008818     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
008819     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
008820     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
008821     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
008822     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
008823                                          - WS-CAN-FORCE-CNT
008824                                          - WS-CAN-HOLD-CNT).
008825     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
008826     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
008827
008828     COMPUTE WS-NET-TOTAL-CNT
008829         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
008830     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
008831     COMPUTE WS-NET-FATAL-CNT
008832         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
008833     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
008834     COMPUTE WS-NET-FORCE-CNT
008835         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
008836     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
008837     COMPUTE WS-NET-HOLD-CNT
008838         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
008839     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
008840
008841     COMPUTE WS-NET-AVAIL-CNT
008842          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
008843                              - WS-ISS-FORCE-CNT
008844                              - WS-ISS-HOLD-CNT)
008845          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
008846                              - WS-CAN-FORCE-CNT
008847                              - WS-CAN-HOLD-CNT).
008848     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
008849
008850     COMPUTE WS-NET-GOOD-PREM
008851         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
008852     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
008853     COMPUTE WS-NET-BAD-PREM
008854         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
008855     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
008856
008857     MOVE 0000                   TO EMI-ERROR.
008858     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008859     MOVE -1                     TO DPFENTRL.
008860     GO TO 8200-SEND-DATAONLY.
008861
008862     EJECT
008863
008864******************************************************************
008865*                                                                *
008866*           A D D    B A D   I S S U E   P R E M I U M           *
008867*                                                                *
008868******************************************************************
008869
008870 3100-ADD-BAD-ISSUE-PREM.
008871     IF PB-OVERRIDE-LIFE
008872       OR PB-OVERRIDE-BOTH
008873           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
008874           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
008875       ELSE
008876           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
008877           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
008878
008879     IF PB-OVERRIDE-AH
008880       OR PB-OVERRIDE-BOTH
008881           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
008882       ELSE
008883           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
008884
008885 3199-EXIT.
008886     EXIT.
008887
008888     EJECT
008889
008890******************************************************************
008891*                                                                *
008892*       A D D   G O O D   I S S U E   P R E M I U M              *
008893*                                                                *
008894******************************************************************
008895
008896 3200-ADD-GOOD-ISSUE-PREM.
008897     IF PB-OVERRIDE-LIFE
008898       OR PB-OVERRIDE-BOTH
008899           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
008900           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
008901       ELSE
008902           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
008903           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
008904
008905     IF PB-OVERRIDE-AH
008906       OR PB-OVERRIDE-BOTH
008907           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
008908       ELSE
008909           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
008910
008911 3299-EXIT.
008912     EXIT.
008913
008914     EJECT
008915
008916
008917******************************************************************
008918*                                                                *
008919*        A D D   B A D   C A N C E L   P R E M I U M             *
008920*                                                                *
008921******************************************************************
008922
008923 3300-ADD-BAD-CANCEL-PREM.
008924     IF PB-OVERRIDE-LIFE
008925       OR PB-OVERRIDE-BOTH
008926           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
008927       ELSE
008928           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
008929
008930     IF PB-OVERRIDE-AH
008931       OR PB-OVERRIDE-BOTH
008932           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
008933       ELSE
008934           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
008935
008936 3399-EXIT.
008937     EXIT.
008938
008939     EJECT
008940
008941******************************************************************
008942*                                                                *
008943*       A D D   G O O D   C A N C E L   P R E M I U M            *
008944*                                                                *
008945******************************************************************
008946
008947 3400-ADD-GOOD-CANCEL-PREM.
008948     IF PB-OVERRIDE-LIFE
008949       OR PB-OVERRIDE-BOTH
008950           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
008951       ELSE
008952           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
008953
008954     IF PB-OVERRIDE-AH
008955       OR PB-OVERRIDE-BOTH
008956           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
008957       ELSE
008958           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
008959
008960 3499-EXIT.
008961     EXIT.
008962
008963     EJECT
008964
008965******************************************************************
008966*                                                                *
008967*           E D I T   B A T C H   D A T A                        *
008968*                                                                *
008969******************************************************************
008970
008971 3500-EDIT-BATCH-DATA.
008972     IF PI-PREV-KEY NOT = SPACES
008973        MOVE PI-PREV-KEY         TO ERPNDB-KEY
008974     ELSE
008975        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
008976
008977     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
008978     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
008979
008980     
      * EXEC CICS HANDLE CONDITION
008981*         NOTFND      (3590-NOT-FOUND)
008982*    END-EXEC.
      *    MOVE '"$I                   ! A #00016201' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'4120233030303136323031' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
008983
008984     IF DRISSL   GREATER THAN ZEROS OR
008985        DRISSL   GREATER THAN ZEROS OR
008986        DRLFPRML GREATER THAN ZEROS OR
008987        DRAHPRML GREATER THAN ZEROS OR
008988        DRCANCL  GREATER THAN ZEROS OR
008989        DRLFRFDL GREATER THAN ZEROS OR
008990        DRAHRFDL GREATER THAN ZEROS
008991              NEXT SENTENCE
008992          ELSE
008993              MOVE ER-3224    TO EMI-ERROR
008994              MOVE -1         TO DPFENTRL
008995              MOVE AL-UNBON   TO DPFENTRA
008996              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
008997              GO TO 8200-SEND-DATAONLY.
008998
008999     IF NOT MODIFY-CAP
009000         MOVE 'UPDATE'       TO SM-READ
009001         PERFORM 9995-SECURITY-VIOLATION
009002         MOVE ER-0070        TO EMI-ERROR
009003         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009004         GO TO 8100-SEND-INITIAL-MAP.
009005
009006        IF DRISSL GREATER THAN ZEROS
009007           MOVE AL-UNNON         TO DRISSA
009008           MOVE DRISSI           TO DEEDIT-FIELD
009009           PERFORM 8600-DEEDIT
009010           IF DEEDIT-FIELD-V0  NUMERIC
009011              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
009012           ELSE
009013              MOVE ER-2223    TO EMI-ERROR
009014              MOVE -1         TO DRISSL
009015              MOVE AL-UNBON   TO DRISSA
009016              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009017
009018        IF DRLFPRML GREATER THAN ZEROS
009019           MOVE AL-UNNON         TO DRLFPRMA
009020           
      * EXEC CICS BIF DEEDIT
009021*              FIELD  (DRLFPRMI)
009022*              LENGTH (11)
009023*          END-EXEC
           MOVE 11
             TO DFHEIV11
      *    MOVE '@"L                   #   #00016241' TO DFHEIV0
           MOVE X'40224C202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303136323431' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DRLFPRMI, 
                 DFHEIV11
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
009024           IF DRLFPRMI NUMERIC
009025              MOVE DRLFPRMI   TO WS-DRLFPRM
009026*          MOVE DRLFPRMI         TO DEEDIT-FIELD
009027*          PERFORM 8600-DEEDIT
009028*          IF DEEDIT-FIELD-V2  NUMERIC
009029*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
009030           ELSE
009031              MOVE ER-2223    TO EMI-ERROR
009032              MOVE -1         TO DRLFPRML
009033              MOVE AL-UNBON   TO DRLFPRMA
009034              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009035
009036        IF DRAHPRML GREATER THAN ZEROS
009037           MOVE AL-UNNON         TO DRAHPRMA
009038           
      * EXEC CICS BIF DEEDIT
009039*              FIELD  (DRAHPRMI)
009040*              LENGTH (11)
009041*          END-EXEC
           MOVE 11
             TO DFHEIV11
      *    MOVE '@"L                   #   #00016259' TO DFHEIV0
           MOVE X'40224C202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303136323539' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DRAHPRMI, 
                 DFHEIV11
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
009042           IF DRAHPRMI NUMERIC
009043              MOVE DRAHPRMI   TO WS-DRAHPRM
009044*          MOVE DRAHPRMI         TO DEEDIT-FIELD
009045*          PERFORM 8600-DEEDIT
009046*          IF DEEDIT-FIELD-V2  NUMERIC
009047*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
009048           ELSE
009049              MOVE ER-2223    TO EMI-ERROR
009050              MOVE -1         TO DRAHPRML
009051              MOVE AL-UNBON   TO DRAHPRMA
009052              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009053
009054        IF DRCANCL GREATER THAN ZEROS
009055           MOVE AL-UNNON         TO DRCANCA
009056           MOVE DRCANCI          TO DEEDIT-FIELD
009057           PERFORM 8600-DEEDIT
009058           IF DEEDIT-FIELD-V0  NUMERIC
009059              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
009060           ELSE
009061              MOVE ER-2223    TO EMI-ERROR
009062              MOVE -1         TO DRCANCL
009063              MOVE AL-UNBON   TO DRCANCL
009064              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009065
009066        IF DRLFRFDL GREATER THAN ZEROS
009067           MOVE AL-UNNON         TO DRLFRFDA
009068           
      * EXEC CICS BIF DEEDIT
009069*              FIELD  (DRLFRFDI)
009070*              LENGTH (11)
009071*          END-EXEC
           MOVE 11
             TO DFHEIV11
      *    MOVE '@"L                   #   #00016289' TO DFHEIV0
           MOVE X'40224C202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303136323839' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DRLFRFDI, 
                 DFHEIV11
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
009072           IF DRLFRFDI NUMERIC
009073              MOVE DRLFRFDI   TO WS-DRLFRFD
009074*          MOVE DRLFRFDI         TO DEEDIT-FIELD
009075*          PERFORM 8600-DEEDIT
009076*          IF DEEDIT-FIELD-V2  NUMERIC
009077*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
009078           ELSE
009079              MOVE ER-2223    TO EMI-ERROR
009080              MOVE -1         TO DRLFRFDL
009081              MOVE AL-UNBON   TO DRLFRFDA
009082              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009083
009084        IF DRAHRFDL GREATER THAN ZEROS
009085           MOVE AL-UNNON         TO DRAHRFDA
009086           
      * EXEC CICS BIF DEEDIT
009087*              FIELD  (DRAHRFDI)
009088*              LENGTH (11)
009089*          END-EXEC
           MOVE 11
             TO DFHEIV11
      *    MOVE '@"L                   #   #00016307' TO DFHEIV0
           MOVE X'40224C202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303136333037' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DRAHRFDI, 
                 DFHEIV11
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
009090           IF DRAHRFDI NUMERIC
009091              MOVE DRAHRFDI   TO WS-DRAHRFD
009092*          MOVE DRAHRFDI         TO DEEDIT-FIELD
009093*          PERFORM 8600-DEEDIT
009094*          IF DEEDIT-FIELD-V2  NUMERIC
009095*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
009096           ELSE
009097              MOVE ER-2223    TO EMI-ERROR
009098              MOVE -1         TO DRAHRFDL
009099              MOVE AL-UNBON   TO DRAHRFDA
009100              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009101
009102     IF EMI-ERROR = ZEROS
009103        GO 3600-UPDATE-BATCH-HEADER.
009104
009105     GO TO 8200-SEND-DATAONLY.
009106
009107 3590-NOT-FOUND.
009108     MOVE ER-2192                TO EMI-ERROR.
009109     MOVE -1                     TO DPFENTRL.
009110     MOVE AL-UNBON               TO DPFENTRA.
009111     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009112     GO TO 8200-SEND-DATAONLY.
009113
009114     EJECT
009115
009116******************************************************************
009117*                                                                *
009118*           U P D A T E   B A T C H   H E A D E R                *
009119*                                                                *
009120******************************************************************
009121
009122 3600-UPDATE-BATCH-HEADER.
009123     
      * EXEC CICS HANDLE CONDITION
009124*         NOTFND      (3690-NOT-FOUND)
009125*    END-EXEC.
      *    MOVE '"$I                   ! B #00016344' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'4220233030303136333434' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009126
009127     
      * EXEC CICS READ
009128*        DATASET (FILE-ID-ERPNDB)
009129*        RIDFLD  (ERPNDB-KEY)
009130*        SET     (ADDRESS OF PENDING-BUSINESS)
009131*        UPDATE
009132*    END-EXEC.
      *    MOVE '&"S        EU         (   #00016348' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303136333438' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009133
009134     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
009135     MOVE 'B'                    TO JP-RECORD-TYPE.
009136     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
009137
009138     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
009139
009140     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
009141
009142     IF DRISSL GREATER THAN ZEROS
009143        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
009144
009145     IF DRCANCL GREATER THAN ZEROS
009146        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
009147
009148
009149     IF DRLFPRML GREATER THAN ZEROS
009150        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
009151
009152     IF DRAHPRML GREATER THAN ZEROS
009153        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
009154
009155     IF DRLFRFDL GREATER THAN ZEROS
009156        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
009157
009158     IF DRAHRFDL GREATER THAN ZEROS
009159        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
009160
009161 3670-REWRITE-BATCH-HEADER.
009162     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
009163        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
009164        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
009165        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
009166        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
009167        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
009168        MOVE SPACE               TO PB-OUT-BAL-CD
009169     ELSE
009170        MOVE 'O'                 TO PB-OUT-BAL-CD.
009171
009172     MOVE 'C'                    TO JP-RECORD-TYPE.
009173     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
009174
009175     
      * EXEC CICS REWRITE
009176*         DATASET      (FILE-ID-ERPNDB)
009177*         FROM         (PENDING-BUSINESS)
009178*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00016396' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303136333936' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009179
009180     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
009181
009182     GO TO 7200-DISPLAY-BATCHES.
009183
009184 3690-NOT-FOUND.
009185     MOVE ER-2192                TO EMI-ERROR.
009186     MOVE -1                     TO DPFENTRL.
009187     MOVE AL-UNBON               TO DPFENTRA.
009188     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009189     GO TO 8200-SEND-DATAONLY.
009190
009191     EJECT
009192
009193******************************************************************
009194*                                                                *
009195*           R E - D I S P L A Y   R E C O R D                    *
009196*                                                                *
009197******************************************************************
009198
009199 3900-RE-DISPLAY-RECORD.
009200     
      * EXEC CICS HANDLE CONDITION
009201*         NOTFND   (3990-NOT-FOUND)
009202*    END-EXEC.
      *    MOVE '"$I                   ! C #00016421' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'4320233030303136343231' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009203
009204     IF PI-DISPLAY-ORIGINAL-BATCH
009205         MOVE FILE-ID-ERPNDB3     TO FILE-ID
009206     ELSE
009207         MOVE FILE-ID-ERPNDB      TO FILE-ID.
009208
009209     
      * EXEC CICS READ
009210*         DATASET   (FILE-ID)
009211*         RIDFLD    (PI-PREV-KEY)
009212*         SET       (ADDRESS OF PENDING-BUSINESS)
009213*    END-EXEC.
      *    MOVE '&"S        E          (   #00016430' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303136343330' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 PI-PREV-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009214
009215     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
009216
009217     IF PB-ISSUE
009218         GO TO 7000-DISPLAY-ISSUES.
009219
009220     IF PB-CANCELLATION
009221         GO TO 7100-DISPLAY-CANCELS.
009222
009223     IF PB-BATCH-TRAILER
009224         GO TO 7200-DISPLAY-BATCHES.
009225
009226 3990-NOT-FOUND.
009227     MOVE LOW-VALUES             TO EL631BI.
009228
009229     IF PI-MAP-NAME = EL631B
009230         MOVE -1                  TO BMAINTL
009231     ELSE
009232         MOVE -1                  TO CMAINTL.
009233
009234     GO TO 8100-SEND-INITIAL-MAP.
009235
009236     EJECT
009237
009238***************************************************************
009239*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
009240*                                                             *
009241*      1. START BROWSE WITH                                   *
009242*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
009243*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
009244*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
009245*                                                             *
009246*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
009247*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
009248*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
009249*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
009250*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
009251*               AND IS IT TO BE DISPLAYED.                    *
009252*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
009253*               DISPLAYED.                                    *
009254*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
009255*               DISPLAYED.                                    *
009256*                                                             *
009257*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
009258*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
009259***************************************************************
009260
009261 4000-BROWSE-DETAIL-FORWARD.
009262     IF FIRST-TIME
009263        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
009264     ELSE
009265        IF SHOW-RECORD
009266           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
009267           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
009268           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
009269           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
009270           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
009271        ELSE
009272           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
009273
009274     
      * EXEC CICS HANDLE CONDITION
009275*         NOTFND   (4050-END-RECORDS)
009276*         ENDFILE  (4050-END-RECORDS)
009277*    END-EXEC.
      *    MOVE '"$I''                  ! D #00016495' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'4420233030303136343935' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009278
009279     
      * EXEC CICS STARTBR
009280*         DATASET   (FILE-ID-ERPNDB2)
009281*         RIDFLD    (ERPNDB-ALT-KEY)
009282*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &   #00016500' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'2020233030303136353030' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB2, 
                 ERPNDB-ALT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009283
009284     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
009285
009286     IF FIRST-TIME OR SHOW-RECORD
009287        MOVE SPACE               TO WS-FIRST-TIME-SW
009288        GO TO 4005-READ-NEXT-RECORD.
009289
009290     
      * EXEC CICS READNEXT
009291*         DATASET    (FILE-ID-ERPNDB2)
009292*         SET        (ADDRESS OF PENDING-BUSINESS)
009293*         RIDFLD     (ERPNDB-ALT-KEY)
009294*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )   #00016511' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303136353131' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB2, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-ALT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009295
009296 4005-READ-NEXT-RECORD.
009297     
      * EXEC CICS READNEXT
009298*         DATASET    (FILE-ID-ERPNDB2)
009299*         SET        (ADDRESS OF PENDING-BUSINESS)
009300*         RIDFLD     (ERPNDB-ALT-KEY)
009301*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )   #00016518' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303136353138' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB2, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-ALT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009302
009303     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
009304
009305     IF WS-BATCH-PREFIX = '#CL'
009306        GO TO 4005-READ-NEXT-RECORD.
009307
009308     IF SHOW-RECORD
009309        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
009310           PB-CARRIER       NOT = PI-PB-CARRIER        OR
009311           PB-GROUPING      NOT = PI-PB-GROUPING       OR
009312           PB-STATE         NOT = PI-PB-STATE          OR
009313           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
009314           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
009315           PB-CERT-NO       NOT = WS-NEW-CERT-NO
009316           GO TO 4050-END-RECORDS
009317        ELSE
009318           GO TO 4010-CHECK-REC-TYPE.
009319
009320     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
009321        PB-CARRIER          NOT = PI-PB-CARRIER        OR
009322        PB-GROUPING         NOT = PI-PB-GROUPING       OR
009323        PB-STATE            NOT = PI-PB-STATE          OR
009324        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
009325        GO TO 4050-END-RECORDS.
009326
009327     IF PB-BATCH-TRAILER
009328        GO TO 4005-READ-NEXT-RECORD.
009329
009330     IF PI-PB-CERT-NO NOT = LOW-VALUES
009331        IF PI-PB-CERT-NO NOT = PB-CERT-NO
009332           GO TO 4005-READ-NEXT-RECORD
009333        ELSE
009334           IF PI-PB-CERT-EFF-DT = LOW-VALUES
009335              GO TO 4010-CHECK-REC-TYPE
009336           ELSE
009337              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
009338                 GO TO 4010-CHECK-REC-TYPE
009339              ELSE
009340                 GO TO 4005-READ-NEXT-RECORD.
009341
009342     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
009343        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
009344           GO TO 4005-READ-NEXT-RECORD.
009345
009346 4010-CHECK-REC-TYPE.
009347     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
009348         IF  PB-CARRIER = PI-CARRIER-SECURITY
009349             NEXT SENTENCE
009350         ELSE
009351             GO TO 4005-READ-NEXT-RECORD.
009352
009353     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
009354         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
009355             NEXT SENTENCE
009356        ELSE
009357             GO TO 4005-READ-NEXT-RECORD.
009358
009359     IF NOT DISPLAY-CHANGE-RECORDS AND
009360            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
009361        GO TO 4005-READ-NEXT-RECORD.
009362
009363     IF DISPLAY-HOLD-RECORDS AND
009364        NOT PB-RECORD-ON-HOLD
009365          GO TO 4005-READ-NEXT-RECORD.
009366
009367     IF PB-ISSUE
009368        IF DISPLAY-CHK-REQ-RECORDS
009369            GO TO 4005-READ-NEXT-RECORD.
009370
009371     IF PB-ISSUE
009372        IF ISSUE-WITH-WARNING
009373           IF PB-WARNING-ERRORS
009374              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
009375                  GO TO 4005-READ-NEXT-RECORD
009376              ELSE
009377                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009378                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009379                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009380                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009381                 MOVE PB-SV-STATE            TO PI-SV-STATE
009382                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
009383                 GO TO 7000-DISPLAY-ISSUES
009384           ELSE
009385              GO TO 4005-READ-NEXT-RECORD.
009386
009387     IF PB-ISSUE
009388        IF (ISSUES-IN-ERROR AND
009389            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
009390            ALL-ISSUES
009391            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009392            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009393            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009394            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009395            MOVE PB-SV-STATE            TO PI-SV-STATE
009396            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
009397            GO TO 7000-DISPLAY-ISSUES
009398        ELSE
009399            GO TO 4005-READ-NEXT-RECORD.
009400
009401     IF PB-CANCELLATION
009402        IF DISPLAY-CHK-REQ-RECORDS
009403           IF PB-C-REFUND-REQUESTED
009404              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009405              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009406              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009407              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009408              MOVE PB-SV-STATE            TO PI-SV-STATE
009409              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
009410              GO TO 7100-DISPLAY-CANCELS
009411           ELSE
009412               GO TO 4005-READ-NEXT-RECORD.
009413
009414     IF PB-CANCELLATION
009415        IF CANCEL-WITH-WARNING
009416           IF PB-WARNING-ERRORS
009417              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
009418                  GO TO 4005-READ-NEXT-RECORD
009419              ELSE
009420                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009421                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009422                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009423                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009424                 MOVE PB-SV-STATE            TO PI-SV-STATE
009425                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
009426                 GO TO 7100-DISPLAY-CANCELS
009427           ELSE
009428              GO TO 4005-READ-NEXT-RECORD.
009429
009430     IF PB-CANCELLATION
009431        IF (CANCEL-IN-ERROR  AND
009432            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
009433            ALL-CANCELS
009434            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009435            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009436            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009437            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009438            MOVE PB-SV-STATE            TO PI-SV-STATE
009439            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
009440            GO TO 7100-DISPLAY-CANCELS.
009441
009442     GO TO 4005-READ-NEXT-RECORD.
009443
009444 4050-END-RECORDS.
009445******************************************************************
009446*                                                                *
009447*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
009448*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
009449*         PROGRAM.                                               *
009450*                                                                *
009451******************************************************************
009452
009453     IF BROWSE-STARTED
009454        MOVE SPACE               TO WS-BROWSE-STARTED-SW
009455        
      * EXEC CICS ENDBR
009456*            DATASET  (FILE-ID-ERPNDB2)
009457*       END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00016676' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303136363736' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB2, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009458
009459     IF  EIBTRNID NOT = TRANS-EXB1
009460         IF PENDING-BUS-RECS-FOUND
009461             NEXT SENTENCE
009462           ELSE
009463             MOVE '9'            TO PI-BROWSE-SW
009464             GO TO 9400-CLEAR.
009465
009466     IF SHOW-RECORD
009467        MOVE ER-2253            TO EMI-ERROR
009468       ELSE
009469        MOVE ER-2254            TO EMI-ERROR.
009470
009471     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009472
009473     IF PI-MAP-NAME = SPACES
009474        MOVE -1                  TO DPFENTRL
009475        MOVE EL631D               TO PI-MAP-NAME
009476        GO TO 8100-SEND-INITIAL-MAP.
009477
009478     IF PI-MAP-NAME = EL631B
009479        MOVE -1                  TO BMAINTL
009480     ELSE
009481        IF PI-MAP-NAME = EL631C
009482           MOVE -1               TO CMAINTL
009483        ELSE
009484           MOVE -1               TO DPFENTRL.
009485
009486     GO TO 8200-SEND-DATAONLY.
009487
009488     EJECT
009489
009490***************************************************************
009491*                                                             *
009492*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
009493*                                                             *
009494*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
009495*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
009496*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
009497*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
009498*                                                             *
009499*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
009500*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
009501*          A. IS IT WITHIN THE SAME KEY GROUP?                *
009502*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
009503*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
009504*                AND IS IT TO BE DISPLAYED.                   *
009505*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
009506*                DISPLAYED.                                   *
009507*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
009508*                DISPLAYED.                                   *
009509*                                                             *
009510*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
009511*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
009512*                                                             *
009513*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
009514*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
009515*                THEY ARE NOT TO BE DISPLAYED.                *
009516*                                                             *
009517***************************************************************
009518
009519 4100-BROWSE-PRIMARY-FORWARD.
009520     IF FIRST-TIME  OR SHOW-RECORD
009521        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
009522        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
009523        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
009524     ELSE
009525        MOVE PI-PREV-KEY           TO ERPNDB-KEY
009526        IF ERPNDB-BATCH-SEQ-NO = +9999
009527           GO TO 4150-END-BATCH
009528        ELSE
009529           IF DISPLAY-CHANGE-RECORDS
009530              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
009531           ELSE
009532              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
009533              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
009534
009535     IF FIRST-TIME
009536         IF ERPNDB-BATCH-SEQ-NO = +1  AND
009537            PI-PB-BATCH-SEQ-NO NOT = ZERO
009538              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
009539
009540     
      * EXEC CICS HANDLE CONDITION
009541*         ENDFILE  (4150-END-BATCH)
009542*    END-EXEC.
      *    MOVE '"$''                   ! E #00016761' TO DFHEIV0
           MOVE X'222427202020202020202020' &
                X'202020202020202020202120' &
                X'4520233030303136373631' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009543
009544 4105-READ-NEXT.
009545     
      * EXEC CICS HANDLE CONDITION
009546*         NOTFND    (4150-END-BATCH)
009547*    END-EXEC.
      *    MOVE '"$I                   ! F #00016766' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'4620233030303136373636' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009548
009549     MOVE SPACES                 TO WS-REC-FOUND-SW.
009550
009551     IF PI-DISPLAY-ORIGINAL-BATCH
009552        MOVE FILE-ID-ERPNDB3     TO FILE-ID
009553     ELSE
009554        MOVE FILE-ID-ERPNDB      TO FILE-ID.
009555
009556     
      * EXEC CICS READ
009557*         DATASET   (FILE-ID)
009558*         SET       (ADDRESS OF PENDING-BUSINESS)
009559*         RIDFLD    (ERPNDB-KEY)
009560*         GTEQ
009561*    END-EXEC.
      *    MOVE '&"S        G          (   #00016777' TO DFHEIV0
           MOVE X'262253202020202020202047' &
                X'202020202020202020202820' &
                X'2020233030303136373737' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009562
009563     IF PI-DISPLAY-ORIGINAL-BATCH
009564        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
009565           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
009566           GO TO 4150-END-BATCH
009567        ELSE
009568           IF PB-BATCH-TRAILER
009569              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
009570              GO TO 4105-READ-NEXT
009571           ELSE
009572              NEXT SENTENCE
009573     ELSE
009574        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
009575           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
009576           GO TO 4150-END-BATCH.
009577
009578     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
009579
009580     IF WS-BATCH-PREFIX = '#CL'
009581         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
009582         GO TO 4105-READ-NEXT.
009583
009584     MOVE PB-CARRIER             TO PI-PB-CARRIER.
009585     MOVE PB-GROUPING            TO PI-PB-GROUPING.
009586     MOVE PB-STATE               TO PI-PB-STATE.
009587     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
009588
009589     IF PB-BATCH-TRAILER
009590        IF SHOW-RECORD
009591           GO TO 4150-END-BATCH
009592        ELSE
009593           MOVE ER-2251         TO EMI-ERROR
009594           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009595           MOVE 1               TO PI-BROWSE-TYPE
009596           GO TO 7200-DISPLAY-BATCHES.
009597
009598     IF SHOW-RECORD
009599           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
009600              GO TO 4110-BUMP-SEQ
009601           ELSE
009602              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
009603                 GO TO 4110-BUMP-SEQ
009604              ELSE
009605                 GO TO 4107-CHECK-REC-TYPE.
009606
009607     IF NOT  PI-PRIMARY-WITH-SELECT
009608        GO TO 4107-CHECK-REC-TYPE.
009609
009610     IF PI-PB-CERT-NO NOT = LOW-VALUES
009611        IF PI-PB-CERT-NO NOT = PB-CERT-NO
009612           GO TO 4110-BUMP-SEQ
009613        ELSE
009614           IF PI-PB-CERT-EFF-DT = LOW-VALUES
009615              GO TO 4107-CHECK-REC-TYPE
009616           ELSE
009617              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
009618                 GO TO 4107-CHECK-REC-TYPE
009619              ELSE
009620                 GO TO 4110-BUMP-SEQ.
009621
009622     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
009623        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
009624           GO TO 4110-BUMP-SEQ.
009625
009626 4107-CHECK-REC-TYPE.
009627     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
009628         IF  PB-CARRIER = PI-CARRIER-SECURITY
009629             NEXT SENTENCE
009630           ELSE
009631             GO TO 4110-BUMP-SEQ.
009632
009633     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
009634         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
009635             NEXT SENTENCE
009636           ELSE
009637             GO TO 4110-BUMP-SEQ.
009638
009639     IF NOT DISPLAY-CHANGE-RECORDS AND
009640        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
009641           GO TO 4110-BUMP-SEQ.
009642
009643     IF DISPLAY-HOLD-RECORDS AND
009644        NOT PB-RECORD-ON-HOLD
009645          GO TO 4110-BUMP-SEQ.
009646
009647     IF PB-ISSUE
009648        IF DISPLAY-CHK-REQ-RECORDS
009649            GO TO 4110-BUMP-SEQ.
009650
009651     IF PB-ISSUE
009652        IF ISSUE-WITH-WARNING
009653           IF PB-WARNING-ERRORS
009654              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
009655                  GO TO 4110-BUMP-SEQ
009656              ELSE
009657                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009658                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009659                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009660                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009661                 MOVE PB-SV-STATE            TO PI-SV-STATE
009662                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
009663                 GO TO 7000-DISPLAY-ISSUES
009664        ELSE
009665            GO TO 4110-BUMP-SEQ.
009666
009667     IF PB-ISSUE
009668        IF (ISSUES-IN-ERROR AND
009669            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
009670            ALL-ISSUES
009671            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009672            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009673            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009674            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009675            MOVE PB-SV-STATE            TO PI-SV-STATE
009676            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
009677            GO TO 7000-DISPLAY-ISSUES
009678        ELSE
009679            GO TO 4110-BUMP-SEQ.
009680
009681     IF PB-CANCELLATION
009682        IF DISPLAY-CHK-REQ-RECORDS
009683           IF PB-C-REFUND-REQUESTED
009684              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009685              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009686              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009687              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009688              MOVE PB-SV-STATE            TO PI-SV-STATE
009689              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
009690              GO TO 7100-DISPLAY-CANCELS
009691           ELSE
009692              GO TO 4110-BUMP-SEQ.
009693
009694     IF PB-CANCELLATION
009695        IF CANCEL-WITH-WARNING
009696           IF PB-WARNING-ERRORS
009697              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
009698                  GO TO 4110-BUMP-SEQ
009699              ELSE
009700                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009701                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009702                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009703                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009704                 MOVE PB-SV-STATE            TO PI-SV-STATE
009705                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
009706                 GO TO 7100-DISPLAY-CANCELS
009707           ELSE
009708              GO TO 4110-BUMP-SEQ.
009709
009710     IF PB-CANCELLATION
009711        IF (CANCEL-IN-ERROR  AND
009712            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
009713            ALL-CANCELS
009714            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009715            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009716            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009717            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009718            MOVE PB-SV-STATE            TO PI-SV-STATE
009719            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
009720            GO TO 7100-DISPLAY-CANCELS.
009721
009722 4110-BUMP-SEQ.
009723     IF NOT DISPLAY-CHANGE-RECORDS
009724        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
009725        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
009726     ELSE
009727        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
009728           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
009729           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
009730        ELSE
009731           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
009732           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
009733
009734     GO TO 4105-READ-NEXT.
009735
009736 4150-END-BATCH.
009737******************************************************************
009738*                                                                *
009739*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
009740*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
009741*         PROGRAM.                                               *
009742*                                                                *
009743******************************************************************
009744
009745     IF  EIBTRNID NOT = TRANS-EXB1
009746         IF PENDING-BUS-RECS-FOUND
009747             NEXT SENTENCE
009748           ELSE
009749             MOVE '9'            TO PI-BROWSE-SW
009750             GO TO 9400-CLEAR.
009751
009752     IF SHOW-RECORD
009753        MOVE ER-2253             TO EMI-ERROR
009754     ELSE
009755        MOVE ER-2251             TO EMI-ERROR.
009756
009757     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009758
009759     IF PI-MAP-NAME = SPACES
009760        MOVE -1                  TO BMAINTL
009761        MOVE EL631B              TO PI-MAP-NAME
009762        GO TO 8100-SEND-INITIAL-MAP.
009763
009764     IF PI-MAP-NAME = EL631B
009765        MOVE -1                  TO BMAINTL
009766     ELSE
009767        IF PI-MAP-NAME = EL631C
009768           MOVE -1               TO CMAINTL
009769        ELSE
009770           MOVE -1               TO DPFENTRL.
009771
009772     GO TO 8200-SEND-DATAONLY.
009773
009774     EJECT
009775
009776***************************************************************
009777*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
009778*                                                             *
009779*      1. START BROWSE WITH                                   *
009780*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
009781*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
009782*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
009783*                                                             *
009784*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
009785*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
009786*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
009787*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
009788*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
009789*               AND IS IT TO BE DISPLAYED.                    *
009790*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
009791*               DISPLAYED.                                    *
009792*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
009793*               DISPLAYED.                                    *
009794*                                                             *
009795*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
009796*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
009797***************************************************************
009798
009799 4200-BROWSE-CSR-FORWARD.
009800
009801     IF FIRST-TIME
009802        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
009803     ELSE
009804        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
009805
009806     
      * EXEC CICS HANDLE CONDITION
009807*         NOTFND   (4250-END-RECORDS)
009808*         ENDFILE  (4250-END-RECORDS)
009809*    END-EXEC.
      *    MOVE '"$I''                  ! G #00017027' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'4720233030303137303237' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009810
009811     
      * EXEC CICS STARTBR
009812*         DATASET   (FILE-ID-ERPNDB4)
009813*         RIDFLD    (ERPNDB-CSR-KEY)
009814*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &   #00017032' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'2020233030303137303332' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB4, 
                 ERPNDB-CSR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009815
009816     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
009817
009818     IF FIRST-TIME
009819        MOVE SPACE               TO WS-FIRST-TIME-SW
009820        GO TO 4205-READ-NEXT-RECORD.
009821
009822     
      * EXEC CICS READNEXT
009823*         DATASET    (FILE-ID-ERPNDB4)
009824*         SET        (ADDRESS OF PENDING-BUSINESS)
009825*         RIDFLD     (ERPNDB-CSR-KEY)
009826*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )   #00017043' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303137303433' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB4, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-CSR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009827
009828 4205-READ-NEXT-RECORD.
009829
009830     
      * EXEC CICS READNEXT
009831*         DATASET    (FILE-ID-ERPNDB4)
009832*         SET        (ADDRESS OF PENDING-BUSINESS)
009833*         RIDFLD     (ERPNDB-CSR-KEY)
009834*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )   #00017051' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303137303531' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB4, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-CSR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009835
009836     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
009837
009838     IF WS-BATCH-PREFIX = '#CL'
009839        GO TO 4205-READ-NEXT-RECORD.
009840
009841     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
009842        PB-CSR-ID           NOT = PI-PB-CSR-ID
009843        GO TO 4250-END-RECORDS.
009844
009845     IF PB-BATCH-TRAILER
009846        GO TO 4205-READ-NEXT-RECORD.
009847
009848     IF PI-PB-CERT-NO NOT = LOW-VALUES
009849        IF PI-PB-CERT-NO NOT = PB-CERT-NO
009850           GO TO 4205-READ-NEXT-RECORD
009851        ELSE
009852           IF PI-PB-CERT-EFF-DT = LOW-VALUES
009853              GO TO 4210-CHECK-REC-TYPE
009854           ELSE
009855              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
009856                 GO TO 4210-CHECK-REC-TYPE
009857              ELSE
009858                 GO TO 4205-READ-NEXT-RECORD.
009859
009860     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
009861        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
009862           GO TO 4205-READ-NEXT-RECORD.
009863
009864 4210-CHECK-REC-TYPE.
009865     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
009866         IF  PB-CARRIER = PI-CARRIER-SECURITY
009867             NEXT SENTENCE
009868         ELSE
009869             GO TO 4205-READ-NEXT-RECORD.
009870
009871     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
009872         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
009873             NEXT SENTENCE
009874        ELSE
009875             GO TO 4205-READ-NEXT-RECORD.
009876
009877     IF NOT DISPLAY-CHANGE-RECORDS AND
009878            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
009879        GO TO 4205-READ-NEXT-RECORD.
009880
009881     IF DISPLAY-HOLD-RECORDS AND
009882        NOT PB-RECORD-ON-HOLD
009883          GO TO 4205-READ-NEXT-RECORD.
009884
009885     IF PB-ISSUE
009886        IF DISPLAY-CHK-REQ-RECORDS
009887            GO TO 4205-READ-NEXT-RECORD.
009888
009889     IF PB-ISSUE
009890        IF ISSUE-WITH-WARNING
009891           IF PB-WARNING-ERRORS
009892              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
009893                  GO TO 4205-READ-NEXT-RECORD
009894              ELSE
009895                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009896                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
009897                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009898                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009899                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009900                 MOVE PB-SV-STATE            TO PI-SV-STATE
009901                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
009902                 GO TO 7000-DISPLAY-ISSUES
009903           ELSE
009904              GO TO 4205-READ-NEXT-RECORD.
009905
009906     IF PB-ISSUE
009907        IF (ISSUES-IN-ERROR AND
009908            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
009909            ALL-ISSUES
009910            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009911            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
009912            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009913            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009914            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009915            MOVE PB-SV-STATE            TO PI-SV-STATE
009916            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
009917            GO TO 7000-DISPLAY-ISSUES
009918        ELSE
009919            GO TO 4205-READ-NEXT-RECORD.
009920
009921     IF PB-CANCELLATION
009922        IF DISPLAY-CHK-REQ-RECORDS
009923           IF PB-C-REFUND-REQUESTED
009924              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009925              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
009926              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009927              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009928              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009929              MOVE PB-SV-STATE            TO PI-SV-STATE
009930              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
009931              GO TO 7100-DISPLAY-CANCELS
009932           ELSE
009933               GO TO 4205-READ-NEXT-RECORD.
009934
009935     IF PB-CANCELLATION
009936        IF CANCEL-WITH-WARNING
009937           IF PB-WARNING-ERRORS
009938              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
009939                  GO TO 4205-READ-NEXT-RECORD
009940              ELSE
009941                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009942                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
009943                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009944                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009945                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009946                 MOVE PB-SV-STATE            TO PI-SV-STATE
009947                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
009948                 GO TO 7100-DISPLAY-CANCELS
009949           ELSE
009950              GO TO 4205-READ-NEXT-RECORD.
009951
009952     IF PB-CANCELLATION
009953        IF (CANCEL-IN-ERROR  AND
009954            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
009955            ALL-CANCELS
009956            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
009957            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
009958            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
009959            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
009960            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
009961            MOVE PB-SV-STATE            TO PI-SV-STATE
009962            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
009963            GO TO 7100-DISPLAY-CANCELS.
009964
009965     GO TO 4205-READ-NEXT-RECORD.
009966
009967 4250-END-RECORDS.
009968******************************************************************
009969*                                                                *
009970*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
009971*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
009972*         PROGRAM.                                               *
009973*                                                                *
009974******************************************************************
009975
009976     IF BROWSE-STARTED
009977        MOVE SPACE               TO WS-BROWSE-STARTED-SW
009978        
      * EXEC CICS ENDBR
009979*            DATASET  (FILE-ID-ERPNDB4)
009980*       END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00017199' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303137313939' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB4, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
009981
009982     IF  EIBTRNID NOT = TRANS-EXB1
009983         IF PENDING-BUS-RECS-FOUND
009984             NEXT SENTENCE
009985           ELSE
009986             MOVE '9'            TO PI-BROWSE-SW
009987             GO TO 9400-CLEAR.
009988
009989     IF SHOW-RECORD
009990        MOVE ER-2253            TO EMI-ERROR
009991       ELSE
009992        MOVE ER-2254            TO EMI-ERROR.
009993
009994     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009995
009996     IF PI-MAP-NAME = SPACES
009997        MOVE -1                  TO DPFENTRL
009998        MOVE EL631D               TO PI-MAP-NAME
009999        GO TO 8100-SEND-INITIAL-MAP.
010000
010001     IF PI-MAP-NAME = EL631B
010002        MOVE -1                  TO BMAINTL
010003     ELSE
010004        IF PI-MAP-NAME = EL631C
010005           MOVE -1               TO CMAINTL
010006        ELSE
010007           MOVE -1               TO DPFENTRL.
010008
010009     GO TO 8200-SEND-DATAONLY.
010010
010011     EJECT
010012
010013***************************************************************
010014*                                                             *
010015*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
010016*                                                             *
010017*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
010018*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
010019*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
010020*                                                             *
010021*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
010022*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
010023*          A. IS IT WITHIN THE SAME COMPANY                   *
010024*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
010025*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
010026*                AND IS IT TO BE DISPLAYED.                   *
010027*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
010028*                DISPLAYED.                                   *
010029*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
010030*                DISPLAYED.                                   *
010031*                                                             *
010032*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
010033*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
010034*                                                             *
010035*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
010036*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
010037*                THEY ARE NOT TO BE DISPLAYED.                *
010038*                                                             *
010039***************************************************************
010040
010041 4300-BROWSE-FILE-FORWARD.
010042     IF FIRST-TIME OR SHOW-RECORD
010043        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
010044        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
010045        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
010046     ELSE
010047        MOVE PI-PREV-KEY         TO ERPNDB-KEY
010048        IF ERPNDB-BATCH-SEQ-NO = +9999
010049           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
010050        ELSE
010051           IF DISPLAY-CHANGE-RECORDS
010052              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
010053           ELSE
010054              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
010055              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
010056
010057     
      * EXEC CICS HANDLE CONDITION
010058*         ENDFILE  (4350-END-BATCH)
010059*         NOTFND   (4350-END-BATCH)
010060*    END-EXEC.
      *    MOVE '"$''I                  ! H #00017278' TO DFHEIV0
           MOVE X'222427492020202020202020' &
                X'202020202020202020202120' &
                X'4820233030303137323738' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010061
010062 4305-READ-NEXT.
010063     IF PI-DISPLAY-ORIGINAL-BATCH
010064        MOVE FILE-ID-ERPNDB3     TO FILE-ID
010065     ELSE
010066        MOVE FILE-ID-ERPNDB      TO FILE-ID.
010067
010068     
      * EXEC CICS READ
010069*         DATASET   (FILE-ID)
010070*         SET       (ADDRESS OF PENDING-BUSINESS)
010071*         RIDFLD    (ERPNDB-KEY)
010072*         GTEQ
010073*    END-EXEC.
      *    MOVE '&"S        G          (   #00017289' TO DFHEIV0
           MOVE X'262253202020202020202047' &
                X'202020202020202020202820' &
                X'2020233030303137323839' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010074
010075     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
010076        GO TO 4350-END-BATCH.
010077
010078     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
010079                                    WS-BATCH-NO.
010080
010081     IF  WS-BATCH-PREFIX = '#CL'
010082         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
010083         GO TO 4305-READ-NEXT.
010084
010085     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
010086     MOVE PB-CARRIER             TO PI-PB-CARRIER.
010087     MOVE PB-GROUPING            TO PI-PB-GROUPING.
010088     MOVE PB-STATE               TO PI-PB-STATE.
010089     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
010090
010091     IF PB-BATCH-TRAILER
010092        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
010093        GO TO 4305-READ-NEXT.
010094
010095     IF SHOW-RECORD
010096           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
010097              GO TO 4310-BUMP-SEQ
010098           ELSE
010099              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
010100                 GO TO 4310-BUMP-SEQ
010101              ELSE
010102                 GO TO 4307-CHECK-REC-TYPE.
010103
010104     IF PI-PB-CERT-NO NOT = LOW-VALUES
010105        IF PI-PB-CERT-NO NOT = PB-CERT-NO
010106           GO TO 4310-BUMP-SEQ
010107        ELSE
010108           IF PI-PB-CERT-EFF-DT = LOW-VALUES
010109              GO TO 4307-CHECK-REC-TYPE
010110           ELSE
010111              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
010112                 GO TO 4307-CHECK-REC-TYPE
010113              ELSE
010114                 GO TO 4310-BUMP-SEQ.
010115
010116     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
010117        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
010118           GO TO 4310-BUMP-SEQ.
010119
010120 4307-CHECK-REC-TYPE.
010121     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
010122         IF  PB-CARRIER = PI-CARRIER-SECURITY
010123             NEXT SENTENCE
010124         ELSE
010125             GO TO 4310-BUMP-SEQ.
010126
010127     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
010128         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
010129             NEXT SENTENCE
010130        ELSE
010131             GO TO 4310-BUMP-SEQ.
010132
010133     IF NOT DISPLAY-CHANGE-RECORDS AND
010134            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
010135        GO TO 4310-BUMP-SEQ.
010136
010137     IF DISPLAY-HOLD-RECORDS AND
010138        NOT PB-RECORD-ON-HOLD
010139          GO TO 4310-BUMP-SEQ.
010140
010141     IF PB-ISSUE
010142        IF DISPLAY-CHK-REQ-RECORDS
010143           GO TO 4310-BUMP-SEQ.
010144
010145     IF PB-ISSUE
010146        IF ISSUE-WITH-WARNING
010147           IF PB-WARNING-ERRORS
010148              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
010149                  GO TO 4310-BUMP-SEQ
010150              ELSE
010151                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010152                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010153                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010154                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010155                 MOVE PB-SV-STATE            TO PI-SV-STATE
010156                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010157                 GO TO 7000-DISPLAY-ISSUES
010158           ELSE
010159              GO TO 4310-BUMP-SEQ.
010160
010161     IF PB-ISSUE
010162        IF (ISSUES-IN-ERROR AND
010163            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
010164            ALL-ISSUES
010165            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010166            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010167            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010168            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010169            MOVE PB-SV-STATE            TO PI-SV-STATE
010170            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010171            GO TO 7000-DISPLAY-ISSUES
010172        ELSE
010173            GO TO 4310-BUMP-SEQ.
010174
010175     IF PB-CANCELLATION
010176        IF DISPLAY-CHK-REQ-RECORDS
010177           IF PB-C-REFUND-REQUESTED
010178              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010179              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010180              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010181              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010182              MOVE PB-SV-STATE            TO PI-SV-STATE
010183              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010184              GO TO 7100-DISPLAY-CANCELS
010185           ELSE
010186              GO TO 4310-BUMP-SEQ.
010187
010188     IF PB-CANCELLATION
010189        IF CANCEL-WITH-WARNING
010190           IF PB-WARNING-ERRORS
010191              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
010192                  GO TO 4310-BUMP-SEQ
010193              ELSE
010194                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010195                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010196                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010197                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010198                 MOVE PB-SV-STATE            TO PI-SV-STATE
010199                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010200                 GO TO 7100-DISPLAY-CANCELS
010201           ELSE
010202              GO TO 4310-BUMP-SEQ.
010203
010204     IF PB-CANCELLATION
010205        IF (CANCEL-IN-ERROR  AND
010206            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
010207            ALL-CANCELS
010208            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010209            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010210            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010211            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010212            MOVE PB-SV-STATE            TO PI-SV-STATE
010213            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010214            GO TO 7100-DISPLAY-CANCELS.
010215
010216 4310-BUMP-SEQ.
010217     IF NOT DISPLAY-CHANGE-RECORDS
010218        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
010219        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
010220     ELSE
010221        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
010222           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
010223           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
010224        ELSE
010225           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
010226           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
010227
010228     GO TO 4305-READ-NEXT.
010229
010230 4350-END-BATCH.
010231
010232******************************************************************
010233*                                                                *
010234*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
010235*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
010236*         PROGRAM.                                               *
010237*                                                                *
010238******************************************************************
010239
010240     IF  EIBTRNID NOT = TRANS-EXB1
010241         IF PENDING-BUS-RECS-FOUND
010242             NEXT SENTENCE
010243           ELSE
010244             MOVE '9'            TO PI-BROWSE-SW
010245             GO TO 9400-CLEAR.
010246
010247     IF SHOW-RECORD
010248        MOVE ER-2253            TO EMI-ERROR
010249     ELSE
010250        MOVE ER-2251            TO EMI-ERROR.
010251
010252     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
010253
010254     IF PI-MAP-NAME = SPACES
010255        MOVE -1                  TO BMAINTL
010256        MOVE EL631B               TO PI-MAP-NAME
010257        GO TO 8100-SEND-INITIAL-MAP.
010258
010259     IF PI-MAP-NAME = EL631B
010260        MOVE -1                  TO BMAINTL
010261     ELSE
010262        IF PI-MAP-NAME = EL631C
010263           MOVE -1               TO CMAINTL
010264        ELSE
010265           MOVE -1               TO DPFENTRL.
010266
010267     GO TO 8200-SEND-DATAONLY.
010268
010269     EJECT
010270
010271******************************************************************
010272*                                                                *
010273*        B R O W S E   D E T A I L   B A C K W A R D             *
010274*                                                                *
010275******************************************************************
010276
010277 4500-BROWSE-DETAIL-BACKWARD.
010278
010279     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
010280
010281     
      * EXEC CICS HANDLE CONDITION
010282*         NOTFND   (4570-NOT-FOUND)
010283*         ENDFILE  (4550-END-RECORDS)
010284*    END-EXEC
      *    MOVE '"$I''                  ! I #00017502' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'4920233030303137353032' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
010285
010286     
      * EXEC CICS STARTBR
010287*         DATASET   (FILE-ID-ERPNDB2)
010288*         RIDFLD    (ERPNDB-ALT-KEY)
010289*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &   #00017507' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'2020233030303137353037' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB2, 
                 ERPNDB-ALT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010290
010291     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
010292                                    WS-FIRST-TIME-SW.
010293
010294 4505-READ-PREV-RECORD.
010295     
      * EXEC CICS READPREV
010296*         DATASET    (FILE-ID-ERPNDB2)
010297*         SET        (ADDRESS OF PENDING-BUSINESS)
010298*         RIDFLD     (ERPNDB-ALT-KEY)
010299*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&0S                   )   #00017516' TO DFHEIV0
           MOVE X'263053202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303137353136' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB2, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-ALT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010300
010301     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
010302
010303     IF WS-BATCH-PREFIX = '#CL'
010304         GO TO 4505-READ-PREV-RECORD.
010305
010306     IF FIRST-TIME
010307         MOVE SPACE               TO WS-FIRST-TIME-SW
010308         GO TO 4505-READ-PREV-RECORD.
010309
010310     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
010311        PB-CARRIER       NOT = PI-PB-CARRIER  OR
010312        PB-GROUPING      NOT = PI-PB-GROUPING OR
010313        PB-STATE         NOT = PI-PB-STATE    OR
010314        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
010315          GO TO 4550-END-RECORDS.
010316
010317
010318     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
010319
010320     IF PB-BATCH-TRAILER
010321        GO TO 4505-READ-PREV-RECORD.
010322
010323     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
010324
010325     IF  WS-BATCH-PREFIX = '#CL'
010326         GO TO 4505-READ-PREV-RECORD.
010327
010328     IF PI-PB-CERT-NO NOT = LOW-VALUES
010329        IF PI-PB-CERT-NO NOT = PB-CERT-NO
010330           GO TO 4505-READ-PREV-RECORD
010331        ELSE
010332           IF PI-PB-CERT-EFF-DT = LOW-VALUES
010333              GO TO 4510-CHECK-REC-TYPE
010334           ELSE
010335              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
010336                 GO TO 4510-CHECK-REC-TYPE
010337              ELSE
010338                 GO TO 4505-READ-PREV-RECORD.
010339
010340     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
010341        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
010342           GO TO 4505-READ-PREV-RECORD.
010343
010344 4510-CHECK-REC-TYPE.
010345     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
010346         IF  PB-CARRIER = PI-CARRIER-SECURITY
010347             NEXT SENTENCE
010348         ELSE
010349             GO TO 4505-READ-PREV-RECORD.
010350
010351     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
010352         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
010353             NEXT SENTENCE
010354        ELSE
010355             GO TO 4505-READ-PREV-RECORD.
010356
010357     IF NOT DISPLAY-CHANGE-RECORDS AND
010358            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
010359        GO TO 4505-READ-PREV-RECORD.
010360
010361     IF DISPLAY-HOLD-RECORDS AND
010362        NOT PB-RECORD-ON-HOLD
010363          GO TO 4505-READ-PREV-RECORD.
010364
010365     IF PB-ISSUE
010366        IF DISPLAY-CHK-REQ-RECORDS
010367           GO TO 4505-READ-PREV-RECORD.
010368
010369     IF PB-ISSUE
010370        IF ISSUE-WITH-WARNING
010371           IF PB-WARNING-ERRORS
010372              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
010373                  GO TO 4505-READ-PREV-RECORD
010374              ELSE
010375                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010376                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010377                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010378                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010379                 MOVE PB-SV-STATE            TO PI-SV-STATE
010380                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010381                 GO TO 7000-DISPLAY-ISSUES
010382           ELSE
010383              GO TO 4505-READ-PREV-RECORD.
010384
010385     IF PB-ISSUE
010386        IF (ISSUES-IN-ERROR AND
010387            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
010388            ALL-ISSUES
010389            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010390            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010391            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010392            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010393            MOVE PB-SV-STATE            TO PI-SV-STATE
010394            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010395            GO TO 7000-DISPLAY-ISSUES
010396        ELSE
010397            GO TO 4505-READ-PREV-RECORD.
010398
010399     IF PB-CANCELLATION
010400        IF DISPLAY-CHK-REQ-RECORDS
010401           IF PB-C-REFUND-REQUESTED
010402              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010403              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010404              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010405              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010406              MOVE PB-SV-STATE            TO PI-SV-STATE
010407              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010408              GO TO 7100-DISPLAY-CANCELS
010409           ELSE
010410              GO TO 4505-READ-PREV-RECORD.
010411
010412     IF PB-CANCELLATION
010413        IF CANCEL-WITH-WARNING
010414           IF PB-WARNING-ERRORS
010415              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
010416                  GO TO 4505-READ-PREV-RECORD
010417              ELSE
010418                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010419                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010420                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010421                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010422                 MOVE PB-SV-STATE            TO PI-SV-STATE
010423                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010424                 GO TO 7100-DISPLAY-CANCELS
010425           ELSE
010426              GO TO 4505-READ-PREV-RECORD.
010427
010428     IF PB-CANCELLATION
010429        IF (CANCEL-IN-ERROR  AND
010430            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
010431            ALL-CANCELS
010432            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010433            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010434            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010435            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010436            MOVE PB-SV-STATE            TO PI-SV-STATE
010437            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010438            GO TO 7100-DISPLAY-CANCELS.
010439
010440     GO TO 4505-READ-PREV-RECORD.
010441
010442 4550-END-RECORDS.
010443     IF PI-MAP-NAME = EL631B
010444        MOVE -1                  TO BMAINTL
010445     ELSE
010446        IF PI-MAP-NAME = EL631C
010447           MOVE -1               TO CMAINTL
010448        ELSE
010449           MOVE -1               TO DPFENTRL.
010450
010451     MOVE ER-2255               TO EMI-ERROR.
010452     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
010453     GO TO 8200-SEND-DATAONLY.
010454
010455 4570-NOT-FOUND.
010456
010457******************************************************************
010458*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
010459******************************************************************
010460
010461     
      * EXEC CICS RESETBR
010462*         DATASET    (FILE-ID-ERPNDB2)
010463*         RIDFLD     (ERPNDB-ALT-KEY)
010464*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&4         G          &   #00017682' TO DFHEIV0
           MOVE X'263420202020202020202047' &
                X'202020202020202020202620' &
                X'2020233030303137363832' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB2, 
                 ERPNDB-ALT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010465
010466     
      * EXEC CICS READNEXT
010467*         DATASET    (FILE-ID-ERPNDB2)
010468*         SET        (ADDRESS OF PENDING-BUSINESS)
010469*         RIDFLD     (ERPNDB-ALT-KEY)
010470*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )   #00017687' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303137363837' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB2, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-ALT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010471
010472     
      * EXEC CICS READPREV
010473*         DATASET    (FILE-ID-ERPNDB2)
010474*         SET        (ADDRESS OF PENDING-BUSINESS)
010475*         RIDFLD     (ERPNDB-ALT-KEY)
010476*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&0S                   )   #00017693' TO DFHEIV0
           MOVE X'263053202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303137363933' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB2, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-ALT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010477
010478 4580-READ-PREV-RECORD.
010479     
      * EXEC CICS READPREV
010480*         DATASET    (FILE-ID-ERPNDB2)
010481*         SET        (ADDRESS OF PENDING-BUSINESS)
010482*         RIDFLD     (ERPNDB-ALT-KEY)
010483*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&0S                   )   #00017700' TO DFHEIV0
           MOVE X'263053202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303137373030' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB2, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-ALT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010484
010485     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
010486
010487     IF WS-BATCH-PREFIX = '#CL'
010488        GO TO 4580-READ-PREV-RECORD.
010489
010490     MOVE SPACE                  TO WS-FIRST-TIME-SW.
010491     GO TO 4505-READ-PREV-RECORD.
010492
010493     EJECT
010494
010495******************************************************************
010496*                                                                *
010497*        B R O W S E   P R I M A R Y   B A C K W A R D           *
010498*                                                                *
010499******************************************************************
010500
010501 4600-BROWSE-PRIMARY-BACKWARD.
010502        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
010503
010504     IF ERPNDB-BATCH-SEQ-NO = +9999
010505        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
010506
010507        IF ERPNDB-BATCH-SEQ-NO = +0000
010508           GO TO 4650-END-BATCH
010509        ELSE
010510           IF PI-MAP-NAME NOT = EL631D
010511              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
010512                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
010513              ELSE
010514                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
010515                 IF DISPLAY-CHANGE-RECORDS
010516                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
010517                 ELSE
010518                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
010519
010520     
      * EXEC CICS HANDLE CONDITION
010521*         NOTFND    (4680-NOT-FOUND)
010522*         ENDFILE   (4680-NOT-FOUND)
010523*    END-EXEC.
      *    MOVE '"$I''                  ! J #00017741' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'4A20233030303137373431' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010524
010525 4605-READ-NEXT.
010526     IF ERPNDB-BATCH-SEQ-NO = +0000
010527        GO TO 4650-END-BATCH.
010528
010529     IF PI-DISPLAY-ORIGINAL-BATCH
010530        MOVE FILE-ID-ERPNDB3     TO FILE-ID
010531     ELSE
010532        MOVE FILE-ID-ERPNDB      TO FILE-ID.
010533
010534     
      * EXEC CICS READ
010535*         DATASET   (FILE-ID)
010536*         SET       (ADDRESS OF PENDING-BUSINESS)
010537*         RIDFLD    (ERPNDB-KEY)
010538*    END-EXEC.
      *    MOVE '&"S        E          (   #00017755' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303137373535' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010539
010540     IF NOT  PI-PRIMARY-WITH-SELECT
010541        GO TO 4607-CHECK-REC-TYPE.
010542
010543     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
010544
010545     IF  WS-BATCH-PREFIX = '#CL'
010546         GO TO 4610-BUMP-SEQ.
010547
010548     IF PI-PB-CERT-NO NOT = LOW-VALUES
010549        IF PI-PB-CERT-NO NOT = PB-CERT-NO
010550           GO TO 4610-BUMP-SEQ
010551        ELSE
010552           IF PI-PB-CERT-EFF-DT = LOW-VALUES
010553              GO TO 4607-CHECK-REC-TYPE
010554           ELSE
010555              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
010556                 GO TO 4607-CHECK-REC-TYPE
010557              ELSE
010558                 GO TO 4610-BUMP-SEQ.
010559
010560     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
010561        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
010562           GO TO 4610-BUMP-SEQ.
010563
010564 4607-CHECK-REC-TYPE.
010565     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
010566         IF  PB-CARRIER = PI-CARRIER-SECURITY
010567             NEXT SENTENCE
010568         ELSE
010569             GO TO 4610-BUMP-SEQ.
010570
010571     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
010572         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
010573             NEXT SENTENCE
010574        ELSE
010575             GO TO 4610-BUMP-SEQ.
010576
010577     IF NOT DISPLAY-CHANGE-RECORDS AND
010578            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
010579        GO TO 4610-BUMP-SEQ.
010580
010581     IF DISPLAY-HOLD-RECORDS AND
010582        NOT PB-RECORD-ON-HOLD
010583          GO TO 4610-BUMP-SEQ.
010584
010585     IF PB-ISSUE
010586        IF DISPLAY-CHK-REQ-RECORDS
010587           GO TO 4610-BUMP-SEQ.
010588
010589     IF PB-ISSUE
010590        IF ISSUE-WITH-WARNING
010591           IF PB-WARNING-ERRORS
010592              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
010593                  GO TO 4610-BUMP-SEQ
010594              ELSE
010595                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010596                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010597                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010598                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010599                 MOVE PB-SV-STATE            TO PI-SV-STATE
010600                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010601                 GO TO 7000-DISPLAY-ISSUES
010602           ELSE
010603              GO TO 4610-BUMP-SEQ.
010604
010605     IF PB-ISSUE
010606        IF (ISSUES-IN-ERROR AND
010607            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
010608            ALL-ISSUES
010609            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010610            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010611            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010612            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010613            MOVE PB-SV-STATE            TO PI-SV-STATE
010614            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010615            GO TO 7000-DISPLAY-ISSUES
010616        ELSE
010617            GO TO 4610-BUMP-SEQ.
010618
010619     IF PB-CANCELLATION
010620        IF DISPLAY-CHK-REQ-RECORDS
010621           IF PB-C-REFUND-REQUESTED
010622              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010623              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010624              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010625              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010626              MOVE PB-SV-STATE            TO PI-SV-STATE
010627              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010628              GO TO 7100-DISPLAY-CANCELS
010629           ELSE
010630              GO TO 4610-BUMP-SEQ.
010631
010632     IF PB-CANCELLATION
010633        IF CANCEL-WITH-WARNING
010634           IF PB-WARNING-ERRORS
010635              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
010636                  GO TO 4610-BUMP-SEQ
010637              ELSE
010638                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010639                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010640                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010641                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010642                 MOVE PB-SV-STATE            TO PI-SV-STATE
010643                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010644                 GO TO 7100-DISPLAY-CANCELS
010645           ELSE
010646              GO TO 4610-BUMP-SEQ.
010647
010648     IF PB-CANCELLATION
010649        IF (CANCEL-IN-ERROR  AND
010650            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
010651            ALL-CANCELS
010652            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010653            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010654            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010655            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010656            MOVE PB-SV-STATE            TO PI-SV-STATE
010657            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010658            GO TO 7100-DISPLAY-CANCELS.
010659
010660 4610-BUMP-SEQ.
010661     IF ERPNDB-BATCH-SEQ-NO = ZEROS
010662        GO TO 4650-END-BATCH.
010663
010664     IF DISPLAY-CHANGE-RECORDS
010665        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
010666           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
010667        ELSE
010668           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
010669           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
010670        ELSE
010671           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
010672           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
010673
010674        GO TO 4605-READ-NEXT.
010675
010676 4650-END-BATCH.
010677     IF PI-MAP-NAME = EL631B
010678        MOVE -1                  TO BMAINTL
010679     ELSE
010680        IF PI-MAP-NAME = EL631C
010681           MOVE -1               TO CMAINTL
010682        ELSE
010683           MOVE -1               TO DPFENTRL.
010684
010685     MOVE ER-2252               TO EMI-ERROR.
010686     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
010687     GO TO 8200-SEND-DATAONLY.
010688
010689 4680-NOT-FOUND.
010690     IF DISPLAY-CHANGE-RECORDS
010691        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
010692           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
010693        ELSE
010694           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
010695           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
010696     ELSE
010697        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
010698
010699     GO TO 4605-READ-NEXT.
010700
010701     EJECT
010702
010703******************************************************************
010704*                                                                *
010705*        B R O W S E   F I L E   B A C K W A R D S               *
010706*                                                                *
010707******************************************************************
010708
010709 4800-BROWSE-FILE-BACKWARD.
010710     
      * EXEC CICS HANDLE CONDITION
010711*         NOTFND   (4860-NOT-FOUND)
010712*         ENDFILE  (4850-END-RECORDS)
010713*    END-EXEC.
      *    MOVE '"$I''                  ! K #00017931' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'4B20233030303137393331' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010714
010715     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
010716
010717     IF PI-DISPLAY-ORIGINAL-BATCH
010718        MOVE FILE-ID-ERPNDB3     TO FILE-ID
010719     ELSE
010720        MOVE FILE-ID-ERPNDB      TO FILE-ID.
010721
010722     
      * EXEC CICS STARTBR
010723*         DATASET   (FILE-ID)
010724*         RIDFLD    (ERPNDB-KEY)
010725*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &   #00017943' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'2020233030303137393433' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010726
010727     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
010728
010729     
      * EXEC CICS READPREV
010730*         DATASET    (FILE-ID-ERPNDB)
010731*         SET        (ADDRESS OF PENDING-BUSINESS)
010732*         RIDFLD     (ERPNDB-KEY)
010733*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&0S                   )   #00017950' TO DFHEIV0
           MOVE X'263053202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303137393530' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010734
010735 4810-READ-PREV-RECORD.
010736     
      * EXEC CICS READPREV
010737*         DATASET    (FILE-ID-ERPNDB)
010738*         SET        (ADDRESS OF PENDING-BUSINESS)
010739*         RIDFLD     (ERPNDB-KEY)
010740*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&0S                   )   #00017957' TO DFHEIV0
           MOVE X'263053202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303137393537' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010741
010742     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
010743        GO TO 4850-END-RECORDS.
010744
010745     IF PB-BATCH-TRAILER
010746        GO TO 4810-READ-PREV-RECORD.
010747
010748     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
010749
010750     IF  WS-BATCH-PREFIX = '#CL'
010751         GO TO 4810-READ-PREV-RECORD.
010752
010753     IF PI-PB-CERT-NO NOT = LOW-VALUES
010754        IF PI-PB-CERT-NO NOT = PB-CERT-NO
010755           GO TO 4810-READ-PREV-RECORD
010756        ELSE
010757           IF PI-PB-CERT-EFF-DT = LOW-VALUES
010758              GO TO 4820-CHECK-REC-TYPE
010759           ELSE
010760              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
010761                 GO TO 4820-CHECK-REC-TYPE
010762              ELSE
010763                 GO TO 4810-READ-PREV-RECORD.
010764
010765     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
010766        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
010767           GO TO 4810-READ-PREV-RECORD.
010768
010769 4820-CHECK-REC-TYPE.
010770     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
010771         IF  PB-CARRIER = PI-CARRIER-SECURITY
010772             NEXT SENTENCE
010773         ELSE
010774             GO TO 4810-READ-PREV-RECORD.
010775
010776     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
010777         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
010778             NEXT SENTENCE
010779        ELSE
010780             GO TO 4810-READ-PREV-RECORD.
010781
010782     IF NOT DISPLAY-CHANGE-RECORDS AND
010783            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
010784        GO TO 4810-READ-PREV-RECORD.
010785
010786     IF DISPLAY-HOLD-RECORDS AND
010787        NOT PB-RECORD-ON-HOLD
010788          GO TO 4810-READ-PREV-RECORD.
010789
010790     IF PB-ISSUE
010791        IF DISPLAY-CHK-REQ-RECORDS
010792           GO TO 4810-READ-PREV-RECORD.
010793
010794     IF PB-ISSUE
010795        IF ISSUE-WITH-WARNING
010796           IF PB-WARNING-ERRORS
010797              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
010798                  GO TO 4810-READ-PREV-RECORD
010799              ELSE
010800                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010801                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010802                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010803                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010804                 MOVE PB-SV-STATE            TO PI-SV-STATE
010805                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010806                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010807                 GO TO 7000-DISPLAY-ISSUES
010808           ELSE
010809              GO TO 4810-READ-PREV-RECORD.
010810
010811     IF PB-ISSUE
010812        IF (ISSUES-IN-ERROR AND
010813            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
010814            ALL-ISSUES
010815            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010816            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010817            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010818            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010819            MOVE PB-SV-STATE            TO PI-SV-STATE
010820            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010821            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010822            GO TO 7000-DISPLAY-ISSUES
010823        ELSE
010824            GO TO 4810-READ-PREV-RECORD.
010825
010826     IF PB-CANCELLATION
010827        IF DISPLAY-CHK-REQ-RECORDS
010828           IF PB-C-REFUND-REQUESTED
010829              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010830              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010831              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010832              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010833              MOVE PB-SV-STATE            TO PI-SV-STATE
010834              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010835              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010836              GO TO 7100-DISPLAY-CANCELS
010837           ELSE
010838              GO TO 4810-READ-PREV-RECORD.
010839
010840     IF PB-CANCELLATION
010841        IF CANCEL-WITH-WARNING
010842           IF PB-WARNING-ERRORS
010843              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
010844                  GO TO 4810-READ-PREV-RECORD
010845              ELSE
010846                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010847                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010848                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010849                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010850                 MOVE PB-SV-STATE            TO PI-SV-STATE
010851                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010852                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010853                 GO TO 7100-DISPLAY-CANCELS
010854           ELSE
010855              GO TO 4810-READ-PREV-RECORD.
010856
010857     IF PB-CANCELLATION
010858        IF (CANCEL-IN-ERROR  AND
010859            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
010860            ALL-CANCELS
010861            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
010862            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010863            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
010864            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
010865            MOVE PB-SV-STATE            TO PI-SV-STATE
010866            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
010867            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
010868            GO TO 7100-DISPLAY-CANCELS.
010869
010870     GO TO 4810-READ-PREV-RECORD.
010871
010872 4850-END-RECORDS.
010873     MOVE ER-2252                TO EMI-ERROR.
010874     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
010875
010876     IF PI-MAP-NAME = EL631B
010877        MOVE -1                  TO BPFENTRL
010878     ELSE
010879        MOVE -1                  TO CPFENTRL.
010880
010881     GO TO 8200-SEND-DATAONLY.
010882
010883 4860-NOT-FOUND.
010884
010885******************************************************************
010886*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
010887******************************************************************
010888
010889     
      * EXEC CICS RESETBR
010890*         DATASET    (FILE-ID-ERPNDB)
010891*         RIDFLD     (ERPNDB-KEY)
010892*     END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&4         G          &   #00018110' TO DFHEIV0
           MOVE X'263420202020202020202047' &
                X'202020202020202020202620' &
                X'2020233030303138313130' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010893
010894     
      * EXEC CICS READNEXT
010895*         DATASET    (FILE-ID-ERPNDB)
010896*         SET        (ADDRESS OF PENDING-BUSINESS)
010897*         RIDFLD     (ERPNDB-KEY)
010898*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )   #00018115' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303138313135' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010899
010900     
      * EXEC CICS READPREV
010901*         DATASET    (FILE-ID-ERPNDB)
010902*         SET        (ADDRESS OF PENDING-BUSINESS)
010903*         RIDFLD     (ERPNDB-KEY)
010904*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&0S                   )   #00018121' TO DFHEIV0
           MOVE X'263053202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303138313231' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010905
010906     GO TO 4810-READ-PREV-RECORD.
010907
010908     EJECT
010909
010910******************************************************************
010911*                                                                *
010912*           B R O W S E   C S R   B A C K W A R D                *
010913*                                                                *
010914******************************************************************
010915
010916 4900-BROWSE-CSR-BACKWARD.
010917
010918     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
010919
010920     
      * EXEC CICS HANDLE CONDITION
010921*         NOTFND   (4970-NOT-FOUND)
010922*         ENDFILE  (4950-END-RECORDS)
010923*    END-EXEC
      *    MOVE '"$I''                  ! L #00018141' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'4C20233030303138313431' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
010924
010925     
      * EXEC CICS STARTBR
010926*         DATASET   (FILE-ID-ERPNDB4)
010927*         RIDFLD    (ERPNDB-CSR-KEY)
010928*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &   #00018146' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'2020233030303138313436' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB4, 
                 ERPNDB-CSR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010929
010930     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
010931                                    WS-FIRST-TIME-SW.
010932
010933 4905-READ-PREV-RECORD.
010934     
      * EXEC CICS READPREV
010935*         DATASET    (FILE-ID-ERPNDB4)
010936*         SET        (ADDRESS OF PENDING-BUSINESS)
010937*         RIDFLD     (ERPNDB-CSR-KEY)
010938*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&0S                   )   #00018155' TO DFHEIV0
           MOVE X'263053202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303138313535' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB4, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-CSR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
010939
010940     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
010941
010942     IF WS-BATCH-PREFIX = '#CL'
010943         GO TO 4905-READ-PREV-RECORD.
010944
010945     IF FIRST-TIME
010946         MOVE SPACE               TO WS-FIRST-TIME-SW
010947         GO TO 4905-READ-PREV-RECORD.
010948
010949     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
010950        PB-CSR-ID           NOT = PI-PB-CSR-ID
010951        GO TO 4950-END-RECORDS.
010952
010953     IF PB-BATCH-TRAILER
010954        GO TO 4905-READ-PREV-RECORD.
010955
010956     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
010957
010958     IF  WS-BATCH-PREFIX = '#CL'
010959         GO TO 4905-READ-PREV-RECORD.
010960
010961     IF PI-PB-CERT-NO NOT = LOW-VALUES
010962        IF PI-PB-CERT-NO NOT = PB-CERT-NO
010963           GO TO 4905-READ-PREV-RECORD
010964        ELSE
010965           IF PI-PB-CERT-EFF-DT = LOW-VALUES
010966              GO TO 4910-CHECK-REC-TYPE
010967           ELSE
010968              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
010969                 GO TO 4910-CHECK-REC-TYPE
010970              ELSE
010971                 GO TO 4905-READ-PREV-RECORD.
010972
010973     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
010974        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
010975           GO TO 4905-READ-PREV-RECORD.
010976
010977 4910-CHECK-REC-TYPE.
010978     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
010979         IF  PB-CARRIER = PI-CARRIER-SECURITY
010980             NEXT SENTENCE
010981         ELSE
010982             GO TO 4905-READ-PREV-RECORD.
010983
010984     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
010985         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
010986             NEXT SENTENCE
010987        ELSE
010988             GO TO 4905-READ-PREV-RECORD.
010989
010990     IF NOT DISPLAY-CHANGE-RECORDS AND
010991            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
010992        GO TO 4905-READ-PREV-RECORD.
010993
010994     IF DISPLAY-HOLD-RECORDS AND
010995        NOT PB-RECORD-ON-HOLD
010996          GO TO 4905-READ-PREV-RECORD.
010997
010998     IF PB-ISSUE
010999        IF DISPLAY-CHK-REQ-RECORDS
011000           GO TO 4905-READ-PREV-RECORD.
011001
011002     IF PB-ISSUE
011003        IF ISSUE-WITH-WARNING
011004           IF PB-WARNING-ERRORS
011005              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
011006                  GO TO 4505-READ-PREV-RECORD
011007              ELSE
011008                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
011009                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
011010                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
011011                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
011012                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
011013                 MOVE PB-SV-STATE            TO PI-SV-STATE
011014                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
011015                 GO TO 7000-DISPLAY-ISSUES
011016           ELSE
011017              GO TO 4905-READ-PREV-RECORD.
011018
011019     IF PB-ISSUE
011020        IF (ISSUES-IN-ERROR AND
011021            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
011022            ALL-ISSUES
011023            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
011024            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
011025            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
011026            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
011027            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
011028            MOVE PB-SV-STATE            TO PI-SV-STATE
011029            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
011030            GO TO 7000-DISPLAY-ISSUES
011031        ELSE
011032            GO TO 4905-READ-PREV-RECORD.
011033
011034     IF PB-CANCELLATION
011035        IF DISPLAY-CHK-REQ-RECORDS
011036           IF PB-C-REFUND-REQUESTED
011037              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
011038              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
011039              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
011040              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
011041              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
011042              MOVE PB-SV-STATE            TO PI-SV-STATE
011043              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
011044              GO TO 7100-DISPLAY-CANCELS
011045           ELSE
011046              GO TO 4905-READ-PREV-RECORD.
011047
011048     IF PB-CANCELLATION
011049        IF CANCEL-WITH-WARNING
011050           IF PB-WARNING-ERRORS
011051              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
011052                  GO TO 4505-READ-PREV-RECORD
011053              ELSE
011054                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
011055                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
011056                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
011057                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
011058                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
011059                 MOVE PB-SV-STATE            TO PI-SV-STATE
011060                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
011061                 GO TO 7100-DISPLAY-CANCELS
011062           ELSE
011063              GO TO 4905-READ-PREV-RECORD.
011064
011065     IF PB-CANCELLATION
011066        IF (CANCEL-IN-ERROR  AND
011067            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
011068            ALL-CANCELS
011069            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
011070            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
011071            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
011072            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
011073            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
011074            MOVE PB-SV-STATE            TO PI-SV-STATE
011075            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
011076            GO TO 7100-DISPLAY-CANCELS.
011077
011078     GO TO 4905-READ-PREV-RECORD.
011079
011080 4950-END-RECORDS.
011081     IF PI-MAP-NAME = EL631B
011082        MOVE -1                  TO BMAINTL
011083     ELSE
011084        IF PI-MAP-NAME = EL631C
011085           MOVE -1               TO CMAINTL
011086        ELSE
011087           MOVE -1               TO DPFENTRL.
011088
011089     MOVE ER-2255               TO EMI-ERROR.
011090     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
011091     GO TO 8200-SEND-DATAONLY.
011092
011093 4970-NOT-FOUND.
011094
011095******************************************************************
011096*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
011097******************************************************************
011098
011099     
      * EXEC CICS RESETBR
011100*         DATASET    (FILE-ID-ERPNDB4)
011101*         RIDFLD     (ERPNDB-CSR-KEY)
011102*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&4         G          &   #00018320' TO DFHEIV0
           MOVE X'263420202020202020202047' &
                X'202020202020202020202620' &
                X'2020233030303138333230' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB4, 
                 ERPNDB-CSR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011103
011104     
      * EXEC CICS READNEXT
011105*         DATASET    (FILE-ID-ERPNDB4)
011106*         SET        (ADDRESS OF PENDING-BUSINESS)
011107*         RIDFLD     (ERPNDB-CSR-KEY)
011108*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )   #00018325' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303138333235' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB4, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-CSR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011109
011110     
      * EXEC CICS READPREV
011111*         DATASET    (FILE-ID-ERPNDB4)
011112*         SET        (ADDRESS OF PENDING-BUSINESS)
011113*         RIDFLD     (ERPNDB-CSR-KEY)
011114*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&0S                   )   #00018331' TO DFHEIV0
           MOVE X'263053202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303138333331' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB4, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-CSR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011115
011116 4980-READ-PREV-RECORD.
011117     
      * EXEC CICS READPREV
011118*         DATASET    (FILE-ID-ERPNDB4)
011119*         SET        (ADDRESS OF PENDING-BUSINESS)
011120*         RIDFLD     (ERPNDB-CSR-KEY)
011121*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&0S                   )   #00018338' TO DFHEIV0
           MOVE X'263053202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303138333338' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB4, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-CSR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011122
011123     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
011124
011125     IF WS-BATCH-PREFIX = '#CL'
011126        GO TO 4980-READ-PREV-RECORD.
011127
011128     MOVE SPACE                  TO WS-FIRST-TIME-SW.
011129     GO TO 4905-READ-PREV-RECORD.
011130
011131     EJECT
011132
011133
011134******************************************************************
011135*                                                                *
011136*        B R O W S E   B A T C H   H E A D E R S                 *
011137*                                                                *
011138******************************************************************
011139
011140 5000-BROWSE-BATCH-HEADERS.
011141
011142     IF EIBTRNID NOT = TRANS-EXB1
011143        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
011144        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
011145        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
011146        GO TO 5010-READ-NEXT-RECORD.
011147
011148     IF EIBAID = DFHPF4
011149        MOVE '0'                TO PI-EDIT-SW
011150        MOVE PI-PREV-KEY         TO ERPNDB-KEY
011151        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
011152        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
011153        GO TO 5010-READ-NEXT-RECORD.
011154
011155     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
011156     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
011157     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
011158
011159     
      * EXEC CICS HANDLE CONDITION
011160*         ENDFILE  (5050-NOT-FOUND)
011161*    END-EXEC.
      *    MOVE '"$''                   ! M #00018380' TO DFHEIV0
           MOVE X'222427202020202020202020' &
                X'202020202020202020202120' &
                X'4D20233030303138333830' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011162
011163 5010-READ-NEXT-RECORD.
011164     
      * EXEC CICS HANDLE CONDITION
011165*         NOTFND    (5050-NOT-FOUND)
011166*    END-EXEC.
      *    MOVE '"$I                   ! N #00018385' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'4E20233030303138333835' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011167
011168     
      * EXEC CICS READ
011169*         DATASET   (FILE-ID-ERPNDB)
011170*         SET       (ADDRESS OF PENDING-BUSINESS)
011171*         RIDFLD    (ERPNDB-KEY)
011172*         GTEQ
011173*    END-EXEC.
      *    MOVE '&"S        G          (   #00018389' TO DFHEIV0
           MOVE X'262253202020202020202047' &
                X'202020202020202020202820' &
                X'2020233030303138333839' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011174
011175     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
011176         GO TO 5050-NOT-FOUND.
011177
011178     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
011179
011180     IF WS-BATCH-PREFIX = '#CL'
011181         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
011182         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
011183         GO TO 5010-READ-NEXT-RECORD.
011184
011185     IF NOT PB-BATCH-TRAILER
011186         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
011187         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
011188         GO TO 5010-READ-NEXT-RECORD.
011189
011190     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
011191         IF  PB-CARRIER = PI-CARRIER-SECURITY
011192             NEXT SENTENCE
011193         ELSE
011194             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
011195             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
011196             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
011197             GO TO 5010-READ-NEXT-RECORD.
011198
011199     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
011200         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
011201             NEXT SENTENCE
011202        ELSE
011203             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
011204             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
011205             GO TO 5010-READ-NEXT-RECORD.
011206
011207     IF EIBAID = DFHPF4
011208        MOVE '0'                TO PI-EDIT-SW
011209        GO TO 7200-DISPLAY-BATCHES.
011210
011211     IF PI-CSR-BROWSE
011212        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
011213           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
011214           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
011215           GO TO 5010-READ-NEXT-RECORD.
011216
011217     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
011218       IF PI-PB-CARRIER    = SPACES AND
011219          PI-PB-GROUPING   = SPACES AND
011220          PI-PB-STATE      = SPACES AND
011221          PI-PB-ACCOUNT    = SPACES
011222            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
011223            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
011224            GO TO 7200-DISPLAY-BATCHES
011225         ELSE
011226           IF PI-PB-CARRIER    = PB-CARRIER  AND
011227              PI-PB-GROUPING   = PB-GROUPING AND
011228              PI-PB-STATE      = PB-STATE    AND
011229              PI-PB-ACCOUNT    = PB-ACCOUNT
011230              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
011231              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
011232              GO TO 7200-DISPLAY-BATCHES.
011233
011234     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
011235     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
011236
011237     
      * EXEC CICS HANDLE CONDITION
011238*         NOTFND    (5050-NOT-FOUND)
011239*    END-EXEC.
      *    MOVE '"$I                   ! O #00018458' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'4F20233030303138343538' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011240
011241     
      * EXEC CICS READ
011242*         DATASET   (FILE-ID-ERPNDB)
011243*         SET       (ADDRESS OF PENDING-BUSINESS)
011244*         RIDFLD    (ERPNDB-KEY)
011245*         GTEQ
011246*    END-EXEC.
      *    MOVE '&"S        G          (   #00018462' TO DFHEIV0
           MOVE X'262253202020202020202047' &
                X'202020202020202020202820' &
                X'2020233030303138343632' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011247
011248     GO TO 5010-READ-NEXT-RECORD.
011249
011250 5050-NOT-FOUND.
011251
011252******************************************************************
011253*                                                                *
011254*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
011255*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
011256*         PROGRAM.                                               *
011257*                                                                *
011258******************************************************************
011259
011260     IF EIBTRNID NOT = TRANS-EXB1
011261        IF PENDING-BUS-RECS-FOUND
011262            NEXT SENTENCE
011263          ELSE
011264            MOVE '9'            TO PI-BROWSE-SW
011265            GO TO 9400-CLEAR.
011266
011267     MOVE ER-2256                TO EMI-ERROR.
011268     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
011269
011270     IF PI-MAP-NAME = SPACES
011271        MOVE EL631D              TO PI-MAP-NAME
011272        MOVE -1                  TO DPFENTRL
011273        GO TO 8100-SEND-INITIAL-MAP.
011274
011275     IF PI-MAP-NAME = EL631B
011276        MOVE -1                  TO BMAINTL
011277     ELSE
011278        IF PI-MAP-NAME = EL631C
011279           MOVE -1               TO CMAINTL
011280        ELSE
011281           MOVE -1               TO DPFENTRL
011282           GO TO 8200-SEND-DATAONLY.
011283
011284     GO TO 8100-SEND-INITIAL-MAP.
011285
011286     .
011287 5100-PROCESS-POL-RESC.
011288
011289     MOVE ZEROS                  TO CG-LF-BENCD
011290                                    CG-AH-BENCD
011291                                    CG-LF-CAN-AMT
011292                                    CG-AH-CAN-AMT
011293     MOVE LOW-VALUES             TO CG-LF-CAN-DT
011294                                    CG-AH-CAN-DT
011295     MOVE SPACES                 TO CG-BATCH-NO
011296
011297     MOVE '4'                    TO CG-OPTION-CODE
011298     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
011299     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
011300     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
011301     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
011302     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
011303     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
011304     MOVE PI-SV-STATE            TO CG-CERT-STATE
011305     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
011306     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
011307     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
011308     MOVE PI-PREV-ALT-KEY (1:33)
011309                                 TO CG-CERT-KEY
011310     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
011311     MOVE ZEROS                  TO CG-LF-CAN-AMT
011312                                    CG-AH-CAN-AMT
011313     MOVE LOW-VALUES             TO CG-LF-CAN-DT
011314                                    CG-AH-CAN-DT
011315     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
011316     MOVE ZERO                   TO CG-BATCH-SEQ-NO
011317
011318*    display 'about to cancel ' cg-cert-key
011319     
      * EXEC CICS LINK
011320*        PROGRAM  ('ELCANC')
011321*        COMMAREA (CANCEL-GEN-PASS-AREA)
011322*    END-EXEC
           MOVE LENGTH OF
            CANCEL-GEN-PASS-AREA
             TO DFHEIV11
           MOVE 'ELCANC' TO DFHEIV1
      *    MOVE '."C                   (   #00018540' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303138353430' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 CANCEL-GEN-PASS-AREA, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011323     IF CG-SUCCESS
011324        CONTINUE
011325     ELSE
011326        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
011327        MOVE '3'                 TO EMI-SWITCH1
011328        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
011329        EVALUATE TRUE
011330           WHEN CG-DATE-ERROR
011331             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
011332           WHEN CG-CERT-NOT-FOUND
011333             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
011334           WHEN CG-AMOUNT-ERROR
011335             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
011336           WHEN CG-OPTION-ERROR
011337             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
011338           WHEN CG-PREV-CAN
011339             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
011340           WHEN CG-INVALID-DATA
011341             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
011342           WHEN CG-NO-ACCT-MSTR
011343             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
011344           WHEN CG-SFX-A-EXIST
011345             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
011346           WHEN CG-MISC-ERROR
011347             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
011348           WHEN OTHER
011349             MOVE ' ERROR - ELCANC - RETURN '
011350                                 TO EMI-ERROR-TEXT (1) (12:25)
011351        END-EVALUATE
011352        GO TO 8200-SEND-DATAONLY
011353     END-IF
011354
011355     
      * EXEC CICS GETMAIN
011356*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
011357*        LENGTH  (ELCRTT-RECORD-LENGTH)
011358*        INITIMG (GETMAIN-SPACE)
011359*    END-EXEC
      *    MOVE ',"IL                  $   #00018576' TO DFHEIV0
           MOVE X'2C22494C2020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303138353736' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 ELCRTT-RECORD-LENGTH, 
                 GETMAIN-SPACE
           SET ADDRESS OF CERTIFICATE-TRAILERS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011360
011361     move ' '                    to ws-elcrtt-update-sw
011362     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTT-PRIMARY
011363     MOVE 'C'                    TO ELCRTT-REC-TYPE
011364
011365     
      * EXEC CICS READ
011366*        UPDATE
011367*        DATASET  (CRTT-ID)
011368*        RIDFLD   (ELCRTT-KEY)
011369*        INTO     (CERTIFICATE-TRAILERS)
011370*        resp     (ws-response)
011371*    END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (  N#00018586' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'204E233030303138353836' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO ws-response
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011372
011373     if resp-normal
011374        if cs-claim-verification-status = 'B' or 'C' or 'D' or
011375                  'E' or 'F' or 'G'
011376           move 'J'              to cs-claim-verification-status
011377           set update-elcrtt to true
011378        end-if
011379        if update-elcrtt
011380           
      * EXEC CICS REWRITE
011381*             DATASET    (crtt-ID)
011382*             FROM       (CERTIFICATE-TRAILERS)
011383*          END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00018601' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303138363031' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 crtt-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011384        else
011385           
      * exec cics unlock
011386*             dataset    (crtt-ID)
011387*          end-exec
      *    MOVE '&*                    #   #00018606' TO DFHEIV0
           MOVE X'262A20202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303138363036' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 crtt-ID, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011388        end-if
011389     end-if
011390
011391     .
011392 5100-EXIT.
011393     EXIT.
011394
011395
011396******************************************************************
011397*                                                                *
011398*        B R O W S E   B A T C H   B A C K W A R D S             *
011399*                                                                *
011400******************************************************************
011401
011402 5500-BROWSE-BATCH-BACKWARD.
011403     
      * EXEC CICS HANDLE CONDITION
011404*         NOTFND   (5550-END-RECORDS)
011405*         ENDFILE  (5550-END-RECORDS)
011406*    END-EXEC.
      *    MOVE '"$I''                  ! P #00018624' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'5020233030303138363234' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011407
011408 5505-START-BROWSE.
011409     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
011410     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
011411     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
011412
011413     
      * EXEC CICS STARTBR
011414*         DATASET   (FILE-ID-ERPNDB)
011415*         RIDFLD    (ERPNDB-ALT-KEY)
011416*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &   #00018634' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'2020233030303138363334' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 ERPNDB-ALT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011417
011418     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
011419
011420     
      * EXEC CICS READNEXT
011421*         DATASET    (FILE-ID-ERPNDB)
011422*         SET        (ADDRESS OF PENDING-BUSINESS)
011423*         RIDFLD     (ERPNDB-KEY)
011424*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )   #00018641' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303138363431' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011425
011426     
      * EXEC CICS READPREV
011427*         DATASET    (FILE-ID-ERPNDB)
011428*         SET        (ADDRESS OF PENDING-BUSINESS)
011429*         RIDFLD     (ERPNDB-KEY)
011430*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&0S                   )   #00018647' TO DFHEIV0
           MOVE X'263053202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303138363437' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011431
011432     
      * EXEC CICS READPREV
011433*         DATASET    (FILE-ID-ERPNDB)
011434*         SET        (ADDRESS OF PENDING-BUSINESS)
011435*         RIDFLD     (ERPNDB-KEY)
011436*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&0S                   )   #00018653' TO DFHEIV0
           MOVE X'263053202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303138363533' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011437
011438     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
011439        GO TO 5550-END-RECORDS.
011440
011441     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
011442
011443     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
011444
011445     IF  WS-BATCH-PREFIX = '#CL'
011446             MOVE SPACE               TO WS-BROWSE-STARTED-SW
011447             
      * EXEC CICS ENDBR
011448*                 DATASET  (FILE-ID-ERPNDB)
011449*            END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00018668' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303138363638' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011450         GO TO 5505-START-BROWSE.
011451
011452     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
011453         IF  PB-CARRIER = PI-CARRIER-SECURITY
011454             NEXT SENTENCE
011455         ELSE
011456             MOVE SPACE               TO WS-BROWSE-STARTED-SW
011457             
      * EXEC CICS ENDBR
011458*                 DATASET  (FILE-ID-ERPNDB)
011459*            END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00018678' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303138363738' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011460             GO TO 5505-START-BROWSE.
011461
011462
011463     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
011464         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
011465             NEXT SENTENCE
011466        ELSE
011467             MOVE SPACE               TO WS-BROWSE-STARTED-SW
011468             
      * EXEC CICS ENDBR
011469*                 DATASET  (FILE-ID-ERPNDB)
011470*            END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00018689' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303138363839' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011471             GO TO 5505-START-BROWSE.
011472
011473     IF NOT PB-BATCH-TRAILER
011474        MOVE SPACE               TO WS-BROWSE-STARTED-SW
011475        
      * EXEC CICS ENDBR
011476*            DATASET  (FILE-ID-ERPNDB)
011477*       END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00018696' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303138363936' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011478        GO TO 5505-START-BROWSE.
011479
011480     IF PI-CSR-BROWSE
011481        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
011482           MOVE SPACE            TO WS-BROWSE-STARTED-SW
011483           
      * EXEC CICS ENDBR
011484*               DATASET  (FILE-ID-ERPNDB)
011485*          END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00018704' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303138373034' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011486           GO TO 5505-START-BROWSE.
011487
011488     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
011489        IF PI-PB-CARRIER    = SPACES AND
011490           PI-PB-GROUPING   = SPACES AND
011491           PI-PB-STATE      = SPACES AND
011492           PI-PB-ACCOUNT    = SPACES
011493             GO TO 7200-DISPLAY-BATCHES
011494          ELSE
011495            IF PI-PB-CARRIER    = PB-CARRIER  AND
011496               PI-PB-GROUPING   = PB-GROUPING AND
011497               PI-PB-STATE      = PB-STATE    AND
011498               PI-PB-ACCOUNT    = PB-ACCOUNT
011499                 GO TO 7200-DISPLAY-BATCHES.
011500
011501     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
011502
011503     
      * EXEC CICS ENDBR
011504*         DATASET  (FILE-ID-ERPNDB)
011505*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00018724' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303138373234' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011506
011507     GO TO 5505-START-BROWSE.
011508
011509 5550-END-RECORDS.
011510     MOVE ER-2257                TO EMI-ERROR.
011511     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
011512     MOVE -1                     TO DPFENTRL.
011513
011514     GO TO 8200-SEND-DATAONLY.
011515
011516     EJECT
011517
011518******************************************************************
011519*                                                                *
011520*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
011521*                                                                *
011522******************************************************************
011523
011524 6000-CREATE-TEMP-STORAGE.
011525
011526     
      * EXEC CICS HANDLE CONDITION
011527*        QIDERR  (6050-QID-ERROR)
011528*    END-EXEC.
      *    MOVE '"$N                   ! Q #00018747' TO DFHEIV0
           MOVE X'22244E202020202020202020' &
                X'202020202020202020202120' &
                X'5120233030303138373437' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011529
011530     
      * EXEC CICS WRITEQ TS
011531*        QUEUE    (QID)
011532*        FROM     (PROGRAM-INTERFACE-BLOCK)
011533*        LENGTH   (WS-COMM-LENGTH)
011534*        ITEM     (W-ONE)
011535*    END-EXEC.
      *    MOVE '*" I   L              ''   #00018751' TO DFHEIV0
           MOVE X'2A2220492020204C20202020' &
                X'202020202020202020202720' &
                X'2020233030303138373531' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 QID, 
                 PROGRAM-INTERFACE-BLOCK, 
                 WS-COMM-LENGTH, 
                 W-ONE, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011536
011537 6000-EXIT.
011538      EXIT.
011539
011540     EJECT
011541
011542******************************************************************
011543*                                                                *
011544*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
011545*                                                                *
011546******************************************************************
011547
011548 6050-RECOVER-TEMP-STORAGE.
011549     IF PGM-NAME = XCTL-EL6312
011550        GO TO 6050-EXIT.
011551
011552     IF PGM-NAME = XCTL-EL6313
011553        GO TO 6050-EXIT.
011554
011555     IF PGM-NAME = XCTL-EL6315
011556         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
011557     END-IF
011558
011559     IF PGM-NAME = XCTL-EL6316
011560         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
011561     END-IF
011562
011563     
      * EXEC CICS HANDLE CONDITION
011564*        QIDERR  (6050-QID-ERROR)
011565*    END-EXEC.
      *    MOVE '"$N                   ! R #00018784' TO DFHEIV0
           MOVE X'22244E202020202020202020' &
                X'202020202020202020202120' &
                X'5220233030303138373834' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011566
011567     
      * EXEC CICS READQ TS
011568*         QUEUE   (QID)
011569*         INTO    (PROGRAM-INTERFACE-BLOCK)
011570*         LENGTH  (WS-COMM-LENGTH)
011571*         ITEM    (W-ONE)
011572*     END-EXEC.
      *    MOVE '*$II   L              ''   #00018788' TO DFHEIV0
           MOVE X'2A2449492020204C20202020' &
                X'202020202020202020202720' &
                X'2020233030303138373838' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 QID, 
                 PROGRAM-INTERFACE-BLOCK, 
                 WS-COMM-LENGTH, 
                 W-ONE, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011573
011574 6050-DELETE-TEMP-STORAGE.
011575
011576     
      * EXEC CICS DELETEQ TS
011577*        QUEUE   (QID)
011578*    END-EXEC.
      *    MOVE '*&                    #   #00018797' TO DFHEIV0
           MOVE X'2A2620202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303138373937' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 QID, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011579
011580     GO TO 6050-EXIT.
011581
011582 6050-QID-ERROR.
011583     MOVE ER-0033                TO EMI-ERROR
011584     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
011585
011586 6050-EXIT.
011587      EXIT.
011588
011589     EJECT
011590
011591******************************************************************
011592*                                                                *
011593*            T E R M   C O N V E R S I O N                       *
011594*                                                                *
011595******************************************************************
011596
011597 6100-TERM-CONVERSION.
011598
011599     IF PI-BPMTS = ZERO
011600         GO TO 6199-EXIT.
011601
011602     IF PI-BMODE = ' ' OR 'M'
011603         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
011604         GO TO 6105-ROUND-TERM.
011605
011606     IF PI-BMODE = 'S'
011607         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
011608         GO TO 6105-ROUND-TERM.
011609
011610     IF PI-BMODE = 'W'
011611         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
011612         GO TO 6105-ROUND-TERM.
011613
011614     IF PI-BMODE = 'B'
011615         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
011616         GO TO 6105-ROUND-TERM.
011617
011618     IF PI-BMODE = 'T'
011619         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
011620
011621 6105-ROUND-TERM.
011622
011623     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
011624         ADD +1                  TO WS-CALC-TERM-WHOLE
011625         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
011626
011627     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
011628         GO TO 6125-COMPUTE-TERM-BENEFIT.
011629
011630     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
011631         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
011632                                      WS-BTERM    (WS-SUB1)
011633         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
011634
011635     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
011636         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
011637             MOVE -1               TO BMODEL
011638             MOVE ER-2593          TO EMI-ERROR
011639             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
011640             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
011641
011642 6124-CHECK-BENEFIT.
011643
011644     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
011645        GO TO 6126-COMPUTE-BENEFIT.
011646
011647     GO TO 6199-EXIT.
011648
011649 EJECT
011650******************************************************************
011651**         COMPUTE TERM AND BENEFIT
011652******************************************************************
011653 6125-COMPUTE-TERM-BENEFIT.
011654
011655     IF PI-BTYPE (WS-SUB1) = SPACES  OR
011656        PI-BPMTAMT = ZERO
011657         GO TO 6199-EXIT.
011658
011659     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
011660                                     WS-BTERM  (WS-SUB1).
011661     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
011662
011663 6126-COMPUTE-BENEFIT.
011664
011665     IF PI-BMODE = 'M' OR  ' '
011666         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
011667
011668     IF PI-BMODE = 'W'
011669         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
011670
011671     IF PI-BMODE = 'S'
011672         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
011673
011674     IF PI-BMODE = 'B'
011675         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
011676
011677     IF PI-BMODE = 'T'
011678         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
011679
011680     IF WS-SUB1 = +1
011681        COMPUTE WS-BBEN (WS-SUB1) =
011682                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
011683
011684     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
011685     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
011686     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
011687
011688 6199-EXIT.
011689     EXIT.
011690     EJECT
011691
011692******************************************************************
011693*                                                                *
011694*             D I S P L A Y   I S S U E S                        *
011695*                                                                *
011696******************************************************************
011697
011698 6200-CREATE-VADS.
011699
011700     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
011701     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
011702     MOVE SPACES                 TO WS-PASS-VADS-REC
011703
011704     
      * EXEC CICS GETMAIN
011705*       SET      (ADDRESS OF PENDING-BUSINESS)
011706*       LENGTH   (ERPNDB-RECORD-LENGTH)
011707*       INITIMG  (GETMAIN-SPACE)
011708*       RESP     (WS-RESPONSE)
011709*    END-EXEC
      *    MOVE ',"IL                  $  N#00018925' TO DFHEIV0
           MOVE X'2C22494C2020202020202020' &
                X'202020202020202020202420' &
                X'204E233030303138393235' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 ERPNDB-RECORD-LENGTH, 
                 GETMAIN-SPACE
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011710
011711     
      * EXEC CICS READ
011712*       INTO    (PENDING-BUSINESS)
011713*       DATASET (FILE-ID-ERPNDB)
011714*       RIDFLD  (ERPNDB-KEY)
011715*       RESP    (WS-RESPONSE)
011716*    END-EXEC
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&"IL       E          (  N#00018932' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303138393332' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011717
011718     IF RESP-NORMAL
011719        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
011720        IF (RESP-NORMAL)
011721           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
011722              AM-CONTROL-PRIMARY (1:20))
011723           MOVE AM-NAME          TO VD-ACCOUNT-NAME
011724        ELSE
011725           MOVE 'ACCOUNT NOT FOUND'
011726                                 TO VD-ACCOUNT-NAME
011727
011728        END-IF
011729
011730        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
011731                                    TO M1
011732        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
011733        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
011734           (A2 > M1)
011735           OR (WS-WORK-FIELD (A2:1) = '*')
011736           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
011737           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
011738        END-PERFORM
011739        IF A2 > M1
011740           CONTINUE
011741        ELSE
011742           MOVE WS-WORK-FIELD (1:A2 - 1)
011743                                    TO VD-ACCOUNT-NAME
011744        END-IF
011745        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
011746        MOVE PB-CARRIER          TO VD-CARRIER
011747        MOVE PB-GROUPING         TO VD-GROUPING
011748        MOVE PB-STATE            TO VD-STATE
011749        MOVE PB-ACCOUNT          TO VD-ACCOUNT
011750        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
011751        MOVE PB-CERT-NO          TO VD-CERT-NO
011752        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
011753        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
011754        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
011755        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
011756        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
011757        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
011758        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
011759        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
011760        MOVE PB-CSR-ID           TO VD-CSR-ID
011761        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
011762        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
011763        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
011764        MOVE PB-I-LF-TERM        TO VD-LF-TERM
011765        MOVE PB-I-LF-RATE        TO VD-LF-RATE
011766        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
011767        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
011768        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
011769        MOVE PB-I-AH-TERM        TO VD-AH-TERM
011770        MOVE PB-I-AH-RATE        TO VD-AH-RATE
011771        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
011772        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
011773        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
011774     END-IF
011775
011776     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
011777
011778     
      * EXEC CICS GETMAIN
011779*       SET      (ADDRESS OF PENDING-MAILING-DATA)
011780*       LENGTH   (ERPNDM-RECORD-LENGTH)
011781*       INITIMG  (GETMAIN-SPACE)
011782*       RESP     (WS-RESPONSE)
011783*    END-EXEC
      *    MOVE ',"IL                  $  N#00018999' TO DFHEIV0
           MOVE X'2C22494C2020202020202020' &
                X'202020202020202020202420' &
                X'204E233030303138393939' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 ERPNDM-RECORD-LENGTH, 
                 GETMAIN-SPACE
           SET ADDRESS OF PENDING-MAILING-DATA TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011784
011785     
      * EXEC CICS READ
011786*       INTO    (PENDING-MAILING-DATA)
011787*       DATASET (FILE-ID-ERPNDM)
011788*       RIDFLD  (ERPNDM-KEY)
011789*       RESP    (WS-RESPONSE)
011790*    END-EXEC
           MOVE LENGTH OF
            PENDING-MAILING-DATA
             TO DFHEIV11
      *    MOVE '&"IL       E          (  N#00019006' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303139303036' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDM, 
                 PENDING-MAILING-DATA, 
                 DFHEIV11, 
                 ERPNDM-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011791
011792     IF RESP-NORMAL
011793        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
011794        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
011795        MOVE PM-CITY              TO VD-INSURED-CITY
011796        MOVE PM-STATE             TO VD-INSURED-STATE
011797        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
011798     END-IF
011799
011800     MOVE 'VAC1'                  TO VD-LETTER-ID
011801     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
011802     MOVE PI-COMPANY-ID           TO VD-COMP-ID
011803     MOVE EIBTIME                 TO VD-CURRENT-TIME
011804     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
011805     MOVE +0                      TO VD-ARCHIVE-NO
011806     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
011807
011808     .
011809 6200-EXIT.
011810     EXIT.
011811
011812 6210-READ-ERACCT.
011813
011814     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
011815     MOVE LOW-VALUES             TO ERACCT-FILL
011816
011817     
      * EXEC CICS READ
011818*         DATASET   ('ERACCT')
011819*         INTO      (ACCOUNT-MASTER)
011820*         RIDFLD    (ERACCT-KEY)
011821*         GTEQ
011822*         RESP      (WS-RESPONSE)
011823*    END-EXEC
           MOVE LENGTH OF
            ACCOUNT-MASTER
             TO DFHEIV11
           MOVE 'ERACCT' TO DFHEIV1
      *    MOVE '&"IL       G          (  N#00019038' TO DFHEIV0
           MOVE X'2622494C2020202020202047' &
                X'202020202020202020202820' &
                X'204E233030303139303338' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ACCOUNT-MASTER, 
                 DFHEIV11, 
                 ERACCT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011824
011825     .
011826 6210-EXIT.
011827     EXIT.
011828
011829 6220-READ-ERMAIL.
011830
011831     MOVE ELCERT-KEY             TO ERMAIL-KEY
011832     MOVE ' '                    TO WS-ERMAIL-SW
011833
011834     
      * EXEC CICS READ
011835*       DATASET   (FILE-ID-ERMAIL)
011836*       SET       (ADDRESS OF MAILING-DATA)
011837*       RIDFLD    (ERMAIL-KEY)
011838*       RESP      (WS-RESPONSE)
011839*    END-EXEC
      *    MOVE '&"S        E          (  N#00019055' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303139303535' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERMAIL, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERMAIL-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF MAILING-DATA TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011840
011841     IF RESP-NORMAL
011842        SET ERMAIL-FOUND TO TRUE
011843     END-IF
011844     .
011845 6220-EXIT.
011846     EXIT.
011847
011848 6400-CHECK-FOR-RES-REF-CLAIM.
011849
011850     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
011851
011852     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
011853                                    W-CL-COMP-CD.
011854     MOVE PI-CERT-NO             TO MSTR-CERT-NO
011855                                    W-CL-CERT-NO.
011856     MOVE SPACES                 TO MSTR-CERT-SFX.
011857
011858     
      * EXEC CICS HANDLE CONDITION
011859*        NOTFND  (6400-CONTINUE)
011860*        ENDFILE (6400-CONTINUE)
011861*    END-EXEC.
      *    MOVE '"$I''                  ! S #00019079' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'5320233030303139303739' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011862
011863     
      * EXEC CICS IGNORE CONDITION
011864*        DUPKEY
011865*    END-EXEC.
      *    MOVE '"*$                   !   #00019084' TO DFHEIV0
           MOVE X'222A24202020202020202020' &
                X'202020202020202020202120' &
                X'2020233030303139303834' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011866
011867     
      * EXEC CICS STARTBR
011868*        DATASET   (CLMS-ID)
011869*        RIDFLD    (ELMSTR-KEY)
011870*        GENERIC   EQUAL
011871*        KEYLENGTH (ELMSTR-LENGTH)
011872*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,   KG    E          &   #00019088' TO DFHEIV0
           MOVE X'262C2020204B472020202045' &
                X'202020202020202020202620' &
                X'2020233030303139303838' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 ELMSTR-KEY, 
                 ELMSTR-LENGTH, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011873
011874     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
011875
011876 6400-NEXT-CLAIM.
011877
011878     
      * EXEC CICS READNEXT
011879*        DATASET   (CLMS-ID)
011880*        RIDFLD    (ELMSTR-KEY)
011881*        SET       (ADDRESS OF CLAIM-MASTER)
011882*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )   #00019099' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303139303939' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELMSTR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CLAIM-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
011883
011884     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
011885        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
011886         GO TO 6400-CONTINUE
011887     END-IF.
011888
011889     IF PI-CARRIER     NOT = CL-CARRIER        OR
011890        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
011891        PI-STATE       NOT = CL-CERT-STATE     OR
011892        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
011893        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
011894         GO TO 6400-NEXT-CLAIM
011895     END-IF.
011896
011897*    display 'found claim ' cl-claim-no
011898*       ' with denial type ' cl-denial-type
011899
011900     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
011901         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
011902         GO TO 6400-CONTINUE
011903     END-IF.
011904
011905     GO TO 6400-NEXT-CLAIM.
011906
011907 6400-CONTINUE.
011908
011909     IF WS-BROWSE-STARTED-SW = 'Y'
011910         
      * EXEC CICS ENDBR
011911*            DATASET   (CLMS-ID)
011912*        END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00019131' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303139313331' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011913         MOVE 'N' TO WS-BROWSE-STARTED-SW
011914     END-IF.
011915
011916 6400-EXIT.
011917     EXIT.
011918
011919 7000-DISPLAY-ISSUES.
011920
011921     IF PI-DISPLAY-ORIGINAL-BATCH
011922        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
011923        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
011924     ELSE
011925        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
011926
011927     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
011928
011929     MOVE 'Y'                        TO WS-DISPLAY-SW.
011930     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
011931
011932     MOVE LOW-VALUES                 TO EL631BI.
011933     MOVE ZEROS                      TO PI-BPMTAMT
011934                                        PI-BPMTS.
011935     MOVE SPACE                      TO PI-BMODE
011936                                        PI-BTYPE (1)
011937                                        PI-BTYPE (2).
011938     MOVE EL631B                     TO PI-MAP-NAME.
011939     MOVE 'Y'                        TO PI-BROWSE-SW.
011940     MOVE PB-BATCH-SEQ-NO            TO BSEQO
011941                                        PI-HIGH-SEQ-NO.
011942
011943     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
011944        MOVE AL-SABOF                TO BCHGTA
011945        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
011946        MOVE AL-SANON                TO BCHGA
011947     ELSE
011948        MOVE AL-SADOF                TO BCHGTA
011949                                        BCHGA
011950        MOVE PB-CHG-COUNT            TO BCHGO.
011951
011952     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
011953     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
011954     MOVE WS-HR-MINS                 TO BMANTATO.
011955
011956     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
011957        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
011958        MOVE SPACE                   TO DC-OPTION-CODE
011959        PERFORM 9700-DATE-LINK
011960        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
011961        MOVE 'INACTIVE'              TO BMOENDTO
011962     ELSE
011963        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
011964        MOVE SPACE                   TO DC-OPTION-CODE
011965        PERFORM 9700-DATE-LINK
011966        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
011967        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
011968        MOVE SPACE                   TO DC-OPTION-CODE
011969        PERFORM 9700-DATE-LINK
011970        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
011971
011972*    MOVE PB-I-REFERENCE             TO BREFO.
011973
011974*    IF PI-COMPANY-ID EQUAL 'HER'
011975*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
011976*        IF WS-MEMBER-NO-1-8  IS NUMERIC
011977*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
011978*                MOVE WS-MEMBER-NO-1-8
011979*                                TO  BMICRNOO.
011980
011981*    IF PB-I-MICROFILM-NO  IS NUMERIC
011982*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
011983*            MOVE PB-I-MICROFILM-NO
011984*                                TO  BMICRNOO.
011985
011986     IF PB-I-VIN NOT = SPACES
011987        MOVE PB-I-VIN            TO BVINO
011988     END-IF
011989
011990     MOVE PB-I-LETTER-REQD           TO LETRREQO
011991
011992
011993     MOVE PB-CERT-PRIME              TO BCERTNOO.
011994     MOVE PB-CERT-SFX                TO BSUFIXO.
011995     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
011996     MOVE SPACE                      TO DC-OPTION-CODE.
011997     PERFORM 9700-DATE-LINK.
011998     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
011999
012000     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
012001     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
012002     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
012003     MOVE PB-I-INSURED-SEX           TO BSEXO
012004
012005     IF PB-I-AGE NOT = ZEROS
012006         MOVE PB-I-AGE               TO BAGEO.
012007
012008     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
012009                                 TO ELCERT-KEY
012010     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
012011     IF NOT CERT-TRL-REC-NOT-FOUND
012012         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
012013             MOVE 'AGE*'             TO BAGEDEFO
012014         ELSE
012015             MOVE 'AGE '             TO BAGEDEFO
012016         END-IF
012017     ELSE
012018         MOVE 'AGE '             TO BAGEDEFO
012019     END-IF
012020
012021     IF PB-I-BIRTHDAY NOT = LOW-VALUES
012022         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
012023         MOVE SPACE                  TO DC-OPTION-CODE
012024         PERFORM 9700-DATE-LINK
012025         IF NO-CONVERSION-ERROR
012026            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
012027
012028     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
012029         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
012030         MOVE SPACE                  TO DC-OPTION-CODE
012031         PERFORM 9700-DATE-LINK
012032         IF NO-CONVERSION-ERROR
012033            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
012034
012035     IF PB-I-EXTENTION-DAYS NUMERIC
012036        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
012037           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
012038        ELSE
012039           IF PB-I-TERM-IN-DAYS NUMERIC
012040              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
012041                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
012042
012043     IF PB-I-LOAN-TERM GREATER THAN ZEROS
012044        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
012045
012046     MOVE PB-FORCE-CODE              TO BFORCEO.
012047     MOVE PB-I-TERM-TYPE             TO BMODEO
012048                                        PI-BMODE.
012049
012050     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
012051        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
012052
012053     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
012054         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
012055                                        PI-BPMTS.
012056
012057     IF PB-I-PAYMENT-AMOUNT NUMERIC
012058         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
012059           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
012060                                        PI-BPMTAMT.
012061
012062     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
012063     MOVE PB-BATCH-ENTRY             TO BENTRYO.
012064     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
012065     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
012066     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
012067     MOVE PB-I-SIG-SW                TO BSIGO.
012068     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
012069     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
012070     MOVE PB-RECORD-BILL             TO BBILCDO.
012071     MOVE PB-FORCE-CODE              TO BFORCEO.
012072
012073     IF (PB-I-LIVES NUMERIC)
012074        AND (PB-I-LIVES > ZEROS)
012075        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
012076        IF (RESP-NORMAL)
012077           AND (AM-DCC-PRODUCT-CODE = 'DDF')
012078           CONTINUE
012079        ELSE
012080           MOVE PB-I-LIVES       TO BLIVESO
012081        END-IF
012082     END-IF
012083
012084     IF PB-I-NUM-BILLED NUMERIC AND
012085        PB-I-NUM-BILLED GREATER THAN ZEROS
012086        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
012087*    ELSE
012088*       MOVE ZEROS                   TO BBILLEDO.
012089
012090     MOVE PB-CHG-COUNT               TO BCHGCNTO.
012091
012092     IF PB-I-LOAN-APR NOT = +99.9999
012093        MOVE PB-I-LOAN-APR           TO BAPRO.
012094
012095     IF PB-I-MEMBER-NO  GREATER THAN SPACES
012096        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
012097
012098     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
012099        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
012100           MOVE AL-SANOF                TO BORIGHDA
012101           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
012102           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
012103
012104     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
012105
012106     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
012107        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
012108
012109     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
012110        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
012111                                        PI-BTYPE (1).
012112
012113     IF PB-I-LF-TERM     GREATER THAN ZEROS
012114        MOVE PB-I-LF-TERM            TO BTERMO (1).
012115
012116     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
012117        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
012118
012119     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
012120        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
012121
012122     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
012123        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
012124
012125     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
012126        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
012127
012128     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
012129         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
012130         MOVE SPACE                  TO DC-OPTION-CODE
012131         PERFORM 9700-DATE-LINK
012132         IF NO-CONVERSION-ERROR
012133            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
012134
012135     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
012136        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
012137        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
012138        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
012139        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
012140                 GIVING BDIFFO (1)
012141     ELSE
012142        MOVE SPACES                  TO BBEN-CD     (1)
012143                                        BBEN-ABBR   (1).
012144
012145     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
012146        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
012147        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
012148                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
012149
012150     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
012151       IF PB-RECORD-ON-HOLD
012152          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
012153
012154     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
012155       IF PB-RECORD-RETURNED
012156          MOVE 'RETURNED'          TO BBILL-LIT     (1).
012157
012158     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
012159        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
012160             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
012161
012162     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
012163
012164     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
012165        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
012166
012167     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
012168        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
012169                                        PI-BTYPE (2).
012170
012171     IF PB-I-AH-TERM     GREATER THAN ZEROS
012172        MOVE PB-I-AH-TERM            TO BTERMO      (2).
012173
012174     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
012175        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
012176
012177     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
012178        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
012179
012180     IF PB-I-TOT-FEES NOT NUMERIC
012181        MOVE ZEROS               TO PB-I-TOT-FEES
012182     END-IF
012183
012184     IF PB-I-TOT-FEES > ZEROS
012185        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
012186
012187     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
012188         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
012189         MOVE SPACE                  TO DC-OPTION-CODE
012190         PERFORM 9700-DATE-LINK
012191         IF NO-CONVERSION-ERROR
012192            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
012193
012194     IF PB-I-TOT-FEES > ZEROS
012195        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
012196        SUBTRACT PB-I-TOT-FEES FROM
012197                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
012198
012199     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
012200        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
012201        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
012202        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
012203        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
012204                 GIVING BDIFFO (2)
012205     ELSE
012206        MOVE SPACES                  TO BBEN-CD     (2)
012207                                        BBEN-ABBR   (2).
012208
012209     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
012210       IF PB-RECORD-ON-HOLD
012211          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
012212
012213     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
012214       IF PB-RECORD-RETURNED
012215          MOVE 'RETURNED'          TO BBILL-LIT     (2).
012216
012217     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
012218        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
012219             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
012220
012221     MOVE PB-CSR-ID                  TO BCSRO.
012222
012223     IF PI-COMPANY-ID  =  'DMD'
012224        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
012225            NEXT SENTENCE
012226        ELSE
012227            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
012228               MOVE 'NEW CERT'       TO BNCERTLI
012229               MOVE EC-NEW-CERT      TO BNCERTO.
012230
012231     IF PI-COMPANY-ID  =  'DMD'
012232        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
012233            NEXT SENTENCE
012234        ELSE
012235           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
012236               MOVE 'NEW STATE'      TO BNSTATLI
012237               MOVE EC-NEW-STATE     TO BNSTATO.
012238
012239 7000-CONTINUE.
012240     MOVE 'C'                        TO BMAINTI.
012241     MOVE AL-UANON                   TO BMAINTA.
012242
012243
012244     IF PB-BATCH-CHG-SEQ-NO = ZEROS
012245        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
012246
012247     IF ARCHIVE-LETTER-RELEASED
012248        PERFORM 7050-UPDATE-PENDING THRU 7050-EXIT
012249     END-IF
012250
012251     IF PI-6315-FINALIZED = 'Y'   AND
012252        PB-UNFORCED-ERRORS
012253          MOVE -1                TO BFORCEL
012254          MOVE  1                TO SET-CURSOR-SW
012255     END-IF
012256
012257     IF NO-CURSOR-SET
012258        MOVE -1                      TO BMAINTL.
012259
012260     GO TO 8100-SEND-INITIAL-MAP.
012261
012262     EJECT
012263
012264 7050-UPDATE-PENDING.
012265     
      * EXEC CICS READ
012266*        DATASET (FILE-ID-ERPNDB)
012267*        INTO    (PENDING-BUSINESS)
012268*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
012269*        UPDATE
012270*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00019486' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303139343836' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 PI-PREV-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
012271
012272     MOVE 'C' TO PB-I-LETTER-REQD
012273     MOVE PB-I-LETTER-REQD       TO LETRREQO
012274     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
012275     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
012276     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
012277     MOVE '5'                    TO DC-OPTION-CODE.
012278     PERFORM 9700-DATE-LINK
012279     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
012280
012281     
      * EXEC CICS REWRITE
012282*        DATASET (FILE-ID-ERPNDB)
012283*        FROM    (PENDING-BUSINESS)
012284*    END-EXEC.
           MOVE LENGTH OF
            PENDING-BUSINESS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00019502' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303139353032' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 PENDING-BUSINESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
012285
012286 7050-EXIT.
012287      EXIT.
012288
012289******************************************************************
012290*                                                                *
012291*             D I S P L A Y   C A N C E L S                      *
012292*                                                                *
012293******************************************************************
012294
012295 7100-DISPLAY-CANCELS.
012296     IF PI-DISPLAY-ORIGINAL-BATCH
012297        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
012298        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
012299     ELSE
012300        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
012301
012302     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
012303
012304     MOVE 'Y'                        TO WS-DISPLAY-SW.
012305     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
012306
012307     MOVE LOW-VALUES                 TO EL631CI.
012308     MOVE EL631C                     TO PI-MAP-NAME.
012309     MOVE 'Y'                        TO PI-BROWSE-SW.
012310     MOVE PB-BATCH-SEQ-NO            TO CSEQO
012311                                        PI-HIGH-SEQ-NO.
012312
012313     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
012314        MOVE AL-SABOF                TO CCHGTA
012315        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
012316        MOVE AL-SANON                TO CCHGA
012317      ELSE
012318        MOVE AL-SADOF                TO CCHGTA
012319                                        CCHGA
012320        MOVE PB-CHG-COUNT            TO CCHGCNTO.
012321
012322*    MOVE PB-C-REFERENCE             TO CREFO.
012323
012324*    IF PB-C-MICROFILM-NO IS NUMERIC
012325*       IF PB-C-MICROFILM-NO  NOT = ZEROS
012326*          MOVE PB-C-MICROFILM-NO
012327*                                TO CMICRNOO
012328*          MOVE AL-UNNON         TO CMICRNOA
012329*       END-IF
012330*    END-IF
012331
012332     IF PB-C-INT-ON-REFS NUMERIC
012333        IF PB-C-INT-ON-REFS NOT = ZEROS
012334           MOVE PB-C-INT-ON-REFS
012335                                 TO CNHINTO
012336           MOVE AL-SANOF         TO CNHINTA
012337        END-IF
012338     END-IF
012339
012340     MOVE PB-CERT-PRIME              TO CCERTNOO.
012341     MOVE PB-CERT-SFX                TO CSUFIXO.
012342     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
012343     MOVE SPACE                      TO DC-OPTION-CODE.
012344     PERFORM 9700-DATE-LINK.
012345     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
012346
012347     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
012348        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
012349        MOVE SPACE                   TO DC-OPTION-CODE
012350        PERFORM 9700-DATE-LINK
012351        IF NO-CONVERSION-ERROR
012352           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
012353
012354     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
012355        NEXT SENTENCE
012356     ELSE
012357        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
012358
012359     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
012360        NEXT SENTENCE
012361     ELSE
012362        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
012363
012364     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
012365        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
012366        MOVE SPACE                   TO DC-OPTION-CODE
012367        PERFORM 9700-DATE-LINK
012368        IF NO-CONVERSION-ERROR
012369           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
012370
012371     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
012372         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
012373
012374     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
012375         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
012376
012377     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
012378        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
012379        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
012380                 GIVING CDRFND1O.
012381
012382     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
012383        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
012384        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
012385                 GIVING CDRFND2O.
012386
012387     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
012388       IF PB-RECORD-ON-HOLD
012389          MOVE 'ON HOLD'             TO CBILIT1O.
012390
012391     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
012392       IF PB-RECORD-RETURNED
012393          MOVE 'RETURNED'            TO CBILIT1O.
012394
012395     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
012396        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
012397             MOVE 'OVERRIDE'         TO CBILIT1O.
012398
012399     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
012400       IF PB-RECORD-ON-HOLD
012401          MOVE 'ON HOLD'             TO CBILIT2O.
012402
012403     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
012404       IF PB-RECORD-RETURNED
012405          MOVE 'RETURNED'            TO CBILIT2O.
012406
012407     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
012408        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
012409             MOVE 'OVERRIDE'         TO CBILIT2O.
012410
012411     MOVE PB-C-LAST-NAME             TO CLSTNMO.
012412
012413     PERFORM 6210-READ-ERACCT THRU 6210-EXIT
012414     IF (RESP-NORMAL)
012415       AND (PB-CONTROL-BY-ACCOUNT (1:20) =
012416          AM-CONTROL-PRIMARY (1:20))
012417       IF AM-GPCD > 1
012418         AND AM-GPCD < 6
012419         AND PB-C-CANCEL-REASON NOT > SPACES
012420          MOVE 'Y'                     TO PB-C-CANCEL-REASON
012421       END-IF
012422     END-IF.
012423     MOVE PB-C-CANCEL-REASON         TO CCANREAO
012424                                        PI-CANCEL-REASON-631
012425     MOVE PB-FORCE-CODE              TO CFORCEO.
012426     MOVE PB-RECORD-BILL             TO CBILCDO.
012427     MOVE PB-CI-LAST-NAME            TO CINAMEO.
012428     MOVE SPACES                     TO CINITSO.
012429     IF PB-CI-FIRST-NAME GREATER THAN SPACES
012430         MOVE PB-CI-FIRST-NAME       TO CINITSO
012431     ELSE
012432         MOVE PB-CI-INITIALS         TO CINITSO
012433     END-IF.
012434
012435     IF PB-CI-CANCEL-FEE NUMERIC
012436        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
012437        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
012438     ELSE
012439        MOVE ZEROES                  TO W-CANCEL-FEE.
012440
012441     MOVE W-CANCEL-FEE               TO CCANFEEO.
012442
012443     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
012444        ADD PB-CI-LF-PREMIUM-AMT
012445             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
012446
012447     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
012448        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
012449
012450     MOVE PB-CI-LF-TERM              TO CTERM1O.
012451     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
012452     MOVE PB-CI-AH-TERM              TO CTERM2O.
012453     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
012454
012455     IF PB-C-LIVES NUMERIC
012456        MOVE PB-C-LIVES              TO CLIVESO.
012457
012458     IF PB-C-PAYEE-CODE GREATER THAN SPACES
012459        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
012460
012461     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
012462        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
012463        MOVE SPACE                   TO DC-OPTION-CODE
012464        PERFORM 9700-DATE-LINK
012465        IF NO-CONVERSION-ERROR
012466           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
012467
012468     IF  PB-C-REFUND-CREATED
012469         MOVE 'YES'                  TO CRFNDSWO
012470     ELSE
012471         IF PB-C-REFUND-REQUESTED
012472            MOVE 'REQ'               TO CRFNDSWO
012473         ELSE
012474            MOVE 'NO'                TO CRFNDSWO.
012475
012476     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
012477     MOVE SPACE                      TO DC-OPTION-CODE.
012478     PERFORM 9700-DATE-LINK.
012479     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
012480     MOVE PB-INPUT-BY                TO CENTBYO.
012481
012482     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
012483        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
012484        MOVE SPACE                   TO DC-OPTION-CODE
012485        PERFORM 9700-DATE-LINK
012486        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
012487        MOVE 'INACTIVE'              TO CMOENDTO
012488     ELSE
012489        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
012490        MOVE SPACE                   TO DC-OPTION-CODE
012491        PERFORM 9700-DATE-LINK
012492        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
012493        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
012494        MOVE SPACE                   TO DC-OPTION-CODE
012495        PERFORM 9700-DATE-LINK
012496        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
012497
012498     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
012499
012500     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
012501     MOVE WS-HR-MINS                 TO CMANTATO.
012502
012503     EVALUATE PB-LF-REFUND-TYPE
012504        WHEN '1'
012505           MOVE 'RULE78'            TO CLFREFNO
012506        WHEN '2'
012507           MOVE 'PRORAT'            TO CLFREFNO
012508        WHEN '3'
012509           MOVE 'CALIF'             TO CLFREFNO
012510        WHEN '4'
012511           MOVE 'IRREG'             TO CLFREFNO
012512        WHEN '5'
012513           MOVE 'NETPAY'            TO CLFREFNO
012514        WHEN '6'
012515           MOVE 'ATCP'              TO CLFREFNO
012516        WHEN '7'
012517           MOVE 'UTAH'              TO CLFREFNO
012518        WHEN '8'
012519           MOVE 'MEAN'              TO CLFREFNO
012520        WHEN '9'
012521           MOVE 'SUM '              TO CLFREFNO
012522        WHEN 'B'
012523           MOVE 'BALN'              TO CLFREFNO
012524     END-EVALUATE.
012525
012526     EVALUATE TRUE
012527        WHEN PB-AH-REFUND-TYPE =  '1'
012528           MOVE 'RULE78'            TO CAHREFNO
012529        WHEN PB-AH-REFUND-TYPE =  '2'
012530           MOVE 'PRORAT'            TO CAHREFNO
012531        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
012532           MOVE 'CALIF'             TO CAHREFNO
012533        WHEN PB-AH-REFUND-TYPE =  '4'
012534           MOVE 'IRREG'             TO CAHREFNO
012535        WHEN PB-AH-REFUND-TYPE =  '5'
012536           MOVE 'NETPAY'            TO CAHREFNO
012537        WHEN PB-AH-REFUND-TYPE =  '6'
012538           MOVE 'ATCP'              TO CAHREFNO
012539        WHEN PB-AH-REFUND-TYPE =  '7'
012540           MOVE 'UTAH'              TO CAHREFNO
012541        WHEN PB-AH-REFUND-TYPE =  '8'
012542           MOVE 'MEAN'              TO CAHREFNO
012543        WHEN PB-AH-REFUND-TYPE =  '9'
012544           MOVE 'SUM '              TO CAHREFNO
012545        WHEN PB-AH-REFUND-TYPE =  'B'
012546           MOVE 'BALN'              TO CAHREFNO
012547     END-EVALUATE.
012548
012549     MOVE PB-REIN-CD                 TO CREINCDO.
012550
012551     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
012552        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
012553        MOVE SPACE                   TO DC-OPTION-CODE
012554        PERFORM 9700-DATE-LINK
012555        IF NO-CONVERSION-ERROR
012556           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
012557
012558     IF PB-ACCT-EXP-DT  = HIGH-VALUES
012559        MOVE 999999                  TO WS-EXP-DT-EDIT
012560        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
012561        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
012562     ELSE
012563        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
012564           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
012565           MOVE SPACE                   TO DC-OPTION-CODE
012566           PERFORM 9700-DATE-LINK
012567           IF NO-CONVERSION-ERROR
012568              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
012569
012570     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
012571        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
012572           MOVE AL-SANOF                TO CORIGHDA
012573           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
012574           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
012575
012576     MOVE PB-CSR-ID              TO CCSRO.
012577
012578     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
012579     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
012580
012581     MOVE 'N'                    TO ACTSPCO
012582     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACNT-KEY
012583     MOVE '2'                    TO ERACNT-REC-TYPE
012584     MOVE +3                     TO ERACNT-SEQ-NO
012585
012586     
      * EXEC CICS READ
012587*         DATASET   ('ERACNT')
012588*         INTO      (NOTE-FILE)
012589*         RIDFLD    (ERACNT-KEY)
012590*         RESP      (WS-RESPONSE)
012591*    END-EXEC
           MOVE LENGTH OF
            NOTE-FILE
             TO DFHEIV11
           MOVE 'ERACNT' TO DFHEIV1
      *    MOVE '&"IL       E          (  N#00019807' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303139383037' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 NOTE-FILE, 
                 DFHEIV11, 
                 ERACNT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
012592
012593     IF RESP-NORMAL
012594        IF NT-account-special = 'Y'
012595           MOVE 'Y'              TO actspcO
012596           MOVE ER-1762          TO EMI-ERROR
012597           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
012598        END-IF
012599     END-IF
012600
012601     MOVE 'C'                    TO CMAINTI.
012602     MOVE AL-UANON               TO CMAINTA.
012603
012604     IF PI-6316-FINALIZED = 'Y'  AND
012605        PB-UNFORCED-ERRORS
012606          MOVE -1                TO CFORCEL
012607          MOVE  1                TO SET-CURSOR-SW
012608     END-IF
012609
012610     IF PB-BATCH-CHG-SEQ-NO = ZEROS
012611        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
012612
012613     IF NO-CURSOR-SET
012614        MOVE -1                  TO CMAINTL.
012615
012616     GO TO 8100-SEND-INITIAL-MAP.
012617
012618
012619     EJECT
012620***************************************************************
012621*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
012622*     RECORD TO THE BATCH TOTAL SCREEN.                       *
012623***************************************************************
012624
012625 7200-DISPLAY-BATCHES.
012626     MOVE EL631D                 TO PI-MAP-NAME.
012627     MOVE LOW-VALUES             TO EL631DI.
012628
012629     MOVE 'Y'                    TO WS-DISPLAY-SW.
012630
012631     
      * EXEC CICS HANDLE CONDITION
012632*         NOTFND   (3690-NOT-FOUND)
012633*    END-EXEC.
      *    MOVE '"$I                   ! T #00019852' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'5420233030303139383532' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
012634
012635     IF PI-DISPLAY-SCREEN
012636        MOVE PI-PREV-KEY         TO ERPNDB-KEY
012637     ELSE
012638        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
012639
012640     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
012641     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
012642
012643     
      * EXEC CICS READ
012644*         DATASET   (FILE-ID-ERPNDB)
012645*         RIDFLD    (ERPNDB-KEY)
012646*         SET       (ADDRESS OF PENDING-BUSINESS)
012647*    END-EXEC.
      *    MOVE '&"S        E          (   #00019864' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303139383634' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERPNDB, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERPNDB-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF PENDING-BUSINESS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
012648
012649     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
012650     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
012651     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
012652     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
012653     MOVE PB-SV-STATE            TO PI-SV-STATE.
012654
012655     MOVE EL631D                 TO PI-MAP-NAME.
012656     MOVE LOW-VALUES             TO EL631DI.
012657     MOVE PB-ENTRY-BATCH         TO DBATCHO.
012658
012659*    IF PI-AR-PROCESSING
012660*       MOVE PB-REFERENCE        TO DREFO.
012661
012662     MOVE PB-CSR-ID              TO DCSRO.
012663
012664     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
012665        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
012666        MOVE SPACE               TO DC-OPTION-CODE
012667        PERFORM 9700-DATE-LINK
012668        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
012669        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
012670        MOVE 'INACTIVE'          TO DLDATEO
012671     ELSE
012672        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
012673        MOVE SPACE               TO DC-OPTION-CODE
012674        PERFORM 9700-DATE-LINK
012675        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
012676
012677     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
012678     MOVE SPACE                  TO DC-OPTION-CODE.
012679     PERFORM 9700-DATE-LINK.
012680     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
012681
012682     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
012683        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
012684     ELSE
012685        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
012686        MOVE SPACE               TO DC-OPTION-CODE
012687        PERFORM 9700-DATE-LINK
012688        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
012689
012690     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
012691     MOVE SPACE                  TO DC-OPTION-CODE.
012692     PERFORM 9700-DATE-LINK.
012693     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
012694
012695     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
012696     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
012697
012698     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
012699        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
012700                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
012701
012702     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
012703     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
012704     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
012705
012706     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
012707        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
012708                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
012709
012710     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
012711     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
012712     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
012713
012714     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
012715        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
012716                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
012717
012718     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
012719     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
012720
012721     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
012722        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
012723                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
012724
012725     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
012726     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
012727     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
012728
012729     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
012730        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
012731                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
012732
012733     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
012734     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
012735     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
012736
012737     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
012738        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
012739                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
012740
012741     MOVE -1                     TO DPFENTRL.
012742     GO TO 8100-SEND-INITIAL-MAP.
012743
012744     EJECT
012745
012746***************************************************************
012747*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
012748*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
012749*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
012750*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
012751*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
012752*     ARE THEN SET ACCORDINGLY.                               *
012753*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
012754*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
012755*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
012756***************************************************************
012757
012758******************************************************************
012759*                                                                *
012760*            E R R O R   A N A L Y S I S                         *
012761*                                                                *
012762******************************************************************
012763
012764******************************************************************
012765*                                                                *
012766*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
012767*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
012768*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
012769*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
012770*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
012771*                                                                *
012772*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
012773*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
012774*                                                                *
012775******************************************************************
012776
012777 7300-FORMAT-ERRORS.
012778
012779     MOVE ' '                    TO PI-ERRORS-SW
012780
012781     IF PB-COMMON-ERRORS = LOW-VALUES
012782        IF PB-FATAL-ERRORS
012783           MOVE ER-2695          TO EMI-ERROR
012784           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
012785           GO TO 7399-EXIT.
012786
012787     MOVE +0                     TO WS-SUB4
012788     move +0                     to pi-6311-fatal-ctr
012789
012790     .
012791 7310-ERROR-LOOP.
012792
012793     ADD +1                      TO WS-SUB4.
012794
012795     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
012796        GO TO 7350-SET-ERROR-FLAGS.
012797
012798     IF PI-COMPANY-ID = 'UCL'
012799         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
012800             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
012801             MOVE ' '                   TO DC-OPTION-CODE
012802             PERFORM 9700-DATE-LINK
012803             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
012804
012805     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
012806     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
012807
012808     if (emi-fatal)
012809        and (emi-error not = 1753 and 1754 and 1757 and
012810                             1758 and 1759 and 1760)
012811        add +1                   to pi-6311-fatal-ctr
012812     end-if
012813     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
012814
012815     GO TO 7310-ERROR-LOOP.
012816
012817
012818 7350-SET-ERROR-FLAGS.
012819
012820     IF EMI-FATAL-CTR NOT = ZEROS
012821        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
012822        MOVE 'X'                 TO PB-FATAL-FLAG
012823                                    PI-ERRORS-SW
012824        GO TO 7355-SET-ERROR-FLAGS.
012825
012826     move ' ' to pi-unforced-sw
012827     IF EMI-FORCABLE-CTR NOT = ZEROS
012828        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
012829        IF PB-ISSUE
012830           IF PB-ISSUE-FORCE
012831              MOVE 'F'           TO PB-FORCE-ER-CD
012832              MOVE ER-2600       TO EMI-ERROR
012833              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
012834             ELSE
012835              MOVE 'X'           TO PB-FORCE-ER-CD
012836*                                   PI-ERRORS-SW
012837          ELSE
012838           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
012839              MOVE 'F'           TO PB-FORCE-ER-CD
012840                                    pi-unforced-sw
012841              MOVE ER-2600       TO EMI-ERROR
012842              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
012843             ELSE
012844              MOVE 'X'           TO PB-FORCE-ER-CD
012845                                    pi-unforced-sw.
012846*                                   PI-ERRORS-SW.
012847
012848     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
012849     IF PB-ISSUE
012850         MOVE 'I'                TO ENDT-RECORD-TYPE
012851     ELSE
012852         MOVE 'C'                TO ENDT-RECORD-TYPE
012853     END-IF
012854     MOVE +0                     TO ENDT-SEQ-NO
012855
012856     
      * EXEC CICS READ
012857*        DATASET   (FILE-ID-ERENDT)
012858*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
012859*        RIDFLD    (ERENDT-KEY)
012860*        RESP      (WS-RESPONSE)
012861*        GTEQ
012862*    END-EXEC
      *    MOVE '&"S        G          (  N#00020077' TO DFHEIV0
           MOVE X'262253202020202020202047' &
                X'202020202020202020202820' &
                X'204E233030303230303737' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERENDT, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERENDT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF ENDORSEMENT-RECORD TO
               DFHEIV20
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
012863
012864     IF RESP-NORMAL
012865        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
012866        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
012867            MOVE ER-0280          TO EMI-ERROR
012868            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
012869            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
012870            IF CALLED-FROM-6315
012871               MOVE 'Y' TO WS-ARCHIVE-LETTER-SW
012872            END-IF
012873            EVALUATE TRUE
012874              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
012875                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
012876              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
012877                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
012878              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
012879                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
012880            END-EVALUATE
012881        END-IF
012882     END-IF
012883
012884
012885
012886     IF FIRST-ENTRY OR
012887        EIBAID = DFHPF1 OR DFHPF2
012888        MOVE '0'                TO PI-EDIT-SW
012889        GO TO 7399-EXIT.
012890
012891 7355-SET-ERROR-FLAGS.
012892
012893     IF EMI-WARNING-CTR NOT = ZEROS
012894        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
012895        MOVE 'W'                 TO PB-WARN-ER-CD.
012896
012897     IF PB-UNFORCED-ERRORS OR
012898        PB-FATAL-ERRORS    OR
012899        PB-RECORD-ON-HOLD  OR
012900        PB-RECORD-RETURNED OR
012901        PB-CANCELLATION
012902          NEXT SENTENCE
012903        ELSE
012904          GO TO 7399-EXIT.
012905
012906     
      * EXEC CICS  HANDLE CONDITION
012907*           NOTFND   (7399-EXIT)
012908*    END-EXEC.
      *    MOVE '"$I                   ! U #00020127' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'5520233030303230313237' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
012909
012910     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
012911     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
012912     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
012913     MOVE PB-SV-STATE            TO ELCERT-STATE.
012914
012915     
      * EXEC CICS READ
012916*        SET     (ADDRESS OF CERTIFICATE-MASTER)
012917*        DATASET (FILE-ID-ELCERT)
012918*        RIDFLD  (ELCERT-KEY)
012919*        UPDATE
012920*    END-EXEC.
      *    MOVE '&"S        EU         (   #00020136' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303230313336' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CERTIFICATE-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
012921
012922
012923     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
012924     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
012925
012926     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
012927        GO TO 7360-REWRITE-CERT-MASTER.
012928
012929     IF PB-ISSUE
012930        IF PB-RECORD-RETURNED
012931            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
012932            GO TO 7360-REWRITE-CERT-MASTER
012933        ELSE
012934            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
012935            GO TO 7360-REWRITE-CERT-MASTER.
012936
012937     IF PB-RECORD-RETURNED
012938         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
012939         GO TO 7360-REWRITE-CERT-MASTER.
012940
012941     IF (PB-C-LF-CANCEL-VOIDED)
012942        or (pb-c-ah-cancel-voided)
012943        IF (PB-UNFORCED-ERRORS OR
012944            PB-FATAL-ERRORS    OR
012945            PB-RECORD-ON-HOLD)
012946            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
012947            GO TO 7360-REWRITE-CERT-MASTER
012948        ELSE
012949            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
012950            GO TO 7360-REWRITE-CERT-MASTER.
012951
012952     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
012953                            OR PB-RECORD-ON-HOLD)
012954        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
012955     ELSE
012956        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
012957
012958 7360-REWRITE-CERT-MASTER.
012959
012960     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
012961        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
012962        
      * EXEC CICS UNLOCK
012963*            DATASET    (FILE-ID-ELCERT)
012964*       END-EXEC
      *    MOVE '&*                    #   #00020183' TO DFHEIV0
           MOVE X'262A20202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303230313833' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
012965        GO TO 7399-EXIT.
012966
012967     
      * EXEC CICS REWRITE
012968*         DATASET    (FILE-ID-ELCERT)
012969*         FROM       (CERTIFICATE-MASTER)
012970*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV11
      *    MOVE '&& L                  %   #00020188' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303230313838' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ELCERT, 
                 CERTIFICATE-MASTER, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
012971
012972 7399-EXIT.
012973      EXIT.
012974
012975     EJECT
012976
012977*************************************************************
012978*                                                           *
012979*              S E T   A T T R I B U T E S                  *
012980*                                                           *
012981*************************************************************
012982
012983 7400-SET-ATTRIBUTES.
012984
012985     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
012986        GO TO 7499-EXIT.
012987
012988**2601**
012989
012990     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
012991        IF PB-ISSUE
012992           MOVE AL-UABON         TO BEFFDTA
012993           GO TO 7499-EXIT
012994         ELSE
012995           MOVE AL-UABON         TO CEFFDTA
012996           GO TO 7499-EXIT.
012997
012998**2604**
012999
013000     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
013001        IF PB-ISSUE
013002           MOVE AL-UABON         TO BTYPE1A
013003           MOVE -1               TO BTYPE1L
013004           MOVE  1               TO SET-CURSOR-SW
013005           GO TO 7499-EXIT.
013006
013007**2605**
013008
013009     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
013010        IF PB-ISSUE
013011           MOVE AL-UABON         TO BTYPE2A
013012           MOVE -1               TO BTYPE2L
013013           MOVE  1               TO SET-CURSOR-SW
013014           GO TO 7499-EXIT.
013015
013016**2606**
013017
013018     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
013019        IF PB-ISSUE
013020           MOVE AL-UABON         TO BSIGA
013021           MOVE -1               TO BSIGL
013022           MOVE  1               TO SET-CURSOR-SW
013023           GO TO 7499-EXIT.
013024
013025**2607**
013026
013027     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
013028        IF PB-ISSUE
013029           MOVE AL-UABON         TO BSIGA
013030           MOVE -1               TO BSIGL
013031           MOVE  1               TO SET-CURSOR-SW
013032           GO TO 7499-EXIT.
013033
013034**2615**
013035
013036     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
013037        IF PB-ISSUE
013038           MOVE AL-UABOF         TO BREINA
013039           MOVE -1               TO BREINL
013040           GO TO 7499-EXIT.
013041
013042**2622**
013043
013044     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
013045        IF PB-ISSUE
013046           MOVE AL-UABON         TO BEFFDTA
013047           GO TO 7499-EXIT
013048        ELSE
013049           MOVE AL-UABON         TO CEFFDTA
013050           GO TO 7499-EXIT.
013051
013052     EJECT
013053
013054*************************************************************
013055*                                                           *
013056*              I S S U E   E R R O R S                      *
013057*                                                           *
013058*************************************************************
013059
013060 7420-ISSUE-ERRORS.
013061
013062     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1577
013063        MOVE -1                  TO LETRREQL
013064        MOVE AL-UABOF            TO LETRREQA
013065        MOVE  1                  TO SET-CURSOR-SW
013066        GO TO 7499-EXIT.
013067
013068     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1584
013069        MOVE AL-UABOF            TO LETRREQA
013070        GO TO 7499-EXIT.
013071
013072**2626**
013073
013074     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
013075        MOVE AL-UABON            TO BCERTNOA
013076        GO TO 7499-EXIT.
013077
013078**2627**
013079
013080     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
013081        MOVE AL-UNBON            TO BAGEA
013082        MOVE -1                  TO BAGEL
013083        MOVE  1                  TO SET-CURSOR-SW
013084        GO TO 7499-EXIT.
013085
013086**2628**
013087
013088     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
013089        MOVE AL-UNBON            TO BAGEA
013090        MOVE -1                  TO BAGEL
013091        MOVE  1                  TO SET-CURSOR-SW
013092        GO TO 7499-EXIT.
013093
013094**2629**
013095
013096     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
013097        MOVE AL-UABON            TO BSEXA
013098        MOVE -1                  TO BSEXL
013099        MOVE  1                  TO SET-CURSOR-SW
013100        GO TO 7499-EXIT.
013101
013102**2630**
013103
013104     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
013105        MOVE -1                  TO BTYPE1L
013106        MOVE  1                  TO SET-CURSOR-SW
013107        GO TO 7499-EXIT.
013108
013109**2631**
013110
013111     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
013112        MOVE -1                  TO BTYPE1L
013113        MOVE  1                  TO SET-CURSOR-SW
013114        GO TO 7499-EXIT.
013115
013116**2632**
013117
013118     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
013119        MOVE AL-UNBON            TO BBEN1A
013120        MOVE -1                  TO BBEN1L
013121        MOVE  1                  TO SET-CURSOR-SW
013122        GO TO 7499-EXIT.
013123
013124**2633**
013125
013126     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
013127        MOVE AL-UNBON            TO BPREM1A
013128        MOVE -1                  TO BPREM1L
013129        MOVE  1                  TO SET-CURSOR-SW
013130        GO TO 7499-EXIT.
013131
013132**2634**
013133
013134     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
013135        MOVE -1                  TO BTYPE2L
013136        MOVE  1                  TO SET-CURSOR-SW
013137        GO TO 7499-EXIT.
013138
013139**2635**
013140
013141     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
013142        MOVE AL-UNBON            TO BBEN2A
013143        MOVE -1                  TO BBEN2L
013144        MOVE  1                  TO SET-CURSOR-SW
013145        GO TO 7499-EXIT.
013146
013147**2636**
013148
013149     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
013150        MOVE AL-UNBON            TO BPREM2A
013151        MOVE -1                  TO BPREM2L
013152        MOVE  1                  TO SET-CURSOR-SW
013153        GO TO 7499-EXIT.
013154
013155**2639**
013156
013157     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
013158        MOVE AL-UNBON            TO BBEN1A
013159        MOVE -1                  TO BBEN1L
013160        MOVE  1                  TO SET-CURSOR-SW
013161        GO TO 7499-EXIT.
013162
013163**2640**
013164
013165     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
013166        MOVE AL-UNBON            TO BBEN2A
013167        MOVE -1                  TO BBEN2L
013168        MOVE  1                  TO SET-CURSOR-SW
013169        GO TO 7499-EXIT.
013170
013171**2647**
013172
013173     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
013174        MOVE AL-UNBON            TO BTERM1A
013175        MOVE -1                  TO BTERM1L
013176        MOVE  1                  TO SET-CURSOR-SW
013177        GO TO 7499-EXIT.
013178
013179**2648**
013180
013181     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
013182              or er-3070
013183        MOVE AL-UNBON            TO BLNTRMA
013184        MOVE -1                  TO BLNTRML
013185        MOVE  1                  TO SET-CURSOR-SW
013186        GO TO 7499-EXIT.
013187
013188**2649**
013189
013190     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
013191        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
013192            MOVE AL-UNBON            TO BPREM1A
013193            MOVE -1                  TO BPREM1L
013194            MOVE  1                  TO SET-CURSOR-SW
013195            GO TO 7499-EXIT
013196     ELSE
013197        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
013198           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
013199            MOVE AL-UNBON            TO BPREM2A
013200            MOVE -1                  TO BPREM2L
013201            MOVE  1                  TO SET-CURSOR-SW
013202            GO TO 7499-EXIT.
013203
013204**2650**
013205
013206     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
013207        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
013208            MOVE AL-UNBON        TO BPREM1A
013209            MOVE -1              TO BPREM1L
013210            MOVE  1              TO SET-CURSOR-SW
013211            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
013212                MOVE AL-UNBON        TO BPREM2A
013213                MOVE -1              TO BPREM2L
013214                MOVE  1              TO SET-CURSOR-SW
013215                GO TO 7499-EXIT
013216            ELSE
013217                GO TO 7499-EXIT
013218        ELSE
013219            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
013220                MOVE AL-UNBON        TO BPREM2A
013221                MOVE -1              TO BPREM2L
013222                MOVE  1              TO SET-CURSOR-SW
013223                GO TO 7499-EXIT
013224            ELSE
013225                GO TO 7499-EXIT.
013226
013227**2651**
013228
013229     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2651
013230        MOVE AL-UABON            TO BSIGA
013231        MOVE -1                  TO BSIGL
013232        MOVE  1                  TO SET-CURSOR-SW
013233        GO TO 7499-EXIT.
013234
013235**2653**
013236
013237     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
013238        MOVE AL-UABON            TO BFREQA
013239        MOVE -1                  TO BFREQL
013240        MOVE  1                  TO SET-CURSOR-SW
013241        GO TO 7499-EXIT.
013242
013243**2654**
013244
013245     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
013246        MOVE AL-UABON            TO BFREQA
013247        MOVE -1                  TO BFREQL
013248        MOVE  1                  TO SET-CURSOR-SW
013249        GO TO 7499-EXIT.
013250
013251**2655**
013252
013253     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
013254        MOVE AL-UABON            TO BFREQA
013255        MOVE -1                  TO BFREQL
013256        MOVE  1                  TO SET-CURSOR-SW
013257        GO TO 7499-EXIT.
013258
013259**2656**
013260
013261     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
013262        MOVE AL-UNBON            TO BAPRA
013263        MOVE -1                  TO BAPRL
013264        MOVE  1                  TO SET-CURSOR-SW
013265        GO TO 7499-EXIT.
013266
013267**2657**
013268
013269     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
013270        MOVE AL-UNBON            TO BAPRA
013271        MOVE -1                  TO BAPRL
013272        MOVE  1                  TO SET-CURSOR-SW
013273        GO TO 7499-EXIT.
013274
013275**2658**
013276
013277     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
013278        MOVE AL-UNBON            TO BTERM2A
013279        MOVE -1                  TO BTERM2L
013280        MOVE  1                  TO SET-CURSOR-SW
013281        GO TO 7499-EXIT.
013282
013283**2660**
013284
013285     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
013286        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
013287        MOVE -1                  TO BLSTNML
013288        MOVE  1                  TO SET-CURSOR-SW
013289        GO TO 7499-EXIT.
013290
013291
013292**2662**
013293
013294     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
013295        MOVE AL-UNBON            TO BAGEA
013296        MOVE -1                  TO BAGEL
013297        MOVE  1                  TO SET-CURSOR-SW
013298        GO TO 7499-EXIT.
013299
013300**2663**
013301
013302     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
013303        MOVE AL-UNBON            TO BAGEA
013304        MOVE -1                  TO BAGEL
013305        MOVE  1                  TO SET-CURSOR-SW
013306        GO TO 7499-EXIT.
013307
013308**2664**
013309
013310     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
013311        MOVE AL-UABON            TO BREINA
013312        MOVE -1                  TO BREINL
013313        MOVE  1                  TO SET-CURSOR-SW
013314        GO TO 7499-EXIT.
013315
013316**2667**
013317
013318     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
013319        MOVE AL-UNBON            TO BBEN2A
013320        MOVE -1                  TO BBEN2L
013321        MOVE  1                  TO SET-CURSOR-SW
013322        GO TO 7499-EXIT.
013323
013324**2668**
013325
013326     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
013327        MOVE AL-UABON            TO BEFFDTA
013328        GO TO 7499-EXIT.
013329
013330**2669**
013331
013332     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
013333       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
013334       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
013335        MOVE AL-UNBON            TO BAGEA
013336        MOVE -1                  TO BAGEL
013337        MOVE  1                  TO SET-CURSOR-SW
013338        GO TO 7499-EXIT.
013339
013340**2670**
013341
013342     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
013343        MOVE AL-UABON            TO BFORCEA
013344        MOVE -1                  TO BFORCEL
013345        MOVE  1                  TO SET-CURSOR-SW
013346        GO TO 7499-EXIT.
013347
013348**2671**
013349
013350     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
013351        MOVE AL-UABON            TO BEFFDTA
013352        GO TO 7499-EXIT.
013353
013354**2672**
013355
013356     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
013357        MOVE AL-UABON            TO BEFFDTA
013358        GO TO 7499-EXIT.
013359
013360**2673**
013361
013362     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
013363        MOVE AL-UABON            TO BEFFDTA
013364        GO TO 7499-EXIT.
013365
013366**2674**
013367
013368     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
013369        MOVE AL-UABON            TO BTYPE1A BTYPE2A
013370        MOVE -1                  TO BTYPE1L
013371        MOVE  1                  TO SET-CURSOR-SW
013372        GO TO 7499-EXIT.
013373
013374**2677**
013375
013376     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
013377        MOVE AL-UNBON            TO BTERM1A
013378        MOVE -1                  TO BTERM1L
013379        MOVE  1                  TO SET-CURSOR-SW
013380        GO TO 7499-EXIT.
013381
013382**2678**
013383
013384     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
013385        MOVE AL-UNBON            TO BTERM2A
013386        MOVE -1                  TO BTERM2L
013387        MOVE  1                  TO SET-CURSOR-SW
013388        GO TO 7499-EXIT.
013389
013390**2679**
013391
013392     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
013393        MOVE AL-UABON            TO BTYPE1A
013394        MOVE -1                  TO BTYPE1L
013395        MOVE  1                  TO SET-CURSOR-SW
013396        GO TO 7499-EXIT.
013397
013398**2680**
013399
013400     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
013401        MOVE AL-UABOF            TO B1STPMTA
013402        MOVE -1                  TO B1STPMTL
013403        MOVE  1                  TO SET-CURSOR-SW
013404        GO TO 7499-EXIT.
013405
013406**2681**
013407
013408     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
013409        MOVE AL-UABON            TO BDAYSA
013410        MOVE -1                  TO BDAYSL
013411        MOVE  1                  TO SET-CURSOR-SW
013412        GO TO 7499-EXIT.
013413
013414**2682**
013415
013416     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
013417        MOVE AL-UABON            TO BTERM1A
013418        MOVE -1                  TO BTERM1L
013419        MOVE  1                  TO SET-CURSOR-SW
013420        GO TO 7499-EXIT.
013421
013422**2683**
013423
013424     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
013425        MOVE AL-UABON            TO BSKPCDA
013426        MOVE -1                  TO BSKPCDL
013427        MOVE  1                  TO SET-CURSOR-SW
013428        GO TO 7499-EXIT.
013429
013430**2684**
013431
013432     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
013433        MOVE AL-UABON            TO BTYPE2A
013434        MOVE -1                  TO BTYPE2L
013435        MOVE  1                  TO SET-CURSOR-SW
013436        GO TO 7499-EXIT.
013437
013438**2686**
013439
013440     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
013441        MOVE AL-UABON            TO BTYPE2A
013442        MOVE -1                  TO BTYPE2L
013443        MOVE  1                  TO SET-CURSOR-SW
013444        GO TO 7499-EXIT.
013445
013446**2689**
013447
013448     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
013449        MOVE AL-UABON            TO BSIGA
013450        MOVE -1                  TO BSIGL
013451        MOVE  1                  TO SET-CURSOR-SW
013452        GO TO 7499-EXIT.
013453
013454**2690**
013455
013456     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
013457        MOVE AL-UABOF            TO BLNOFCRA
013458        MOVE -1                  TO BLNOFCRL
013459        MOVE  1                  TO SET-CURSOR-SW
013460        GO TO 7499-EXIT.
013461
013462**2693**
013463
013464     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
013465        MOVE AL-UABOF            TO BLNOFCRA
013466        MOVE AL-UNBON            TO BBEN1A
013467        MOVE -1                  TO BBEN1L
013468        MOVE  1                  TO SET-CURSOR-SW
013469        GO TO 7499-EXIT.
013470
013471**2720**
013472
013473     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
013474        MOVE AL-UNBON            TO BBEN1A
013475        MOVE -1                  TO BBEN1L
013476        MOVE  1                  TO SET-CURSOR-SW
013477        GO TO 7499-EXIT.
013478
013479**2709**
013480
013481*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
013482*       MOVE AL-UNBON            TO BBEN1A
013483*       MOVE -1                  TO BBEN1L
013484*       MOVE  1                  TO SET-CURSOR-SW
013485*       GO TO 7499-EXIT.
013486
013487*************************************************************
013488*                                                           *
013489*            C A N C E L   E R R O R S                      *
013490*                                                           *
013491*************************************************************
013492
013493**2726**
013494
013495     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
013496        MOVE AL-UABON            TO CCERTNOA
013497        GO TO 7499-EXIT.
013498
013499**2728**
013500
013501     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
013502        MOVE AL-UABON            TO CCERTNOA
013503        GO TO 7499-EXIT.
013504
013505**2729**
013506
013507     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
013508        MOVE AL-UABON            TO CCERTNOA
013509        GO TO 7499-EXIT.
013510
013511**2730**
013512
013513     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
013514        MOVE AL-UABON            TO CCERTNOA
013515        GO TO 7499-EXIT.
013516
013517**2731**
013518
013519     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
013520        MOVE AL-UABON            TO CCANDT1A
013521        MOVE -1                  TO CCANDT1L
013522        MOVE  1                  TO SET-CURSOR-SW
013523        GO TO 7499-EXIT.
013524
013525**2732**
013526
013527     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
013528        MOVE AL-UABON            TO CCANDT1A
013529        MOVE -1                  TO CCANDT1L
013530        MOVE  1                  TO SET-CURSOR-SW
013531        GO TO 7499-EXIT.
013532
013533**2733**
013534
013535     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
013536        MOVE AL-UABON            TO CCANDT1A
013537        MOVE -1                  TO CCANDT1L
013538        MOVE  1                  TO SET-CURSOR-SW
013539        GO TO 7499-EXIT.
013540
013541**2734**
013542
013543     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
013544        MOVE AL-UNBON            TO CREFND1A
013545        MOVE -1                  TO CREFND1L
013546        MOVE  1                  TO SET-CURSOR-SW
013547        GO TO 7499-EXIT.
013548
013549**2735**
013550
013551     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
013552        MOVE AL-UABON            TO CCANDT2A
013553        MOVE -1                  TO CCANDT2L
013554        MOVE  1                  TO SET-CURSOR-SW
013555        GO TO 7499-EXIT.
013556
013557**2736**
013558
013559     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
013560        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
013561            MOVE AL-UNBON        TO CREFND1A
013562            MOVE -1              TO CREFND1L
013563            MOVE  1              TO SET-CURSOR-SW
013564            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
013565                MOVE AL-UNBON        TO CREFND2A
013566                MOVE -1              TO CREFND2L
013567                MOVE  1              TO SET-CURSOR-SW
013568                GO TO 7499-EXIT
013569            ELSE
013570                GO TO 7499-EXIT
013571        ELSE
013572            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
013573                MOVE AL-UNBON        TO CREFND2A
013574                MOVE -1              TO CREFND2L
013575                MOVE  1              TO SET-CURSOR-SW
013576                GO TO 7499-EXIT
013577            ELSE
013578                GO TO 7499-EXIT.
013579
013580**2738**
013581
013582     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
013583        MOVE -1                  TO CREFND2L
013584        MOVE  1                  TO SET-CURSOR-SW
013585        GO TO 7499-EXIT.
013586
013587**2739**
013588
013589     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
013590        MOVE -1                  TO CREFND1L
013591        MOVE  1                  TO SET-CURSOR-SW
013592        GO TO 7499-EXIT.
013593
013594**2741**
013595
013596     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
013597        MOVE -1                  TO CREFND1L
013598        MOVE  1                  TO SET-CURSOR-SW
013599        GO TO 7499-EXIT.
013600
013601**2743**
013602
013603     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
013604        MOVE AL-UNBON            TO CCANDT1A
013605        MOVE -1                  TO CCANDT1L
013606        MOVE  1                  TO SET-CURSOR-SW
013607        GO TO 7499-EXIT.
013608
013609**2744**
013610
013611     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
013612        MOVE AL-UNBON            TO CCANDT2A
013613        MOVE -1                  TO CCANDT2L
013614        MOVE  1                  TO SET-CURSOR-SW
013615        GO TO 7499-EXIT.
013616
013617**2747**
013618
013619     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
013620        MOVE AL-UABON            TO CLSTNMA
013621        MOVE -1                  TO CLSTNML
013622        MOVE  1                  TO SET-CURSOR-SW
013623        GO TO 7499-EXIT.
013624
013625**2749**
013626
013627     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
013628        MOVE AL-UABON            TO CFORCEA
013629        MOVE -1                  TO CFORCEL
013630        MOVE  1                  TO SET-CURSOR-SW
013631        GO TO 7499-EXIT.
013632
013633**2753**
013634
013635     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
013636        MOVE AL-UNBON            TO CCANDT1A
013637        MOVE -1                  TO CCANDT1L
013638        MOVE  1                  TO SET-CURSOR-SW
013639        GO TO 7499-EXIT.
013640
013641**2755**
013642
013643     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
013644        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
013645            MOVE AL-UNBON        TO CREFND1A
013646            MOVE -1              TO CREFND1L
013647            MOVE  1              TO SET-CURSOR-SW
013648            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
013649                MOVE AL-UNBON        TO CREFND2A
013650                MOVE -1              TO CREFND2L
013651                MOVE  1              TO SET-CURSOR-SW
013652                GO TO 7499-EXIT
013653            ELSE
013654                GO TO 7499-EXIT
013655        ELSE
013656            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
013657                MOVE AL-UNBON        TO CREFND2A
013658                MOVE -1              TO CREFND2L
013659                MOVE  1              TO SET-CURSOR-SW
013660            ELSE
013661                GO TO 7499-EXIT.
013662
013663**2757**
013664
013665     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
013666        MOVE AL-UNBON            TO CLIVESA
013667        MOVE -1                  TO CLIVESL
013668        MOVE  1                  TO SET-CURSOR-SW
013669        GO TO 7499-EXIT.
013670
013671**2771**
013672
013673     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
013674        MOVE AL-UABON            TO CCANDT2A
013675        MOVE -1                  TO CCANDT2L
013676        MOVE  1                  TO SET-CURSOR-SW
013677        GO TO 7499-EXIT.
013678
013679**2774**
013680
013681     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
013682        MOVE AL-UABON            TO CCANDT1A
013683        MOVE -1                  TO CCANDT1L
013684        MOVE  1                  TO SET-CURSOR-SW
013685        GO TO 7499-EXIT.
013686
013687**2775**
013688
013689     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
013690        MOVE AL-UABON            TO CCANDT2A
013691        MOVE -1                  TO CCANDT2L
013692        MOVE  1                  TO SET-CURSOR-SW
013693        GO TO 7499-EXIT.
013694
013695**2776**
013696
013697     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
013698        MOVE AL-UABON            TO CCANDT1A
013699        MOVE -1                  TO CCANDT1L
013700        MOVE  1                  TO SET-CURSOR-SW
013701        GO TO 7499-EXIT.
013702
013703
013704**2777**
013705
013706     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
013707        MOVE AL-UABON            TO CCANDT2A
013708        MOVE -1                  TO CCANDT2L
013709        MOVE  1                  TO SET-CURSOR-SW
013710        GO TO 7499-EXIT.
013711
013712**2794**
013713
013714     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
013715        MOVE AL-UABON            TO CFORCEA
013716        MOVE -1                  TO CFORCEL
013717        MOVE  1                  TO SET-CURSOR-SW
013718        GO TO 7499-EXIT.
013719
013720**2799**
013721
013722     IF PI-COMPANY-ID = 'UCL'
013723         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
013724             MOVE AL-UNBON            TO BEFFDTA
013725             MOVE -1                  TO BEFFDTL
013726             MOVE  1                  TO SET-CURSOR-SW
013727             GO TO 7499-EXIT.
013728
013729 7499-EXIT.
013730      EXIT.
013731
013732     EJECT
013733
013734 7500-READ-ERLOFC.
013735     MOVE SPACES                 TO  WS-LOAN-OFFICER
013736                                     ERLOFC-KEY.
013737
013738     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
013739
013740     IF ST-ACCNT-CNTL
013741         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
013742
013743     IF CARR-GROUP-ST-ACCNT-CNTL
013744         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
013745         MOVE PI-SV-STATE        TO  ERLOFC-STATE
013746         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
013747
013748     IF CARR-ST-ACCNT-CNTL
013749         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
013750         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
013751
013752     IF CARR-ACCNT-CNTL
013753         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
013754
013755     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
013756
013757     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
013758
013759     
      * EXEC CICS HANDLE CONDITION
013760*        NOTFND   (7550-OFFICER-NOTFND)
013761*    END-EXEC.
      *    MOVE '"$I                   ! V #00020980' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'5620233030303230393830' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
013762
013763     
      * EXEC CICS READ
013764*        DATASET   (FILE-ID-ERLOFC)
013765*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
013766*        RIDFLD    (ERLOFC-KEY)
013767*        EQUAL
013768*    END-EXEC.
      *    MOVE '&"S        E          (   #00020984' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303230393834' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERLOFC, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERLOFC-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF LOAN-OFFICER-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
013769
013770     GO TO 7599-EXIT.
013771
013772 7550-OFFICER-NOTFND.
013773     MOVE 'X'                    TO WS-LOAN-OFFICER.
013774
013775 7599-EXIT.
013776      EXIT.
013777     EJECT
013778******************************************************************
013779*                                                                *
013780*            S  E N D    I N I T I A L   M A P                   *
013781*                                                                *
013782******************************************************************
013783
013784 8100-SEND-INITIAL-MAP.
013785     MOVE EIBTIME                TO TIME-IN.
013786
013787     IF EIBAID = DFHPF11
013788        MOVE 'Y'                 TO EMI-ROLL-SWITCH
013789        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
013790
013791
013792     IF PI-COMPANY-ID = CLIENT-GIC
013793        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
013794                                       BCPREM-ATTRB (2).
013795
013796     IF PI-COMPANY-ID = (CLIENT-MIC OR
013797                         CLIENT-PEM OR
013798                         CLIENT-CSO)
013799        AND PI-DISPLAY-ORIGINAL-BATCH
013800          IF PI-MAP-NAME = EL631B
013801             MOVE AL-SADOF               TO BPF5HDRA
013802                                            BPF4HDRA
013803          ELSE
013804             IF PI-MAP-NAME = EL631C
013805                MOVE AL-SADOF            TO CPF5HDRA
013806                                            CPF4HDRA.
013807
013808     IF PI-MAP-NAME = EL631B
013809        MOVE AL-SADOF               TO BPF5HDRA
013810     ELSE
013811        MOVE AL-SADOF               TO CPF5HDRA
013812     END-IF
013813
013814*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
013815     IF PI-MAP-NAME = EL631B
013816          IF PI-COMPANY-ID NOT = 'DMD'
013817             MOVE AL-SANOF            TO BBILLEDA
013818             MOVE AL-SADOF            TO DMDBILA.
013819*DMD CUSTOM CODING*************END
013820
013821     IF PI-PROCESSOR-ID = 'LGXX'
013822        IF PI-MAP-NAME = EL631B
013823           MOVE AL-SABOF                    TO BREFHDGA
013824           MOVE AL-SANOF                    TO BREFA
013825        ELSE
013826           IF PI-MAP-NAME = EL631C
013827              MOVE AL-SABOF                 TO CREFHDGA
013828              MOVE AL-SANOF                 TO CREFA.
013829
013830     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
013831        continue
013832     ELSE
013833        IF PI-MAP-NAME = EL631C
013834           MOVE AL-SADOF         TO CCANTXTA
013835                                    CCANFEEA
013836        end-if
013837     end-if
013838
013839     IF PI-MAP-NAME = EL631D
013840        IF PI-AR-PROCESSING
013841           MOVE AL-SANOF            TO DREFHDGA
013842        ELSE
013843           MOVE AL-SADOF            TO DREFHDGA.
013844
013845     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
013846        AND (PI-MAP-NAME = EL631B)
013847        MOVE AL-SADOF            TO BVINHA
013848                                    BVINA
013849     END-IF
013850
013851     IF PI-MAP-NAME = EL631B
013852        MOVE PI-COMPANY-ID          TO BCOMPIDO
013853        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
013854                                 TO BREGIONO
013855        MOVE PI-PROCESSOR-ID     TO BUSERO
013856        IF CSR-EDIT-SESSION
013857           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
013858                                 TO BHEADO
013859           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
013860        ELSE
013861           MOVE AL-SADOF         TO BF15HDRA
013862           MOVE '4=B-HDR      '  TO BPF4HDRO
013863        END-IF
013864        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
013865        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
013866        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
013867        MOVE WS-CURRENT-DT          TO BDATEO
013868        MOVE TIME-OUT               TO BTIMEO
013869        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
013870        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
013871        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
013872        IF   WS-DISPLAY-SCREEN
013873             MOVE PB-ENTRY-BATCH    TO BBATCHO
013874             MOVE PB-SV-CARRIER     TO BCARRO
013875             MOVE PB-SV-GROUPING    TO BGROUPO
013876             MOVE PB-SV-STATE       TO BSTATEO
013877             MOVE PB-ACCOUNT        TO BACCTO
013878        ELSE
013879             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
013880     ELSE
013881        IF PI-MAP-NAME = EL631C
013882           MOVE '4=B-HDR      '     TO CPF4HDRO
013883           IF CSR-EDIT-SESSION
013884              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
013885                                 TO CHEADO
013886           ELSE
013887              MOVE AL-SADOF      TO CF15HDRA
013888           END-IF
013889           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
013890           MOVE WS-CURRENT-DT          TO CDATEO
013891           MOVE TIME-OUT               TO CTIMEO
013892           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
013893           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
013894           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
013895           MOVE WS-C-HDG               TO CLFHDGO
013896           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
013897           MOVE WS-C-HDG               TO CAHHDGO
013898           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
013899           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
013900           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
013901           IF   WS-DISPLAY-SCREEN
013902                MOVE PB-ENTRY-BATCH    TO CBATCHO
013903                MOVE PB-SV-CARRIER     TO CCARRO
013904                MOVE PB-SV-GROUPING    TO CGROUPO
013905                MOVE PB-SV-STATE       TO CSTATEO
013906                MOVE PB-ACCOUNT        TO CACCTO
013907           ELSE
013908                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
013909        ELSE
013910           MOVE WS-CURRENT-DT          TO DDATEO
013911           MOVE TIME-OUT               TO DTIMEO
013912           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
013913                                          WS-REFUND-HDG-OVERRIDE
013914           MOVE WS-D-PREM-HDG          TO DLFPHDGO
013915           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
013916           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
013917                                          WS-REFUND-HDG-OVERRIDE
013918           MOVE WS-D-PREM-HDG          TO DAHPHDGO
013919           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
013920           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
013921           IF CSR-EDIT-SESSION
013922              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
013923                                 TO DHEADO
013924           END-IF
013925           IF  WS-DISPLAY-SCREEN
013926               MOVE PB-ENTRY-BATCH     TO DBATCHO
013927               MOVE PB-CARRIER         TO DCARRO
013928               MOVE PB-GROUPING        TO DGROUPO
013929               MOVE PB-STATE           TO DSTATEO
013930               MOVE PB-ACCOUNT         TO DACCTO
013931               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
013932           ELSE
013933               MOVE EL631D             TO PI-MAP-NAME
013934               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
013935               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
013936
013937     MOVE SPACE                        TO WS-DISPLAY-SW.
013938
013939     
      * EXEC CICS SEND
013940*        MAP      (PI-MAP-NAME)
013941*        MAPSET   (MAPSET-EL6311S)
013942*        FROM     (EL631BI)
013943*        ERASE
013944*        CURSOR
013945*    END-EXEC.
           MOVE LENGTH OF
            EL631BI
             TO DFHEIV12
           MOVE -1
             TO DFHEIV11
      *    MOVE '8$     CT  E    H L F ,   #00021160' TO DFHEIV0
           MOVE X'382420202020204354202045' &
                X'2020202048204C2046202C20' &
                X'2020233030303231313630' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PI-MAP-NAME, 
                 EL631BI, 
                 DFHEIV12, 
                 MAPSET-EL6311S, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
013946
013947     GO TO 9100-RETURN-TRAN.
013948
013949     EJECT
013950
013951******************************************************************
013952*                                                                *
013953*              S E N D    D A T A O N L Y                        *
013954*                                                                *
013955******************************************************************
013956
013957 8200-SEND-DATAONLY.
013958     MOVE EIBTIME                TO TIME-IN.
013959
013960     IF PI-COMPANY-ID = CLIENT-GIC
013961        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
013962                                       BCPREM-ATTRB (2).
013963
013964     IF PI-MAP-NAME = EL631B
013965        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
013966        MOVE WS-CURRENT-DT          TO BDATEO
013967        MOVE TIME-OUT               TO BTIMEO
013968        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
013969        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
013970        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
013971        MOVE SPACES                 TO BPFENTRO
013972        MOVE AL-UANOF               TO BPFENTRA
013973
013974*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
013975        IF PI-COMPANY-ID NOT = 'DMD'
013976             MOVE AL-SANOF            TO BBILLEDA
013977             MOVE AL-SADOF            TO DMDBILA
013978         ELSE
013979            NEXT SENTENCE
013980*DMD CUSTOM CODING*************END
013981     ELSE
013982        IF PI-MAP-NAME = EL631C
013983           MOVE WS-CURRENT-DT          TO CDATEO
013984           MOVE TIME-OUT               TO CTIMEO
013985           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
013986           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
013987           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
013988           MOVE SPACES                 TO CPFENTRO
013989           MOVE AL-UANOF               TO CPFENTRA
013990        ELSE
013991           MOVE WS-CURRENT-DT          TO DDATEO
013992           MOVE TIME-OUT               TO DTIMEO
013993           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
013994
013995     
      * EXEC CICS SEND
013996*        MAP      (PI-MAP-NAME)
013997*        MAPSET   (MAPSET-EL6311S)
013998*        FROM     (EL631BI)
013999*        DATAONLY
014000*        CURSOR
014001*    END-EXEC.
           MOVE LENGTH OF
            EL631BI
             TO DFHEIV12
           MOVE -1
             TO DFHEIV11
      *    MOVE '8$D    CT       H L F ,   #00021216' TO DFHEIV0
           MOVE X'382444202020204354202020' &
                X'2020202048204C2046202C20' &
                X'2020233030303231323136' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PI-MAP-NAME, 
                 EL631BI, 
                 DFHEIV12, 
                 MAPSET-EL6311S, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
014002
014003     GO TO 9100-RETURN-TRAN.
014004
014005     EJECT
014006
014007******************************************************************
014008*                                                                *
014009*           U T I L I T Y   R O U T I N E S                      *
014010*                                                                *
014011******************************************************************
014012
014013 8300-SEND-TEXT.
014014     
      * EXEC CICS SEND TEXT
014015*        FROM     (LOGOFF-TEXT)
014016*        LENGTH   (LOGOFF-LENGTH)
014017*        ERASE
014018*        FREEKB
014019*    END-EXEC.
      *    MOVE '8&      T  E F  H   F -   #00021235' TO DFHEIV0
           MOVE X'382620202020202054202045' &
                X'204620204820202046202D20' &
                X'2020233030303231323335' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 LOGOFF-TEXT, 
                 LOGOFF-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
014020
014021     
      * EXEC CICS RETURN
014022*    END-EXEC.
      *    MOVE '.(                    ''   #00021242' TO DFHEIV0
           MOVE X'2E2820202020202020202020' &
                X'202020202020202020202720' &
                X'2020233030303231323432' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
014023
014024 8400-LOG-JOURNAL-RECORD.
014025
014026     if (pi-journal-file-id > 0)
014027        and (jp-file-id = file-id-erpndb)
014028        move eibdate             to jp-date
014029        move eibtime             to jp-time
014030*       move FILE-ID-ERPNDB      TO JP-FILE-ID
014031        MOVE PI-PROCESSOR-ID     TO JP-USER-ID
014032        MOVE 03                  TO PI-JOURNAL-FILE-ID
014033        if csr-edit-session
014034           move 'EL6311C'        to jp-program-id
014035        else
014036           MOVE THIS-PGM         TO JP-PROGRAM-ID
014037        end-if
014038
014039**      length is 585 plus 30 extra for jrnl stuff
014040**      system already accounts for the 34
014041
014042        
      * EXEC CICS JOURNAL
014043*          JFILEID   (PI-JOURNAL-FILE-ID)
014044*          JTYPEID   ('EL')
014045*          FROM      (JOURNAL-RECORD)
014046*          LENGTH    (615)
014047*          resp      (ws-response)
014048*       END-EXEC
           MOVE 'EL' TO DFHEIV7
           MOVE 615
             TO DFHEIV11
      *    MOVE '4"LF                  (  N#00021263' TO DFHEIV0
           MOVE X'34224C462020202020202020' &
                X'202020202020202020202820' &
                X'204E233030303231323633' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PI-JOURNAL-FILE-ID, 
                 DFHEIV7, 
                 JOURNAL-RECORD, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO ws-response
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
014049
014050        if resp-normal
014051           continue
014052        else
014053           display ' error-el6311-journal ' ws-response
014054        end-if
014055     end-if
014056
014057*    EXEC CICS JOURNAL
014058*        JFILEID     (PI-JOURNAL-FILE-ID)
014059*        JTYPEID     ('EL')
014060*        FROM        (JOURNAL-RECORD)
014061*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
014062*    END-EXEC.
014063
014064     .
014065 8400-exit.
014066     exit.
014067
014068 8600-DEEDIT.
014069     
      * EXEC CICS BIF DEEDIT
014070*         FIELD   (DEEDIT-FIELD)
014071*         LENGTH  (15)
014072*    END-EXEC.
           MOVE 15
             TO DFHEIV11
      *    MOVE '@"L                   #   #00021290' TO DFHEIV0
           MOVE X'40224C202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303231323930' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DEEDIT-FIELD, 
                 DFHEIV11
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
014073
014074 8800-UNAUTHORIZED-ACCESS.
014075     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
014076     GO TO 8300-SEND-TEXT.
014077
014078 8810-PF23.
014079     MOVE EIBAID                 TO PI-ENTRY-CD-1.
014080     MOVE XCTL-EL005             TO PGM-NAME.
014081     GO TO 9300-XCTL.
014082
014083 9000-CONNECT-TO-DB.
014084
014085     IF SVR > SPACES
014086        CONTINUE
014087     ELSE
014088*  The below is unnecessary but I'll play along
014089        MOVE 'PROD_LOGIC'           TO SVR
014090        MOVE 'appuser'              TO USR
014091        MOVE 'appuser@cso'          TO PASS
014092     END-IF
014093
014094     STRING
014095         USR DELIMITED SPACE
014096         "." DELIMITED SIZE
014097         PASS DELIMITED SPACE INTO USR-PASS
014098     END-STRING
014099
014101     EXEC SQL
              CONNECT TO :SVR USER :USR-PASS
014102     END-EXEC
014103
014104     IF SQLCODE NOT = 0
014105        DISPLAY "ERROR: CANNOT CONNECT "
014106        DISPLAY SQLCODE
014107        DISPLAY SQLERRMC
014108     END-IF
014109
014110     .
014111 9000-EXIT.
014112     EXIT.
014113 9050-DISCONNECT.
014114
014116     EXEC SQL
              DISCONNECT
014117     END-EXEC
014118     .
014119 9050-EXIT.
014120     EXIT.
014121
014122 9100-RETURN-TRAN.
014123     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
014124
014125     IF  PI-MAP-NAME =  EL631B
014126         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
014127
014128     IF  PI-MAP-NAME =  EL631C
014129         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
014130
014131     IF  PI-MAP-NAME =  EL631D
014132         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
014133
014134     
      * EXEC CICS RETURN
014135*        TRANSID    (TRANS-EXB1)
014136*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
014137*        LENGTH     (1300)
014138*    END-EXEC.
           MOVE 1300
             TO DFHEIV11
      *    MOVE '.(CT                  ''   #00021355' TO DFHEIV0
           MOVE X'2E2843542020202020202020' &
                X'202020202020202020202720' &
                X'2020233030303231333535' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 TRANS-EXB1, 
                 PROGRAM-INTERFACE-BLOCK, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
014139
014140 9200-RETURN-MAIN-MENU.
014141     MOVE XCTL-EL626             TO PGM-NAME.
014142     GO TO 9300-XCTL.
014143
014144 9300-XCTL.
014145     
      * EXEC CICS XCTL
014146*        PROGRAM    (PGM-NAME)
014147*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
014148*        LENGTH     (PI-COMM-LENGTH)
014149*    END-EXEC.
      *    MOVE '.$C                   %   #00021366' TO DFHEIV0
           MOVE X'2E2443202020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303231333636' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PGM-NAME, 
                 PROGRAM-INTERFACE-BLOCK, 
                 PI-COMM-LENGTH, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
014150
014151 9400-CLEAR.
014152     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
014153     GO TO 9300-XCTL.
014154
014155 9500-PF12.
014156     MOVE XCTL-EL010             TO PGM-NAME.
014157     GO TO 9300-XCTL.
014158
014159 9600-PGMID-ERROR.
014160     
      * EXEC CICS HANDLE CONDITION
014161*        PGMIDERR    (8300-SEND-TEXT)
014162*    END-EXEC.
      *    MOVE '"$L                   ! W #00021381' TO DFHEIV0
           MOVE X'22244C202020202020202020' &
                X'202020202020202020202120' &
                X'5720233030303231333831' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
014163
014164     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
014165     MOVE ' '                    TO PI-ENTRY-CD-1.
014166     MOVE XCTL-EL005             TO PGM-NAME.
014167     MOVE PGM-NAME               TO LOGOFF-PGM.
014168     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
014169     GO TO 9300-XCTL.
014170
014171 9700-DATE-LINK.
014172     MOVE LINK-ELDATCV           TO PGM-NAME.
014173     
      * EXEC CICS LINK
014174*        PROGRAM    (PGM-NAME)
014175*        COMMAREA   (DATE-CONVERSION-DATA)
014176*        LENGTH     (DC-COMM-LENGTH)
014177*    END-EXEC.
      *    MOVE '."C                   (   #00021394' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303231333934' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PGM-NAME, 
                 DATE-CONVERSION-DATA, 
                 DC-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
014178
014179 9800-LINK-PENDING-EDIT.
014180
014181     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
014182     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
014183
014184     MOVE LINK-EL050             TO PGM-NAME
014185     MOVE PENDING-BUSINESS       TO PASSED-RECORD
014186     MOVE ZEROS                  TO WK-CO-MAX-CAP
014187                                    WK-CO-TOL-CLAIM
014188                                    WK-CO-TOL-PREM
014189                                    WK-CO-TOL-REFUND
014190                                    WK-CO-TOL-PREM-PCT
014191                                    WK-CO-TOL-REFUND-PCT
014192                                    WK-REFUND-OVS-AMT
014193                                    WK-REFUND-OVS-PCT
014194                                    WK-ACCT-ADDR
014195                                    WK-LIFE-EDIT-ADDR
014196                                    WK-AH-EDIT-ADDR
014197                                    WK-LIFE-BEN-ADDR
014198                                    WK-AH-BEN-ADDR
014199                                    WK-STATE-ADDR
014200                                    WK-PLAN-ADDR
014201                                    WK-FORM-ADDR
014202     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
014203
014204     MOVE '6'                    TO WK-ENTRY-SW.
014205
014206     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
014207
014208     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
014209                                    EC-AM-EXPIRATION-DT
014210                                    EC-AM-EFFECTIVE-DT
014211                                    EC-CM-LF-CANCEL-DT
014212                                    EC-CM-AH-CANCEL-DT
014213                                    EC-CM-DEATH-DT.
014214
014215     MOVE ZEROS                  TO EC-CO-TOL-PREM
014216                                    EC-CO-TOL-REFUND
014217                                    EC-CO-MIN-AGE
014218                                    EC-CO-MIN-PREMIUM
014219                                    EC-CO-MIN-TERM
014220                                    EC-CO-MAX-TERM
014221                                    EC-ST-TOL-PREM
014222                                    EC-ST-TOL-REFUND
014223                                    EC-AM-LF-TOL-PREM
014224                                    EC-AM-AH-TOL-PREM
014225                                    EC-AM-LF-MAX-ATT-AGE
014226                                    EC-AM-LF-MAX-AGE
014227                                    EC-AM-LF-MAX-TERM
014228                                    EC-AM-LF-MAX-TOT-BEN
014229                                    EC-AM-AH-MAX-ATT-AGE
014230                                    EC-AM-AH-MAX-AGE
014231                                    EC-AM-AH-MAX-TERM
014232                                    EC-AM-AH-MAX-TOT-BEN
014233                                    EC-AM-AH-MAX-MON-BEN
014234                                    EC-RT-LF-MAX-ATT-AGE
014235                                    EC-RT-LF-MAX-AGE
014236                                    EC-RT-LF-MAX-TERM
014237                                    EC-RT-LF-MAX-TOT-BEN
014238                                    EC-RT-AH-MAX-ATT-AGE
014239                                    EC-RT-AH-MAX-AGE
014240                                    EC-RT-AH-MAX-TERM
014241                                    EC-RT-AH-MAX-TOT-BEN
014242                                    EC-RT-AH-MAX-MON-BEN
014243                                    EC-RT-AH-RATE
014244                                    EC-RT-LF-RATE
014245                                    EC-RT-LF-NSP-RATE
014246                                    EC-RT-AH-NSP-RATE
014247                                    EC-CM-LF-PRIOR-REFUND
014248                                    EC-CM-AH-PRIOR-REFUND.
014249
014250     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
014251                                    EC-ST-TOL-PREM-PCT
014252                                    EC-AM-LF-TOL-REFUND
014253                                    EC-AM-LF-DEV-PERCENT
014254                                    EC-CO-TOL-REFUND-PCT
014255                                    EC-ST-TOL-REFUND-PCT
014256                                    EC-AM-AH-TOL-REFUND
014257                                    EC-AM-AH-DEV-PERCENT.
014258
014259     
      * EXEC CICS LINK
014260*         PROGRAM   (PGM-NAME)
014261*         COMMAREA  (PASSED-RECORD)
014262*         LENGTH    (WS-EDIT-PASS-LENGTH)
014263*    END-EXEC.
      *    MOVE '."C                   (   #00021480' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303231343830' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PGM-NAME, 
                 PASSED-RECORD, 
                 WS-EDIT-PASS-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
014264
014265     MOVE '1'                    TO PI-EDIT-SW.
014266     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
014267
014268     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
014269
014270     IF PI-COMPANY-ID = 'UCL'
014271         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
014272
014273     IF VALID-PB-ID
014274        GO TO 9800-EXIT.
014275
014276     MOVE PENDING-BUSINESS       TO EMI-LINE1.
014277
014278     IF PI-MAP-NAME = EL631B
014279        MOVE -1                  TO BMAINTL
014280       ELSE
014281        MOVE -1                  TO CMAINTL.
014282
014283     GO TO 8200-SEND-DATAONLY.
014284
014285 9800-EXIT.
014286      EXIT.
014287
014288 9900-ERROR-FORMAT.
014289
014290     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
014291
014292     IF NOT EMI-ERRORS-COMPLETE
014293         MOVE LINK-EL001         TO PGM-NAME
014294         
      * EXEC CICS LINK
014295*            PROGRAM    (PGM-NAME)
014296*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
014297*            LENGTH     (EMI-COMM-LENGTH)
014298*        END-EXEC.
      *    MOVE '."C                   (   #00021515' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303231353135' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PGM-NAME, 
                 ERROR-MESSAGE-INTERFACE-BLOCK, 
                 EMI-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
014299
014300 9900-EXIT.
014301     EXIT.
014302
014303 9990-ABEND.
014304     MOVE LINK-EL004             TO PGM-NAME.
014305     MOVE DFHEIBLK               TO EMI-LINE1.
014306     
      * EXEC CICS LINK
014307*        PROGRAM   (PGM-NAME)
014308*        COMMAREA  (EMI-LINE1)
014309*        LENGTH    (72)
014310*    END-EXEC.
           MOVE 72
             TO DFHEIV11
      *    MOVE '."C                   (   #00021527' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303231353237' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PGM-NAME, 
                 EMI-LINE1, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
014311
014312     IF PI-MAP-NAME = EL631B
014313        MOVE -1                  TO BMAINTL
014314       ELSE
014315        MOVE -1                  TO CMAINTL.
014316
014317     IF EIBTRNID NOT = TRANS-EXB1
014318        GO TO 8100-SEND-INITIAL-MAP
014319       ELSE
014320        GO TO 8200-SEND-DATAONLY.
014321
014322 9995-SECURITY-VIOLATION.
014323*                            COPY ELCSCTP.
      *>>((file: ELCSCTP))
000001******************************************************************
000002*                                                                *
000003*                            ELCSCTP                             *
000004*                            VMOD=2.001                          *
000005*                                                                *
000006*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
000007******************************************************************
000008
000009
000010     MOVE EIBDATE          TO SM-JUL-DATE.
000011     MOVE EIBTRMID         TO SM-TERMID.
000012     MOVE THIS-PGM         TO SM-PGM.
000013     MOVE EIBTIME          TO TIME-IN.
000014     MOVE TIME-OUT         TO SM-TIME.
000015     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
000016
000017     
      * EXEC CICS LINK
000018*         PROGRAM  ('EL003')
000019*         COMMAREA (SECURITY-MESSAGE)
000020*         LENGTH   (80)
000021*    END-EXEC.
           MOVE 'EL003' TO DFHEIV1
           MOVE 80
             TO DFHEIV11
      *    MOVE '."C                   (   #00021562' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303231353632' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 SECURITY-MESSAGE, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000022
000023******************************************************************
000024
      *<<((file: ELCSCTP))

       9999-DFHBACK SECTION.
           MOVE '9%                    "   ' TO DFHEIV0
           MOVE 'EL6311' TO DFHEIV1
           CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
           GOBACK.
       9999-DFHEXIT.
           IF DFHEIGDJ EQUAL 0001
               NEXT SENTENCE
           ELSE IF DFHEIGDJ EQUAL 2
               GO TO 9600-PGMID-ERROR,
                     9990-ABEND,
                     9990-ABEND,
                     0010-MAIN-LOGIC
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 3
               GO TO 1280-BATCH-HDR-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 4
               GO TO 1290-DUPLICATE-ALT-INDEX
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 5
               GO TO 1295-CERT-TRL-REC-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 6
               GO TO 1380-BATCH-HDR-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 7
               GO TO 1385-REC-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 8
               GO TO 1386-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 9
               GO TO 1399-EXIT
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 10
               GO TO 1480-BATCH-HDR-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 11
               GO TO 1490-RECORD-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 12
               GO TO 1405-DELETE-CERTIFICATE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 13
               GO TO 1420-CONTINUE-DELETE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 14
               GO TO 1406-DELETE-ERNOTE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 15
               GO TO 1407-DELETE-MAILING
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 16
               GO TO 1420-CONTINUE-DELETE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 17
               GO TO 1480-BATCH-HDR-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 18
               GO TO 1475-DELETE-FINISHED
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 19
               GO TO 2280-BATCH-HDR-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 20
               GO TO 2290-DUPLICATE-ALT-INDEX
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 21
               GO TO 2380-BATCH-HDR-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 22
               GO TO 2385-REC-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 23
               GO TO 2380-BATCH-HDR-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 24
               GO TO 2485-BATCH-HDR-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 25
               GO TO 2490-RECORD-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 26
               GO TO 2475-CONTINUE-DELETE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 27
               GO TO 2485-BATCH-HDR-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 28
               GO TO 2480-DELETE-FINISHED
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 29
               GO TO 2920-PROCESS-REWRITE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 30
               GO TO 2985-RECORD-MISSING
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 31
               GO TO 2960-BUILD-NEW-CANCEL-RECORD
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 32
               GO TO 2990-DUPLICATE-RECORD
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 33
               GO TO 3590-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 34
               GO TO 3690-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 35
               GO TO 3990-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 36
               GO TO 4050-END-RECORDS,
                     4050-END-RECORDS
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 37
               GO TO 4150-END-BATCH
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 38
               GO TO 4150-END-BATCH
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 39
               GO TO 4250-END-RECORDS,
                     4250-END-RECORDS
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 40
               GO TO 4350-END-BATCH,
                     4350-END-BATCH
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 41
               GO TO 4570-NOT-FOUND,
                     4550-END-RECORDS
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 42
               GO TO 4680-NOT-FOUND,
                     4680-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 43
               GO TO 4860-NOT-FOUND,
                     4850-END-RECORDS
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 44
               GO TO 4970-NOT-FOUND,
                     4950-END-RECORDS
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 45
               GO TO 5050-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 46
               GO TO 5050-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 47
               GO TO 5050-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 48
               GO TO 5550-END-RECORDS,
                     5550-END-RECORDS
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 49
               GO TO 6050-QID-ERROR
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 50
               GO TO 6050-QID-ERROR
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 51
               GO TO 6400-CONTINUE,
                     6400-CONTINUE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 52
               GO TO 3690-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 53
               GO TO 7399-EXIT
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 54
               GO TO 7550-OFFICER-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 55
               GO TO 8300-SEND-TEXT
               DEPENDING ON DFHEIGDI.
           MOVE '9%                    "   ' TO DFHEIV0
           MOVE 'EL6311' TO DFHEIV1
           CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
           GOBACK.
