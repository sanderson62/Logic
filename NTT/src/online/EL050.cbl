      *((program: EL050.cl2))
000001 IDENTIFICATION DIVISION.
000002
000003 PROGRAM-ID. EL050 .
000004*              PROGRAM CONVERTED BY
000005*              COBOL CONVERSION AID PO 5785-ABJ
000006*              CONVERSION DATE 06/07/94 08:48:38.
000007*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
000008*                            VMOD=2.032.
000009*
000010
000011*AUTHOR.     LOGIC, INC.
000012*            DALLAS, TEXAS.
000013
000014*REMARKS.
000015*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
000016*            ON-LINE CREDIT SYSTEM.
000017*
000018******************************************************************
000019*                   C H A N G E   L O G
000020*
000021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000022*-----------------------------------------------------------------
000023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000024* EFFECTIVE    NUMBER
000025*-----------------------------------------------------------------
000026* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
000027* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
000028*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
000029* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
000030*                                IS OPEN OR CNC DT < PD THRU
000031* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
000032* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
000033* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
000034* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
000035* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
000036* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
000037* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
000038* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
000039* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
000040* 061412  CR2011022800001  AJRA  NAPERSOFT
000041* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
000042* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
000043* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
000044* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
000045* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
000046* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
000047* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
000048* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
000049* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
000050* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
000051* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
000052*                                CERT #, ADD 2898 FORCIBLE ERROR
000053* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
000054* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
000055* 013017  CR2016053100001  PEMA  ACH PROCESSING
000056* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
000057* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
000058* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
000059* 092618  CR2018050200001  PEMA  Add check for open clm on issue
000060* 101019  CR2019100700001  PEMA  Disallow V status with claim
000061* 022122  CR2021100800003  PEMA  Add B and H claim types
000062******************************************************************
000063 ENVIRONMENT DIVISION.
000064
000065 DATA DIVISION.
000066     EJECT
000067 WORKING-STORAGE SECTION.
       01  DFH-START PIC X(04).
000068
000069 77  FILLER   PIC X(32) VALUE '********************************'.
000070 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
000071 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
000072
000073 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
000074 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
000075                                   USAGE POINTER.
000076 77  FILLER                        PIC S9(8)   COMP VALUE +0.
000077 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
000078 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
000079                                   USAGE IS POINTER.
000080 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
000081 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
000082                                   USAGE IS POINTER.
000083 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
000084 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
000085                                   USAGE IS POINTER.
000086
000087 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
000088 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
000089                                   USAGE IS POINTER.
000090
000091*    COPY ELC50WS.
      *>>((file: ELC50WS))
000001*****************************************************************
000002*                                                               *
000003*                            ELC50WS.                           *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000005*                            VMOD=2.061.                        *
000006*                                                               *
000007*   THIS IS THE WORKING STORAGE FOR EL050                       *
000008*                                   EL517                       *
000009*****************************************************************
000010******************************************************************
000011*                   C H A N G E   L O G
000012*
000013* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000014*-----------------------------------------------------------------
000015*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000016* EFFECTIVE    NUMBER
000017*-----------------------------------------------------------------
000018* 123102                   PEMA  ADD DCC PROCESSING
000019* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
000020* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
000021* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
000022* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
000023* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
000024* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
000025* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
000026* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
000027* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
000028* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
000029* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
000030* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
000031* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
000032* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
000033* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
000034* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
000035* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
000036* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
000037* 030309  CR2009021700001  PEMA  ADD ER-2883
000038* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
000039* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
000040* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
000041* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
000042* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
000043* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
000044* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
000045* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
000046* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
000047* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
000048* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
000049* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
000050* 061412  CR2011022800001  AJRA  NAPERSOFT
000051* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
000052* 012213  CR2013011600001  PEMA  ADD ERROR 3058
000053* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
000054* 101314  IR2013100100002  PEMA  ADD ERROR 1572
000055* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
000056* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
000057* 040914  IR2014040900001  AJRA  ADD ERROR 2896
000058* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
000059* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
000060* 091114  IR2014091000001  TANA  ADD ERROR 2898
000061* 121815  CR2015121700006  PEMA  ADD ERROR 3827
000062* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
000063* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
000064* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
000065* 100617  CR2017062000003  PEMA  Inforce state comm cap
000066* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
000067* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
000068* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
000069* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
000070* 100518  CR2017061500001  TANA  ADD NEW ERROR MSGS
000071* 092618  CR2018050200001  PEMA  Add check for open clm on issue
000072* 101019  CR2019100700001  PEMA  Add error 3281 V stat on claim
000073* 011020  IR2019121100004  PEMA  Add error 3069 name&age equal
000074* 012220  CR2018092700002  TANA  ADD NEW ERROR MSGS
000075* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM ERROR MSG.
000076* 030920  IR2020030500001  PEMA  ADD ERROR 3071
000077*-----------------------------------------------------------------
000078
000079 01  WORK-AREAS.
000080
000081*****************************************************************
000082*        WORKING STORAGE AREA FOR CLIENT-MON                    *
000083*****************************************************************
000084
000085     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
000086     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
000087     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
000088     12  WS-NAME-EDIT-WORK-AREA.
000089         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
000090         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
000091             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
000092         16  WS-WORK-NAME.
000093             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
000094             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
000095             20  FILLER           PIC X(10)     VALUE SPACES.
000096         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
000097             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
000098
000099*****************************************************************
000100*        END OF WORKING STORAGE FOR CLIENT-MON                  *
000101*****************************************************************
000102
000103     12  WS-ERRESC-KEY.
000104         16 WS-ERRESC-SEARCH-KEY.
000105             20  WS-ERRESC-COMPANY-CD PIC  X.
000106             20  WS-ERRESC-CARRIER    PIC  X.
000107             20  WS-ERRESC-GROUP      PIC X(6).
000108             20  WS-ERRESC-STATE      PIC XX.
000109             20  WS-ERRESC-ACCOUNT    PIC X(10).
000110         16 WS-ERRESC-RESIDUAL-KEY.
000111             20  WS-ERRESC-AGENT      PIC X(10).
000112             20  WS-ERRESC-RES-STATE  PIC XX.
000113             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
000114*                                          YYYYMMDD
000115     12  WS-COMMISSION                PIC SV9(5) COMP-3.
000116     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
000117
000118*RESIDENT STATE TAX MASTER(ERRESS)
000119*
000120     12  WS-ERRESS-KEY.
000121         16  WS-ERRESS-COMPANY-CD      PIC  X.
000122         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
000123         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
000124         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
000125*                                          YYYYMMDD
000126
000127     12  WS-CONTRACT-DATE              PIC 9(8).
000128*                                          YYYYMMDD
000129     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
000130     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
000131         16 WS-YEAR-YY                 PIC   9999.
000132         16 FILLER                     PIC 9(4).
000133*                                          YYYYMMDD
000134     12  WS-SAVE-ERRESS-KEY            PIC X(9).
000135     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
000136     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
000137     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
000138
000139     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
000140         88  DPRB-1ST-TIME                      VALUE ' '.
000141
000142*****************************************************************
000143*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
000144*****************************************************************
000145
000146     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
000147     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
000148     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
000149     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
000150     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
000151     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
000152     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.
000153     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
000154     12  ws-st-agent-sig-edit    pic x          value spaces.
000155     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
000156     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
000157     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
000158     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
000159         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
000160         88 NO-AH-COVERAGE           VALUE '  ' '00'.
000161     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
000162         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
000163         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
000164     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
000165
000166     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
000167     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
000168
000169     12  WS-R78-METHOD            PIC X         VALUE SPACES.
000170     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
000171     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
000172     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
000173     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
000174     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
000175     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
000176     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
000177     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
000178     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
000179     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
000180     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
000181     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
000182     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
000183     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
000184     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
000185     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
000186     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
000187     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
000188     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
000189     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
000190     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
000191     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
000192     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
000193     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
000194     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
000195     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
000196     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
000197     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
000198     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
000199     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
000200     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
000201     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
000202     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
000203     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
000204     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
000205     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
000206     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
000207     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
000208     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
000209     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
000210     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
000211     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
000212     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
000213     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
000214     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
000215     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
000216     12  WS-IG-OVRD               PIC X         VALUE SPACES.
000217     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
000218     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
000219     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
000220     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
000221     12  WS-2671-SW               PIC X         VALUE SPACE.
000222     12  WS-2672-SW               PIC X         VALUE SPACE.
000223     12  ws-9813-sw               pic x         value spaces.
000224     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
000225         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
000226     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
000227         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
000228     12  W-BROWSE-SW              PIC X         VALUE SPACE.
000229
000230     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
000231         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
000232         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
000233         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
000234         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
000235
000236     12  WS-CREDIT-EDIT-CONTROLS.
000237         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
000238         16  WS-MIN-AGE           PIC 99                VALUE  0.
000239         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
000240         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
000241         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
000242         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
000243
000244     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
000245     12  WS-AGE-FIELDS.
000246         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
000247         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
000248         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
000249         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
000250
000251     12  WS-SAVE-ALLOWABLE-BENEFIT.
000252         16  WS-SAVE-BENEFIT-CODE       PIC XX.
000253         16  WS-SAVE-BENEFIT-TYPE       PIC X.
000254         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
000255         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
000256         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
000257         16  FILLER                      PIC XX.
000258
000259     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
000260     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
000261     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
000262     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
000263     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
000264     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
000265     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
000266     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
000267     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
000268     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
000269
000270     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
000271     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
000272     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
000273     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
000274     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
000275     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
000276     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
000277     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
000278         88  WS-REDUCING              VALUE 'R'.
000279         88  WS-LEVEL                 VALUE 'L' 'P'.
000280     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
000281
000282     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
000283     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
000284     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
000285     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
000286     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
000287     12  ws-ah-max-bens           pic 99        value zeros.
000288     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
000289     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
000290     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
000291     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
000292
000293     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
000294     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
000295     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
000296     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
000297     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
000298     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
000299     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
000300     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
000301     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
000302     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
000303     12  WS-ACCT-SIG-SW.
000304         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
000305         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
000306     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
000307     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
000308     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
000309     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
000310     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
000311     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
000312     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
000313     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
000314     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
000315     12  WS-INITIALS.
000316         16  WS-INIT-1            PIC X         VALUE SPACES.
000317         16  WS-INIT-2            PIC X         VALUE SPACES.
000318
000319     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
000320     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
000321     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
000322     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
000323     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
000324*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
000325     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
000326     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
000327     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
000328     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
000329     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
000330     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
000331     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
000332     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
000333     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
000334     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
000335     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
000336     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
000337     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
000338     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
000339     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
000340     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
000341     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
000342     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
000343     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
000344     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
000345     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
000346     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
000347******** FLA
000348     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
000349     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
000350     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
000351     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
000352     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
000353********
000354     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
000355     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
000356     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
000357     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
000358     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
000359     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
000360     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
000361     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
000362     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
000363     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
000364
000365     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
000366         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
000367                                         '0' THRU '9'.
000368
000369     12  NUMBER-OF-MONTHS.
000370         16  SK-MO OCCURS 12 TIMES PIC X.
000371
000372     12  WS-WORK-DATE.
000373         16  WS-YEAR            PIC 99    VALUE 00.
000374         16  WS-MONTH           PIC 99    VALUE 00.
000375         16  WS-DAY             PIC 99    VALUE 00.
000376
000377     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
000378     12  WS-WORK-CRIT-DEV       REDEFINES
000379         WS-WORK-LF-CRIT-PER    PIC X(03).
000380
000381     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
000382     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
000383
000384     12  WS-WORK-DATE-FROM.
000385         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
000386         16  FILLER             PIC X  VALUE SPACE.
000387         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
000388         16  FILLER             PIC X         VALUE SPACE.
000389         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
000390
000391     12  WS-WORK-DATE-THRU.
000392         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
000393         16  FILLER             PIC X         VALUE SPACE.
000394         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
000395         16  FILLER             PIC X         VALUE SPACE.
000396         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
000397
000398     12  WS-LF-INPUT-CD.
000399         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
000400         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
000401
000402     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
000403     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
000404         16  WS-AH-INPUT-CD-1   PIC X.
000405         16  WS-AH-INPUT-CD-2-3 PIC XX.
000406
000407     12  WS-SWITCHES.
000408         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
000409         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
000410             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
000411         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
000412             88  BANK-ACCT-FOUND          VALUE 'Y'.
000413         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
000414             88  AGENT-MASTER-FOUND       VALUE 'Y'.
000415         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
000416             88  BXRF-MASTER-FOUND        VALUE 'Y'.
000417         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
000418             88  COMP-MASTER-FOUND        VALUE 'Y'.
000419         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
000420             88  LOFC-MASTER-FOUND        VALUE 'Y'.
000421         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
000422             88  PDEF-MASTER-FOUND        VALUE 'Y'.
000423         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
000424             88  STAT-MASTER-FOUND        VALUE 'Y'.
000425         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
000426             88  PLAN-MASTER-FOUND        VALUE 'Y'.
000427         16  ELCRTT-FOUND-SW          PIC X    VALUE SPACES.
000428             88  ELCRTT-FOUND             VALUE 'Y'.
000429         16  ELCRTT-UPDATE-SW         PIC X    VALUE SPACES.
000430             88  ELCRTT-UPDATE            VALUE 'Y'.
000431         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
000432             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
000433         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
000434             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
000435         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
000436             88  FORM-MASTER-FOUND        VALUE 'Y'.
000437         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
000438             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
000439         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
000440             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
000441         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
000442             88  PROCESS-FORM-EDITS       VALUE 'Y'.
000443         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
000444             88  NO-BENEFIT-FOUND         VALUE 'N'.
000445         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
000446             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
000447         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
000448             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
000449         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
000450             88  AH-BENEFIT-FOUND         VALUE ' '.
000451             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
000452         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
000453             88  LF-BENEFIT-FOUND         VALUE ' '.
000454             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
000455         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
000456             88  NO-STATE-RECORD          VALUE '1'.
000457         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
000458             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
000459         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
000460             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
000461         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
000462             88  CERT-WAS-FOUND           VALUE ' '.
000463             88  CERT-WAS-NOT-FOUND       VALUE '1'.
000464         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
000465             88  BROWSE-STARTED           VALUE 'Y'.
000466         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
000467             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
000468         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
000469             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
000470         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
000471             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
000472         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
000473             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
000474         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
000475             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
000476         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
000477             88  APP-CERT-USED            VALUE 'Y' 'A'.
000478         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
000479             88  CTBL-TABLE-FOUND         VALUE 'Y'.
000480             88  FIRST-TIME-THROUGH       VALUE '1'.
000481             88  CTBL-NOT-FOUND           VALUE '2'.
000482
000483         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
000484             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
000485
000486         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
000487             88  DLO-ERROR-FOUND          VALUE 'Y'.
000488
000489********FLA
000490     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
000491     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
000492********
000493     12  RC-SW-1                  PIC X           VALUE '0'.
000494     12  RC-SW-2                  PIC X           VALUE '0'.
000495     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
000496     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
000497     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
000498     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
000499     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
000500     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
000501     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
000502     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
000503     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
000504     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
000505     12  LIT-SPACES               PIC X           VALUE SPACES.
000506     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
000507     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
000508     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
000509     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
000510     12  erpndm-unlock-sw         pic x           value spaces.
000511         88  need-to-unlock-erpndm  value 'Y'.
000512     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
000513     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
000514     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
000515         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
000516         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
000517     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
000518         88  SKIP-ADDR-EDIT         VALUE 'Y'.
000519
000520 01  WS-EXTRA-PERIODS-BY-STATE.
000521     12  WS-INT-PERIODS          PIC 9.
000522     12  WS-EXTRA-PMTS           PIC 9.
000523 01  ws-net-only-state           pic x value 'N'.
000524 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
000525     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
000526     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
000527 01  WS-CRI-SSN-WORK-AREA.
000528     05  WS-CRI-SOC-SEC-NO.
000529         10  WS-SS-REPT-CD       PIC X(5).
000530         10  WS-SS-LAST-NAME     PIC X(5).
000531         10  WS-SS-INITIAL       PIC X.
000532
000533     05  WS-CRI-REPORT-CODE.
000534         10  FILLER              PIC X(5).
000535         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
000536
000537     05  WS-CRI-LAST-NAME.
000538         10  WS-CRI-NAME-MOVE    PIC X(5).
000539         10  FILLER              PIC X(10).
000540
000541 01  ws-state-commission-caps.
000542     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
000543     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
000544     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
000545     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
000546
000547     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
000548     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
000549     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
000550     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
000551
000552     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
000553     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
000554     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
000555     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
000556
000557     05  ws-st-cap-limit-to      pic x.
000558
000559     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
000560     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
000561     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
000562     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
000563
000564     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
000565     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
000566     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
000567     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
000568
000569     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
000570     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
000571     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
000572     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
000573
000574 01  WS-NUM-TABLE                PIC X(26)  VALUE
000575     '12345678012345070923456789'.
000576 01  FILLER REDEFINES WS-NUM-TABLE.
000577     05  WS-NUM OCCURS 26        PIC 9.
000578 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
000579 01  V1                          PIC S999 COMP-3.
000580 01  V2                          PIC S999 COMP-3.
000581 01  V3                          PIC S999 COMP-3.
000582 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
000583 01  FILLER REDEFINES WS-WORK-VIN.
000584     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
000585 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
000586 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
000587 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
000588 01  WS-HEX-WORK.
000589     05  FILLER                  PIC X  VALUE LOW-VALUES.
000590     05  WS-HEX-BYTE             PIC X.
000591 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
000592 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
000593
000594 01  WS-WORK-HIN-ROW-B.
000595     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
000596
000597 01  ws-benefit-cd-chg-sw      pic x value spaces.
000598     88  benefit-code-chg           value 'Y'.
000599 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
000600 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
000601     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
000602 01  WS-ROW-D-TABLE.
000603     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
000604
000605 01  WS-HIN-TABLE-B.
000606     05  F                       PIC XX VALUE 'A2'.
000607     05  F                       PIC XX VALUE 'B3'.
000608     05  F                       PIC XX VALUE 'C4'.
000609     05  F                       PIC XX VALUE 'D5'.
000610     05  F                       PIC XX VALUE 'E6'.
000611     05  F                       PIC XX VALUE 'F7'.
000612     05  F                       PIC XX VALUE 'G8'.
000613     05  F                       PIC XX VALUE 'H9'.
000614     05  F                       PIC XX VALUE 'I1'.
000615     05  F                       PIC XX VALUE 'J2'.
000616     05  F                       PIC XX VALUE 'K3'.
000617     05  F                       PIC XX VALUE 'L4'.
000618     05  F                       PIC XX VALUE 'M5'.
000619     05  F                       PIC XX VALUE 'N6'.
000620     05  F                       PIC XX VALUE 'O0'.
000621     05  F                       PIC XX VALUE 'P7'.
000622     05  F                       PIC XX VALUE 'Q0'.
000623     05  F                       PIC XX VALUE 'R8'.
000624     05  F                       PIC XX VALUE 'S9'.
000625     05  F                       PIC XX VALUE 'T2'.
000626     05  F                       PIC XX VALUE 'U3'.
000627     05  F                       PIC XX VALUE 'V4'.
000628     05  F                       PIC XX VALUE 'W5'.
000629     05  F                       PIC XX VALUE 'X6'.
000630     05  F                       PIC XX VALUE 'Y7'.
000631     05  F                       PIC XX VALUE 'Z8'.
000632 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
000633     05  WS-VAL-IN               PIC X.
000634     05  WS-VAL-OUT              PIC 9.
000635 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
000636 01  ws-greg-eff-date            pic x(10) value ' '.
000637 01  WS-COMPARE-BINARY-DATES.
000638     05  WS-971231                PIC XX VALUE X'92FF'.
000639     05  WS-931231                PIC XX VALUE X'8CFF'.
000640     05  WS-791231                PIC XX VALUE X'77FF'.
000641     05  WS-771001                PIC XX VALUE X'74A1'.
000642     05  WS-820301                PIC XX VALUE X'7B41'.
000643     05  WS-831031                PIC XX VALUE X'7DBF'.
000644     05  WS-831231                PIC XX VALUE X'7DFF'.
000645     05  WS-810831                PIC XX VALUE X'7A7F'.
000646     05  WS-830901                PIC XX VALUE X'7D81'.
000647
000648 01  FILE-ACCESS-IDS.
000649     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
000650     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
000651     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
000652     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
000653     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
000654     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
000655     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
000656     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
000657     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
000658     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
000659     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
000660     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
000661     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
000662     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
000663     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
000664     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
000665     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
000666
000667 01  DD-IU-SW                    PIC X   VALUE ' '.
000668     88  DD-IU-PRESENT                 VALUE 'Y'.
000669
000670 01  ACCESS-KEYS.
000671     12  ELMSTR-KEY.
000672         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
000673         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
000674     12  W-CLAIM-KEY.
000675         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
000676         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
000677
000678     12  ELCNTL-KEY.
000679         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
000680         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
000681         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
000682         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
000683
000684     12  ELCERT-KEY.
000685         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
000686         16  CERT-CARRIER         PIC X       VALUE SPACE.
000687         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
000688         16  CERT-STATE           PIC XX      VALUE SPACES.
000689         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
000690         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
000691         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
000692
000693     12  ELCERT2-KEY.
000694         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
000695         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
000696
000697     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
000698
000699     12  ELCERT-SAVE.
000700         16  FILLER                      PIC XX    VALUE SPACES.
000701
000702         16  WCS-CONTROL-PRIMARY.
000703             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
000704             20  WCS-CARRIER             PIC X     VALUE SPACE.
000705             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
000706             20  WCS-STATE               PIC XX    VALUE SPACES.
000707             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
000708             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
000709             20  WCS-CERT-NO.
000710                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
000711                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
000712
000713         16  CS-CONTROL-BY-NAME.
000714             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
000715             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
000716             20  CS-INSURED-INITIALS.
000717                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
000718                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
000719
000720         16  CS-CONTROL-BY-SSN.
000721             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
000722             20  CS-SOC-SEC-NO.
000723                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
000724                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
000725                 24  CS-SSN-LN3.
000726                     28 CS-INSURED-INITIALS-A2   PIC XX
000727                                     VALUE SPACES.
000728                     28 CS-PART-LAST-NAME-A2     PIC X
000729                                     VALUE SPACE.
000730
000731         16  CS-CONTROL-BY-CERT-NO.
000732             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
000733             20  CS-CERT-NO-A4           PIC X(11)
000734                                     VALUE SPACES.
000735
000736         16  CS-CONTROL-BY-MEMB.
000737             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
000738             20  CS-MEMBER-NO.
000739                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
000740                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
000741                 24  CS-MEMB-LN4.
000742                     28 CS-INSURED-INITIALS-A5   PIC XX
000743                                      VALUE SPACES.
000744                     28 CS-PART-LAST-NAME-A5     PIC XX
000745                                      VALUE SPACES.
000746
000747         16  FILLER              PIC X(360) VALUE SPACES.
000748
000749     12  ERACCT-KEY.
000750         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
000751         16  ACCT-CARRIER         PIC X     VALUE SPACES.
000752         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
000753         16  ACCT-STATE           PIC X(02) VALUE SPACES.
000754         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
000755         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
000756
000757     12  ERCOMP-KEY.
000758         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
000759         16  COMP-CARRIER         PIC X     VALUE SPACES.
000760         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
000761         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
000762         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
000763         16  COMP-TYPE            PIC X     VALUE SPACES.
000764
000765     12  ERLOFC-KEY.
000766         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
000767         16  LOFC-CARRIER         PIC X     VALUE SPACES.
000768         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
000769         16  LOFC-STATE           PIC XX    VALUE SPACES.
000770         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
000771         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
000772
000773     12  WS-ELCRTT-KEY.
000774         16  WS-ELCRTT-PRIMARY       PIC X(33).
000775         16  WS-ELCRTT-REC-TYPE      PIC X(1).
000776
000777     12  ERBXRF-KEY.
000778         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
000779         16  BXRF-CARRIER         PIC X     VALUE SPACES.
000780         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
000781         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
000782
000783     12  ERAGTC-KEY.
000784         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
000785         16  AGTC-CARRIER         PIC X     VALUE SPACES.
000786         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
000787         16  AGTC-BANK            PIC X(10) VALUE SPACES.
000788         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
000789         16  AGTC-TYPE            PIC X     VALUE SPACES.
000790
000791     12  ERPLAN-KEY.
000792         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
000793         16  PLAN-CARRIER         PIC X     VALUE SPACES.
000794         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
000795         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
000796         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
000797         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
000798         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
000799         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
000800
000801     12  ERFORM-KEY.
000802         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
000803         16  FORM-STATE           PIC X(2)  VALUE SPACES.
000804         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
000805         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
000806
000807     12  ERREIN-KEY.
000808         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
000809         16  REIN-TYPE            PIC X     VALUE SPACES.
000810         16  REIN-TABLE-CO.
000811             20  REIN-CODE-1      PIC X     VALUE SPACE.
000812             20  REIN-CODE-2      PIC X     VALUE SPACE.
000813             20  REIN-CODE-3      PIC X     VALUE SPACE.
000814         16  FILLER               PIC X(3)  VALUE SPACES.
000815
000816     12  ERCTBL-KEY.
000817         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
000818         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
000819         16  CTBL-CNTRL-2.
000820             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
000821             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
000822
000823     12  ELCRTO-KEY.
000824         16  ELCRTO-COMPANY-CD       PIC X.
000825         16  ELCRTO-CARRIER          PIC X.
000826         16  ELCRTO-GROUPING         PIC X(6).
000827         16  ELCRTO-STATE            PIC XX.
000828         16  ELCRTO-ACCOUNT          PIC X(10).
000829         16  ELCRTO-CERT-EFF-DT      PIC XX.
000830         16  ELCRTO-CERT-NO.
000831             20  ELCRTO-CERT-PRIME   PIC X(10).
000832             20  ELCRTO-CERT-SFX     PIC X.
000833         16  ELCRTO-RECORD-TYPE      PIC X.
000834         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
000835
000836
000837     12  WS-ACCESS.
000838         16  FILLER               PIC XX    VALUE SPACES.
000839         16  WS-BEN-CD            PIC XX    VALUE SPACES.
000840
000841     12  WS-CARR-ACCESS.
000842         16  FILLER               PIC X(3)  VALUE SPACES.
000843         16  WS-CARR              PIC X     VALUE SPACE.
000844*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
000845*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
000846     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
000847         88  WS-DMD-LF-RATING   VALUE 'Y'.
000848         88  WS-DMD-AH-RATING   VALUE 'Y'.
000849         88  WS-DMD-NO-RATING   VALUE 'N'.
000850
000851     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
000852         88  WS-LF-CASH            VALUE 'MJ' 'MS'
000853                                         'NJ' 'NL'
000854                                         'PJ' 'PL'
000855                                         'SJ' 'SL'.
000856     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
000857         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
000858                                         'NI' 'NJ' 'NL' 'NU'
000859                                         'PJ' 'PL' 'PI' 'PU'
000860                                         'SI' 'SJ' 'SL' 'SU'
000861                                         'MX' 'MY' 'MZ'.
000862
000863 01  ERPDEF-KEY-SAVE             PIC X(18).
000864 01  ERPDEF-KEY.
000865     12  ERPDEF-COMPANY-CD       PIC X.
000866     12  ERPDEF-STATE            PIC XX.
000867     12  ERPDEF-PROD-CD          PIC XXX.
000868     12  F                       PIC X(7).
000869     12  ERPDEF-BEN-TYPE         PIC X.
000870     12  ERPDEF-BEN-CODE         PIC XX.
000871     12  ERPDEF-EXP-DT           PIC XX.
000872
000873 01  ELSTAT-KEY-SAVE             PIC X(20).
000874 01  ELSTAT-KEY.
000875     12  ELSTAT-COMPANY-ID       PIC XXX.
000876     12  ELSTAT-CARRIER          PIC X.
000877     12  ELSTAT-GROUP            PIC X(6).
000878     12  ELSTAT-STATE            PIC XX.
000879     12  ELSTAT-EXP-DT           PIC 9(8).
000880
000881 01  WS-ERROR-VALUES.
000882     12  ER-1570                     PIC S9(4)   VALUE +1570.
000883     12  ER-1571                     PIC S9(4)   VALUE +1571.
000884     12  er-1572                     pic s9(4)   value +1572.
000885     12  er-1573                     pic s9(4)   value +1573.
000886     12  er-1574                     pic s9(4)   value +1574.
000887     12  ER-1575                     PIC S9(4)   VALUE +1575.
000888     12  er-1576                     pic s9(4)   value +1576.
000889     12  er-1577                     pic s9(4)   value +1577.
000890     12  er-1583                     pic s9(4)   value +1583.
000891     12  er-1584                     pic s9(4)   value +1584.
000892     12  er-1743                     pic s9(4)   value +1743.
000893     12  er-1744                     pic s9(4)   value +1744.
000894     12  er-1745                     pic s9(4)   value +1745.
000895     12  er-1746                     pic s9(4)   value +1746.
000896     12  er-1747                     pic s9(4)   value +1747.
000897     12  er-1748                     pic s9(4)   value +1748.
000898     12  er-1749                     pic s9(4)   value +1749.
000899     12  er-1750                     pic s9(4)   value +1750.
000900     12  er-1751                     pic s9(4)   value +1751.
000901     12  er-1752                     pic s9(4)   value +1752.
000902     12  er-1753                     pic s9(4)   value +1753.
000903     12  er-1754                     pic s9(4)   value +1754.
000904     12  er-1755                     pic s9(4)   value +1755.
000905     12  er-1756                     pic s9(4)   value +1756.
000906     12  er-1757                     pic s9(4)   value +1757.
000907     12  er-1758                     pic s9(4)   value +1758.
000908     12  er-1759                     pic s9(4)   value +1759.
000909     12  er-1760                     pic s9(4)   value +1760.
000910     12  er-1761                     pic s9(4)   value +1761.
000911     12  ER-1891                     PIC S9(4)   VALUE +1891.
000912     12  ER-1892                     PIC S9(4)   VALUE +1892.
000913     12  ER-1893                     PIC S9(4)   VALUE +1893.
000914     12  ER-1894                     PIC S9(4)   VALUE +1894.
000915     12  ER-1895                     PIC S9(4)   VALUE +1895.
000916     12  ER-1896                     PIC S9(4)   VALUE +1896.
000917     12  ER-1897                     PIC S9(4)   VALUE +1897.
000918     12  ER-1898                     PIC S9(4)   VALUE +1898.
000919     12  ER-1899                     PIC S9(4)   VALUE +1899.
000920     12  ER-1900                     PIC S9(4)   VALUE +1900.
000921     12  ER-1901                     PIC S9(4)   VALUE +1901.
000922     12  ER-1902                     PIC S9(4)   VALUE +1902.
000923     12  ER-1903                     PIC S9(4)   VALUE +1903.
000924     12  ER-1904                     PIC S9(4)   VALUE +1904.
000925     12  ER-1905                     PIC S9(4)   VALUE +1905.
000926     12  ER-1906                     PIC S9(4)   VALUE +1906.
000927     12  ER-1907                     PIC S9(4)   VALUE +1907.
000928     12  ER-1909                     PIC S9(4)   VALUE +1909.
000929     12  ER-1910                     PIC S9(4)   VALUE +1910.
000930     12  ER-1911                     PIC S9(4)   VALUE +1911.
000931     12  ER-1912                     PIC S9(4)   VALUE +1912.
000932     12  ER-1913                     PIC S9(4)   VALUE +1913.
000933     12  ER-1914                     PIC S9(4)   VALUE +1914.
000934     12  ER-1915                     PIC S9(4)   VALUE +1915.
000935     12  ER-1916                     PIC S9(4)   VALUE +1916.
000936     12  ER-1917                     PIC S9(4)   VALUE +1917.
000937     12  ER-1918                     PIC S9(4)   VALUE +1918.
000938     12  ER-1919                     PIC S9(4)   VALUE +1919.
000939     12  ER-1920                     PIC S9(4)   VALUE +1920.
000940     12  ER-1921                     PIC S9(4)   VALUE +1921.
000941     12  ER-1922                     PIC S9(4)   VALUE +1922.
000942     12  ER-1923                     PIC S9(4)   VALUE +1923.
000943     12  ER-1924                     PIC S9(4)   VALUE +1924.
000944     12  ER-1925                     PIC S9(4)   VALUE +1925.
000945     12  ER-1926                     PIC S9(4)   VALUE +1926.
000946     12  ER-1927                     PIC S9(4)   VALUE +1927.
000947     12  ER-1955                     PIC s9(4)   VALUE +1955.
000948     12  ER-1956                     PIC s9(4)   VALUE +1956.
000949     12  ER-1957                     PIC s9(4)   VALUE +1957.
000950     12  ER-1958                     PIC s9(4)   VALUE +1958.
000951     12  ER-1959                     PIC s9(4)   VALUE +1959.
000952     12  ER-1960                     PIC s9(4)   VALUE +1960.
000953     12  ER-1961                     PIC s9(4)   VALUE +1961.
000954     12  ER-1962                     PIC s9(4)   VALUE +1962.
000955     12  ER-1963                     PIC s9(4)   VALUE +1963.
000956     12  ER-2393                     PIC S9(4)   VALUE +2393.
000957     12  ER-2600                     PIC S9(4)   VALUE +2600.
000958     12  ER-2601                     PIC S9(4)   VALUE +2601.
000959     12  ER-2602                     PIC S9(4)   VALUE +2602.
000960     12  ER-2603                     PIC S9(4)   VALUE +2603.
000961     12  ER-2604                     PIC S9(4)   VALUE +2604.
000962     12  ER-2605                     PIC S9(4)   VALUE +2605.
000963     12  ER-2606                     PIC S9(4)   VALUE +2606.
000964     12  ER-2607                     PIC S9(4)   VALUE +2607.
000965     12  ER-2608                     PIC S9(4)   VALUE +2608.
000966     12  ER-2609                     PIC S9(4)   VALUE +2609.
000967     12  ER-2610                     PIC S9(4)   VALUE +2610.
000968     12  ER-2611                     PIC S9(4)   VALUE +2611.
000969     12  ER-2612                     PIC S9(4)   VALUE +2612.
000970     12  ER-2613                     PIC S9(4)   VALUE +2613.
000971     12  ER-2614                     PIC S9(4)   VALUE +2614.
000972     12  ER-2615                     PIC S9(4)   VALUE +2615.
000973     12  ER-2616                     PIC S9(4)   VALUE +2616.
000974     12  ER-2617                     PIC S9(4)   VALUE +2617.
000975     12  ER-2618                     PIC S9(4)   VALUE +2618.
000976     12  ER-2619                     PIC S9(4)   VALUE +2619.
000977     12  ER-2620                     PIC S9(4)   VALUE +2620.
000978     12  ER-2621                     PIC S9(4)   VALUE +2621.
000979     12  ER-2622                     PIC S9(4)   VALUE +2622.
000980     12  ER-2623                     PIC S9(4)   VALUE +2623.
000981     12  ER-2624                     PIC S9(4)   VALUE +2624.
000982     12  ER-2625                     PIC S9(4)   VALUE +2625.
000983     12  ER-2626                     PIC S9(4)   VALUE +2626.
000984     12  ER-2627                     PIC S9(4)   VALUE +2627.
000985     12  ER-2628                     PIC S9(4)   VALUE +2628.
000986     12  ER-2629                     PIC S9(4)   VALUE +2629.
000987     12  ER-2630                     PIC S9(4)   VALUE +2630.
000988     12  ER-2631                     PIC S9(4)   VALUE +2631.
000989     12  ER-2632                     PIC S9(4)   VALUE +2632.
000990     12  ER-2633                     PIC S9(4)   VALUE +2633.
000991     12  ER-2634                     PIC S9(4)   VALUE +2634.
000992     12  ER-2635                     PIC S9(4)   VALUE +2635.
000993     12  ER-2636                     PIC S9(4)   VALUE +2636.
000994     12  ER-2637                     PIC S9(4)   VALUE +2637.
000995     12  ER-2638                     PIC S9(4)   VALUE +2638.
000996     12  ER-2639                     PIC S9(4)   VALUE +2639.
000997     12  ER-2640                     PIC S9(4)   VALUE +2640.
000998     12  ER-2641                     PIC S9(4)   VALUE +2641.
000999     12  ER-2642                     PIC S9(4)   VALUE +2642.
001000     12  ER-2643                     PIC S9(4)   VALUE +2643.
001001     12  ER-2644                     PIC S9(4)   VALUE +2644.
001002     12  ER-2645                     PIC S9(4)   VALUE +2645.
001003     12  ER-2646                     PIC S9(4)   VALUE +2646.
001004     12  ER-2647                     PIC S9(4)   VALUE +2647.
001005     12  ER-2648                     PIC S9(4)   VALUE +2648.
001006     12  ER-2649                     PIC S9(4)   VALUE +2649.
001007     12  ER-2650                     PIC S9(4)   VALUE +2650.
001008     12  ER-2651                     PIC S9(4)   VALUE +2651.
001009     12  ER-2652                     PIC S9(4)   VALUE +2652.
001010     12  ER-2653                     PIC S9(4)   VALUE +2653.
001011     12  ER-2654                     PIC S9(4)   VALUE +2654.
001012     12  ER-2655                     PIC S9(4)   VALUE +2655.
001013     12  ER-2656                     PIC S9(4)   VALUE +2656.
001014     12  ER-2657                     PIC S9(4)   VALUE +2657.
001015     12  ER-2658                     PIC S9(4)   VALUE +2658.
001016     12  ER-2659                     PIC S9(4)   VALUE +2659.
001017     12  ER-2660                     PIC S9(4)   VALUE +2660.
001018     12  ER-2661                     PIC S9(4)   VALUE +2661.
001019     12  ER-2662                     PIC S9(4)   VALUE +2662.
001020     12  ER-2663                     PIC S9(4)   VALUE +2663.
001021     12  ER-2664                     PIC S9(4)   VALUE +2664.
001022     12  ER-2665                     PIC S9(4)   VALUE +2665.
001023     12  ER-2666                     PIC S9(4)   VALUE +2666.
001024     12  ER-2667                     PIC S9(4)   VALUE +2667.
001025     12  ER-2668                     PIC S9(4)   VALUE +2668.
001026     12  ER-2669                     PIC S9(4)   VALUE +2669.
001027     12  ER-2670                     PIC S9(4)   VALUE +2670.
001028     12  ER-2671                     PIC S9(4)   VALUE +2671.
001029     12  ER-2672                     PIC S9(4)   VALUE +2672.
001030     12  ER-2673                     PIC S9(4)   VALUE +2673.
001031     12  ER-2674                     PIC S9(4)   VALUE +2674.
001032     12  ER-2675                     PIC S9(4)   VALUE +2675.
001033     12  ER-2676                     PIC S9(4)   VALUE +2676.
001034     12  ER-2677                     PIC S9(4)   VALUE +2677.
001035     12  ER-2678                     PIC S9(4)   VALUE +2678.
001036     12  ER-2679                     PIC S9(4)   VALUE +2679.
001037     12  ER-2680                     PIC S9(4)   VALUE +2680.
001038     12  ER-2681                     PIC S9(4)   VALUE +2681.
001039     12  ER-2682                     PIC S9(4)   VALUE +2682.
001040     12  ER-2683                     PIC S9(4)   VALUE +2683.
001041     12  ER-2684                     PIC S9(4)   VALUE +2684.
001042     12  ER-2685                     PIC S9(4)   VALUE +2685.
001043     12  ER-2686                     PIC S9(4)   VALUE +2686.
001044     12  ER-2687                     PIC S9(4)   VALUE +2687.
001045     12  ER-2688                     PIC S9(4)   VALUE +2688.
001046     12  ER-2689                     PIC S9(4)   VALUE +2689.
001047     12  ER-2690                     PIC S9(4)   VALUE +2690.
001048     12  ER-2691                     PIC S9(4)   VALUE +2691.
001049     12  ER-2692                     PIC S9(4)   VALUE +2692.
001050     12  ER-2693                     PIC S9(4)   VALUE +2693.
001051     12  ER-2694                     PIC S9(4)   VALUE +2694.
001052     12  ER-2695                     PIC S9(4)   VALUE +2695.
001053     12  ER-2696                     PIC S9(4)   VALUE +2696.
001054     12  ER-2697                     PIC S9(4)   VALUE +2697.
001055     12  ER-2698                     PIC S9(4)   VALUE +2698.
001056     12  ER-2699                     PIC S9(4)   VALUE +2699.
001057     12  ER-2700                     PIC S9(4)   VALUE +2700.
001058     12  ER-2701                     PIC S9(4)   VALUE +2701.
001059     12  ER-2702                     PIC S9(4)   VALUE +2702.
001060     12  ER-2703                     PIC S9(4)   VALUE +2703.
001061     12  ER-2704                     PIC S9(4)   VALUE +2704.
001062     12  ER-2707                     PIC S9(4)   VALUE +2707.
001063     12  ER-2720                     PIC S9(4)   VALUE +2720.
001064     12  ER-2709                     PIC S9(4)   VALUE +2709.
001065     12  ER-2717                     PIC S9(4)   VALUE +2717.
001066     12  ER-2718                     PIC S9(4)   VALUE +2718.
001067     12  ER-2719                     PIC S9(4)   VALUE +2719.
001068     12  ER-2721                     PIC S9(4)   VALUE +2721.
001069     12  ER-2722                     PIC S9(4)   VALUE +2722.
001070     12  ER-2723                     PIC S9(4)   VALUE +2723.
001071     12  ER-2724                     PIC S9(4)   VALUE +2724.
001072     12  ER-2725                     PIC S9(4)   VALUE +2725.
001073     12  ER-2726                     PIC S9(4)   VALUE +2726.
001074     12  ER-2727                     PIC S9(4)   VALUE +2727.
001075     12  ER-2728                     PIC S9(4)   VALUE +2728.
001076     12  ER-2729                     PIC S9(4)   VALUE +2729.
001077     12  ER-2730                     PIC S9(4)   VALUE +2730.
001078     12  ER-2731                     PIC S9(4)   VALUE +2731.
001079     12  ER-2732                     PIC S9(4)   VALUE +2732.
001080     12  ER-2733                     PIC S9(4)   VALUE +2733.
001081     12  ER-2734                     PIC S9(4)   VALUE +2734.
001082     12  ER-2735                     PIC S9(4)   VALUE +2735.
001083     12  ER-2736                     PIC S9(4)   VALUE +2736.
001084     12  ER-2737                     PIC S9(4)   VALUE +2737.
001085     12  ER-2738                     PIC S9(4)   VALUE +2738.
001086     12  ER-2739                     PIC S9(4)   VALUE +2739.
001087     12  ER-2740                     PIC S9(4)   VALUE +2740.
001088     12  ER-2741                     PIC S9(4)   VALUE +2741.
001089     12  ER-2742                     PIC S9(4)   VALUE +2742.
001090     12  ER-2743                     PIC S9(4)   VALUE +2743.
001091     12  ER-2744                     PIC S9(4)   VALUE +2744.
001092     12  ER-2745                     PIC S9(4)   VALUE +2745.
001093     12  ER-2746                     PIC S9(4)   VALUE +2746.
001094     12  ER-2747                     PIC S9(4)   VALUE +2747.
001095     12  ER-2748                     PIC S9(4)   VALUE +2748.
001096     12  ER-2749                     PIC S9(4)   VALUE +2749.
001097     12  ER-2750                     PIC S9(4)   VALUE +2750.
001098     12  ER-2751                     PIC S9(4)   VALUE +2751.
001099     12  ER-2752                     PIC S9(4)   VALUE +2752.
001100     12  ER-2753                     PIC S9(4)   VALUE +2753.
001101     12  ER-2754                     PIC S9(4)   VALUE +2754.
001102     12  ER-2755                     PIC S9(4)   VALUE +2755.
001103     12  ER-2756                     PIC S9(4)   VALUE +2756.
001104     12  ER-2757                     PIC S9(4)   VALUE +2757.
001105     12  ER-2758                     PIC S9(4)   VALUE +2758.
001106     12  ER-2759                     PIC S9(4)   VALUE +2759.
001107     12  ER-2760                     PIC S9(4)   VALUE +2760.
001108     12  ER-2761                     PIC S9(4)   VALUE +2761.
001109     12  ER-2762                     PIC S9(4)   VALUE +2762.
001110     12  ER-2763                     PIC S9(4)   VALUE +2763.
001111     12  ER-2764                     PIC S9(4)   VALUE +2764.
001112     12  ER-2765                     PIC S9(4)   VALUE +2765.
001113     12  ER-2766                     PIC S9(4)   VALUE +2766.
001114     12  ER-2767                     PIC S9(4)   VALUE +2767.
001115     12  ER-2768                     PIC S9(4)   VALUE +2768.
001116     12  ER-2769                     PIC S9(4)   VALUE +2769.
001117     12  ER-2770                     PIC S9(4)   VALUE +2770.
001118     12  ER-2771                     PIC S9(4)   VALUE +2771.
001119     12  ER-2772                     PIC S9(4)   VALUE +2772.
001120     12  ER-2773                     PIC S9(4)   VALUE +2773.
001121     12  ER-2774                     PIC S9(4)   VALUE +2774.
001122     12  ER-2775                     PIC S9(4)   VALUE +2775.
001123     12  ER-2776                     PIC S9(4)   VALUE +2776.
001124     12  ER-2777                     PIC S9(4)   VALUE +2777.
001125     12  ER-2778                     PIC S9(4)   VALUE +2778.
001126     12  ER-2779                     PIC S9(4)   VALUE +2779.
001127     12  ER-2780                     PIC S9(4)   VALUE +2780.
001128     12  ER-2781                     PIC S9(4)   VALUE +2781.
001129     12  ER-2782                     PIC S9(4)   VALUE +2782.
001130     12  ER-2783                     PIC S9(4)   VALUE +2783.
001131     12  ER-2786                     PIC S9(4)   VALUE +2786.
001132     12  ER-2787                     PIC S9(4)   VALUE +2787.
001133     12  ER-2788                     PIC S9(4)   VALUE +2788.
001134     12  ER-2789                     PIC S9(4)   VALUE +2789.
001135     12  ER-2792                     PIC S9(4)   VALUE +2792.
001136     12  ER-2793                     PIC S9(4)   VALUE +2793.
001137     12  ER-2794                     PIC S9(4)   VALUE +2794.
001138     12  ER-2795                     PIC S9(4)   VALUE +2795.
001139     12  ER-2796                     PIC S9(4)   VALUE +2796.
001140     12  ER-2798                     PIC S9(4)   VALUE +2798.
001141     12  ER-2799                     PIC S9(4)   VALUE +2799.
001142     12  ER-2869                     PIC S9(4)   VALUE +2869.
001143     12  ER-2879                     PIC S9(4)   VALUE +2879.
001144     12  ER-2881                     PIC S9(4)   VALUE +2881.
001145     12  ER-2883                     PIC S9(4)   VALUE +2883.
001146     12  ER-2882                     PIC S9(4)   VALUE +2882.
001147     12  ER-2884                     PIC S9(4)   VALUE +2884.
001148     12  ER-2885                     PIC S9(4)   VALUE +2885.
001149     12  ER-2886                     PIC S9(4)   VALUE +2886.
001150     12  ER-2887                     PIC S9(4)   VALUE +2887.
001151     12  ER-2888                     PIC S9(4)   VALUE +2888.
001152     12  ER-2889                     PIC S9(4)   VALUE +2889.
001153     12  ER-2890                     PIC S9(4)   VALUE +2890.
001154     12  ER-2891                     PIC S9(4)   VALUE +2891.
001155     12  ER-2892                     PIC S9(4)   VALUE +2892.
001156     12  ER-2894                     PIC S9(4)   VALUE +2894.
001157     12  ER-2895                     PIC S9(4)   VALUE +2895.
001158     12  ER-2896                     PIC S9(4)   VALUE +2896.
001159     12  ER-2897                     PIC S9(4)   VALUE +2897.
001160     12  ER-2898                     PIC S9(4)   VALUE +2898.
001161     12  ER-2963                     PIC S9(4)   VALUE +2963.
001162     12  ER-2964                     PIC S9(4)   VALUE +2964.
001163     12  ER-2965                     PIC S9(4)   VALUE +2965.
001164     12  ER-2969                     PIC S9(4)   VALUE +2969.
001165     12  ER-2998                     PIC S9(4)   VALUE +2998.
001166     12  ER-3006                     PIC S9(4)   VALUE +3006.
001167     12  ER-3049                     PIC S9(4)   VALUE +3049.
001168     12  ER-3050                     PIC S9(4)   VALUE +3050.
001169     12  ER-3052                     PIC S9(4)   VALUE +3052.
001170     12  ER-3054                     PIC S9(4)   VALUE +3054.
001171     12  ER-3057                     PIC S9(4)   VALUE +3057.
001172     12  ER-3058                     PIC S9(4)   VALUE +3058.
001173     12  ER-3059                     PIC S9(4)   VALUE +3059.
001174     12  ER-3060                     PIC S9(4)   VALUE +3060.
001175     12  ER-3061                     PIC S9(4)   VALUE +3061.
001176     12  ER-3062                     PIC S9(4)   VALUE +3062.
001177     12  ER-3063                     PIC S9(4)   VALUE +3063.
001178     12  ER-3068                     PIC S9(4)   VALUE +3068.
001179     12  ER-3069                     PIC S9(4)   VALUE +3069.
001180     12  er-3070                     pic s9(4)   value +3070.
001181     12  er-3071                     pic s9(4)   value +3071.
001182     12  er-3270                     pic s9(4)   value +3270.
001183     12  er-3273                     pic s9(4)   value +3273.
001184     12  er-3281                     pic s9(4)   value +3281.
001185     12  ER-3780                     PIC S9(4)   VALUE +3780.
001186     12  ER-3781                     PIC S9(4)   VALUE +3781.
001187     12  ER-3782                     PIC S9(4)   VALUE +3782.
001188     12  ER-3789                     PIC S9(4)   VALUE +3789.
001189     12  ER-3790                     PIC S9(4)   VALUE +3790.
001190     12  ER-3825                     PIC S9(4)   VALUE +3825.
001191     12  ER-3826                     PIC S9(4)   VALUE +3826.
001192     12  ER-3827                     PIC S9(4)   VALUE +3827.
001193     12  ER-3843                     PIC S9(4)   VALUE +3843.
001194     12  ER-7812                     PIC S9(4)   VALUE +7812.
001195     12  ER-7813                     PIC S9(4)   VALUE +7813.
001196     12  ER-7814                     PIC S9(4)   VALUE +7814.
001197     12  ER-7815                     PIC S9(4)   VALUE +7815.
001198     12  ER-7816                     PIC S9(4)   VALUE +7816.
001199     12  ER-7817                     PIC S9(4)   VALUE +7817.
001200     12  ER-7818                     PIC S9(4)   VALUE +7818.
001201     12  ER-7819                     PIC S9(4)   VALUE +7819.
001202     12  ER-7820                     PIC S9(4)   VALUE +7820.
001203     12  ER-7823                     PIC S9(4)   VALUE +7823.
001204     12  ER-7825                     PIC S9(4)   VALUE +7825.
001205     12  ER-8002                     PIC S9(4)   VALUE +8002.
001206     12  ER-8030                     PIC S9(4)   VALUE +8030.
001207     12  ER-8036                     PIC S9(4)   VALUE +8036.
001208     12  ER-8037                     PIC S9(4)   VALUE +8037.
001209     12  ER-8038                     PIC S9(4)   VALUE +8038.
001210     12  ER-8039                     PIC S9(4)   VALUE +8039.
001211     12  ER-8040                     PIC S9(4)   VALUE +8040.
001212     12  ER-8041                     PIC S9(4)   VALUE +8041.
001213     12  ER-8042                     PIC S9(4)   VALUE +8042.
001214     12  ER-8043                     PIC S9(4)   VALUE +8043.
001215     12  ER-8044                     PIC S9(4)   VALUE +8044.
001216     12  ER-8045                     PIC S9(4)   VALUE +8045.
001217     12  ER-8046                     PIC S9(4)   VALUE +8046.
001218     12  ER-8050                     PIC S9(4)   VALUE +8050.
001219     12  ER-8067                     PIC S9(4)   VALUE +8067.
001220     12  ER-8068                     PIC S9(4)   VALUE +8068.
001221     12  ER-8069                     PIC S9(4)   VALUE +8069.
001222     12  ER-8070                     PIC S9(4)   VALUE +8070.
001223     12  ER-8071                     PIC S9(4)   VALUE +8071.
001224     12  ER-8072                     PIC S9(4)   VALUE +8072.
001225     12  ER-8074                     PIC S9(4)   VALUE +8074.
001226     12  ER-8075                     PIC S9(4)   VALUE +8075.
001227     12  ER-8076                     PIC S9(4)   VALUE +8076.
001228     12  ER-8077                     PIC S9(4)   VALUE +8077.
001229     12  ER-8078                     PIC S9(4)   VALUE +8078.
001230     12  ER-8079                     PIC S9(4)   VALUE +8079.
001231     12  ER-8080                     PIC S9(4)   VALUE +8080.
001232     12  ER-8081                     PIC S9(4)   VALUE +8081.
001233     12  ER-8082                     PIC S9(4)   VALUE +8082.
001234     12  ER-8083                     PIC S9(4)   VALUE +8083.
001235     12  ER-8084                     PIC S9(4)   VALUE +8084.
001236     12  ER-8085                     PIC S9(4)   VALUE +8085.
001237     12  ER-8086                     PIC S9(4)   VALUE +8086.
001238     12  ER-8087                     PIC S9(4)   VALUE +8087.
001239     12  ER-8088                     PIC S9(4)   VALUE +8088.
001240     12  ER-8089                     PIC S9(4)   VALUE +8089.
001241     12  ER-8090                     PIC S9(4)   VALUE +8090.
001242     12  ER-8091                     PIC S9(4)   VALUE +8091.
001243     12  ER-8092                     PIC S9(4)   VALUE +8092.
001244     12  ER-8093                     PIC S9(4)   VALUE +8093.
001245     12  ER-8094                     PIC S9(4)   VALUE +8094.
001246     12  ER-8095                     PIC S9(4)   VALUE +8095.
001247     12  ER-8096                     PIC S9(4)   VALUE +8096.
001248     12  ER-8097                     PIC S9(4)   VALUE +8097.
001249     12  ER-8098                     PIC S9(4)   VALUE +8098.
001250     12  ER-8099                     PIC S9(4)   VALUE +8099.
001251     12  ER-8109                     PIC S9(4)   VALUE +8109.
001252     12  ER-8110                     PIC S9(4)   VALUE +8110.
001253     12  ER-8111                     PIC S9(4)   VALUE +8111.
001254     12  ER-8112                     PIC S9(4)   VALUE +8112.
001255     12  ER-8113                     PIC S9(4)   VALUE +8113.
001256     12  ER-8114                     PIC S9(4)   VALUE +8114.
001257     12  ER-8116                     PIC S9(4)   VALUE +8116.
001258     12  ER-8148                     PIC S9(4)   VALUE +8148.
001259     12  ER-8152                     PIC S9(4)   VALUE +8152.
001260     12  ER-8300                     PIC S9(4)   VALUE +8300.
001261     12  ER-8301                     PIC S9(4)   VALUE +8301.
001262     12  ER-8302                     PIC S9(4)   VALUE +8302.
001263     12  ER-8303                     PIC S9(4)   VALUE +8303.
001264     12  ER-8304                     PIC S9(4)   VALUE +8304.
001265     12  ER-8310                     PIC S9(4)   VALUE +8310.
001266     12  ER-8311                     PIC S9(4)   VALUE +8311.
001267     12  ER-8312                     PIC S9(4)   VALUE +8312.
001268     12  ER-8313                     PIC S9(4)   VALUE +8313.
001269     12  ER-8314                     PIC S9(4)   VALUE +8314.
001270     12  ER-8315                     PIC S9(4)   VALUE +8315.
001271     12  ER-8316                     PIC S9(4)   VALUE +8316.
001272     12  ER-8317                     PIC S9(4)   VALUE +8317.
001273     12  ER-9236                     PIC S9(4)   VALUE +9236.
001274     12  ER-9501                     PIC S9(4)   VALUE +9501.
001275     12  ER-9503                     PIC S9(4)   VALUE +9503.
001276     12  ER-9263                     PIC S9(4)   VALUE +9263.
001277     12  ER-9813                     PIC S9(4)   VALUE +9813.
001278     12  er-9823                     pic s9(4)   value +9823.
001279     12  ER-9999                     PIC S9(4)   VALUE +9999.
001280******************************************************************
001281***************   END OF ELC50WS     ****************************
001282******************************************************************
001283     EJECT
      *<<((file: ELC50WS))
000092     EJECT
000093 01  WORKING-STORAGE-WORK-AREAS.
000094     12  WS-RESPONSE             PIC S9(8)  COMP.
000095         88  WS-RESP-NORMAL           VALUE +00.
000096         88  WS-RESP-ERROR            VALUE +01.
000097         88  WS-RESP-NOTFND           VALUE +13.
000098         88  WS-RESP-DUPREC           VALUE +14.
000099         88  WS-RESP-ENDFILE          VALUE +20.
000100     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
000101     12  WORK-AREAS.
000102         16  WK-CONV-GREG.
000103             24  WCG-CENT             PIC XX.
000104             24  WCG-REST             PIC X(4).
000105         16  WORK-GREGORIAN-DATE.
000106             24  WK-GREG-CENT         PIC XX.
000107             24  WK-GREG-DATE-YYMMDD.
000108                 28  WK-GREG-YYMM     PIC X(4).
000109                 28  WK-GREG-DD       PIC XX.
000110
000111         16  WORK-SELECT-DATE.
000112             24  WK-SELECT-CENT            PIC XX.
000113             24  WK-SELECT-DATE-YYMMDD.
000114                 28  WK-SELECT-GREG-YYMM   PIC X(4).
000115                 28  FILLER                PIC XX.
000116
000117         16  WK-FORM-NO.
000118             24  WK-FORM-BANK-ID       PIC X(5).
000119             24  WK-FORM-UNDRWRTR      PIC X(1).
000120             24  WK-FORM-MASTER-POL-NO PIC X(6).
000121
000122         16  WK-MEMBER-NO.
000123             24  WK-MEMBER-1-6        PIC X(6).
000124             24  WK-MEMBER-7-12       PIC X(6).
000125
000126         16  WK-FULL-CERT-NO.
000127             24  WK-CERT-POS-1-2      PIC X(2).
000128             24  WK-CERT-POS-3        PIC X(1).
000129             24  WK-CERT-POS-4        PIC X(1).
000130             24  WK-CERT-POS-5-6      PIC X(2).
000131             24  WK-CERT-POS-7        PIC X(1).
000132             24  WK-CERT-POS-8-11     PIC X(4).
000133
000134         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
000135             88  VALID-RATE-CODE        VALUE 'Y'.
000136             88  FOUND-TO-BE-INVALID    VALUE 'N'.
000137
000138         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
000139         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
000140         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
000141         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
000142         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
000143         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
000144         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
000145         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
000146         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
000147         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
000148
000149* DLO001
000150 01  WS-DLO-MASTER-POLICY-FORM.
000151     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
000152     12  DMPF-RETURN-CODE          PIC XX.
000153         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
000154         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
000155         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
000156         88  DMPF-POLICY-INACTIVE              VALUE '03'.
000157         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
000158         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
000159
000160* DLO002
000161 01  WS-DLO-INTERNAL-POLICY-FORM.
000162     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
000163     12  DIPF-RETURN-CODE          PIC XX.
000164         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
000165         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
000166         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
000167         88  DIPF-POLICY-INACTIVE              VALUE '03'.
000168         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
000169         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
000170
000171* DLO003
000172 01  WS-DLO-VALID-BANK-ID.
000173     12  DVBI-BANK-ID              PIC X(5).
000174     12  DVBI-BANK-ID-TYPE         PIC X.
000175         88  DVBI-BILLING-BANK                 VALUE 'B'.
000176         88  DVBI-PLAN-BANK                    VALUE 'P'.
000177         88  DVBI-ENROLL-BANK                  VALUE 'E'.
000178         88  DVBI-NEGOT-BANK                   VALUE 'N'.
000179         88  DVBI-PROCESS-CENTER               VALUE 'X'.
000180     12  DVBI-RETURN-CODE          PIC XX.
000181         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
000182         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
000183         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
000184         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
000185         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
000186         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
000187         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
000188         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
000189         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
000190
000191* DLO007
000192 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
000193     12  DCUA-RES-STATE            PIC XX.
000194     12  DCUA-BEN-TYPE             PIC XX.
000195     12  DCUA-SYS-IDENT            PIC X.
000196         88  DCUA-CLAIM                        VALUE 'C'.
000197         88  DCUA-PREMIUM                      VALUE 'P'.
000198     12  DCUA-COVERAGE-RULE        PIC X.
000199     12  DCUA-CLIENT-ID            PIC X(10).
000200     12  DCUA-EFF-DATE             PIC X(8).
000201     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
000202     12  DCUA-RETURN-CODE          PIC XX.
000203         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
000204     12  DCUA-CERT-NUMBER          PIC X(11).
000205     12  DCUA-UNDRWRTR-CODE        PIC XX.
000206     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
000207
000208* DLO011
000209 01  WS-DLO-PREM-RATES-BEN-TYPE.
000210     12  DPRB-RATE-CODE            PIC X(4).
000211     12  DPRB-COVERAGE-CATEG       PIC X.
000212     12  DPRB-RETURN-CODE          PIC XX.
000213         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
000214         88  DPRB-NO-RATE-CODE                 VALUE '01'.
000215         88  DPRB-NO-COV-CATEG                 VALUE '02'.
000216         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
000217         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
000218         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
000219         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
000220         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
000221         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
000222     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
000223     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
000224     12  DPRB-BEN-TYPE             PIC XX.
000225
000226* DLO017
000227 01  WS-DLO-VALID-RATE-CODE.
000228     12  DVRC-RATE-CODE            PIC X(4).
000229     12  DVRC-RETURN-CODE          PIC XX.
000230         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
000231         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
000232         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
000233         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
000234         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
000235         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
000236
000237* DLO019
000238 01  WS-DLO-ORIG-COV-CAT.
000239     12  DOCC-ORIG-BEN-TYPE        PIC XX.
000240     12  DOCC-RETURN-CODE          PIC XX.
000241     12  DOCC-ORIG-COV-CAT         PIC X.
000242     12  DOCC-UNDERWITER           PIC XX.
000243     12  DOCC-UNDW-GROUP-CODE      PIC X.
000244     12  DOCC-FILLER               PIC X(6).
000245
000246* DLO021
000247 01  WS-DLO-VALID-LOAN-OFFICER.
000248     12  DVLO-LOAN-OFFICER.
000249         16  DVLO-BILL-TYPE        PIC X.
000250         16  DVLO-BILL-SOURCE      PIC X.
000251         16  DVLO-BATCH-TYPE       PIC X.
000252     12  DVLO-RETURN-CODE          PIC XX.
000253         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
000254         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
000255         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
000256         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
000257         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
000258         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
000259
000260* DLO022
000261 01  WS-DLO-VALID-STATE-CODE.
000262     12  DVSC-STATE-CODE           PIC XX.
000263     12  DVSC-RETURN-CODE          PIC XX.
000264         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
000265
000266* DLO023
000267 01  WS-DLO-VALID-CODE-VALUES.
000268     12  DVCV-SYSTEM-ID            PIC XX.
000269         88  DVCV-CLAIMS                       VALUE 'CL'.
000270         88  DVCV-CREDIT                       VALUE 'CR'.
000271     12  DVCV-RECORD-TYPE          PIC XX.
000272         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
000273         88  DVCV-EOB-CODE                     VALUE 'EO'.
000274         88  DVCV-ICD9-CODE                    VALUE 'I9'.
000275         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
000276         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
000277         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
000278         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
000279         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
000280     12  DVCV-RECORD-KEY           PIC X(6).
000281     12  DVCV-RETURN-CODE          PIC XX.
000282         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
000283         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
000284         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
000285         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
000286         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
000287         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
000288         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
000289     12  DVCV-CODE-DESC            PIC X(60).
000290     12  DVCV-GEN-DESC-1           PIC X(20).
000291     12  DVCV-GEN-DESC-2           PIC X(20).
000292     12  DVCV-GEN-DESC-3           PIC X(20).
000293
000294 01  hldi-pass-area-len          pic s9(4) comp value +214.
000295 01  hldi-pass-area.
000296     03  PA-VIN                  PIC X(17).
000297     03  PA-ErrorCode            PIC X(10).
000298     03  PA-ErrorDesc            PIC X(30).
000299     03  PA-ModelYear            PIC 9(7).
000300     03  PA-MakeName             PIC X(50).
000301     03  PA-ModelName            PIC X(50).
000302     03  PA-SeriesName           PIC X(50).
000303
000304 01  zipcd-pass-area-len         pic s9(4) comp value +67.
000305 01  zipcd-pass-area.
000306     03  PA-zip                  PIC X(5).
000307     03  PA-ErrorCode-zip        PIC X(10).
000308     03  PA-city                 PIC x(50).
000309     03  PA-state                PIC Xx.
000310
000311 01  clmhs-pass-area-len         pic s9(4) comp value +40.
000312 01  clmhs-pass-area.
000313     03  pa-clmhs-state          pic xx.
000314     03  pa-account              pic x(10).
000315     03  pa-eff-dt               pic x(10).
000316     03  pa-cert-no              pic x(11).
000317     03  pa-clm-count            pic 9(5).
000318
000319****  this is for aggregate report.
000320****  Length is erpndb + 100 of passed-key-area
000321 01  ws-passed-key-length        pic s9(4) comp value +587.
000322
000323 01  ws-pass-to-pemaggo.
000324     05  ws-passed-erpndb        pic x(585).
000325     05  ws-exceed-limit-yn      pic x.
000326     05  ws-has-claim-yn         pic x.
000327
000328     EJECT
000329*    COPY ERCBXRF.
      *>>((file: ERCBXRF))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCBXRF                             *
000005*                                                                *
000006*   ONLINE CREDIT SYSTEM                                         *
000007*                                                                *
000008*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
000009*                                                                *
000010*   FILE TYPE = VSAM,KSDS                                        *
000011*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
000012*                                                                *
000013*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
000014*       ALTERNATE PATH = NONE                                    *
000015*                                                                *
000016*   LOG = NO                                                     *
000017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000018*                                                                *
000019******************************************************************
000020
000021 01  BANK-CROSS-REFERENCE.
000022     12  BK-RECORD-ID                PIC XX.
000023         88  VALID-BK-ID             VALUE 'BK'.
000024
000025     12  BK-CONTROL-PRIMARY.
000026         16  BK-COMPANY-CD           PIC X.
000027         16  BK-CARRIER              PIC X.
000028         16  BK-GROUPING             PIC X(6).
000029         16  BK-BANK-NO              PIC X(10).
000030
000031     12  BK-MAINT-INFORMATION.
000032         16  BK-LAST-MAINT-DT        PIC XX.
000033         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
000034         16  BK-LAST-MAINT-USER      PIC X(4).
000035         16  FILLER                  PIC X(9).
000036
000037     12  FILLER                      PIC X(37).
000038
000039     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
000040
000041     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
000042                            DEPENDING ON BK-BANK-POINTER-CNT.
000043         16  BK-AM-ACCOUNT           PIC X(10).
000044         16  BK-AM-EXP-DT            PIC XX.
000045         16  BK-AM-EFF-DT            PIC XX.
000046         16  BK-AM-STATE             PIC XX.
000047         16  FILLER                  PIC X(20).
000048
000049******************************************************************
      *<<((file: ERCBXRF))
000330
000331*    COPY ERCCOMP.
      *>>((file: ERCCOMP))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCCOMP                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.019                          *
000007*                                                                *
000008*   ONLINE CREDIT SYSTEM                                         *
000009*                                                                *
000010*   FILE DESCRIPTION = COMPENSATION MASTER                       *
000011*                                                                *
000012*   FILE TYPE = VSAM,KSDS                                        *
000013*   RECORD SIZE = 700   RECFORM = FIXED                          *
000014*                                                                *
000015*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
000016*       ALTERNATE PATH = NONE                                    *
000017*                                                                *
000018*   LOG = NO                                                     *
000019*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000020*                                                                *
000021******************************************************************
000022*                   C H A N G E   L O G
000023*
000024* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000025*-----------------------------------------------------------------
000026*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000027* EFFECTIVE    NUMBER
000028*-----------------------------------------------------------------
000029* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
000030* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
000031* 092205    2005050300006  PEMA  ADD LEASE FEE
000032* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
000033* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
000034* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
000035* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
000036* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
000037* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
000038******************************************************************
000039
000040 01  COMPENSATION-MASTER.
000041     12  CO-RECORD-ID                          PIC XX.
000042         88  VALID-CO-ID                          VALUE 'CO'.
000043
000044     12  CO-CONTROL-PRIMARY.
000045         16  CO-COMPANY-CD                     PIC X.
000046         16  CO-CONTROL.
000047             20  CO-CTL-1.
000048                 24  CO-CARR-GROUP.
000049                     28  CO-CARRIER            PIC X.
000050                     28  CO-GROUPING.
000051                         32  CO-GROUP-PREFIX   PIC XXX.
000052                         32  CO-GROUP-PRIME    PIC XXX.
000053                 24  CO-RESP-NO.
000054                     28  CO-RESP-PREFIX        PIC X(4).
000055                     28  CO-RESP-PRIME         PIC X(6).
000056             20  CO-CTL-2.
000057                 24  CO-ACCOUNT.
000058                     28  CO-ACCT-PREFIX        PIC X(4).
000059                     28  CO-ACCT-PRIME         PIC X(6).
000060         16  CO-TYPE                           PIC X.
000061             88  CO-COMPANY-TYPE                  VALUE 'C'.
000062             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
000063             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
000064
000065     12  CO-MAINT-INFORMATION.
000066         16  CO-LAST-MAINT-DT                  PIC XX.
000067         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
000068         16  CO-LAST-MAINT-USER                PIC X(4).
000069     12  FILLER                                PIC XX.
000070     12  CO-STMT-TYPE                          PIC XXX.
000071     12  CO-COMP-TYPE                          PIC X.
000072         88  CO-COMP-IS-SPPDD                    VALUE '1'.
000073     12  CO-STMT-OWNER                         PIC X(4).
000074     12  CO-BALANCE-CONTROL                    PIC X.
000075         88  CO-CARRY-BALANCE                     VALUE 'Y'.
000076         88  CO-NO-BALANCE                        VALUE 'N'.
000077
000078     12  CO-INTERNAL-CONTROL-1                 PIC X.
000079         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
000080         88  CO-AUTO-GENERATED                    VALUE 'Y'.
000081         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
000082
000083     12  CO-INTERNAL-CONTROL-2                 PIC X.
000084         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
000085         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
000086
000087     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
000088     12  CO-GA-DIRECT-DEP                      PIC X.
000089     12  CO-FUTURE-SPACE                       PIC X.
000090         88  CO-FUTURE-NOT-USED                   VALUE ' '.
000091
000092     12  CO-ACCT-NAME                          PIC X(30).
000093     12  CO-MAIL-NAME                          PIC X(30).
000094     12  CO-ADDR-1                             PIC X(30).
000095     12  CO-ADDR-2                             PIC X(30).
000096     12  CO-ADDR-3.
000097         16  CO-ADDR-CITY                      PIC X(27).
000098         16  CO-ADDR-STATE                     PIC XX.
000099     12  CO-CSO-1099                           PIC X.
000100     12  CO-ZIP.
000101         16  CO-ZIP-PRIME.
000102             20  CO-ZIP-PRI-1ST                PIC X.
000103                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
000104             20  FILLER                        PIC X(4).
000105         16  CO-ZIP-PLUS4                      PIC X(4).
000106     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
000107         16  CO-CAN-POSTAL-1                   PIC XXX.
000108         16  CO-CAN-POSTAL-2                   PIC XXX.
000109         16  FILLER                            PIC XXX.
000110     12  CO-SOC-SEC                            PIC X(13).
000111     12  CO-TELEPHONE.
000112         16  CO-AREA-CODE                      PIC XXX.
000113         16  CO-PREFIX                         PIC XXX.
000114         16  CO-PHONE                          PIC X(4).
000115
000116     12  CO-ROLADEX-PRINT-DT                   PIC XX.
000117
000118     12  CO-AR-BAL-LEVEL                       PIC X.
000119         88  CO-AR-REF-LVL                        VALUE '1'.
000120         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
000121         88  CO-AR-BILL-LVL                       VALUE '2'.
000122         88  CO-AR-AGT-LVL                        VALUE '3'.
000123         88  CO-AR-FR-LVL                         VALUE '4'.
000124
000125     12  CO-AR-NORMAL-PRINT                    PIC X.
000126         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
000127         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
000128
000129     12  CO-AR-SUMMARY-CODE                    PIC X(6).
000130
000131     12  CO-AR-REPORTING                       PIC X.
000132         88  CO-AR-NET-REPORT                     VALUE 'N'.
000133         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
000134
000135     12  CO-AR-PULL-CHECK                      PIC X.
000136         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
000137         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
000138
000139     12  CO-AR-BALANCE-PRINT                   PIC X.
000140         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
000141
000142     12  CO-AR-LAST-RUN-CODE                   PIC X.
000143         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
000144         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
000145         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
000146
000147     12  CO-LAST-EOM-STMT-DT                   PIC XX.
000148
000149     12  CO-USER-CODE                          PIC X.
000150     12  CO-REPORT-GROUP-ID                    PIC X(12).
000151
000152******************************************************************
000153*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
000154*    THE LAST MONTH END RUN.
000155******************************************************************
000156
000157     12  CO-LAST-ACTIVITY-DATE.
000158         16  CO-ACT-YEAR                       PIC 99.
000159         16  CO-ACT-MONTH                      PIC 99.
000160         16  CO-ACT-DAY                        PIC 99.
000161
000162     12  CO-LAST-STMT-DT.
000163         16  CO-LAST-STMT-YEAR                 PIC 99.
000164         16  CO-LAST-STMT-MONTH                PIC 99.
000165         16  CO-LAST-STMT-DAY                  PIC 99.
000166
000167     12  CO-MO-END-TOTALS.
000168         16  CO-MONTHLY-TOTALS.
000169             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
000170             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
000171             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
000172             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
000173             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
000174
000175         16  CO-AGING-TOTALS.
000176             20  CO-CUR                    PIC S9(7)V99   COMP-3.
000177             20  CO-OV30                   PIC S9(7)V99   COMP-3.
000178             20  CO-OV60                   PIC S9(7)V99   COMP-3.
000179             20  CO-OV90                   PIC S9(7)V99   COMP-3.
000180
000181         16  CO-YTD-TOTALS.
000182             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
000183             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
000184
000185         16  CO-OVER-UNDER-TOTALS.
000186             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
000187             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
000188
000189     12  CO-MISCELLANEOUS-TOTALS.
000190         16  CO-FICA-TOTALS.
000191             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
000192             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
000193
000194         16  CO-CLAIM-TOTALS.
000195             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
000196             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
000197
000198******************************************************************
000199*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
000200*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
000201******************************************************************
000202
000203     12  CO-CURRENT-TOTALS.
000204         16  CO-CURRENT-LAST-STMT-DT.
000205             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
000206             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
000207             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
000208
000209         16  CO-CURRENT-MONTHLY-TOTALS.
000210             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
000211             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
000212             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
000213             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
000214             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
000215
000216         16  CO-CURRENT-AGING-TOTALS.
000217             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
000218             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
000219             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
000220             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
000221
000222         16  CO-CURRENT-YTD-TOTALS.
000223             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
000224             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
000225
000226     12  CO-PAID-COMM-TOTALS.
000227         16  CO-YTD-PAID-COMMS.
000228             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
000229             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
000230
000231     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
000232         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
000233         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
000234
000235     12  CO-DELINQUENT-LETTER-CODE         PIC X.
000236         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
000237         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
000238         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
000239         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
000240         88  CO-OVERWRITE-LETTER              VALUE 'O'.
000241         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
000242         88  CO-FINAL-LETTER                  VALUE 'F'.
000243         88  CO-RECONCILING                   VALUE 'R'.
000244         88  CO-PHONE-CALL                    VALUE 'P'.
000245         88  CO-LEGAL                         VALUE 'L'.
000246         88  CO-COLLECTION-AGENCY             VALUE 'C'.
000247         88  CO-WRITE-OFF                     VALUE 'W'.
000248         88  CO-NO-ACTION                     VALUE 'N' ' '.
000249
000250     12  CO-CSR-CODE                       PIC X(4).
000251
000252     12  CO-GA-STATUS-INFO.
000253         16  CO-GA-EFFECTIVE-DT            PIC XX.
000254         16  CO-GA-TERMINATION-DT          PIC XX.
000255         16  CO-GA-STATUS-CODE             PIC X.
000256             88  CO-GA-ACTIVE                 VALUE 'A'.
000257             88  CO-GA-INACTIVE               VALUE 'I'.
000258             88  CO-GA-PENDING                VALUE 'P'.
000259         16  CO-GA-COMMENTS.
000260             20  CO-GA-COMMENT-1           PIC X(40).
000261             20  CO-GA-COMMENT-2           PIC X(40).
000262             20  CO-GA-COMMENT-3           PIC X(40).
000263             20  CO-GA-COMMENT-4           PIC X(40).
000264
000265     12  CO-RPTCD2                         PIC X(10).
000266     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
000267         16  CO-OV120                      PIC S9(7)V99   COMP-3.
000268         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
000269
000270     12  CO-TYPE-AGENT                     PIC X(01).
000271         88  CO-CORPORATION                   VALUE 'C'.
000272         88  CO-PARTNERSHIP                   VALUE 'P'.
000273         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
000274         88  CO-TRUST                         VALUE 'T'.
000275         88  CO-UNKNOWN                       VALUE ' ' 'X'.
000276
000277     12  CO-FAXNO.
000278         16  CO-FAX-AREA-CODE                  PIC XXX.
000279         16  CO-FAX-PREFIX                     PIC XXX.
000280         16  CO-FAX-PHONE                      PIC X(4).
000281
000282     12  CO-BANK-INFORMATION.
000283         16  CO-BANK-TRANSIT-NO                PIC X(8).
000284         16  CO-BANK-TRANSIT-NON REDEFINES
000285             CO-BANK-TRANSIT-NO                PIC 9(8).
000286
000287         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
000288     12  CO-MISC-DEDUCT-INFO REDEFINES
000289                  CO-BANK-INFORMATION.
000290         16  CO-MD-GL-ACCT                     PIC X(10).
000291         16  CO-MD-DIV                         PIC XX.
000292         16  CO-MD-CENTER                      PIC X(4).
000293         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
000294         16  CO-CREATE-AP-CHECK                PIC X.
000295         16  CO-DELIVER-CK-TO-MEL              PIC X.
000296         16  FILLER                            PIC XXX.
000297     12  CO-ACH-STATUS                         PIC X.
000298         88  CO-ACH-ACTIVE                         VALUE 'A'.
000299         88  CO-ACH-PENDING                        VALUE 'P'.
000300
000301     12  CO-BILL-SW                            PIC X.
000302     12  CO-CONTROL-NAME                       PIC X(30).
000303     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
000304     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
000305     12  CO-CLP-STATE                          PIC XX.
000306     12  CO-FIRST-WRITTEN-DT                   PIC XX.
000307     12  CO-SPP-REFUND-EDIT                    PIC X.
000308
000309******************************************************************
      *<<((file: ERCCOMP))
000332
000333*    COPY ERCAGTC.
      *>>((file: ERCAGTC))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCAGTC                             *
000005*                            VMOD=2.001                          *
000006*                                                                *
000007*   ONLINE CREDIT SYSTEM                                         *
000008*                                                                *
000009*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
000010*                                                                *
000011*   FILE TYPE = VSAM,KSDS                                        *
000012*   RECORD SIZE = 450   RECFORM = FIXED                          *
000013*                                                                *
000014*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
000015*       ALTERNATE PATH = NONE                                    *
000016*                                                                *
000017*   LOG = NO                                                     *
000018*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000019*                                                                *
000020******************************************************************
000021*                   C H A N G E   L O G
000022*
000023* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000024*-----------------------------------------------------------------
000025*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000026* EFFECTIVE    NUMBER
000027*-----------------------------------------------------------------
000028* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
000029* 111004                         NEW FILE AND COPYBOOK
000030* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
000031******************************************************************
000032
000033 01  AGENT-COMMISSIONS.
000034     12  AG-RECORD-ID                          PIC XX.
000035         88  VALID-CO-ID                          VALUE 'AG'.
000036
000037     12  AG-CONTROL-PRIMARY.
000038         16  AG-COMPANY-CD                     PIC X.
000039         16  AG-CONTROL.
000040             20  AG-CTL-1.
000041                 24  AG-CARR-GROUP.
000042                     28  AG-CARRIER            PIC X.
000043                     28  AG-GROUPING           PIC X(6).
000044                 24  AG-BANK                   PIC X(10).
000045             20  AG-CTL-2.
000046                 24  AG-EXP-DT                 PIC XX.
000047         16  AG-TYPE                           PIC X.
000048             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
000049             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
000050
000051     12  AG-MAINT-INFORMATION.
000052         16  AG-LAST-MAINT-DT                  PIC XX.
000053         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
000054         16  AG-LAST-MAINT-USER                PIC X(4).
000055         16  FILLER                            PIC X(10).
000056
000057     12  AG-EFF-DT                             PIC XX.
000058     12  AG-COMM-STRUCTURE.
000059         16  AG-AGT-COMMS OCCURS 10.
000060             20  AG-AGT                PIC X(10).
000061             20  AG-COM-TYP            PIC X.
000062             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
000063             20  AG-RECALC-LV-INDIC    PIC X.
000064             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
000065             20  AG-LRCALC-LV-INDIC    PIC X.
000066             20  FILLER                PIC X(05).
000067
000068     12  FILLER                  PIC X(145).
000069******************************************************************
      *<<((file: ERCAGTC))
000334*    COPY ERCRESS.
      *>>((file: ERCRESS))
000001******************************************************************
000002*                                                                *
000003*                            ERCRESS                             *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000005*                            VMOD=2.002                          *
000006*                                                                *
000007*   CREDIT RESIDENT STATE TAXES MASTER                          *
000008*                                                                *
000009*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
000010*   VSAM RESIDENT STATE TAX MASTER                              *
000011*                                                                *
000012*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
000013*                                                                *
000014*   FILE TYPE = VSAM,KSDS                                        *
000015*   RECORD SIZE = 0047 RECFORM = FIXED                           *
000016*                                                                *
000017*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
000018*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
000019*                                                                *
000020*   LOG = NO                                                     *
000021*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000022*                                                                *
000023*                                                                *
000024******************************************************************
000025
000026 01  RESIDENT-STATE-TAX-MASTER.
000027
000028     10  ERRESS-PRIMARY-KEY.
000029         15  RES-COMPANY-CD        PIC X.
000030         15  RES-RESIDENT-STATE    PIC XX.
000031         15  RES-COVERAGE-CATEGORY PIC X.
000032         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
000033*                                      YYYYMMDD
000034*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
000035
000036     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
000037
000038         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
000039         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
000040         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
000041         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
000042
000043     10 RES-RECALC-SW              PIC   X.
000044         88 RECALC                VALUE 'Y'.
000045         88 NO-RECALC             VALUE 'N'.
000046     10  RES-MAINT-BY              PIC X(4).
000047     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
000048     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
000049*                                      YYYYMMDD
      *<<((file: ERCRESS))
000335     EJECT
000336*    COPY ERCRESC.
      *>>((file: ERCRESC))
000001******************************************************************
000002*                                                                *
000003*                            ERCRESC                             *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000005*                            VMOD=2.003                          *
000006*                                                                *
000007*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
000008*                                                                *
000009*   FILE TYPE = VSAM,KSDS                                        *
000010*   RECORD SIZE = 103 RECFORM = FIXED                            *
000011*                                                                *
000012*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
000013*       ALTERNATE PATH1 = NONE                                   *
000014*                                                                *
000015*   LOG = NO                                                     *
000016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000017*                                                                *
000018******************************************************************
000019
000020 01  ACCOUNT-RESIDENT-ST-COMMISSION.
000021
000022     10  ERRESC-RECORD-KEY.
000023         15  RESC-COMPANY-CD           PIC   X.
000024         15  RESC-CARRIER              PIC   X.
000025         15  RESC-GROUP                PIC   X(6).
000026         15  RESC-STATE                PIC   XX.
000027         15  RESC-ACCOUNT              PIC   X(10).
000028         15  RESC-AGENT                PIC   X(10).
000029         15  RESC-RESIDENT-STATE       PIC   XX.
000030         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
000031*                                           YYYYMMDD
000032     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
000033
000034     10  RESC-COMM-RECORD-DATA.
000035         15  RESC-COMMISSIONS OCCURS 12 TIMES.
000036             20 RESC-COVERAGE-CAT      PIC    X.
000037             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
000038             20 RESC-COMMISSION-TAB REDEFINES
000039                RESC-COMMISSION-PER    PIC  XXX.
000040
000041     10  RESC-MAINT-BY                 PIC X(4).
000042     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
000043     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
000044*                                          YYYYMMDD
      *<<((file: ERCRESC))
000337     EJECT
000338*    COPY ERCPLAN.
      *>>((file: ERCPLAN))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCPLAN                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.003                          *
000007*                                                                *
000008*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
000009*                                                                *
000010*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
000011*   PLAN MASTER                                                  *
000012*                                                                *
000013*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
000014*                                                                *
000015*   FILE TYPE = VSAM,KSDS                                        *
000016*   RECORD SIZE = 420   RECFORM = FIX                            *
000017*                                                                *
000018*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
000019*       ALTERNATE PATH1 = N/A                                    *
000020*                                                                *
000021*   LOG = NO                                                     *
000022*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000023*                                                                *
000024*                                                                *
000025******************************************************************
000026
000027 01  PLAN-MASTER.
000028     12  PL-RECORD-ID                      PIC XX.
000029         88  VALID-PL-ID                      VALUE 'PL'.
000030
000031     12  PL-CONTROL-PRIMARY.
000032         16  PL-COMPANY-CD                 PIC X.
000033         16  PL-MSTR-CNTRL.
000034             20  PL-CONTROL-A.
000035                 24  PL-CARRIER            PIC X.
000036                 24  PL-GROUPING           PIC X(6).
000037                 24  PL-STATE              PIC XX.
000038                 24  PL-ACCOUNT            PIC X(10).
000039             20  PL-BENEFIT-TYPE           PIC X.
000040             20  PL-BENEFIT-CODE           PIC XX.
000041             20  PL-REVISION-NO            PIC X(3).
000042
000043     12  PL-CONTROL-BY-VAR-GRP.
000044         16  PL-COMPANY-CD-A1              PIC X.
000045         16  PL-VG-CARRIER                 PIC X.
000046         16  PL-VG-GROUPING                PIC X(6).
000047         16  PL-VG-STATE                   PIC XX.
000048         16  PL-VG-ACCOUNT                 PIC X(10).
000049         16  PL-BENEFIT-TYPE-A1            PIC X.
000050         16  PL-BENEFIT-CODE-A1            PIC XX.
000051         16  PL-REVISION-NO-A1             PIC 999.
000052
000053     12  PL-MAINT-INFORMATION.
000054         16  PL-LAST-MAINT-DT              PIC XX.
000055         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
000056         16  PL-LAST-MAINT-USER            PIC X(4).
000057         16  FILLER                        PIC XX.
000058
000059     12  PL-LIABILITY-LIMITS.
000060         16  PL-ATT-AGE                    PIC S99        COMP-3.
000061         16  PL-L-LIMITS        OCCURS 8 TIMES.
000062             20  PL-LM-AGE                 PIC S99        COMP-3.
000063             20  PL-LM-DUR                 PIC S999       COMP-3.
000064             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
000065             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
000066
000067     12  FILLER                            PIC X(30).
000068
000069     12  PL-GL-ACCOUNT-NOS.
000070         16  PL-PREMIUM-GL                 PIC X(8).
000071         16  PL-COMM-GL                    PIC X(8).
000072         16  PL-CLAIM-GL                   PIC X(8).
000073     12  FILLER                            PIC X(24).
000074     12  PL-TOLERANCES.
000075         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
000076         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
000077         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
000078         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
000079         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
000080         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
000081     12  PL-OVER-SHORT.
000082         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
000083         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
000084     12  FILLER                            PIC X(24).
000085     12  PLAN-MISC.
000086         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
000087         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
000088         16  PL-IG                         PIC X.
000089         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
000090         16  PL-POLICY-FORM                PIC X(12).
000091         16  PL-EDIT-FOR-FORM              PIC X(01).
000092         16  PL-DEV-CODE                   PIC XXX.
000093         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
000094         16  PL-CALC-METHOD                PIC X.
000095         16  PL-BENEFIT-GROUP              PIC X(05).
000096         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
000097
000098         16  FILLER                        PIC X(99).
000099******************************************************************
      *<<((file: ERCPLAN))
000339     EJECT
000340*    COPY ELCCERT.
      *>>((file: ELCCERT))
000001******************************************************************
000002*                                                                *
000003*                            ELCCERT.                            *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000005*                            VMOD=2.013                          *
000006*                                                                *
000007*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
000008*                                                                *
000009*   FILE TYPE = VSAM,KSDS                                        *
000010*   RECORD SIZE = 450  RECFORM = FIXED                           *
000011*                                                                *
000012*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
000013*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
000014*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
000015*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
000016*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
000017*                                                                *
000018*   LOG = YES                                                    *
000019*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000020******************************************************************
000021*                   C H A N G E   L O G
000022*
000023* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000024*-----------------------------------------------------------------
000025*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000026* EFFECTIVE    NUMBER
000027*-----------------------------------------------------------------
000028* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
000029* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
000030* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
000031* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
000032* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
000033* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
000034* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
000035* 032612  CR2011110200001  PEMA  AHL CHANGES
000036* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
000037* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
000038* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
000039******************************************************************
000040
000041 01  CERTIFICATE-MASTER.
000042     12  CM-RECORD-ID                      PIC XX.
000043         88  VALID-CM-ID                      VALUE 'CM'.
000044
000045     12  CM-CONTROL-PRIMARY.
000046         16  CM-COMPANY-CD                 PIC X.
000047         16  CM-CARRIER                    PIC X.
000048         16  CM-GROUPING.
000049             20  CM-GROUPING-PREFIX        PIC X(3).
000050             20  CM-GROUPING-PRIME         PIC X(3).
000051         16  CM-STATE                      PIC XX.
000052         16  CM-ACCOUNT.
000053             20  CM-ACCOUNT-PREFIX         PIC X(4).
000054             20  CM-ACCOUNT-PRIME          PIC X(6).
000055         16  CM-CERT-EFF-DT                PIC XX.
000056         16  CM-CERT-NO.
000057             20  CM-CERT-PRIME             PIC X(10).
000058             20  CM-CERT-SFX               PIC X.
000059
000060     12  CM-CONTROL-BY-NAME.
000061         16  CM-COMPANY-CD-A1              PIC X.
000062         16  CM-INSURED-LAST-NAME          PIC X(15).
000063         16  CM-INSURED-INITIALS.
000064             20  CM-INSURED-INITIAL1       PIC X.
000065             20  CM-INSURED-INITIAL2       PIC X.
000066
000067     12  CM-CONTROL-BY-SSN.
000068         16  CM-COMPANY-CD-A2              PIC X.
000069         16  CM-SOC-SEC-NO.
000070             20  CM-SSN-STATE              PIC XX.
000071             20  CM-SSN-ACCOUNT            PIC X(6).
000072             20  CM-SSN-LN3.
000073                 25  CM-INSURED-INITIALS-A2.
000074                     30 CM-INSURED-INITIAL1-A2   PIC X.
000075                     30 CM-INSURED-INITIAL2-A2   PIC X.
000076                 25 CM-PART-LAST-NAME-A2         PIC X.
000077
000078     12  CM-CONTROL-BY-CERT-NO.
000079         16  CM-COMPANY-CD-A4              PIC X.
000080         16  CM-CERT-NO-A4                 PIC X(11).
000081
000082     12  CM-CONTROL-BY-MEMB.
000083         16  CM-COMPANY-CD-A5              PIC X.
000084         16  CM-MEMBER-NO.
000085             20  CM-MEMB-STATE             PIC XX.
000086             20  CM-MEMB-ACCOUNT           PIC X(6).
000087             20  CM-MEMB-LN4.
000088                 25  CM-INSURED-INITIALS-A5.
000089                     30 CM-INSURED-INITIAL1-A5   PIC X.
000090                     30 CM-INSURED-INITIAL2-A5   PIC X.
000091                 25 CM-PART-LAST-NAME-A5         PIC XX.
000092
000093     12  CM-INSURED-PROFILE-DATA.
000094         16  CM-INSURED-FIRST-NAME.
000095             20  CM-INSURED-1ST-INIT       PIC X.
000096             20  FILLER                    PIC X(9).
000097         16  CM-INSURED-ISSUE-AGE          PIC 99.
000098         16  CM-INSURED-SEX                PIC X.
000099             88  CM-SEX-MALE                  VALUE 'M'.
000100             88  CM-SEX-FEMAL                 VALUE 'F'.
000101         16  CM-INSURED-JOINT-AGE          PIC 99.
000102         16  CM-JOINT-INSURED-NAME.
000103             20  CM-JT-LAST-NAME           PIC X(15).
000104             20  CM-JT-FIRST-NAME.
000105                 24  CM-JT-1ST-INIT        PIC X.
000106                 24  FILLER                PIC X(9).
000107             20  CM-JT-INITIAL             PIC X.
000108
000109     12  CM-LIFE-DATA.
000110         16  CM-LF-BENEFIT-CD              PIC XX.
000111         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
000112         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
000113         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
000114         16  CM-LF-DEV-CODE                PIC XXX.
000115         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
000116         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
000117         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
000118         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
000119         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
000120         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
000121         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
000122         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
000123         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
000124         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
000125         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
000126         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
000127         16  cm-temp-epiq                  pic xx.
000128             88  EPIQ-CLASS                  value 'EQ'.
000129*        16  FILLER                        PIC XX.
000130
000131     12  CM-AH-DATA.
000132         16  CM-AH-BENEFIT-CD              PIC XX.
000133         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
000134         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
000135         16  CM-AH-DEV-CODE                PIC XXX.
000136         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
000137         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
000138         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
000139         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
000140         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
000141         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
000142         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
000143         16  CM-AH-PAID-THRU-DT            PIC XX.
000144             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
000145         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
000146         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
000147         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
000148         16  FILLER                        PIC X.
000149
000150     12  CM-LOAN-INFORMATION.
000151         16  CM-LIVES                      PIC S9(7)     COMP-3.
000152         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
000153                                           PIC S9(5)V99  COMP-3.
000154         16  CM-BILLED                     PIC S9(7)     COMP-3.
000155         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
000156         16  CM-PAY-FREQUENCY              PIC S99.
000157         16  CM-LOAN-TERM                  PIC S999      COMP-3.
000158         16  CM-RATE-CLASS                 PIC XX.
000159         16  CM-BENEFICIARY                PIC X(25).
000160         16  CM-POLICY-FORM-NO             PIC X(12).
000161         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
000162         16  CM-LAST-ADD-ON-DT             PIC XX.
000163         16  CM-DEDUCTIBLE-AMOUNTS.
000164             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
000165             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
000166         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
000167             20  CM-RESIDENT-STATE         PIC XX.
000168             20  CM-RATE-CODE              PIC X(4).
000169             20  FILLER                    PIC XX.
000170         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
000171             20  CM-LOAN-OFFICER           PIC X(5).
000172             20  FILLER                    PIC XXX.
000173         16  CM-CSR-CODE                   PIC XXX.
000174         16  CM-UNDERWRITING-CODE          PIC X.
000175             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
000176         16  CM-POST-CARD-IND              PIC X.
000177         16  CM-REF-INTERFACE-SW           PIC X.
000178         16  CM-PREMIUM-TYPE               PIC X.
000179             88  CM-SING-PRM                  VALUE '1'.
000180             88  CM-O-B-COVERAGE              VALUE '2'.
000181             88  CM-OPEN-END                  VALUE '3'.
000182         16  CM-IND-GRP-TYPE               PIC X.
000183             88  CM-INDIVIDUAL                VALUE 'I'.
000184             88  CM-GROUP                     VALUE 'G'.
000185         16  CM-SKIP-CODE                  PIC X.
000186             88  NO-MONTHS-SKIPPED            VALUE SPACE.
000187             88  SKIP-JULY                    VALUE '1'.
000188             88  SKIP-AUGUST                  VALUE '2'.
000189             88  SKIP-SEPTEMBER               VALUE '3'.
000190             88  SKIP-JULY-AUG                VALUE '4'.
000191             88  SKIP-AUG-SEPT                VALUE '5'.
000192             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
000193             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
000194             88  SKIP-JUNE                    VALUE '8'.
000195             88  SKIP-JUNE-JULY               VALUE '9'.
000196             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
000197             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
000198         16  CM-PAYMENT-MODE               PIC X.
000199             88  PAY-MONTHLY                  VALUE SPACE.
000200             88  PAY-WEEKLY                   VALUE '1'.
000201             88  PAY-SEMI-MONTHLY             VALUE '2'.
000202             88  PAY-BI-WEEKLY                VALUE '3'.
000203             88  PAY-SEMI-ANUALLY             VALUE '4'.
000204         16  CM-LOAN-NUMBER                PIC X(8).
000205         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
000206         16  CM-OLD-LOF                    PIC XXX.
000207*        16  CM-LOAN-OFFICER               PIC XXX.
000208         16  CM-REIN-TABLE                 PIC XXX.
000209         16  CM-SPECIAL-REIN-CODE          PIC X.
000210         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
000211         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
000212         16  CM-LOAN-1ST-PMT-DT            PIC XX.
000213
000214     12  CM-STATUS-DATA.
000215         16  CM-ENTRY-STATUS               PIC X.
000216         16  CM-ENTRY-DT                   PIC XX.
000217
000218         16  CM-LF-STATUS-AT-CANCEL        PIC X.
000219         16  CM-LF-CANCEL-DT               PIC XX.
000220         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
000221
000222         16  CM-LF-STATUS-AT-DEATH         PIC X.
000223         16  CM-LF-DEATH-DT                PIC XX.
000224         16  CM-LF-DEATH-EXIT-DT           PIC XX.
000225
000226         16  CM-LF-CURRENT-STATUS          PIC X.
000227             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
000228                                                'M' '4' '5' '9'.
000229             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
000230             88  CM-LF-POLICY-PENDING         VALUE '2'.
000231             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
000232             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
000233             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
000234             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
000235             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
000236             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
000237             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
000238             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
000239             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
000240             88  CM-LF-DECLINED               VALUE 'D'.
000241             88  CM-LF-VOIDED                 VALUE 'V'.
000242
000243         16  CM-AH-STATUS-AT-CANCEL        PIC X.
000244         16  CM-AH-CANCEL-DT               PIC XX.
000245         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
000246
000247         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
000248         16  CM-AH-SETTLEMENT-DT           PIC XX.
000249         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
000250
000251         16  CM-AH-CURRENT-STATUS          PIC X.
000252             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
000253                                                'M' '4' '5' '9'.
000254             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
000255             88  CM-AH-POLICY-PENDING         VALUE '2'.
000256             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
000257             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
000258             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
000259             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
000260             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
000261             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
000262             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
000263             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
000264             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
000265             88  CM-AH-DECLINED               VALUE 'D'.
000266             88  CM-AH-VOIDED                 VALUE 'V'.
000267
000268         16  CM-CLAIM-INTERFACE-SW         PIC X.
000269             88  NO-CLAIM-ATTACHED            VALUE SPACE.
000270             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
000271             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
000272         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
000273
000274         16  CM-ENTRY-BATCH                PIC X(6).
000275         16  CM-LF-EXIT-BATCH              PIC X(6).
000276         16  CM-AH-EXIT-BATCH              PIC X(6).
000277         16  CM-LAST-MONTH-END             PIC XX.
000278
000279     12  CM-NOTE-SW                        PIC X.
000280         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
000281         88  CERT-NOTES-PRESENT               VALUE '1'.
000282         88  BILLING-NOTES-PRESENT            VALUE '2'.
000283         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
000284         88  CLAIM-NOTES-PRESENT              VALUE '4'.
000285         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
000286         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
000287         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
000288     12  CM-COMP-EXCP-SW                   PIC X.
000289         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
000290         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
000291     12  CM-INSURED-ADDRESS-SW             PIC X.
000292         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
000293         88  INSURED-ADDR-PRESENT             VALUE '1'.
000294
000295*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
000296     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
000297     12  FILLER                            PIC X.
000298
000299*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
000300     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
000301     12  FILLER                            PIC X.
000302*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
000303     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
000304
000305     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
000306         88  CERT-ADDED-BATCH                 VALUE ' '.
000307         88  CERT-ADDED-ONLINE                VALUE '1'.
000308         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
000309         88  CERT-PURGED-OFFLINE              VALUE '3'.
000310         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
000311     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
000312         88  CERT-AS-LOADED                   VALUE ' '.
000313         88  CERT-CANCELLED-ONLINE            VALUE '1'.
000314         88  CERT-CLAIM-ONLINE                VALUE '2'.
000315         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
000316         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
000317         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
000318         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
000319         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
000320
000321     12  CM-ACCOUNT-COMM-PCTS.
000322         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
000323         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
000324
000325     12  CM-USER-FIELD                     PIC X.
000326     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
000327     12  CM-CLP-STATE                      PIC XX.
000328     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
000329     12  CM-USER-RESERVED                  PIC XXX.
000330     12  FILLER REDEFINES CM-USER-RESERVED.
000331         16  CM-AH-CLASS-CD                PIC XX.
000332         16  F                             PIC X.
000333******************************************************************
      *<<((file: ELCCERT))
000341     EJECT
000342*    COPY ERCMAIL.
      *>>((file: ERCMAIL))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCMAIL                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.003                          *
000007*                                                                *
000008*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
000009*                                                                *
000010*   FILE TYPE = VSAM,KSDS                                        *
000011*   RECORD SIZE = 374   RECFORM = FIX                            *
000012*                                                                *
000013*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
000014*   ALTERNATE PATH    = NOT USED                                 *
000015*                                                                *
000016*   LOG = YES                                                    *
000017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000018******************************************************************
000019*                   C H A N G E   L O G
000020*
000021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000022*-----------------------------------------------------------------
000023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000024* EFFECTIVE    NUMBER
000025*-----------------------------------------------------------------
000026* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
000027* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
000028* 111108                   PEMA  ADD CRED BENE ADDR2
000029******************************************************************
000030
000031 01  MAILING-DATA.
000032     12  MA-RECORD-ID                      PIC XX.
000033         88  VALID-MA-ID                       VALUE 'MA'.
000034
000035     12  MA-CONTROL-PRIMARY.
000036         16  MA-COMPANY-CD                 PIC X.
000037         16  MA-CARRIER                    PIC X.
000038         16  MA-GROUPING.
000039             20  MA-GROUPING-PREFIX        PIC XXX.
000040             20  MA-GROUPING-PRIME         PIC XXX.
000041         16  MA-STATE                      PIC XX.
000042         16  MA-ACCOUNT.
000043             20  MA-ACCOUNT-PREFIX         PIC X(4).
000044             20  MA-ACCOUNT-PRIME          PIC X(6).
000045         16  MA-CERT-EFF-DT                PIC XX.
000046         16  MA-CERT-NO.
000047             20  MA-CERT-PRIME             PIC X(10).
000048             20  MA-CERT-SFX               PIC X.
000049
000050     12  FILLER                            PIC XX.
000051
000052     12  MA-ACCESS-CONTROL.
000053         16  MA-SOURCE-SYSTEM              PIC XX.
000054             88  MA-FROM-CREDIT                VALUE 'CR'.
000055             88  MA-FROM-VSI                   VALUE 'VS'.
000056             88  MA-FROM-WARRANTY              VALUE 'WA'.
000057             88  MA-FROM-OTHER                 VALUE 'OT'.
000058         16  MA-RECORD-ADD-DT              PIC XX.
000059         16  MA-RECORD-ADDED-BY            PIC XXXX.
000060         16  MA-LAST-MAINT-DT              PIC XX.
000061         16  MA-LAST-MAINT-BY              PIC XXXX.
000062         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
000063
000064     12  MA-PROFILE-INFO.
000065         16  MA-QUALIFY-CODE-1             PIC XX.
000066         16  MA-QUALIFY-CODE-2             PIC XX.
000067         16  MA-QUALIFY-CODE-3             PIC XX.
000068         16  MA-QUALIFY-CODE-4             PIC XX.
000069         16  MA-QUALIFY-CODE-5             PIC XX.
000070
000071         16  MA-INSURED-LAST-NAME          PIC X(15).
000072         16  MA-INSURED-FIRST-NAME         PIC X(10).
000073         16  MA-INSURED-MIDDLE-INIT        PIC X.
000074         16  MA-INSURED-ISSUE-AGE          PIC 99.
000075         16  MA-INSURED-BIRTH-DT           PIC XX.
000076         16  MA-INSURED-SEX                PIC X.
000077             88  MA-SEX-MALE                   VALUE 'M'.
000078             88  MA-SEX-FEMALE                 VALUE 'F'.
000079         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
000080
000081         16  MA-ADDRESS-CORRECTED          PIC X.
000082         16  MA-JOINT-BIRTH-DT             PIC XX.
000083*        16  FILLER                        PIC X(12).
000084
000085         16  MA-ADDRESS-LINE-1             PIC X(30).
000086         16  MA-ADDRESS-LINE-2             PIC X(30).
000087         16  MA-CITY-STATE.
000088             20  MA-CITY                   PIC X(28).
000089             20  MA-ADDR-STATE             PIC XX.
000090         16  MA-ZIP.
000091             20  MA-ZIP-CODE.
000092                 24  MA-ZIP-CODE-1ST       PIC X(1).
000093                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
000094                 24  FILLER                PIC X(4).
000095             20  MA-ZIP-PLUS4              PIC X(4).
000096         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
000097             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
000098             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
000099             20  FILLER                    PIC X(3).
000100
000101         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
000102
000103         16  FILLER                        PIC XXX.
000104*        16  FILLER                        PIC X(10).
000105
000106
000107     12  MA-CRED-BENE-INFO.
000108         16  MA-CRED-BENE-NAME                 PIC X(25).
000109         16  MA-CRED-BENE-ADDR                 PIC X(30).
000110         16  MA-CRED-BENE-ADDR2                PIC X(30).
000111         16  MA-CRED-BENE-CTYST.
000112             20  MA-CRED-BENE-CITY             PIC X(28).
000113             20  MA-CRED-BENE-STATE            PIC XX.
000114         16  MA-CRED-BENE-ZIP.
000115             20  MA-CB-ZIP-CODE.
000116                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
000117                     88  MA-CB-CANADIAN-POST-CODE
000118                                           VALUE 'A' THRU 'Z'.
000119                 24  FILLER                    PIC X(4).
000120             20  MA-CB-ZIP-PLUS4               PIC X(4).
000121         16  MA-CB-CANADIAN-POSTAL-CODE
000122                            REDEFINES MA-CRED-BENE-ZIP.
000123             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
000124             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
000125             20  FILLER                        PIC X(3).
000126     12  MA-POST-CARD-MAIL-DATA.
000127         16  MA-MAIL-DATA OCCURS 7.
000128             20  MA-MAIL-TYPE              PIC X.
000129                 88  MA-12MO-MAILING           VALUE '1'.
000130                 88  MA-EXP-MAILING            VALUE '2'.
000131             20  MA-MAIL-STATUS            PIC X.
000132                 88  MA-MAIL-ST-MAILED         VALUE '1'.
000133                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
000134                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
000135             20  MA-MAIL-DATE              PIC XX.
000136     12  FILLER                            PIC XX.
000137     12  FILLER                            PIC XX.
000138*    12  FILLER                            PIC X(30).
000139******************************************************************
      *<<((file: ERCMAIL))
000343     EJECT
000344*    COPY ERCPNDM.
      *>>((file: ERCPNDM))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCPNDM                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.003                          *
000007*                                                                *
000008*   FILE DESCRIPTION = PENDING MAILING DATA                      *
000009*                                                                *
000010*   FILE TYPE = VSAM,KSDS                                        *
000011*   RECORD SIZE = 374   RECFORM = FIX                            *
000012*                                                                *
000013*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
000014*   ALTERNATE PATH    = NOT USED                                 *
000015*                                                                *
000016*   LOG = YES                                                    *
000017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000018******************************************************************
000019*                   C H A N G E   L O G
000020*
000021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000022*-----------------------------------------------------------------
000023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000024* EFFECTIVE    NUMBER
000025*-----------------------------------------------------------------
000026* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
000027* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
000028* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
000029* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
000030******************************************************************
000031
000032 01  PENDING-MAILING-DATA.
000033     12  PM-RECORD-ID                      PIC XX.
000034         88  VALID-MA-ID                       VALUE 'PM'.
000035
000036     12  PM-CONTROL-PRIMARY.
000037         16  PM-COMPANY-CD                 PIC X.
000038         16  PM-ENTRY-BATCH                PIC X(6).
000039         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
000040         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
000041
000042     12  FILLER                            PIC X(14).
000043
000044     12  PM-ACCESS-CONTROL.
000045         16  PM-SOURCE-SYSTEM              PIC XX.
000046             88  PM-FROM-CREDIT                VALUE 'CR'.
000047             88  PM-FROM-VSI                   VALUE 'VS'.
000048             88  PM-FROM-WARRANTY              VALUE 'WA'.
000049             88  PM-FROM-OTHER                 VALUE 'OT'.
000050         16  PM-RECORD-ADD-DT              PIC XX.
000051         16  PM-RECORD-ADDED-BY            PIC XXXX.
000052         16  PM-LAST-MAINT-DT              PIC XX.
000053         16  PM-LAST-MAINT-BY              PIC XXXX.
000054         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
000055
000056     12  PM-PROFILE-INFO.
000057         16  PM-QUALIFY-CODE-1             PIC XX.
000058         16  PM-QUALIFY-CODE-2             PIC XX.
000059         16  PM-QUALIFY-CODE-3             PIC XX.
000060         16  PM-QUALIFY-CODE-4             PIC XX.
000061         16  PM-QUALIFY-CODE-5             PIC XX.
000062
000063         16  PM-INSURED-LAST-NAME          PIC X(15).
000064         16  PM-INSURED-FIRST-NAME         PIC X(10).
000065         16  PM-INSURED-MIDDLE-INIT        PIC X.
000066         16  PM-INSURED-ISSUE-AGE          PIC 99.
000067         16  PM-INSURED-BIRTH-DT           PIC XX.
000068         16  PM-INSURED-SEX                PIC X.
000069             88  PM-SEX-MALE                   VALUE 'M'.
000070             88  PM-SEX-FEMALE                 VALUE 'F'.
000071         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
000072
000073         16  PM-ADDRESS-CORRECTED          PIC X.
000074         16  PM-JOINT-BIRTH-DT             PIC XX.
000075*        16  FILLER                        PIC X(12).
000076
000077         16  PM-ADDRESS-LINE-1             PIC X(30).
000078         16  PM-ADDRESS-LINE-2             PIC X(30).
000079         16  PM-CITY-STATE.
000080             20  PM-CITY                   PIC X(28).
000081             20  PM-STATE                  PIC XX.
000082         16  PM-ZIP.
000083             20  PM-ZIP-CODE.
000084                 24  PM-ZIP-1              PIC X.
000085                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
000086                 24  FILLER                PIC X(4).
000087             20  PM-ZIP-PLUS4              PIC X(4).
000088         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
000089             20  PM-CAN-POST1              PIC XXX.
000090             20  PM-CAN-POST2              PIC XXX.
000091             20  FILLER                    PIC XXX.
000092
000093         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
000094         16  pm-city-st-zip-verified       pic x.
000095         16  FILLER                        PIC XX.
000096
000097     12  PM-CRED-BENE-INFO.
000098         16  PM-CRED-BENE-NAME             PIC X(25).
000099         16  PM-CRED-BENE-ADDR             PIC X(30).
000100         16  PM-CRED-BENE-ADDR2            PIC X(30).
000101         16  PM-CRED-BENE-CTYST.
000102             20  PM-CRED-BENE-CITY         PIC X(28).
000103             20  PM-CRED-BENE-STATE        PIC XX.
000104         16  PM-CRED-BENE-ZIP.
000105             20  PM-CB-ZIP-CODE.
000106                 24  PM-CB-ZIP-1           PIC X.
000107                     88  PM-CB-CANADIAN-POST-CODE
000108                                  VALUE 'A' THRU 'Z'.
000109                 24  FILLER                PIC X(4).
000110             20  PM-CB-ZIP-PLUS4           PIC X(4).
000111         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
000112             20  PM-CB-CAN-POST1           PIC XXX.
000113             20  PM-CB-CAN-POST2           PIC XXX.
000114             20  FILLER                    PIC XXX.
000115     12  PM-POST-CARD-MAIL-DATA.
000116         16  PM-MAIL-DATA OCCURS 7.
000117             20  PM-MAIL-TYPE              PIC X.
000118                 88  PM-12MO-MAILING           VALUE '1'.
000119                 88  PM-EXP-MAILING            VALUE '2'.
000120             20  PM-MAIL-STATUS            PIC X.
000121                 88  PM-MAIL-ST-MAILED         VALUE '1'.
000122                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
000123                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
000124             20  PM-MAIL-DATE              PIC XX.
000125     12  FILLER                            PIC XX.
000126     12  FILLER                            PIC X(12).
000127*    12  FILLER                            PIC X(30).
000128
000129******************************************************************
      *<<((file: ERCPNDM))
000345*                                COPY ERCLOFC.
      *>>((file: ERCLOFC))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCLOFC                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.003                          *
000007*                                                                *
000008*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
000009*                                                                *
000010*   FILE TYPE = VSAM,KSDS                                        *
000011*   RECORD SIZE = 670   RECFORM = FIX                            *
000012*                                                                *
000013*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
000014*                                                                *
000015*   LOG = YES                                                    *
000016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000017*                                                                *
000018******************************************************************
000019
000020 01  LOAN-OFFICER-MASTER.
000021     12  LO-RECORD-ID                PIC XX.
000022         88  VALID-LO-ID                VALUE 'LO'.
000023
000024     12  LO-CONTROL-PRIMARY.
000025         16  LO-COMPANY-CD           PIC X.
000026         16  LO-CARRIER              PIC X.
000027         16  LO-GROUPING.
000028             20  LO-GROUPING-PREFIX  PIC XXX.
000029             20  LO-GROUPING-PRIME   PIC XXX.
000030         16  LO-STATE                PIC XX.
000031         16  LO-ACCOUNT.
000032             20  LO-ACCOUNT-PREFIX   PIC X(4).
000033             20  LO-ACCOUNT-PRIME    PIC X(6).
000034         16  LO-OFFICER-CODE         PIC X(5).
000035
000036     12  LO-OFFICER-NAME             PIC X(30).
000037
000038     12  LO-LAST-MAINT-DT            PIC XX.
000039     12  LO-LAST-USER                PIC X(4).
000040     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
000041
000042     12  LO-COMP-CONTROL             PIC X.
000043             88  LO-SHOW-COMP           VALUE 'Y'.
000044             88  LO-SUPPRESS-COMP       VALUE 'N'.
000045     12  LO-DETAIL-CONTROL           PIC X.
000046             88  LO-PRINT-DETAIL        VALUE 'D'.
000047             88  LO-PRINT-SUMMARY       VALUE 'S'.
000048
000049     12  LO-SV-CARRIER               PIC X.
000050     12  LO-SV-GROUPING              PIC X(6).
000051     12  LO-SV-STATE                 PIC XX.
000052
000053     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
000054     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
000055
000056     12  LO-OFFICER-INFO.
000057         16  FILLER OCCURS 12 TIMES.
000058             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
000059             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
000060             20  LO-LF-COUNT         PIC S9(5) COMP-3.
000061             20  LO-LF-PREM          PIC S9(7) COMP-3.
000062             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
000063             20  LO-AH-COUNT         PIC S9(5) COMP-3.
000064             20  LO-AH-PREM          PIC S9(7) COMP-3.
000065             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
000066     12  FILLER                      PIC X(198).
000067******************************************************************
      *<<((file: ERCLOFC))
000346*                                COPY ERCPDEF.
      *>>((file: ERCPDEF))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCPDEF.                            *
000005*                                                                *
000006*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
000007*                                                                *
000008*    FILE TYPE = VSAM,KSDS                                       *
000009*    RECORD SIZE = 1319 RECFORM = FIXED                          *
000010*                                                                *
000011*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
000012*                                                                *
000013*    LOG = YES                                                   *
000014*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000015******************************************************************
000016*                   C H A N G E   L O G
000017*
000018* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000019*-----------------------------------------------------------------
000020*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000021* EFFECTIVE    NUMBER
000022*-----------------------------------------------------------------
000023* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
000024* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
000025* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
000026* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
000027******************************************************************
000028 01  PRODUCT-MASTER.
000029    12  PD-RECORD-ID                 PIC X(02).
000030        88  VALID-PD-ID                  VALUE 'PD'.
000031
000032    12  PD-CONTROL-PRIMARY.
000033        16  PD-COMPANY-CD            PIC X.
000034        16  PD-STATE                 PIC XX.
000035        16  PD-PRODUCT-CD            PIC XXX.
000036        16  PD-FILLER                PIC X(7).
000037        16  PD-BEN-TYPE              PIC X.
000038        16  PD-BEN-CODE              PIC XX.
000039        16  PD-PROD-EXP-DT           PIC XX.
000040
000041    12  FILLER                       PIC X(50).
000042
000043    12  PD-PRODUCT-DATA OCCURS 8.
000044        16  PD-PROD-CODE             PIC X.
000045            88  PD-PROD-LIFE           VALUE 'L'.
000046            88  PD-PROD-PROP           VALUE 'P'.
000047            88  PD-PROD-AH             VALUE 'A'.
000048            88  PD-PROD-IU             VALUE 'I'.
000049            88  PD-PROD-GAP            VALUE 'G'.
000050            88  PD-PROD-FAML           VALUE 'F'.
000051            88  PD-PROD-OTH            VALUE 'O'.
000052        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
000053        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
000054        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
000055        16  PD-MAX-TERM              PIC S999        COMP-3.
000056        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
000057        16  FILLER                   PIC X.
000058        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
000059        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
000060        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
000061        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
000062        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
000063        16  PD-REC-CRIT-PERIOD       PIC 99.
000064        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
000065            20  PD-RECURRING-YN      PIC X.
000066            20  FILLER               PIC X.
000067        16  PD-RTW-MOS               PIC 99.
000068        16  PD-MAX-EXTENSION         PIC 99.
000069        16  pd-ben-pct               pic sv999 comp-3.
000070*       16  FILLER                   PIC XX.
000071
000072    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
000073
000074    12  PD-TERM-LIMITS OCCURS 15.
000075        16  PD-LOW-TERM              PIC S999        COMP-3.
000076        16  PD-HI-TERM               PIC S999        COMP-3.
000077
000078*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
000079    12  PD-LOAN-AMT-LIMITS OCCURS 15.
000080        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
000081        16  PD-HI-AMT                PIC S9(7)       COMP-3.
000082
000083    12  PD-EARN-FACTORS.
000084        16  FILLER OCCURS 15.
000085            20  FILLER OCCURS 15.
000086                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
000087
000088    12  PD-PRODUCT-DESC              PIC X(80).
000089    12  PD-TRUNCATED                 PIC X.
000090    12  FILLER                       PIC X(59).
000091
000092    12  PD-MAINT-INFORMATION.
000093        16  PD-LAST-MAINT-DT         PIC X(02).
000094        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
000095        16  PD-LAST-MAINT-BY         PIC X(04).
      *<<((file: ERCPDEF))
000347*                                COPY ELCSTATE.
      *>>((file: ELCSTATE))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCSTATE.                           *
000005*                                                                *
000006*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
000007*                                                                *
000008*   FILE TYPE = VSAM,KSDS                                        *
000009*   RECORD SIZE = 250  RECFORM = FIXED                           *
000010*                                                                *
000011*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
000012*       ALTERNATE INDEX = NONE                                   *
000013*                                                                *
000014*   LOG = YES                                                    *
000015*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000016******************************************************************
000017*                   C H A N G E   L O G
000018*
000019* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000020*-----------------------------------------------------------------
000021*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000022* EFFECTIVE    NUMBER
000023*-----------------------------------------------------------------
000024* 122710  CR2010012700001  PEMA  NEW COPYBOOK
000025******************************************************************
000026*
000027 01  STATE-FILE.
000028     12  SF-RECORD-ID                       PIC XX.
000029         88  VALID-CF-ID                        VALUE 'SF'.
000030
000031     12  SF-CONTROL-PRIMARY.
000032         16  SF-COMPANY-ID                  PIC XXX.
000033         16  SF-CARRIER-CODE                PIC X.
000034         16  SF-GROUPING                    PIC X(6).
000035         16  SF-STATE-CODE                  PIC XX.
000036         16  SF-EXPIRE-DATE                 PIC 9(8).
000037
000038****************************************************************
000039*             STATE CONTROLS
000040****************************************************************
000041
000042     12  SF-LAST-MAINT-DT                   PIC XX.
000043     12  SF-LAST-MAINT-BY                   PIC X(4).
000044     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
000045
000046     12  SF-STATE-RT-CONTROLS.
000047         16  SF-ST-RT-CALC                  PIC X.
000048
000049     12  SF-ST-TAX-CONTROLS.
000050         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
000051         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
000052         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
000053
000054     12  SF-ST-REFUND-OPTIONS.
000055         16  SF-ST-RF-LR-CALC               PIC X.
000056         16  SF-ST-RF-LL-CALC               PIC X.
000057         16  SF-ST-RF-LN-CALC               PIC X.
000058         16  SF-ST-RF-AH-CALC               PIC X.
000059         16  SF-ST-RF-CP-CALC               PIC X.
000060
000061     12  SF-ST-UNEARN-PREM-OPTIONS.
000062         16  SF-ST-LUEP-R78                 PIC X.
000063         16  SF-ST-LUEP-PRO                 PIC X.
000064         16  SF-ST-LUEP-ST                  PIC X.
000065         16  SF-ST-LUEP-DOM                 PIC X.
000066         16  SF-ST-AUEP-R78                 PIC X.
000067         16  SF-ST-AUEP-PRO                 PIC X.
000068         16  SF-ST-AUEP-ST                  PIC X.
000069         16  SF-ST-AUEP-DOM                 PIC X.
000070         16  SF-ST-CUEP-R78                 PIC X.
000071         16  SF-ST-CUEP-PRO                 PIC X.
000072         16  SF-ST-CUEP-ST                  PIC X.
000073         16  SF-ST-CUEP-DOM                 PIC X.
000074
000075     12  SF-ST-EARN-PREM-OPTIONS.
000076         16  SF-ST-LEP-R78                  PIC X.
000077         16  SF-ST-LEP-PRO                  PIC X.
000078         16  SF-ST-LEP-ST                   PIC X.
000079         16  SF-ST-LEP-DOM                  PIC X.
000080         16  SF-ST-AEP-R78                  PIC X.
000081         16  SF-ST-AEP-PRO                  PIC X.
000082         16  SF-ST-AEP-ST                   PIC X.
000083         16  SF-ST-AEP-DOM                  PIC X.
000084         16  SF-ST-CEP-R78                  PIC X.
000085         16  SF-ST-CEP-PRO                  PIC X.
000086         16  SF-ST-CEP-ST                   PIC X.
000087         16  SF-ST-CEP-DOM                  PIC X.
000088
000089     12  SF-FOR-FUTURE-USE                  PIC X(179).
      *<<((file: ELCSTATE))
000348     EJECT
000349*    COPY ELCCRTT.
      *>>((file: ELCCRTT))
000001******************************************************************
000002*                                                                *
000003*                            ELCCRTT.                            *
000004*                                                                *
000005*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
000006*                                                                *
000007*   FILE TYPE = VSAM,KSDS                                        *
000008*   RECORD SIZE = 552  RECFORM = FIXED                           *
000009*                                                                *
000010*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
000011*                                                                *
000012*   LOG = YES                                                    *
000013*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000014******************************************************************
000015*                   C H A N G E   L O G
000016*
000017* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000018*-----------------------------------------------------------------
000019*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000020* EFFECTIVE    NUMBER
000021*-----------------------------------------------------------------
000022* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
000023* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
000024* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
000025* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
000026* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
000027* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
000028* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
000029* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
000030* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
000031* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
000032* 091318  CR2018073000001  PEMA  ADD Refund methods
000033* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
000034******************************************************************
000035
000036 01  CERTIFICATE-TRAILERS.
000037     12  CS-RECORD-ID                      PIC XX.
000038         88  VALID-CS-ID                      VALUE 'CS'.
000039
000040     12  CS-CONTROL-PRIMARY.
000041         16  CS-COMPANY-CD                 PIC X.
000042         16  CS-CARRIER                    PIC X.
000043         16  CS-GROUPING                   PIC X(6).
000044         16  CS-STATE                      PIC XX.
000045         16  CS-ACCOUNT                    PIC X(10).
000046         16  CS-CERT-EFF-DT                PIC XX.
000047         16  CS-CERT-NO.
000048             20  CS-CERT-PRIME             PIC X(10).
000049             20  CS-CERT-SFX               PIC X.
000050         16  CS-TRAILER-TYPE               PIC X.
000051             88  COMM-TRLR           VALUE 'A'.
000052             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
000053             88  CERT-DATA-TRLR      VALUE 'C'.
000054
000055     12  CS-DATA-AREA                      PIC X(516).
000056
000057     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
000058         16  CS-BANK-COMMISSION-AREA.
000059             20  CS-BANK-COMMS       OCCURS 10.
000060                 24  CS-AGT                PIC X(10).
000061                 24  CS-COM-TYP            PIC X.
000062                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
000063                 24  CS-RECALC-LV-INDIC    PIC X.
000064                 24  FILLER                PIC X(10).
000065
000066         16  FILLER                        PIC X(256).
000067
000068     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
000069****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
000070
000071         16  CS-MB-CLAIM-DATA OCCURS 24.
000072             20  CS-CLAIM-NO               PIC X(7).
000073             20  CS-CLAIM-TYPE             PIC X.
000074                 88  CS-AH-CLM               VALUE 'A'.
000075                 88  CS-IU-CLM               VALUE 'I'.
000076                 88  CS-GP-CLM               VALUE 'G'.
000077                 88  CS-LF-CLM               VALUE 'L'.
000078                 88  CS-PR-CLM               VALUE 'P'.
000079                 88  CS-FL-CLM               VALUE 'F'.
000080                 88  CS-OT-CLM               VALUE 'O'.
000081             20  CS-INSURED-TYPE           PIC X.
000082                 88  CS-PRIM-INSURED          VALUE 'P'.
000083                 88  CS-CO-BORROWER           VALUE 'C'.
000084             20  CS-BENEFIT-PERIOD         PIC 99.
000085             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
000086             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
000087             20  CS-REMAINING-BENS         PIC S999 COMP-3.
000088         16  FILLER                        PIC X(12).
000089
000090     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
000091         16  CS-VIN-NUMBER                 PIC X(17).
000092         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
000093         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
000094         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
000095         16  cs-agent-name.
000096             20  cs-agent-fname            pic x(20).
000097             20  cs-agent-mi               pic x.
000098             20  cs-agent-lname            pic x(25).
000099         16  cs-license-no                 pic x(15).
000100         16  cs-npn-number                 pic x(10).
000101         16  cs-agent-edit-status          pic x.
000102             88  cs-ae-refer-to-manager      value 'M'.
000103             88  cs-ae-cover-sheet           value 'C'.
000104             88  cs-ae-sig-form              value 'S'.
000105             88  cs-ae-verified              value 'V'.
000106             88  cs-unidentified-signature   value 'U'.
000107             88  cs-cert-returned            value 'R'.
000108             88  cs-accept-no-commission     value 'N'.
000109         16  cs-year                       pic 9999.
000110         16  cs-make                       pic x(20).
000111         16  cs-model                      pic x(20).
000112         16  cs-future                     pic x(20).
000113         16  cs-vehicle-odometer           pic s9(7) comp-3.
000114         16  cs-claim-verification-status  pic x.
000115             88  cs-clm-ver-eligible         value 'A'.
000116             88  cs-clm-ver-partial-elig     value 'B'.
000117             88  cs-clm-ver-not-eligible     value 'C'.
000118             88  cs-clm-ver-not-elig-opn-clm value 'D'.
000119             88  cs-clm-ver-not-part-elig-rw value 'E'.
000120             88  cs-clm-ver-ND-CERT          value 'F'.
000121             88  cs-clm-ver-spec-other       value 'G'.
000122             88  cs-clam-ver-pratial-corrected
000123                                             value 'H'.
000124             88  cs-clm-ver-no-matches       value 'I'.
000125             88  cs-clm-ver-not-elig-corrected
000126                                             value 'J'.
000127             88  cs-clm-ver-needs-review     value 'R'.
000128             88  cs-clm-ver-sent-to-claims   value 'W'.
000129         16  CS-LF-REFUND-METHOD           PIC X.
000130         16  CS-AH-REFUND-METHOD           PIC X.
000131         16  FILLER                        PIC X(353). *> was 420
000132*        16  FILLER                        PIC X(496).
      *<<((file: ELCCRTT))
000350*    COPY ELCCRTO.
      *>>((file: ELCCRTO))
000001******************************************************************
000002*                                                                *
000003*                            ELCCRTO.                            *
000004*                                                                *
000005*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
000006*                                                                *
000007*   FILE TYPE = VSAM,KSDS                                        *
000008*   RECORD SIZE = 524  RECFORM = FIXED                           *
000009*                                                                *
000010*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
000011*                                                                *
000012*   LOG = YES                                                    *
000013*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000014******************************************************************
000015*                   C H A N G E   L O G
000016*
000017* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000018*-----------------------------------------------------------------
000019*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000020* EFFECTIVE    NUMBER
000021*-----------------------------------------------------------------
000022* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
000023* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
000024* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
000025* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
000026* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
000027******************************************************************
000028
000029 01  ORIGINAL-CERTIFICATE.
000030     12  OC-RECORD-ID                      PIC XX.
000031         88  VALID-OC-ID                      VALUE 'OC'.
000032
000033     12  OC-CONTROL-PRIMARY.
000034         16  OC-COMPANY-CD                 PIC X.
000035         16  OC-CARRIER                    PIC X.
000036         16  OC-GROUPING                   PIC X(6).
000037         16  OC-STATE                      PIC XX.
000038         16  OC-ACCOUNT                    PIC X(10).
000039         16  OC-CERT-EFF-DT                PIC XX.
000040         16  OC-CERT-NO.
000041             20  OC-CERT-PRIME             PIC X(10).
000042             20  OC-CERT-SFX               PIC X.
000043         16  OC-RECORD-TYPE                PIC X.
000044         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
000045
000046     12  OC-LAST-MAINT-DT                  PIC XX.
000047     12  OC-LAST-MAINT-BY                  PIC X(4).
000048     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
000049
000050     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
000051     12  FILLER                            PIC X(49).
000052
000053     12  OC-ORIG-REC.
000054         16  OC-INS-LAST-NAME              PIC X(15).
000055         16  OC-INS-FIRST-NAME             PIC X(10).
000056         16  OC-INS-MIDDLE-INIT            PIC X.
000057         16  OC-INS-AGE                    PIC S999     COMP-3.
000058         16  OC-JNT-LAST-NAME              PIC X(15).
000059         16  OC-JNT-FIRST-NAME             PIC X(10).
000060         16  OC-JNT-MIDDLE-INIT            PIC X.
000061         16  OC-JNT-AGE                    PIC S999     COMP-3.
000062         16  OC-LF-BENCD                   PIC XX.
000063         16  OC-LF-TERM                    PIC S999      COMP-3.
000064         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
000065         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
000066         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
000067         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
000068         16  OC-LF-EXP-DT                  PIC XX.
000069         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
000070         16  OC-LF-CANCEL-DT               PIC XX.
000071         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
000072         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
000073         16  OC-AH-BENCD                   PIC XX.
000074         16  OC-AH-TERM                    PIC S999      COMP-3.
000075         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
000076         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
000077         16  OC-AH-EXP-DT                  PIC XX.
000078         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
000079         16  OC-AH-CP                      PIC 99.
000080         16  OC-AH-CANCEL-DT               PIC XX.
000081         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
000082         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
000083         16  OC-CRED-BENE-NAME             PIC X(25).
000084         16  OC-1ST-PMT-DT                 PIC XX.
000085         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
000086         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
000087         16  OC-ISSUE-TRAN-IND             PIC X.
000088         16  OC-CANCEL-TRAN-IND            PIC X.
000089         16  FILLER                        PIC X(211).
000090
000091     12  FILLER                            PIC X(50).
000092
000093******************************************************************
      *<<((file: ELCCRTO))
000351
000352*    COPY ELCDATE.
      *>>((file: ELCDATE))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCDATE.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.003
000007*                                                                *
000008*                                                                *
000009*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
000010*                 LENGTH = 200                                   *
000011******************************************************************
000012
000013 01  DATE-CONVERSION-DATA.
000014     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
000015     12  DC-OPTION-CODE                PIC X.
000016         88  BIN-TO-GREG                VALUE ' '.
000017         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
000018         88  EDIT-GREG-TO-BIN           VALUE '2'.
000019         88  YMD-GREG-TO-BIN            VALUE '3'.
000020         88  MDY-GREG-TO-BIN            VALUE '4'.
000021         88  JULIAN-TO-BIN              VALUE '5'.
000022         88  BIN-PLUS-ELAPSED           VALUE '6'.
000023         88  FIND-CENTURY               VALUE '7'.
000024         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
000025         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
000026         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
000027         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
000028         88  JULIAN-TO-BIN-3            VALUE 'C'.
000029         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
000030         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
000031         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
000032         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
000033         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
000034         88  CHECK-LEAP-YEAR            VALUE 'H'.
000035         88  BIN-3-TO-GREG              VALUE 'I'.
000036         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
000037         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
000038         88  CYMD-GREG-TO-BIN           VALUE 'L'.
000039         88  MDCY-GREG-TO-BIN           VALUE 'M'.
000040         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
000041         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
000042         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
000043         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
000044         88  THREE-CHARACTER-BIN
000045                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
000046         88  GREGORIAN-TO-BIN
000047                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
000048         88  BIN-TO-GREGORIAN
000049                  VALUES ' ' '1' 'I' '8' 'G'.
000050         88  JULIAN-TO-BINARY
000051                  VALUES '5' 'C' 'E' 'F'.
000052     12  DC-ERROR-CODE                 PIC X.
000053         88  NO-CONVERSION-ERROR        VALUE ' '.
000054         88  DATE-CONVERSION-ERROR
000055                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
000056         88  DATE-IS-ZERO               VALUE '1'.
000057         88  DATE-IS-NON-NUMERIC        VALUE '2'.
000058         88  DATE-IS-INVALID            VALUE '3'.
000059         88  DATE1-GREATER-DATE2        VALUE '4'.
000060         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
000061         88  DATE-INVALID-OPTION        VALUE '9'.
000062         88  INVALID-CENTURY            VALUE 'A'.
000063         88  ONLY-CENTURY               VALUE 'B'.
000064         88  ONLY-LEAP-YEAR             VALUE 'C'.
000065         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
000066     12  DC-END-OF-MONTH               PIC X.
000067         88  CALCULATE-END-OF-MONTH     VALUE '1'.
000068     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
000069         88  USE-NORMAL-PROCESS         VALUE ' '.
000070         88  ADJUST-DOWN-100-YRS        VALUE '1'.
000071         88  ADJUST-UP-100-YRS          VALUE '2'.
000072     12  FILLER                        PIC X.
000073     12  DC-CONVERSION-DATES.
000074         16  DC-BIN-DATE-1             PIC XX.
000075         16  DC-BIN-DATE-2             PIC XX.
000076         16  DC-GREG-DATE-1-EDIT       PIC X(08).
000077         16  DC-GREG-DATE-1-EDIT-R REDEFINES
000078                       DC-GREG-DATE-1-EDIT.
000079             20  DC-EDIT1-MONTH        PIC 99.
000080             20  SLASH1-1              PIC X.
000081             20  DC-EDIT1-DAY          PIC 99.
000082             20  SLASH1-2              PIC X.
000083             20  DC-EDIT1-YEAR         PIC 99.
000084         16  DC-GREG-DATE-2-EDIT       PIC X(08).
000085         16  DC-GREG-DATE-2-EDIT-R REDEFINES
000086                     DC-GREG-DATE-2-EDIT.
000087             20  DC-EDIT2-MONTH        PIC 99.
000088             20  SLASH2-1              PIC X.
000089             20  DC-EDIT2-DAY          PIC 99.
000090             20  SLASH2-2              PIC X.
000091             20  DC-EDIT2-YEAR         PIC 99.
000092         16  DC-GREG-DATE-1-YMD        PIC 9(06).
000093         16  DC-GREG-DATE-1-YMD-R  REDEFINES
000094                     DC-GREG-DATE-1-YMD.
000095             20  DC-YMD-YEAR           PIC 99.
000096             20  DC-YMD-MONTH          PIC 99.
000097             20  DC-YMD-DAY            PIC 99.
000098         16  DC-GREG-DATE-1-MDY        PIC 9(06).
000099         16  DC-GREG-DATE-1-MDY-R REDEFINES
000100                      DC-GREG-DATE-1-MDY.
000101             20  DC-MDY-MONTH          PIC 99.
000102             20  DC-MDY-DAY            PIC 99.
000103             20  DC-MDY-YEAR           PIC 99.
000104         16  DC-GREG-DATE-1-ALPHA.
000105             20  DC-ALPHA-MONTH        PIC X(10).
000106             20  DC-ALPHA-DAY          PIC 99.
000107             20  FILLER                PIC XX.
000108             20  DC-ALPHA-CENTURY.
000109                 24 DC-ALPHA-CEN-N     PIC 99.
000110             20  DC-ALPHA-YEAR         PIC 99.
000111         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
000112         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
000113         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
000114         16  DC-JULIAN-DATE            PIC 9(05).
000115         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
000116                                       PIC 9(05).
000117         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
000118             20  DC-JULIAN-YEAR        PIC 99.
000119             20  DC-JULIAN-DAYS        PIC 999.
000120         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
000121         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
000122         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
000123     12  DATE-CONVERSION-VARIBLES.
000124         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
000125         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
000126             20  FILLER                PIC 9(3).
000127             20  HOLD-CEN-1-CCYY.
000128                 24  HOLD-CEN-1-CC     PIC 99.
000129                 24  HOLD-CEN-1-YY     PIC 99.
000130             20  HOLD-CEN-1-MO         PIC 99.
000131             20  HOLD-CEN-1-DA         PIC 99.
000132         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
000133             20  HOLD-CEN-1-R-MO       PIC 99.
000134             20  HOLD-CEN-1-R-DA       PIC 99.
000135             20  HOLD-CEN-1-R-CCYY.
000136                 24  HOLD-CEN-1-R-CC   PIC 99.
000137                 24  HOLD-CEN-1-R-YY   PIC 99.
000138             20  FILLER                PIC 9(3).
000139         16  HOLD-CENTURY-1-X.
000140             20  FILLER                PIC X(3)  VALUE SPACES.
000141             20  HOLD-CEN-1-X-CCYY.
000142                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
000143                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
000144             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
000145             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
000146         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
000147             20  HOLD-CEN-1-R-X-MO     PIC XX.
000148             20  HOLD-CEN-1-R-X-DA     PIC XX.
000149             20  HOLD-CEN-1-R-X-CCYY.
000150                 24  HOLD-CEN-1-R-X-CC PIC XX.
000151                 24  HOLD-CEN-1-R-X-YY PIC XX.
000152             20  FILLER                PIC XXX.
000153         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
000154         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
000155         16  DC-JULIAN-DATE-1          PIC 9(07).
000156         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
000157             20  DC-JULIAN-1-CCYY.
000158                 24  DC-JULIAN-1-CC    PIC 99.
000159                 24  DC-JULIAN-1-YR    PIC 99.
000160             20  DC-JULIAN-DA-1        PIC 999.
000161         16  DC-JULIAN-DATE-2          PIC 9(07).
000162         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
000163             20  DC-JULIAN-2-CCYY.
000164                 24  DC-JULIAN-2-CC    PIC 99.
000165                 24  DC-JULIAN-2-YR    PIC 99.
000166             20  DC-JULIAN-DA-2        PIC 999.
000167         16  DC-GREG-DATE-A-EDIT.
000168             20  DC-EDITA-MONTH        PIC 99.
000169             20  SLASHA-1              PIC X VALUE '/'.
000170             20  DC-EDITA-DAY          PIC 99.
000171             20  SLASHA-2              PIC X VALUE '/'.
000172             20  DC-EDITA-CCYY.
000173                 24  DC-EDITA-CENT     PIC 99.
000174                 24  DC-EDITA-YEAR     PIC 99.
000175         16  DC-GREG-DATE-B-EDIT.
000176             20  DC-EDITB-MONTH        PIC 99.
000177             20  SLASHB-1              PIC X VALUE '/'.
000178             20  DC-EDITB-DAY          PIC 99.
000179             20  SLASHB-2              PIC X VALUE '/'.
000180             20  DC-EDITB-CCYY.
000181                 24  DC-EDITB-CENT     PIC 99.
000182                 24  DC-EDITB-YEAR     PIC 99.
000183         16  DC-GREG-DATE-CYMD         PIC 9(08).
000184         16  DC-GREG-DATE-CYMD-R REDEFINES
000185                              DC-GREG-DATE-CYMD.
000186             20  DC-CYMD-CEN           PIC 99.
000187             20  DC-CYMD-YEAR          PIC 99.
000188             20  DC-CYMD-MONTH         PIC 99.
000189             20  DC-CYMD-DAY           PIC 99.
000190         16  DC-GREG-DATE-MDCY         PIC 9(08).
000191         16  DC-GREG-DATE-MDCY-R REDEFINES
000192                              DC-GREG-DATE-MDCY.
000193             20  DC-MDCY-MONTH         PIC 99.
000194             20  DC-MDCY-DAY           PIC 99.
000195             20  DC-MDCY-CEN           PIC 99.
000196             20  DC-MDCY-YEAR          PIC 99.
000197    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
000198        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
000199    12  DC-EL310-DATE                  PIC X(21).
000200    12  FILLER                         PIC X(28).
      *<<((file: ELCDATE))
000353
000354     EJECT
000355*    COPY ELCCALC.
      *>>((file: ELCCALC))
000001******************************************************************
000002*                                                                *
000003*                           ELCCALC.                            *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000005*                            VMOD=2.025                          *
000006*                                                                *
000007*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
000008*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
000009*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
000010*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
000011*                                                                *
000012*  PASSED TO ELRTRM                                              *
000013*  -----------------                                             *
000014*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
000015*  ORIGINAL TERM                                                 *
000016*  BEGINNING DATE                                                *
000017*  ENDING DATE                                                   *
000018*  COMPANY I.D.                                                  *
000019*  ACCOUNT MASTER USER FIELD                                     *
000020*  PROCESS SWITCH (CANCEL, CLAIM)                                *
000021*  FREE LOOK DAYS                                                *
000022*                                                                *
000023*  RETURNED FROM ELRTRM                                          *
000024*  ---------------------                                         *
000025*  REMAINING TERM 1 - USED FOR EARNINGS                          *
000026*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
000027*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
000028*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
000029*----------------------------------------------------------------*
000030*  PASSED TO ELRAMT                                              *
000031*  ----------------                                              *
000032*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
000033*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
000034*  ORIGINAL AMOUNT                                               *
000035*  ALTERNATE BENEFIT (BALLON)                                    *
000036*  A.P.R. - NET PAY ONLY                                         *
000037*  METHOD
000038*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
000039*  COMPANY I.D.                                                  *
000040*  BENEFIT TYPE                                                  *
000041*                                                                *
000042*  RETURNED FROM ELRAMT                                          *
000043*  --------------------                                          *
000044*  REMAINING AMOUNT 1 - CURRENT                                  *
000045*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
000046*  REMAINING AMOUNT FACTOR
000047*----------------------------------------------------------------*
000048*  PASSED TO ELRESV                                              *
000049*  -----------------                                             *
000050*  CERTIFICATE EFFECTIVE DATE                                    *
000051*  VALUATION DATE                                                *
000052*  PAID THRU DATE                                                *
000053*  BENEFIT                                                       *
000054*  INCURRED DATE                                                 *
000055*  REPORTED DATE                                                 *
000056*  ISSUE AGE                                                     *
000057*  TERM                                                          *
000058*  CDT PERCENT                                                   *
000059*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
000060* *CLAIM TYPE (LIFE, A/H)                                        *
000061* *REMAINING BENEFIT (FROM ELRAMT)                               *
000062* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
000063*                                                                *
000064*  RETURNED FROM ELRESV                                          *
000065*  --------------------                                          *
000066*  CDT TABLE USED                                                *
000067*  CDT FACTOR USED                                               *
000068*  PAY TO CURRENT RESERVE                                        *
000069*  I.B.N.R. - A/H ONLY                                           *
000070*  FUTURE (ACCRUED) AH ONLY                                      *
000071*----------------------------------------------------------------*
000072*  PASSED TO ELRATE                                              *
000073*  ----------------                                              *
000074*  CERT ISSUE DATE                                               *
000075*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
000076*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
000077*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
000078*  STATE CODE (CLIENT DEFINED)                                   *
000079*  STATE CODE (STANDARD P.O. ABBRV)                              *
000080*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
000081*  DEVIATION CODE                                                *
000082*  ISSUE AGE                                                     *
000083*  ORIGINAL BENEFIT AMOUNT                                       *
000084*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
000085*  PROCESS TYPE (ISSUE OR CANCEL)                                *
000086*  BENEFIT KIND (LIFE OR A/H)                                    *
000087*  A.P.R.                                                        *
000088*  METHOD
000089*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
000090*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
000091*  COMPANY I.D. (3 CHARACTER)                                    *
000092*  BENEFIT CODE                                                  *
000093*  BENEFIT OVERRIDE CODE                                         *
000094*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
000095*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
000096*  JOINT INDICATOR (CSL ONLY)                                    *
000097*  FIRST PAYMENT DATE (CSL ONLY)                                 *
000098*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
000099*                                                                *
000100*  RETURNED FROM ELRATE                                          *
000101*  --------------------                                          *
000102*  CALCULATED PREMIUM                                            *
000103*  PREMIUM RATE                                                  *
000104*  MORTALITY CODE                                                *
000105*  MAX ATTAINED AGE                                              *
000106*  MAX AGE                                                       *
000107*  MAX TERM                                                      *
000108*  MAX MONTHLY BENEFIT                                           *
000109*  MAX TOTAL BENIFIT                                             *
000110*  COMPOSITE RATE (OPEN-END ONLY)                                *
000111*----------------------------------------------------------------*
000112*  PASSED TO ELRFND                                              *
000113*  ----------------                                              *
000114*  CERT ISSUE DATE                                               *
000115*  REFUND DATE                                                   *
000116*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
000117*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
000118*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
000119*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
000120*  STATE CODE (CLIENT DEFINED)                                   *
000121*  STATE CODE (STANDARD P.O. ABBRV)                              *
000122*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
000123*  DEVIATION CODE                                                *
000124*  ISSUE AGE                                                     *
000125*  ORIGINAL BENEFIT AMOUNT                                       *
000126*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
000127*  PROCESS TYPE (CANCEL)                                         *
000128*  BENEFIT KIND (LIFE OR A/H)                                    *
000129*  A.P.R.                                                        *
000130*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
000131*  RATING METHOD -  (CODE FROM BENEFIT)                          *
000132*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
000133*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
000134*  COMPANY I.D. (3 CHARACTER)                                    *
000135*  BENEFIT CODE                                                  *
000136*  BENEFIT OVERRIDE CODE                                         *
000137*                                                                *
000138*  RETURNED FROM ELRFND                                          *
000139*  --------------------                                          *
000140*  CALCULATED REFUND                                             *
000141*----------------------------------------------------------------*
000142*  PASSED TO ELEARN                                              *
000143*  ----------------                                              *
000144*  CERT ISSUE DATE                                               *
000145*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
000146*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
000147*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
000148*  STATE CODE (CLIENT DEFINED)                                   *
000149*  STATE CODE (STANDARD P.O. ABBRV)                              *
000150*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
000151*  DEVIATION CODE                                                *
000152*  ISSUE AGE                                                     *
000153*  ORIGINAL BENEFIT AMOUNT                                       *
000154*  BENEFIT KIND (LIFE OR A/H)                                    *
000155*  A.P.R.                                                        *
000156*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
000157*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
000158*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
000159*  COMPANY I.D. (3 CHARACTER)                                    *
000160*  BENEFIT CODE                                                  *
000161*  BENEFIT OVERRIDE CODE                                         *
000162*                                                                *
000163*  RETURNED FROM ELEARN                                          *
000164*  --------------------                                          *
000165*  INDICATED  EARNINGS                                           *
000166*----------------------------------------------------------------*
000167*                 LENGTH = 450                                   *
000168*                                                                *
000169******************************************************************
000170******************************************************************
000171*                   C H A N G E   L O G
000172*
000173* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000174*-----------------------------------------------------------------
000175*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000176* EFFECTIVE    NUMBER
000177*-----------------------------------------------------------------
000178* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
000179* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
000180* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
000181* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
000182* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
000183* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
000184* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
000185* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
000186* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
000187* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
000188* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
000189* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
000190******************************************************************
000191
000192 01  CALCULATION-PASS-AREA.
000193     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
000194                                     COMP.
000195
000196     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
000197       88  NO-CP-ERROR                             VALUE ZERO.
000198       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
000199                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
000200       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
000201       88  CP-ERROR-IN-DATES                       VALUE '2'.
000202       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
000203       88  CP-ERROR-IN-TERMS                       VALUE '4'.
000204       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
000205       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
000206       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
000207       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
000208       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
000209       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
000210       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
000211       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
000212       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
000213       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
000214       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
000215       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
000216       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
000217       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
000218
000219     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
000220       88  NO-CP-ERROR-2                           VALUE ZERO.
000221***********************  INPUT AREAS ****************************
000222
000223     12  CP-CALCULATION-AREA.
000224         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
000225         16  CP-CERT-EFF-DT        PIC XX.
000226         16  CP-VALUATION-DT       PIC XX.
000227         16  CP-PAID-THRU-DT       PIC XX.
000228         16  CP-BENEFIT-TYPE       PIC X.
000229           88  CP-AH                               VALUE 'A' 'D'
000230                                                   'I' 'U'.
000231           88  CP-REDUCING-LIFE                    VALUE 'R'.
000232           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
000233         16  CP-INCURRED-DT        PIC XX.
000234         16  CP-REPORTED-DT        PIC XX.
000235         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
000236         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
000237         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
000238                                     COMP-3.
000239         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
000240                                     COMP-3.
000241         16  CP-CDT-METHOD         PIC X.
000242           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
000243           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
000244           88  CP-CDT-INTERPOLATED                 VALUE '3'.
000245         16  CP-CLAIM-TYPE         PIC X.
000246           88  CP-AH-CLAIM                         VALUE 'A'.
000247           88  CP-LIFE-CLAIM                       VALUE 'L'.
000248         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
000249                                     COMP-3.
000250         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
000251                                     COMP-3.
000252         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
000253                                     COMP-3.
000254         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
000255                                     COMP-3.
000256         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
000257                                     COMP-3.
000258         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
000259                                     COMP-3.
000260         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
000261                                     COMP-3.
000262         16  CP-REM-TERM-METHOD    PIC X.
000263           88  CP-EARN-AFTER-15TH                  VALUE '1'.
000264           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
000265           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
000266           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
000267           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
000268           88  CP-EARN-AFTER-14TH                  VALUE '6'.
000269           88  CP-EARN-AFTER-16TH                  VALUE '7'.
000270         16  CP-EARNING-METHOD     PIC X.
000271           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
000272           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
000273           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
000274           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
000275           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
000276           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
000277           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
000278           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
000279           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
000280           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
000281           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
000282           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
000283           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
000284           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
000285         16  CP-PROCESS-TYPE       PIC X.
000286           88  CP-CLAIM                            VALUE '1'.
000287           88  CP-CANCEL                           VALUE '2'.
000288           88  CP-ISSUE                            VALUE '3'.
000289         16  CP-SPECIAL-CALC-CD    PIC X.
000290           88  CP-OUTSTANDING-BAL              VALUE 'O'.
000291           88  CP-1-MTH-INTEREST               VALUE ' '.
000292           88  CP-0-MTH-INTEREST               VALUE 'A'.
000293           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
000294           88  CP-CRITICAL-PERIOD              VALUE 'C'.
000295           88  CP-TERM-IS-DAYS                 VALUE 'D'.
000296           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
000297           88  CP-FARM-PLAN                    VALUE 'F'.
000298           88  CP-RATE-AS-STANDARD             VALUE 'G'.
000299           88  CP-2-MTH-INTEREST               VALUE 'I'.
000300           88  CP-3-MTH-INTEREST               VALUE 'J'.
000301           88  CP-4-MTH-INTEREST               VALUE 'K'.
000302           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
000303           88  CP-MORTGAGE-REC                 VALUE 'M'.
000304           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
000305           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
000306           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
000307           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
000308                                                     'W' 'X'.
000309           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
000310           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
000311           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
000312           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
000313           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
000314           88  CP-SUMMARY-REC                  VALUE 'Z'.
000315           88  CP-PROPERTY-BENEFIT             VALUE '2'.
000316           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
000317           88  CP-AD-D-BENEFIT                 VALUE '4'.
000318           88  CP-CSL-METH-1                   VALUE '5'.
000319           88  CP-CSL-METH-2                   VALUE '6'.
000320           88  CP-CSL-METH-3                   VALUE '7'.
000321           88  CP-CSL-METH-4                   VALUE '8'.
000322
000323         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
000324                                     COMP-3.
000325         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
000326         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
000327         16  CP-STATE              PIC XX          VALUE SPACE.
000328         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
000329         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
000330           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
000331               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
000332         16  CP-R78-OPTION         PIC X.
000333           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
000334           88  CP-TERM-TIMES-TERM                  VALUE '1'.
000335
000336         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
000337         16  CP-IBNR-RESERVE-SW    PIC X.
000338         16  CP-CLAIM-STATUS       PIC X.
000339         16  CP-RATE-FILE          PIC X.
000340         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
000341                                     COMP-3.
000342
000343         16  CP-LIFE-OVERRIDE-CODE PIC X.
000344         16  CP-AH-OVERRIDE-CODE   PIC X.
000345
000346         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
000347                                     COMP-3.
000348         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
000349                                   PIC S9(5)V99 COMP-3.
000350         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
000351                                     COMP-3.
000352         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
000353                                     COMP-3.
000354         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
000355                                     COMP-3.
000356         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
000357                                  PIC S9(7)V99 COMP-3.
000358
000359         16  CP-PAID-FROM-DATE     PIC X(02).
000360         16  CP-CLAIM-CALC-METHOD  PIC X(01).
000361         16  CP-EXT-DAYS-CALC      PIC X.
000362           88  CP-EXT-NO-CHG                   VALUE ' '.
000363           88  CP-EXT-CHG-LF                   VALUE '1'.
000364           88  CP-EXT-CHG-AH                   VALUE '2'.
000365           88  CP-EXT-CHG-LF-AH                VALUE '3'.
000366         16  CP-DOMICILE-STATE     PIC XX.
000367         16  CP-CARRIER            PIC X.
000368         16  CP-REIN-FLAG          PIC X.
000369         16  CP-REM-TRM-CALC-OPTION PIC X.
000370           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
000371                      '2' '3' '4' '5'.
000372           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
000373           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
000374           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
000375           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
000376           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
000377           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
000378           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
000379           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
000380         16  CP-SIG-SWITCH         PIC X.
000381         16  CP-RATING-METHOD      PIC X.
000382           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
000383           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
000384           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
000385           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
000386           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
000387           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
000388           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
000389           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
000390           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
000391         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
000392                                     COMP-3.
000393         16  CP-BEN-CATEGORY       PIC X.
000394         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
000395         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
000396                                   PIC S99V9(5) COMP-3.
000397         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
000398         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
000399                                   PIC S99V9(5) COMP-3.
000400         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
000401         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
000402         16  CP-EXPIRE-DT          PIC XX.
000403         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
000404         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
000405         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
000406         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
000407         16  CP-DDF-SPEC-CALC      PIC X.
000408             88  CP-CALC-GROSS-FEE        VALUE 'G'.
000409             88  CP-CALC-CLP              VALUE 'C'.
000410         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
000411         16  CP-CANCEL-REASON      PIC X.
000412         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
000413         16  CP-PMT-MODE           PIC X.
000414         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
000415         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
000416         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
000417         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
000418         16  FILLER                PIC X.
000419
000420***************    OUTPUT FROM ELRESV   ************************
000421
000422         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
000423
000424         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
000425                                     COMP-3.
000426         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
000427                                     COMP-3.
000428         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
000429                                     COMP-3.
000430         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
000431                                     COMP-3.
000432         16  FILLER                PIC X(09).
000433***************    OUTPUT FROM ELRTRM   *************************
000434
000435         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
000436                                     COMP-3.
000437         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
000438                                     COMP-3.
000439         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
000440                                     COMP-3.
000441         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
000442                                     COMP-3.
000443         16  FILLER                PIC X(12).
000444
000445***************    OUTPUT FROM ELRAMT   *************************
000446
000447         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
000448                                     COMP-3.
000449         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
000450                                     COMP-3.
000451         16  FILLER                PIC X(12).
000452
000453***************    OUTPUT FROM ELRATE   *************************
000454
000455         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
000456                                     COMP-3.
000457         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
000458                                     COMP-3.
000459         16  CP-MORTALITY-CODE     PIC X(4).
000460         16  CP-RATE-EDIT-FLAG     PIC X.
000461             88  CP-RATES-NEED-APR                  VALUE '1'.
000462         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
000463                                     COMP-3.
000464         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
000465         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
000466         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
000467                                   PIC S9(7)V99 COMP-3.
000468         16  FILLER                PIC X(07).
000469
000470***************    OUTPUT FROM ELRFND   *************************
000471
000472         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
000473                                     COMP-3.
000474         16  CP-REFUND-TYPE-USED   PIC X.
000475           88  CP-R-AS-R78                         VALUE '1'.
000476           88  CP-R-AS-PRORATA                     VALUE '2'.
000477           88  CP-R-AS-CALIF                       VALUE '3'.
000478           88  CP-R-AS-TEXAS                       VALUE '4'.
000479           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
000480           88  CP-R-AS-NET-PAY                     VALUE '5'.
000481           88  CP-R-AS-ANTICIPATION                VALUE '6'.
000482           88  CP-R-AS-MEAN                        VALUE '8'.
000483           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
000484           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
000485           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
000486           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
000487           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
000488           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
000489         16  FILLER                PIC X(12).
000490
000491***************    OUTPUT FROM ELEARN   *************************
000492
000493         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
000494                                     COMP-3.
000495         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
000496                                     COMP-3.
000497         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
000498                                     COMP-3.
000499         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
000500                                     COMP-3.
000501         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
000502                                     COMP-3.
000503         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
000504                                     COMP-3.
000505         16  CP-EARNING-TYPE-USED  PIC X.
000506           88  CP-E-AS-SPECIAL                     VALUE 'S'.
000507           88  CP-E-AS-R78                         VALUE '1'.
000508           88  CP-E-AS-PRORATA                     VALUE '2'.
000509           88  CP-E-AS-TEXAS                       VALUE '4'.
000510           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
000511           88  CP-E-AS-NET-PAY                     VALUE '5'.
000512           88  CP-E-AS-ANTICIPATION                VALUE '6'.
000513           88  CP-E-AS-MEAN                        VALUE '8'.
000514           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
000515         16  FILLER                PIC X(12).
000516
000517***************    OUTPUT FROM ELPMNT   *************************
000518
000519         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
000520                                     COMP-3.
000521         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
000522                                     COMP-3.
000523         16  FILLER                PIC X(12).
000524
000525***************   MISC WORK AREAS    *****************************
000526         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
000527                                     COMP-3.
000528         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
000529                                     COMP-3.
000530         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
000531                                     COMP-3.
000532         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
000533                                     COMP-3.
000534         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
000535                                     COMP-3.
000536         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
000537                                     COMP-3.
000538         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
000539             88  OPEN-RATE-FILE                   VALUE 'O'.
000540             88  CLOSE-RATE-FILE                  VALUE 'C'.
000541             88  IO-ERROR                         VALUE 'E'.
000542
000543         16  CP-FIRST-PAY-DATE     PIC XX.
000544
000545         16  CP-JOINT-INDICATOR    PIC X.
000546
000547         16  CP-RESERVE-REMAINING-TERM
000548                                   PIC S9(4)V9    VALUE ZERO
000549                                     COMP-3.
000550
000551         16  CP-INSURED-BIRTH-DT   PIC XX.
000552
000553         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
000554                                     COMP-3.
000555
000556         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
000557                                     COMP-3.
000558
000559         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
000560                                     COMP-3.
000561
000562         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
000563                                     COMP-3.
000564
000565         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
000566                                     COMP-3.
000567
000568         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
000569                                     COMP-3.
000570
000571         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
000572                                     COMP-3.
000573
000574         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
000575             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
000576
000577         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
000578                                     COMP-3.
000579         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
000580                                     COMP-3.
000581         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
000582         16  cp-extra-periods      pic 9 value zeros.
000583         16  cp-net-only-state     pic x value spaces.
000584         16  FILLER                PIC X(13).
000585******************************************************************
      *<<((file: ELCCALC))
000356     EJECT
000357******************************************************************
000358*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
000359*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
000360*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
000361*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
000362*** MODIFICATION.                                              ***
000363*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
000364*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
000365******************************************************************
000366*    COPY ERCPNDB.
      *>>((file: ERCPNDB))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCPNDB.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.025                          *
000007*                                                                *
000008*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
000009*                                                                *
000010******************************************************************
000011*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
000012*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
000013******************************************************************
000014*                                                                *
000015*                                                                *
000016*   FILE TYPE = VSAM,KSDS                                        *
000017*   RECORD SIZE = 585  RECFORM = FIXED                           *
000018*                                                                *
000019*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
000020*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
000021*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
000022*                                                 RKP=13,LEN=36  *
000023*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
000024*                                      AND CHG-SEQ.)             *
000025*                                                RKP=49,LEN=11   *
000026*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
000027*                                      AND CHG-SEQ.)             *
000028*                                                RKP=60,LEN=15   *
000029*                                                                *
000030*   LOG = NO                                                     *
000031*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000032******************************************************************
000033******************************************************************
000034*                   C H A N G E   L O G
000035*
000036* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000037*-----------------------------------------------------------------
000038*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000039* EFFECTIVE    NUMBER
000040*-----------------------------------------------------------------
000041* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
000042* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
000043* 011904                   PEMA  ADD TOTAL FEE PROCESSING
000044* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
000045* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
000046* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
000047* 032306                   PEMA  ADD BOW LOAN NUMBER
000048* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
000049* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
000050* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
000051* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
000052* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
000053* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
000054* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
000055* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
000056* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
000057* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
000058* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
000059* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
000060* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
000061******************************************************************
000062
000063 01  PENDING-BUSINESS.
000064     12  PB-RECORD-ID                     PIC XX.
000065         88  VALID-PB-ID                        VALUE 'PB'.
000066
000067     12  PB-CONTROL-PRIMARY.
000068         16  PB-COMPANY-CD                PIC X.
000069         16  PB-ENTRY-BATCH               PIC X(6).
000070         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
000071         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
000072
000073     12  PB-CONTROL-BY-ACCOUNT.
000074         16  PB-COMPANY-CD-A1             PIC X.
000075         16  PB-CARRIER                   PIC X.
000076         16  PB-GROUPING.
000077             20  PB-GROUPING-PREFIX       PIC XXX.
000078             20  PB-GROUPING-PRIME        PIC XXX.
000079         16  PB-STATE                     PIC XX.
000080         16  PB-ACCOUNT.
000081             20  PB-ACCOUNT-PREFIX        PIC X(4).
000082             20  PB-ACCOUNT-PRIME         PIC X(6).
000083         16  PB-CERT-EFF-DT               PIC XX.
000084         16  PB-CERT-NO.
000085             20  PB-CERT-PRIME            PIC X(10).
000086             20  PB-CERT-SFX              PIC X.
000087         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
000088
000089         16  PB-RECORD-TYPE               PIC X.
000090             88  PB-MAILING-DATA                VALUE '0'.
000091             88  PB-ISSUE                       VALUE '1'.
000092             88  PB-CANCELLATION                VALUE '2'.
000093             88  PB-BATCH-TRAILER               VALUE '9'.
000094
000095     12  PB-CONTROL-BY-ORIG-BATCH.
000096         16  PB-ORIGINAL-COMPANY-CD       PIC X.
000097         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
000098         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
000099         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
000100
000101     12  PB-CONTROL-BY-CSR.
000102         16  PB-CSR-COMPANY-CD            PIC X.
000103         16  PB-CSR-ID                    PIC X(4).
000104         16  PB-CSR-ENTRY-BATCH           PIC X(6).
000105         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
000106         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
000107******************************************************************
000108*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
000109******************************************************************
000110
000111     12  PB-LAST-MAINT-DT                 PIC XX.
000112     12  PB-LAST-MAINT-BY                 PIC X(4).
000113     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
000114
000115     12  PB-RECORD-BODY                   PIC X(375).
000116
000117     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
000118         16  PB-CERT-ORIGIN               PIC X.
000119             88  CLASIC-CREATED-CERT         VALUE '1'.
000120         16  PB-I-NAME.
000121             20  PB-I-INSURED-LAST-NAME   PIC X(15).
000122             20  PB-I-INSURED-FIRST-NAME.
000123                 24  PB-I-INSURED-1ST-INIT PIC X.
000124                 24  FILLER                PIC X(9).
000125             20  PB-I-INSURED-MIDDLE-INIT PIC X.
000126         16  PB-I-AGE                     PIC S99   COMP-3.
000127         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
000128         16  PB-I-BIRTHDAY                PIC XX.
000129         16  PB-I-INSURED-SEX             PIC X.
000130             88  PB-SEX-MALE     VALUE 'M'.
000131             88  PB-SEX-FEMALE   VALUE 'F'.
000132
000133         16  PB-I-LF-TERM                 PIC S999   COMP-3.
000134         16  PB-I-AH-TERM                 PIC S999   COMP-3.
000135         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
000136         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
000137         16  PB-I-SKIP-CODE               PIC X.
000138             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
000139             88  PB-SKIP-JULY              VALUE '1'.
000140             88  PB-SKIP-AUGUST            VALUE '2'.
000141             88  PB-SKIP-SEPTEMBER         VALUE '3'.
000142             88  PB-SKIP-JULY-AUG          VALUE '4'.
000143             88  PB-SKIP-AUG-SEPT          VALUE '5'.
000144             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
000145             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
000146             88  PB-SKIP-JUNE              VALUE '8'.
000147             88  PB-SKIP-JUNE-JULY         VALUE '9'.
000148             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
000149             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
000150         16  PB-I-TERM-TYPE               PIC X.
000151             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
000152             88  PB-PAID-WEEKLY            VALUE 'W'.
000153             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
000154             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
000155             88  PB-PAID-13-YEARLY         VALUE 'T'.
000156         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
000157         16  PB-I-POLICY-FORM-NO          PIC X(12).
000158         16  PB-I-DATA-ENTRY-SW           PIC X.
000159             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
000160             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
000161             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
000162             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
000163         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
000164         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
000165*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
000166         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
000167         16  PB-I-LETTER-REQD             PIC X.
000168
000169         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
000170             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
000171             88  PB-INVALID-LIFE             VALUE '  ' '00'
000172                                                   '90' THRU '99'.
000173         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
000174                                          PIC XX.
000175         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
000176         16  PB-I-AMOUNT-FINANCED REDEFINES
000177                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
000178         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
000179         16  PB-I-UNPAID-CASH-PRICE REDEFINES
000180                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
000181         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
000182         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
000183         16  PB-I-CLP-AMOUNT REDEFINES
000184                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
000185         16  PB-I-LF-CALC-FLAG            PIC X.
000186             88 PB-COMP-LF-PREM               VALUE '?'.
000187         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
000188         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
000189         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
000190         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
000191         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
000192         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
000193         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
000194         16  PB-I-LF-ABBR                 PIC XXX.
000195         16  PB-I-LF-INPUT-CD             PIC XX.
000196
000197         16  PB-I-AH-BENEFIT-CD           PIC XX.
000198             88  PB-VALID-AH                 VALUE '01' THRU '89'.
000199             88  PB-INVALID-AH               VALUE '  ' '00'
000200                                                   '90' THRU '99'.
000201         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
000202         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
000203         16  PB-I-AH-CALC-FLAG            PIC X.
000204             88 PB-COMP-AH-PREM                  VALUE '?'.
000205         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
000206         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
000207         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
000208         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
000209         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
000210         16  PB-I-AH-ABBR                 PIC XXX.
000211         16  PB-I-AH-INPUT-CD             PIC XXX.
000212
000213         16  PB-I-SPECIAL-REIN-CODE       PIC X.
000214         16  PB-I-REIN-TABLE              PIC XXX.
000215         16  PB-I-BUSINESS-TYPE           PIC 99.
000216         16  PB-I-INDV-GRP-CD             PIC X.
000217         16  PB-I-MORT-CODE.
000218             20  PB-I-TABLE               PIC X.
000219             20  PB-I-INTEREST            PIC XX.
000220             20  PB-I-MORT-TYP            PIC X.
000221         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
000222         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
000223         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
000224         16  PB-I-INDV-GRP-OVRD           PIC X.
000225         16  PB-I-RATE-CLASS-OVRD         PIC XX.
000226         16  PB-I-SIG-SW                  PIC X.
000227             88  PB-POLICY-SIGNED             VALUE 'Y'.
000228         16  PB-I-RATE-CLASS              PIC XX.
000229         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
000230         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
000231         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
000232         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
000233         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
000234         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
000235         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
000236         16  PB-I-BENEFIT-TYPE            PIC XXX.
000237         16  PB-I-OB-FLAG                 PIC X.
000238             88  PB-I-OB                      VALUE 'B'.
000239             88  PB-I-SUMMARY                 VALUE 'Z'.
000240         16  PB-I-ENTRY-STATUS            PIC X.
000241             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
000242                                              'M' '5' '9' '2'.
000243             88  PB-I-NORMAL-ENTRY            VALUE '1'.
000244             88  PB-I-POLICY-PENDING          VALUE '2'.
000245             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
000246             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
000247             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
000248             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
000249             88  PB-I-REIN-ONLY               VALUE '9'.
000250             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
000251             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
000252             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
000253             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
000254         16  PB-I-INT-CODE                PIC X.
000255             88  PB-ADD-ON-INTEREST           VALUE 'A'.
000256             88  PB-SIMPLE-INTEREST           VALUE 'S'.
000257         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
000258         16  PB-I-SOC-SEC-NO              PIC X(11).
000259         16  PB-I-MEMBER-NO               PIC X(12).
000260         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
000261*        16  PB-I-LOAN-OFFICER            PIC XXX.
000262         16  PB-I-OLD-LOF                 PIC XXX.
000263         16  PB-I-LF-EXPIRE-DT            PIC XX.
000264         16  PB-I-AH-EXPIRE-DT            PIC XX.
000265         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
000266         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
000267         16  PB-I-LIFE-INDICATOR          PIC X.
000268             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
000269         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
000270         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
000271                                          PIC S9(5)V99    COMP-3.
000272         16  PB-I-MAIL-ADDRS-SW           PIC X.
000273             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
000274             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
000275         16  PB-I-1ST-PMT-DT              PIC XX.
000276         16  PB-I-JOINT-INSURED.
000277             20 PB-I-JOINT-LAST-NAME      PIC X(15).
000278             20 PB-I-JOINT-FIRST-NAME.
000279                24  PB-I-JOINT-FIRST-INIT PIC X.
000280                24  FILLER                PIC X(9).
000281             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
000282*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
000283         16  PB-I-BENEFICIARY-NAME.
000284             20  PB-I-BANK-NUMBER         PIC X(10).
000285             20  FILLER                   PIC X(15).
000286         16  PB-I-LAST-ADD-ON-DT          PIC XX.
000287         16  PB-I-REFERENCE               PIC X(12).
000288         16  FILLER REDEFINES PB-I-REFERENCE.
000289             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
000290             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
000291             20  PB-I-CLP-STATE           PIC XX.
000292         16  PB-I-UNDERWRITING-STATUS     PIC X.
000293             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
000294             88  PB-I-POLICY-DECLINED         VALUE 'D'.
000295             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
000296         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
000297         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
000298         16  PB-I-RESIDENT-STATE          PIC XX.
000299         16  PB-I-RATE-CODE               PIC X(4).
000300         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
000301         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
000302         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
000303         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
000304         16  PB-I-BANK-NOCHRGB            PIC 99.
000305         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
000306         16  PB-I-JOINT-BIRTHDAY          PIC XX.
000307
000308     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
000309         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
000310             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
000311         16  PB-C-CANCEL-ORIGIN           PIC X.
000312             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
000313         16  PB-C-LF-CANCEL-DT            PIC XX.
000314         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
000315         16  PB-C-LF-CALC-REQ             PIC X.
000316             88 PB-COMP-LF-CANCEL            VALUE '?'.
000317         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
000318         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
000319         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
000320             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
000321         16  PB-C-AH-CANCEL-DT            PIC XX.
000322         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
000323         16  PB-C-AH-CALC-REQ             PIC X.
000324             88 PB-COMP-AH-CANCEL            VALUE '?'.
000325         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
000326         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
000327         16  PB-C-LAST-NAME               PIC X(15).
000328         16  PB-C-REFUND-SW               PIC X.
000329             88  PB-C-REFUND-CREATED          VALUE 'Y'.
000330             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
000331         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
000332         16  PB-C-PAYEE-CODE              PIC X(6).
000333         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
000334         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
000335         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
000336         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
000337         16  PB-C-REFERENCE               PIC X(12).
000338         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
000339         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
000340         16  PB-C-POST-CARD-IND           PIC X.
000341         16  PB-C-CANCEL-REASON           PIC X.
000342         16  PB-C-REF-INTERFACE-SW        PIC X.
000343         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
000344         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
000345         16  FILLER                       PIC X(01).
000346*        16  FILLER                       PIC X(18).
000347         16  PB-C-POLICY-FORM-NO          PIC X(12).
000348*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
000349         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
000350         16  PB-CANCELED-CERT-DATA.
000351             20  PB-CI-INSURED-NAME.
000352                 24  PB-CI-LAST-NAME      PIC X(15).
000353                 24  PB-CI-INITIALS       PIC XX.
000354             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
000355             20  PB-CI-INSURED-SEX        PIC X.
000356             20  PB-CI-LF-TERM            PIC S999        COMP-3.
000357             20  PB-CI-LF-BENEFIT-CD      PIC XX.
000358             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
000359             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
000360             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
000361             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
000362             20  PB-CI-AH-TERM            PIC S999        COMP-3.
000363             20  PB-CI-AH-BENEFIT-CD      PIC XX.
000364             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
000365             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
000366             20  PB-CI-RATE-CLASS         PIC XX.
000367             20  PB-CI-RATE-DEV-LF        PIC XXX.
000368             20  PB-CI-RATE-DEV-AH        PIC XXX.
000369             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
000370             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
000371             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
000372             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
000373             20  PB-CI-LF-ABBR            PIC X(3).
000374             20  PB-CI-AH-ABBR            PIC X(3).
000375             20  PB-CI-OB-FLAG            PIC X.
000376                 88  PB-CI-OB                VALUE 'B'.
000377             20  PB-CI-LF-POLICY-STATUS   PIC X.
000378                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
000379                                           'M' '4' '5' '9' '2'.
000380                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
000381                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
000382                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
000383                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
000384                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
000385                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
000386                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
000387                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
000388                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
000389                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
000390                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
000391                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
000392                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
000393             20  PB-CI-AH-POLICY-STATUS   PIC X.
000394                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
000395                                           'M' '4' '5' '9' '2'.
000396                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
000397                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
000398                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
000399                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
000400                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
000401                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
000402                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
000403                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
000404                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
000405                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
000406                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
000407                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
000408                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
000409             20  PB-CI-PAY-FREQUENCY      PIC 99.
000410             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
000411             20  PB-CI-SOC-SEC-NO         PIC X(11).
000412             20  PB-CI-MEMBER-NO          PIC X(12).
000413             20  PB-CI-INT-CODE           PIC X.
000414                 88  PB-CI-ADD-ON                  VALUE 'A'.
000415                 88  PB-CI-SIMPLE                  VALUE 'S'.
000416             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
000417             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
000418             20  PB-CI-COMP-EXCP-SW       PIC X.
000419                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
000420                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
000421             20  PB-CI-ENTRY-STATUS       PIC X.
000422             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
000423             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
000424             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
000425             20  PB-CI-DEATH-DT           PIC XX.
000426             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
000427             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
000428             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
000429             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
000430             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
000431             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
000432             20  PB-CI-ENTRY-DT              PIC XX.
000433             20  PB-CI-ENTRY-BATCH           PIC X(6).
000434             20  PB-CI-LF-EXPIRE-DT          PIC XX.
000435             20  PB-CI-AH-EXPIRE-DT          PIC XX.
000436             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
000437             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
000438             20  PB-CI-OLD-LOF               PIC XXX.
000439*            20  PB-CI-LOAN-OFFICER          PIC XXX.
000440             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
000441             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
000442             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
000443             20  PB-CI-INDV-GRP-CD           PIC X.
000444             20  PB-CI-BENEFICIARY-NAME.
000445                 24  PB-CI-BANK-NUMBER       PIC X(10).
000446                 24  FILLER                  PIC X(15).
000447             20  PB-CI-NOTE-SW               PIC X.
000448             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
000449             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
000450             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
000451             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
000452             20  PB-CI-LOAN-OFFICER          PIC X(5).
000453             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
000454             20  PB-CI-FIRST-NAME            PIC X(10).
000455             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
000456
000457         16  FILLER                       PIC X(13).
000458*032306  16  FILLER                       PIC X(27).
000459*        16  FILLER                       PIC X(46).
000460
000461     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
000462         16  FILLER                       PIC X(10).
000463         16  PB-M-INSURED-LAST-NAME       PIC X(15).
000464         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
000465         16  PB-M-INSURED-MID-INIT        PIC X.
000466         16  PB-M-INSURED-AGE             PIC 99.
000467         16  PB-M-INSURED-BIRTHDAY        PIC XX.
000468         16  PB-M-INSURED-SEX             PIC X.
000469         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
000470         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
000471         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
000472         16  PB-M-INSURED-CITY-STATE.
000473             20  PB-M-INSURED-CITY        PIC X(28).
000474             20  PB-M-INSURED-STATE       PIC XX.
000475         16  PB-M-INSURED-ZIP-CODE.
000476             20  PB-M-INSURED-ZIP-PRIME.
000477                 24  PB-M-INSURED-ZIP-1   PIC X.
000478                     88  PB-M-CANADIAN-POST-CODE
000479                                             VALUE 'A' THRU 'Z'.
000480                 24  FILLER               PIC X(4).
000481             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
000482         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
000483                                        PB-M-INSURED-ZIP-CODE.
000484             20  PM-M-INS-CAN-POST1       PIC XXX.
000485             20  PM-M-INS-CAN-POST2       PIC XXX.
000486             20  FILLER                   PIC XXX.
000487         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
000488         16  PB-M-JOINT-BIRTHDAY          PIC XX.
000489         16  PB-M-CRED-BENE-NAME          PIC X(30).
000490         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
000491         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
000492         16  PB-M-CRED-BENE-CITYST.
000493             20  PB-M-CRED-BENE-CITY      PIC X(28).
000494             20  PB-M-CRED-BENE-STATE     PIC XX.
000495
000496         16  FILLER                       PIC X(92).
000497
000498     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
000499         16  FILLER                       PIC X(10).
000500         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
000501         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
000502         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
000503         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
000504         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
000505         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
000506         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
000507         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
000508         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
000509         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
000510         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
000511         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
000512         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
000513         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
000514         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
000515         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
000516         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
000517         16  PB-ACCOUNT-NAME              PIC X(30).
000518         16  PB-PREM-REF-RPT-FLAG         PIC X.
000519         16  PB-REFERENCE                 PIC X(12).
000520         16  PB-B-RECEIVED-DT             PIC XX.
000521         16  FILLER                       PIC X(234).
000522
000523     12  PB-RECORD-STATUS.
000524         16  PB-CREDIT-SELECT-DT          PIC XX.
000525         16  PB-CREDIT-ACCEPT-DT          PIC XX.
000526         16  PB-BILLED-DT                 PIC XX.
000527         16  PB-BILLING-STATUS            PIC X.
000528             88  PB-ENTRY-REVERSED            VALUE 'R'.
000529             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
000530             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
000531         16  PB-RECORD-BILL               PIC X.
000532             88  PB-RECORD-ON-HOLD            VALUE 'H'.
000533             88  PB-RECORD-RETURNED           VALUE 'R'.
000534             88  PB-RECORD-ENDORSED           VALUE 'E'.
000535             88  PB-OVERRIDE-LIFE             VALUE 'L'.
000536             88  PB-OVERRIDE-AH               VALUE 'A'.
000537             88  PB-OVERRIDE-BOTH             VALUE 'B'.
000538         16  PB-BATCH-ENTRY               PIC X.
000539             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
000540             88  PB-REIN-ONLY-CERT            VALUE 'R'.
000541             88  PB-REISSUED-CERT             VALUE 'E'.
000542             88  PB-CASH-CERT                 VALUE 'C'.
000543             88  PB-MONTHLY-CERT              VALUE 'M'.
000544             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
000545             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
000546             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
000547         16  PB-FORCE-CODE                PIC X.
000548             88  PB-FORCE-OFF                 VALUE ' ' '0'.
000549             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
000550             88  PB-CANCEL-FORCE              VALUE '8'.
000551             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
000552             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
000553             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
000554             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
000555             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
000556             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
000557             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
000558             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
000559         16  PB-FATAL-FLAG                PIC X.
000560             88  PB-FATAL-ERRORS              VALUE 'X'.
000561         16  PB-FORCE-ER-CD               PIC X.
000562             88  PB-FORCE-ERRORS              VALUE 'F'.
000563             88  PB-UNFORCED-ERRORS           VALUE 'X'.
000564         16  PB-WARN-ER-CD                PIC X.
000565             88  PB-WARNING-ERRORS            VALUE 'W'.
000566         16  FILLER                       PIC X.
000567         16  PB-OUT-BAL-CD                PIC X.
000568             88  PB-OUT-OF-BAL                VALUE 'O'.
000569         16  PB-LIFE-OVERRIDE-L1          PIC X.
000570         16  PB-AH-OVERRIDE-L1            PIC X.
000571         16  PB-INPUT-DT                  PIC XX.
000572         16  PB-INPUT-BY                  PIC X(4).
000573         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
000574         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
000575         16  PB-TOLERANCE-REJECT-SW       PIC X.
000576         16  PB-LF-EARNING-METHOD         PIC X.
000577         16  PB-AH-EARNING-METHOD         PIC X.
000578         16  PB-LF-TERM-CALC-METHOD       PIC X.
000579         16  PB-AH-TERM-CALC-METHOD       PIC X.
000580         16  PB-REIN-CD                   PIC XXX.
000581         16  PB-LF-REFUND-TYPE            PIC X.
000582         16  PB-AH-REFUND-TYPE            PIC X.
000583         16  PB-ACCT-EFF-DT               PIC XX.
000584         16  PB-ACCT-EXP-DT               PIC XX.
000585         16  PB-COMPANY-ID                PIC X(3).
000586         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
000587         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
000588         16  PB-SV-CARRIER                PIC X.
000589         16  PB-SV-GROUPING               PIC X(6).
000590         16  PB-SV-STATE                  PIC XX.
000591         16  PB-CONFIRMATION-REPT-DT      PIC XX.
000592         16  PB-GA-BILLING-INFO.
000593             20  PB-GA-BILL-DT OCCURS 5 TIMES
000594                                          PIC XX.
000595         16  PB-SV-REMIT-TO  REDEFINES
000596             PB-GA-BILLING-INFO           PIC X(10).
000597         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
000598         16  PB-I-LOAN-OFFICER            PIC X(5).
000599         16  PB-I-VIN                     PIC X(17).
000600
000601         16  FILLER                       PIC X(04).
000602         16  IMNET-BYPASS-SW              PIC X.
000603
000604******************************************************************
000605*                COMMON EDIT ERRORS                              *
000606******************************************************************
000607
000608     12  PB-COMMON-ERRORS.
000609         16  PB-COMMON-ERROR    OCCURS 10 TIMES
000610                                           PIC S9(4)     COMP.
000611
000612******************************************************************
      *<<((file: ERCPNDB))
000367
000368* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
000369*    COPY ELC50W1.
      *>>((file: ELC50W1))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                             ELC50W1                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.004                          *
000007*                                                                *
000008*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
000009*                                                                *
000010*                                                                *
000011******************************************************************
000012
000013     12  WK-WORK-AREA.
000014         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
000015         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
000016         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
000017         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
000018         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
000019         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
000020         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
000021         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
000022         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
000023         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
000024         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
000025         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
000026         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
000027         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
000028         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
000029         16  WK-CREDIT-EDIT-CONTROLS.
000030             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
000031             20  WK-MIN-AGE           PIC 99  VALUE 00.
000032             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
000033             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
000034             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
000035             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
000036         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
000037         16  WK-SAVE-REIN-DATA.
000038             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
000039             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
000040             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
000041         16  WK-ENTRY-SW              PIC X    VALUE ' '.
000042             88  ENTRY-FROM-EL6311       VALUE '6'.
000043         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
000044         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
000045     12  WK-RECORD-ADDRESSES.
000046         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
000047         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
000048         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
000049         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
000050         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
000051         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
000052         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
000053         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
000054     12  WK-OVER-SHORT-AREA.
000055         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
000056         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
000057         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
000058             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
000059         16  FILLER                   PIC X(5) VALUE SPACES.
      *<<((file: ELC50W1))
000370
000371*    COPY ELCEDITC.
      *>>((file: ELCEDITC))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCEDITC                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.012                          *
000007*                                                                *
000008*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
000009*                     EL6313, EL050 AND EL517.                   *
000010*                                                                *
000011******************************************************************
000012******************************************************************
000013*                   C H A N G E   L O G
000014*
000015* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000016*-----------------------------------------------------------------
000017*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000018* EFFECTIVE    NUMBER
000019*-----------------------------------------------------------------
000020* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
000021******************************************************************
000022
000023     12  EDIT-CRITERIA-DATA.
000024         16  EC-CO-MONTH-END-DT       PIC XX.
000025         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
000026         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
000027         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
000028         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
000029         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
000030         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
000031         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
000032         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
000033         16  EC-CO-REM-TERM-CALC      PIC X.
000034               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
000035               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
000036               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
000037               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
000038
000039         16  EC-BR-LF-EARNINGS-CALC    PIC X.
000040               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
000041               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
000042               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
000043               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
000044               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
000045               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
000046               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
000047               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
000048               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
000049               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
000050
000051         16  EC-BR-AH-EARNINGS-CALC    PIC X.
000052               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
000053               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
000054               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
000055               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
000056               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
000057               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
000058               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
000059               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
000060
000061         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
000062                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
000063                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
000064
000065         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
000066                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
000067                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
000068                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
000069                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
000070                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
000071                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
000072                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
000073                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
000074
000075         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
000076               88  EC-BR-REDUCING                   VALUE 'R'.
000077               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
000078
000079         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
000080         16  EC-BR-LF-DESC             PIC X(10).
000081         16  EC-BR-AH-DESC             PIC X(10).
000082         16  EC-BR-LF-COMMENT          PIC X(10).
000083         16  EC-BR-AH-COMMENT          PIC X(10).
000084
000085         16  EC-BR-LF-REM-TERM-CALC    PIC X.
000086               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
000087               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
000088               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
000089               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
000090
000091         16  EC-BR-AH-REM-TERM-CALC    PIC X.
000092               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
000093               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
000094               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
000095               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
000096
000097         16  EC-BR-LF-REFUND-CALC      PIC X.
000098                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
000099                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
000100                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
000101                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
000102                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
000103                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
000104                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
000105
000106         16  EC-BR-AH-REFUND-CALC      PIC X.
000107                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
000108                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
000109                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
000110                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
000111                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
000112                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
000113                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
000114                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
000115
000116         16  EC-BR-LF-BEN-I-G-CD       PIC X.
000117                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
000118                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
000119                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
000120
000121         16  EC-BR-AH-BEN-I-G-CD       PIC X.
000122                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
000123                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
000124                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
000125
000126         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
000127         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
000128         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
000129         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
000130
000131         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
000132         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
000133                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
000134                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
000135                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
000136                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
000137
000138         16  EC-ST-LF-REM-TERM-CALC    PIC X.
000139               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
000140               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
000141               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
000142               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
000143               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
000144
000145         16  EC-ST-AH-REM-TERM-CALC    PIC X.
000146               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
000147               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
000148               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
000149               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
000150               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
000151
000152         16  EC-ST-LF-REFUND-CALC      PIC X.
000153                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
000154                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
000155                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
000156                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
000157                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
000158                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
000159                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
000160                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
000161
000162         16  EC-ST-AH-REFUND-CALC      PIC X.
000163                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
000164                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
000165                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
000166                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
000167                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
000168                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
000169                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
000170                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
000171
000172         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
000173         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
000174         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
000175         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
000176         16  EC-AM-EXPIRATION-DT       PIC XX.
000177         16  EC-AM-EFFECTIVE-DT        PIC XX.
000178         16  EC-AM-CLASS-CD            PIC XX.
000179         16  EC-AM-LF-DEVIATION        PIC XXX.
000180         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
000181         16  EC-AM-AH-DEVIATION        PIC XXX.
000182         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
000183         16  EC-AM-PHONE-NO            PIC X(10).
000184
000185         16  EC-AM-LF-REFUND-CALC      PIC X.
000186                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
000187                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
000188                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
000189                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
000190                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
000191                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
000192                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
000193
000194         16  EC-AM-AH-REFUND-CALC      PIC X.
000195                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
000196                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
000197                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
000198                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
000199                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
000200                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
000201                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
000202
000203         16  EC-AM-BEN-I-G-CD          PIC X.
000204                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
000205                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
000206                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
000207
000208         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
000209         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
000210         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
000211         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
000212         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
000213         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
000214         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
000215         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
000216         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
000217
000218         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
000219         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
000220         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
000221         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
000222         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
000223         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
000224         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
000225         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
000226         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
000227         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
000228         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
000229         16  EC-RT-LF-NSP-ST           PIC XX.
000230         16  EC-RT-AH-NSP-ST           PIC XX.
000231         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
000232         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
000233
000234         16  EC-CM-LF-PRIOR-STATUS     PIC X.
000235             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
000236                                             'M' '5' '9' '2'.
000237             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
000238             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
000239             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
000240             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
000241             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
000242             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
000243             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
000244             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
000245             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
000246             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
000247
000248         16  EC-CM-AH-PRIOR-STATUS     PIC X.
000249             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
000250                                             'M' '5' '9' '2'.
000251             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
000252             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
000253             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
000254             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
000255             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
000256             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
000257             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
000258             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
000259             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
000260             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
000261
000262         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
000263         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
000264         16  EC-CM-LF-CANCEL-DT        PIC XX.
000265         16  EC-CM-AH-CANCEL-DT        PIC XX.
000266         16  EC-CM-DEATH-DT            PIC XX.
000267
000268*DMD CUSTOM CODING FIELDS BELOW
000269*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
000270         16  EC-BR-DMD-RATING-SW       PIC X.
000271                 88  EC-DMD-AH-RATING            VALUE 'Y'.
000272                 88  EC-DMD-LF-RATING            VALUE 'Y'.
000273                 88  NO-DMD-RATING               VALUE 'N'.
000274
000275         16  EC-NEW-CERT               PIC X(11).
000276         16  EC-NEW-STATE              PIC XX.
000277         16  FILLER                    PIC X.
000278*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
000279         16  OVER-SHORT-EDIT-FIELDS.
000280             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
000281             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
000282             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
000283             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
000284             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
000285             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
000286             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
000287             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
000288             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
000289         16  FILLER                    PIC X(71).
      *<<((file: ELCEDITC))
000372******************************************************************
000373
000374     EJECT
000375*    COPY ELCDIFRD.
      *>>((file: ELCDIFRD))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCDIFRD.                           *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.004                          *
000007*                                                                *
000008*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
000009*                                                                *
000010******************************************************************
000011*
000012  01  WS-DIFFERENCE-CALCULATION.
000013        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
000014        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
000015        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
000016        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
000017        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
000018        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
000019        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
000020        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
000021        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
000022        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
000023        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
      *<<((file: ELCDIFRD))
000376
000377     EJECT
      ****************************************************************
      *                                                               
      * Copyright (c) 2016-2020 NTT DATA, Inc.                        
      * All rights reserved.                                          
      *                                                               
      ****************************************************************
       01  DFHEIV.                                                    
         02  DFHEIV0               PIC X(35).                         
         02  DFHEIV1               PIC X(08).                         
         02  DFHEIV2               PIC X(08).                         
         02  DFHEIV3               PIC X(08).                         
         02  DFHEIV4               PIC X(06).                         
         02  DFHEIV5               PIC X(04).                         
         02  DFHEIV6               PIC X(04).                         
         02  DFHEIV7               PIC X(02).                         
         02  DFHEIV8               PIC X(02).                         
         02  DFHEIV9               PIC X(01).                         
         02  DFHEIV10              PIC S9(7) COMP-3.                  
         02  DFHEIV11              PIC S9(4) COMP SYNC.               
         02  DFHEIV12              PIC S9(4) COMP SYNC.               
         02  DFHEIV13              PIC S9(4) COMP SYNC.               
         02  DFHEIV14              PIC S9(4) COMP SYNC.               
         02  DFHEIV15              PIC S9(4) COMP SYNC.               
         02  DFHEIV16              PIC S9(9) COMP SYNC.               
         02  DFHEIV17              PIC X(04).                         
         02  DFHEIV18              PIC X(04).                         
         02  DFHEIV19              PIC X(04).                         
         02  DFHEIV20              USAGE IS POINTER.                  
         02  DFHEIV21              USAGE IS POINTER.                  
         02  DFHEIV22              USAGE IS POINTER.                  
         02  DFHEIV23              USAGE IS POINTER.                  
         02  DFHEIV24              USAGE IS POINTER.                  
         02  DFHEIV25              PIC S9(9) COMP SYNC.               
         02  DFHEIV26              PIC S9(9) COMP SYNC.               
         02  DFHEIV27              PIC S9(9) COMP SYNC.               
         02  DFHEIV28              PIC S9(9) COMP SYNC.               
         02  DFHEIV29              PIC S9(9) COMP SYNC.               
         02  DFHEIV30              PIC S9(9) COMP SYNC.               
         02  DFHEIV31              PIC S9(9) COMP SYNC.               
         02  DFHEIV32              PIC S9(4) COMP SYNC.               
         02  DFHEIV33              PIC S9(4) COMP SYNC.               
         02  DFHEIV34              PIC S9(4) COMP SYNC.               
         02  DFHEIV35              PIC S9(4) COMP SYNC.               
         02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.       
         02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.    
         02  FILLER                PIC X(02).                         
         02  DFHEIV99              PIC X(08) VALUE SPACE.             
         02  DFHEIVL0              PIC X(48) VALUE SPACE.             
         02  DFHEIVL1              PIC X(48) VALUE SPACE.             
         02  DFHEIVL2              PIC X(48) VALUE SPACE.             
         02  DFHEIVL3              PIC X(48) VALUE SPACE.             
         02  DFHEIVL4              PIC X(255) VALUE SPACE.            
         02  DFHEIVL5              PIC X(255) VALUE SPACE.            
       LINKAGE  SECTION.
      *****************************************************************
      *                                                               *
      * Copyright (c) 2016-2020 NTT DATA, Inc.                        *
      * All rights reserved.                                          *
      *                                                               *
      *****************************************************************
       01  dfheiblk.
           02  eibtime          pic s9(7) comp-3.
           02  eibdate          pic s9(7) comp-3.
           02  eibtrnid         pic x(4).
           02  eibtaskn         pic s9(7) comp-3.
           02  eibtrmid         pic x(4).
           02  dfheigdi         pic s9(4) comp.
           02  eibcposn         pic s9(4) comp.
           02  eibcalen         pic s9(4) comp.
           02  eibaid           pic x(1).
           02  eibfiller1       pic x(1).
           02  eibfn            pic x(2).
           02  eibfiller2       pic x(2).
           02  eibrcode         pic x(6).
           02  eibfiller3       pic x(2).
           02  eibds            pic x(8).
           02  eibreqid         pic x(8).
           02  eibrsrce         pic x(8).
           02  eibsync          pic x(1).
           02  eibfree          pic x(1).
           02  eibrecv          pic x(1).
           02  eibsend          pic x(1).
           02  eibatt           pic x(1).
           02  eibeoc           pic x(1).
           02  eibfmh           pic x(1).
           02  eibcompl         pic x(1).
           02  eibsig           pic x(1).
           02  eibconf          pic x(1).
           02  eiberr           pic x(1).
           02  eibrldbk         pic x(1).
           02  eiberrcd         pic x(4).
           02  eibsynrb         pic x(1).
           02  eibnodat         pic x(1).
           02  eibfiller5       pic x(2).
           02  eibresp          pic s9(8) comp.
           02  eibresp2         pic s9(8) comp.
           02  dfheigdj         pic s9(4) comp.
           02  dfheigdk         pic s9(4) comp.
000379
000380 01  DFHCOMMAREA                   PIC X(1036).
000381
000382*01 PARMLIST .
000383*    02  FILLER                    PIC S9(8)   COMP.
000384*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
000385*    02  ERACCT-POINTER            PIC S9(8)   COMP.
000386*    02  ERREIN-POINTER            PIC S9(8)   COMP.
000387*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
000388*    02  ERFORM-POINTER            PIC S9(8)   COMP.
000389*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
000390*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
000391
000392     EJECT
000393*    COPY ELCCNTL.
      *>>((file: ELCCNTL))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCCNTL.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.059                          *
000007*                                                                *
000008*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
000009*                                                                *
000010*   FILE TYPE = VSAM,KSDS                                        *
000011*   RECORD SIZE = 750  RECFORM = FIXED                           *
000012*                                                                *
000013*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
000014*       ALTERNATE INDEX = NONE                                   *
000015*                                                                *
000016*   LOG = YES                                                    *
000017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000018******************************************************************
000019*                   C H A N G E   L O G
000020*
000021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000022*-----------------------------------------------------------------
000023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000024* EFFECTIVE    NUMBER
000025*-----------------------------------------------------------------
000026* 082503                   PEMA  ADD BENEFIT GROUP
000027* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
000028* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
000029* 092705    2005050300006  PEMA  ADD SPP LEASES
000030* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
000031* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
000032* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
000033* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
000034* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
000035* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
000036* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
000037* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
000038* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
000039* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
000040* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
000041******************************************************************
000042*
000043 01  CONTROL-FILE.
000044     12  CF-RECORD-ID                       PIC XX.
000045         88  VALID-CF-ID                        VALUE 'CF'.
000046
000047     12  CF-CONTROL-PRIMARY.
000048         16  CF-COMPANY-ID                  PIC XXX.
000049         16  CF-RECORD-TYPE                 PIC X.
000050             88  CF-COMPANY-MASTER              VALUE '1'.
000051             88  CF-PROCESSOR-MASTER            VALUE '2'.
000052             88  CF-STATE-MASTER                VALUE '3'.
000053             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
000054             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
000055             88  CF-CARRIER-MASTER              VALUE '6'.
000056             88  CF-MORTALITY-MASTER            VALUE '7'.
000057             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
000058             88  CF-TERMINAL-MASTER             VALUE '9'.
000059             88  CF-AH-EDIT-MASTER              VALUE 'A'.
000060             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
000061             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
000062             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
000063             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
000064             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
000065             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
000066             88  CF-REMINDERS-MASTER            VALUE 'R'.
000067             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
000068         16  CF-ACCESS-CD-GENL              PIC X(4).
000069         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
000070             20  CF-PROCESSOR               PIC X(4).
000071         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
000072             20  CF-STATE-CODE              PIC XX.
000073             20  FILLER                     PIC XX.
000074         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
000075             20  FILLER                     PIC XX.
000076             20  CF-HI-BEN-IN-REC           PIC XX.
000077         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
000078             20  FILLER                     PIC XXX.
000079             20  CF-CARRIER-CNTL            PIC X.
000080         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
000081             20  FILLER                     PIC XX.
000082             20  CF-HI-TYPE-IN-REC          PIC 99.
000083         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
000084             20  CF-CRDB-TABLE-INDICATOR    PIC X.
000085                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
000086             20  CF-CRDB-BENEFIT-TYPE       PIC X.
000087             20  CF-CRDB-WAITING-PERIOD     PIC XX.
000088         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
000089             20  FILLER                     PIC X.
000090             20  CF-CUSTOM-REPORT-NO        PIC 999.
000091         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
000092             20  FILLER                     PIC XX.
000093             20  CF-MORTGAGE-PLAN           PIC XX.
000094         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
000095
000096     12  CF-LAST-MAINT-DT                   PIC XX.
000097     12  CF-LAST-MAINT-BY                   PIC X(4).
000098     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
000099
000100     12  CF-RECORD-BODY                     PIC X(728).
000101
000102
000103****************************************************************
000104*             COMPANY MASTER RECORD                            *
000105****************************************************************
000106
000107     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
000108         16  CF-COMPANY-ADDRESS.
000109             20  CF-CL-MAIL-TO-NAME         PIC X(30).
000110             20  CF-CL-IN-CARE-OF           PIC X(30).
000111             20  CF-CL-ADDR-LINE-1          PIC X(30).
000112             20  CF-CL-ADDR-LINE-2          PIC X(30).
000113             20  CF-CL-CITY-STATE           PIC X(30).
000114             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
000115             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
000116         16  CF-COMPANY-CD                  PIC X.
000117         16  CF-COMPANY-PASSWORD            PIC X(8).
000118         16  CF-SECURITY-OPTION             PIC X.
000119             88  ALL-SECURITY                   VALUE '1'.
000120             88  COMPANY-VERIFY                 VALUE '2'.
000121             88  PROCESSOR-VERIFY               VALUE '3'.
000122             88  NO-SECURITY                    VALUE '4'.
000123             88  ALL-BUT-TERM                   VALUE '5'.
000124         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
000125             88  USE-ACTUAL-CARRIER             VALUE SPACE.
000126         16  CF-LGX-INTERFACE-CNTL          PIC X.
000127             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
000128         16  CF-INFORCE-LOCATION            PIC X.
000129             88  CERTS-ARE-ONLINE               VALUE '1'.
000130             88  CERTS-ARE-OFFLINE              VALUE '2'.
000131             88  NO-CERTS-AVAILABLE             VALUE '3'.
000132         16  CF-LOWER-CASE-LETTERS          PIC X.
000133         16  CF-CERT-ACCESS-CONTROL         PIC X.
000134             88  CF-ST-ACCNT-CNTL               VALUE ' '.
000135             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
000136             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
000137             88  CF-ACCNT-CNTL                  VALUE '3'.
000138             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
000139
000140         16  CF-FORMS-PRINTER-ID            PIC X(4).
000141         16  CF-CHECK-PRINTER-ID            PIC X(4).
000142
000143         16  CF-LGX-CREDIT-USER             PIC X.
000144             88  CO-IS-NOT-USER                 VALUE 'N'.
000145             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
000146
000147         16 CF-CREDIT-CALC-CODES.
000148             20  CF-CR-REM-TERM-CALC PIC X.
000149               88  CR-EARN-AFTER-15TH           VALUE '1'.
000150               88  CR-EARN-ON-HALF-MO           VALUE '2'.
000151               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
000152               88  CR-EARN-ON-FULL-MO           VALUE '4'.
000153               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
000154               88  CR-EARN-AFTER-14TH           VALUE '6'.
000155               88  CR-EARN-AFTER-16TH           VALUE '7'.
000156             20  CF-CR-R78-METHOD           PIC X.
000157               88  USE-TERM-PLUS-ONE            VALUE SPACE.
000158               88  DONT-USE-PLUS-ONE            VALUE '1'.
000159
000160         16  CF-CLAIM-CONTROL-COUNTS.
000161             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
000162                 88  CO-CLM-COUNT-RESET         VALUE +99999.
000163
000164             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
000165                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
000166
000167             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
000168                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
000169
000170             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
000171                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
000172
000173         16  CF-CURRENT-MONTH-END           PIC XX.
000174
000175         16  CF-CO-CALC-QUOTE-TOLERANCE.
000176             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
000177             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
000178             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
000179             20  CF-CO-CLAIM-REJECT-SW      PIC X.
000180                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
000181                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
000182             20  CF-CO-PREM-REJECT-SW       PIC X.
000183                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
000184                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
000185             20  CF-CO-REF-REJECT-SW        PIC X.
000186                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
000187                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
000188
000189         16  CF-CO-REPORTING-DT             PIC XX.
000190         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
000191         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
000192           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
000193           88  CF-CO-MONTH-END                  VALUE '1'.
000194
000195         16  CF-LGX-CLAIM-USER              PIC X.
000196             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
000197             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
000198
000199         16  CF-CREDIT-EDIT-CONTROLS.
000200             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
000201             20  CF-MIN-AGE                 PIC 99.
000202             20  CF-DEFAULT-AGE             PIC 99.
000203             20  CF-MIN-TERM                PIC S999      COMP-3.
000204             20  CF-MAX-TERM                PIC S999      COMP-3.
000205             20  CF-DEFAULT-SEX             PIC X.
000206             20  CF-JOINT-AGE-INPUT         PIC X.
000207                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
000208             20  CF-BIRTH-DATE-INPUT        PIC X.
000209                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
000210             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
000211                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
000212                 88  CF-ZERO-CARRIER            VALUE '1'.
000213                 88  CF-ZERO-GROUPING           VALUE '2'.
000214                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
000215             20  CF-EDIT-SW                 PIC X.
000216                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
000217             20  CF-EDIT-RESTART-BATCH      PIC X(6).
000218             20  CF-CR-PR-METHOD            PIC X.
000219               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
000220               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
000221             20  FILLER                     PIC X.
000222
000223         16  CF-CREDIT-MISC-CONTROLS.
000224             20  CF-REIN-TABLE-SW           PIC X.
000225                 88 REIN-TABLES-ARE-USED        VALUE '1'.
000226             20  CF-COMP-TABLE-SW           PIC X.
000227                 88 COMP-TABLES-ARE-USED        VALUE '1'.
000228             20  CF-EXPERIENCE-RETENTION-AGE
000229                                            PIC S9        COMP-3.
000230             20  CF-CONVERSION-DT           PIC XX.
000231             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
000232             20  CF-RUN-FREQUENCY-SW        PIC X.
000233                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
000234                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
000235
000236             20  CF-CR-CHECK-NO-CONTROL.
000237                 24  CF-CR-CHECK-NO-METHOD    PIC X.
000238                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
000239                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
000240                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
000241                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
000242                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
000243
000244                 24  CF-CR-CHECK-COUNT       REDEFINES
000245                     CF-CR-CHECK-COUNTER      PIC X(4).
000246
000247                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
000248                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
000249
000250                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
000251                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
000252                 24  CF-MAIL-PROCESSING       PIC X.
000253                     88  MAIL-PROCESSING          VALUE 'Y'.
000254
000255         16  CF-MISC-SYSTEM-CONTROL.
000256             20  CF-SYSTEM-C                 PIC X.
000257                 88  CONFIRMATION-SYS-USED       VALUE '1'.
000258             20  CF-SYSTEM-D                 PIC X.
000259                 88  DAILY-BILL-SYS-USED         VALUE '1'.
000260             20  CF-SOC-SEC-NO-SW            PIC X.
000261                 88  SOC-SEC-NO-USED             VALUE '1'.
000262             20  CF-MEMBER-NO-SW             PIC X.
000263                 88  MEMBER-NO-USED              VALUE '1'.
000264             20  CF-TAX-ID-NUMBER            PIC X(11).
000265             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
000266             20  CF-PAYMENT-APPROVAL-SW      PIC X.
000267                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
000268                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
000269                 88  CF-ALL-APPROVED             VALUE 'Y'.
000270                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
000271             20  CF-SYSTEM-E                 PIC X.
000272                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
000273
000274         16  CF-LGX-LIFE-USER               PIC X.
000275             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
000276             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
000277
000278         16  CF-CR-MONTH-END-DT             PIC XX.
000279
000280         16  CF-FILE-MAINT-DATES.
000281             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
000282                 88  CF-LAST-BATCH-RESET        VALUE +999999.
000283             20  CF-LAST-BATCH       REDEFINES
000284                 CF-LAST-BATCH-NO               PIC X(4).
000285             20  CF-RATES-FILE-MAINT-DT         PIC XX.
000286             20  CF-RATES-FILE-CREATE-DT        PIC XX.
000287             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
000288             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
000289             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
000290             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
000291             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
000292             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
000293             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
000294             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
000295
000296         16  CF-NEXT-COMPANY-ID             PIC XXX.
000297         16  FILLER                         PIC X.
000298
000299         16  CF-ALT-MORT-CODE               PIC X(4).
000300         16  CF-MEMBER-CAPTION              PIC X(10).
000301
000302         16  CF-LIFE-ACCESS-CONTROL         PIC X.
000303             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
000304             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
000305             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
000306             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
000307             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
000308
000309         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
000310
000311         16  CF-LIFE-OVERRIDE-L1            PIC X.
000312         16  CF-LIFE-OVERRIDE-L2            PIC XX.
000313         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
000314         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
000315
000316         16  CF-AH-OVERRIDE-L1              PIC X.
000317         16  CF-AH-OVERRIDE-L2              PIC XX.
000318         16  CF-AH-OVERRIDE-L6              PIC X(6).
000319         16  CF-AH-OVERRIDE-L12             PIC X(12).
000320
000321         16  CF-REPORT-CD1-CAPTION          PIC X(10).
000322         16  CF-REPORT-CD2-CAPTION          PIC X(10).
000323
000324         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
000325         16  CF-AR-LAST-EL860-DT            PIC XX.
000326         16  CF-MP-MONTH-END-DT             PIC XX.
000327
000328         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
000329         16  CF-CLAIM-PAID-THRU-TO          PIC X.
000330             88  CF-CLAIM-PAID-TO               VALUE '1'.
000331
000332         16  CF-AR-MONTH-END-DT             PIC XX.
000333
000334         16  CF-CRDTCRD-USER                PIC X.
000335             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
000336             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
000337
000338         16  CF-CC-MONTH-END-DT             PIC XX.
000339
000340         16  CF-PRINT-ADDRESS-LABELS        PIC X.
000341
000342         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
000343             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
000344             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
000345             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
000346         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
000347         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
000348         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
000349         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
000350             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
000351             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
000352         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
000353         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
000354         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
000355             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
000356         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
000357
000358         16  CF-CL-ZIP-CODE.
000359             20  CF-CL-ZIP-PRIME.
000360                 24  CF-CL-ZIP-1ST          PIC X.
000361                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
000362                 24  FILLER                 PIC X(4).
000363             20  CF-CL-ZIP-PLUS4            PIC X(4).
000364         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
000365             20  CF-CL-CAN-POSTAL-1         PIC XXX.
000366             20  CF-CL-CAN-POSTAL-2         PIC XXX.
000367             20  FILLER                     PIC XXX.
000368
000369         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
000370         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
000371         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
000372         16  CF-CO-OPTION-START-DATE        PIC XX.
000373         16  CF-REM-TRM-CALC-OPTION         PIC X.
000374           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
000375                                                      '3' '4'.
000376           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
000377           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
000378           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
000379           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
000380           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
000381           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
000382
000383         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
000384
000385         16  CF-PAYMENT-APPROVAL-LEVELS.
000386             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
000387             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
000388             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
000389             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
000390             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
000391             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
000392
000393         16  CF-END-USER-REPORTING-USER     PIC X.
000394             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
000395             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
000396
000397         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
000398             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
000399             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
000400
000401         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
000402
000403         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
000404         16  FILLER                         PIC X.
000405
000406         16  CF-CREDIT-ARCHIVE-CNTL.
000407             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
000408             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
000409             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
000410
000411         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
000412
000413         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
000414             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
000415             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
000416
000417         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
000418             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
000419             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
000420
000421         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
000422
000423         16  CF-CO-ACH-ID-CODE              PIC  X.
000424             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
000425             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
000426             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
000427         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
000428         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
000429         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
000430         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
000431         16  CF-CO-ACH-RECV-NAME            PIC X(23).
000432         16  CF-CO-ACH-RECV-NO              PIC X(08).
000433         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
000434         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
000435         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
000436                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
000437         16  CF-CO-ACH-TRACE-SPACE REDEFINES
000438                 CF-CO-ACH-TRACE-NO         PIC X(4).
000439
000440         16  CF-CO-OVER-SHORT.
000441             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
000442             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
000443
000444*         16  FILLER                         PIC X(102).
000445         16  CF-PAYMENT-APPROVAL-LEVELS-2.
000446             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
000447             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
000448
000449         16  CF-AH-APPROVAL-DAYS.
000450             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
000451             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
000452             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
000453             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
000454
000455         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
000456
000457         16  CF-APPROV-LEV-5.
000458             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
000459             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
000460             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
000461
000462         16  FILLER                         PIC X(68).
000463****************************************************************
000464*             PROCESSOR/USER RECORD                            *
000465****************************************************************
000466
000467     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
000468         16  CF-PROCESSOR-NAME              PIC X(30).
000469         16  CF-PROCESSOR-PASSWORD          PIC X(11).
000470         16  CF-PROCESSOR-TITLE             PIC X(26).
000471         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
000472                 88  MESSAGE-YES                VALUE 'Y'.
000473                 88  MESSAGE-NO                 VALUE ' ' 'N'.
000474
000475*****************************************************
000476****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
000477****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
000478****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
000479****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
000480*****************************************************
000481
000482         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
000483             20  CF-ADMINISTRATION-CONTROLS PIC XX.
000484             20  CF-APPLICATION-FORCE       PIC X.
000485             20  CF-INDIVIDUAL-APP.
000486                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
000487                     28  CF-BROWSE-APP      PIC X.
000488                     28  CF-UPDATE-APP      PIC X.
000489
000490         16  CF-CURRENT-TERM-ON             PIC X(4).
000491         16  CF-PROCESSOR-LIMITS-CLAIMS.
000492             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
000493             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
000494             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
000495             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
000496             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
000497             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
000498             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
000499         16  CF-PROCESSOR-CARRIER           PIC X.
000500             88  NO-CARRIER-SECURITY            VALUE ' '.
000501         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
000502             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
000503         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
000504             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
000505         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
000506             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
000507
000508         16  CF-PROC-SYS-ACCESS-SW.
000509             20  CF-PROC-CREDIT-CLAIMS-SW.
000510                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
000511                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
000512                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
000513                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
000514             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
000515                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
000516                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
000517             20  CF-PROC-LIFE-GNRLDGR-SW.
000518                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
000519                     88  ACCESS-TO-LIFE             VALUE 'Y'.
000520                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
000521                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
000522             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
000523                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
000524                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
000525         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
000526             CF-PROC-SYS-ACCESS-SW              PIC X(4).
000527             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
000528         16  CF-PROCESSOR-PRINTER               PIC X(4).
000529
000530         16  CF-APPROVAL-LEVEL                  PIC X.
000531             88  APPROVAL-LEVEL-1                   VALUE '1'.
000532             88  APPROVAL-LEVEL-2                   VALUE '2'.
000533             88  APPROVAL-LEVEL-3                   VALUE '3'.
000534             88  APPROVAL-LEVEL-4                   VALUE '4'.
000535             88  APPROVAL-LEVEL-5                   VALUE '5'.
000536
000537         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
000538
000539         16  CF-LANGUAGE-TYPE                   PIC X.
000540             88  CF-LANG-IS-ENG                     VALUE 'E'.
000541             88  CF-LANG-IS-FR                      VALUE 'F'.
000542
000543         16  CF-CSR-IND                         PIC X.
000544         16  FILLER                             PIC X(239).
000545
000546****************************************************************
000547*             PROCESSOR/REMINDERS RECORD                       *
000548****************************************************************
000549
000550     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
000551         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
000552             20  CF-START-REMIND-DT         PIC XX.
000553             20  CF-END-REMIND-DT           PIC XX.
000554             20  CF-REMINDER-TEXT           PIC X(50).
000555         16  FILLER                         PIC X(296).
000556
000557
000558****************************************************************
000559*             STATE MASTER RECORD                              *
000560****************************************************************
000561
000562     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
000563         16  CF-STATE-ABBREVIATION          PIC XX.
000564         16  CF-STATE-NAME                  PIC X(25).
000565         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
000566         16  CF-ST-CALC-QUOTE-TOLERANCE.
000567             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
000568             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
000569             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
000570             20  CF-ST-CLAIM-REJECT-SW      PIC X.
000571                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
000572                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
000573             20  CF-ST-PREM-REJECT-SW       PIC X.
000574                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
000575                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
000576             20  CF-ST-REF-REJECT-SW        PIC X.
000577                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
000578                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
000579         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
000580         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
000581         16  CF-ST-REFUND-RULES.
000582             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
000583             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
000584             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
000585         16  CF-ST-FST-PMT-EXTENSION.
000586             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
000587             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
000588                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
000589                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
000590                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
000591                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
000592         16  CF-ST-STATE-CALL.
000593             20  CF-ST-CALL-UNEARNED        PIC X.
000594             20  CF-ST-CALL-RPT-CNTL        PIC X.
000595             20  CF-ST-CALL-RATE-DEV        PIC XXX.
000596         16  CF-REPLACEMENT-LAW-SW          PIC X.
000597             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
000598             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
000599         16  CF-REPLACEMENT-LETTER          PIC X(4).
000600         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
000601         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
000602         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
000603         16  CF-ST-SPLIT-PAYMENT            PIC X.
000604         16  FILLER                         PIC X.
000605         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
000606             20  CF-ST-BENEFIT-CD           PIC XX.
000607             20  CF-ST-BENEFIT-KIND         PIC X.
000608                 88  CF-ST-LIFE-KIND            VALUE 'L'.
000609                 88  CF-ST-AH-KIND              VALUE 'A'.
000610             20  CF-ST-REM-TERM-CALC        PIC X.
000611                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
000612                 88  ST-EARN-AFTER-15TH         VALUE '1'.
000613                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
000614                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
000615                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
000616                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
000617                 88  ST-EARN-AFTER-14TH         VALUE '6'.
000618                 88  ST-EARN-AFTER-16TH         VALUE '7'.
000619
000620             20  CF-ST-REFUND-CALC          PIC X.
000621                 88  ST-REFUND-NOT-USED         VALUE SPACE.
000622                 88  ST-REFD-BY-R78             VALUE '1'.
000623                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
000624                 88  ST-REFD-AS-CALIF           VALUE '3'.
000625                 88  ST-REFD-AS-TEXAS           VALUE '4'.
000626                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
000627                 88  ST-REFD-ANTICIPATION       VALUE '6'.
000628                 88  ST-REFD-UTAH               VALUE '7'.
000629                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
000630                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
000631                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
000632
000633             20  CF-ST-EARNING-CALC         PIC X.
000634                 88  ST-EARNING-NOT-USED        VALUE SPACE.
000635                 88  ST-EARN-BY-R78             VALUE '1'.
000636                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
000637                 88  ST-EARN-AS-CALIF           VALUE '3'.
000638                 88  ST-EARN-AS-TEXAS           VALUE '4'.
000639                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
000640                 88  ST-EARN-ANTICIPATION       VALUE '6'.
000641                 88  ST-EARN-MEAN               VALUE '8'.
000642                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
000643
000644             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
000645                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
000646                 88  ST-OVRD-BY-R78             VALUE '1'.
000647                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
000648                 88  ST-OVRD-AS-CALIF           VALUE '3'.
000649                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
000650                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
000651                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
000652                 88  ST-OVRD-MEAN               VALUE '8'.
000653                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
000654             20  cf-st-extra-periods        pic 9.
000655*            20  FILLER                     PIC X.
000656
000657         16  CF-ST-COMMISSION-CAPS.
000658             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
000659             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
000660             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
000661             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
000662         16  CF-COMM-CAP-LIMIT-TO           PIC X.
000663                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
000664                 88  ST-LIMIT-TO-GA             VALUE 'G'.
000665                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
000666
000667         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
000668
000669         16  CF-ST-STATUTORY-INTEREST.
000670             20  CF-ST-STAT-DATE-FROM       PIC X.
000671                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
000672                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
000673             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
000674             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
000675             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
000676             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
000677             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
000678
000679         16  CF-ST-OVER-SHORT.
000680             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
000681             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
000682
000683         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
000684
000685         16  CF-ST-RT-CALC                  PIC X.
000686
000687         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
000688         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
000689         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
000690         16  CF-ST-RF-LR-CALC               PIC X.
000691         16  CF-ST-RF-LL-CALC               PIC X.
000692         16  CF-ST-RF-LN-CALC               PIC X.
000693         16  CF-ST-RF-AH-CALC               PIC X.
000694         16  CF-ST-RF-CP-CALC               PIC X.
000695*        16  FILLER                         PIC X(206).
000696*CIDMOD         16  FILLER                         PIC X(192).
000697         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
000698             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
000699         16  CF-ST-REF-AH-DEATH-IND         PIC X.
000700         16  CF-ST-VFY-2ND-BENE             PIC X.
000701         16  CF-ST-CAUSAL-STATE             PIC X.
000702         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
000703         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
000704         16  CF-ST-AGENT-SIG-EDIT           PIC X.
000705             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
000706         16  CF-ST-NET-ONLY-STATE           PIC X.
000707             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
000708         16  cf-commission-cap-required     pic x.
000709         16  CF-ST-GA-COMMISSION-CAPS.
000710             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
000711             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
000712             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
000713             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
000714         16  CF-ST-TOT-COMMISSION-CAPS.
000715             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
000716             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
000717             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
000718             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
000719         16  FILLER                         PIC X(156).
000720
000721****************************************************************
000722*             BENEFIT MASTER RECORD                            *
000723****************************************************************
000724
000725     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
000726         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
000727             20  CF-BENEFIT-CODE            PIC XX.
000728             20  CF-BENEFIT-NUMERIC  REDEFINES
000729                 CF-BENEFIT-CODE            PIC XX.
000730             20  CF-BENEFIT-ALPHA           PIC XXX.
000731             20  CF-BENEFIT-DESCRIP         PIC X(10).
000732             20  CF-BENEFIT-COMMENT         PIC X(10).
000733
000734             20  CF-LF-COVERAGE-TYPE        PIC X.
000735                 88  CF-REDUCING                VALUE 'R'.
000736                 88  CF-LEVEL                   VALUE 'L' 'P'.
000737
000738             20  CF-SPECIAL-CALC-CD         PIC X.
000739                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
000740                 88  CF-NP-0-MO-INT             VALUE 'A'.
000741                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
000742                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
000743                 88  CF-TERM-IN-DAYS            VALUE 'D'.
000744                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
000745                 88  CF-FARM-PLAN               VALUE 'F'.
000746                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
000747                 88  CF-2-MTH-INTEREST          VALUE 'I'.
000748                 88  CF-3-MTH-INTEREST          VALUE 'J'.
000749                 88  CF-4-MTH-INTEREST          VALUE 'K'.
000750                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
000751                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
000752                 88  CF-PRUDENTIAL              VALUE 'P'.
000753                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
000754                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
000755                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
000756                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
000757                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
000758                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
000759
000760             20  CF-JOINT-INDICATOR         PIC X.
000761                 88  CF-JOINT-COVERAGE          VALUE 'J'.
000762
000763*            20  FILLER                     PIC X(12).
000764             20  cf-maximum-benefits        pic s999 comp-3.
000765             20  FILLER                     PIC X(09).
000766             20  CF-BENEFIT-CATEGORY        PIC X.
000767             20  CF-LOAN-TYPE               PIC X(8).
000768
000769             20  CF-CO-REM-TERM-CALC        PIC X.
000770                 88  CO-EARN-AFTER-15TH         VALUE '1'.
000771                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
000772                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
000773                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
000774                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
000775
000776             20  CF-CO-EARNINGS-CALC        PIC X.
000777                 88  CO-EARN-BY-R78             VALUE '1'.
000778                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
000779                 88  CO-EARN-AS-CALIF           VALUE '3'.
000780                 88  CO-EARN-AS-TEXAS           VALUE '4'.
000781                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
000782                 88  CO-EARN-ANTICIPATION       VALUE '6'.
000783                 88  CO-EARN-AS-MEAN            VALUE '8'.
000784                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
000785
000786             20  CF-CO-REFUND-CALC          PIC X.
000787                 88  CO-REFUND-NOT-USED         VALUE SPACE.
000788                 88  CO-REFD-BY-R78             VALUE '1'.
000789                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
000790                 88  CO-REFD-AS-CALIF           VALUE '3'.
000791                 88  CO-REFD-AS-TEXAS           VALUE '4'.
000792                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
000793                 88  CO-REFD-ANTICIPATION       VALUE '6'.
000794                 88  CO-REFD-MEAN               VALUE '8'.
000795                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
000796                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
000797                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
000798
000799             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
000800                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
000801                 88  CO-OVRD-BY-R78             VALUE '1'.
000802                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
000803                 88  CO-OVRD-AS-CALIF           VALUE '3'.
000804                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
000805                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
000806                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
000807                 88  CO-OVRD-MEAN               VALUE '8'.
000808                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
000809
000810             20  CF-CO-BEN-I-G-CD           PIC X.
000811                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
000812                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
000813                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
000814
000815         16  FILLER                         PIC X(304).
000816
000817
000818****************************************************************
000819*             CARRIER MASTER RECORD                            *
000820****************************************************************
000821
000822     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
000823         16  CF-ADDRESS-DATA.
000824             20  CF-MAIL-TO-NAME            PIC X(30).
000825             20  CF-IN-CARE-OF              PIC X(30).
000826             20  CF-ADDRESS-LINE-1          PIC X(30).
000827             20  CF-ADDRESS-LINE-2          PIC X(30).
000828             20  CF-CITY-STATE              PIC X(30).
000829             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
000830             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
000831
000832         16  CF-CLAIM-NO-CONTROL.
000833             20  CF-CLAIM-NO-METHOD         PIC X.
000834                 88  CLAIM-NO-MANUAL            VALUE '1'.
000835                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
000836                 88  CLAIM-NO-SEQ               VALUE '3'.
000837                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
000838             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
000839                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
000840                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
000841                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
000842
000843         16  CF-CHECK-NO-CONTROL.
000844             20  CF-CHECK-NO-METHOD         PIC X.
000845                 88  CHECK-NO-MANUAL            VALUE '1'.
000846                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
000847                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
000848                 88  CHECK-NO-AT-PRINT          VALUE '4'.
000849             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
000850                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
000851
000852         16  CF-DOMICILE-STATE              PIC XX.
000853
000854         16  CF-EXPENSE-CONTROLS.
000855             20  CF-EXPENSE-METHOD          PIC X.
000856                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
000857                 88  DOLLARS-PER-PMT            VALUE '2'.
000858                 88  PERCENT-OF-PAYMENT         VALUE '3'.
000859                 88  DOLLARS-PER-MONTH          VALUE '4'.
000860             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
000861             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
000862
000863         16  CF-CORRESPONDENCE-CONTROL.
000864             20  CF-LETTER-RESEND-OPT       PIC X.
000865                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
000866                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
000867             20  FILLER                     PIC X(4).
000868
000869         16  CF-RESERVE-CONTROLS.
000870             20  CF-MANUAL-SW               PIC X.
000871                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
000872             20  CF-FUTURE-SW               PIC X.
000873                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
000874             20  CF-PTC-SW                  PIC X.
000875                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
000876             20  CF-IBNR-SW                 PIC X.
000877                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
000878             20  CF-PTC-LF-SW               PIC X.
000879                 88  CF-LF-PTC-USED             VALUE '1'.
000880             20  CF-CDT-ACCESS-METHOD       PIC X.
000881                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
000882                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
000883                 88  CF-CDT-INTERPOLATED        VALUE '3'.
000884             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
000885
000886         16  CF-CLAIM-CALC-METHOD           PIC X.
000887             88  360-PLUS-MONTHS                VALUE '1'.
000888             88  365-PLUS-MONTHS                VALUE '2'.
000889             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
000890             88  360-DAILY                      VALUE '4'.
000891             88  365-DAILY                      VALUE '5'.
000892
000893         16  CF-LAST-ALPHA-CHARACTER        PIC X.
000894         16  FILLER                         PIC X(11).
000895
000896         16  CF-LIMIT-AMOUNTS.
000897             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
000898             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
000899             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
000900             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
000901             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
000902             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
000903             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
000904             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
000905             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
000906             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
000907
000908         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
000909         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
000910         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
000911
000912         16  CF-ZIP-CODE.
000913             20  CF-ZIP-PRIME.
000914                 24  CF-ZIP-1ST             PIC X.
000915                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
000916                 24  FILLER                 PIC X(4).
000917             20  CF-ZIP-PLUS4               PIC X(4).
000918         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
000919             20  CF-CAN-POSTAL-1            PIC XXX.
000920             20  CF-CAN-POSTAL-2            PIC XXX.
000921             20  FILLER                     PIC XXX.
000922
000923         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
000924         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
000925         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
000926
000927         16  CF-RATING-SWITCH               PIC X.
000928             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
000929             88  CF-NO-RATING                   VALUE 'N'.
000930
000931         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
000932
000933         16  CF-CARRIER-OVER-SHORT.
000934             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
000935             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
000936
000937         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
000938         16  CF-SECPAY-SWITCH               PIC X.
000939             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
000940             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
000941         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
000942         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
000943         16  FILLER                         PIC X(444).
000944*        16  FILLER                         PIC X(452).
000945
000946
000947****************************************************************
000948*             MORTALITY MASTER RECORD                          *
000949****************************************************************
000950
000951     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
000952         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
000953                                INDEXED BY CF-MORT-NDX.
000954             20  CF-MORT-TABLE              PIC X(5).
000955             20  CF-MORT-TABLE-TYPE         PIC X.
000956                 88  CF-MORT-JOINT              VALUE 'J'.
000957                 88  CF-MORT-SINGLE             VALUE 'S'.
000958                 88  CF-MORT-COMBINED           VALUE 'C'.
000959                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
000960                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
000961             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
000962             20  CF-MORT-AGE-METHOD         PIC XX.
000963                 88  CF-AGE-LAST                VALUE 'AL'.
000964                 88  CF-AGE-NEAR                VALUE 'AN'.
000965             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
000966             20  CF-MORT-ADJUSTMENT-DIRECTION
000967                                            PIC X.
000968                 88  CF-MINUS                   VALUE '-'.
000969                 88  CF-PLUS                    VALUE '+'.
000970             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
000971             20  CF-MORT-JOINT-CODE         PIC X.
000972                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
000973             20  CF-MORT-PC-Q               PIC X.
000974                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
000975             20  CF-MORT-TABLE-CODE         PIC X(4).
000976             20  CF-MORT-COMMENTS           PIC X(15).
000977             20  FILLER                     PIC X(14).
000978
000979         16  FILLER                         PIC X(251).
000980
000981
000982****************************************************************
000983*             BUSSINESS TYPE MASTER RECORD                     *
000984****************************************************************
000985
000986     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
000987* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
000988* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
000989* AND RECORD 05 IS TYPES 81-99
000990         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
000991             20  CF-BUSINESS-TITLE          PIC  X(19).
000992             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
000993                                            PIC S9V9(4) COMP-3.
000994             20  CF-BUS-EXCL-ST-CALL        PIC  X.
000995             20  FILLER                     PIC  X.
000996         16  FILLER                         PIC  X(248).
000997
000998
000999****************************************************************
001000*             TERMINAL MASTER RECORD                           *
001001****************************************************************
001002
001003     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
001004
001005         16  CF-COMPANY-TERMINALS.
001006             20  CF-TERMINAL-ID  OCCURS 120 TIMES
001007                                  PIC X(4).
001008         16  FILLER               PIC X(248).
001009
001010
001011****************************************************************
001012*             LIFE EDIT MASTER RECORD                          *
001013****************************************************************
001014
001015     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
001016         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
001017             20  CF-LIFE-CODE-IN            PIC XX.
001018             20  CF-LIFE-CODE-OUT           PIC XX.
001019         16  FILLER                         PIC X(248).
001020
001021
001022****************************************************************
001023*             AH EDIT MASTER RECORD                            *
001024****************************************************************
001025
001026     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
001027         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
001028             20  CF-AH-CODE-IN              PIC XXX.
001029             20  CF-AH-CODE-OUT             PIC XX.
001030         16  FILLER                         PIC X(248).
001031
001032
001033****************************************************************
001034*             CREDIBILITY TABLES                               *
001035****************************************************************
001036
001037     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
001038         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
001039                             INDEXED BY CF-CRDB-NDX.
001040             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
001041             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
001042             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
001043         16  FILLER                         PIC  X(332).
001044
001045
001046****************************************************************
001047*             REPORT CUSTOMIZATION RECORD                      *
001048****************************************************************
001049
001050     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
001051         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
001052             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
001053             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
001054             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
001055**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
001056****       A T-TRANSFER.                                   ****
001057             88  CF-ALL-ACCOUNTS                VALUE 'B'.
001058
001059         16  FILLER                         PIC XX.
001060
001061         16  CF-CARRIER-CNTL-OPT.
001062             20  CF-CARRIER-OPT-SEQ         PIC 9.
001063                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
001064                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
001065             20  CF-CARRIER-SELECT OCCURS 3 TIMES
001066                                            PIC X.
001067         16  CF-GROUP-CNTL-OPT.
001068             20  CF-GROUP-OPT-SEQ           PIC 9.
001069                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
001070                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
001071             20  CF-GROUP-SELECT OCCURS 3 TIMES
001072                                            PIC X(6).
001073         16  CF-STATE-CNTL-OPT.
001074             20  CF-STATE-OPT-SEQ           PIC 9.
001075                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
001076                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
001077             20  CF-STATE-SELECT OCCURS 3 TIMES
001078                                            PIC XX.
001079         16  CF-ACCOUNT-CNTL-OPT.
001080             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
001081                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
001082                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
001083             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
001084                                            PIC X(10).
001085         16  CF-BUS-TYP-CNTL-OPT.
001086             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
001087                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
001088                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
001089             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
001090                                            PIC XX.
001091         16  CF-LF-TYP-CNTL-OPT.
001092             20  CF-LF-TYP-OPT-SEQ          PIC 9.
001093                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
001094                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
001095             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
001096                                            PIC XX.
001097         16  CF-AH-TYP-CNTL-OPT.
001098             20  CF-AH-TYP-OPT-SEQ          PIC 9.
001099                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
001100                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
001101             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
001102                                            PIC XX.
001103         16  CF-REPTCD1-CNTL-OPT.
001104             20  CF-REPTCD1-OPT-SEQ         PIC 9.
001105                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
001106                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
001107             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
001108                                            PIC X(10).
001109         16  CF-REPTCD2-CNTL-OPT.
001110             20  CF-REPTCD2-OPT-SEQ         PIC 9.
001111                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
001112                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
001113             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
001114                                            PIC X(10).
001115         16  CF-USER1-CNTL-OPT.
001116             20  CF-USER1-OPT-SEQ           PIC 9.
001117                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
001118                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
001119             20  CF-USER1-SELECT OCCURS 3 TIMES
001120                                            PIC X(10).
001121         16  CF-USER2-CNTL-OPT.
001122             20  CF-USER2-OPT-SEQ           PIC 9.
001123                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
001124                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
001125             20  CF-USER2-SELECT OCCURS 3 TIMES
001126                                            PIC X(10).
001127         16  CF-USER3-CNTL-OPT.
001128             20  CF-USER3-OPT-SEQ           PIC 9.
001129                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
001130                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
001131             20  CF-USER3-SELECT OCCURS 3 TIMES
001132                                            PIC X(10).
001133         16  CF-USER4-CNTL-OPT.
001134             20  CF-USER4-OPT-SEQ           PIC 9.
001135                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
001136                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
001137             20  CF-USER4-SELECT OCCURS 3 TIMES
001138                                            PIC X(10).
001139         16  CF-USER5-CNTL-OPT.
001140             20  CF-USER5-OPT-SEQ           PIC 9.
001141                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
001142                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
001143             20  CF-USER5-SELECT OCCURS 3 TIMES
001144                                            PIC X(10).
001145         16  CF-REINS-CNTL-OPT.
001146             20  CF-REINS-OPT-SEQ           PIC 9.
001147                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
001148                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
001149             20  CF-REINS-SELECT OCCURS 3 TIMES.
001150                 24  CF-REINS-PRIME         PIC XXX.
001151                 24  CF-REINS-SUB           PIC XXX.
001152
001153         16  CF-AGENT-CNTL-OPT.
001154             20  CF-AGENT-OPT-SEQ           PIC 9.
001155                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
001156                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
001157             20  CF-AGENT-SELECT OCCURS 3 TIMES
001158                                            PIC X(10).
001159
001160         16  FILLER                         PIC X(43).
001161
001162         16  CF-LOSS-RATIO-SELECT.
001163             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
001164             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
001165         16  CF-ENTRY-DATE-SELECT.
001166             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
001167             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
001168         16  CF-EFFECTIVE-DATE-SELECT.
001169             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
001170             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
001171
001172         16  CF-EXCEPTION-LIST-IND          PIC X.
001173             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
001174
001175         16  FILLER                         PIC X(318).
001176
001177****************************************************************
001178*                  EXCEPTION REPORTING RECORD                  *
001179****************************************************************
001180
001181     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
001182         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
001183             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
001184
001185         16  CF-COMBINED-LIFE-AH-OPT.
001186             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
001187             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
001188             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
001189             20  CF-CANCELLATION-RATIO      PIC S9(02).
001190
001191         16  CF-LIFE-OPT.
001192             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
001193             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
001194             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
001195             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
001196             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
001197             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
001198             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
001199             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
001200             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
001201             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
001202
001203         16  CF-AH-OPT.
001204             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
001205             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
001206             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
001207             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
001208             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
001209             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
001210             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
001211             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
001212             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
001213             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
001214
001215         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
001216             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
001217             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
001218             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
001219
001220         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
001221
001222         16  FILLER                         PIC X(673).
001223
001224
001225****************************************************************
001226*             MORTGAGE SYSTEM PLAN RECORD                      *
001227****************************************************************
001228
001229     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
001230         16  CF-PLAN-TYPE                   PIC X.
001231             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
001232             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
001233             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
001234         16  CF-PLAN-ABBREV                 PIC XXX.
001235         16  CF-PLAN-DESCRIPT               PIC X(10).
001236         16  CF-PLAN-NOTES                  PIC X(20).
001237         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
001238         16  CF-PLAN-UNDERWRITING.
001239             20  CF-PLAN-TERM-DATA.
001240                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
001241                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
001242             20  CF-PLAN-AGE-DATA.
001243                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
001244                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
001245                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
001246             20  CF-PLAN-BENEFIT-DATA.
001247                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
001248                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
001249                 24  CF-MAXIMUM-MONTHLY-BENEFIT
001250                                            PIC S9(7)V99  COMP-3.
001251         16  CF-PLAN-POLICY-FORMS.
001252             20  CF-POLICY-FORM             PIC X(12).
001253             20  CF-MASTER-APPLICATION      PIC X(12).
001254             20  CF-MASTER-POLICY           PIC X(12).
001255         16  CF-PLAN-RATING.
001256             20  CF-RATE-CODE               PIC X(5).
001257             20  CF-SEX-RATING              PIC X.
001258                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
001259                 88  CF-PLAN-SEX-RATED         VALUE '2'.
001260             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
001261             20  CF-SUB-STD-TYPE            PIC X.
001262                 88  CF-PCT-OF-PREM            VALUE '1'.
001263                 88  CF-PCT-OF-BENE            VALUE '2'.
001264         16  CF-PLAN-PREM-TOLERANCES.
001265             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
001266             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
001267         16  CF-PLAN-PYMT-TOLERANCES.
001268             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
001269             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
001270         16  CF-PLAN-MISC-DATA.
001271             20  FILLER                     PIC X.
001272             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
001273             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
001274         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
001275         16  CF-PLAN-IND-GRP                PIC X.
001276             88  CF-MORT-INDIV-PLAN            VALUE 'I'
001277                                                     '1'.
001278             88  CF-MORT-GROUP-PLAN            VALUE 'G'
001279                                                     '2'.
001280         16  CF-MIB-SEARCH-SW               PIC X.
001281             88  CF-MIB-SEARCH-ALL             VALUE '1'.
001282             88  CF-MIB-SEARCH-NONE            VALUE '2'.
001283             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
001284             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
001285         16  CF-ALPHA-SEARCH-SW             PIC X.
001286             88  CF-MIB-ALPHA-ALL              VALUE '1'.
001287             88  CF-MIB-ALPHA-NONE             VALUE '2'.
001288             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
001289             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
001290             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
001291             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
001292             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
001293             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
001294             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
001295             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
001296                                                     'A' 'B' 'C'
001297                                                     'X' 'Y' 'Z'.
001298         16  CF-EFF-DT-RULE-SW              PIC X.
001299             88  CF-EFF-DT-ENTER               VALUE 'E'.
001300             88  CF-EFF-DT-MONTH               VALUE 'M'.
001301             88  CF-EFF-DT-QTR                 VALUE 'Q'.
001302             88  CF-EFF-DT-SEMI                VALUE 'S'.
001303             88  CF-EFF-DT-ANN                 VALUE 'A'.
001304         16  FILLER                         PIC X(4).
001305         16  CF-HEALTH-QUESTIONS            PIC X.
001306             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
001307         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
001308         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
001309         16  CF-PLAN-SNGL-JNT               PIC X.
001310             88  CF-COMBINED-PLAN              VALUE 'C'.
001311             88  CF-JNT-PLAN                   VALUE 'J'.
001312             88  CF-SNGL-PLAN                  VALUE 'S'.
001313         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
001314         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
001315         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
001316         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
001317         16  CF-RERATE-CNTL                 PIC  X.
001318             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
001319             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
001320             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
001321             88  CF-AUTO-RECALC                 VALUE '4'.
001322         16  CF-BENEFIT-TYPE                PIC  X.
001323             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
001324             88  CF-BENEFIT-REDUCES             VALUE '2'.
001325         16  CF-POLICY-FEE                  PIC S999V99
001326                                                    COMP-3.
001327         16  CF-1ST-NOTICE-FORM             PIC  X(04).
001328         16  CF-2ND-NOTICE-FORM             PIC  X(04).
001329         16  CF-3RD-NOTICE-FORM             PIC  X(04).
001330         16  CF-4TH-NOTICE-FORM             PIC  X(04).
001331         16  FILLER                         PIC  X(32).
001332         16  CF-TERMINATION-FORM            PIC  X(04).
001333         16  FILLER                         PIC  X(08).
001334         16  CF-CLAIM-CAP                   PIC S9(7)V99
001335                                                       COMP-3.
001336         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
001337         16  CF-ISSUE-LETTER                PIC  X(4).
001338         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
001339         16  CF-DEPENDENT-COVERAGE          PIC  X.
001340             88  CF-YES-DEP-COV                 VALUE 'Y'.
001341             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
001342         16  CF-MP-REFUND-CALC              PIC X.
001343             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
001344             88  CF-MP-REFD-BY-R78              VALUE '1'.
001345             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
001346             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
001347             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
001348             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
001349             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
001350             88  CF-MP-REFD-MEAN                VALUE '8'.
001351         16  CF-ALT-RATE-CODE               PIC  X(5).
001352
001353
001354         16  FILLER                         PIC X(498).
001355****************************************************************
001356*             MORTGAGE COMPANY MASTER RECORD                   *
001357****************************************************************
001358
001359     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
001360         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
001361         16  CF-MORTG-ACCESS-CONTROL        PIC X.
001362             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
001363             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
001364             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
001365             88  CF-MORT-PROD-CNTL                   VALUE '3'.
001366             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
001367
001368         16  CF-MORTG-CONVERSION-DATE       PIC XX.
001369         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
001370         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
001371         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
001372         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
001373
001374         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
001375             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
001376         16  CF-MP-RECON-USE-IND            PIC X(1).
001377             88  CF-MP-USE-RECON             VALUE 'Y'.
001378         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
001379             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
001380         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
001381             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
001382             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
001383         16  FILLER                         PIC X(1).
001384         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
001385             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
001386         16  CF-MORTG-MIB-VERSION           PIC X.
001387             88  CF-MORTG-MIB-BATCH         VALUE '1'.
001388             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
001389             88  CF-MORTG-MIB-BOTH          VALUE '3'.
001390         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
001391             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
001392                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
001393             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
001394                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
001395             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
001396                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
001397             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
001398                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
001399             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
001400                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
001401             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
001402                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
001403         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
001404         16  FILLER                         PIC X(7).
001405         16  CF-MORTG-DESTINATION-SYMBOL.
001406             20  CF-MORTG-MIB-COMM          PIC X(5).
001407             20  CF-MORTG-MIB-TERM          PIC X(5).
001408         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
001409             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
001410         16  FILLER                         PIC X(03).
001411         16  CF-MP-CHECK-NO-CONTROL.
001412             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
001413                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
001414                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
001415                                                ' ' LOW-VALUES.
001416                 88  CF-MP-CHECK-NO-PRE-PRINTED
001417                                               VALUE '3'.
001418         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
001419         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
001420         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
001421             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
001422                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
001423             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
001424                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
001425             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
001426                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
001427             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
001428                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
001429             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
001430                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
001431             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
001432                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
001433         16  CF-MORTG-BILLING-AREA.
001434             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
001435                                            PIC X.
001436         16  CF-MORTG-MONTH-END-DT          PIC XX.
001437         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
001438         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
001439         16  CF-MORTG-MIB-DEST-SW           PIC X.
001440             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
001441             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
001442         16  FILLER                         PIC X.
001443         16  CF-MORTG-LABEL-CONTROL         PIC X.
001444             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
001445             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
001446         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
001447         16  FILLER                         PIC X(8).
001448         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
001449         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
001450         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
001451         16  CF-ACH-COMPANY-ID.
001452             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
001453                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
001454                 88  CF-ACH-ICD-DUNS                VALUE '3'.
001455                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
001456             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
001457         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
001458             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
001459         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
001460             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
001461             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
001462         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
001463         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
001464         16  FILLER                         PIC X(536).
001465
001466****************************************************************
001467*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
001468****************************************************************
001469
001470     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
001471         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
001472             20  CF-FEMALE-HEIGHT.
001473                 24  CF-FEMALE-FT           PIC 99.
001474                 24  CF-FEMALE-IN           PIC 99.
001475             20  CF-FEMALE-MIN-WT           PIC 999.
001476             20  CF-FEMALE-MAX-WT           PIC 999.
001477         16  FILLER                         PIC X(428).
001478
001479     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
001480         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
001481             20  CF-MALE-HEIGHT.
001482                 24  CF-MALE-FT             PIC 99.
001483                 24  CF-MALE-IN             PIC 99.
001484             20  CF-MALE-MIN-WT             PIC 999.
001485             20  CF-MALE-MAX-WT             PIC 999.
001486         16  FILLER                         PIC X(428).
001487******************************************************************
001488*             AUTOMATIC ACTIVITY RECORD                          *
001489******************************************************************
001490     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
001491         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
001492             20  CF-SYS-ACTIVE-SW           PIC X(01).
001493             20  CF-SYS-LETTER-ID           PIC X(04).
001494             20  CF-SYS-RESEND-DAYS         PIC 9(03).
001495             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
001496             20  CF-SYS-RESET-SW            PIC X(01).
001497             20  CF-SYS-REPORT-DAYS         PIC 9(03).
001498             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
001499
001500         16  FILLER                         PIC X(50).
001501
001502         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
001503             20  CF-USER-ACTIVE-SW          PIC X(01).
001504             20  CF-USER-LETTER-ID          PIC X(04).
001505             20  CF-USER-RESEND-DAYS        PIC 9(03).
001506             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
001507             20  CF-USER-RESET-SW           PIC X(01).
001508             20  CF-USER-REPORT-DAYS        PIC 9(03).
001509             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
001510             20  CF-USER-ACTIVITY-DESC      PIC X(20).
001511
001512         16  FILLER                         PIC X(246).
      *<<((file: ELCCNTL))
000394     EJECT
000395*    COPY ERCACCT.
      *>>((file: ERCACCT))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCACCT                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.031                          *
000007*                                                                *
000008*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
000009*                                                                *
000010*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
000011*   VSAM ACCOUNT MASTER FILES.                                   *
000012*                                                                *
000013*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
000014*                                                                *
000015*   FILE TYPE = VSAM,KSDS                                        *
000016*   RECORD SIZE = 2000  RECFORM = FIX                            *
000017*                                                                *
000018*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
000019*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
000020*                                                                *
000021*   LOG = NO                                                     *
000022*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000023*                                                                *
000024*                                                                *
000025******************************************************************
000026*                   C H A N G E   L O G
000027*
000028* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000029*-----------------------------------------------------------------
000030*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000031* EFFECTIVE    NUMBER
000032*-----------------------------------------------------------------
000033* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
000034* 092705    2005050300006  PEMA  ADD SPP LEASES
000035* 022808    2007083100002  PEMA  ADD FREEZE STATUS
000036* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
000037* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
000038* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
000039* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
000040* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
000041******************************************************************
000042
000043 01  ACCOUNT-MASTER.
000044     12  AM-RECORD-ID                      PIC XX.
000045         88  VALID-AM-ID                      VALUE 'AM'.
000046
000047     12  AM-CONTROL-PRIMARY.
000048         16  AM-COMPANY-CD                 PIC X.
000049         16  AM-MSTR-CNTRL.
000050             20  AM-CONTROL-A.
000051                 24  AM-CARRIER            PIC X.
000052                 24  AM-GROUPING.
000053                     28 AM-GROUPING-PREFIX PIC XXX.
000054                     28 AM-GROUPING-PRIME  PIC XXX.
000055                 24  AM-STATE              PIC XX.
000056                 24  AM-ACCOUNT.
000057                     28  AM-ACCOUNT-PREFIX PIC X(4).
000058                     28  AM-ACCOUNT-PRIME  PIC X(6).
000059             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
000060                                           PIC X(19).
000061             20  AM-CNTRL-B.
000062                 24  AM-EXPIRATION-DT      PIC XX.
000063                 24  FILLER                PIC X(4).
000064             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
000065                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
000066
000067     12  AM-CONTROL-BY-VAR-GRP.
000068         16  AM-COMPANY-CD-A1              PIC X.
000069         16  AM-VG-CARRIER                 PIC X.
000070         16  AM-VG-GROUPING                PIC X(6).
000071         16  AM-VG-STATE                   PIC XX.
000072         16  AM-VG-ACCOUNT                 PIC X(10).
000073         16  AM-VG-DATE.
000074             20  AM-VG-EXPIRATION-DT       PIC XX.
000075             20  FILLER                    PIC X(4).
000076         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
000077                                           PIC 9(11)      COMP-3.
000078     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
000079         16  FILLER                        PIC X(10).
000080         16  AM-VG-KEY3.
000081             20  AM-VG3-ACCOUNT            PIC X(10).
000082             20  AM-VG3-EXP-DT             PIC XX.
000083         16  FILLER                        PIC X(4).
000084     12  AM-MAINT-INFORMATION.
000085         16  AM-LAST-MAINT-DT              PIC XX.
000086         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
000087         16  AM-LAST-MAINT-USER            PIC X(4).
000088         16  FILLER                        PIC XX.
000089
000090     12  AM-EFFECTIVE-DT                   PIC XX.
000091     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
000092
000093     12  AM-PREV-DATES  COMP-3.
000094         16  AM-PREV-EXP-DT                PIC 9(11).
000095         16  AM-PREV-EFF-DT                PIC 9(11).
000096
000097     12  AM-REPORT-CODE-1                  PIC X(10).
000098     12  AM-REPORT-CODE-2                  PIC X(10).
000099
000100     12  AM-CITY-CODE                      PIC X(4).
000101     12  AM-COUNTY-PARISH                  PIC X(6).
000102
000103     12  AM-NAME                           PIC X(30).
000104     12  AM-PERSON                         PIC X(30).
000105     12  AM-ADDRS                          PIC X(30).
000106     12  AM-CITY.
000107         16  AM-ADDR-CITY                  PIC X(28).
000108         16  AM-ADDR-STATE                 PIC XX.
000109     12  AM-ZIP.
000110         16  AM-ZIP-PRIME.
000111             20  AM-ZIP-PRI-1ST            PIC X.
000112                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
000113             20  FILLER                    PIC X(4).
000114         16  AM-ZIP-PLUS4                  PIC X(4).
000115     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
000116         16  AM-CAN-POSTAL-1               PIC XXX.
000117         16  AM-CAN-POSTAL-2               PIC XXX.
000118         16  FILLER                        PIC XXX.
000119     12  AM-TEL-NO.
000120         16  AM-AREA-CODE                  PIC 999.
000121         16  AM-TEL-PRE                    PIC 999.
000122         16  AM-TEL-NBR                    PIC 9(4).
000123     12  AM-TEL-LOC                        PIC X.
000124         88  AM-TEL-AT-HOME                   VALUE 'H'.
000125         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
000126
000127     12  AM-COMM-STRUCTURE.
000128         16  AM-DEFN-1.
000129             20  AM-AGT-COMMS       OCCURS 10 TIMES.
000130                 24  AM-AGT.
000131                     28  AM-AGT-PREFIX     PIC X(4).
000132                     28  AM-AGT-PRIME      PIC X(6).
000133                 24  AM-COM-TYP            PIC X.
000134                 24  AM-L-COM              PIC SV9(5)     COMP-3.
000135                 24  AM-J-COM              PIC SV9(5)     COMP-3.
000136                 24  AM-A-COM              PIC SV9(5)     COMP-3.
000137                 24  AM-RECALC-LV-INDIC    PIC X.
000138                 24  AM-RETRO-LV-INDIC     PIC X.
000139                 24  AM-GL-CODES           PIC X.
000140                 24  AM-COMM-CHARGEBACK    PIC 9(02).
000141                 24  FILLER                PIC X(01).
000142         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
000143             20  AM-COM-TBLS        OCCURS 10 TIMES.
000144                 24  FILLER                PIC X(11).
000145                 24  AM-L-COMA             PIC XXX.
000146                 24  AM-J-COMA             PIC XXX.
000147                 24  AM-A-COMA             PIC XXX.
000148                 24  FILLER                PIC X(6).
000149
000150     12  AM-COMM-CHANGE-STATUS             PIC X.
000151         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
000152
000153     12  AM-CSR-CODE                       PIC X(4).
000154
000155     12  AM-BILLING-STATUS                 PIC X.
000156         88  AM-ACCOUNT-BILLED                VALUE 'B'.
000157         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
000158     12  AM-AUTO-REFUND-SW                 PIC X.
000159         88  AUTO-REFUNDS-USED                VALUE 'Y'.
000160         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
000161     12  AM-GPCD                           PIC 99.
000162     12  AM-IG                             PIC X.
000163         88  AM-HAS-INDIVIDUAL                VALUE '1'.
000164         88  AM-HAS-GROUP                     VALUE '2'.
000165     12  AM-STATUS                         PIC X.
000166         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
000167         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
000168         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
000169         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
000170         88  AM-ACCOUNT-FROZEN                VALUE '4'.
000171         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
000172         88  AM-ACCOUNT-DROPPED               VALUE '6'.
000173         88  AM-ACCOUNT-LAPSED                VALUE '7'.
000174         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
000175         88  AM-ACCOUNT-PENDING               VALUE '9'.
000176     12  AM-REMIT-TO                       PIC 99.
000177     12  AM-ID-NO                          PIC X(11).
000178
000179     12  AM-CAL-TABLE                      PIC XX.
000180     12  AM-LF-DEVIATION                   PIC XXX.
000181     12  AM-AH-DEVIATION                   PIC XXX.
000182     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
000183     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
000184     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
000185     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
000186     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
000187     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
000188
000189     12  AM-USER-FIELDS.
000190         16  AM-FLD-1                      PIC XX.
000191         16  AM-FLD-2                      PIC XX.
000192         16  AM-FLD-3                      PIC XX.
000193         16  AM-FLD-4                      PIC XX.
000194         16  AM-FLD-5                      PIC XX.
000195
000196     12  AM-1ST-PROD-DATE.
000197         16  AM-1ST-PROD-YR                PIC XX.
000198         16  AM-1ST-PROD-MO                PIC XX.
000199         16  AM-1ST-PROD-DA                PIC XX.
000200     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
000201     12  AM-CERTS-PURGED-DATE.
000202         16  AM-PUR-YR                     PIC XX.
000203         16  AM-PUR-MO                     PIC XX.
000204         16  AM-PUR-DA                     PIC XX.
000205     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
000206     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
000207     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
000208     12  AM-INACTIVE-DATE.
000209         16  AM-INA-MO                     PIC 99.
000210         16  AM-INA-DA                     PIC 99.
000211         16  AM-INA-YR                     PIC 99.
000212     12  AM-AR-HI-CERT-DATE                PIC XX.
000213
000214     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
000215     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
000216
000217     12  AM-OB-PAYMENT-MODE                PIC X.
000218         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
000219         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
000220         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
000221         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
000222
000223     12  AM-AH-ONLY-INDICATOR              PIC X.
000224         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
000225         88  AM-NO-AH-ONLY                    VALUE 'N'.
000226
000227     12  AM-EDIT-LOAN-OFC                  PIC X(01).
000228
000229     12  AM-OVER-SHORT.
000230         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
000231         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
000232
000233     12  AM-DCC-PRODUCT-CODE               PIC XXX.
000234     12  AM-DCC-CLP-STATE                  PIC XX.
000235
000236     12  AM-RECALC-COMM                    PIC X.
000237     12  AM-RECALC-REIN                    PIC X.
000238
000239     12  AM-REI-TABLE                      PIC XXX.
000240     12  AM-REI-ET-LF                      PIC X.
000241     12  AM-REI-ET-AH                      PIC X.
000242     12  AM-REI-PE-LF                      PIC X.
000243     12  AM-REI-PE-AH                      PIC X.
000244     12  AM-REI-PRT-ST                     PIC X.
000245     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
000246     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
000247     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
000248     12  AM-REI-GROUP-A                    PIC X(6).
000249     12  AM-REI-MORT                       PIC X(4).
000250     12  AM-REI-PRT-OW                     PIC X.
000251     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
000252     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
000253     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
000254     12  AM-REI-GROUP-B                    PIC X(6).
000255
000256     12  AM-TRUST-TYPE                     PIC X(2).
000257
000258     12  AM-EMPLOYER-STMT-USED             PIC X.
000259     12  AM-GROUPED-CHECKS-Y-N             PIC X.
000260
000261     12  AM-STD-AH-TYPE                    PIC XX.
000262     12  AM-EARN-METHODS.
000263         16  AM-EARN-METHOD-R              PIC X.
000264             88 AM-REF-RL-R78                 VALUE 'R'.
000265             88 AM-REF-RL-PR                  VALUE 'P'.
000266             88 AM-REF-RL-MEAN                VALUE 'M'.
000267             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
000268         16  AM-EARN-METHOD-L              PIC X.
000269             88 AM-REF-LL-R78                 VALUE 'R'.
000270             88 AM-REF-LL-PR                  VALUE 'P'.
000271             88 AM-REF-LL-MEAN                VALUE 'M'.
000272             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
000273         16  AM-EARN-METHOD-A              PIC X.
000274             88 AM-REF-AH-R78                 VALUE 'R'.
000275             88 AM-REF-AH-PR                  VALUE 'P'.
000276             88 AM-REF-AH-MEAN                VALUE 'M'.
000277             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
000278             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
000279             88 AM-REF-AH-NET                 VALUE 'N'.
000280
000281     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
000282     12  AM-TOL-REF                        PIC S999V99    COMP-3.
000283     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
000284
000285     12  AM-RET-Y-N                        PIC X.
000286     12  AM-RET-P-E                        PIC X.
000287     12  AM-LF-RET                         PIC S9V9999    COMP-3.
000288     12  AM-AH-RET                         PIC S9V9999    COMP-3.
000289     12  AM-RET-GRP                        PIC X(6).
000290     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
000291         16  AM-POOL-PRIME                 PIC XXX.
000292         16  AM-POOL-SUB                   PIC XXX.
000293     12  AM-RETRO-EARNINGS.
000294         16  AM-RET-EARN-R                 PIC X.
000295         16  AM-RET-EARN-L                 PIC X.
000296         16  AM-RET-EARN-A                 PIC X.
000297     12  AM-RET-ST-TAX-USE                 PIC X.
000298         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
000299         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
000300     12  AM-RETRO-BEG-EARNINGS.
000301         16  AM-RET-BEG-EARN-R             PIC X.
000302         16  AM-RET-BEG-EARN-L             PIC X.
000303         16  AM-RET-BEG-EARN-A             PIC X.
000304     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
000305     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
000306
000307     12  AM-USER-SELECT-OPTIONS.
000308         16  AM-USER-SELECT-1              PIC X(10).
000309         16  AM-USER-SELECT-2              PIC X(10).
000310         16  AM-USER-SELECT-3              PIC X(10).
000311         16  AM-USER-SELECT-4              PIC X(10).
000312         16  AM-USER-SELECT-5              PIC X(10).
000313
000314     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
000315
000316     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
000317
000318     12  AM-RPT045A-SWITCH                 PIC X.
000319         88  RPT045A-OFF                   VALUE 'N'.
000320
000321     12  AM-INSURANCE-LIMITS.
000322         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
000323         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
000324
000325     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
000326         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
000327
000328     12  AM-DISMBR-COVERAGE-SW             PIC X.
000329         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
000330         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
000331
000332     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
000333
000334     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
000335     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
000336     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
000337     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
000338     12  AM-DCC-UEF-STATE                  PIC XX.
000339     12  FILLER                            PIC XXX.
000340     12  AM-REPORT-CODE-3                  PIC X(10).
000341*    12  FILLER                            PIC X(22).
000342
000343     12  AM-RESERVE-DATE.
000344         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
000345         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
000346         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
000347
000348     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
000349     12  AM-NOTIFICATION-TYPES.
000350         16  AM-NOTIF-OF-LETTERS           PIC X.
000351         16  AM-NOTIF-OF-PAYMENTS          PIC X.
000352         16  AM-NOTIF-OF-REPORTS           PIC X.
000353         16  AM-NOTIF-OF-STATUS            PIC X.
000354
000355     12  AM-BENEFIT-TABLE-USAGE            PIC X.
000356         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
000357         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
000358         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
000359         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
000360
000361     12  AM-BENEFIT-CONTROLS.
000362         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
000363             20  AM-BENEFIT-CODE           PIC XX.
000364             20  AM-BENEFIT-TYPE           PIC X.
000365             20  AM-BENEFIT-REVISION       PIC XXX.
000366             20  AM-BENEFIT-REM-TERM       PIC X.
000367             20  AM-BENEFIT-RETRO-Y-N      PIC X.
000368             20  FILLER                    PIC XX.
000369         16  FILLER                        PIC X(80).
000370
000371     12  AM-TRANSFER-DATA.
000372         16  AM-TRANSFERRED-FROM.
000373             20  AM-TRNFROM-CARRIER        PIC X.
000374             20  AM-TRNFROM-GROUPING.
000375                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
000376                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
000377             20  AM-TRNFROM-STATE          PIC XX.
000378             20  AM-TRNFROM-ACCOUNT.
000379                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
000380                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
000381             20  AM-TRNFROM-DTE            PIC XX.
000382         16  AM-TRANSFERRED-TO.
000383             20  AM-TRNTO-CARRIER          PIC X.
000384             20  AM-TRNTO-GROUPING.
000385                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
000386                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
000387             20  AM-TRNTO-STATE            PIC XX.
000388             20  AM-TRNTO-ACCOUNT.
000389                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
000390                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
000391             20  AM-TRNTO-DTE              PIC XX.
000392         16  FILLER                        PIC X(10).
000393
000394     12  AM-SAVED-REMIT-TO                 PIC 99.
000395
000396     12  AM-COMM-STRUCTURE-SAVED.
000397         16  AM-DEFN-1-SAVED.
000398             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
000399                 24  AM-AGT-SV             PIC X(10).
000400                 24  AM-COM-TYP-SV         PIC X.
000401                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
000402                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
000403                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
000404                 24  AM-RECALC-LV-INDIC-SV PIC X.
000405                 24  FILLER                PIC X.
000406                 24  AM-GL-CODES-SV        PIC X.
000407                 24  AM-COM-CHARGEBACK-SV  PIC 99.
000408                 24  FILLER                PIC X.
000409         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
000410             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
000411                 24  FILLER                PIC X(11).
000412                 24  AM-L-COMA-SV          PIC XXX.
000413                 24  AM-J-COMA-SV          PIC XXX.
000414                 24  AM-A-COMA-SV          PIC XXX.
000415                 24  FILLER                PIC X(6).
000416
000417     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
000418         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
000419            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
000420            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
000421            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
000422
000423     12  AM-ORIG-DEALER-NO                 PIC X(10).
000424     12  FILLER                            PIC X(120).
000425
000426     12  AM-ACCOUNT-EXECUTIVE-DATA.
000427         16  AM-CONTROL-NAME               PIC X(30).
000428         16  AM-EXECUTIVE-ONE.
000429             20  AM-EXEC1-NAME             PIC X(15).
000430             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
000431                                                          COMP-3.
000432             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
000433                                                          COMP-3.
000434         16  AM-EXECUTIVE-TWO.
000435             20  AM-EXEC2-NAME             PIC X(15).
000436             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
000437                                                          COMP-3.
000438             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
000439                                                          COMP-3.
000440
000441     12  AM-RETRO-ADDITIONAL-DATA.
000442         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
000443         16  AM-RETRO-PREM-P-E             PIC X.
000444         16  AM-RETRO-CLMS-P-I             PIC X.
000445         16  AM-RETRO-RET-BRACKET-LF.
000446             20  AM-RETRO-RET-METHOD-LF    PIC X.
000447                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
000448                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
000449             20  AM-RETRO-RET-BASIS-LF     PIC X.
000450                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
000451                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
000452             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
000453                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
000454                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
000455         16  AM-RETRO-RET-BRACKET-AH.
000456             20  AM-RETRO-RET-METHOD-AH    PIC X.
000457                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
000458                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
000459                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
000460             20  AM-RETRO-RET-BASIS-AH     PIC X.
000461                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
000462                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
000463             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
000464                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
000465                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
000466
000467     12  AM-COMMENTS.
000468         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
000469
000470     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
000471         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
000472         16  AM-FLI-BILLING-CODE           PIC X.
000473         16  AM-FLI-ALT-STATE-CODE         PIC XX.
000474         16  AM-FLI-UNITED-IDENT           PIC X.
000475         16  AM-FLI-INTEREST-LOST-DATA.
000476             20  AM-FLI-BANK-NO            PIC X(5).
000477             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
000478             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
000479             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
000480         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
000481             20  AM-FLI-AGT                PIC X(9).
000482             20  AM-FLI-AGT-COMM-ACC       PIC X.
000483             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
000484         16  FILLER                        PIC X(102).
000485
000486     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
000487         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
000488             20  AM-BENEFIT-DMD-CODE         PIC XX.
000489             20  AM-BENEFIT-DMD-TYPE         PIC X.
000490             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
000491             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
000492             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
000493         16  FILLER                          PIC X(10).
000494******************************************************************
      *<<((file: ERCACCT))
000396     EJECT
000397*    COPY ERCREIN.
      *>>((file: ERCREIN))
000001******************************************************************
000002*                                                                *
000003*                            ERCREIN                             *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000005*                            VMOD=2.010                          *
000006*                                                                *
000007*   ONLINE CREDIT SYSTEM                                         *
000008*                                                                *
000009*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
000010*                                                                *
000011*   FILE TYPE = VSAM,KSDS                                        *
000012*   RECORD SIZE = 4000  RECFORM = FIXED                          *
000013*                                                                *
000014*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
000015*       ALTERNATE PATH = NONE                                    *
000016*                                                                *
000017*   LOG = NO                                                     *
000018*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000019*                                                                *
000020******************************************************************
000021*                   C H A N G E   L O G
000022*
000023* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000024*-----------------------------------------------------------------
000025*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000026* EFFECTIVE    NUMBER
000027*-----------------------------------------------------------------
000028* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
000029* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
000030******************************************************************
000031 01  REINSURANCE-RECORD.
000032     12  RE-RECORD-ID                      PIC XX.
000033         88  VALID-RE-ID                      VALUE 'RE'.
000034
000035     12  RE-CONTROL-PRIMARY.
000036         16  RE-COMPANY-CD                 PIC X.
000037         16  RE-KEY.
000038             20  RE-CODE                   PIC X.
000039                 88  RE-TABLE-RECORD          VALUE 'A'.
000040                 88  RE-COMPANY-RECORD        VALUE 'B'.
000041             20  RE-TABLE                  PIC XXX.
000042             20  FILLER                    PIC XXX.
000043         16  RE-COMPANY-KEY REDEFINES RE-KEY.
000044             20  FILLER                    PIC X.
000045             20  RE-COMPANY.
000046                 24  RE-COMP-PRIME         PIC XXX.
000047                 24  RE-COMP-SUB           PIC XXX.
000048
000049     12  RE-MAINT-INFORMATION.
000050         16  RE-LAST-MAINT-DT              PIC XX.
000051         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
000052         16  RE-LAST-MAINT-USER            PIC X(4).
000053         16  FILLER                        PIC X(10).
000054
000055     12  RE-TABLE-DATA.
000056         16  RE-100-COMP                   PIC 99.
000057
000058         16  RE-COMP-INFO    OCCURS 30 TIMES.
000059             20  RE-REI-COMP-NO.
000060                 24  RE-REI-COMP           PIC XXX.
000061                 24  RE-REI-COMP-SUB       PIC XXX.
000062             20  RE-LF-QC                  PIC X.
000063             20  RE-AH-QC                  PIC X.
000064             20  RE-LO-DATE                PIC 9(11)     COMP-3.
000065             20  RE-HI-DATE                PIC 9(11)     COMP-3.
000066             20  RE-LFAGE-LO               PIC 99.
000067             20  RE-LFAGE-HI               PIC 99.
000068             20  RE-AHAGE-LO               PIC 99.
000069             20  RE-AHAGE-HI               PIC 99.
000070             20  RE-LFTRM-LO               PIC S999       COMP-3.
000071             20  RE-LFTRM-HI               PIC S999       COMP-3.
000072             20  RE-AHTRM-LO               PIC S999       COMP-3.
000073             20  RE-AHTRM-HI               PIC S999       COMP-3.
000074             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
000075             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
000076             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
000077             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
000078             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
000079             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
000080             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
000081             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
000082             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
000083             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
000084             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
000085             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
000086             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
000087             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
000088             20  RE-LF-BEN-CODE            PIC X.
000089             20  RE-AH-BEN-CODE            PIC X.
000090             20  RE-INTERACTIVE            PIC X.
000091             20  RE-REMAINING              PIC X.
000092             20  RE-LF-RUNOFF-SW           PIC X.
000093             20  RE-AH-RUNOFF-SW           PIC X.
000094             20  FILLER                    PIC X(19).
000095
000096         16  RE-COMP-INFO-END              PIC X(6).
000097         16  RE-NSP-ST-CD-LF               PIC XX.
000098         16  RE-NSP-ST-CD-AH               PIC XX.
000099         16  RE-TABLE-CARRIER-SECURITY     PIC X.
000100             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
000101
000102         16  FILLER                        PIC X(27).
000103
000104     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
000105         16  RE-NAME                       PIC X(30).
000106         16  RE-LF-PE                      PIC X.
000107         16  RE-AH-PE                      PIC X.
000108         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
000109         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
000110         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
000111         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
000112         16  RE-PRT-ST                     PIC X.
000113         16  RE-PRT-OW                     PIC X.
000114         16  RE-MORT-CODE                  PIC X(4).
000115         16  RE-CLAIM-CODE                 PIC X.
000116         16  RE-ZERO-LF-FEE                PIC X.
000117         16  RE-ZERO-AH-FEE                PIC X.
000118         16  RE-CEDE-NAME                  PIC X(30).
000119         16  RE-LF-COMM                    PIC X.
000120         16  RE-AH-COMM                    PIC X.
000121         16  RE-LF-TAX                     PIC X.
000122         16  RE-AH-TAX                     PIC X.
000123         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
000124         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
000125         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
000126
000127         16  RE-COMP-CARRIER-SECURITY      PIC X.
000128             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
000129
000130         16  RE-LF-CEDING-FEE-BRACKETS.
000131             20  RE-LF-FEE-METHOD          PIC X.
000132                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
000133                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
000134                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
000135                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
000136             20  RE-LF-FEE-BASIS           PIC X.
000137                 88  RE-LF-GROSS-CEDED             VALUE '1'.
000138                 88  RE-LF-NET-CEDED               VALUE '2'.
000139                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
000140                 88  RE-LF-NET-WRITTEN             VALUE '4'.
000141                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
000142                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
000143                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
000144                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
000145             20  FILLER                    PIC XXX.
000146             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
000147                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
000148                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
000149
000150         16  RE-AH-CEDING-FEE-BRACKETS.
000151             20  RE-AH-FEE-METHOD          PIC X.
000152                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
000153                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
000154                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
000155                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
000156             20  RE-AH-FEE-BASIS           PIC X.
000157                 88  RE-AH-GROSS-CEDED             VALUE '1'.
000158                 88  RE-AH-NET-CEDED               VALUE '2'.
000159                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
000160                 88  RE-AH-NET-WRITTEN             VALUE '4'.
000161                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
000162                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
000163                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
000164                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
000165             20  FILLER                    PIC XXX.
000166             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
000167                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
000168                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
000169
000170         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
000171
000172         16  RE-OLD-CEDING-STMT            PIC X.
000173
000174         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
000175         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
000176         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
000177         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
000178         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
000179         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
000180         16  RE-REINS-GROUPING-CODE        PIC X(6).
000181         16  RE-MORT-SW                    PIC X.
000182         16  RE-CEDING-TYPE-FLAG           PIC X.
000183             88  RE-NO-CESSION-TYPE                VALUE ' '.
000184             88  RE-CEDED                          VALUE 'C'.
000185             88  RE-ASSUMED                        VALUE 'A'.
000186             88  RE-PHANTOM                        VALUE 'P'.
000187
000188         16  RE-CEDING-STMT-OPT-A          PIC X.
000189             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
000190         16  RE-CEDING-STMT-OPT-B          PIC X.
000191             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
000192         16  RE-CEDING-STMT-OPT-C          PIC X.
000193             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
000194         16  RE-CEDING-STMT-OPT-D          PIC X.
000195             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
000196         16  RE-CEDING-STMT-OPT-E          PIC X.
000197             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
000198
000199         16  RE-PRT-CRSV                   PIC X.
000200
000201         16  RE-GL-CENTER                  PIC X(4).
000202
000203         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
000204
000205         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
000206
000207         16  RE-EARN-STOP-CODE             PIC X.
000208             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
000209             88  STOP-AH-EARNING    VALUE 'A' 'B'.
000210
000211         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
000212             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
000213
000214         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
000215         16  FILLER                        PIC X(2281).
000216
000217         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
000218
000219******************************************************************
      *<<((file: ERCREIN))
000398     EJECT
000399*    COPY ERCCTBL.
      *>>((file: ERCCTBL))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCCTBL                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.003
000007*                                                                *
000008*   ONLINE CREDIT SYSTEM                                         *
000009*                                                                *
000010*   FILE DESCRIPTION = COMPENSATION TABLE                        *
000011*                                                                *
000012*   FILE TYPE = VSAM,KSDS                                        *
000013*   RECORD SIZE = 200   RECFORM = FIXED                          *
000014*                                                                *
000015*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
000016*       ALTERNATE PATH = NONE                                    *
000017*                                                                *
000018*   LOG = NO                                                     *
000019*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000020*                                                                *
000021*                                                                *
000022******************************************************************
000023
000024 01  COMM-TABLE-RECORD.
000025     12  CT-RECORD-ID                      PIC XX.
000026         88  VALID-CT-ID                      VALUE 'CT'.
000027
000028     12  CT-CONTROL-PRIMARY.
000029         16  CT-COMPANY-CD                 PIC X.
000030         16  CT-TABLE                      PIC XXX.
000031         16  CT-CNTRL-2.
000032             20  CT-BEN-TYPE               PIC X.
000033             20  CT-BEN-CODE               PIC XX.
000034
000035     12  CT-MAINT-INFORMATION.
000036         16  CT-LAST-MAINT-DT              PIC XX.
000037         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
000038         16  CT-LAST-MAINT-USER            PIC X(4).
000039         16  FILLER                        PIC X(31).
000040
000041     12  CT-LIMITS.
000042         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
000043
000044         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
000045
000046         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
000047
000048     12  CT-RATES.
000049         16  CT-RTX          OCCURS 27 TIMES.
000050             20  CT-RT                     PIC SV9(5)     COMP-3.
000051             20  CT-RT-R   REDEFINES
000052                 CT-RT                     PIC XXX.
000053
000054     12  FILLER                            PIC  X(42).
000055
000056******************************************************************
      *<<((file: ERCCTBL))
000400     EJECT
000401*    COPY ERCFORM.
      *>>((file: ERCFORM))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCFORM.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000006*                            VMOD=2.003                          *
000007*                                                                *
000008*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
000009*                                                                *
000010*    FILE TYPE = VSAM,KSDS                                       *
000011*    RECORD SIZE = 500  RECFORM = FIXED                          *
000012*                                                                *
000013*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
000014*                                                                *
000015*    LOG = YES                                                   *
000016*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000017******************************************************************
000018 01  FORM-MASTER.
000019    12  FO-RECORD-ID                 PIC X(02).
000020        88  VALID-FO-ID                  VALUE 'FO'.
000021
000022    12  FO-CONTROL-PRIMARY.
000023        16  FO-COMPANY-CD            PIC X(01).
000024        16  FO-STATE                 PIC X(02).
000025        16  FO-FORM-ID               PIC X(12).
000026        16  FO-FORM-EXP-DT           PIC X(02).
000027
000028    12  FO-POLICY-FORM-DATA.
000029        16  FO-IND-GRP-CD            PIC X(01).
000030        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
000031        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
000032        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
000033        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
000034        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
000035        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
000036        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
000037        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
000038        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
000039        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
000040        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
000041        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
000042        16  FO-DIS-DEF-TYPE          PIC 9(02).
000043        16  FO-DISMEMBERMENT-CD      PIC X(01).
000044        16  FO-APP-CERT-USE-CD       PIC X(01).
000045
000046    12  FILLER                       PIC X(29).
000047
000048    12  FO-FORM-PLAN-TABLE.
000049        16  FO-FORM-PLANS     OCCURS 40 TIMES.
000050            20  FO-PLAN-TYPE         PIC X(01).
000051            20  FO-PLAN-ID           PIC X(02).
000052            20  FO-PLAN-TERM         PIC 9(03).
000053            20  FO-PLAN-REFUND-METHOD
000054                                     PIC X.
000055
000056    12  FILLER                       PIC X(30).
000057
000058    12  FO-COMMENTS-AREA.
000059        16  FO-COMMENT-LINE-1        PIC X(78).
000060
000061    12  FILLER                       PIC X(20).
000062
000063    12  FO-MAINT-INFORMATION.
000064        16  FO-LAST-MAINT-DT         PIC X(02).
000065        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
000066        16  FO-LAST-MAINT-BY         PIC X(04).
      *<<((file: ERCFORM))
000402     EJECT
000403*    COPY ELCMSTR.
      *>>((file: ELCMSTR))
000001******************************************************************
000002*                                                                *
000003*                            ELCMSTR.                            *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000005*                            VMOD=2.012                          *
000006*                                                                *
000007*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
000008*                                                                *
000009*   FILE TYPE = VSAM,KSDS                                        *
000010*   RECORD SIZE = 350  RECFORM = FIXED                           *
000011*                                                                *
000012*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
000013*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
000014*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
000015*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
000016*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
000017*                                                 RKP=75,LEN=21  *
000018*                                                                *
000019*   **** NOTE ****                                               *
000020*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
000021*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
000022*                                                                *
000023*   LOG = YES                                                    *
000024*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000025******************************************************************
000026*                   C H A N G E   L O G
000027*
000028* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000029*-----------------------------------------------------------------
000030*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000031* EFFECTIVE    NUMBER
000032*-----------------------------------------------------------------
000033* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
000034* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
000035* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
000036* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
000037* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
000038* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
000039* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
000040******************************************************************
000041 01  CLAIM-MASTER.
000042     12  CL-RECORD-ID                PIC XX.
000043         88  VALID-CL-ID         VALUE 'CL'.
000044
000045     12  CL-CONTROL-PRIMARY.
000046         16  CL-COMPANY-CD           PIC X.
000047         16  CL-CARRIER              PIC X.
000048         16  CL-CLAIM-NO             PIC X(7).
000049         16  CL-CERT-NO.
000050             20  CL-CERT-PRIME       PIC X(10).
000051             20  CL-CERT-SFX         PIC X.
000052
000053     12  CL-CONTROL-BY-NAME.
000054         16  CL-COMPANY-CD-A1        PIC X.
000055         16  CL-INSURED-LAST-NAME    PIC X(15).
000056         16  CL-INSURED-NAME.
000057             20  CL-INSURED-1ST-NAME PIC X(12).
000058             20  CL-INSURED-MID-INIT PIC X.
000059
000060     12  CL-CONTROL-BY-SSN.
000061         16  CL-COMPANY-CD-A2        PIC X.
000062         16  CL-SOC-SEC-NO.
000063             20  CL-SSN-STATE        PIC XX.
000064             20  CL-SSN-ACCOUNT      PIC X(6).
000065             20  CL-SSN-LN3          PIC X(3).
000066
000067     12  CL-CONTROL-BY-CERT-NO.
000068         16  CL-COMPANY-CD-A4        PIC X.
000069         16  CL-CERT-NO-A4.
000070             20  CL-CERT-A4-PRIME    PIC X(10).
000071             20  CL-CERT-A4-SFX      PIC X.
000072
000073     12  CL-CONTROL-BY-CCN.
000074         16  CL-COMPANY-CD-A5        PIC X.
000075         16  CL-CCN-A5.
000076             20  CL-CCN.
000077                 24  CL-CCN-PREFIX-A5 PIC X(4).
000078                 24  CL-CCN-PRIME-A5 PIC X(12).
000079             20  CL-CCN-FILLER-A5    PIC X(4).
000080
000081     12  CL-INSURED-PROFILE-DATA.
000082         16  CL-INSURED-BIRTH-DT     PIC XX.
000083         16  CL-INSURED-SEX-CD       PIC X.
000084             88  INSURED-IS-MALE        VALUE 'M'.
000085             88  INSURED-IS-FEMALE      VALUE 'F'.
000086             88  INSURED-SEX-UNKNOWN    VALUE ' '.
000087         16  CL-INSURED-OCC-CD       PIC X(6).
000088         16  FILLER                  PIC X(5).
000089
000090     12  CL-PROCESSING-INFO.
000091         16  CL-PROCESSOR-ID         PIC X(4).
000092         16  CL-CLAIM-STATUS         PIC X.
000093             88  CLAIM-IS-OPEN          VALUE 'O'.
000094             88  CLAIM-IS-CLOSED        VALUE 'C'.
000095         16  CL-CLAIM-TYPE           PIC X.
000096*            88  AH-CLAIM               VALUE 'A'.
000097*            88  LIFE-CLAIM             VALUE 'L'.
000098*            88  PROPERTY-CLAIM         VALUE 'P'.
000099*            88  IUI-CLAIM              VALUE 'I'.
000100*            88  GAP-CLAIM              VALUE 'G'.
000101*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
000102*            88  OTHER-CLAIM            VALUE 'O'.
000103         16  CL-CLAIM-PREM-TYPE      PIC X.
000104             88  SINGLE-PREMIUM         VALUE '1'.
000105             88  O-B-COVERAGE           VALUE '2'.
000106             88  OPEN-END-COVERAGE      VALUE '3'.
000107         16  CL-INCURRED-DT          PIC XX.
000108         16  CL-REPORTED-DT          PIC XX.
000109         16  CL-FILE-ESTABLISH-DT    PIC XX.
000110         16  CL-EST-END-OF-DISAB-DT  PIC XX.
000111         16  CL-LAST-PMT-DT          PIC XX.
000112         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
000113         16  CL-PAID-THRU-DT         PIC XX.
000114         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
000115         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
000116         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
000117         16  CL-PMT-CALC-METHOD      PIC X.
000118             88  CL-360-DAY-YR          VALUE '1'.
000119             88  CL-365-DAY-YR          VALUE '2'.
000120             88  CL-FULL-MONTHS         VALUE '3'.
000121         16  CL-CAUSE-CD             PIC X(6).
000122
000123         16  CL-PRIME-CERT-NO.
000124             20  CL-PRIME-CERT-PRIME PIC X(10).
000125             20  CL-PRIME-CERT-SFX   PIC X.
000126
000127         16  CL-SYSTEM-IDENTIFIER    PIC XX.
000128             88  CL-CREDIT-CLAIM        VALUE 'CR'.
000129             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
000130
000131         16  CL-MICROFILM-NO         PIC X(10).
000132         16  FILLER REDEFINES CL-MICROFILM-NO.
000133             20  CL-BENEFIT-PERIOD   PIC 99.
000134             20  FILLER              PIC X(8).
000135         16  CL-PROG-FORM-TYPE       PIC X.
000136         16  CL-LAST-ADD-ON-DT       PIC XX.
000137
000138         16  CL-LAST-REOPEN-DT       PIC XX.
000139         16  CL-LAST-CLOSE-DT        PIC XX.
000140         16  CL-LAST-CLOSE-REASON    PIC X(01).
000141             88  FINAL-PAID             VALUE '1'.
000142             88  CLAIM-DENIED           VALUE '2'.
000143             88  AUTO-CLOSE             VALUE '3'.
000144             88  MANUAL-CLOSE           VALUE '4'.
000145             88  BENEFITS-CHANGED       VALUE 'C'.
000146             88  SETUP-ERRORS           VALUE 'E'.
000147         16  CL-ASSOC-CERT-SEQU      PIC S99.
000148         16  CL-ASSOC-CERT-TOTAL     PIC S99.
000149         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
000150             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
000151         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
000152         16  FILLER                  PIC X.
000153
000154     12  CL-CERTIFICATE-DATA.
000155         16  CL-CERT-ORIGIN          PIC X.
000156             88  CERT-WAS-ONLINE        VALUE '1'.
000157             88  CERT-WAS-CREATED       VALUE '2'.
000158             88  COVERAGE-WAS-ADDED     VALUE '3'.
000159         16  CL-CERT-KEY-DATA.
000160             20  CL-CERT-CARRIER     PIC X.
000161             20  CL-CERT-GROUPING    PIC X(6).
000162             20  CL-CERT-STATE       PIC XX.
000163             20  CL-CERT-ACCOUNT.
000164                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
000165                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
000166             20  CL-CERT-EFF-DT      PIC XX.
000167
000168     12  CL-STATUS-CONTROLS.
000169         16  CL-PRIORITY-CD          PIC X.
000170             88  CONFIDENTIAL-DATA      VALUE '8'.
000171             88  HIGHEST-PRIORITY       VALUE '9'.
000172         16  CL-SUPV-ATTN-CD         PIC X.
000173             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
000174             88  SUPV-IS-REQUIRED       VALUE 'Y'.
000175         16  CL-PURGED-DT            PIC XX.
000176         16  CL-RESTORED-DT          PIC XX.
000177         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
000178         16  CL-NEXT-RESEND-DT       PIC XX.
000179         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
000180         16  CL-CRITICAL-PERIOD      PIC 99.
000181*        16  FILLER                  PIC XX.
000182         16  CL-LAST-MAINT-DT        PIC XX.
000183         16  CL-LAST-MAINT-USER      PIC X(4).
000184         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
000185         16  CL-LAST-MAINT-TYPE      PIC X.
000186             88  CLAIM-SET-UP           VALUE ' '.
000187             88  PAYMENT-MADE           VALUE '1'.
000188             88  LETTER-SENT            VALUE '2'.
000189             88  MASTER-WAS-ALTERED     VALUE '3'.
000190             88  MASTER-WAS-RESTORED    VALUE '4'.
000191             88  INCURRED-DATE-CHANGED  VALUE '5'.
000192             88  FILE-CONVERTED         VALUE '6'.
000193             88  CHANGE-OF-BENEFITS     VALUE 'C'.
000194             88  ERROR-CORRECTION       VALUE 'E'.
000195         16  CL-RELATED-CLAIM-NO     PIC X(7).
000196         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
000197         16  CL-BENEFICIARY          PIC X(10).
000198         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
000199         16  CL-DENIAL-TYPE          PIC X.
000200             88  CL-TYPE-DENIAL          VALUE '1'.
000201             88  CL-TYPE-RESCISSION      VALUE '2'.
000202             88  CL-TYPE-REFORMATION     VALUE '3'.
000203             88  CL-TYPE-REF-TO-RES      VALUE '4'.
000204             88  CL-TYPE-RECONSIDERED    VALUE '5'.
000205         16  CL-NO-OF-EXTENSIONS     PIC 99.
000206
000207         16  filler                  pic x(3).
000208*        16  CL-CRIT-PER-RECURRENT   PIC X.
000209*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
000210*        16  CL-RTW-DT               PIC XX.
000211
000212     12  CL-TRAILER-CONTROLS.
000213         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
000214             88  CL-1ST-TRL-AVAIL       VALUE +4095.
000215             88  CL-LAST-TRL-AVAIL      VALUE +100.
000216             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
000217         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
000218         16  FILLER                  PIC XX.
000219         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
000220         16  CL-ADDRESS-TRAILER-CNT.
000221             20  CL-INSURED-ADDR-CNT  PIC S9(1).
000222                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
000223             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
000224                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
000225             20  CL-BENIF-ADDR-CNT    PIC S9(1).
000226                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
000227             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
000228                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
000229             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
000230                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
000231             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
000232                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
000233             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
000234                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
000235
000236     12  CL-CV-REFERENCE-NO.
000237         16  CL-CV-REFNO-PRIME       PIC X(18).
000238         16  CL-CV-REFNO-SFX         PIC XX.
000239
000240     12  CL-FILE-LOCATION            PIC X(4).
000241
000242     12  CL-PROCESS-ERRORS.
000243         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
000244             88  NO-FATAL-ERRORS        VALUE ZERO.
000245         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
000246             88  NO-FORCABLE-ERRORS     VALUE ZERO.
000247
000248     12  CL-PRODUCT-CD               PIC X.
000249
000250     12  CL-CURRENT-KEY-DATA.
000251         16  CL-CURRENT-CARRIER      PIC X.
000252         16  CL-CURRENT-GROUPING     PIC X(6).
000253         16  CL-CURRENT-STATE        PIC XX.
000254         16  CL-CURRENT-ACCOUNT      PIC X(10).
000255
000256     12  CL-ASSOCIATES               PIC X.
000257         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
000258         88  CL-ASSOC-INTERFACE         VALUE 'I'.
000259         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
000260         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
000261
000262     12  CL-ACTIVITY-CODE            PIC 99.
000263     12  CL-ACTIVITY-MAINT-DT        PIC XX.
000264     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
000265
000266     12  CL-LAPSE-REPORT-CODE        PIC 9.
000267     12  CL-LAG-REPORT-CODE          PIC 9.
000268     12  CL-LOAN-TYPE                PIC XX.
000269     12  CL-LEGAL-STATE              PIC XX.
000270
000271     12  CL-YESNOSW                  PIC X.
000272     12  CL-ACCIDENT-CLAIM-SW        PIC X.
000273         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
000274         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
000275         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
000276     12  cl-insured-type             pic x.
000277         88  cl-claim-on-primary         value 'P'.
000278         88  cl-claim-on-co-borrower     value 'C'.
000279     12  cl-benefit-expiration-dt    PIC XX.
      *<<((file: ELCMSTR))
000404
000405 01  PLAN-RECORDS.
000406     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
000407     12  LINK-AH-PLAN-RECORD     PIC X(420).
000408
000409     EJECT
       PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
       0000-DFHEXIT SECTION.
           MOVE FUNCTION WHEN-COMPILED TO DFHEIVL0(1:21).
           MOVE '9#                    %   ' TO DFHEIV0.
           MOVE 'EL050' TO DFHEIV1.
           CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1
                DFHEIVL0.
000410 VCOBOL-DUMMY-PROCEDURE.
000411
000412     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
000413
000414     
      * EXEC CICS  HANDLE CONDITION
000415*           ERROR    (9300-ABEND)
000416*           NOTOPEN  (3990-FILES-NOT-OPEN)
000417*    END-EXEC.
      *    MOVE '"$.J                  ! " #00007941' TO DFHEIV0
           MOVE X'22242E4A2020202020202020' &
                X'202020202020202020202120' &
                X'2220233030303037393431' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000418
000419 0000-COPY-PROCEDURE-DIV.
000420*                          COPY ELC50PD.
      *>>((file: ELC50PD))
000001******************************************************************
000002*                                                                *
000003*                            ELC50PD                             *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
000005*                            VMOD=2.188                          *
000006*                                                                *
000007******************************************************************
000008*                   C H A N G E   L O G
000009*
000010* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
000011*-----------------------------------------------------------------
000012*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
000013* EFFECTIVE    NUMBER
000014*-----------------------------------------------------------------
000015* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
000016* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
000017* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
000018*                             2709 AND 2718
000019* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
000020* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
000021* 011904                   PEMA  ADD TOTAL FEE PROCESSING
000022* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
000023* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
000024*                                IS OPEN OR CNC DT < PD THRU
000025* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
000026* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
000027* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
000028* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
000029* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
000030* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
000031* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
000032* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
000033* 092205  CR2005050300006  PEMA  ADD SPP LEASES
000034* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
000035* 020906                   PEMA  EXPAND LOAN OFFICER
000036* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
000037* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
000038* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
000039* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
000040* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
000041* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
000042* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
000043* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
000044* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
000045* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
000046* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
000047* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
000048* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
000049* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
000050* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
000051* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
000052* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
000053* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
000054* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
000055* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
000056* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
000057* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
000058* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
000059* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
000060* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
000061*                                UPDATE VIN ON CERT TRAILER
000062* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
000063* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
000064* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
000065* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
000066* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
000067* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
000068* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
000069* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
000070* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
000071* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
000072* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
000073* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
000074* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
000075* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
000076* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
000077* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
000078* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
000079* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
000080* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
000081* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
000082* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
000083* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
000084* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
000085* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
000086* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
000087* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
000088* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
000089* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
000090* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
000091* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
000092* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
000093* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
000094* 032912  CR2011110200001  PEMA  AHL CHANGES
000095* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
000096* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
000097* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
000098* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
000099* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
000100* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
000101* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
000102* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
000103* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
000104* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
000105* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
000106* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
000107* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
000108* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
000109* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
000110* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
000111* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
000112* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
000113* 120213  CR2013112500001  PEMA  Correct address edit - 2694
000114* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
000115* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
000116* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
000117* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
000118* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
000119* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
000120* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
000121* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
000122*                                CERT #, ADD 2898 FORCIBLE ERROR
000123* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
000124* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
000125* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
000126* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
000127* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
000128* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
000129* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
000130* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
000131* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
000132* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
000133* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
000134* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
000135* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
000136* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
000137* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
000138* 100617  CR2017062000003  PEMA  New comm cap edits
000139* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
000140* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
000141* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
000142* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
000143* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
000144* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
000145* 070218  IR2018062700001  PEMA  Fix edit for spaces in certno
000146* 092118  CR2018073000001  PEMA  Add lf & ah refund method to ELCR
000147* 092618  CR2018050200001  PEMA  Add check for open clm on issue
000148* 021519  CR2019021100001  PEMA  Non-monthly calcs for AL.
000149* 101019  CR2019100700001  PEMA  Disallow V status with claim
000150* 011020  IR2019121100004  PEMA  Add error 3069 name&age equal
000151* 012220  CR2018092700002  TANA  Add edit for letter required
000152* 012820  CR2020012800001  PEMA  ADD MIN LOAN TERM FOR EXTD TERM.
000153* 030920  IR2020030500001  PEMA  ADD ERROR 3071 FOR MOB BUSINESS
000154******************************************************************
000155************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
000156******************************************************************
000157
000158     INITIALIZE  WS-CRI-SSN-WORK-AREA.
000159
000160     MOVE SPACES                 TO PB-FATAL-FLAG
000161                                    PB-FORCE-ER-CD
000162                                    PB-WARN-ER-CD
000163                                    PB-OUT-BAL-CD.
000164
000165     MOVE SPACE                  TO WS-IG-OVRD-AH
000166                                    WS-IG-OVRD-LF
000167                                    WS-IG-OVRD-AM
000168                                    WS-IG-OVRD
000169                                    WS-IG-OVRD-AH-PL
000170                                    WS-IG-OVRD-LF-PL
000171                                    WS-IG-OVRD-AH-BEN
000172                                    WS-IG-OVRD-LF-BEN.
000173
000174******************************************************************
000175*************       INITIALIZE COMMON ERRORS       ***************
000176******************************************************************
000177
000178     MOVE +0                     TO PB-NO-OF-ERRORS.
000179     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
000180
000181******************************************************************
000182
000183     MOVE EIBDATE                TO DC-JULIAN-DATE.
000184     SET JULIAN-TO-BIN           TO TRUE.
000185*    MOVE 5                      TO DC-OPTION-CODE.
000186     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
000187     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
000188
000189     MOVE ZERO                   TO  SUB4.
000190
000191 0040-INITIALIZE-GA-BILL-DT.
000192
000193     ADD +1                      TO  SUB4.
000194
000195     IF  SUB4 GREATER THAN +5
000196         GO TO 0050-CHECK-CNTL-FOUND.
000197
000198     IF  PB-GA-BILL-DT (SUB4) = SPACES
000199         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
000200
000201     GO TO 0040-INITIALIZE-GA-BILL-DT.
000202
000203 0050-CHECK-CNTL-FOUND.
000204
000205     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
000206        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
000207                                         WS-AH-REM-TERM-CALC
000208                                         EC-CO-REM-TERM-CALC
000209        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
000210        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
000211        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
000212                                         WS-TOL-AH-CLAIM
000213        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
000214                                         WS-TOL-AH-PREM
000215                                         EC-CO-TOL-PREM
000216        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
000217                                         WS-TOL-AH-REFUND
000218                                         EC-CO-TOL-REFUND
000219        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
000220                                         WS-AH-REFUND-OVS-AMT
000221                                         EC-CO-OVR-SHT-AMT
000222        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
000223                                         WS-TOL-AH-PREM-PCT
000224                                         EC-CO-TOL-PREM-PCT
000225        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
000226                                         WS-TOL-AH-REFUND-PCT
000227                                         EC-CO-TOL-REFUND-PCT
000228        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
000229                                         WS-AH-REFUND-OVS-PCT
000230                                         EC-CO-OVR-SHT-PCT
000231        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
000232        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
000233        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
000234        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
000235        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
000236        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
000237        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
000238        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
000239        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
000240        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
000241        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
000242        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
000243                                         EC-CO-MONTH-END-DT
000244        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
000245          GO TO 0100-READ-ACCT.
000246
000247     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
000248     MOVE SPACES                 TO CNTL-ACCESS.
000249     MOVE '1'                    TO CNTL-REC-TYPE.
000250     MOVE +0                     TO CNTL-SEQ-NO.
000251
000252     MOVE '1' TO RC-SW-1.
000253     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
000254     IF NOT CF-COMPANY-MASTER
000255         MOVE ZEROS             TO WK-CO-TOL-PREM
000256                                   WK-CO-TOL-CLAIM
000257                                   WK-CO-TOL-REFUND
000258                                   WK-REFUND-OVS-AMT
000259                                   WK-REFUND-OVS-PCT
000260                                   WK-CO-TOL-PREM-PCT
000261                                   WK-CO-TOL-REFUND-PCT
000262                                   WK-DEFAULT-APR
000263                                   WK-CO-MAX-CAP
000264        MOVE SPACES             TO WK-CR-REM-TERM-CALC
000265                                   WK-CR-R78-METHOD
000266                                   WK-CO-REF-REJECT-SW
000267                                   WK-CO-PREM-REJECT-SW
000268                                   WK-REM-TRM-CALC-OPTION
000269                                   WK-BIRTH-DATE-INPUT
000270                                   WK-JOINT-AGE-INPUT
000271        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
000272        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
000273        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
000274        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
000275          GO TO 0099-COMPANY-NOT-FOUND.
000276
000277     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
000278        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
000279     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
000280        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
000281     IF CF-CO-TOL-CAP NOT NUMERIC
000282        MOVE +0                    TO CF-CO-TOL-CAP.
000283     IF CF-DEFAULT-APR NOT NUMERIC
000284        MOVE +0                    TO CF-DEFAULT-APR.
000285
000286     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
000287     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
000288     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
000289     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
000290     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
000291     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
000292     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
000293     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
000294     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
000295     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
000296     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
000297     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
000298
000299     IF CF-CO-OVR-SHT-AMT NUMERIC AND
000300          CF-CO-OVR-SHT-AMT > +0
000301        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
000302
000303     IF CF-CO-OVR-SHT-PCT NUMERIC AND
000304          CF-CO-OVR-SHT-PCT > +0
000305        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
000306
000307     IF CF-VALID-REM-TRM-OPTION
000308         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
000309     ELSE
000310         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
000311
000312     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
000313     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
000314     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
000315     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
000316
000317     GO TO 0050-CHECK-CNTL-FOUND.
000318
000319 0099-COMPANY-NOT-FOUND.
000320
000321     MOVE ER-2616                TO WS-ERROR.
000322     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
000323
000324 0100-READ-ACCT.
000325
000326     MOVE SPACES                 TO DATE-RANGE-SW.
000327
000328     IF WK-ACCT-ADDR = ZEROS
000329        GO TO 0102-ACCT-GETMAIN.
000330
000331     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
000332     SET ERACCT-FILE-ADDRESSED   TO TRUE.
000333     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
000334
000335     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
000336        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
000337        GO TO 0105-READ-ACCT
000338     END-IF
000339
000340     IF PB-CARRIER NOT = SPACES
000341        IF PB-CARRIER NOT = AM-VG-CARRIER
000342           GO TO 0105-READ-ACCT.
000343
000344     IF PB-STATE NOT = SPACES
000345        IF PB-STATE NOT = AM-VG-STATE
000346           GO TO 0105-READ-ACCT.
000347
000348     IF PB-GROUPING NOT = SPACES
000349        IF PB-GROUPING NOT = AM-VG-GROUPING
000350           GO TO 0105-READ-ACCT.
000351
000352     MOVE 'X'                 TO DATE-RANGE-SW.
000353
000354     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
000355        MOVE 'X'                 TO DATE-RANGE-SW
000356        GO TO 0105-READ-ACCT.
000357
000358     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
000359        GO TO 0105-READ-ACCT.
000360
000361     GO TO 0180-ACCOUNT-FOUND.
000362
000363 0102-ACCT-GETMAIN.
000364     PERFORM 8560-GETMAIN THRU 8560-EXIT.
000365     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
000366
000367 0105-READ-ACCT.
000368     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
000369     MOVE PB-CARRIER             TO ACCT-CARRIER.
000370     MOVE PB-GROUPING            TO ACCT-GROUPING.
000371     MOVE PB-STATE               TO ACCT-STATE.
000372     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
000373     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
000374
000375     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
000376
000377     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
000378
000379 0110-FIND-ACCT-TOLERANCES-LOOP.
000380
000381     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
000382
000383     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
000384        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
000385        GO TO 0199-ACCT-NOT-FOUND
000386     END-IF
000387     IF PB-CARRIER NOT = SPACES
000388        IF PB-CARRIER NOT = AM-VG-CARRIER
000389           GO TO 0199-ACCT-NOT-FOUND.
000390
000391     IF PB-STATE NOT = SPACES
000392        IF PB-STATE NOT = AM-VG-STATE
000393           GO TO 0199-ACCT-NOT-FOUND.
000394
000395     IF PB-GROUPING NOT = SPACES
000396        IF PB-GROUPING NOT = AM-VG-GROUPING
000397           GO TO 0199-ACCT-NOT-FOUND.
000398
000399     MOVE 'X'                    TO DATE-RANGE-SW.
000400
000401     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
000402        MOVE 'X'                 TO DATE-RANGE-SW
000403        GO TO 0199-ACCT-NOT-FOUND.
000404
000405     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
000406        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
000407
000408 0180-ACCOUNT-FOUND.
000409
000410     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
000411     MOVE AM-CARRIER             TO PB-SV-CARRIER.
000412     MOVE AM-STATE               TO PB-SV-STATE.
000413     MOVE AM-GROUPING            TO PB-SV-GROUPING.
000414
000415     IF AM-CANCEL-FEE  NOT NUMERIC
000416        MOVE ZEROS TO AM-CANCEL-FEE.
000417
000418     IF AM-MAX-MON-BEN NOT NUMERIC
000419        MOVE ZEROS TO AM-MAX-MON-BEN.
000420
000421     IF AM-MAX-TOT-BEN NOT NUMERIC
000422        MOVE ZEROS TO AM-MAX-TOT-BEN.
000423
000424     IF AM-CLP-TOL-PCT NOT NUMERIC
000425        MOVE +0                  TO AM-CLP-TOL-PCT
000426     END-IF
000427     IF AM-SPP-LEASE-COMM NOT NUMERIC
000428        MOVE +0                  TO AM-SPP-LEASE-COMM
000429     END-IF
000430     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
000431        MOVE ER-2611             TO   WS-ERROR
000432        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
000433
000434     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
000435        MOVE ER-2621             TO   WS-ERROR
000436        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
000437
000438     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
000439        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
000440        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
000441        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
000442         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
000443
000444     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
000445     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
000446     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
000447     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
000448     IF AM-CLP-TOL-PCT NOT = ZEROS
000449        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
000450     END-IF
000451     IF AM-SPP-LEASE-COMM NOT = ZEROS
000452        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
000453     END-IF
000454
000455*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
000456*       MOVE +0                  TO WS-ACCT-ADDL-CLP
000457*                                   WS-ADMIN-FEES
000458*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
000459*          (SUB5 > +10)
000460*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
000461*             AND (AM-A-COM (SUB5) NUMERIC)
000462*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
000463*                + (AM-A-COM (SUB5) * 1000)
000464*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
000465*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
000466*                + (AM-A-COM (SUB5) * 1000)
000467*             END-IF
000468*             IF AM-COM-TYP (SUB5) = 'N'
000469*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
000470*                + (AM-A-COM (SUB5) * 1000)
000471*             END-IF
000472*          END-IF
000473*       END-PERFORM
000474*    END-IF
000475
000476     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
000477        AND (PB-ISSUE)
000478        MOVE +0                  TO WS-ACCT-ADDL-CLP
000479                                    ws-cred-union-fees
000480        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
000481           (SUB5 > +10)
000482           MOVE +0 TO WS-WK-RATE
000483           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
000484                                   'O' OR 'S')
000485              IF (AM-A-COM (SUB5) NUMERIC)
000486                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
000487                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
000488              ELSE
000489                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
000490                 IF PB-ISSUE
000491                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
000492                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
000493                 ELSE
000494                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
000495                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
000496                 END-IF
000497                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
000498                 MOVE ZEROS             TO WS-SUB1
000499                                           WS-COMMISSION
000500                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
000501                 MOVE '0530'               TO CTBL-SW
000502                 MOVE ' '                  TO WS-CTBL-READ-SW
000503                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
000504                 IF FIRST-TIME-THROUGH
000505                    MOVE 'AA'              TO CTBL-BEN-CODE
000506                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
000507                 END-IF
000508                 IF CTBL-TABLE-FOUND
000509                    IF PB-ISSUE
000510                       COMPUTE WS-COMM-CK-AMT =
000511                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
000512                    ELSE
000513                       COMPUTE WS-COMM-CK-AMT =
000514                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
000515                    END-IF
000516                    PERFORM 8800-GET-COMP-RATE
000517                              THRU 8800-EXIT
000518                 END-IF
000519              END-IF
000520              if am-com-typ (sub5) = 'O' or 'S'
000521                 compute ws-cred-union-fees rounded =
000522                    ws-cred-union-fees +
000523                    (pb-i-ah-premium-amt * ws-wk-rate)
000524              else
000525                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
000526                + (WS-WK-RATE * 1000)
000527              end-if
000528           END-IF
000529        END-PERFORM
000530     END-IF
000531
000532     IF PB-COMPANY-ID EQUAL 'CRI'
000533         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
000534
000535     IF PB-COMPANY-ID EQUAL 'NCL'
000536         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
000537     END-IF
000538
000539     GO TO 0200-READ-CERT.
000540
000541 0199-ACCT-NOT-FOUND.
000542
000543     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
000544
000545     IF DATE-RANGE-SW NOT = SPACES
000546        MOVE ER-2601             TO WS-ERROR
000547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
000548     ELSE
000549        MOVE ER-2619             TO WS-ERROR
000550        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
000551
000552     GO TO 9990-RETURN.
000553
000554 0200-READ-CERT.
000555
000556     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
000557     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
000558     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
000559     MOVE PB-SV-STATE            TO CERT-STATE.
000560     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
000561     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
000562     MOVE PB-CERT-NO             TO CERT-CERT-NO.
000563
000564     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
000565
000566     IF CERT-WAS-NOT-FOUND
000567        GO TO 0299-CERT-NOT-FOUND.
000568
000569     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
000570        MOVE ER-2759             TO WS-ERROR
000571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
000572        GO TO 0298-UNLOCK-RETURN.
000573
000574     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
000575         MOVE ER-2758            TO WS-ERROR
000576         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
000577         GO TO 0298-UNLOCK-RETURN.
000578
000579     IF PB-ISSUE
000580        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
000581           IF CERT-WAS-CREATED-FOR-CLAIM
000582              NEXT SENTENCE
000583            ELSE
000584              MOVE ER-2626       TO WS-ERROR
000585              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
000586              GO TO 0298-UNLOCK-RETURN.
000587
000588     IF NOT PB-CANCELLATION
000589        GO TO 0300-CONTINUE-EDIT.
000590
000591     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
000592     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
000593     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
000594     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
000595     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
000596     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
000597
000598     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
000599     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
000600     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
000601     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
000602     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
000603     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
000604     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
000605     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
000606     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
000607
000608     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
000609     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
000610     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
000611     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
000612     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
000613     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
000614     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
000615
000616     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
000617     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
000618
000619     MOVE CM-CREDIT-INTERFACE-SW-1
000620                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
000621     MOVE CM-CREDIT-INTERFACE-SW-2
000622                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
000623
000624     IF CM-O-B-COVERAGE
000625         MOVE 'B'                 TO PB-CI-OB-FLAG.
000626
000627     IF CM-LIVES NOT NUMERIC
000628         MOVE ZERO                TO CM-LIVES.
000629
000630     IF CM-BILLED NOT NUMERIC
000631         MOVE ZERO                TO CM-BILLED.
000632
000633     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
000634         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
000635         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
000636         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
000637         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
000638         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
000639         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
000640         MOVE CM-LIVES             TO PB-CI-LIVES
000641*The next line causes a problem with my change  I dont think it is
000642*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
000643
000644     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
000645     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
000646     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
000647     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
000648     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
000649     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
000650
000651     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
000652     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
000653     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
000654     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
000655
000656     IF CM-LIFE-COMM-PCT NUMERIC
000657         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
000658     ELSE
000659         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
000660
000661     IF CM-AH-COMM-PCT NUMERIC
000662         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
000663     ELSE
000664         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
000665
000666     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
000667
000668     IF CM-LOAN-APR       NOT NUMERIC
000669           MOVE ZERO               TO CM-LOAN-APR.
000670
000671     IF CM-PAY-FREQUENCY  NOT NUMERIC
000672           MOVE ZERO               TO CM-PAY-FREQUENCY.
000673
000674     IF CM-LOAN-TERM      NOT NUMERIC
000675           MOVE ZERO               TO CM-LOAN-TERM.
000676
000677     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
000678           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
000679
000680     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
000681           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
000682
000683     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
000684     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
000685     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
000686     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
000687     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
000688     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
000689     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
000690     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
000691     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
000692     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
000693     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
000694     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
000695     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
000696
000697     IF CM-STATE = CM-SSN-STATE
000698         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
000699
000700     IF CM-STATE NOT = CM-MEMB-STATE
000701         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
000702
000703     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
000704
000705     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
000706*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
000707        IF CM-ADDL-CLP NOT NUMERIC
000708           MOVE +0               TO CM-ADDL-CLP
000709        END-IF
000710        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
000711        IF AM-DCC-PRODUCT-CODE = 'DDF'
000712           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
000713        END-IF
000714     END-IF
000715
000716     IF PB-COMPANY-ID = 'DCC' or 'VPP'
000717        MOVE +0                  TO WS-ADMIN-FEES
000718                                    WS-CSO-ADMIN-FEE
000719                                    WS-COMM-AND-MFEE
000720                                    WS-1ST-YR-ALLOW
000721        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
000722           (SUB5 > +10)
000723           MOVE +0 TO WS-WK-RATE
000724           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
000725              IF (AM-A-COM (SUB5) NUMERIC)
000726                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
000727                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
000728              ELSE
000729                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
000730                 IF PB-ISSUE
000731                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
000732                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
000733                 ELSE
000734                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
000735                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
000736                 END-IF
000737                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
000738                 MOVE ZEROS             TO WS-SUB1
000739                                           WS-COMMISSION
000740                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
000741                 MOVE '0530'               TO CTBL-SW
000742                 MOVE ' '                  TO WS-CTBL-READ-SW
000743                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
000744                 IF FIRST-TIME-THROUGH
000745                    MOVE 'AA'              TO CTBL-BEN-CODE
000746                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
000747                 END-IF
000748                 IF CTBL-TABLE-FOUND
000749                    IF PB-ISSUE
000750                       COMPUTE WS-COMM-CK-AMT =
000751                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
000752                    ELSE
000753                       COMPUTE WS-COMM-CK-AMT =
000754                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
000755                    END-IF
000756                    PERFORM 8800-GET-COMP-RATE
000757                              THRU 8800-EXIT
000758                 END-IF
000759              END-IF
000760              IF AM-COM-TYP (SUB5) = 'I'
000761                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
000762                   + (WS-WK-RATE * 1000)
000763              END-IF
000764              IF AM-COM-TYP (SUB5) = 'N'
000765                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
000766                   + (WS-WK-RATE * 1000)
000767              END-IF
000768              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
000769                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
000770                   + (WS-WK-RATE * 1000)
000771              END-IF
000772              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
000773                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
000774                   + (WS-WK-RATE * 1000)
000775              END-IF
000776           END-IF
000777        END-PERFORM
000778     END-IF
000779
000780     GO TO 0300-CONTINUE-EDIT.
000781
000782 0298-UNLOCK-RETURN.
000783      PERFORM 9250-UNLOCK-RETURN
000784      GO TO 9990-RETURN.
000785
000786 0299-CERT-NOT-FOUND.
000787
000788     MOVE '1'                     TO CERT-STATUS-SW.
000789
000790     IF PB-COMPANY-ID = 'UCL'
000791         IF WS-ERROR = ER-2799
000792             GO TO 3000-CONTINUE-EDIT.
000793
000794     IF NOT PB-CANCELLATION
000795         GO TO 0300-CONTINUE-EDIT.
000796
000797     MOVE ER-2726                  TO  WS-ERROR.
000798     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
000799     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
000800     MOVE ZEROS                  TO PB-CI-INSURED-AGE
000801                                    PB-CI-LF-TERM
000802                                    PB-C-LF-REM-TERM
000803                                    PB-CI-AH-TERM
000804                                    PB-C-AH-REM-TERM
000805                                    PB-CI-LF-BENEFIT-CD
000806                                    PB-CI-LF-BENEFIT-AMT
000807                                    PB-CI-LF-ALT-BENEFIT-AMT
000808                                    PB-CI-LF-PREMIUM-AMT
000809                                    PB-CI-LF-ALT-PREMIUM-AMT
000810                                    PB-CI-AH-BENEFIT-CD
000811                                    PB-CI-AH-BENEFIT-AMT
000812                                    PB-CI-AH-PREMIUM-AMT
000813                                    PB-CI-PAY-FREQUENCY
000814                                    PB-CI-LOAN-APR
000815                                    PB-CI-LOAN-TERM
000816                                    PB-CI-LIFE-COMMISSION
000817                                    PB-CI-AH-COMMISSION
000818                                    PB-CI-CURR-SEQ
000819                                    PB-CI-AH-CANCEL-AMT
000820                                    PB-CI-LF-CANCEL-AMT
000821                                    PB-CI-RATE-DEV-PCT-LF
000822                                    PB-CI-RATE-DEV-PCT-AH
000823                                    PB-CI-EXTENTION-DAYS
000824                                    PB-CI-TERM-IN-DAYS
000825                                    PB-CI-LIVES
000826                                    PB-CI-LF-CRIT-PER
000827                                    PB-CI-AH-CRIT-PER
000828                                    PB-CI-ADDL-CLP
000829                                    PB-CI-DDF-IU-RATE-UP.
000830
000831     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
000832                                    PB-CI-AH-SETTLEMENT-DT
000833                                    PB-CI-DEATH-DT
000834                                    PB-CI-LF-PRIOR-CANCEL-DT
000835                                    PB-CI-AH-PRIOR-CANCEL-DT
000836                                    PB-CI-ENTRY-DT
000837                                    PB-CI-LF-EXPIRE-DT
000838                                    PB-CI-AH-EXPIRE-DT
000839                                    PB-CI-LOAN-1ST-PMT-DT.
000840
000841     IF ACCOUNT-MAST-FOUND
000842        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
000843        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
000844
000845
000846 0300-CONTINUE-EDIT.
000847
000848     IF PB-ISSUE
000849        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
000850            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
000851
000852     IF PB-ISSUE
000853        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
000854            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
000855
000856     IF PB-ISSUE
000857       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
000858          (AM-NO-AH-ONLY)
000859           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
000860               IF PB-I-LIFE-BENEFIT-CD = ZEROS
000861                   MOVE ER-2679 TO WS-ERROR
000862                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
000863
000864     IF PB-ISSUE
000865        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
000866        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
000867        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
000868     ELSE
000869        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
000870        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
000871        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
000872
000873     MOVE 'N'                    TO PLAN-MASTER-SW
000874                                    PLAN-MASTER-LIFE-SW
000875                                    FORM-MASTER-SW
000876                                    WS-APP-CERT-SW.
000877
000878     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
000879                                    WS-PL-TOL-LF-REFUND
000880                                    WS-PL-REF-OVS-AMT
000881                                    WS-PL-TOL-LF-PREM-PCT
000882                                    WS-PL-TOL-LF-REFUND-PCT
000883                                    WS-PL-REF-OVS-PCT
000884                                    WS-PL-TOL-LF-CLAIM.
000885
000886     IF PB-COMPANY-ID = 'NCL'
000887       IF PB-ISSUE
000888         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
000889             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
000890             IF FORM-MASTER-FOUND
000891                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
000892
000893     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
000894        GO TO 0310-FIND-AH-BENEFIT-RECORD.
000895
000896********************** MON CODE **********************
000897     IF PB-COMPANY-ID = 'MON'
000898     IF PB-ISSUE
000899     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
000900        AND (PB-I-LOAN-APR NOT NUMERIC OR
000901             PB-I-LOAN-APR = ZERO)
000902               MOVE 14.0         TO PB-I-LOAN-APR.
000903******************************************************
000904
000905     IF PB-COMPANY-ID = 'NCL'
000906       IF PB-ISSUE
000907           IF FORM-MASTER-FOUND
000908             IF FO-DISMEMBERMENT-CD = 'Y'  AND
000909                AM-DISMBR-COVERAGE
000910                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
000911                 IF WS-LF-INPUT-CD-1 NOT = 'B'
000912                   MOVE '8'            TO  WS-LF-INPUT-CD-1
000913                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
000914                                           PB-I-LIFE-BENEFIT-CD.
000915
000916     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
000917
000918     IF WK-LIFE-BEN-ADDR NOT = ZEROS
000919         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
000920         SET ELCNTL-FILE-ADDRESSED   TO TRUE
000921         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
000922         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
000923         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
000924           AND NOT LESS THAN CF-BENEFIT-CODE (1)
000925             GO TO 0301-LIFE-BENEFIT-SEARCH
000926         ELSE
000927             NEXT SENTENCE
000928     ELSE
000929         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
000930
000931     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
000932     MOVE '4'                    TO CNTL-REC-TYPE.
000933     MOVE +0                     TO CNTL-SEQ-NO.
000934     MOVE WS-ACCESS              TO CNTL-ACCESS.
000935
000936     MOVE '1' TO RC-SW-2.
000937     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
000938
000939     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
000940        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
000941         GO TO 0305-BENEFIT-NOT-FOUND.
000942
000943     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
000944
000945 0301-LIFE-BENEFIT-SEARCH.
000946
000947     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
000948
000949     IF NO-BENEFIT-FOUND
000950        GO TO 0305-BENEFIT-NOT-FOUND.
000951
000952     IF WS-BEN-CD = '99'
000953        GO TO 0305-BENEFIT-NOT-FOUND.
000954
000955     IF PB-COMPANY-ID = 'NCL'
000956         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
000957             GO TO 0304-LIFE-BENEFIT-FOUND.
000958
000959     MOVE +1                     TO SUB5.
000960     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
000961
000962* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
000963* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
000964     IF PB-COMPANY-ID = 'DMD'
000965         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
000966
000967 0302-EDIT-ACCT-LF-BENEFITS.
000968
000969     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
000970        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
000971           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
000972                                 TO WS-SAVE-ALLOWABLE-BENEFIT
000973           GO TO 03XX-GET-LIFE-ERPLAN.
000974
000975     IF SUB5 LESS THAN +20
000976        ADD +1                   TO SUB5
000977        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
000978
000979     MOVE +1                     TO SUB5.
000980
000981     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
000982        GO TO 03XX-EDIT-FOR-NINETY-LF.
000983
000984 0303-EDIT-DMD-EXTRA-BENEFITS.
000985
000986     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
000987        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
000988           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
000989                                 TO WS-SAVE-ALLOWABLE-BENEFIT
000990           GO TO 03XX-GET-LIFE-ERPLAN.
000991
000992     IF SUB5 LESS THAN +30
000993        ADD +1                   TO SUB5
000994        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
000995
000996     MOVE +1                     TO SUB5.
000997
000998 03XX-EDIT-FOR-NINETY-LF.
000999
001000***************************************************************
001001*                                                             *
001002*    NINETY BENEFIT PLAN TYPES:                               *
001003*                                                             *
001004*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
001005*      92 = ALL GROUP REDUCING BENEFITS                       *
001006*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
001007*      94 = ALL GROUP LEVEL BENEFITS                          *
001008*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
001009*           BENEFIT CONTROLS.                                 *
001010*      99 = ALL BENEFITS                                      *
001011*                                                             *
001012***************************************************************
001013
001014     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
001015                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
001016
001017     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
001018       AND
001019        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
001020        GO TO 03XX-GET-LIFE-ERPLAN.
001021
001022     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
001023       AND
001024        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
001025        IF CF-REDUCING (SUB3)
001026           IF (PB-I-INDV-GRP-OVRD = 'I')
001027              OR
001028           ((AM-IG = '1') AND
001029           (PB-I-INDV-GRP-OVRD NOT = 'G'))
001030              OR
001031           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
001032           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
001033           (AM-IG NOT = '2'))
001034              GO TO 03XX-GET-LIFE-ERPLAN.
001035
001036     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
001037       AND
001038        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
001039        IF CF-REDUCING (SUB3)
001040           IF (PB-I-INDV-GRP-OVRD = 'G')
001041              OR
001042           ((AM-IG = '2') AND
001043           (PB-I-INDV-GRP-OVRD NOT = 'I'))
001044              OR
001045           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
001046           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
001047           (AM-IG NOT = '1'))
001048              GO TO 03XX-GET-LIFE-ERPLAN.
001049
001050     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
001051       AND
001052        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
001053        IF CF-LEVEL    (SUB3)
001054           IF (PB-I-INDV-GRP-OVRD = 'I')
001055              OR
001056           ((AM-IG = '1') AND
001057           (PB-I-INDV-GRP-OVRD NOT = 'G'))
001058              OR
001059           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
001060           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
001061            (AM-IG NOT = '2'))
001062              GO TO 03XX-GET-LIFE-ERPLAN.
001063
001064     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
001065       AND
001066        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
001067        IF CF-LEVEL    (SUB3)
001068           IF (PB-I-INDV-GRP-OVRD = 'G')
001069              OR
001070           ((AM-IG = '2') AND
001071           (PB-I-INDV-GRP-OVRD NOT = 'G'))
001072              OR
001073           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
001074           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
001075           (AM-IG NOT = '1'))
001076              GO TO 03XX-GET-LIFE-ERPLAN.
001077
001078     IF SUB5 LESS THAN +20
001079        ADD +1                   TO SUB5
001080        GO TO 03XX-EDIT-FOR-NINETY-LF.
001081
001082     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
001083
001084     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
001085        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
001086
001087     MOVE +1                     TO SUB5.
001088
001089 03XX-EDIT-DMD-EXTRA-NINETY-LF.
001090
001091     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
001092                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
001093
001094     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
001095       AND
001096        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
001097        GO TO 03XX-GET-LIFE-ERPLAN.
001098
001099     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
001100       AND
001101        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
001102        IF CF-REDUCING (SUB3)
001103           IF (PB-I-INDV-GRP-OVRD = 'I')
001104              OR
001105           ((AM-IG = '1') AND
001106           (PB-I-INDV-GRP-OVRD NOT = 'G'))
001107              OR
001108           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
001109           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
001110           (AM-IG NOT = '2'))
001111              GO TO 03XX-GET-LIFE-ERPLAN.
001112
001113     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
001114       AND
001115        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
001116        IF CF-REDUCING (SUB3)
001117           IF (PB-I-INDV-GRP-OVRD = 'G')
001118              OR
001119           ((AM-IG = '2') AND
001120           (PB-I-INDV-GRP-OVRD NOT = 'I'))
001121              OR
001122           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
001123           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
001124           (AM-IG NOT = '1'))
001125              GO TO 03XX-GET-LIFE-ERPLAN.
001126
001127     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
001128       AND
001129        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
001130        IF CF-LEVEL    (SUB3)
001131           IF (PB-I-INDV-GRP-OVRD = 'I')
001132              OR
001133           ((AM-IG = '1') AND
001134           (PB-I-INDV-GRP-OVRD NOT = 'G'))
001135              OR
001136           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
001137           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
001138            (AM-IG NOT = '2'))
001139              GO TO 03XX-GET-LIFE-ERPLAN.
001140
001141     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
001142       AND
001143        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
001144        IF CF-LEVEL    (SUB3)
001145           IF (PB-I-INDV-GRP-OVRD = 'G')
001146              OR
001147           ((AM-IG = '2') AND
001148           (PB-I-INDV-GRP-OVRD NOT = 'G'))
001149              OR
001150           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
001151           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
001152           (AM-IG NOT = '1'))
001153              GO TO 03XX-GET-LIFE-ERPLAN.
001154
001155     IF SUB5 LESS THAN +30
001156        ADD +1                   TO SUB5
001157        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
001158
001159     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
001160
001161 03XX-EDIT-FOR-NINETY-LF-CONT.
001162
001163     MOVE +99                    TO SUB5.
001164
001165     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
001166        IF PB-ISSUE
001167           MOVE ER-1924          TO  WS-ERROR
001168           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
001169
001170     GO TO 0304-LIFE-BENEFIT-FOUND.
001171
001172 03XX-GET-LIFE-ERPLAN.
001173
001174     IF WK-PLAN-ADDR EQUAL +0
001175        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
001176
001177     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
001178     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
001179     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
001180     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
001181     MOVE 'Y'                    TO PLAN-MASTER-SW
001182                                    PLAN-MASTER-LIFE-SW.
001183     GO TO XXXX-CHECK-LF-PLAN-KEY.
001184
001185 03XX-ERPLAN-LIFE-GETMAIN.
001186
001187     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
001188     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
001189
001190 03XX-ERPLAN-LIFE-READ.
001191
001192     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
001193     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
001194     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
001195     MOVE PB-SV-STATE            TO PLAN-STATE.
001196     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
001197     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
001198     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
001199     MOVE WS-SAVE-BENEFIT-REVISION
001200                                 TO PLAN-REVISION-NO.
001201
001202     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
001203     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
001204
001205     IF PB-COMPANY-ID = 'NCL'
001206       IF NOT LF-PLAN-MASTER-FOUND
001207         IF NOT PB-POLICY-IS-DECLINED  AND
001208            NOT PB-POLICY-IS-VOIDED
001209             MOVE  ER-1921         TO  WS-ERROR
001210             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
001211             GO TO 0304-LIFE-BENEFIT-FOUND.
001212
001213     IF NOT LF-PLAN-MASTER-FOUND
001214        GO TO 0304-LIFE-BENEFIT-FOUND.
001215
001216 XXXX-CHECK-LF-PLAN-KEY.
001217
001218     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
001219        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
001220        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
001221        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
001222        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
001223        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
001224        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
001225        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
001226        MOVE 'N'                 TO PLAN-MASTER-SW
001227          GO TO 03XX-ERPLAN-LIFE-READ.
001228
001229     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
001230
001231     IF  PB-CANCELLATION
001232         GO TO  0303-LF-ACCT-BEN-FOUND.
001233
001234     IF PL-EDIT-FOR-FORM EQUAL 'Y'
001235        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
001236           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
001237           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
001238              MOVE ER-2644             TO WS-ERROR
001239              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001240           ELSE
001241              NEXT SENTENCE
001242        ELSE
001243           IF PB-COMPANY-ID NOT = 'NCL'
001244              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
001245                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
001246
001247 0303-LF-ACCT-BEN-FOUND.
001248
001249     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
001250
001251     IF PL-DEV-CODE NOT = SPACES
001252        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
001253
001254     IF PL-DEV-PCT NUMERIC AND
001255        PL-DEV-PCT NOT = ZEROS
001256        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
001257
001258     IF PL-TOL-PREM-AMT GREATER THAN +0
001259        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
001260
001261     IF PL-TOL-REF-AMT GREATER THAN +0
001262        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
001263
001264     IF PL-TOL-PREM-PCT GREATER THAN +0
001265        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
001266
001267     IF PL-TOL-REF-PCT GREATER THAN +0
001268        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
001269
001270     IF PL-TOL-CLM-AMT GREATER THAN +0
001271        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
001272
001273     IF PL-OVER-SHORT-AMT NUMERIC  AND
001274                          PL-OVER-SHORT-AMT > +0
001275        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
001276
001277     IF PL-OVER-SHORT-PCT NUMERIC  AND
001278                          PL-OVER-SHORT-PCT > +0
001279        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
001280
001281     IF PL-SALES-TAX NUMERIC AND
001282                          PL-SALES-TAX > +0
001283         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
001284
001285     IF PL-IG NOT EQUAL SPACES AND ZEROS
001286        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
001287                                    WS-IG-OVRD-AM.
001288
001289 0304-LIFE-BENEFIT-FOUND.
001290
001291     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
001292
001293     IF PB-ISSUE
001294        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
001295     ELSE
001296        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
001297
001298     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
001299     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
001300     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
001301     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
001302     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
001303                                         WS-LF-REFUND-CALC.
001304     if (ws-lf-earnings-calc = '5')
001305        and (pb-i-loan-apr = zeros)
001306        and (benefit-code-chg)
001307        move +99.9999 to pb-i-loan-apr
001308     end-if
001309
001310     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
001311        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
001312
001313     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
001314        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
001315
001316     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
001317
001318     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
001319     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
001320     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
001321     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
001322     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
001323     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
001324
001325     IF PB-COMPANY-ID = 'NCL'  AND
001326        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
001327         NEXT SENTENCE
001328     ELSE
001329         IF SUB5 NOT GREATER THAN +20
001330            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
001331               MOVE WS-SAVE-BENEFIT-REM-TERM
001332                                      TO WS-AM-LF-BENE-REM-TERM
001333                                         EC-BR-LF-REM-TERM-CALC.
001334
001335     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
001336     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
001337
001338     GO TO 0310-FIND-AH-BENEFIT-RECORD.
001339
001340 0305-BENEFIT-NOT-FOUND.
001341
001342     MOVE '1'                    TO LF-BENEFIT-ERROR.
001343     MOVE ER-2604                TO WS-ERROR.
001344     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
001345
001346     EJECT
001347
001348 0310-FIND-AH-BENEFIT-RECORD.
001349
001350     MOVE 'N'                    TO PLAN-MASTER-SW
001351                                    PLAN-MASTER-AH-SW.
001352
001353     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
001354                                    WS-PL-TOL-AH-REFUND
001355                                    WS-AH-PL-REF-OVS-AMT
001356                                    WS-PL-TOL-AH-PREM-PCT
001357                                    WS-PL-TOL-AH-REFUND-PCT
001358                                    WS-AH-PL-REF-OVS-PCT
001359                                    WS-PL-TOL-AH-CLAIM.
001360     MOVE ' '                    TO WS-AH-DCC-TRUNC
001361
001362
001363     if pb-issue
001364        IF PB-I-AH-INPUT-CD EQUAL ZEROS
001365           MOVE SPACES              TO PB-I-AH-INPUT-CD
001366        end-if
001367        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
001368           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
001369           GO TO 0399-BENEFIT-NOT-FOUND
001370        end-if
001371     end-if
001372
001373     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
001374        GO TO 0400-FIND-CARRIER.
001375
001376     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
001377
001378     IF WK-AH-BEN-ADDR NOT = ZEROS
001379         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
001380         SET ELCNTL-FILE-ADDRESSED TO TRUE
001381         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
001382         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
001383           AND NOT LESS THAN CF-BENEFIT-CODE (1)
001384             GO TO 0311-AH-BENEFIT-SEARCH
001385         ELSE
001386             NEXT SENTENCE
001387     ELSE
001388         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
001389
001390     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
001391     MOVE '5'                    TO CNTL-REC-TYPE.
001392     MOVE +0                     TO CNTL-SEQ-NO.
001393     MOVE WS-ACCESS              TO CNTL-ACCESS.
001394
001395     MOVE '2' TO RC-SW-2.
001396     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
001397
001398     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
001399        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
001400          GO TO 0399-BENEFIT-NOT-FOUND.
001401
001402     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
001403
001404 0311-AH-BENEFIT-SEARCH.
001405
001406     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
001407
001408     IF NO-BENEFIT-FOUND
001409         GO TO 0399-BENEFIT-NOT-FOUND.
001410
001411     IF WS-BEN-CD = '99'
001412        GO TO 0399-BENEFIT-NOT-FOUND.
001413
001414     IF PB-COMPANY-ID  =  'NCL'
001415         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
001416             GO TO 0314-A-H-BENEFIT-FOUND.
001417
001418     MOVE +1                     TO SUB5.
001419     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
001420
001421* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
001422* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
001423     IF PB-COMPANY-ID = 'DMD'
001424         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
001425
001426 0312-EDIT-ACCT-AH-BENEFITS.
001427
001428     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
001429        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
001430           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
001431                                 TO WS-SAVE-ALLOWABLE-BENEFIT
001432           GO TO 03XX-GET-AH-ERPLAN.
001433
001434     IF SUB5 LESS THAN +20
001435        ADD +1                   TO SUB5
001436        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
001437
001438     MOVE +1                     TO SUB5.
001439
001440     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
001441        GO TO 03XX-EDIT-FOR-NINETY-AH.
001442
001443 0313-EDIT-DMD-EXTRA-BENEFITS.
001444
001445     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
001446        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
001447           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
001448                                 TO WS-SAVE-ALLOWABLE-BENEFIT
001449           GO TO 03XX-GET-AH-ERPLAN.
001450
001451     IF SUB5 LESS THAN +30
001452        ADD +1                   TO SUB5
001453        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
001454
001455     MOVE +1                     TO SUB5.
001456
001457 03XX-EDIT-FOR-NINETY-AH.
001458
001459***************************************************************
001460*                                                             *
001461*    NINETY BENEFIT PLAN TYPES:                               *
001462*                                                             *
001463*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
001464*      92 = ALL GROUP REDUCING BENEFITS.                      *
001465*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
001466*           BENEFIT CONTROLS.                                 *
001467*      99 = ALL BENEFITS.                                     *
001468*                                                             *
001469***************************************************************
001470
001471     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
001472                                TO WS-SAVE-ALLOWABLE-BENEFIT.
001473
001474     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
001475       AND
001476        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
001477        GO TO 03XX-GET-AH-ERPLAN.
001478
001479     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
001480       AND
001481        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
001482           IF (PB-I-INDV-GRP-OVRD = 'I')
001483              OR
001484           ((AM-IG = '1') AND
001485           (PB-I-INDV-GRP-OVRD NOT = 'G'))
001486              OR
001487           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
001488           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
001489           (AM-IG NOT = '2'))
001490              GO TO 03XX-GET-AH-ERPLAN.
001491
001492     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
001493       AND
001494        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
001495           IF (PB-I-INDV-GRP-OVRD = 'G')
001496              OR
001497           ((AM-IG = '2') AND
001498           (PB-I-INDV-GRP-OVRD NOT = 'I'))
001499              OR
001500           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
001501           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
001502           (AM-IG NOT = '1'))
001503              GO TO 03XX-GET-AH-ERPLAN.
001504
001505     IF SUB5 LESS THAN +20
001506        ADD +1                   TO SUB5
001507        GO TO 03XX-EDIT-FOR-NINETY-AH.
001508
001509     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
001510        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
001511
001512     MOVE +1                    TO SUB5.
001513
001514 03XX-EDIT-DMD-EXTRA-NINETY-AH.
001515
001516     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
001517                                TO WS-SAVE-ALLOWABLE-BENEFIT.
001518
001519     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
001520       AND
001521        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
001522        GO TO 03XX-GET-AH-ERPLAN.
001523
001524     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
001525       AND
001526        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
001527           IF (PB-I-INDV-GRP-OVRD = 'I')
001528              OR
001529           ((AM-IG = '1') AND
001530           (PB-I-INDV-GRP-OVRD NOT = 'G'))
001531              OR
001532           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
001533           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
001534           (AM-IG NOT = '2'))
001535              GO TO 03XX-GET-AH-ERPLAN.
001536
001537     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
001538       AND
001539        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
001540           IF (PB-I-INDV-GRP-OVRD = 'G')
001541              OR
001542           ((AM-IG = '2') AND
001543           (PB-I-INDV-GRP-OVRD NOT = 'I'))
001544              OR
001545           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
001546           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
001547           (AM-IG NOT = '1'))
001548              GO TO 03XX-GET-AH-ERPLAN.
001549
001550     IF SUB5 LESS THAN +30
001551        ADD +1                   TO SUB5
001552        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
001553
001554 03XX-EDIT-FOR-NINETY-AH-CONT.
001555
001556     MOVE +99                    TO SUB5.
001557
001558     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
001559
001560     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
001561        IF PB-ISSUE
001562           MOVE ER-1925          TO  WS-ERROR
001563           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
001564
001565     GO TO 0314-A-H-BENEFIT-FOUND.
001566
001567 03XX-GET-AH-ERPLAN.
001568
001569     IF WK-PLAN-ADDR EQUAL +0
001570         GO TO 03XX-ERPLAN-AH-GETMAIN.
001571
001572     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
001573     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
001574     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
001575     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
001576     MOVE 'Y'                    TO PLAN-MASTER-SW
001577                                    PLAN-MASTER-AH-SW.
001578*****GO TO XXXX-CHECK-AH-PLAN-KEY.
001579     GO TO 03XX-ERPLAN-AH-READ.
001580
001581 03XX-ERPLAN-AH-GETMAIN.
001582
001583     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
001584     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
001585
001586 03XX-ERPLAN-AH-READ.
001587
001588     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
001589     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
001590     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
001591     MOVE PB-SV-STATE            TO PLAN-STATE.
001592     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
001593     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
001594     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
001595     MOVE WS-SAVE-BENEFIT-REVISION
001596                                 TO PLAN-REVISION-NO.
001597
001598     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
001599     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
001600
001601     IF PB-COMPANY-ID = 'NCL'
001602       IF NOT AH-PLAN-MASTER-FOUND
001603         IF NOT PB-POLICY-IS-DECLINED  AND
001604            NOT PB-POLICY-IS-VOIDED
001605             MOVE  ER-1922         TO  WS-ERROR
001606             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
001607             GO TO 0314-A-H-BENEFIT-FOUND.
001608
001609     IF NOT AH-PLAN-MASTER-FOUND
001610        GO TO 0314-A-H-BENEFIT-FOUND.
001611
001612 XXXX-CHECK-AH-PLAN-KEY.
001613
001614     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
001615        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
001616        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
001617        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
001618        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
001619        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
001620        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
001621        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
001622        MOVE 'N'                 TO PLAN-MASTER-SW
001623          GO TO 03XX-ERPLAN-AH-READ.
001624
001625     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
001626
001627     IF  PB-CANCELLATION
001628         GO TO  0313-AH-ACCT-BEN-FOUND.
001629
001630     IF PL-EDIT-FOR-FORM EQUAL 'Y'
001631       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
001632          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
001633          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
001634             MOVE ER-2644             TO WS-ERROR
001635             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001636          ELSE
001637             NEXT SENTENCE
001638       ELSE
001639          IF PB-COMPANY-ID NOT = 'NCL'
001640             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
001641                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
001642
001643 0313-AH-ACCT-BEN-FOUND.
001644
001645     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
001646
001647     IF PL-DEV-CODE NOT = SPACES
001648        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
001649
001650     IF PL-DEV-PCT NUMERIC AND
001651        PL-DEV-PCT NOT = ZEROS
001652        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
001653
001654     IF PL-TOL-PREM-AMT NOT EQUAL +0
001655        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
001656
001657     IF PL-TOL-REF-AMT NOT EQUAL +0
001658        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
001659
001660     IF PL-TOL-PREM-PCT GREATER THAN +0
001661        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
001662
001663     IF PL-TOL-REF-PCT GREATER THAN +0
001664        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
001665
001666     IF PL-TOL-CLM-AMT NOT EQUAL +0
001667        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
001668
001669     IF PL-OVER-SHORT-AMT NUMERIC AND
001670                          PL-OVER-SHORT-AMT > +0
001671        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
001672
001673     IF PL-OVER-SHORT-PCT NUMERIC AND
001674                          PL-OVER-SHORT-PCT > +0
001675        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
001676
001677     IF PL-IG NOT EQUAL SPACES AND ZEROS
001678        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
001679        IF WS-IG-OVRD-AM EQUAL SPACES
001680            MOVE PL-IG           TO WS-IG-OVRD-AM.
001681
001682 0314-A-H-BENEFIT-FOUND.
001683
001684     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
001685
001686     IF PB-ISSUE
001687        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
001688       ELSE
001689        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
001690
001691     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
001692
001693     if cf-maximum-benefits (sub3) numeric
001694        move cf-maximum-benefits (sub3)
001695                                 to ws-ah-max-bens
001696     else
001697        move zeros               to ws-ah-max-bens
001698     end-if
001699
001700     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
001701     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
001702     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
001703                                         WS-AH-REFUND-CALC.
001704
001705     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
001706        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
001707
001708     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
001709        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
001710
001711     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
001712
001713     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
001714     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
001715     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
001716     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
001717     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
001718     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
001719
001720     IF PB-COMPANY-ID = 'NCL'  AND
001721        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
001722         NEXT SENTENCE
001723     ELSE
001724         IF SUB5 NOT GREATER THAN +20
001725            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
001726                MOVE WS-SAVE-BENEFIT-REM-TERM
001727                                      TO WS-AM-AH-BENE-REM-TERM
001728                                         EC-BR-AH-REM-TERM-CALC.
001729
001730     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
001731     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
001732
001733     GO TO 0400-FIND-CARRIER.
001734
001735 0399-BENEFIT-NOT-FOUND.
001736
001737     MOVE '1'                    TO AH-BENEFIT-ERROR.
001738     MOVE ER-2605                TO WS-ERROR.
001739     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
001740
001741     EJECT
001742
001743 0400-FIND-CARRIER.
001744
001745     MOVE PB-SV-CARRIER          TO WS-CARR.
001746
001747     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
001748     MOVE ZEROS                  TO CNTL-SEQ-NO.
001749     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
001750     MOVE '6'                    TO CNTL-REC-TYPE.
001751
001752*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
001753     MOVE SPACE                  TO WS-DMD-RATING-SW
001754                                    EC-BR-DMD-RATING-SW.
001755
001756     MOVE '2'                    TO RC-SW-1.
001757     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
001758
001759     IF NOT CF-CARRIER-MASTER
001760        GO TO 0400-CARRIER-NOT-FOUND.
001761
001762 0400-BUILD-CARR-TOL.
001763
001764     IF CF-CR-TOL-PREM NUMERIC AND
001765        CF-CR-TOL-PREM GREATER THAN +0
001766        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
001767                                    WS-TOL-AH-PREM.
001768
001769     IF CF-CR-TOL-REFUND NUMERIC AND
001770        CF-CR-TOL-REFUND GREATER THAN +0
001771        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
001772                                    WS-TOL-AH-REFUND.
001773
001774     IF CF-CR-OVR-SHT-AMT NUMERIC AND
001775        CF-CR-OVR-SHT-AMT GREATER THAN +0
001776        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
001777                                    WS-AH-REFUND-OVS-AMT.
001778
001779     IF CF-CR-OVR-SHT-PCT NUMERIC AND
001780        CF-CR-OVR-SHT-PCT GREATER THAN +0
001781        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
001782                                    WS-AH-REFUND-OVS-PCT.
001783
001784     IF CF-CR-TOL-PREM-PCT NUMERIC AND
001785        CF-CR-TOL-PREM-PCT GREATER THAN +0
001786        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
001787                                    WS-TOL-AH-PREM-PCT.
001788
001789     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
001790        CF-CR-TOL-REFUND-PCT GREATER THAN +0
001791        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
001792                                     WS-TOL-AH-REFUND-PCT.
001793
001794     IF CF-COMPANY-ID EQUAL 'DMD'
001795         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
001796                                    EC-BR-DMD-RATING-SW.
001797
001798     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
001799     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
001800        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
001801     END-IF
001802     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
001803        MOVE +0                  TO CF-CARRIER-LEASE-COMM
001804     END-IF
001805     IF WS-TOL-CLP-PCT = ZEROS
001806        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
001807     END-IF
001808
001809     IF WS-SPP-LEASE-COMM = ZEROS
001810        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
001811     END-IF
001812
001813     GO TO 0400-FIND-ERPDEF.
001814
001815 0400-CARRIER-NOT-FOUND.
001816
001817     MOVE ER-2602                TO WS-ERROR.
001818     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
001819
001820 0400-FIND-ERPDEF.
001821
001822*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
001823     IF (PB-COMPANY-ID = 'DCC')
001824        AND (AM-DCC-PRODUCT-CODE <> spaces)
001825        CONTINUE
001826     ELSE
001827        GO TO 0400-FIND-ERCOMP
001828     END-IF
001829
001830     MOVE ' '                    TO PDEF-MASTER-SW
001831     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
001832     MOVE PB-STATE               TO ERPDEF-STATE
001833     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
001834        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
001835     END-IF
001836     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
001837     MOVE 'A'                    TO ERPDEF-BEN-TYPE
001838     IF PB-ISSUE
001839        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
001840     ELSE
001841        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
001842     END-IF
001843     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
001844     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
001845     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
001846     IF PDEF-MASTER-FOUND
001847        MOVE 'N'                 TO PDEF-MASTER-SW
001848        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
001849        IF PDEF-MASTER-FOUND
001850           IF (ERPDEF-KEY-SAVE (1:16) =
001851                        PD-CONTROL-PRIMARY (1:16))
001852              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
001853              CONTINUE
001854           ELSE
001855              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
001856              IF (ERPDEF-KEY-SAVE (1:16) =
001857                        PD-CONTROL-PRIMARY (1:16))
001858                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
001859                 CONTINUE
001860              ELSE
001861                 MOVE 'N'        TO PDEF-MASTER-SW
001862              END-IF
001863           END-IF
001864        END-IF
001865        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
001866     END-IF
001867     IF PDEF-MASTER-FOUND
001868        IF PD-TRUNCATED = 'Y'
001869           MOVE 'T'              TO WS-AH-DCC-TRUNC
001870        END-IF
001871     END-IF
001872
001873     .
001874 0400-FIND-ERCOMP.
001875
001876     IF PB-COMPANY-ID = 'DCC' or 'VPP'
001877        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
001878           (WS-SUB1 > +10)
001879           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
001880                 OR 'A' OR 'N'
001881              MOVE PB-COMPANY-CD TO COMP-COMP-CD
001882              MOVE PB-CARRIER    TO COMP-CARRIER
001883              MOVE PB-GROUPING   TO COMP-GROUPING
001884              MOVE LOW-VALUES    TO COMP-ACCOUNT
001885              MOVE AM-AGT (WS-SUB1)
001886                                 TO COMP-FIN-RESP
001887              MOVE 'G'           TO COMP-TYPE
001888              PERFORM 8582-READ-COMPENSATION-MASTER
001889                                 THRU 8582-EXIT
001890              IF COMP-MASTER-FOUND
001891                 IF CO-GA-INACTIVE
001892                    MOVE ER-2763 TO WS-ERROR
001893                    PERFORM 9900-ERROR-FORMAT
001894                                 THRU 9900-EXIT
001895                    MOVE +11     TO WS-SUB1
001896                 END-IF
001897                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
001898                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
001899                    MOVE ER-2788 TO WS-ERROR
001900                    PERFORM 9900-ERROR-FORMAT
001901                                 THRU 9900-EXIT
001902                    MOVE +11     TO WS-SUB1
001903                 END-IF
001904              END-IF
001905           END-IF
001906        END-PERFORM
001907     END-IF
001908
001909     IF PB-COMPANY-ID = 'DCC' or 'VPP'
001910        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
001911           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
001912                                    WS-CLP-STATE
001913        ELSE
001914           MOVE SPACES           TO PB-I-CLP-STATE
001915                                    WS-CLP-STATE
001916        END-IF
001917     END-IF
001918
001919     IF (PB-COMPANY-ID = 'DCC')
001920        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
001921        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
001922        CONTINUE
001923     ELSE
001924        GO TO 0400-FIND-STATE-RECORD
001925     END-IF
001926
001927     MOVE SPACES                 TO WS-CLP-STATE
001928     MOVE +0                     TO WS-BANK-FEE
001929                                    WS-BANK-LFEE
001930                                    WS-BANK-NOCHRGB
001931
001932     MOVE LOW-VALUES             TO COMP-FIN-RESP
001933
001934     IF (PB-ISSUE)
001935        AND (PB-I-BANK-NUMBER NOT =
001936            SPACES AND ZEROS AND LOW-VALUES)
001937        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
001938     ELSE
001939        IF (PB-CANCELLATION)
001940           AND (PB-CI-BANK-NUMBER NOT =
001941                SPACES AND ZEROS AND LOW-VALUES)
001942           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
001943        END-IF
001944     END-IF
001945
001946     IF COMP-FIN-RESP NOT = LOW-VALUES
001947        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
001948        MOVE PB-CARRIER          TO COMP-CARRIER
001949        MOVE PB-GROUPING         TO COMP-GROUPING
001950        MOVE LOW-VALUES          TO COMP-ACCOUNT
001951        MOVE 'B'                 TO COMP-TYPE
001952        PERFORM 8582-READ-COMPENSATION-MASTER
001953                                 THRU 8582-EXIT
001954        IF COMP-MASTER-FOUND
001955           IF CO-MAX-BANK-FEE NOT NUMERIC
001956              MOVE +0            TO CO-MAX-BANK-FEE
001957           END-IF
001958           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
001959              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
001960           END-IF
001961           IF CO-GA-INACTIVE
001962              MOVE ER-2763       TO WS-ERROR
001963              PERFORM 9900-ERROR-FORMAT
001964                                 THRU 9900-EXIT
001965           END-IF
001966           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
001967              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
001968              MOVE ER-2788 TO WS-ERROR
001969              PERFORM 9900-ERROR-FORMAT
001970                                 THRU 9900-EXIT
001971              MOVE +11     TO WS-SUB1
001972           END-IF
001973           IF WS-AH-BEN-CATEGORY = 'G'
001974              MOVE CO-MAX-BANK-FEE
001975                                 TO WS-BANK-FEE
001976                                    PB-I-BANK-FEE
001977           ELSE
001978              MOVE CO-MAX-BANK-FEE-LEASE
001979                                 TO WS-BANK-LFEE
001980                                    PB-I-BANK-FEE
001981           END-IF
001982           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
001983              AND (WS-AH-REFUND-CALC = 'G'))
001984                        OR
001985              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
001986              AND (WS-AH-REFUND-CALC NOT = 'G'))
001987              CONTINUE
001988           ELSE
001989              MOVE ER-2789 TO WS-ERROR
001990              PERFORM 9900-ERROR-FORMAT
001991                                 THRU 9900-EXIT
001992           END-IF
001993           MOVE CO-CLP-STATE     TO WS-CLP-STATE
001994                                    PB-I-CLP-STATE
001995           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
001996           MOVE CO-CARRIER       TO BXRF-CARRIER
001997           MOVE CO-GROUPING      TO BXRF-GROUPING
001998           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
001999           MOVE BXRF-MAX-REC-LENGTH
002000                                 TO BXRF-REC-LENGTH
002001           PERFORM 8584-READ-BANK-CROSS-REF
002002                                 THRU 8584-EXIT
002003           IF BXRF-MASTER-FOUND
002004              MOVE ' '           TO BANK-ACCT-SW
002005              MOVE BK-BANK-POINTER-CNT
002006                                 TO BK-BANK-POINTER-CNT
002007              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
002008                 (WS-SUB1 > BK-BANK-POINTER-CNT)
002009                 OR (BANK-ACCT-FOUND)
002010                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
002011                    AND (BK-AM-EXP-DT (WS-SUB1)
002012                                 > PB-CERT-EFF-DT)
002013                    AND (BK-AM-EFF-DT (WS-SUB1)
002014                                 NOT > PB-CERT-EFF-DT)
002015                    SET BANK-ACCT-FOUND TO TRUE
002016                 END-IF
002017              END-PERFORM
002018              IF NOT BANK-ACCT-FOUND
002019                 MOVE ZEROS      TO WS-BANK-FEE
002020                                    WS-BANK-LFEE
002021                 MOVE ER-2869    TO WS-ERROR
002022                 PERFORM 9900-ERROR-FORMAT
002023                                 THRU 9900-EXIT
002024              ELSE
002025                 PERFORM 5000-PROCESS-REPS
002026                                 THRU 5000-EXIT
002027                 IF AGENT-MASTER-FOUND
002028                    MOVE +0      TO WS-BANK-FEE
002029                                    WS-BANK-LFEE
002030*                   MOVE AG-SPP-FEES (1)
002031*                                TO PB-I-BANK-FEE
002032*                                   WS-BANK-FEE
002033                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
002034                       (WS-SUB1 > +10)
002035                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
002036                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
002037                       END-IF
002038                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
002039                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
002040                       END-IF
002041                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
002042                          AG-SPP-FEES (WS-SUB1)
002043                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
002044                          AG-SPP-LFEES (WS-SUB1)
002045                    END-PERFORM
002046                    IF WS-AH-BEN-CATEGORY = 'G'
002047                       MOVE WS-BANK-FEE
002048                                 TO PB-I-BANK-FEE
002049                    ELSE
002050                       MOVE WS-BANK-LFEE
002051                                 TO PB-I-BANK-FEE
002052                    END-IF
002053                 END-IF
002054              END-IF
002055           END-IF
002056        ELSE
002057           MOVE ER-2879          TO WS-ERROR
002058           PERFORM 9900-ERROR-FORMAT
002059                                 THRU 9900-EXIT
002060        END-IF
002061     ELSE
002062        MOVE ER-2879             TO WS-ERROR
002063        PERFORM 9900-ERROR-FORMAT
002064                                 THRU 9900-EXIT
002065     END-IF
002066
002067     IF WS-AH-BEN-CATEGORY = 'G'
002068        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
002069        + WS-BANK-FEE
002070     ELSE
002071        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
002072        + WS-BANK-LFEE
002073     END-IF
002074
002075     .
002076 0400-FIND-STATE-RECORD.
002077
002078     IF WK-STATE-ADDR NOT = ZEROS
002079         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
002080         SET ELCNTL-FILE-ADDRESSED TO TRUE
002081         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
002082         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
002083         IF PB-SV-STATE = CF-STATE-CODE
002084             GO TO 0405-CONTINUE-EDIT
002085         ELSE
002086             NEXT SENTENCE
002087     ELSE
002088         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
002089
002090     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
002091     MOVE PB-SV-STATE            TO CNTL-ACCESS.
002092     MOVE '3'                    TO CNTL-REC-TYPE.
002093     MOVE +0                     TO CNTL-SEQ-NO.
002094
002095     MOVE '3'                    TO RC-SW-2.
002096     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
002097
002098     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
002099        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
002100        PB-SV-STATE   NOT = CF-STATE-CODE)
002101        MOVE ZEROS               TO WS-TOL-LF-CLAIM
002102                                    WS-TOL-AH-CLAIM
002103                                    WS-MINIMUM-REFUND
002104                                    WS-TOL-LF-PREM
002105                                    WS-TOL-AH-PREM
002106                                    WS-TOL-LF-REFUND
002107                                    WS-TOL-AH-REFUND
002108                                    EC-ST-TOL-PREM-PCT
002109                                    WS-TOL-LF-PREM-PCT
002110                                    WS-TOL-AH-PREM-PCT
002111                                    EC-ST-TOL-REFUND-PCT
002112                                    WS-TOL-LF-REFUND-PCT
002113                                    WS-TOL-AH-REFUND-PCT
002114                                    EC-ST-TOL-PREM
002115                                    EC-ST-TOL-REFUND
002116                                    EC-ST-FST-PMT-DAYS-MAX
002117                                    WS-FREE-LOOK-PERIOD
002118                                    WS-ST-LF-PREM-TAX
002119                                    WS-ST-AH-PREM-TAX-I
002120                                    WS-ST-AH-PREM-TAX-G
002121                                    WS-BANK-FEE
002122                                    WS-BANK-LFEE
002123                                    WS-TOL-CLP-PCT
002124                                    WS-SPP-LEASE-COMM
002125                                    WS-INT-PERIODS
002126                                    WS-EXTRA-PMTS
002127        MOVE SPACES              TO WS-STATE-ABBREVIATION
002128                                    EC-ST-FST-PMT-DAYS-CHG
002129                                    WS-LF-REM-TERM-CALC
002130                                    WS-LF-REFUND-CALC
002131                                    EC-ST-LF-REM-TERM-CALC
002132                                    EC-ST-LF-REFUND-CALC
002133                                    WS-AH-REM-TERM-CALC
002134                                    WS-AH-REFUND-CALC
002135                                    WS-LF-BEN-CATEGORY
002136                                    WS-AH-BEN-CATEGORY
002137                                    WS-CLP-STATE
002138                                    WS-ST-REFUND-CLAIM-FLAG
002139                                    WS-ST-CAUSAL-STATE
002140                                    ws-st-agent-sig-edit
002141                                    EC-ST-AH-REM-TERM-CALC
002142                                    EC-ST-AH-REFUND-CALC
002143          GO TO 0499-STATE-NOT-FOUND.
002144
002145     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
002146
002147 0405-CONTINUE-EDIT.
002148
002149     IF (PB-COMPANY-ID <> 'AHL')
002150        and (pb-issue)
002151        MOVE +0                  TO SUB3
002152        INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
002153        IF SUB3 > +0
002154           MOVE ER-3270          TO WS-ERROR
002155           PERFORM 9900-ERROR-FORMAT
002156                                 THRU 9900-EXIT
002157        else
002158           IF PB-CERT-PRIME NOT NUMERIC
002159              MOVE ER-2722       TO WS-ERROR
002160              PERFORM 9900-ERROR-FORMAT
002161                                 THRU 9900-EXIT
002162           end-if
002163        END-IF
002164     END-IF
002165
002166     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
002167
002168     IF CF-ST-TOL-CLAIM NOT = ZEROS
002169        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
002170                                    WS-TOL-AH-CLAIM.
002171
002172     IF CF-ST-REFUND-MIN NOT NUMERIC
002173        MOVE ZEROS               TO CF-ST-REFUND-MIN.
002174
002175     IF CF-ST-REFUND-MIN NOT = ZEROS
002176        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
002177
002178     IF CF-ST-TOL-PREM  NOT = ZEROS
002179        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
002180                                    WS-TOL-AH-PREM
002181        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
002182
002183     IF CF-ST-TOL-REFUND NOT = ZEROS
002184        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
002185                                    WS-TOL-AH-REFUND
002186        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
002187
002188     IF CF-ST-OVR-SHT-AMT NUMERIC AND
002189        CF-ST-OVR-SHT-AMT GREATER THAN +0
002190        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
002191                                    WS-AH-REFUND-OVS-AMT
002192                                    EC-ST-OVR-SHT-AMT.
002193
002194     IF CF-ST-TOL-PREM-PCT NUMERIC AND
002195        CF-ST-TOL-PREM-PCT GREATER THAN +0
002196        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
002197                                    WS-TOL-LF-PREM-PCT
002198                                    WS-TOL-AH-PREM-PCT.
002199
002200     IF CF-ST-TOL-REF-PCT NUMERIC AND
002201        CF-ST-TOL-REF-PCT GREATER THAN +0
002202        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
002203                                    WS-TOL-LF-REFUND-PCT
002204                                    WS-TOL-AH-REFUND-PCT.
002205
002206     IF CF-ST-OVR-SHT-PCT NUMERIC AND
002207        CF-ST-OVR-SHT-PCT GREATER THAN +0
002208        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
002209                                    WS-AH-REFUND-OVS-PCT
002210                                    EC-ST-OVR-SHT-PCT.
002211
002212     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
002213     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
002214
002215     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
002216          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
002217
002218     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
002219     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
002220
002221     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
002222
002223     IF CF-ST-LF-PREM-TAX NUMERIC
002224        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
002225     END-IF
002226     IF CF-ST-AH-PREM-TAX-I NUMERIC
002227        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
002228     END-IF
002229     IF CF-ST-AH-PREM-TAX-G NUMERIC
002230        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
002231     END-IF
002232
002233     IF CF-ST-REF-AH-DEATH-IND > SPACES
002234         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
002235     END-IF.
002236
002237     IF CF-ST-CAUSAL-STATE > SPACES
002238         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
002239     END-IF.
002240
002241     if cf-st-extra-interest-periods not numeric
002242        move zeros               to cf-st-extra-interest-periods
002243     end-if
002244     if cf-st-extra-payments not numeric
002245        move zeros               to cf-st-extra-payments
002246     end-if
002247
002248     move cf-st-extra-interest-periods
002249                                 to ws-int-periods
002250     move cf-st-extra-payments   to ws-extra-pmts
002251
002252     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
002253     move cf-st-net-only-state   to ws-net-only-state
002254
002255     if cf-st-comm-cap-sl not numeric
002256        move zeros               to cf-st-comm-cap-sl
002257     end-if
002258     if cf-st-comm-cap-jl not numeric
002259        move zeros               to cf-st-comm-cap-jl
002260     end-if
002261     if cf-st-comm-cap-sa not numeric
002262        move zeros               to cf-st-comm-cap-sa
002263     end-if
002264     if cf-st-comm-cap-ja not numeric
002265        move zeros               to cf-st-comm-cap-ja
002266     end-if
002267
002268     if cf-st-ga-comm-cap-sl not numeric
002269        move zeros               to cf-st-ga-comm-cap-sl
002270     end-if
002271     if cf-st-ga-comm-cap-jl not numeric
002272        move zeros               to cf-st-ga-comm-cap-jl
002273     end-if
002274     if cf-st-ga-comm-cap-sa not numeric
002275        move zeros               to cf-st-ga-comm-cap-sa
002276     end-if
002277     if cf-st-ga-comm-cap-ja not numeric
002278        move zeros               to cf-st-ga-comm-cap-ja
002279     end-if
002280
002281     if cf-st-tot-comm-cap-sl not numeric
002282        move zeros               to cf-st-tot-comm-cap-sl
002283     end-if
002284     if cf-st-tot-comm-cap-jl not numeric
002285        move zeros               to cf-st-tot-comm-cap-jl
002286     end-if
002287     if cf-st-tot-comm-cap-sa not numeric
002288        move zeros               to cf-st-tot-comm-cap-sa
002289     end-if
002290     if cf-st-tot-comm-cap-ja not numeric
002291        move zeros               to cf-st-tot-comm-cap-ja
002292     end-if
002293
002294     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
002295
002296     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
002297     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
002298     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
002299     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
002300
002301     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
002302     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
002303     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
002304     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
002305
002306     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
002307     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
002308     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
002309     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
002310
002311     IF WS-LF-BENEFIT-CD = ZEROS
002312        GO TO 0410-CHECK-AH.
002313
002314     IF CF-ST-RT-CALC NOT = SPACES
002315        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
002316                                    EC-ST-LF-REM-TERM-CALC
002317     END-IF
002318
002319     IF WS-LF-COVERAGE-TYPE = 'R'
002320        IF WS-LF-EARNINGS-CALC = '5'
002321           IF CF-ST-RF-LN-CALC > '0'
002322              MOVE CF-ST-RF-LN-CALC
002323                                 TO WS-LF-REFUND-CALC
002324                                    EC-ST-LF-REFUND-CALC
002325           END-IF
002326        ELSE
002327           IF CF-ST-RF-LR-CALC > '0'
002328              MOVE CF-ST-RF-LR-CALC
002329                                 TO WS-LF-REFUND-CALC
002330                                    EC-ST-LF-REFUND-CALC
002331           END-IF
002332        END-IF
002333     ELSE
002334        IF CF-ST-RF-LL-CALC > '0'
002335           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
002336                                    EC-ST-LF-REFUND-CALC
002337        END-IF
002338     END-IF
002339
002340     IF CF-ST-RT-CALC NOT = SPACES
002341        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
002342                                    EC-ST-LF-REM-TERM-CALC
002343     END-IF
002344
002345     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
002346     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
002347
002348     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
002349
002350     IF NO-BENEFIT-FOUND
002351        GO TO 0410-CHECK-AH.
002352
002353     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
002354        MOVE CF-ST-REM-TERM-CALC  (SUB3)
002355                                 TO EC-ST-LF-REM-TERM-CALC
002356                                    WS-LF-REM-TERM-CALC
002357     END-IF
002358
002359     IF CF-ST-REFUND-CALC (SUB3) > '0'
002360        MOVE CF-ST-REFUND-CALC (SUB3)
002361                                 TO WS-LF-REFUND-CALC
002362                                    EC-ST-LF-REFUND-CALC
002363     END-IF
002364*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
002365     if cf-st-extra-periods (sub3) not numeric
002366        move zeros               to cf-st-extra-periods (sub3)
002367     end-if
002368     if cf-st-extra-periods (sub3) > zeros
002369        if ws-lf-ben-category = 'P'
002370           move cf-st-extra-periods (sub3)
002371                                 to ws-extra-pmts
002372        else
002373           if ws-lf-ben-category = 'I'
002374              move cf-st-extra-periods (sub3)
002375                                 to ws-int-periods
002376           end-if
002377        end-if
002378     end-if
002379
002380     .
002381 0410-CHECK-AH.
002382
002383     IF WS-AH-BENEFIT-CD = ZEROS
002384        GO TO 0500-SET-ACCOUNT.
002385
002386     IF CF-ST-RT-CALC NOT = SPACES
002387        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
002388                                    EC-ST-AH-REM-TERM-CALC
002389     END-IF
002390
002391     IF WS-AH-SPECIAL-CALC-CD = 'C'
002392        IF CF-ST-RF-CP-CALC > '0'
002393           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
002394                                    EC-ST-AH-REFUND-CALC
002395        END-IF
002396     ELSE
002397        IF CF-ST-RF-AH-CALC > '0'
002398           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
002399                                    EC-ST-AH-REFUND-CALC
002400        END-IF
002401     END-IF
002402     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
002403     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
002404
002405     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
002406
002407     IF NO-BENEFIT-FOUND
002408        GO TO 0500-SET-ACCOUNT.
002409
002410     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
002411        MOVE CF-ST-REM-TERM-CALC (SUB3)
002412                                 TO WS-AH-REM-TERM-CALC
002413                                    EC-ST-AH-REM-TERM-CALC
002414     END-IF
002415
002416     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
002417        MOVE CF-ST-REFUND-CALC (SUB3)
002418                                 TO WS-AH-REFUND-CALC
002419                                    EC-ST-AH-REFUND-CALC
002420     END-IF
002421
002422*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
002423
002424     GO TO 0500-SET-ACCOUNT.
002425
002426 0499-STATE-NOT-FOUND.
002427
002428     MOVE ER-2603                TO WS-ERROR.
002429     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002430
002431     EJECT
002432
002433 0500-SET-ACCOUNT.
002434
002435*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
002436
002437     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
002438        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
002439        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
002440        MOVE WS-CLP-STATE        TO CNTL-ACCESS
002441        MOVE '3'                 TO CNTL-REC-TYPE
002442        MOVE +0                  TO CNTL-SEQ-NO
002443
002444        MOVE '3'                 TO RC-SW-2
002445        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
002446
002447        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
002448           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
002449           WS-CLP-STATE  NOT = CF-STATE-CODE)
002450           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
002451                                    WS-ST-AH-PREM-TAX-I
002452                                    WS-ST-AH-PREM-TAX-G
002453        ELSE
002454           IF CF-ST-LF-PREM-TAX NUMERIC
002455              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
002456           END-IF
002457           IF CF-ST-AH-PREM-TAX-I NUMERIC
002458              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
002459           END-IF
002460           IF CF-ST-AH-PREM-TAX-G NUMERIC
002461              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
002462           END-IF
002463        END-IF
002464        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
002465     END-IF
002466
002467*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
002468*  FOR DCC ONLY
002469
002470     IF PB-COMPANY-ID = 'DCC' or 'VPP'
002471
002472        MOVE ' '                 TO STAT-MASTER-SW
002473        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
002474        MOVE PB-CARRIER          TO ELSTAT-CARRIER
002475        MOVE PB-GROUPING         TO ELSTAT-GROUP
002476        MOVE PB-STATE            TO ELSTAT-STATE
002477        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
002478           MOVE WS-CLP-STATE     TO ELSTAT-STATE
002479        END-IF
002480
002481        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
002482        SET BIN-TO-GREG          TO TRUE
002483        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
002484        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
002485        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
002486
002487        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
002488        IF STAT-MASTER-FOUND
002489           MOVE 'N'              TO STAT-MASTER-SW
002490           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
002491           IF STAT-MASTER-FOUND
002492              IF (ELSTAT-KEY-SAVE (1:12) =
002493                           SF-CONTROL-PRIMARY (1:12))
002494                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
002495                    MOVE 'F'        TO STAT-MASTER-SW
002496                 ELSE
002497                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
002498                    IF (STAT-MASTER-FOUND)
002499                       AND (ELSTAT-KEY-SAVE (1:12) =
002500                           SF-CONTROL-PRIMARY (1:12))
002501                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
002502                       MOVE 'F'     TO STAT-MASTER-SW
002503                    END-IF
002504                 END-IF
002505              END-IF
002506           END-IF
002507        END-IF
002508
002509        IF STAT-MASTER-SW = 'F'
002510           IF (SF-ST-LF-PREM-TAX NUMERIC)
002511              and (sf-st-lf-prem-tax > zeros)
002512              MOVE SF-ST-LF-PREM-TAX
002513                                 TO WS-ST-LF-PREM-TAX
002514           END-IF
002515           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
002516              and (sf-st-ah-prem-tax-i > zeros)
002517              MOVE SF-ST-AH-PREM-TAX-I
002518                                 TO WS-ST-AH-PREM-TAX-I
002519           END-IF
002520           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
002521              and (sf-st-ah-prem-tax-g > zeros)
002522              MOVE SF-ST-AH-PREM-TAX-G
002523                                 TO WS-ST-AH-PREM-TAX-G
002524           END-IF
002525        END-IF
002526     END-IF
002527
002528     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
002529        AND (PB-ISSUE)
002530        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
002531        AND (AM-DCC-PRODUCT-CODE = 'DDF')
002532        AND (AM-GPCD = 06)
002533        MOVE 'Y'                 TO WS-GOOD-HIN
002534        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
002535           MOVE PB-I-VIN         TO WS-WORK-VIN
002536           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
002537              (V1 > 16)
002538              IF WS-WORK-VIN (V1:1) NUMERIC
002539                 MOVE WS-WORK-VIN-N (V1)
002540                                 TO WS-ROW-B-VAL (V1)
002541              ELSE
002542                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
002543                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
002544                    OR (V2 > 26)
002545                 END-PERFORM
002546                 IF V2 < 27
002547                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
002548                 ELSE
002549                    MOVE 'N'     TO WS-GOOD-HIN
002550                 END-IF
002551              END-IF
002552              COMPUTE WS-ROW-D-VAL (V1) =
002553                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
002554              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
002555                 WS-ROW-D-VAL (V1)
002556           END-PERFORM
002557           MOVE ZEROS            TO WS-VIN-REMAINDER
002558           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
002559             REMAINDER WS-VIN-REMAINDER
002560           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
002561              CONTINUE
002562           ELSE
002563              MOVE 'N'           TO WS-GOOD-HIN
002564           END-IF
002565        ELSE
002566           MOVE 'N'              TO WS-GOOD-HIN
002567        END-IF
002568        IF WS-GOOD-HIN NOT = 'Y'
002569           MOVE ER-3826           TO WS-ERROR
002570           PERFORM 9900-ERROR-FORMAT
002571                                 THRU 9900-EXIT
002572        END-IF
002573     END-IF
002574
002575     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
002576        AND (PB-ISSUE)
002577        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
002578        AND (AM-GPCD NOT = 06)
002579        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
002580           perform 3400-edit-vin thru 3400-exit
002581        ELSE
002582          MOVE ER-3826           TO WS-ERROR
002583          PERFORM 9900-ERROR-FORMAT
002584                                 THRU 9900-EXIT
002585        END-IF
002586     END-IF
002587
002588     if (pb-company-id = 'CID')
002589        and (pb-issue)
002590        and (pb-i-vin not = spaces and low-values and zeros)
002591        perform 3400-edit-vin    thru 3400-exit
002592     end-if
002593
002594******************************************************************
002595******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
002596******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
002597******* METHODS.
002598******************************************************************
002599     IF PB-COMPANY-ID EQUAL TO 'NCL'
002600        IF PB-CANCELLATION
002601           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
002602              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
002603                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
002604                IF FORM-MASTER-FOUND
002605                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
002606******************************************************************
002607
002608     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
002609     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
002610
002611     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
002612     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
002613     MOVE AM-STATUS              TO WS-ACCT-STATUS.
002614     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
002615
002616
002617     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
002618     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
002619     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
002620
002621     IF AM-LF-OB-RATE NOT NUMERIC
002622         MOVE ZERO               TO AM-LF-OB-RATE.
002623
002624     IF AM-LF-OB-RATE-JNT NOT NUMERIC
002625         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
002626
002627     IF AM-AH-OB-RATE NOT NUMERIC
002628         MOVE ZERO               TO AM-AH-OB-RATE.
002629
002630     IF WS-LF-JOINT-INDICATOR = 'J'
002631         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
002632     ELSE
002633         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
002634
002635     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
002636
002637     IF WS-IG-OVRD-AM  EQUAL SPACE
002638         MOVE AM-IG              TO WS-IG-OVRD-AM.
002639
002640     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
002641         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
002642                                       WS-IG-OVRD
002643     ELSE
002644         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
002645             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
002646                                       WS-IG-OVRD
002647         ELSE
002648             MOVE AM-IG             TO WS-IG-OVRD-AH
002649                                       WS-IG-OVRD.
002650
002651     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
002652         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
002653                                       WS-IG-OVRD
002654     ELSE
002655         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
002656             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
002657                                       WS-IG-OVRD
002658         ELSE
002659             MOVE AM-IG             TO WS-IG-OVRD-LF
002660                                       WS-IG-OVRD.
002661
002662     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
002663     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
002664     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
002665     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
002666*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
002667     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
002668                                              TO 'PRLDSFCTIA'.
002669
002670     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
002671     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
002672     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
002673     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
002674
002675     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
002676     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
002677     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
002678     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
002679     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
002680     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
002681     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
002682
002683     IF WS-ACCT-AH-DEV-PCT > +0
002684        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
002685     ELSE
002686        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
002687
002688     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
002689        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
002690     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
002691        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
002692
002693        IF AM-EARN-METHOD-L = 'S'
002694            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
002695                                        WS-LF-REFUND-CALC.
002696
002697        IF AM-EARN-METHOD-R = 'S'
002698            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
002699                                        WS-LF-REFUND-CALC.
002700
002701     IF WS-LF-COVERAGE-TYPE = 'R'
002702         IF AM-EARN-METHOD-R = 'R'
002703            MOVE '1'             TO EC-AM-LF-REFUND-CALC
002704                                    WS-LF-REFUND-CALC.
002705     IF WS-LF-COVERAGE-TYPE = 'R'
002706         IF AM-EARN-METHOD-R = 'P'
002707            MOVE '2'             TO EC-AM-LF-REFUND-CALC
002708                                    WS-LF-REFUND-CALC.
002709     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
002710         IF AM-EARN-METHOD-L = 'R'
002711            MOVE '1'             TO EC-AM-LF-REFUND-CALC
002712                                    WS-LF-REFUND-CALC.
002713     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
002714         IF AM-EARN-METHOD-L = 'P'
002715            MOVE '2'             TO EC-AM-LF-REFUND-CALC
002716                                    WS-LF-REFUND-CALC.
002717     IF WS-LF-COVERAGE-TYPE = 'R'
002718         IF AM-EARN-METHOD-R = 'A'
002719            MOVE '6'             TO EC-AM-LF-REFUND-CALC
002720                                    WS-LF-REFUND-CALC.
002721     IF WS-LF-COVERAGE-TYPE = 'R'
002722         IF AM-EARN-METHOD-R = 'M'
002723            MOVE '8'             TO EC-AM-LF-REFUND-CALC
002724                                    WS-LF-REFUND-CALC.
002725     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
002726         IF AM-EARN-METHOD-L = 'A'
002727            MOVE '6'             TO EC-AM-LF-REFUND-CALC
002728                                    WS-LF-REFUND-CALC.
002729     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
002730         IF AM-EARN-METHOD-L = 'M'
002731            MOVE '8'             TO EC-AM-LF-REFUND-CALC
002732                                    WS-LF-REFUND-CALC.
002733
002734     IF AM-EARN-METHOD-A = 'R'
002735        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
002736                                    WS-AH-REFUND-CALC.
002737     IF AM-EARN-METHOD-A = 'P'
002738        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
002739                                    WS-AH-REFUND-CALC.
002740     IF AM-EARN-METHOD-A = 'C'
002741        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
002742                                    WS-AH-REFUND-CALC.
002743     IF AM-EARN-METHOD-A = 'A'
002744        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
002745                                    WS-AH-REFUND-CALC.
002746     IF AM-EARN-METHOD-A = 'M'
002747        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
002748                                    WS-AH-REFUND-CALC.
002749     IF AM-EARN-METHOD-A = 'N'
002750        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
002751                                    WS-AH-REFUND-CALC.
002752     IF AM-EARN-METHOD-A = 'S'
002753        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
002754                                    WS-AH-REFUND-CALC.
002755
002756     IF AM-TOL-PREM NOT = ZEROS
002757        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
002758                                    WS-TOL-AH-PREM.
002759
002760     IF AM-OVR-SHT-AMT NUMERIC AND
002761                  AM-OVR-SHT-AMT > 0
002762        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
002763                                    EC-AM-LF-OVR-SHT-AMT
002764                                    WS-AH-REFUND-OVS-AMT
002765                                    EC-AM-AH-OVR-SHT-AMT.
002766
002767     IF AM-OVR-SHT-PCT NUMERIC AND
002768                    AM-OVR-SHT-PCT > 0
002769        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
002770                                    EC-AM-LF-OVR-SHT-PCT
002771                                    WS-AH-REFUND-OVS-PCT
002772                                    EC-AM-AH-OVR-SHT-PCT.
002773
002774     IF AM-TOL-REF-PCT NUMERIC AND
002775                  AM-TOL-REF-PCT > 0
002776        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
002777                                    WS-TOL-AH-REFUND-PCT.
002778
002779     IF AM-TOL-REF  NOT = ZEROS  AND
002780                  AM-TOL-REF NUMERIC
002781        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
002782                                    EC-AM-LF-TOL-REFUND
002783                                    WS-TOL-AH-REFUND
002784                                    EC-AM-AH-TOL-REFUND.
002785
002786     IF AM-TOL-CLM  NOT = ZEROS
002787        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
002788                                    WS-TOL-AH-CLAIM.
002789
002790     IF AM-CLP-TOL-PCT NOT NUMERIC
002791        MOVE +0                  TO AM-CLP-TOL-PCT
002792     END-IF
002793
002794     IF AM-SPP-LEASE-COMM NOT NUMERIC
002795        MOVE +0                  TO AM-SPP-LEASE-COMM
002796     END-IF
002797
002798     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
002799        MOVE WS-PL-TOL-LF-PREM-PCT
002800                                 TO WS-TOL-LF-PREM-PCT.
002801
002802     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
002803        MOVE WS-PL-TOL-AH-PREM-PCT
002804                                 TO WS-TOL-AH-PREM-PCT.
002805
002806     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
002807        MOVE WS-PL-TOL-LF-REFUND-PCT
002808                                 TO WS-TOL-LF-REFUND-PCT.
002809
002810     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
002811        MOVE WS-PL-TOL-AH-REFUND-PCT
002812                                 TO WS-TOL-AH-REFUND-PCT.
002813
002814     IF WS-PL-REF-OVS-AMT > +0
002815        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
002816
002817     IF WS-PL-REF-OVS-PCT > +0
002818        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
002819
002820     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
002821        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
002822     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
002823        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
002824     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
002825        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
002826     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
002827        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
002828     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
002829        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
002830     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
002831        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
002832
002833     IF WS-AH-PL-REF-OVS-AMT > +0
002834        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
002835
002836     IF WS-AH-PL-REF-OVS-PCT > +0
002837        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
002838
002839     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
002840     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
002841
002842     IF PB-CANCELLATION
002843        GO TO 3000-CONTINUE-EDIT.
002844
002845     MOVE +1 TO SUB1.
002846     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
002847     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
002848
002849     IF CF-COMPANY-ID = 'DMD'
002850       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
002851         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
002852        ELSE
002853         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
002854
002855  0525-FIND-ACCT-COMM.
002856     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
002857        NEXT SENTENCE
002858      ELSE
002859         ADD +1 TO SUB1
002860         IF SUB1 LESS +11
002861            GO TO 0525-FIND-ACCT-COMM
002862          ELSE
002863             GO TO 0550-st-comm-cap-check.
002864
002865     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
002866     MOVE ZERO                   TO PB-I-AH-COMMISSION
002867                                    PB-I-LIFE-COMMISSION.
002868***  IF PB-COMPANY-ID = 'CRI'
002869     IF PB-PREM-ACCTNG-ONLY
002870         GO TO 0550-st-comm-cap-check.
002871
002872     MOVE '0530' TO CTBL-SW.
002873     MOVE ' '    TO WS-CTBL-READ-SW.
002874
002875
002876 0530-GET-AH-COMP.
002877     IF NO-AH-COVERAGE  OR
002878        NO-AH-BENEFIT-MATCH
002879           GO TO 0540-NEXT-READ-STEP.
002880
002881     IF AM-A-COM (SUB1) NUMERIC
002882        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
002883         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
002884         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
002885         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
002886         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
002887     ELSE
002888          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
002889          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
002890          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
002891          MOVE ZEROS             TO WS-SUB1
002892                                    WS-COMMISSION
002893          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
002894          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
002895          IF WS-COMMISSION > ZEROS
002896             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
002897             GO TO 0540-NEXT-READ-STEP
002898          END-IF
002899          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
002900          IF CTBL-TABLE-FOUND
002901             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
002902                                        PB-I-AH-TERM
002903             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
002904             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
002905             GO TO 0540-NEXT-READ-STEP
002906          ELSE
002907             IF FIRST-TIME-THROUGH
002908                 GO TO 0530-GET-AH-COMP
002909             ELSE
002910                 MOVE ER-2609                TO WS-ERROR
002911                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002912
002913 0540-NEXT-READ-STEP.
002914     MOVE '0540' TO CTBL-SW.
002915     MOVE ' '    TO WS-CTBL-READ-SW.
002916
002917 0540-GET-LF-COMP.
002918     IF NO-LIFE-COVERAGE  OR
002919        NO-LF-BENEFIT-MATCH
002920           GO TO 0550-st-comm-cap-check.
002921
002922     IF WS-LF-JOINT-INDICATOR = 'J'
002923        IF AM-J-COM (SUB1) NUMERIC
002924           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
002925           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
002926           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
002927           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
002928           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
002929        ELSE
002930           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
002931           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
002932           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
002933           MOVE ZEROS                TO WS-SUB1
002934                                        WS-COMMISSION
002935           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
002936           IF WS-COMMISSION > ZEROS
002937              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
002938              GO TO 0550-st-comm-cap-check
002939           END-IF
002940           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
002941           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
002942           IF CTBL-TABLE-FOUND
002943              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
002944              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
002945              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
002946              GO TO 0550-st-comm-cap-check
002947           ELSE
002948              IF FIRST-TIME-THROUGH
002949                  GO TO 0540-GET-LF-COMP
002950              ELSE
002951                  MOVE ER-2609                TO WS-ERROR
002952                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002953                  GO TO 0550-st-comm-cap-check.
002954
002955     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
002956        IF AM-L-COM (SUB1) NUMERIC
002957           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
002958           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
002959           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
002960           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
002961           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
002962        ELSE
002963           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
002964           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
002965           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
002966           MOVE ZEROS                TO WS-SUB1
002967                                        WS-COMMISSION
002968           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
002969           IF WS-COMMISSION IS GREATER THAN ZEROS
002970              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
002971              GO TO 0550-st-comm-cap-check
002972           END-IF
002973           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
002974           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
002975           IF CTBL-TABLE-FOUND
002976              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
002977              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
002978              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
002979              GO TO 0550-st-comm-cap-check
002980           ELSE
002981              IF FIRST-TIME-THROUGH
002982                  GO TO 0540-GET-LF-COMP
002983              ELSE
002984                  MOVE ER-2609                TO WS-ERROR
002985                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002986
002987 0550-st-comm-cap-check.
002988
002989     move +0                     to ws-tot-sl-wk-rate
002990                                    ws-sl-wk-rate
002991                                    ws-ga-sl-wk-rate
002992                                    ws-tot-jl-wk-rate
002993                                    ws-jl-wk-rate
002994                                    ws-ga-jl-wk-rate
002995                                    ws-tot-sa-wk-rate
002996                                    ws-sa-wk-rate
002997                                    ws-ga-sa-wk-rate
002998                                    ws-tot-ja-wk-rate
002999                                    ws-ja-wk-rate
003000                                    ws-ga-ja-wk-rate
003001
003002     perform varying sub5 from +1 by +1 until
003003        (sub5 > +10)
003004        move +0                  to ws-wk-rate
003005        if (am-gl-codes (sub5) <> 'Y')
003006           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
003007           if pb-i-lf-benefit-cd <> '  ' and '00'
003008              move zeros         to ws-wk-rate
003009              if (am-l-com (sub5) numeric)
003010                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
003011                 move am-l-com(sub5)
003012                                 to ws-wk-rate
003013              else
003014                 move pb-company-cd to ctbl-company-cd
003015                 move pb-i-lf-benefit-cd
003016                                 to ctbl-ben-code
003017                 move pb-i-lf-term  to ws-work-term
003018                 move pb-life-override-l1
003019                                 to ctbl-ben-type
003020                 move zeros      to ws-sub1
003021                                    ws-commission
003022                 move am-l-coma (sub5)
003023                                 to ctbl-table
003024                 move '0540'     to ctbl-sw
003025                 perform 0552-get-it
003026                                 thru 0552-exit
003027              end-if
003028              compute ws-tot-sl-wk-rate =
003029                 ws-tot-sl-wk-rate + ws-wk-rate
003030              if am-com-typ(sub5) = 'C' or 'D'
003031                 compute ws-sl-wk-rate =
003032                    ws-sl-wk-rate + ws-wk-rate
003033              else
003034                 if am-com-typ(sub5) = 'O' or 'P'
003035                    compute ws-ga-sl-wk-rate =
003036                       ws-ga-sl-wk-rate + ws-wk-rate
003037                 end-if
003038              end-if
003039
003040              move zeros         to ws-wk-rate
003041              if (am-j-com (sub5) numeric)
003042                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
003043                 move am-j-com(sub5)
003044                                 to ws-wk-rate
003045              else
003046                 move pb-company-cd to ctbl-company-cd
003047                 move pb-i-lf-benefit-cd
003048                                 to ctbl-ben-code
003049                 move pb-i-lf-term  to ws-work-term
003050                 move pb-life-override-l1
003051                                 to ctbl-ben-type
003052                 move zeros      to ws-sub1
003053                                    ws-commission
003054                 move am-j-coma (sub5)
003055                                 to ctbl-table
003056                 move '0540'     to ctbl-sw
003057                 perform 0552-get-it
003058                                 thru 0552-exit
003059              end-if
003060              compute ws-tot-jl-wk-rate =
003061                 ws-tot-jl-wk-rate + ws-wk-rate
003062              if am-com-typ(sub5) = 'C' or 'D'
003063                 compute ws-jl-wk-rate =
003064                    ws-jl-wk-rate + ws-wk-rate
003065              else
003066                 if am-com-typ(sub5) = 'O' or 'P'
003067                    compute ws-ga-jl-wk-rate =
003068                       ws-ga-jl-wk-rate + ws-wk-rate
003069                 end-if
003070              end-if
003071           end-if
003072           move zeros            to ws-wk-rate
003073
003074           if pb-i-ah-benefit-cd <> '  ' and '00'
003075              if (am-a-com (sub5) numeric)
003076                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
003077                 move am-a-com(sub5)
003078                                 to ws-wk-rate
003079              else
003080                 move pb-company-cd to ctbl-company-cd
003081                 move pb-i-ah-benefit-cd
003082                                 to ctbl-ben-code
003083                 move pb-i-ah-term  to ws-work-term
003084                 move pb-ah-override-l1
003085                                 to ctbl-ben-type
003086                 move zeros      to ws-sub1
003087                                    ws-commission
003088                 move am-a-coma (sub5)
003089                                 to ctbl-table
003090                 move '0530'     to ctbl-sw
003091                 perform 0552-get-it
003092                                 thru 0552-exit
003093              end-if
003094              compute ws-tot-sa-wk-rate =
003095                 ws-tot-sa-wk-rate + ws-wk-rate
003096              if am-com-typ(sub5) = 'C' or 'D'
003097                 compute ws-sa-wk-rate =
003098                    ws-sa-wk-rate + ws-wk-rate
003099              else
003100                 if am-com-typ(sub5) = 'O' or 'P'
003101                    compute ws-ga-sa-wk-rate =
003102                       ws-ga-sa-wk-rate + ws-wk-rate
003103                 end-if
003104              end-if
003105           end-if
003106        end-if
003107     end-perform
003108
003109     go to 0550-continue
003110
003111     .
003112 0552-get-it.
003113
003114     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
003115     MOVE ZEROS                  TO WS-SUB1
003116                                    WS-COMMISSION
003117     MOVE ' '                    TO WS-CTBL-READ-SW
003118     PERFORM 8300-READ-CTBL-TABLE
003119                                 THRU 8300-EXIT
003120     IF FIRST-TIME-THROUGH
003121        MOVE 'AA'                TO CTBL-BEN-CODE
003122        PERFORM 8300-READ-CTBL-TABLE
003123                                 THRU 8300-EXIT
003124     END-IF
003125     IF CTBL-TABLE-FOUND
003126        if pb-life-override-l1 = ctbl-ben-type
003127           move pb-i-lf-benefit-amt
003128                                 to WS-COMM-CK-AMT
003129        else
003130           compute ws-comm-ck-amt =
003131              pb-I-ah-benefit-amt * pb-i-ah-term
003132        end-if
003133        PERFORM 8800-GET-COMP-RATE
003134                                 THRU 8800-EXIT
003135     else
003136        move zeros               to ws-wk-rate
003137     END-IF
003138
003139     .
003140 0552-exit.
003141     exit.
003142
003143 0550-continue.
003144
003145     if ws-lf-joint-indicator = 'J'
003146        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
003147           and (ws-st-comm-cap-jl <> zeros)
003148           MOVE ER-1956          TO WS-ERROR
003149           PERFORM 9900-ERROR-FORMAT
003150                                 THRU 9900-EXIT
003151        end-if
003152        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
003153           and (ws-st-ga-comm-cap-jl <> zeros)
003154           MOVE ER-1959          TO WS-ERROR
003155           PERFORM 9900-ERROR-FORMAT
003156                                 THRU 9900-EXIT
003157        end-if
003158        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
003159           and (ws-st-tot-comm-cap-jl <> zeros)
003160           MOVE ER-1962          TO WS-ERROR
003161           PERFORM 9900-ERROR-FORMAT
003162                                 THRU 9900-EXIT
003163        end-if
003164     else
003165        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
003166           and (ws-st-comm-cap-sl <> zeros)
003167           MOVE ER-1955          TO WS-ERROR
003168           PERFORM 9900-ERROR-FORMAT
003169                                 THRU 9900-EXIT
003170        end-if
003171        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
003172           and (ws-st-ga-comm-cap-sl <> zeros)
003173           MOVE ER-1958          TO WS-ERROR
003174           PERFORM 9900-ERROR-FORMAT
003175                                 THRU 9900-EXIT
003176        end-if
003177        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
003178           and (ws-st-tot-comm-cap-sl <> zeros)
003179           MOVE ER-1961          TO WS-ERROR
003180           PERFORM 9900-ERROR-FORMAT
003181                                 THRU 9900-EXIT
003182        end-if
003183
003184     if ws-ah-joint-indicator = 'J'
003185        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
003186           and (ws-st-comm-cap-ja <> zeros)
003187           MOVE ER-1957          TO WS-ERROR
003188           PERFORM 9900-ERROR-FORMAT
003189                                 THRU 9900-EXIT
003190        end-if
003191        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
003192           and (ws-st-ga-comm-cap-ja <> zeros)
003193           MOVE ER-1960          TO WS-ERROR
003194           PERFORM 9900-ERROR-FORMAT
003195                                 THRU 9900-EXIT
003196        end-if
003197        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
003198           and (ws-st-tot-comm-cap-ja <> zeros)
003199           MOVE ER-1963          TO WS-ERROR
003200           PERFORM 9900-ERROR-FORMAT
003201                                 THRU 9900-EXIT
003202        end-if
003203     else
003204        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
003205           and (ws-st-comm-cap-sa <> zeros)
003206           MOVE ER-1957          TO WS-ERROR
003207           PERFORM 9900-ERROR-FORMAT
003208                                 THRU 9900-EXIT
003209        end-if
003210        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
003211           and (ws-st-ga-comm-cap-sa <> zeros)
003212           MOVE ER-1960          TO WS-ERROR
003213           PERFORM 9900-ERROR-FORMAT
003214                                 THRU 9900-EXIT
003215        end-if
003216        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
003217           and (ws-st-tot-comm-cap-sa <> zeros)
003218           MOVE ER-1963          TO WS-ERROR
003219           PERFORM 9900-ERROR-FORMAT
003220                                 THRU 9900-EXIT
003221        end-if
003222     end-if
003223
003224     .
003225 0560-EDIT-CONTINUE.
003226
003227     MOVE ZEROS                  TO WS-LF-PMF-COMM
003228                                    WS-AH-PMF-COMM
003229*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
003230*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
003231
003232     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
003233        (SUB1 > +10)
003234        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
003235           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
003236           MOVE '0530'           TO CTBL-SW
003237           MOVE ' '              TO WS-CTBL-READ-SW
003238           PERFORM 0561-CHECK-AH THRU 0561-EXIT
003239           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
003240           MOVE '0540'           TO CTBL-SW
003241           MOVE ' '              TO WS-CTBL-READ-SW
003242           PERFORM 0563-CHECK-LF THRU 0563-EXIT
003243        END-IF
003244     END-PERFORM
003245
003246     GO TO 0564-EDIT-CONTINUE
003247
003248     .
003249 0561-CHECK-AH.
003250
003251     IF (NO-AH-COVERAGE)
003252        OR (NO-AH-BENEFIT-MATCH)
003253        CONTINUE
003254     ELSE
003255        IF (AM-A-COM (SUB1) NUMERIC)
003256           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
003257           IF (AM-COM-TYP (SUB1) = 'A')
003258              AND (WS-AH-PMF-COMM = ZEROS)
003259              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
003260           END-IF
003261           CONTINUE
003262        ELSE
003263           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
003264           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
003265           MOVE PB-AH-OVERRIDE-L1
003266                                 TO CTBL-BEN-TYPE
003267           MOVE ZEROS            TO WS-SUB1
003268                                    WS-COMMISSION
003269           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
003270           PERFORM 8300-READ-CTBL-TABLE
003271                                 THRU 8300-EXIT
003272           IF CTBL-TABLE-FOUND
003273              IF (AM-COM-TYP (SUB1) = 'A')
003274                 AND (WS-AH-PMF-COMM = ZEROS)
003275                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
003276                                        PB-I-AH-TERM
003277                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
003278                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
003279              END-IF
003280              CONTINUE
003281           ELSE
003282              IF FIRST-TIME-THROUGH
003283                 GO TO 0561-CHECK-AH
003284              ELSE
003285                 MOVE ER-2609    TO WS-ERROR
003286                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003287              END-IF
003288           END-IF
003289        END-IF
003290     END-IF
003291
003292     .
003293 0561-EXIT.
003294     EXIT.
003295
003296 0563-CHECK-LF.
003297
003298     IF (NO-LIFE-COVERAGE)
003299        OR (NO-LF-BENEFIT-MATCH)
003300        CONTINUE
003301     ELSE
003302        IF WS-LF-JOINT-INDICATOR = 'J'
003303           IF AM-J-COM (SUB1) NUMERIC
003304              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
003305              IF (AM-COM-TYP (SUB1) = 'A')
003306                 AND (WS-LF-PMF-COMM = ZEROS)
003307                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
003308              END-IF
003309              CONTINUE
003310           ELSE
003311              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
003312              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
003313              MOVE PB-LIFE-OVERRIDE-L1
003314                                 TO CTBL-BEN-TYPE
003315              MOVE ZEROS         TO WS-SUB1
003316                                    WS-COMMISSION
003317              MOVE AM-J-COMA (SUB1)
003318                                 TO CTBL-TABLE
003319              PERFORM 8300-READ-CTBL-TABLE
003320                                 THRU 8300-EXIT
003321              IF CTBL-TABLE-FOUND
003322                 IF (AM-COM-TYP (SUB1) = 'A')
003323                    AND (WS-LF-PMF-COMM = ZEROS)
003324                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
003325                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
003326                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
003327                 END-IF
003328                 CONTINUE
003329              ELSE
003330                 IF FIRST-TIME-THROUGH
003331                    GO TO 0563-CHECK-LF
003332                 ELSE
003333                    MOVE ER-2609 TO WS-ERROR
003334                    PERFORM 9900-ERROR-FORMAT
003335                                 THRU 9900-EXIT
003336*                   GO TO 0560-EDIT-CONTINUE
003337                 END-IF
003338              END-IF
003339           END-IF
003340        ELSE
003341           IF AM-L-COM (SUB1) NUMERIC
003342              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
003343              IF (AM-COM-TYP (SUB1) = 'A')
003344                 AND (WS-LF-PMF-COMM = ZEROS)
003345                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
003346              END-IF
003347              CONTINUE
003348           ELSE
003349              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
003350              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
003351              MOVE PB-LIFE-OVERRIDE-L1
003352                                 TO CTBL-BEN-TYPE
003353              MOVE ZEROS         TO WS-SUB1
003354                                    WS-COMMISSION
003355              MOVE AM-L-COMA (SUB1)
003356                                 TO CTBL-TABLE
003357              PERFORM 8300-READ-CTBL-TABLE
003358                                 THRU 8300-EXIT
003359              IF CTBL-TABLE-FOUND
003360                 CONTINUE
003361              ELSE
003362                 IF FIRST-TIME-THROUGH
003363                    GO TO 0563-CHECK-LF
003364                 ELSE
003365                    MOVE ER-2609 TO WS-ERROR
003366                    PERFORM 9900-ERROR-FORMAT
003367                                 THRU 9900-EXIT
003368                 END-IF
003369              END-IF
003370           END-IF
003371        END-IF
003372     END-IF
003373
003374     .
003375 0563-EXIT.
003376     EXIT.
003377
003378 0564-EDIT-CONTINUE.
003379
003380     IF  PB-COMPANY-ID EQUAL 'DMD'
003381         IF PB-I-NUM-BILLED EQUAL ZEROS
003382            MOVE ER-8148       TO WS-ERROR
003383            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003384
003385*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
003386*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
003387*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
003388*         SET ELAPSED-BETWEEN-BIN TO TRUE
003389*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
003390*         IF NO-CONVERSION-ERROR
003391*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
003392*         ELSE
003393*             IF PB-COMPANY-ID EQUAL 'HAN'
003394*                 MOVE ZEROS     TO PB-I-AGE.
003395
003396     IF PB-I-BIRTHDAY > LOW-VALUES
003397        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
003398        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
003399        SET ELAPSED-BETWEEN-BIN  TO TRUE
003400        PERFORM 8500-DATE-CONVERT
003401                                 THRU 8500-EXIT
003402        IF NO-CONVERSION-ERROR
003403           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
003404           IF PB-I-AGE > ZEROS
003405              IF WS-WORK-AGE NOT = PB-I-AGE
003406                 MOVE ER-9501    TO WS-ERROR
003407                 PERFORM 9900-ERROR-FORMAT
003408                                 THRU 9900-EXIT
003409              END-IF
003410           ELSE
003411              MOVE WS-WORK-AGE   TO PB-I-AGE
003412           END-IF
003413        END-IF
003414     END-IF
003415
003416     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
003417                                   WS-INS-AGE-SET
003418     IF PB-I-AGE = ZEROS
003419        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
003420           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
003421                                   WS-INS-AGE-SET
003422           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
003423
003424     MOVE PB-I-AGE              TO WS-EDIT-AGE
003425                                   WS-AH-EDIT-AGE.
003426
003427     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
003428        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
003429        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
003430        SET ELAPSED-BETWEEN-BIN  TO TRUE
003431        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
003432        IF NO-CONVERSION-ERROR
003433           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
003434           IF PB-I-JOINT-AGE > 0
003435              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
003436                 MOVE ER-9503    TO WS-ERROR
003437                 PERFORM 9900-ERROR-FORMAT
003438                                 THRU 9900-EXIT
003439              END-IF
003440           ELSE
003441              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
003442           END-IF
003443        ELSE
003444           MOVE ZEROS            TO PB-I-JOINT-AGE
003445        END-IF
003446     END-IF
003447
003448     IF PB-I-JOINT-AGE NOT NUMERIC
003449        MOVE ZERO               TO PB-I-JOINT-AGE.
003450
003451     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
003452                                   WS-JNT-AGE-SET
003453     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
003454        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
003455           (WS-AH-JOINT-INDICATOR = 'J')
003456           IF PB-I-JOINT-AGE = ZEROS
003457               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
003458                                          WS-JNT-AGE-SET
003459               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
003460           END-IF
003461        END-IF
003462     END-IF
003463
003464     MOVE ' ' TO PB-I-LIFE-INDICATOR
003465     IF WS-LF-JOINT-INDICATOR = 'J'
003466        MOVE 'J'                TO PB-I-LIFE-INDICATOR
003467        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
003468            IF  PB-I-JOINT-AGE = ZERO
003469                MOVE ER-2686       TO WS-ERROR
003470                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003471            ELSE
003472                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
003473                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
003474                    IF PB-COMPANY-ID NOT = 'LBL'
003475                        MOVE ER-2685    TO WS-ERROR
003476                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003477
003478     IF WS-AH-JOINT-INDICATOR = 'J'
003479        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
003480            IF  PB-I-JOINT-AGE = ZERO
003481                MOVE ER-2686       TO WS-ERROR
003482                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003483            ELSE
003484                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
003485                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
003486                                           WS-EDIT-AGE
003487                    IF PB-COMPANY-ID NOT = 'LBL'
003488                        MOVE ER-2685    TO WS-ERROR
003489                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003490
003491******************************************************************
003492*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
003493******************************************************************
003494
003495     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
003496        (WS-AH-SPECIAL-CALC-CD = 'O')
003497        NEXT SENTENCE
003498     ELSE
003499        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
003500          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
003501           (WS-LF-JOINT-INDICATOR = 'J'  OR
003502            WS-AH-JOINT-INDICATOR = 'J')  AND
003503           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
003504            MOVE ER-2627             TO WS-ERROR
003505            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003506
003507     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
003508        (WS-AH-SPECIAL-CALC-CD = 'O')
003509         NEXT SENTENCE
003510     ELSE
003511         IF WS-LF-JOINT-INDICATOR = 'J'  OR
003512            WS-AH-JOINT-INDICATOR = 'J'
003513             IF PB-I-JOINT-INSURED = SPACES
003514                 IF PB-COMPANY-ID NOT = 'JAL'
003515                     MOVE ER-2696    TO WS-ERROR
003516                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003517
003518     IF PB-COMPANY-ID NOT = 'BOA'
003519        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
003520           (WS-AH-JOINT-INDICATOR NOT = 'J')
003521           IF (PB-I-JOINT-AGE NOT = ZEROS OR
003522               PB-I-JOINT-INSURED NOT = SPACES)
003523                MOVE ER-2691         TO WS-ERROR
003524                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003525
003526     IF PB-COMPANY-ID = 'BOA'
003527        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
003528           (WS-AH-JOINT-INDICATOR NOT = 'J')
003529            IF PB-I-JOINT-AGE NOT = ZEROS
003530                MOVE ER-2691         TO WS-ERROR
003531                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003532
003533     IF PB-COMPANY-ID = 'CRI'
003534        IF PB-I-SIG-SW = 'J'
003535           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
003536              WS-AH-JOINT-INDICATOR NOT = 'J'
003537              MOVE ER-2675       TO WS-ERROR
003538              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003539
003540     IF PB-COMPANY-ID = 'CRI'
003541        IF PB-I-SIG-SW = 'S'
003542           IF WS-LF-JOINT-INDICATOR = 'J'  OR
003543              WS-AH-JOINT-INDICATOR = 'J'
003544              MOVE ER-2676       TO WS-ERROR
003545              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003546
003547     IF PB-COMPANY-ID = 'CVL'
003548         IF (WS-AH-JOINT-INDICATOR = 'J') AND
003549            (WS-LF-JOINT-INDICATOR NOT = 'J')
003550              MOVE ER-2783           TO WS-ERROR
003551              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003552
003553     IF (WS-LF-JOINT-INDICATOR = 'J')
003554        AND (WS-AH-JOINT-INDICATOR = 'J')
003555        AND (PB-I-LF-TERM > 120)
003556        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
003557        MOVE ER-2783             TO WS-ERROR
003558        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003559     END-IF
003560
003561     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
003562
003563     IF PB-I-INDV-GRP-OVRD = 'I'
003564        MOVE ER-2666             TO WS-ERROR
003565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003566        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
003567
003568     IF PB-I-INDV-GRP-OVRD = 'G'
003569        MOVE ER-2666             TO WS-ERROR
003570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003571        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
003572
003573     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
003574        NEXT SENTENCE
003575     ELSE
003576        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
003577
003578     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
003579        IF WS-ERROR = ER-2666
003580           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
003581           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
003582
003583     IF PB-COMPANY-ID = 'CID'
003584        IF PB-STATE = 'UT' OR 'MO'
003585           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
003586                 OR '76' OR '77')
003587                      OR
003588               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
003589                   OR '41' OR '42' OR '63' OR '64' OR '65'
003590                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
003591                   OR '2K' OR '2L'))
003592              AND PB-I-INDV-GRP-CD = 'I'
003593              MOVE ER-2721             TO WS-ERROR
003594              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003595           END-IF
003596        END-IF
003597     END-IF
003598
003599     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
003600     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
003601        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
003602     ELSE
003603        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
003604     END-IF
003605
003606*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
003607*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
003608     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
003609                                    ACCOUNT-AH-CK-SW.
003610
003611     IF PB-REISSUED-CERT       OR
003612        PB-REIN-ONLY-CERT      OR
003613        PB-POLICY-IS-DECLINED  OR
003614        PB-POLICY-IS-VOIDED
003615*       OR PB-MONTHLY-CERT
003616         GO TO 3000-CONTINUE-EDIT.
003617
003618     IF PB-COMPANY-ID = 'CID' OR 'AHL'
003619        IF WS-EDIT-AGE           > +65
003620           MOVE ER-2709          TO WS-ERROR
003621           PERFORM 9900-ERROR-FORMAT
003622                                 THRU 9900-EXIT
003623        ELSE
003624           IF WS-EDIT-AGE        > +55
003625              MOVE ER-2718       TO WS-ERROR
003626              PERFORM 9900-ERROR-FORMAT
003627                                 THRU 9900-EXIT
003628           END-IF
003629        END-IF
003630
003631     IF PB-COMPANY-ID = 'DCC' or 'VPP'
003632        IF WS-EDIT-AGE           > +65
003633           MOVE ER-2709          TO WS-ERROR
003634           PERFORM 9900-ERROR-FORMAT
003635                                 THRU 9900-EXIT
003636        END-IF
003637     END-IF
003638     .
003639
003640 0565-LIFE-PLAN-LIMIT-EDITS.
003641
003642     IF NOT LF-PLAN-MASTER-FOUND
003643        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
003644                                    EC-AM-LF-MAX-TOT-BEN
003645        GO TO 0580-AH-PLAN-LIMIT-EDITS.
003646
003647     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
003648
003649     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
003650         IF PL-LM-AGE (1) = ZEROS
003651             GO TO 0580-AH-PLAN-LIMIT-EDITS.
003652
003653     IF NO-LF-BENEFIT-MATCH          OR
003654        WS-LF-BENEFIT-CD = ZEROS     OR
003655        WS-LF-SPECIAL-CALC-CD = 'M'
003656        GO TO 0580-AH-PLAN-LIMIT-EDITS.
003657
003658     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
003659     MOVE +1                     TO SUB2.
003660
003661     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
003662        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
003663           MOVE +5   TO SUB2
003664           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
003665              (PL-LM-DUR (SUB2) EQUAL +0) AND
003666              (PL-LM-AGE (SUB2) EQUAL +0)
003667              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
003668              GO TO 0580-AH-PLAN-LIMIT-EDITS.
003669
003670     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
003671
003672     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
003673                               + PB-I-LF-ALT-BENEFIT-AMT.
003674
003675 0568-CHECK-LIFE-ATT-AGE.
003676
003677
003678     IF PL-ATT-AGE NUMERIC AND
003679        PL-ATT-AGE > +0
003680        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
003681     END-IF
003682
003683
003684
003685*    IF PL-ATT-AGE NUMERIC AND
003686*       PL-ATT-AGE > +0
003687*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
003688*       IF PB-I-BIRTHDAY > LOW-VALUES
003689*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
003690*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
003691*          MOVE ZERO             TO DC-ELAPSED-DAYS
003692*          SET BIN-PLUS-ELAPSED  TO TRUE
003693*          PERFORM 8500-DATE-CONVERT
003694*                                THRU 8500-EXIT
003695*          IF NO-CONVERSION-ERROR
003696*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
003697*             MOVE ER-2669       TO WS-ERROR
003698*             PERFORM 9900-ERROR-FORMAT
003699*                                THRU 9900-EXIT
003700*          END-IF
003701*       ELSE
003702*          IF WS-ATT-AGE >= PL-ATT-AGE
003703*             MOVE ER-2669       TO WS-ERROR
003704*             PERFORM 9900-ERROR-FORMAT
003705*                                THRU 9900-EXIT
003706*          END-IF
003707*       END-IF
003708*    END-IF
003709
003710     .
003711 0570-CHECK-LIFE-LIMITS.
003712
003713     IF PB-COMPANY-ID EQUAL 'CRI'
003714        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
003715           IF SUB2 GREATER THAN +4
003716              MOVE ER-2637 TO WS-ERROR
003717              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003718              GO TO 0580-AH-PLAN-LIMIT-EDITS.
003719
003720     IF PB-COMPANY-ID  =  'NCL'
003721        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
003722            SUB2 GREATER THAN +8
003723             MOVE 'U'         TO PB-BATCH-ENTRY
003724             MOVE ER-2637     TO WS-ERROR
003725             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003726             GO TO 0575-CHECK-NCL-SIG-SWITCH.
003727
003728     IF SUB2 > +8
003729        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
003730           AND (PB-I-SIG-SW = 'Y')
003731           CONTINUE
003732        ELSE
003733           MOVE ER-2637          TO WS-ERROR
003734           PERFORM 9900-ERROR-FORMAT
003735                                 THRU 9900-EXIT
003736        END-IF
003737        GO TO 0580-AH-PLAN-LIMIT-EDITS
003738     END-IF
003739
003740     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
003741     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
003742     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
003743
003744     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
003745        ADD +1  TO SUB2
003746        GO TO 0570-CHECK-LIFE-LIMITS.
003747
003748     IF PB-COMPANY-ID = 'NCL'
003749         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
003750
003751     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
003752        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
003753        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
003754           AND (PB-I-SIG-SW = 'Y')
003755           CONTINUE
003756        ELSE
003757           MOVE ER-2637          TO WS-ERROR
003758           PERFORM 9900-ERROR-FORMAT
003759                                 THRU 9900-EXIT
003760        END-IF
003761     END-IF
003762
003763     GO TO 0580-AH-PLAN-LIMIT-EDITS.
003764
003765
003766 0570-CHECK-NCL-LIFE-LIMITS.
003767
003768     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
003769        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
003770         GO TO 0575-CHECK-NCL-SIG-SWITCH.
003771
003772     IF APP-CERT-USED
003773         IF SUB2  LESS THAN  +5
003774             MOVE +5          TO SUB2
003775             GO TO 0570-CHECK-LIFE-LIMITS.
003776
003777     MOVE ER-2637             TO WS-ERROR.
003778     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003779
003780     MOVE 'U'                 TO PB-BATCH-ENTRY.
003781
003782 0575-CHECK-NCL-SIG-SWITCH.
003783
003784     IF NOT APP-CERT-USED
003785         GO TO 0580-AH-PLAN-LIMIT-EDITS.
003786
003787     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
003788        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
003789        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
003790        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
003791         GO TO 0580-AH-PLAN-LIMIT-EDITS.
003792
003793     IF SUB2 GREATER THAN +4
003794         IF PL-LM-AGE (5) = ZEROS  AND
003795            PL-LM-AGE (6) = ZEROS  AND
003796            PL-LM-AGE (7) = ZEROS  AND
003797            PL-LM-AGE (8) = ZEROS
003798             MOVE  ER-1927        TO WS-ERROR
003799             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
003800             GO TO 0580-AH-PLAN-LIMIT-EDITS
003801         ELSE
003802             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
003803                 MOVE  ER-1920    TO WS-ERROR
003804                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
003805
003806     IF PB-I-SIG-SW  = 'Y'
003807       IF NOT PB-I-POLICY-ACCEPTED  AND
003808          NOT PB-I-POLICY-DECLINED
003809           MOVE 'U'               TO PB-BATCH-ENTRY
003810           MOVE  ER-1926          TO WS-ERROR
003811           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
003812
003813
003814 0580-AH-PLAN-LIMIT-EDITS.
003815
003816     IF PB-COMPANY-ID = 'CID' OR 'AHL'
003817        IF PB-I-AH-BENEFIT-AMT > +1250
003818           MOVE ER-2702          TO WS-ERROR
003819           PERFORM 9900-ERROR-FORMAT
003820                                 THRU 9900-EXIT
003821        END-IF
003822     END-IF
003823
003824     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
003825        AND (PB-MONTHLY-CERT)
003826        IF PB-I-AH-BENEFIT-AMT > +3000
003827           MOVE ER-2881          TO WS-ERROR
003828           PERFORM 9900-ERROR-FORMAT
003829                                 THRU 9900-EXIT
003830        END-IF
003831     END-IF
003832
003833     IF NOT AH-PLAN-MASTER-FOUND
003834        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
003835        GO TO 3000-CONTINUE-EDIT.
003836
003837     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
003838
003839     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
003840         IF PL-LM-AGE (1) = ZEROS
003841             GO TO 3000-CONTINUE-EDIT.
003842
003843     IF NO-AH-BENEFIT-MATCH          OR
003844        WS-AH-BENEFIT-CD = ZEROS     OR
003845        WS-AH-SPECIAL-CALC-CD = 'M'
003846        GO TO 3000-CONTINUE-EDIT.
003847
003848     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
003849     MOVE +1                     TO SUB2.
003850
003851     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
003852        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
003853           MOVE +5 TO SUB2
003854           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
003855              (PL-LM-MOA (SUB2) EQUAL +0) AND
003856              (PL-LM-DUR (SUB2) EQUAL +0) AND
003857              (PL-LM-AGE (SUB2) EQUAL +0)
003858              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
003859              GO TO 3000-CONTINUE-EDIT.
003860
003861     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
003862
003863 0590-CHECK-AH-ATT-AGE.
003864
003865     IF PL-ATT-AGE NUMERIC AND
003866        PL-ATT-AGE GREATER THAN +0
003867        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
003868     END-IF
003869*       IF WS-ATT-AGE >= PL-ATT-AGE
003870*          MOVE ER-3054          TO WS-ERROR
003871*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003872     .
003873 0597-CHECK-AH-LIMITS.
003874
003875     IF PB-COMPANY-ID EQUAL 'CRI'
003876        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
003877           IF SUB2 GREATER THAN +4
003878              MOVE ER-2638       TO WS-ERROR
003879              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003880              GO TO 3000-CONTINUE-EDIT.
003881
003882     IF PB-COMPANY-ID  =  'NCL'
003883        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
003884            SUB2 GREATER THAN +8
003885             MOVE 'U'            TO PB-BATCH-ENTRY
003886             MOVE ER-2638        TO WS-ERROR
003887             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
003888             GO TO 0599-CHECK-NCL-SIG-SWITCH.
003889
003890     IF SUB2 > +8
003891        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
003892           AND (PB-I-SIG-SW = 'Y')
003893           CONTINUE
003894        ELSE
003895           MOVE ER-2638          TO WS-ERROR
003896           PERFORM 9900-ERROR-FORMAT
003897                                 THRU 9900-EXIT
003898        END-IF
003899        GO TO 3000-CONTINUE-EDIT
003900     END-IF
003901
003902     IF PB-COMPANY-ID = 'CRI'
003903        IF WS-ERROR = ER-2638
003904           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
003905
003906     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
003907     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
003908     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
003909     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
003910
003911     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
003912        ADD +1                   TO SUB2
003913        GO TO 0597-CHECK-AH-LIMITS.
003914
003915     IF PB-COMPANY-ID = 'NCL'
003916         GO TO 0597-CHECK-NCL-AH-LIMITS.
003917
003918     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
003919        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
003920        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
003921                                 > PL-LM-AMT (SUB2))
003922        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
003923           AND (PB-I-SIG-SW = 'Y')
003924           CONTINUE
003925        ELSE
003926           MOVE ER-2638          TO WS-ERROR
003927           PERFORM 9900-ERROR-FORMAT
003928                                 THRU 9900-EXIT
003929        END-IF
003930     END-IF
003931
003932     IF  PB-COMPANY-ID   EQUAL    'CRI'
003933         IF  WS-ERROR    EQUAL    ER-2638
003934             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
003935                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
003936                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
003937                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
003938                MOVE  ER-1910    TO  WS-ERROR
003939                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
003940
003941     IF PB-COMPANY-ID = 'CRI'
003942        IF WS-ERROR = ER-2638
003943            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
003944            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
003945            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
003946
003947     GO TO 3000-CONTINUE-EDIT.
003948
003949 0597-CHECK-NCL-AH-LIMITS.
003950
003951     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
003952        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
003953        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
003954                            NOT GREATER THAN PL-LM-AMT (SUB2))
003955         GO TO 0599-CHECK-NCL-SIG-SWITCH.
003956
003957     IF APP-CERT-USED
003958         IF SUB2  LESS THAN  +5
003959             MOVE +5             TO SUB2
003960             GO TO 0597-CHECK-AH-LIMITS.
003961
003962     MOVE ER-2638                TO WS-ERROR.
003963     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
003964
003965     MOVE 'U'                    TO PB-BATCH-ENTRY.
003966
003967 0599-CHECK-NCL-SIG-SWITCH.
003968
003969     IF NOT APP-CERT-USED
003970         GO TO 3000-CONTINUE-EDIT.
003971
003972     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
003973        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
003974        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
003975        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
003976         GO TO 3000-CONTINUE-EDIT.
003977
003978     IF SUB2 GREATER THAN +4
003979         IF PL-LM-AGE (5) = ZEROS  AND
003980            PL-LM-AGE (6) = ZEROS  AND
003981            PL-LM-AGE (7) = ZEROS  AND
003982            PL-LM-AGE (8) = ZEROS
003983             MOVE  ER-1927        TO WS-ERROR
003984             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
003985             GO TO 3000-CONTINUE-EDIT
003986         ELSE
003987             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
003988                 MOVE  ER-1920    TO WS-ERROR
003989                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
003990
003991     IF PB-I-SIG-SW  = 'Y'
003992       IF NOT PB-I-POLICY-ACCEPTED  AND
003993          NOT PB-I-POLICY-DECLINED
003994           MOVE 'U'               TO PB-BATCH-ENTRY
003995           MOVE  ER-1926          TO WS-ERROR
003996           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
003997
003998******************************************************************
003999     EJECT
004000
004001 3000-CONTINUE-EDIT.
004002
004003     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
004004     MOVE AM-CSR-CODE            TO PB-CSR-ID.
004005     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
004006     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
004007     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
004008
004009     IF BROWSE-STARTED
004010        PERFORM 9990-RETURN THRU 9990-EXIT
004011        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
004012
004013     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
004014        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
004015        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
004016        SET ELAPSED-BETWEEN-BIN  TO TRUE
004017*       MOVE 1                   TO DC-OPTION-CODE
004018        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
004019        IF DATE-CONVERSION-ERROR
004020           MOVE ER-2622          TO WS-ERROR
004021           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004022        ELSE
004023           IF DC-ELAPSED-MONTHS   GREATER THAN +2
004024              MOVE ER-2623       TO WS-ERROR
004025              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004026           ELSE
004027              MOVE ER-2622       TO WS-ERROR
004028              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004029
004030     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
004031     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
004032     SET ELAPSED-BETWEEN-BIN     TO TRUE.
004033*    MOVE 1                      TO DC-OPTION-CODE.
004034     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
004035     IF DATE-CONVERSION-ERROR
004036        GO TO 3005-EDIT-CONTINUE
004037     ELSE
004038        IF DC-ELAPSED-DAYS GREATER +180
004039           MOVE ER-2613          TO WS-ERROR
004040           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004041        ELSE
004042           IF DC-ELAPSED-DAYS GREATER +90
004043              MOVE ER-2612       TO WS-ERROR
004044              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004045           ELSE
004046             IF DC-ELAPSED-DAYS GREATER +60
004047                MOVE ER-2614     TO WS-ERROR
004048                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004049
004050 3005-EDIT-CONTINUE.
004051
004052     IF PB-CANCELLATION
004053         GO TO 3700-EDIT-CANCEL.
004054
004055     EJECT
004056******************************************************************
004057*                  E D I T   I S S U E                           *
004058******************************************************************
004059
004060 3020-EDIT-ISSUE.
004061
004062      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
004063      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
004064      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
004065      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
004066      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
004067
004068     IF PB-ISSUE-FORCE
004069        OR PB-ISSUE-DATE-FORCED
004070        OR PB-FORCE-OFF
004071        OR PB-OVERCHARGE-FORCE
004072        or pb-exceeded-limit-forced
004073        CONTINUE
004074     ELSE
004075        MOVE ER-2670             TO WS-ERROR
004076        PERFORM 9900-ERROR-FORMAT
004077                                 THRU 9900-EXIT
004078     END-IF
004079
004080     .
004081 3022-SET-POLICY-STATUS.
004082
004083     MOVE '2'                    TO PB-I-ENTRY-STATUS.
004084
004085     IF (PB-REISSUED-CERT)
004086             OR
004087        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
004088         AND (PB-MONTHLY-CERT))
004089         MOVE '5'                TO PB-I-ENTRY-STATUS
004090         MOVE 'E'                TO PB-BATCH-ENTRY
004091     END-IF
004092
004093     IF PB-COMPANY-ID = 'DCC' or 'VPP'
004094        IF PB-MONTHLY-CERT
004095           MOVE 'M'              TO PB-I-ENTRY-STATUS
004096        END-IF
004097        IF PB-CASH-CERT
004098           MOVE 'C'              TO PB-I-ENTRY-STATUS
004099        END-IF
004100     END-IF
004101
004102     IF PB-POLICY-IS-DECLINED
004103         MOVE 'D'                TO PB-I-ENTRY-STATUS.
004104     IF PB-POLICY-IS-VOIDED
004105         MOVE 'V'                TO PB-I-ENTRY-STATUS.
004106     IF PB-NEEDS-UNDERWRITING
004107         MOVE 'U'                TO PB-I-ENTRY-STATUS.
004108     IF PB-REIN-ONLY-CERT
004109         MOVE '9'                TO PB-I-ENTRY-STATUS.
004110     IF PB-PREM-ACCTNG-ONLY
004111         MOVE 'P'                TO PB-I-ENTRY-STATUS.
004112
004113     MOVE SPACE                  TO PB-I-OB-FLAG.
004114
004115     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
004116         MOVE ER-2665            TO WS-ERROR
004117         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004118         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
004119
004120     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
004121        AND WS-AH-SPECIAL-CALC-CD = 'Z'
004122           MOVE 'Z'             TO PB-I-OB-FLAG.
004123
004124     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
004125        AND WS-LF-SPECIAL-CALC-CD = 'Z'
004126           MOVE 'Z'             TO PB-I-OB-FLAG.
004127
004128     IF ACCOUNT-MAST-FOUND
004129         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
004130         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
004131         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
004132         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
004133         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
004134         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
004135         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
004136     END-IF
004137
004138     IF ACCOUNT-MAST-FOUND
004139        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
004140         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
004141
004142     IF (ACCOUNT-MAST-FOUND)
004143*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
004144        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
004145        IF PB-REISSUED-CERT
004146           CONTINUE
004147        ELSE
004148           MOVE ER-2608          TO WS-ERROR
004149           PERFORM 9900-ERROR-FORMAT
004150                                 THRU 9900-EXIT
004151         END-IF
004152     END-IF
004153
004154     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
004155        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
004156        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
004157
004158**********   DMD CUSTOM CODE FOLLOWS  **********
004159 3024-EDIT-DMD-FIELDS.
004160     IF PB-COMPANY-ID NOT = 'DMD'
004161        GO TO 3025-EDIT-REINSURANCE.
004162
004163*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
004164*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
004165*** ERROR IF THEY ARE NOT EQUAL.
004166
004167     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
004168     SET BIN-TO-GREG               TO TRUE.
004169     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
004170     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
004171**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
004172
004173     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
004174     SET BIN-TO-GREG               TO TRUE.
004175     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
004176     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
004177**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
004178
004179     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
004180        MOVE ER-8116               TO WS-ERROR
004181        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004182
004183     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
004184
004185     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
004186                                      WK-FULL-CERT-NO.
004187     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
004188
004189     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
004190
004191     IF PB-VALID-LIFE
004192        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
004193     ELSE
004194        IF PB-VALID-AH
004195          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
004196
004197
004198     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
004199     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
004200     MOVE SPACES                   TO DCUA-CERT-NUMBER
004201                                      DCUA-UNDRWRTR-CODE
004202                                      DCUA-UNDRWRTR-GROUP-CODE
004203                                      DCUA-RETURN-CODE.
004204
004205****************************************************************
004206*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
004207***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
004208***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
004209***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
004210***   TO THIS RECORD.                                        ***
004211****************************************************************
004212     MOVE ' '                      TO WS-DLO-ERROR-SW.
004213     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
004214     IF DCUA-SUCCESSFUL-PROCESS
004215        GO TO 3024-EDIT-DL7-CONT.
004216
004217     IF DCUA-RETURN-CODE EQUAL '01'
004218        MOVE ER-8110               TO WS-ERROR
004219        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004220        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004221        GO TO 3024-EDIT-DL7-CONT.
004222
004223     IF DCUA-RETURN-CODE EQUAL '02'
004224        MOVE ER-8111               TO WS-ERROR
004225        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004226        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004227        GO TO 3024-EDIT-DL7-CONT.
004228
004229     IF DCUA-RETURN-CODE EQUAL '03'
004230        MOVE ER-8074               TO WS-ERROR
004231        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004232        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004233        GO TO 3024-EDIT-DL7-CONT.
004234
004235     IF DCUA-RETURN-CODE EQUAL '04'
004236        MOVE ER-8075               TO WS-ERROR
004237        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004238        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004239        GO TO 3024-EDIT-DL7-CONT.
004240
004241     IF DCUA-RETURN-CODE EQUAL '05'
004242        MOVE ER-8076               TO WS-ERROR
004243        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004244        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004245        GO TO 3024-EDIT-DL7-CONT.
004246
004247     IF DCUA-RETURN-CODE EQUAL '06'
004248        MOVE ER-8077               TO WS-ERROR
004249        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004250        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004251        GO TO 3024-EDIT-DL7-CONT.
004252
004253     IF DCUA-RETURN-CODE EQUAL '07'
004254        MOVE ER-8078               TO WS-ERROR
004255        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004256        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004257        GO TO 3024-EDIT-DL7-CONT.
004258
004259     IF DCUA-RETURN-CODE EQUAL 'E1'
004260        MOVE ER-8079               TO WS-ERROR
004261        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004262        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004263        GO TO 3024-EDIT-DL7-CONT.
004264
004265     IF DCUA-RETURN-CODE EQUAL 'E2'
004266        MOVE ER-8080               TO WS-ERROR
004267        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004269        GO TO 3024-EDIT-DL7-CONT.
004270
004271     IF DCUA-RETURN-CODE EQUAL 'E3'
004272        MOVE ER-8098               TO WS-ERROR
004273        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004274        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004275        GO TO 3024-EDIT-DL7-CONT.
004276
004277     IF DCUA-RETURN-CODE EQUAL 'C1'
004278        MOVE ER-8099               TO WS-ERROR
004279        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004280        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004281        GO TO 3024-EDIT-DL7-CONT.
004282
004283     IF DCUA-RETURN-CODE EQUAL 'U1'
004284        MOVE ER-8109               TO WS-ERROR
004285        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004286        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004287        GO TO 3024-EDIT-DL7-CONT.
004288
004289     IF DCUA-RETURN-CODE EQUAL 'N1'
004290        MOVE ER-8112               TO WS-ERROR
004291        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004292        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004293        GO TO 3024-EDIT-DL7-CONT.
004294
004295     IF DCUA-RETURN-CODE EQUAL 'N2'
004296        MOVE ER-8113               TO WS-ERROR
004297        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004298        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004299        GO TO 3024-EDIT-DL7-CONT.
004300
004301     IF DCUA-RETURN-CODE EQUAL 'N3'
004302        MOVE ER-8114               TO WS-ERROR
004303        MOVE 'Y'                   TO WS-DLO-ERROR-SW
004304        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004305        GO TO 3024-EDIT-DL7-CONT.
004306
004307     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
004308     MOVE ER-8097                  TO WS-ERROR.
004309     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
004310     GO TO 3024-EDIT-DL7-CONT.
004311
004312 3024-EDIT-DL7-CONT.
004313
004314     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
004315     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
004316     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
004317        NEXT SENTENCE
004318     ELSE
004319        MOVE ER-9263               TO WS-ERROR
004320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004321
004322******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
004323******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
004324     IF DCUA-CERT-NUMBER = PB-CERT-NO
004325        NEXT SENTENCE
004326     ELSE
004327        MOVE ER-8039               TO WS-ERROR
004328        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004329
004330     EJECT
004331****************************************************************
004332*** VALIDATE STATE  : DLO022                                 ***
004333****************************************************************
004334     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
004335     MOVE SPACES                   TO DVSC-RETURN-CODE.
004336
004337     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
004338     IF DVSC-SUCCESSFUL-EDIT
004339        GO TO 3024-EDIT-DL22-CONT.
004340
004341     IF DVSC-RETURN-CODE EQUAL '01'
004342        MOVE ER-8300               TO WS-ERROR
004343        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004344        GO TO 3024-EDIT-DL22-CONT.
004345
004346     IF DVSC-RETURN-CODE EQUAL '02'
004347        MOVE ER-8301               TO WS-ERROR
004348        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004349        GO TO 3024-EDIT-DL22-CONT.
004350
004351     IF DVSC-RETURN-CODE EQUAL '03'
004352        MOVE ER-8302               TO WS-ERROR
004353        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004354        GO TO 3024-EDIT-DL22-CONT.
004355
004356     IF DVSC-RETURN-CODE EQUAL 'N1'
004357        MOVE ER-8304               TO WS-ERROR
004358        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004359        GO TO 3024-EDIT-DL22-CONT.
004360
004361     MOVE ER-8303                  TO WS-ERROR
004362     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004363
004364 3024-EDIT-DL22-CONT.
004365 EJECT
004366****************************************************************
004367*** VALIDATE LOAN OFFICER : DLO021                           ***
004368****************************************************************
004369
004370     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
004371     MOVE SPACES                    TO DVLO-RETURN-CODE.
004372     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
004373     IF DVLO-SUCCESSFUL-EDIT
004374        GO TO 3024-EDIT-DL21-CONT.
004375
004376     IF DVLO-RETURN-CODE EQUAL '01'
004377        MOVE ER-8081               TO WS-ERROR
004378        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004379        GO TO 3024-EDIT-DL21-CONT.
004380
004381     IF DVLO-RETURN-CODE EQUAL '02'
004382        MOVE ER-8082               TO WS-ERROR
004383        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004384        GO TO 3024-EDIT-DL21-CONT.
004385
004386     IF DVLO-RETURN-CODE EQUAL '03'
004387        MOVE ER-8083               TO WS-ERROR
004388        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004389        GO TO 3024-EDIT-DL21-CONT.
004390
004391     IF DVLO-RETURN-CODE EQUAL '04'
004392        MOVE ER-8084               TO WS-ERROR
004393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004394        GO TO 3024-EDIT-DL21-CONT.
004395
004396     IF DVLO-RETURN-CODE EQUAL '05'
004397        MOVE ER-8085               TO WS-ERROR
004398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004399        GO TO 3024-EDIT-DL21-CONT.
004400
004401     MOVE ER-7825                  TO WS-ERROR
004402     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
004403     GO TO 3024-EDIT-DL21-CONT.
004404
004405 3024-EDIT-DL21-CONT.
004406 EJECT
004407
004408****************************************************************
004409*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
004410****************************************************************
004411
004412     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
004413     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
004414     MOVE SPACES                 TO DIPF-RETURN-CODE.
004415     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
004416     IF DIPF-SUCCESSFUL-EDIT
004417        GO TO 3024-EDIT-DL02-CONT.
004418
004419     IF DIPF-RETURN-CODE EQUAL '01'
004420        MOVE ER-8086               TO WS-ERROR
004421        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004422        GO TO 3024-EDIT-DL02-CONT.
004423
004424     IF DIPF-RETURN-CODE EQUAL '02'
004425        MOVE ER-8087               TO WS-ERROR
004426        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004427        GO TO 3024-EDIT-DL02-CONT.
004428
004429     IF DIPF-RETURN-CODE EQUAL '03'
004430        MOVE ER-8088               TO WS-ERROR
004431        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004432        GO TO 3024-EDIT-DL02-CONT.
004433
004434     MOVE ER-8095                  TO WS-ERROR
004435     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
004436     GO TO 3024-EDIT-DL02-CONT.
004437
004438 3024-EDIT-DL02-CONT.
004439 EJECT
004440
004441****************************************************************
004442*** VALIDATE BANK ID : DLO003                                ***
004443****************************************************************
004444
004445     MOVE WK-GREG-CENT           TO WCG-CENT.
004446     MOVE WK-GREG-YYMM           TO WCG-REST.
004447     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
004448        MOVE ER-8040               TO WS-ERROR
004449        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004450
004451     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
004452     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
004453     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
004454     MOVE SPACES                 TO  DVBI-RETURN-CODE.
004455     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
004456     IF DVBI-SUCCESSFUL-EDIT
004457        GO TO 3024-EDIT-DL03-CONT.
004458
004459     IF DVBI-RETURN-CODE EQUAL '01'
004460        MOVE ER-8089               TO WS-ERROR
004461        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004462        GO TO 3024-EDIT-DL03-CONT.
004463
004464     IF DVBI-RETURN-CODE EQUAL '02'
004465        MOVE ER-8090               TO WS-ERROR
004466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004467        GO TO 3024-EDIT-DL03-CONT.
004468
004469     IF DVBI-RETURN-CODE EQUAL '03'
004470        MOVE ER-8091               TO WS-ERROR
004471        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004472        GO TO 3024-EDIT-DL03-CONT.
004473
004474     IF DVBI-RETURN-CODE EQUAL '04'
004475        MOVE ER-8092               TO WS-ERROR
004476        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004477        GO TO 3024-EDIT-DL03-CONT.
004478
004479     IF DVBI-RETURN-CODE EQUAL '05'
004480        MOVE ER-8093               TO WS-ERROR
004481        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004482        GO TO 3024-EDIT-DL03-CONT.
004483
004484     IF DVBI-RETURN-CODE EQUAL '06'
004485        MOVE ER-8094               TO WS-ERROR
004486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004487        GO TO 3024-EDIT-DL03-CONT.
004488
004489     MOVE ER-8096                  TO WS-ERROR
004490     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
004491     GO TO 3024-EDIT-DL03-CONT.
004492
004493 3024-EDIT-DL03-CONT.
004494 EJECT
004495
004496     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
004497        NEXT SENTENCE
004498     ELSE
004499        MOVE ER-8042               TO WS-ERROR
004500        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004501
004502     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
004503     MOVE SPACES                 TO  DMPF-RETURN-CODE.
004504     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
004505
004506     IF DMPF-RETURN-CODE = '01'
004507        MOVE ER-8067               TO WS-ERROR
004508        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004509        GO TO 3024-EDIT-DL01-CONT.
004510
004511     IF DMPF-RETURN-CODE = '02'
004512        MOVE ER-8068               TO WS-ERROR
004513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004514        GO TO 3024-EDIT-DL01-CONT.
004515
004516     IF DMPF-RETURN-CODE = '03'
004517        MOVE ER-8069               TO WS-ERROR
004518        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004519        GO TO 3024-EDIT-DL01-CONT.
004520
004521     IF DMPF-RETURN-CODE = 'E1'
004522        MOVE ER-8070               TO WS-ERROR
004523        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004524        GO TO 3024-EDIT-DL01-CONT.
004525
004526     IF DMPF-RETURN-CODE = 'N1'
004527        MOVE ER-8071               TO WS-ERROR
004528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004529        GO TO 3024-EDIT-DL01-CONT.
004530
004531     IF DMPF-RETURN-CODE NOT = 'OK'
004532        MOVE ER-8072               TO WS-ERROR
004533        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004534
004535 3024-EDIT-DL01-CONT.
004536******************************************************************
004537***  VALIDATES RATE CODES : DLO017                             ***
004538******************************************************************
004539
004540      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
004541      MOVE SPACES                   TO DVRC-RETURN-CODE.
004542      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
004543      IF DVRC-SUCCESSFUL-EDIT
004544        MOVE 'Y'                   TO WK-VALID-RATE-CODE
004545        GO TO 3024-CHECK-VALID-RATE.
004546
004547      MOVE 'N'                     TO WK-VALID-RATE-CODE.
004548
004549      IF DVRC-RETURN-CODE EQUAL '01'
004550         MOVE ER-7817                   TO WS-ERROR
004551         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004552         GO TO 3025-EDIT-REINSURANCE.
004553
004554      IF DVRC-RETURN-CODE EQUAL '02'
004555         MOVE ER-7818                   TO WS-ERROR
004556         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004557         GO TO 3025-EDIT-REINSURANCE.
004558
004559      IF DVRC-RETURN-CODE EQUAL '03'
004560         MOVE ER-7819                   TO WS-ERROR
004561         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004562         GO TO 3025-EDIT-REINSURANCE.
004563
004564       MOVE ER-7820                     TO WS-ERROR.
004565       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
004566       GO TO 3025-EDIT-REINSURANCE.
004567
004568******************************************************************
004569***  GET PREMIUM RATES : DLO011                                ***
004570******************************************************************
004571
004572 3024-CHECK-VALID-RATE.
004573
004574     IF VALID-RATE-CODE
004575        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
004576        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
004577        MOVE SPACES                TO DPRB-RETURN-CODE
004578        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
004579     ELSE
004580         GO TO 3025-EDIT-REINSURANCE.
004581
004582      IF DPRB-SUCCESSFUL-PROCESS
004583         IF PB-VALID-LIFE
004584             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
004585             GO TO 3025-EDIT-REINSURANCE
004586         ELSE
004587             IF PB-VALID-AH
004588                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
004589                 GO TO 3025-EDIT-REINSURANCE.
004590
004591      IF DPRB-RETURN-CODE EQUAL '01'
004592         MOVE ER-7812                   TO WS-ERROR
004593         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004594         GO TO 3025-EDIT-REINSURANCE.
004595
004596      IF DPRB-RETURN-CODE EQUAL '02'
004597         MOVE ER-7813                   TO WS-ERROR
004598         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004599         GO TO 3025-EDIT-REINSURANCE.
004600
004601      IF DPRB-RETURN-CODE EQUAL '03'
004602         MOVE ER-7814                   TO WS-ERROR
004603         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004604         GO TO 3025-EDIT-REINSURANCE.
004605
004606      IF DPRB-RETURN-CODE EQUAL '04'
004607         IF NOT DPRB-1ST-TIME
004608            MOVE ER-7815                   TO WS-ERROR
004609            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004610            GO TO 3025-EDIT-REINSURANCE
004611          ELSE
004612         IF PB-VALID-LIFE
004613            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
004614          ELSE
004615            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
004616         END-IF
004617         MOVE SPACES                TO DOCC-RETURN-CODE
004618         MOVE 'X'                   TO DPRB-1ST-TIME-SW
004619         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
004620         IF DOCC-RETURN-CODE = 'OK'
004621             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
004622             GO TO 3024-CHECK-VALID-RATE
004623           ELSE
004624             MOVE ER-7823               TO WS-ERROR
004625             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
004626             GO TO 3025-EDIT-REINSURANCE.
004627
004628       MOVE ER-7816                     TO WS-ERROR.
004629       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
004630       GO TO 3025-EDIT-REINSURANCE.
004631
004632**********   DMD CUSTOM CODE ABOVE    **********
004633
004634 3025-EDIT-REINSURANCE.
004635     IF PB-I-SPECIAL-REIN-CODE = SPACE
004636         GO TO 3027-EDIT-CONTINUE.
004637
004638     MOVE LOW-VALUES               TO ERREIN-KEY.
004639     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
004640     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
004641                                      REIN-CODE-2
004642                                      REIN-CODE-3.
004643     MOVE 'A'                      TO REIN-TYPE.
004644
004645     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
004646
004647     MOVE '3026' TO REIN-SW.
004648     MOVE ' '                   TO WS-REIN-READ-SW.
004649
004650     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
004651     IF REIN-TABLE-NOT-FOUND
004652         GO TO 3026-NO-SPEC-TABLE.
004653
004654     MOVE RE-TABLE              TO WK-REIN-TABLE.
004655     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
004656                                   WS-NSP-ST-CD-LF.
004657     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
004658                                   WS-NSP-ST-CD-AH.
004659
004660     GO TO 3040-EDIT-CONTINUE.
004661
004662 3026-NO-SPEC-TABLE.
004663
004664     MOVE ER-2664                TO WS-ERROR.
004665     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004666     GO TO 3040-EDIT-CONTINUE.
004667
004668 3027-EDIT-CONTINUE.
004669
004670     IF PB-I-REIN-TABLE = SPACES
004671       GO TO 3040-EDIT-CONTINUE.
004672
004673     IF PB-I-REIN-TABLE = WK-REIN-TABLE
004674          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
004675          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
004676           GO TO 3040-EDIT-CONTINUE.
004677
004678     MOVE LOW-VALUES            TO ERREIN-KEY.
004679     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
004680     MOVE 'A'                   TO REIN-TYPE.
004681     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
004682
004683     MOVE '3028'                TO REIN-SW.
004684     MOVE ' '                   TO WS-REIN-READ-SW.
004685
004686     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
004687     IF REIN-TABLE-NOT-FOUND
004688         GO TO 3028-NO-REIN-TABLE.
004689
004690     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
004691     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
004692                                   WS-NSP-ST-CD-LF.
004693     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
004694                                   WS-NSP-ST-CD-AH.
004695
004696     GO TO 3040-EDIT-CONTINUE.
004697
004698 3028-NO-REIN-TABLE.
004699
004700     MOVE ER-2615                TO WS-ERROR.
004701     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004702     GO TO 3040-EDIT-CONTINUE.
004703
004704 3040-EDIT-CONTINUE.
004705
004706     IF PB-I-LF-PREM-CALC NOT NUMERIC
004707         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
004708
004709     IF PB-I-AH-PREM-CALC NOT NUMERIC
004710         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
004711
004712     IF (NOT PB-REISSUED-CERT)
004713        AND (NOT PB-MONTHLY-CERT)
004714        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
004715            MOVE '001'           TO PB-I-LF-TERM
004716            MOVE 'M'             TO PB-I-INSURED-SEX.
004717
004718     IF (NOT PB-REISSUED-CERT)
004719        AND (NOT PB-MONTHLY-CERT)
004720        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
004721            MOVE '001'           TO PB-I-AH-TERM
004722            MOVE 'M'             TO PB-I-INSURED-SEX.
004723
004724 3040-EDIT-1ST-PMT-DT.
004725
004726     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
004727     IF PB-I-EXTENTION-DAYS NOT NUMERIC
004728         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
004729
004730******************************************************************
004731*                                                                *
004732*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
004733*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
004734*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
004735*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
004736*                                                                *
004737******************************************************************
004738
004739     IF PB-EFF-DT-PROCESSING
004740        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
004741                                    PB-I-LF-EXPIRE-DT
004742                                    PB-I-AH-EXPIRE-DT
004743        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
004744        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
004745        MOVE ZERO                TO DC-ELAPSED-DAYS
004746        MOVE +1                  TO DC-ELAPSED-MONTHS
004747        SET BIN-PLUS-ELAPSED     TO TRUE
004748*       MOVE 6                   TO DC-OPTION-CODE
004749        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
004750        IF NO-CONVERSION-ERROR
004751           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
004752
004753******************************************************************
004754*                                                                *
004755*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
004756*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
004757*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
004758*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
004759*                                                                *
004760******************************************************************
004761
004762     IF PB-EXT-DAYS-PROCESSING
004763          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
004764                                         PB-I-LF-EXPIRE-DT
004765                                         PB-I-AH-EXPIRE-DT
004766          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
004767          MOVE ZERO                   TO DC-ELAPSED-DAYS
004768          MOVE +1                     TO DC-ELAPSED-MONTHS
004769          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
004770          SET BIN-PLUS-ELAPSED        TO TRUE
004771*         MOVE 6                      TO DC-OPTION-CODE
004772          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
004773          IF NO-CONVERSION-ERROR
004774             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
004775
004776******************************************************************
004777*                                                                *
004778*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
004779*        BASED ON THE OLDEST EXPIRE DATE.                        *
004780*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
004781*        (EXPIRE DATE - (TERM -1))  *  -1.
004782*                                                                *
004783******************************************************************
004784
004785     IF PB-EXPIRE-DT-PROCESSING
004786        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
004787           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
004788              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
004789              MOVE PB-I-AH-TERM      TO WS-TERM
004790           ELSE
004791              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
004792              MOVE PB-I-LF-TERM      TO WS-TERM
004793        ELSE
004794           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
004795              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
004796              MOVE PB-I-LF-TERM      TO WS-TERM
004797           ELSE
004798              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
004799              MOVE PB-I-AH-TERM      TO WS-TERM.
004800
004801     IF PB-EXPIRE-DT-PROCESSING
004802        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
004803        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
004804        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
004805        MOVE ZERO                TO DC-ELAPSED-DAYS
004806                                    DC-ODD-DAYS-OVER
004807          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
004808          SET BIN-PLUS-ELAPSED    TO TRUE
004809*         MOVE 6                  TO DC-OPTION-CODE
004810          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
004811          IF NO-CONVERSION-ERROR
004812             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
004813
004814******************************************************************
004815*                                                                *
004816*            1ST PAYMENT DATE PROCESSING                         *
004817*                                                                *
004818******************************************************************
004819
004820     IF PB-1ST-PMT-DT-PROCESSING
004821        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
004822                                    PB-I-AH-EXPIRE-DT
004823        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
004824
004825     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
004826         NEXT SENTENCE
004827     ELSE
004828         MOVE ER-2680                 TO WS-ERROR
004829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004830         GO TO 3060-ORIG-TERM-CHECK.
004831
004832     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
004833     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
004834     SET ELAPSED-BETWEEN-BIN     TO TRUE.
004835*    MOVE 1                      TO DC-OPTION-CODE.
004836     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
004837                                    DC-ELAPSED-DAYS
004838                                    DC-ODD-DAYS-OVER.
004839
004840     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
004841
004842     IF DATE-CONVERSION-ERROR
004843        GO TO 3060-ORIG-TERM-CHECK.
004844
004845     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
004846
004847     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
004848        AND (WS-LF-COVERAGE-TYPE = 'L')
004849        IF (DC-ELAPSED-MONTHS > 1)
004850                      OR
004851           ((DC-ELAPSED-MONTHS = 1)
004852           AND (DC-ODD-DAYS-OVER > 0))
004853           MOVE ER-2882          TO WS-ERROR
004854           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
004855        END-IF
004856     END-IF
004857
004858     if dc-elapsed-months > 0
004859        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
004860        + dc-odd-days-over
004861     end-if
004862
004863     IF PB-EXT-DAYS-PROCESSING
004864        CONTINUE
004865     ELSE
004866        IF DC-ELAPSED-MONTHS = +0
004867           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
004868        ELSE
004869           IF (WS-LF-EARNINGS-CALC = '4')
004870              AND (DC-ELAPSED-MONTHS > ZERO)
004871              AND (DC-ELAPSED-DAYS > ZERO)
004872              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
004873           ELSE
004874              PERFORM 6400-COMPUTE-EXTENSION-DAYS
004875                                 THRU 6499-EXIT
004876              MOVE WS-ODD-DAYS-OVER
004877                                 TO PB-I-EXTENTION-DAYS
004878           END-IF
004879        END-IF
004880     END-IF
004881
004882******************************************************************
004883*                                                                *
004884*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
004885*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
004886*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
004887*            AND ANY ODD DAYS.                                   *
004888*                                                                *
004889******************************************************************
004890
004891     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
004892                              (EC-ST-FST-PMT-DAYS-MAX + 32)
004893     IF WS-LF-EARNINGS-CALC NOT = '4'
004894        IF DC-ELAPSED-DAYS > ZEROS
004895           MOVE ER-2681          TO WS-ERROR
004896           PERFORM 9900-ERROR-FORMAT
004897                                 THRU 9900-EXIT
004898        END-IF
004899     END-IF
004900
004901     IF WS-LF-EARNINGS-CALC NOT = '4'
004902        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
004903           MOVE ER-2681          TO WS-ERROR
004904           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
004905
004906     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
004907        (PB-I-LF-TERM NOT = ZERO) AND
004908         NOT NO-LIFE-COVERAGE
004909          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
004910          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
004911          IF WS-LF-EARNINGS-CALC = '4'
004912             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
004913             PB-I-PAY-FREQUENCY
004914          END-IF
004915          MOVE ZERO              TO DC-ELAPSED-DAYS
004916                                    DC-ODD-DAYS-OVER
004917          MOVE 1                 TO DC-END-OF-MONTH
004918          SET BIN-PLUS-ELAPSED        TO TRUE
004919*         MOVE 6                 TO DC-OPTION-CODE
004920          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
004921          IF NO-CONVERSION-ERROR
004922             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
004923             IF (WS-LF-EARNINGS-CALC = 'B') AND
004924                (WS-LF-SPECIAL-CALC-CD = 'L')
004925                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
004926                  MOVE ZERO           TO DC-ELAPSED-DAYS
004927                  MOVE +1             TO DC-ELAPSED-MONTHS
004928                  SET BIN-PLUS-ELAPSED  TO TRUE
004929*                 MOVE 6              TO DC-OPTION-CODE
004930                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
004931                  IF NO-CONVERSION-ERROR
004932                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
004933
004934* okay, i had to move the new att age edit down here because the
004935* expiration date could get recalculated and i need the exp date
004936
004937
004938     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
004939        AND (EC-AM-LF-MAX-ATT-AGE > +0)
004940        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
004941        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
004942           AND ZEROS
004943           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
004944           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
004945           SET ELAPSED-BETWEEN-BIN TO TRUE
004946           PERFORM 8500-DATE-CONVERT
004947                                 THRU 8500-EXIT
004948           IF NO-CONVERSION-ERROR
004949              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
004950                 MOVE ER-2669       TO WS-ERROR
004951*                PERFORM 9900-ERROR-FORMAT
004952*                                THRU 9900-EXIT
004953              END-IF
004954           END-IF
004955        ELSE
004956           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
004957           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
004958              MOVE ER-2669       TO WS-ERROR
004959*             PERFORM 9900-ERROR-FORMAT
004960*                                THRU 9900-EXIT
004961           ELSE
004962              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
004963                 MOVE ER-1570    TO WS-ERROR
004964                 PERFORM 9900-ERROR-FORMAT
004965                                 THRU 9900-EXIT
004966              END-IF
004967           END-IF
004968        END-IF
004969
004970        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
004971           AND ZEROS
004972           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
004973           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
004974           SET ELAPSED-BETWEEN-BIN TO TRUE
004975           PERFORM 8500-DATE-CONVERT
004976                                 THRU 8500-EXIT
004977           IF NO-CONVERSION-ERROR
004978              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
004979                 MOVE ER-2669       TO WS-ERROR
004980*                PERFORM 9900-ERROR-FORMAT
004981*                                THRU 9900-EXIT
004982              END-IF
004983           END-IF
004984        ELSE
004985           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
004986             (PB-I-LF-TERM / 12)
004987           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
004988              MOVE ER-2669       TO WS-ERROR
004989*             PERFORM 9900-ERROR-FORMAT
004990*                                THRU 9900-EXIT
004991           ELSE
004992              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
004993                 MOVE ER-1571    TO WS-ERROR
004994                 PERFORM 9900-ERROR-FORMAT
004995                                 THRU 9900-EXIT
004996              END-IF
004997           END-IF
004998        END-IF
004999        IF WS-ERROR = ER-2669
005000           PERFORM 9900-ERROR-FORMAT
005001                                 THRU 9900-EXIT
005002        END-IF
005003
005004     END-IF
005005
005006     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
005007        (PB-I-AH-TERM NOT = ZERO) AND
005008         NOT NO-AH-COVERAGE
005009          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
005010             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
005011             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
005012             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
005013          ELSE
005014             IF WS-LF-EARNINGS-CALC = '4'
005015                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
005016                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
005017                PB-I-PAY-FREQUENCY
005018             ELSE
005019                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
005020                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
005021             END-IF
005022          END-IF
005023          MOVE ZERO                   TO DC-ELAPSED-DAYS
005024                                         DC-ODD-DAYS-OVER
005025          MOVE 1                      TO DC-END-OF-MONTH
005026          SET BIN-PLUS-ELAPSED        TO TRUE
005027*         MOVE 6                      TO DC-OPTION-CODE
005028          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
005029          IF NO-CONVERSION-ERROR
005030             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
005031
005032     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
005033        AND (EC-AM-AH-MAX-ATT-AGE > +0)
005034        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
005035        IF PB-I-BIRTHDAY > LOW-VALUES
005036           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
005037           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
005038           SET ELAPSED-BETWEEN-BIN TO TRUE
005039           PERFORM 8500-DATE-CONVERT
005040                                 THRU 8500-EXIT
005041           IF NO-CONVERSION-ERROR
005042              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
005043                 MOVE ER-3054       TO WS-ERROR
005044*                PERFORM 9900-ERROR-FORMAT
005045*                                THRU 9900-EXIT
005046              END-IF
005047           END-IF
005048        ELSE
005049           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
005050           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
005051              MOVE ER-3054       TO WS-ERROR
005052*             PERFORM 9900-ERROR-FORMAT
005053*                                THRU 9900-EXIT
005054           END-IF
005055        END-IF
005056
005057        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
005058           AND ZEROS
005059           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
005060           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
005061           SET ELAPSED-BETWEEN-BIN TO TRUE
005062           PERFORM 8500-DATE-CONVERT
005063                                 THRU 8500-EXIT
005064           IF NO-CONVERSION-ERROR
005065              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
005066                 MOVE ER-3054       TO WS-ERROR
005067*                PERFORM 9900-ERROR-FORMAT
005068*                                THRU 9900-EXIT
005069              END-IF
005070           END-IF
005071        ELSE
005072           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
005073             (PB-I-AH-TERM / 12)
005074           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
005075              MOVE ER-3054       TO WS-ERROR
005076*             PERFORM 9900-ERROR-FORMAT
005077*                                THRU 9900-EXIT
005078           END-IF
005079        END-IF
005080        IF WS-ERROR = ER-3054
005081           PERFORM 9900-ERROR-FORMAT
005082                                 THRU 9900-EXIT
005083        END-IF
005084
005085     END-IF
005086
005087     MOVE SPACE                       TO DC-END-OF-MONTH.
005088
005089     IF PB-COMPANY-ID = 'NCB'
005090        GO TO 3040-EDIT-EXTENSION-DAYS.
005091
005092     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
005093       AND
005094        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
005095        NEXT SENTENCE
005096     ELSE
005097        GO TO 3040-EDIT-EXTENSION-DAYS.
005098
005099     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
005100        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
005101        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
005102     ELSE
005103        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
005104        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
005105
005106     SET ELAPSED-BETWEEN-BIN TO TRUE.
005107*    MOVE '1'      TO DC-OPTION-CODE
005108     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
005109     IF (NO-CONVERSION-ERROR)
005110        AND (DC-ELAPSED-MONTHS > +1)
005111        AND (WS-AH-BEN-CATEGORY NOT = 'D')
005112        MOVE ER-2668   TO WS-ERROR
005113        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005114
005115 3040-EDIT-EXTENSION-DAYS.
005116
005117     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
005118        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
005119         GO TO 3050-EDIT-TERM-IN-DAYS
005120     ELSE
005121         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
005122
005123     IF PB-I-EXTENTION-DAYS NOT NUMERIC
005124         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
005125     ELSE
005126        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
005127           AND (WS-LF-EARNINGS-CALC NOT = '4')
005128           MOVE ER-2681         TO WS-ERROR
005129           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005130
005131     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
005132        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
005133        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
005134         GO TO 3060-ORIG-TERM-CHECK.
005135
005136     GO TO 3060-ORIG-TERM-CHECK.
005137
005138 3050-EDIT-TERM-IN-DAYS.
005139
005140     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
005141
005142     IF PB-I-TERM-IN-DAYS NOT NUMERIC
005143         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
005144     ELSE
005145         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
005146            MOVE ER-2682         TO WS-ERROR
005147            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005148
005149     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
005150                                       REMAINDER WS-WORK-TERM.
005151     IF WS-WORK-TERM GREATER THAN ZERO
005152         ADD +1 TO PB-I-LF-TERM.
005153
005154     IF NOT NO-AH-COVERAGE
005155         MOVE ER-2684            TO WS-ERROR
005156         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005157
005158
005159 3060-ORIG-TERM-CHECK.
005160
005161******************************************************************
005162*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
005163******************************************************************
005164
005165     IF WS-LF-SPECIAL-CALC-CD = 'O'
005166        NEXT SENTENCE
005167     ELSE
005168        IF NOT NO-LIFE-COVERAGE
005169           IF PB-I-LF-TERM NUMERIC
005170              AND (PB-I-LF-TERM GREATER THAN ZERO)
005171              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
005172              AND (PB-I-LF-TERM NOT GREATER THAN +360)
005173                  NEXT SENTENCE
005174           ELSE
005175              MOVE ER-2647       TO WS-ERROR
005176              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005177
005178     IF NOT NO-AH-COVERAGE
005179         IF PB-I-AH-TERM NUMERIC
005180            AND (PB-I-AH-TERM GREATER THAN ZERO)
005181            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
005182            AND (PB-I-AH-TERM NOT GREATER THAN +360)
005183             NEXT SENTENCE
005184          ELSE
005185              MOVE ER-2658       TO WS-ERROR
005186              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005187
005188     IF PB-COMPANY-ID = 'NCB'
005189        GO TO 3070-LOAN-TERM-CHECK.
005190
005191     IF POLICY-HAS-AH
005192       AND
005193        POLICY-HAS-LIFE
005194       AND
005195        PB-I-LF-TERM NUMERIC
005196       AND
005197        PB-I-AH-TERM NUMERIC
005198        NEXT SENTENCE
005199     ELSE
005200        GO TO 3070-LOAN-TERM-CHECK.
005201
005202     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
005203     IF WS-TEX-FACT-2 LESS THAN +0
005204        MULTIPLY +1 BY WS-TEX-FACT-2.
005205
005206     IF WS-TEX-FACT-2 GREATER THAN +1
005207        MOVE ER-2668             TO WS-ERROR
005208        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005209
005210 3070-LOAN-TERM-CHECK.
005211
005212     IF (WS-LF-BENEFIT-CD = ZERO)
005213         OR (NO-LF-BENEFIT-MATCH)
005214            GO TO 3125-EDIT-PMT-FREQ.
005215
005216*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
005217*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
005218*          AND 'V' AND 'W' AND 'X'
005219*          GO TO 3125-EDIT-PMT-FREQ
005220*       END-IF
005221*    ELSE
005222*       IF WS-AH-DCC-TRUNC = 'T'
005223*          CONTINUE
005224*       ELSE
005225*          GO TO 3125-EDIT-PMT-FREQ
005226*       END-IF
005227*    END-IF
005228
005229
005230
005231     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
005232                    OR
005233        ((PB-COMPANY-ID = 'DCC' or 'VPP')
005234        AND (WS-AH-DCC-TRUNC = 'T'))
005235        CONTINUE
005236     ELSE
005237        GO TO 3125-EDIT-PMT-FREQ
005238     END-IF
005239
005240     IF PB-I-LOAN-TERM NOT NUMERIC
005241         MOVE ZEROS              TO PB-I-LOAN-TERM.
005242
005243     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
005244        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
005245*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
005246        PB-I-LOAN-TERM NOT GREATER THAN +360
005247         NEXT SENTENCE
005248     ELSE
005249         MOVE ER-2648            TO WS-ERROR
005250         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005251
005252     if  PB-I-LOAN-TERM > WS-MAX-TERM
005253        MOVE ER-3058             TO WS-ERROR
005254        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005255     end-if
005256
005257     IF WS-STATE-ABBREVIATION = 'NC'
005258        IF PB-I-LOAN-TERM > +59
005259           CONTINUE
005260        ELSE
005261           MOVE ER-2792          TO WS-ERROR
005262           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005263        END-IF
005264     END-IF
005265
005266     .
005267 3125-EDIT-PMT-FREQ.
005268
005269     IF (WS-LF-BENEFIT-CD = ZERO)
005270         OR (NO-LF-BENEFIT-MATCH)
005271         or (pb-state = 'AL')
005272            GO TO 3127-EDIT-LOAN-OFFICER.
005273
005274     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
005275                    OR
005276        ((PB-COMPANY-ID = 'DCC' or 'VPP')
005277        AND (WS-AH-DCC-TRUNC = 'T'))
005278                    OR
005279         (PB-COMPANY-ID = 'AHL')
005280        CONTINUE
005281     ELSE
005282        IF (PB-I-LOAN-TERM > ZEROS)
005283           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
005284           MOVE ER-1575          TO WS-ERROR
005285           PERFORM 9900-ERROR-FORMAT
005286                                 THRU 9900-EXIT
005287        END-IF
005288     END-IF
005289
005290     IF WS-LF-EARNINGS-CALC NOT = '4'
005291         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
005292            MOVE ER-2653         TO WS-ERROR
005293            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005294            GO TO 3127-EDIT-LOAN-OFFICER
005295         ELSE
005296            GO TO 3127-EDIT-LOAN-OFFICER.
005297
005298     IF PB-I-PAY-FREQUENCY = ZERO OR 1
005299         MOVE ER-2655            TO WS-ERROR
005300         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005301         GO TO 3127-EDIT-LOAN-OFFICER.
005302
005303     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
005304         MOVE ER-2654            TO WS-ERROR
005305         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005306         GO TO 3127-EDIT-LOAN-OFFICER.
005307
005308     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
005309         GIVING WS-TEX-FACT-2
005310             REMAINDER WS-TEX-FACT-3.
005311
005312*    IF WS-TEX-FACT-3 NOT = ZERO
005313*       MOVE ER-2654             TO WS-ERROR
005314*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005315
005316
005317 3127-EDIT-LOAN-OFFICER.
005318
005319     IF WS-EDIT-LOAN-OFC-SW = 'Y'
005320        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
005321           MOVE ER-2690          TO WS-ERROR
005322           PERFORM 9900-ERROR-FORMAT
005323                                 THRU 9900-EXIT
005324        ELSE
005325           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
005326           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
005327           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
005328           MOVE PB-SV-STATE      TO LOFC-STATE
005329           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
005330           MOVE PB-I-LOAN-OFFICER
005331                                 TO LOFC-CODE
005332           PERFORM 8586-READ-LOAN-OFFICER
005333                                 THRU 8586-EXIT
005334           IF (NOT LOFC-MASTER-FOUND)
005335              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
005336              MOVE ER-3006       TO WS-ERROR
005337              PERFORM 9900-ERROR-FORMAT
005338                                 THRU 9900-EXIT
005339           END-IF
005340        END-IF
005341     END-IF
005342
005343     .
005344 3129-EDIT-APR.
005345
005346     IF (WS-LF-BENEFIT-CD = ZERO)
005347        OR (NO-LF-BENEFIT-MATCH)
005348        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
005349           GO TO 3130-EDIT-AGE
005350*       ELSE
005351*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
005352*             GO TO 3130-EDIT-AGE
005353*          END-IF
005354        END-IF
005355     END-IF
005356
005357     IF (WS-STATE-ABBREVIATION = 'OH')
005358         AND (PB-I-RATE-CLASS NOT = 'L ')
005359         AND (PB-I-LF-TERM GREATER THAN 60)
005360         AND (PB-CERT-EFF-DT GREATER WS-831031)
005361         GO TO 3129-APR-CONT.
005362
005363     IF (WS-STATE-ABBREVIATION = 'RI')
005364         AND (PB-I-LF-TERM GREATER THAN 60)
005365         AND (PB-CERT-EFF-DT GREATER WS-831231)
005366         GO TO 3129-APR-CONT.
005367
005368     IF (WS-STATE-ABBREVIATION = 'UT')
005369         AND (PB-I-LF-TERM GREATER THAN 62)
005370         AND (PB-CERT-EFF-DT GREATER WS-810831)
005371         AND (PB-CERT-EFF-DT LESS WS-830901)
005372         GO TO 3129-APR-CONT.
005373
005374     IF PB-COMPANY-ID = 'LAP'
005375        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
005376           IF PB-I-LOAN-APR GREATER THAN ZEROS
005377              MOVE ER-2656         TO WS-ERROR
005378              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005379              GO TO 3130-EDIT-AGE.
005380
005381     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
005382        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
005383        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
005384        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
005385        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
005386        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
005387         GO TO 3130-EDIT-AGE.
005388
005389 3129-APR-CONT.
005390     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
005391         (WS-LF-SPECIAL-CALC-CD = 'M'))
005392         GO TO 3130-EDIT-AGE.
005393
005394     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
005395         WS-AH-BENEFIT-CD (1:1) = 'S')
005396        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
005397        AND (PB-I-LOAN-APR = ZERO)
005398        MOVE ER-2657             TO WS-ERROR
005399        PERFORM 9900-ERROR-FORMAT
005400                                 THRU 9900-EXIT
005401        GO TO 3130-EDIT-AGE
005402     END-IF
005403
005404*    IF PB-I-LOAN-APR = ZERO
005405*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
005406*    END-IF
005407
005408     if pb-i-loan-apr = +99.9999
005409        move er-2656             to ws-error
005410        PERFORM 9900-ERROR-FORMAT
005411                                 THRU 9900-EXIT
005412        GO TO 3130-EDIT-AGE
005413     end-if
005414
005415*    IF PB-I-LOAN-APR = ZERO
005416*       MOVE ER-2656             TO WS-ERROR
005417*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005418*       GO TO 3130-EDIT-AGE.
005419
005420*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
005421     if pb-i-loan-apr not = +99.9999
005422        IF PB-I-LOAN-APR > +30.000
005423           MOVE ER-2657          TO WS-ERROR
005424           PERFORM 9900-ERROR-FORMAT
005425                                 THRU 9900-EXIT
005426        end-if
005427     end-if
005428
005429     .
005430 3130-EDIT-AGE.
005431
005432******************************************************************
005433*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
005434******************************************************************
005435
005436     IF NOT NO-LIFE-COVERAGE
005437        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
005438           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
005439               MOVE ER-2628             TO WS-ERROR
005440               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005441
005442     IF NOT NO-AH-COVERAGE
005443        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
005444           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
005445               MOVE ER-2628         TO WS-ERROR
005446               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005447
005448 3133-SEX-CODE.
005449     IF PB-I-INSURED-SEX = SPACE OR ZERO
005450         IF WS-DEFAULT-SEX = 'M'
005451             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
005452          ELSE
005453             IF WS-DEFAULT-SEX = 'F'
005454             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
005455
005456     IF PB-I-INSURED-SEX = '1'
005457         MOVE 'M' TO PB-I-INSURED-SEX.
005458
005459     IF PB-I-INSURED-SEX = '2'
005460         MOVE 'F' TO PB-I-INSURED-SEX.
005461
005462 3134-SIG-SW-EDIT.
005463     IF PB-I-SIG-SW = SPACE
005464         MOVE 'N'                TO  PB-I-SIG-SW.
005465
005466     IF PB-COMPANY-ID = 'NCL'
005467         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
005468             NEXT SENTENCE
005469         ELSE
005470             MOVE ER-1923        TO  WS-ERROR
005471             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005472     ELSE
005473     IF PB-COMPANY-ID = 'CRI'
005474         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
005475             NEXT SENTENCE
005476         ELSE
005477             MOVE ER-2606        TO  WS-ERROR
005478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005479     ELSE
005480     IF PB-COMPANY-ID = 'TMS'
005481         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
005482             NEXT SENTENCE
005483         ELSE
005484             MOVE ER-2689        TO  WS-ERROR
005485             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005486     ELSE
005487         IF PB-I-SIG-SW = 'Y' OR 'N'
005488             NEXT SENTENCE
005489         ELSE
005490             MOVE ER-2651        TO  WS-ERROR
005491             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005492
005493     IF PB-COMPANY-ID = 'FLA'
005494         IF (WS-EDIT-AGE GREATER 54  OR
005495             WS-AH-EDIT-AGE GREATER 54)  AND
005496            PB-I-SIG-SW = 'N'
005497            MOVE ER-2651         TO  WS-ERROR
005498            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005499
005500 3135-NAME-EDIT.
005501
005502     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
005503        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
005504        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
005505           MOVE PB-I-JOINT-FIRST-NAME (2:9)
005506                                 TO PB-I-JOINT-FIRST-NAME
005507        END-PERFORM
005508     END-IF
005509
005510     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
005511        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
005512        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
005513           MOVE PB-I-JOINT-LAST-NAME (2:14)
005514                                 TO PB-I-JOINT-LAST-NAME
005515        END-PERFORM
005516     END-IF
005517
005518     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
005519        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
005520        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
005521           MOVE PB-I-INSURED-FIRST-NAME (2:9)
005522                                 TO PB-I-INSURED-FIRST-NAME
005523        END-PERFORM
005524     END-IF
005525
005526     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
005527        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
005528        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
005529           MOVE PB-I-INSURED-LAST-NAME (2:14)
005530                                 TO PB-I-INSURED-LAST-NAME
005531        END-PERFORM
005532     END-IF
005533
005534     if PB-I-JOINT-COVERAGE *> and
005535*       pb-i-insured-last-name <> spaces
005536        if pb-i-insured-last-name = pb-i-joint-last-name and
005537           pb-i-insured-first-name = pb-i-joint-first-name and
005538           pb-i-birthday = pb-i-joint-birthday
005539           move er-3069          to ws-error
005540           perform 9900-error-format
005541                                 thru 9900-exit
005542        end-if
005543     end-if
005544
005545     IF PB-I-INSURED-LAST-NAME = SPACES
005546       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
005547       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
005548           MOVE ER-2660    TO WS-ERROR
005549           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005550
005551 3136-EDIT-SEX.
005552
005553******************************************************************
005554*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
005555******************************************************************
005556
005557     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
005558        (WS-AH-SPECIAL-CALC-CD = 'O')
005559        NEXT SENTENCE
005560     ELSE
005561        IF PB-I-INSURED-SEX = 'M' OR 'F'
005562           NEXT SENTENCE
005563        ELSE
005564           MOVE ER-2629            TO WS-ERROR
005565           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005566
005567 3137-EDIT-EFF-DATE.
005568
005569     IF PB-REISSUED-CERT       OR
005570        PB-POLICY-IS-DECLINED  OR
005571        PB-POLICY-IS-VOIDED
005572         GO TO 3139-EDIT-COVERAGE-CODES.
005573
005574     MOVE SPACE                  TO WS-2671-SW
005575                                    WS-2672-SW.
005576
005577     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
005578         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
005579             MOVE ER-2703        TO WS-ERROR
005580             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005581             GO TO 3139-EDIT-COVERAGE-CODES.
005582
005583     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
005584         GO TO 3139-EDIT-COVERAGE-CODES.
005585
005586     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
005587     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
005588*    MOVE '1'                    TO DC-OPTION-CODE.
005589     SET ELAPSED-BETWEEN-BIN     TO TRUE.
005590     MOVE +0                     TO DC-ELAPSED-MONTHS
005591                                    DC-ELAPSED-DAYS.
005592     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
005593
005594     IF DATE-CONVERSION-ERROR
005595         GO TO 3139-EDIT-COVERAGE-CODES.
005596
005597     IF DC-ELAPSED-DAYS GREATER +180
005598         MOVE ER-2672            TO WS-ERROR
005599         MOVE 'Y'                TO WS-2672-SW
005600         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005601     END-IF
005602
005603     IF WS-ERROR = ER-2671  AND
005604        PB-COMPANY-ID  = 'LBL'
005605        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
005606        MOVE SPACE               TO WS-2671-SW
005607        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
005608
005609     IF PB-ISSUE-DATE-FORCED  AND
005610      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
005611         SUBTRACT +1           FROM PB-NO-OF-ERRORS
005612         MOVE ER-2673            TO WS-ERROR
005613         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005614         MOVE SPACE              TO WS-2671-SW
005615                                    WS-2672-SW.
005616
005617     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
005618         IF PB-ISSUE-DATE-FORCED
005619             MOVE ER-2600          TO  WS-ERROR
005620             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005621         ELSE
005622             MOVE ER-2692          TO  WS-ERROR
005623             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005624
005625
005626 3139-EDIT-COVERAGE-CODES.
005627
005628     if pb-company-id not = 'AHL'
005629        IF (WS-LF-SPECIAL-CALC-CD = 'O')
005630           or (ws-ah-special-calc-cd = 'O')
005631           IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
005632              PB-I-LF-ALT-PREMIUM-AMT) > 500000.00
005633              MOVE ER-3071       TO WS-ERROR
005634              PERFORM 9900-ERROR-FORMAT
005635                                 THRU 9900-EXIT
005636           end-if
005637        END-IF
005638     end-if
005639
005640     IF (WS-LF-SPECIAL-CALC-CD NOT = 'O')
005641        and (ws-ah-special-calc-cd not = 'O')
005642        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
005643                                 > 250000.00
005644           MOVE ER-2719          TO WS-ERROR
005645           PERFORM 9900-ERROR-FORMAT
005646                                 THRU 9900-EXIT
005647        END-IF
005648        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
005649           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
005650           MOVE ER-2787          TO WS-ERROR
005651           PERFORM 9900-ERROR-FORMAT
005652                                 THRU 9900-EXIT
005653        END-IF
005654     END-IF
005655
005656     IF PB-POLICY-IS-DECLINED  OR
005657        PB-POLICY-IS-VOIDED
005658         GO TO 3140-EDIT-MAX-AMT-SIZES.
005659
005660     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
005661        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
005662         MOVE ER-2630                TO WS-ERROR
005663         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005664
005665     IF PB-I-LF-BENEFIT-CD = ZERO  AND
005666        PB-I-LF-BENEFIT-AMT = ZERO  AND
005667        PB-I-LF-PREMIUM-AMT = ZERO
005668         GO TO 3140-CHECK-AH-FOR-ZERO.
005669
005670     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
005671        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
005672        PB-I-LF-PREMIUM-AMT NOT = ZERO
005673         GO TO 3140-CHECK-AH-FOR-ZERO.
005674
005675     IF (PB-I-LF-BENEFIT-CD = ZERO)
005676        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
005677        MOVE ER-2631             TO WS-ERROR
005678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005679     END-IF
005680
005681
005682******************************************************************
005683*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
005684******************************************************************
005685
005686     IF WS-LF-SPECIAL-CALC-CD = 'O'
005687        NEXT SENTENCE
005688     ELSE
005689        IF PB-I-LF-BENEFIT-AMT = ZERO
005690           MOVE ER-2632             TO WS-ERROR
005691           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005692
005693
005694******************************************************************
005695*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
005696******************************************************************
005697
005698     IF WS-LF-SPECIAL-CALC-CD = 'O'
005699        CONTINUE
005700     ELSE
005701        IF PB-I-LF-PREMIUM-AMT = ZERO
005702           IF (NOT PB-COMP-LF-PREM)
005703              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
005704              and (ws-lf-ben-category not = 'C')
005705              MOVE ER-2633       TO WS-ERROR
005706              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005707           END-IF
005708        END-IF
005709     END-IF
005710
005711     .
005712 3140-CHECK-AH-FOR-ZERO.
005713
005714     IF PB-I-AH-BENEFIT-CD = ZERO  AND
005715        PB-I-AH-BENEFIT-AMT = ZERO  AND
005716        PB-I-AH-PREMIUM-AMT = ZERO
005717         GO TO 3140-EDIT-MAX-AMT-SIZES.
005718
005719     IF PB-COMPANY-ID = 'CSL'  AND
005720        PB-I-AH-BENEFIT-CD = ZERO  AND
005721        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
005722        PB-I-AH-PREMIUM-AMT = ZERO
005723         GO TO 3140-EDIT-MAX-AMT-SIZES.
005724
005725     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
005726        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
005727        PB-I-AH-PREMIUM-AMT NOT = ZERO
005728         GO TO 3140-EDIT-MAX-AMT-SIZES.
005729
005730     IF PB-I-AH-BENEFIT-CD = ZERO
005731         MOVE ER-2634            TO WS-ERROR
005732         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005733
005734******************************************************************
005735*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
005736******************************************************************
005737
005738     IF WS-AH-SPECIAL-CALC-CD = 'O'
005739        NEXT SENTENCE
005740     ELSE
005741        IF PB-I-AH-BENEFIT-AMT = ZERO
005742           MOVE ER-2635             TO WS-ERROR
005743           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005744
005745******************************************************************
005746*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
005747******************************************************************
005748
005749     IF WS-AH-SPECIAL-CALC-CD = 'O'
005750        NEXT SENTENCE
005751     ELSE
005752        IF PB-I-AH-PREMIUM-AMT = ZERO
005753            IF NOT PB-COMP-AH-PREM
005754                MOVE ER-2636    TO WS-ERROR
005755                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005756
005757
005758 3140-EDIT-MAX-AMT-SIZES.
005759* CUSTOM CODE FOR CLIENT    'DMD'
005760     MOVE ZEROS                   TO WS-RES-STATE-TAX
005761                                     WS-RES-MUNI-TAX
005762                                     PB-I-STATE-TAX
005763                                     PB-I-MUNI-TAX.
005764
005765     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
005766
005767     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
005768        GO TO 3150-RATE-OUTSTAND-BAL.
005769
005770     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
005771        GO TO 3150-RATE-OUTSTAND-BAL.
005772
005773     IF WS-LF-EARNINGS-CALC EQUAL '5'
005774        GO TO 3150-RATE-OUTSTAND-BAL.
005775
005776     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
005777                             OR 'RIC')
005778        GO TO 3150-RATE-OUTSTAND-BAL.
005779
005780     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
005781        IF PB-I-LOAN-APR GREATER THAN ZEROS
005782            GO TO 3150-RATE-OUTSTAND-BAL
005783        ELSE
005784           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
005785               GO TO 3150-RATE-OUTSTAND-BAL.
005786
005787     IF NOT PB-NO-MONTHS-SKIPPED
005788        GO TO 3150-RATE-OUTSTAND-BAL.
005789
005790     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
005791        GO TO 3150-RATE-OUTSTAND-BAL.
005792
005793     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
005794        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
005795           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
005796             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
005797           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
005798           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
005799              MOVE ER-2693     TO WS-ERROR
005800              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005801              GO TO 3150-RATE-OUTSTAND-BAL
005802           ELSE
005803              GO TO 3150-RATE-OUTSTAND-BAL.
005804
005805 3150-RATE-OUTSTAND-BAL.
005806
005807* DMD RATING TEST
005808     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
005809         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
005810         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
005811         MOVE ER-2687                 TO WS-ERROR
005812         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005813         MOVE 'B'                     TO PB-I-OB-FLAG
005814         GO TO 3260-EDIT-CONTINUE.
005815
005816     IF  PB-COMPANY-ID   EQUAL    'CRI'
005817         IF  WS-ERROR    EQUAL    ER-2693
005818             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
005819                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
005820                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
005821                 MOVE  +0            TO  WS-ERROR.
005822
005823     IF  PB-COMPANY-ID   EQUAL    'CDL'
005824         IF  WS-ERROR    EQUAL    ER-2693
005825             IF WS-STATE-ABBREVIATION EQUAL 'NC'
005826                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
005827                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
005828                 MOVE  +0            TO  WS-ERROR.
005829
005830     IF PLAN-MASTER-AH-SW = 'Y'
005831        IF  PB-COMPANY-ID   EQUAL    'CRI'
005832            IF  WS-ERROR    EQUAL    ER-2693
005833              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
005834                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
005835                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
005836                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
005837                 MOVE  ER-1910           TO  WS-ERROR
005838                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
005839
005840     IF PLAN-MASTER-AH-SW = 'Y'
005841        IF  PB-COMPANY-ID   EQUAL    'CRI'
005842            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
005843               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
005844               MOVE  ER-1910           TO  WS-ERROR
005845               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
005846
005847     IF PLAN-MASTER-AH-SW = 'Y'
005848        IF  PB-COMPANY-ID   EQUAL    'CRI'
005849            IF  WS-ERROR    EQUAL    ER-2693
005850                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
005851                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
005852                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
005853                 MOVE  +0       TO  WS-ERROR.
005854
005855     IF WS-ERROR = ER-2693
005856        IF PB-COMPANY-ID = 'JAL' AND
005857           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
005858           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
005859           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
005860
005861     IF WS-ERROR = ER-2693
005862        IF PB-COMPANY-ID = 'NCL'  AND
005863           PB-I-AH-BENEFIT-CD = 'OA'
005864           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
005865           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
005866
005867     IF WS-ERROR = ER-2693
005868        IF PB-COMPANY-ID = 'CNL' AND
005869           PB-I-LF-BENEFIT-CD = '71' OR '72'
005870           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
005871           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
005872
005873     IF WS-ERROR = ER-2693
005874        IF PB-COMPANY-ID = 'HER'
005875           IF WS-LEVEL
005876              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
005877              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
005878
005879     IF ((LF-BENEFIT-FOUND) AND
005880         (NOT NO-LIFE-COVERAGE)  AND
005881         (WS-LF-SPECIAL-CALC-CD = 'O'))
005882       OR   ((AH-BENEFIT-FOUND) AND
005883             (NOT NO-AH-COVERAGE)    AND
005884             (WS-AH-SPECIAL-CALC-CD = 'O'))
005885         NEXT SENTENCE
005886     ELSE
005887         GO TO 3215-EDIT-RATES.
005888
005889     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
005890        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
005891           MOVE ER-2674          TO WS-ERROR
005892           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005893           GO TO 3215-EDIT-RATES.
005894
005895     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
005896        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
005897           MOVE ER-2674          TO WS-ERROR
005898           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005899           GO TO 3215-EDIT-RATES.
005900
005901     MOVE 'B'                    TO PB-I-OB-FLAG.
005902
005903     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
005904         NEXT SENTENCE
005905     ELSE
005906         IF NOT NO-LIFE-COVERAGE
005907             IF WS-ACCT-LF-OB-RT = ZERO
005908                MOVE ER-2641    TO WS-ERROR
005909                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005910
005911     IF PB-COMPANY-ID = 'CRI'
005912       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
005913         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
005914         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
005915         IF WS-ERROR = ER-2675
005916            SUBTRACT +1               FROM PB-NO-OF-ERRORS
005917            MOVE ER-2687              TO WS-ERROR
005918            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005919         ELSE
005920            MOVE ER-2687              TO WS-ERROR
005921            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005922
005923
005924     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
005925         NEXT SENTENCE
005926     ELSE
005927       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
005928            NEXT SENTENCE
005929       ELSE
005930         IF NOT NO-AH-COVERAGE
005931             IF WS-ACCT-AH-OB-RT = ZERO
005932                MOVE ER-2642    TO WS-ERROR
005933                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005934
005935     IF PB-COMPANY-ID = 'CRI'
005936       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
005937         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
005938         IF WS-ERROR = ER-2676
005939            SUBTRACT +1               FROM PB-NO-OF-ERRORS
005940            MOVE ER-2687              TO WS-ERROR
005941            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
005942         ELSE
005943            MOVE ER-2687              TO WS-ERROR
005944            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
005945
005946     IF PB-COMPANY-ID NOT = 'GIC'
005947         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
005948            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
005949     ELSE
005950         IF PB-I-LF-PREM-CALC = ZEROS
005951             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
005952                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
005953
005954     IF PB-COMPANY-ID NOT = 'GIC'
005955         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
005956            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
005957     ELSE
005958         IF PB-I-AH-PREM-CALC = ZEROS
005959             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
005960                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
005961
005962     MOVE ZEROS TO PB-I-MORT-CODE.
005963
005964     GO TO 3260-EDIT-CONTINUE.
005965
005966
005967 3215-EDIT-RATES.
005968     IF ACCOUNT-MAST-FOUND
005969         NEXT SENTENCE
005970     ELSE
005971         GO TO 3999-END-EDIT.
005972
005973 3220-CHECK-LF-RATES.
005974
005975     IF PB-COMPANY-ID = 'DCC' or 'VPP'
005976        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
005977        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
005978        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
005979           AND (NOT WS-LF-CASH))
005980                           OR
005981           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
005982           AND (NOT WS-AH-CASH)))
005983                       AND
005984           (PB-I-ENTRY-STATUS NOT = '5')
005985           MOVE 'M'              TO PB-BATCH-ENTRY
005986                                    PB-I-ENTRY-STATUS
005987        END-IF
005988     END-IF
005989
005990
005991
005992     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
005993                                    PB-I-AH-PREM-CALC
005994                                    PB-I-LF-ALT-PREM-CALC
005995                                    PB-I-LF-ALT-RATE
005996                                    PB-I-LF-REI-RATE
005997                                    PB-I-LF-ALT-REI-RATE
005998                                    PB-I-AH-REI-RATE
005999                                    PB-I-TOT-FEES-CALC.
006000
006001     IF PB-COMPANY-ID EQUAL 'DMD'
006002        NEXT SENTENCE
006003     ELSE
006004        MOVE ZEROS               TO PB-I-LF-RATE
006005                                    PB-I-AH-RATE.
006006
006007     IF PB-I-TOT-FEES NOT NUMERIC
006008        MOVE ZEROS               TO PB-I-TOT-FEES
006009     END-IF
006010
006011     IF PB-I-LIVES NOT NUMERIC
006012         MOVE ZERO               TO PB-I-LIVES.
006013
006014     IF PB-I-NUM-BILLED NOT NUMERIC
006015         MOVE ZERO               TO PB-I-NUM-BILLED.
006016
006017     IF PB-I-LF-PREM-TAX NOT NUMERIC
006018        MOVE +0                  TO PB-I-LF-PREM-TAX
006019     END-IF
006020
006021     IF PB-I-AH-PREM-TAX NOT NUMERIC
006022        MOVE +0                  TO PB-I-AH-PREM-TAX
006023     END-IF
006024
006025     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
006026        PB-I-PAY-FREQUENCY = ZEROS
006027            MOVE 12 TO CP-PAY-FREQUENCY
006028     ELSE
006029            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
006030
006031     IF PB-I-STATE-TAX NOT NUMERIC
006032         MOVE ZEROS               TO PB-I-STATE-TAX.
006033
006034     IF PB-I-MUNI-TAX NOT NUMERIC
006035         MOVE ZEROS               TO PB-I-MUNI-TAX.
006036
006037     MOVE SPACES                 TO CP-BEN-CATEGORY
006038     IF PB-COMPANY-ID  = 'CSL'  AND
006039        PB-I-LF-TERM NOT = ZERO
006040        COMPUTE WS-PAYMENT-AMT =
006041             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
006042        COMPUTE WS-CSL-AMT1 =
006043             PB-I-LF-TERM * AM-MAX-MON-BEN
006044        COMPUTE WS-CSL-AMT2 =
006045             WS-PAYMENT-AMT * PB-I-LF-TERM
006046        IF CP-PAY-FREQUENCY NOT = 12
006047           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
006048           MOVE '8' TO WS-CSL-CALC-CD
006049        ELSE
006050           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
006051              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
006052               AM-MAX-TOT-BEN
006053               MOVE '6' TO WS-CSL-CALC-CD
006054           ELSE
006055              IF (WS-CSL-AMT1  GREATER THAN
006056                 AM-MAX-TOT-BEN) AND
006057                 (WS-CSL-AMT2  GREATER THAN
006058                 AM-MAX-TOT-BEN)
006059                 MOVE '7' TO WS-CSL-CALC-CD
006060              ELSE
006061                 MOVE '5' TO WS-CSL-CALC-CD.
006062
006063     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
006064         NEXT SENTENCE
006065     ELSE
006066         GO TO 3300-CHECK-AH-RATES.
006067
006068*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
006069
006070     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
006071        IF (PB-I-LF-CRIT-PER    EQUAL +0)
006072              OR
006073           (PB-I-PAYMENT-AMOUNT EQUAL +0)
006074           MOVE ER-2618          TO WS-ERROR
006075           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006076           GO TO 3300-CHECK-AH-RATES.
006077
006078     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
006079           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
006080                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
006081
006082     IF WS-LF-SPECIAL-CALC-CD = 'M'
006083         MOVE ER-2687             TO WS-ERROR
006084         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006085         MOVE 'Z000'              TO PB-I-MORT-CODE
006086         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
006087         GO TO 3300-CHECK-AH-RATES.
006088
006089     IF WS-LF-SPECIAL-CALC-CD = 'Z'
006090        IF PB-I-LIVES = ZERO
006091           MOVE ER-2688          TO WS-ERROR
006092           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006093
006094     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
006095
006096     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
006097     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
006098     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
006099     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
006100     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
006101     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
006102     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
006103     MOVE '3'                    TO CP-PROCESS-TYPE.
006104     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
006105     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
006106
006107******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
006108     IF PB-COMPANY-ID EQUAL 'CDL'
006109         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
006110            CP-EARN-AS-NET-PAY)
006111             IF PB-CERT-EFF-DT GREATER  WS-931231
006112                 MOVE '1'        TO CP-EARNING-METHOD.
006113*******
006114
006115     MOVE PB-SV-STATE            TO CP-STATE.
006116     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
006117     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
006118     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
006119     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
006120     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
006121                                    CP-RATING-BENEFIT-AMT.
006122     IF CP-STATE-STD-ABBRV = 'OR'
006123         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
006124                                         PB-I-LF-ALT-BENEFIT-AMT.
006125     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
006126     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
006127     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
006128     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
006129     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
006130     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
006131     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
006132     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
006133     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
006134                                    CP-REMAINING-TERM
006135                                    CP-LOAN-TERM.
006136
006137     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
006138         NEXT SENTENCE
006139     ELSE
006140         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
006141             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
006142                                           PB-I-LF-PREMIUM-AMT.
006143
006144     IF PB-COMPANY-ID EQUAL 'CSL'
006145        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
006146           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
006147                                         PB-I-LF-PREMIUM-AMT.
006148
006149     IF PB-COMPANY-ID EQUAL 'NCB'
006150         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
006151            CP-EARN-AS-NET-PAY
006152             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
006153                 PB-I-LF-PREMIUM-AMT.
006154
006155     IF (CP-TRUNCATED-LIFE)
006156        or ((pb-company-id = 'AHL')
006157           and (pb-i-loan-term > pb-i-lf-term))
006158        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
006159
006160     IF PB-COMPANY-ID EQUAL 'CRI'
006161        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
006162
006163     IF CP-TERM-IS-DAYS
006164         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
006165     ELSE
006166         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
006167
006168     IF PB-COMPANY-ID = 'DCC' or 'VPP'
006169        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
006170        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
006171        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
006172        IF WS-LF-BEN-CATEGORY = 'D'
006173           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
006174           MOVE PB-I-LIFE-COMMISSION
006175                                 TO CP-DCC-ACT-COMM
006176           MOVE WS-LF-BEN-CATEGORY
006177                                 TO CP-BEN-CATEGORY
006178        END-IF
006179        IF (CP-BENEFIT-CD (1:1) = 'P')
006180           AND (PB-I-LOAN-TERM NOT = ZEROS)
006181           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
006182           add pb-i-ah-premium-amt to cp-original-premium
006183        END-IF
006184     END-IF
006185
006186     IF PB-COMPANY-ID = 'CSL'
006187         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
006188         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
006189         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
006190
006191     IF PB-COMPANY-ID = 'CSL'
006192        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
006193
006194     IF (CP-SPECIAL-CALC-CD = 'H')
006195        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
006196         MOVE PB-I-LF-ALT-BENEFIT-AMT
006197                                    TO CP-ALTERNATE-BENEFIT
006198         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
006199
006200     if (pb-company-id = 'CID')
006201        and (ws-lf-earnings-calc = '4')
006202        and (cp-state-std-abbrv = 'MN' OR 'WA' or 'AL')
006203        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
006204        move pb-i-term-type      to cp-pmt-mode
006205        move pb-i-no-of-payments to cp-no-of-pmts
006206        move pb-i-ah-benefit-amt to cp-monthly-payment
006207     end-if
006208
006209     move ws-net-only-state      to cp-net-only-state
006210     IF (PB-COMPANY-ID = 'CID')
006211        AND (WS-LF-EARNINGS-CALC = 'B')
006212        AND (CP-STATE-STD-ABBRV = 'MN')
006213        MOVE PB-I-LF-ALT-BENEFIT-AMT
006214                                 TO CP-ALTERNATE-BENEFIT
006215        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
006216     END-IF
006217
006218     IF (PB-COMPANY-ID = 'CID')
006219        AND (WS-LF-EARNINGS-CALC = 'B')
006220        MOVE PB-I-LF-ALT-BENEFIT-AMT
006221                                 TO CP-ALTERNATE-BENEFIT
006222        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
006223        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
006224*       compute cp-original-benefit = pb-i-lf-benefit-amt -
006225*         pb-i-lf-alt-premium-amt
006226        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
006227        IF WS-LF-BEN-CATEGORY = 'P'
006228           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
006229        ELSE
006230           IF WS-LF-BEN-CATEGORY = 'I'
006231              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
006232           END-IF
006233        END-IF
006234     END-IF
006235
006236     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
006237     MOVE 'R'                   TO CP-RATE-FILE.
006238     PERFORM 7000-GET-RATE THRU 7000-EXIT.
006239
006240     IF CP-ERROR-RATE-NOT-FOUND
006241        MOVE ER-2641            TO WS-ERROR
006242        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006243        GO TO 3300-CHECK-AH-RATES.
006244
006245     IF PB-COMPANY-ID EQUAL 'CRI'
006246        IF CP-ERROR-NO-LIMITS-CRI
006247           IF NOT ACCOUNT-LIFE-CHECKED
006248              MOVE ER-2607      TO WS-ERROR
006249              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006250
006251
006252******************************************************************
006253*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
006254*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
006255******************************************************************
006256
006257* CALC LIFE AGE AT EXPIRATION.
006258
006259     COMPUTE WS-AGE-AT-EXPIRE =
006260          ((PB-I-LF-TERM / 12) + PB-I-AGE).
006261
006262*    IF PB-STATE = 'CO' OR 'UT'
006263*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
006264*        MOVE 'F'            TO PB-FATAL-FLAG
006265*        MOVE ER-2709        TO WS-ERROR
006266*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006267*        GO TO PREMIUM-EDITING-IS-BYPASSED.
006268
006269*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
006270*        MOVE 'X'            TO PB-FATAL-FLAG
006271*        MOVE ER-2718        TO WS-ERROR
006272*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006273*        GO TO PREMIUM-EDITING-IS-BYPASSED.
006274
006275* CALC A & H AGE AT EXPIRATION.
006276
006277     COMPUTE WS-AGE-AT-EXPIRE =
006278          ((PB-I-AH-TERM / 12) + PB-I-AGE).
006279
006280*    IF PB-STATE = 'CO' OR 'UT'
006281*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
006282*        MOVE 'F'            TO PB-FATAL-FLAG
006283*        MOVE ER-2709        TO WS-ERROR
006284*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006285*        GO TO PREMIUM-EDITING-IS-BYPASSED.
006286
006287*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
006288*        MOVE 'X'            TO PB-FATAL-FLAG
006289*        MOVE ER-2718        TO WS-ERROR
006290*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006291*        GO TO PREMIUM-EDITING-IS-BYPASSED.
006292
006293     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
006294        GO TO 3221-CHECK-ERROR-RATE-OPEN.
006295
006296     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
006297        and (not pb-monthly-cert)
006298        GO TO 3221-CHECK-ERROR-RATE-OPEN
006299     end-if
006300
006301     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
006302        GO TO 3221-CHECK-ERROR-RATE-OPEN.
006303
006304     IF CP-ERROR-AMT-OUTSIDE-LIMIT
006305         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
006306         MOVE ER-2639        TO WS-ERROR
006307         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006308
006309
006310******************************************************************
006311*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
006312******************************************************************
006313
006314 PREMIUM-EDITING-IS-BYPASSED.
006315
006316     IF (CP-R-MAX-ATT-AGE NUMERIC)
006317        AND (CP-R-MAX-ATT-AGE > +0)
006318        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
006319        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
006320           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
006321           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
006322           MOVE '1'              TO DC-OPTION-CODE
006323           PERFORM 8500-DATE-CONVERT
006324                                 THRU 8500-EXIT
006325           IF NO-CONVERSION-ERROR
006326              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
006327                 MOVE ER-2661       TO WS-ERROR
006328*                PERFORM 9900-ERROR-FORMAT
006329*                                THRU 9900-EXIT
006330              END-IF
006331           END-IF
006332        ELSE
006333           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
006334           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
006335              MOVE ER-2661       TO WS-ERROR
006336*             PERFORM 9900-ERROR-FORMAT
006337*                                THRU 9900-EXIT
006338           ELSE
006339              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
006340                 MOVE ER-1570    TO WS-ERROR
006341                 PERFORM 9900-ERROR-FORMAT
006342                                 THRU 9900-EXIT
006343              END-IF
006344           END-IF
006345        END-IF
006346
006347        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
006348           MOVE PB-I-JOINT-BIRTHDAY
006349                                 TO DC-BIN-DATE-1
006350           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
006351           MOVE '1'              TO DC-OPTION-CODE
006352           PERFORM 8500-DATE-CONVERT
006353                                 THRU 8500-EXIT
006354           IF NO-CONVERSION-ERROR
006355              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
006356                 MOVE ER-2661       TO WS-ERROR
006357*                PERFORM 9900-ERROR-FORMAT
006358*                                THRU 9900-EXIT
006359              END-IF
006360           ELSE
006361              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
006362           END-IF
006363        ELSE
006364           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
006365             (PB-I-LF-TERM / 12)
006366           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
006367              MOVE ER-2661       TO WS-ERROR
006368*             PERFORM 9900-ERROR-FORMAT
006369*                                THRU 9900-EXIT
006370           ELSE
006371              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
006372                 MOVE ER-1571    TO WS-ERROR
006373                 PERFORM 9900-ERROR-FORMAT
006374                                 THRU 9900-EXIT
006375              END-IF
006376           END-IF
006377        END-IF
006378        IF WS-ERROR = ER-2661
006379           PERFORM 9900-ERROR-FORMAT
006380                                 THRU 9900-EXIT
006381        END-IF
006382     END-IF
006383
006384*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
006385*       MOVE ER-2661             TO WS-ERROR
006386*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006387
006388     IF CP-ERROR-AGE-OUTSIDE-LIMIT
006389        MOVE ER-2662             TO WS-ERROR
006390        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006391
006392     IF CP-ERROR-TERM-OUTSIDE-LIMIT
006393        MOVE ER-2677             TO WS-ERROR
006394        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006395
006396     IF CP-ERROR-LOAN-TERM
006397        MOVE ER-2648             TO WS-ERROR
006398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006399
006400     if cp-error-term-below-minimum
006401        move er-3070             to ws-error
006402        perform 9900-error-format thru 9900-exit
006403     end-if
006404
006405     .
006406 3221-CHECK-ERROR-RATE-OPEN.
006407
006408     IF CP-ERROR-RATE-FILE-NOTOPEN
006409         GO TO 3990-FILES-NOT-OPEN.
006410
006411     IF PB-COMPANY-ID NOT = 'DMD'
006412        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
006413     END-IF
006414
006415     .
006416 3221-CONTINUE.
006417     MOVE ZEROS                  TO WS-DCC-LF-RATE
006418                                    WS-DCC-AH-RATE
006419
006420     IF PB-COMPANY-ID = 'DCC' or 'VPP'
006421        IF WS-LF-BEN-CATEGORY = 'D'
006422           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
006423              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
006424        END-IF
006425     END-IF
006426
006427     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
006428
006429*   X'A4FF' = 12/31/2009
006430     IF (PB-COMPANY-ID = 'CID')
006431        AND (WS-LF-EARNINGS-CALC = 'B')
006432        AND (CP-STATE-STD-ABBRV = 'MN')
006433        AND (PB-CERT-EFF-DT > X'A4FF')
006434        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
006435     END-IF
006436
006437     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
006438
006439     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
006440     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
006441        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
006442        AND (PB-I-POLICY-IS-MONTHLY)
006443        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
006444        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
006445     END-IF
006446     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
006447     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
006448     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
006449     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
006450
006451     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
006452        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
006453        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
006454        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
006455        MOVE ER-2786             TO WS-ERROR
006456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006457     END-IF
006458
006459     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
006460
006461******************************************************************
006462*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
006463******************************************************************
006464     IF (WS-LF-SPECIAL-CALC-CD = 'E')
006465        and ((not pb-monthly-cert)
006466        or (ws-lf-ben-category = 'C'))
006467        GO TO 3225-CHECK-ALT-LIFE-RATE.
006468
006469     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
006470        GO TO 3225-CHECK-ALT-LIFE-RATE
006471     ELSE
006472       IF PB-I-LF-RATE = ZERO
006473          MOVE ER-2641          TO WS-ERROR
006474          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006475
006476 3225-CHECK-ALT-LIFE-RATE.
006477
006478     IF (PB-COMPANY-ID EQUAL 'GTL') AND
006479        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
006480        (CP-SPECIAL-CALC-CD EQUAL 'H')
006481         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
006482
006483     IF (WS-LF-EARNINGS-CALC NOT = 'B')
006484         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
006485             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
006486                   OR
006487              (PB-I-LF-ALT-PREMIUM-AMT > +0
006488              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
006489              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
006490             MOVE ER-2720        TO  WS-ERROR
006491             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006492             GO TO 3225-RATING-CONT
006493         ELSE
006494             GO TO 3225-RATING-CONT.
006495
006496     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
006497        AND (AM-GPCD = 01 OR 06 OR 15)
006498        MOVE ER-2798             TO WS-ERROR
006499        PERFORM 9900-ERROR-FORMAT
006500                                 THRU 9900-EXIT
006501*       GO TO 3225-RATING-CONT
006502     END-IF
006503
006504     if (pb-company-id = 'CID')
006505        and (ws-lf-earnings-calc = 'B')
006506        and (ws-lf-ben-category = 'P' or 'I')
006507        and (ws-net-only-state = 'Y')
006508        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
006509*       display ' balloon prem ' pb-i-lf-alt-prem-calc
006510        go to 3225-rating-cont
006511     end-if
006512
006513     IF (PB-COMPANY-ID = 'CID')
006514        AND (WS-LF-EARNINGS-CALC = 'B')
006515        AND (CP-STATE-STD-ABBRV = 'MN')
006516        AND (PB-CERT-EFF-DT > X'A4FF')
006517        GO TO 3225-RATING-CONT
006518     END-IF
006519
006520     IF PB-COMPANY-ID = 'DCC' or 'VPP'
006521        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
006522           AND (PB-I-POLICY-IS-MONTHLY)
006523           GO TO 3225-RATING-CONT
006524        END-IF
006525     END-IF
006526
006527     IF PB-COMPANY-ID EQUAL 'WDS' AND
006528        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
006529        CP-EARN-AS-REG-BALLOON
006530        NEXT SENTENCE
006531     ELSE
006532        MOVE '2'                 TO CP-EARNING-METHOD.
006533
006534 3225-SET-ALT-LIFE-RATE-LOOKUP.
006535
006536     MOVE 'L'                    TO CP-BENEFIT-TYPE.
006537
006538     IF (PB-COMPANY-ID EQUAL 'GTL') AND
006539        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
006540        (CP-SPECIAL-CALC-CD EQUAL 'H')
006541         NEXT SENTENCE
006542     ELSE
006543         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
006544
006545     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
006546     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
006547     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
006548                                     CP-RATING-BENEFIT-AMT.
006549     IF CP-STATE-STD-ABBRV = 'OR'
006550         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
006551                                         PB-I-LF-ALT-BENEFIT-AMT.
006552
006553     IF PB-COMPANY-ID = 'DCC' or 'VPP'
006554        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
006555     END-IF
006556
006557     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
006558     MOVE ZERO                   TO CP-CRITICAL-MONTHS
006559     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
006560                                    CP-REMAINING-TERM
006561                                    CP-LOAN-TERM.
006562     IF WS-LF-SPECIAL-CALC-CD = 'L'
006563        ADD +1                   TO CP-ORIGINAL-TERM
006564                                    CP-REMAINING-TERM
006565                                    CP-LOAN-TERM.
006566
006567     MOVE 'R'                   TO CP-RATE-FILE.
006568     PERFORM 7000-GET-RATE THRU 7000-EXIT.
006569
006570     IF CP-ERROR-RATE-NOT-FOUND
006571         MOVE ER-2641            TO WS-ERROR
006572         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006573         GO TO 3300-CHECK-AH-RATES.
006574
006575     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
006576     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
006577
006578     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
006579         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
006580
006581     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
006582                               + PB-I-LF-ALT-BENEFIT-AMT.
006583
006584     IF ACCOUNT-LIFE-CHECKED  OR
006585        PB-POLICY-IS-VOIDED   OR
006586        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
006587        and (not pb-monthly-cert))
006588        GO TO 3225-CONTINUE.
006589
006590     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
006591        GO TO 3225-CONTINUE.
006592
006593     IF WS-LF-BENEFIT-AMT  GREATER THAN
006594                             EC-RT-LF-MAX-TOT-BEN
006595        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
006596        MOVE ER-2639       TO WS-ERROR
006597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006598
006599 3225-CONTINUE.
006600     IF PB-I-LF-ALT-RATE = ZERO
006601         MOVE ER-2659            TO WS-ERROR
006602         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006603
006604     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
006605        PB-I-LF-ALT-PREMIUM-AMT = ZERO
006606        MOVE ER-2698             TO WS-ERROR
006607        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006608
006609 3225-RATING-CONT.
006610
006611     IF (WS-LF-SPECIAL-CALC-CD = 'E')
006612        and (not pb-monthly-cert)
006613         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
006614         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
006615         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
006616            AND (AM-DCC-PRODUCT-CODE = 'DDF')
006617            CONTINUE
006618         ELSE
006619            MOVE ER-2687         TO WS-ERROR
006620            PERFORM 9900-ERROR-FORMAT
006621                                 THRU 9900-EXIT
006622         END-IF
006623         GO TO 3290-EDIT-LF-REIN-RATE
006624     END-IF
006625
006626* DMD RATING TEST
006627     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
006628         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
006629         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
006630         MOVE ER-2687                 TO WS-ERROR
006631         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006632         GO TO 3290-EDIT-LF-REIN-RATE.
006633
006634 3230-CLIENT-MORT-CD-SPECIALS.
006635
006636     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
006637     SET BIN-TO-GREG          TO TRUE.
006638*    MOVE ' '                 TO DC-OPTION-CODE.
006639     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
006640     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
006641
006642 C-POS-3230-MORT-CD.
006643     IF PB-COMPANY-ID = 'POS' AND
006644        PB-SV-CARRIER = '2'
006645         NEXT SENTENCE
006646     ELSE
006647         GO TO C-POS-3240-MORT-CD.
006648
006649     IF PB-SV-GROUPING = '030'
006650        AND PB-CERT-EFF-DT GREATER THAN WS-791231
006651         MOVE '2350' TO PB-I-MORT-CODE
006652      ELSE
006653         MOVE '3300' TO PB-I-MORT-CODE.
006654
006655
006656 C-POS-3240-MORT-CD.
006657     IF PB-COMPANY-ID = 'POS' AND
006658        PB-SV-CARRIER = '1'
006659         NEXT SENTENCE
006660     ELSE
006661         GO TO 3230-CONTINUE.
006662
006663     IF PB-SV-STATE = '45' OR '47'
006664        OR PB-CERT-EFF-DT LESS THAN WS-771001
006665         MOVE '5200' TO PB-I-MORT-CODE
006666     ELSE
006667         MOVE '8300' TO PB-I-MORT-CODE.
006668
006669 3230-CONTINUE.
006670
006671     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
006672        GO TO 3240-CONTINUE
006673     END-IF
006674
006675     IF PB-CERT-EFF-DT > WS-971231
006676        GO TO 3240-CONTINUE
006677     END-IF
006678
006679     IF LF-BENEFIT-FOUND AND
006680        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
006681         MOVE 'F250'       TO PB-I-MORT-CODE
006682     ELSE
006683         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
006684             MOVE '7250'   TO PB-I-MORT-CODE
006685         ELSE
006686             MOVE '4251'   TO PB-I-MORT-CODE
006687         END-IF
006688     END-IF
006689
006690     .
006691 3240-CONTINUE.
006692
006693     IF PB-COMPANY-ID NOT = 'GNL'
006694         GO TO 3256-CONTINUE.
006695
006696     IF PB-CERT-EFF-DT  LESS THAN WS-820301
006697         MOVE 'A300' TO PB-I-MORT-CODE
006698     ELSE
006699         MOVE '8350' TO PB-I-MORT-CODE.
006700
006701 3256-CONTINUE.
006702     IF PB-COMPANY-ID NOT = 'ABL'
006703         GO TO 3260-EDIT-CONTINUE.
006704
006705     IF PB-I-LF-TERM GREATER THAN 59
006706         MOVE 'F550' TO PB-I-MORT-CODE
006707     ELSE
006708         MOVE 'E550' TO PB-I-MORT-CODE.
006709
006710 3260-EDIT-CONTINUE.
006711     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
006712
006713 3290-EDIT-LF-REIN-RATE.
006714     IF LF-REIN-NSP-NOT-USED
006715         GO TO 3290-RATING-CONT.
006716
006717     IF PB-COMPANY-ID = 'DCC' or 'VPP'
006718        GO TO 3290-RATING-CONT.
006719
006720     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
006721     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
006722     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
006723     MOVE '3'                   TO CP-PROCESS-TYPE.
006724     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
006725
006726******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
006727     IF PB-COMPANY-ID EQUAL 'CDL'
006728         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
006729            CP-EARN-AS-NET-PAY)
006730             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
006731*            MOVE SPACE          TO DC-OPTION-CODE
006732             SET BIN-TO-GREG     TO TRUE
006733             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
006734***  Y2K PROJ 7744
006735             IF DC-GREG-DATE-CYMD GREATER 19931231
006736                 MOVE '1'        TO CP-EARNING-METHOD.
006737***  Y2K PROJ 7744
006738*******
006739
006740     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
006741     MOVE PB-SV-STATE           TO CP-STATE.
006742     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
006743     MOVE ZERO                  TO CP-DEVIATION-CODE
006744                                   CP-RATE-DEV-PCT.
006745     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
006746     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
006747                                   CP-RATING-BENEFIT-AMT.
006748
006749************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
006750     IF PB-COMPANY-ID EQUAL 'NCB'
006751         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
006752            CP-EARN-AS-NET-PAY
006753             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
006754                 PB-I-LF-PREMIUM-AMT.
006755************
006756
006757     IF CP-STATE-STD-ABBRV = 'OR'
006758         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
006759                                         PB-I-LF-ALT-BENEFIT-AMT.
006760     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
006761     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
006762     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
006763     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
006764     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
006765     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
006766     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
006767     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
006768                                   CP-REMAINING-TERM
006769                                   CP-LOAN-TERM.
006770     IF CP-TRUNCATED-LIFE
006771        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
006772
006773     IF CP-TERM-IS-DAYS
006774         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
006775     ELSE
006776         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
006777
006778
006779     IF PB-COMPANY-ID = 'DCC' or 'VPP'
006780        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
006781     END-IF
006782
006783     IF PB-COMPANY-ID NOT = 'TIC'
006784          MOVE ZERO          TO CP-CLASS-CODE.
006785
006786     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
006787
006788     MOVE 'R'                   TO CP-RATE-FILE.
006789     PERFORM 7000-GET-RATE THRU 7000-EXIT.
006790
006791     IF CP-ERROR-RATE-NOT-FOUND
006792        IF PB-I-OB
006793           MOVE ER-2625      TO WS-ERROR
006794           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006795           GO TO 3299-EDIT-CONTINUE
006796        ELSE
006797           MOVE ER-2643      TO WS-ERROR
006798           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006799           GO TO 3299-EDIT-CONTINUE.
006800
006801     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
006802
006803     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
006804     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
006805
006806     IF PB-I-LF-REI-RATE = ZERO
006807         MOVE ER-2643        TO WS-ERROR
006808         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006809
006810 3290-CHECK-ALT-REIN-RATE.
006811
006812     IF WS-LF-EARNINGS-CALC NOT = 'B'
006813        GO TO 3290-RATING-CONT.
006814
006815     MOVE 'L'                    TO CP-BENEFIT-TYPE.
006816     MOVE '2'                    TO CP-EARNING-METHOD.
006817     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
006818     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
006819     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
006820     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
006821                                     CP-RATING-BENEFIT-AMT.
006822     IF CP-STATE-STD-ABBRV = 'OR'
006823         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
006824                                         PB-I-LF-ALT-BENEFIT-AMT.
006825
006826     IF PB-COMPANY-ID = 'DCC' or 'VPP'
006827        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
006828     END-IF
006829
006830     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
006831     MOVE ZERO                   TO CP-CRITICAL-MONTHS
006832     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
006833                                    CP-REMAINING-TERM
006834                                    CP-LOAN-TERM.
006835     IF WS-LF-SPECIAL-CALC-CD = 'L'
006836        ADD +1                   TO CP-ORIGINAL-TERM
006837                                    CP-REMAINING-TERM
006838                                    CP-LOAN-TERM.
006839
006840     MOVE 'R'                   TO CP-RATE-FILE.
006841     PERFORM 7000-GET-RATE THRU 7000-EXIT.
006842
006843     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
006844
006845     IF PB-I-LF-ALT-REI-RATE = ZERO
006846         MOVE ER-2643            TO WS-ERROR
006847         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006848
006849 3290-RATING-CONT.
006850
006851     IF PB-I-OB
006852*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
006853        GO TO 3300-CHECK-AH-RATES.
006854
006855 3299-EDIT-CONTINUE.
006856
006857     IF  PB-I-MORT-CODE GREATER THAN SPACES
006858         NEXT SENTENCE
006859     ELSE
006860         MOVE ER-2620           TO WS-ERROR
006861         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
006862
006863 3300-CHECK-AH-RATES.
006864     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
006865         NEXT SENTENCE
006866     ELSE
006867         GO TO 3340-CALCULATE-PREMIUM-AMT.
006868
006869     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
006870        and (not pb-monthly-cert))
006871                  or
006872        ((CF-COMPANY-ID = 'DMD') AND
006873                (NO-DMD-RATING))
006874         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
006875            AND (AM-DCC-PRODUCT-CODE = 'DDF')
006876            CONTINUE
006877         ELSE
006878            MOVE ER-2687         TO WS-ERROR
006879            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006880         END-IF
006881         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
006882         GO TO 3335-EDIT-AH-REIN-NSP-RATE
006883     END-IF
006884
006885     IF PB-I-OB
006886        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
006887
006888     IF WS-AH-SPECIAL-CALC-CD = 'M'
006889         MOVE ER-2687             TO WS-ERROR
006890         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006891         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
006892         GO TO 3999-END-EDIT.
006893
006894*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
006895
006896     if pb-company-id = 'AHL'
006897        go to 3300-skip-crit-per
006898     end-if
006899
006900     if (pb-i-ah-crit-per not = zeros)
006901        and (ws-ah-special-calc-cd not = 'C')
006902        MOVE ER-1572             TO WS-ERROR
006903        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006904        go to 3300-skip-crit-per
006905     END-IF
006906
006907     if (pb-company-id = 'DCC' or 'VPP')
006908        and (am-dcc-product-code not = spaces)
006909        go to 3300-skip-crit-per
006910     end-if
006911
006912     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
006913        IF PB-I-AH-CRIT-PER = ZERO
006914           move ws-ah-max-bens   to pb-i-ah-crit-per
006915*          MOVE ER-2618       TO WS-ERROR
006916*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006917*          GO TO 3999-END-EDIT
006918        END-IF
006919     END-IF
006920
006921     if (ws-ah-special-calc-cd = 'C')
006922        and (pb-i-ah-crit-per <> ws-ah-max-bens)
006923        MOVE ER-1576             TO WS-ERROR
006924        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
006925     end-if
006926
006927     .
006928 3300-skip-crit-per.
006929
006930     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
006931     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
006932     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
006933     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
006934     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
006935     MOVE PB-SV-STATE            TO CP-STATE.
006936     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
006937     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
006938     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
006939*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
006940     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
006941     MOVE '3'                    TO CP-PROCESS-TYPE.
006942     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
006943     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
006944                                    CP-RATING-BENEFIT-AMT.
006945     IF PB-COMPANY-ID = 'CID'
006946               OR
006947        CP-STATE-STD-ABBRV = 'OR'
006948         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
006949                                         PB-I-AH-TERM.
006950     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
006951        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
006952           AND (PB-I-POLICY-IS-MONTHLY)
006953           MOVE PB-I-LF-BENEFIT-AMT
006954                                 TO CP-NET-BENEFIT-AMT
006955           move pb-i-ah-premium-amt to cp-original-premium
006956           add pb-i-lf-premium-amt to cp-original-premium
006957        END-IF
006958     END-IF
006959
006960     MOVE SPACES                 TO CP-BEN-CATEGORY
006961
006962     IF PB-COMPANY-ID = 'DCC' or 'VPP'
006963        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
006964        EVALUATE TRUE
006965           WHEN (WS-AH-BEN-CATEGORY = 'G')
006966              AND (AM-DCC-PRODUCT-CODE = 'DDF')
006967              MOVE PB-I-LF-BENEFIT-AMT
006968                                 TO CP-RATING-BENEFIT-AMT
006969              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
006970           WHEN WS-AH-BEN-CATEGORY = 'G'
006971              MOVE PB-I-UNPAID-CASH-PRICE
006972                                 TO CP-RATING-BENEFIT-AMT
006973           WHEN WS-AH-BEN-CATEGORY = 'D'
006974              MOVE WS-AH-PMF-COMM
006975                                 TO CP-DCC-PMF-COMM
006976              MOVE PB-I-AH-COMMISSION
006977                                 TO CP-DCC-ACT-COMM
006978        END-EVALUATE
006979     END-IF
006980
006981     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
006982     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
006983     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
006984     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
006985     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
006986     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
006987     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
006988                                    CP-REMAINING-TERM
006989                                    WS-WORK-TERM.
006990     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
006991
006992     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
006993     SET BIN-TO-GREG             TO TRUE.
006994*    MOVE ' '                    TO DC-OPTION-CODE.
006995     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
006996     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE
006997
006998     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
006999     IF NOT VALID-SKIP-CODE
007000         MOVE ER-2683            TO WS-ERROR
007001         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007002         GO TO 3320-RATE-CONTINUE.
007003
007004     IF PB-NO-MONTHS-SKIPPED
007005         GO TO 3320-RATE-CONTINUE.
007006
007007     MOVE SPACE TO NUMBER-OF-MONTHS.
007008
007009     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
007010         MOVE 'S'                TO SK-MO (6).
007011     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
007012         MOVE 'S'                TO SK-MO (7).
007013     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
007014         MOVE 'S'                TO SK-MO (8).
007015     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
007016         MOVE 'S'                TO SK-MO (9).
007017     IF PB-I-SKIP-CODE = 'A'
007018         MOVE 'S'                TO SK-MO (10).
007019
007020     MOVE 1                      TO SUB2.
007021     MOVE PB-I-AH-TERM           TO SUB3.
007022     MOVE WS-MONTH               TO SUB1.
007023     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
007024     GO TO 3320-RATE-CONTINUE.
007025
007026 3310-GET-SKIP-MO.
007027     IF SUB1 = 13
007028         MOVE 1                  TO SUB1.
007029
007030     IF SK-MO (SUB1) = 'S'
007031         SUBTRACT 1 FROM WS-WORK-TERM.
007032
007033     ADD 1 TO SUB2
007034              SUB1.
007035
007036 3320-RATE-CONTINUE.
007037
007038     IF WS-WORK-TERM = ZERO
007039         MOVE 1                  TO WS-WORK-TERM.
007040
007041     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
007042                                    CP-LOAN-TERM.
007043
007044     IF PB-COMPANY-ID EQUAL 'DMD'
007045         NEXT SENTENCE
007046     ELSE
007047         MOVE ZERO               TO PB-I-AH-RATE
007048                                    PB-I-AH-REI-RATE.
007049
007050
007051     IF PB-COMPANY-ID EQUAL 'CRI'
007052        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
007053
007054     IF PB-COMPANY-ID = 'CSL'
007055         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
007056         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
007057         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
007058         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
007059
007060     IF PB-COMPANY-ID = 'DCC' or 'VPP'
007061        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
007062           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
007063              PB-I-RATE-DEV-PCT-LF
007064        END-IF
007065        MOVE PB-I-LF-ALT-BENEFIT-AMT
007066                                 TO CP-ALTERNATE-BENEFIT
007067        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
007068        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
007069        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
007070     END-IF
007071
007072*    if ws-clp-state not = spaces
007073*       move ws-clp-state to cp-state
007074*    end-if
007075     IF (PB-COMPANY-ID = 'CID')
007076        AND (WS-LF-EARNINGS-CALC = 'B')
007077        AND (CP-STATE-STD-ABBRV = 'MN')
007078        MOVE 'Y'                 TO CP-AH-BALLOON-SW
007079     ELSE
007080        MOVE ' '                 TO CP-AH-BALLOON-SW
007081     END-IF
007082
007083     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
007084     MOVE 'R'                   TO CP-RATE-FILE.
007085     PERFORM 7000-GET-RATE THRU 7000-EXIT.
007086
007087     IF (CP-ERROR-RATE-NOT-FOUND)
007088        and (not pb-monthly-cert)
007089        IF PB-I-OB
007090           MOVE ER-2624          TO WS-ERROR
007091           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007092           GO TO 3340-CALCULATE-PREMIUM-AMT
007093        ELSE
007094          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
007095              NEXT SENTENCE
007096          ELSE
007097           MOVE ER-2642          TO WS-ERROR
007098           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007099           GO TO 3340-CALCULATE-PREMIUM-AMT.
007100
007101     IF PB-COMPANY-ID EQUAL 'CSL' AND
007102        CP-ERROR-DIV-BY-ZERO
007103           MOVE ER-3782          TO WS-ERROR
007104           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007105
007106     IF PB-COMPANY-ID EQUAL 'CRI'
007107        IF CP-ERROR-NO-LIMITS-CRI
007108           IF NOT ACCOUNT-AH-CHECKED
007109              MOVE ER-2607          TO WS-ERROR
007110              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007111
007112     IF ACCOUNT-AH-CHECKED
007113        NEXT SENTENCE
007114     ELSE
007115       IF CP-ERROR-AMT-OUTSIDE-LIMIT
007116          MOVE ER-2640           TO WS-ERROR
007117          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007118
007119     IF PB-COMPANY-ID = 'CRI'
007120         IF WS-ERROR = ER-2640
007121             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
007122
007123     IF ACCOUNT-AH-CHECKED
007124        CONTINUE
007125     ELSE
007126        IF (CP-R-MAX-ATT-AGE NUMERIC)
007127           AND (CP-R-MAX-ATT-AGE > +0)
007128           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
007129           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
007130              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
007131              MOVE PB-I-AH-EXPIRE-DT
007132                                 TO DC-BIN-DATE-2
007133              MOVE '1'           TO DC-OPTION-CODE
007134              PERFORM 8500-DATE-CONVERT
007135                                 THRU 8500-EXIT
007136              IF NO-CONVERSION-ERROR
007137                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
007138                    MOVE ER-2661       TO WS-ERROR
007139*                   PERFORM 9900-ERROR-FORMAT
007140*                                THRU 9900-EXIT
007141                 END-IF
007142              END-IF
007143           ELSE
007144              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
007145              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
007146                 MOVE ER-2661    TO WS-ERROR
007147*                PERFORM 9900-ERROR-FORMAT
007148*                                THRU 9900-EXIT
007149              ELSE
007150                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
007151                    MOVE ER-1570 TO WS-ERROR
007152                    PERFORM 9900-ERROR-FORMAT
007153                                 THRU 9900-EXIT
007154                 END-IF
007155              END-IF
007156           END-IF
007157
007158           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
007159              MOVE PB-I-JOINT-BIRTHDAY
007160                                    TO DC-BIN-DATE-1
007161              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
007162              MOVE '1'              TO DC-OPTION-CODE
007163              PERFORM 8500-DATE-CONVERT
007164                                    THRU 8500-EXIT
007165              IF NO-CONVERSION-ERROR
007166                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
007167                    MOVE ER-2661       TO WS-ERROR
007168*                   PERFORM 9900-ERROR-FORMAT
007169*                                   THRU 9900-EXIT
007170                 END-IF
007171              END-IF
007172           ELSE
007173              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
007174                (PB-I-AH-TERM / 12)
007175              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
007176                 MOVE ER-2661       TO WS-ERROR
007177*                PERFORM 9900-ERROR-FORMAT
007178*                                   THRU 9900-EXIT
007179              ELSE
007180                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
007181                    MOVE ER-1571 TO WS-ERROR
007182                    PERFORM 9900-ERROR-FORMAT
007183                                 THRU 9900-EXIT
007184                 END-IF
007185              END-IF
007186           END-IF
007187           IF WS-ERROR = ER-2661
007188              PERFORM 9900-ERROR-FORMAT
007189                                    THRU 9900-EXIT
007190           END-IF
007191        END-IF
007192     END-IF
007193
007194*    IF ACCOUNT-AH-CHECKED
007195*       NEXT SENTENCE
007196*    ELSE
007197*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
007198*          MOVE ER-2661          TO WS-ERROR
007199*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007200
007201     IF ACCOUNT-AH-CHECKED
007202        NEXT SENTENCE
007203     ELSE
007204        IF CP-ERROR-AGE-OUTSIDE-LIMIT
007205           MOVE ER-2663          TO WS-ERROR
007206           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007207
007208     IF ACCOUNT-AH-CHECKED OR
007209        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
007210         PB-POLICY-IS-VOIDED
007211        NEXT SENTENCE
007212     ELSE
007213        IF CP-ERROR-TOT-OUTSIDE-LIMIT
007214           MOVE ER-2667            TO WS-ERROR
007215           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007216
007217     IF PB-COMPANY-ID = 'CRI'
007218         IF WS-ERROR = ER-2667
007219             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
007220
007221
007222     IF ACCOUNT-AH-CHECKED
007223        NEXT SENTENCE
007224     ELSE
007225        IF CP-ERROR-TERM-OUTSIDE-LIMIT
007226           MOVE ER-2678            TO WS-ERROR
007227           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007228
007229     IF CP-ERROR-RATE-FILE-NOTOPEN
007230         GO TO 3990-FILES-NOT-OPEN.
007231
007232 3321-CONTINUE.
007233     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
007234     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
007235
007236     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
007237*    IF (PB-COMPANY-ID = 'DCC')
007238        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
007239        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
007240                                    PB-I-LF-ALT-PREM-CALC
007241        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
007242        IF WS-AH-BEN-CATEGORY = 'G'
007243           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
007244           + PB-I-ADDL-CLP)
007245           * (1 + WS-TOL-CLP-PCT)
007246*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
007247        ELSE
007248           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
007249           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
007250*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
007251        END-IF
007252        MOVE WS-TOL-LF-HIGH-PREM-AMT
007253                                 TO PB-I-AH-PREM-CALC
007254        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
007255           MOVE ER-8152          TO WS-ERROR
007256           PERFORM 9900-ERROR-FORMAT
007257                                 THRU 9900-EXIT
007258        ELSE
007259           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
007260                 PB-I-ADDL-CLP)
007261              MOVE ER-8148       TO WS-ERROR
007262              PERFORM 9900-ERROR-FORMAT
007263                                 THRU 9900-EXIT
007264           END-IF
007265        END-IF
007266     END-IF
007267     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
007268        AND (PB-I-POLICY-IS-MONTHLY)
007269        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
007270        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
007271        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
007272           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
007273        END-IF
007274     END-IF
007275
007276     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
007277        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
007278        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
007279        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
007280        MOVE ER-2786             TO WS-ERROR
007281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007282     END-IF
007283
007284     MOVE +0                     TO PB-I-AH-CLP
007285     IF PB-COMPANY-ID = 'DCC' or 'VPP'
007286        evaluate true
007287           when WS-AH-BEN-CATEGORY = 'D'
007288              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
007289                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
007290           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
007291              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
007292           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
007293              compute ws-cred-union-fees rounded =
007294                 ws-cred-union-fees + (pb-i-ah-premium-amt *
007295                    pb-i-ah-commission)
007296              COMPUTE PB-I-AH-CLP =
007297                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
007298        end-evaluate
007299     END-IF
007300
007301     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
007302
007303     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
007304         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
007305
007306     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
007307         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
007308
007309     if (ws-ah-special-calc-cd = 'E')
007310        and (pb-monthly-cert)
007311        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
007312     end-if
007313
007314     IF PB-COMPANY-ID = 'CRI'
007315         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
007316            PB-I-PAYMENT-AMOUNT = ZERO
007317             NEXT SENTENCE
007318         ELSE
007319             COMPUTE PB-I-AH-PREM-CALC =
007320                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
007321                 (CP-PREMIUM-RATE / 100)
007322             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
007323                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
007324                                             PB-I-RATE-DEV-PCT-AH.
007325
007326     IF (PB-I-AH-RATE  = ZERO)
007327        and (not pb-monthly-cert)
007328       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
007329           NEXT SENTENCE
007330       ELSE
007331         MOVE ER-2642            TO WS-ERROR
007332         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007333
007334     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
007335     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
007336     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
007337     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
007338     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
007339     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
007340
007341     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
007342        AND (WS-AH-BEN-CATEGORY = 'G')
007343        AND (AM-DCC-PRODUCT-CODE = 'DDF')
007344        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
007345        IF CP-DEVIATION-CODE NOT = '000'
007346           MOVE '000'            TO CP-DEVIATION-CODE
007347           PERFORM 7000-GET-RATE THRU 7000-EXIT
007348           IF NO-CP-ERROR
007349              COMPUTE PB-I-DDF-IU-RATE-UP =
007350              PB-I-AH-CLP - CP-CALC-PREMIUM
007351           ELSE
007352              MOVE ER-3057        TO WS-ERROR
007353              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007354           END-IF
007355        END-IF
007356     END-IF
007357
007358     .
007359 3335-EDIT-AH-REIN-NSP-RATE.
007360
007361     IF PB-COMPANY-ID = 'DCC' or 'VPP'
007362        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
007363              compute ws-cred-union-fees rounded =
007364                 ws-cred-union-fees + (pb-i-ah-premium-amt *
007365                    pb-i-ah-commission)
007366              COMPUTE PB-I-AH-CLP =
007367                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
007368        end-if
007369     END-IF
007370
007371     IF AH-REIN-NSP-NOT-USED
007372         GO TO 3340-CALCULATE-PREMIUM-AMT.
007373
007374     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
007375     IF PB-COMPANY-ID = 'DCC' or 'VPP'
007376         GO TO 3340-CALCULATE-PREMIUM-AMT.
007377
007378     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
007379     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
007380     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
007381     MOVE PB-SV-STATE            TO CP-STATE.
007382     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
007383     MOVE ZERO                   TO CP-DEVIATION-CODE
007384                                    CP-RATE-DEV-PCT.
007385*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
007386     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
007387     MOVE '3'                    TO CP-PROCESS-TYPE.
007388     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
007389     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
007390                                    CP-RATING-BENEFIT-AMT.
007391     IF CP-STATE-STD-ABBRV = 'OR'
007392         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
007393                                         PB-I-AH-TERM.
007394     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
007395     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
007396     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
007397     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
007398     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
007399     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
007400                                    CP-REMAINING-TERM
007401                                    WS-WORK-TERM.
007402     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
007403
007404     IF PB-COMPANY-ID = 'DCC' or 'VPP'
007405        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
007406     END-IF
007407
007408     IF  PB-COMPANY-ID = 'TIC'
007409         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
007410            MOVE ZERO TO CP-CLASS-CODE.
007411
007412     IF PB-COMPANY-ID NOT = 'TIC'
007413          MOVE ZERO          TO CP-CLASS-CODE.
007414
007415     MOVE ZERO               TO CP-DEVIATION-CODE.
007416
007417     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
007418
007419     MOVE ZERO               TO PB-I-AH-REI-RATE.
007420
007421     MOVE 'R'                   TO CP-RATE-FILE.
007422     PERFORM 7000-GET-RATE THRU 7000-EXIT.
007423
007424     IF CP-ERROR-RATE-NOT-FOUND
007425         MOVE ER-2645        TO WS-ERROR
007426         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007427         GO TO 3340-CALCULATE-PREMIUM-AMT.
007428
007429     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
007430
007431     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
007432     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
007433
007434     IF PB-I-AH-REI-RATE = ZERO
007435         MOVE ER-2645        TO WS-ERROR
007436         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007437
007438
007439 3340-CALCULATE-PREMIUM-AMT.
007440
007441     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
007442     SET BIN-TO-GREG             TO TRUE
007443     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
007444     move dc-greg-date-a-edit    to ws-greg-eff-date
007445
007446     IF PB-COMPANY-ID = 'NCL'
007447         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
007448             WS-AH-SPECIAL-CALC-CD = 'O')
007449             GO TO 3999-END-EDIT.
007450
007451     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
007452                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
007453                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
007454                         OR 'AHL'
007455         NEXT SENTENCE
007456     ELSE
007457         IF WS-STATE-ABBREVIATION = 'CT'
007458             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
007459                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
007460                 COMPUTE PB-I-LF-PREM-CALC =
007461                                     PB-I-LF-PREM-CALC * .90
007462                 COMPUTE PB-I-LF-ALT-PREM-CALC =
007463                                     PB-I-LF-ALT-PREM-CALC * .90
007464                 COMPUTE PB-I-AH-PREM-CALC =
007465                                     PB-I-AH-PREM-CALC * .90.
007466
007467     IF PB-COMP-LF-PREM
007468        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
007469        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
007470
007471     IF PB-COMP-AH-PREM
007472        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
007473
007474 3340-CHECK-DCC-TOT-FEES.
007475
007476     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
007477        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
007478        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
007479        AND (PB-I-POLICY-IS-MONTHLY)
007480        CONTINUE
007481     ELSE
007482        GO TO 3340-EDIT-LF-AH-TOL
007483     END-IF
007484
007485     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
007486     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
007487
007488     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
007489        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
007490           PB-I-RATE-DEV-PCT-LF
007491     END-IF
007492     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
007493        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
007494           PB-I-RATE-DEV-PCT-AH
007495     END-IF
007496     MOVE 'N'                    TO CP-BEN-CATEGORY
007497
007498     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
007499
007500     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
007501     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
007502     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
007503     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
007504     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
007505     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
007506     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
007507     MOVE '3'                    TO CP-PROCESS-TYPE.
007508     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
007509     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
007510
007511     MOVE PB-SV-STATE            TO CP-STATE.
007512     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
007513     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
007514     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
007515     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
007516     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
007517                                    CP-RATING-BENEFIT-AMT.
007518     IF CP-STATE-STD-ABBRV = 'OR'
007519         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
007520                                         PB-I-LF-ALT-BENEFIT-AMT.
007521     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
007522     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
007523     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
007524     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
007525     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
007526     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
007527     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
007528     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
007529     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
007530                                    CP-REMAINING-TERM
007531                                    CP-LOAN-TERM.
007532
007533     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
007534        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
007535           PB-I-LF-PREMIUM-AMT
007536     end-if
007537
007538     IF CP-TRUNCATED-LIFE
007539        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
007540
007541     IF CP-TERM-IS-DAYS
007542         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
007543     ELSE
007544         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
007545
007546
007547     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
007548
007549     IF CP-SPECIAL-CALC-CD = 'H'
007550         MOVE PB-I-LF-ALT-BENEFIT-AMT
007551                                    TO CP-ALTERNATE-BENEFIT
007552         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
007553
007554     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
007555     MOVE 'R'                    TO CP-RATE-FILE
007556     PERFORM 7000-GET-RATE       THRU 7000-EXIT
007557
007558     IF NOT CP-ERROR-RATE-NOT-FOUND
007559        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
007560        IF (CP-DCC-LF-RATE NOT = ZEROS)
007561           AND (CP-BENEFIT-CD (1:1) = 'S')
007562           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
007563                                    PB-I-LF-PREMIUM-AMT
007564        END-IF
007565     ELSE
007566        MOVE +0                  TO PB-I-TOT-FEES-CALC
007567     END-IF
007568
007569     .
007570 3340-EDIT-LF-AH-TOL.
007571
007572***    UNSIGN-WRK1    =    LIFE DIFFERENCE
007573***    UNSIGN-WRK2    =    AH   DIFFERENCE
007574***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
007575***
007576     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
007577         PB-I-AH-PREMIUM-AMT
007578          GIVING WS-CALC-WORK.
007579
007580     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
007581        AND WS-CALC-WORK NOT = ZERO
007582         MOVE ER-2649            TO WS-ERROR
007583         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007584
007585     SUBTRACT PB-I-LF-PREM-CALC
007586             FROM PB-I-LF-PREMIUM-AMT
007587                 GIVING WS-UNSIGN-WRK1.
007588
007589     SUBTRACT PB-I-LF-ALT-PREM-CALC
007590             FROM PB-I-LF-ALT-PREMIUM-AMT
007591                 GIVING WS-UNSIGN-WRK4.
007592
007593     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
007594                                + WS-UNSIGN-WRK4.
007595
007596     SUBTRACT PB-I-AH-PREM-CALC
007597             FROM PB-I-AH-PREMIUM-AMT
007598                 GIVING WS-UNSIGN-WRK2.
007599
007600******************************************************************
007601*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
007602******************************************************************
007603
007604     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
007605         MOVE ZERO TO WS-UNSIGN-WRK1.
007606
007607     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
007608         MOVE ZERO TO WS-UNSIGN-WRK2.
007609
007610     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
007611             GIVING WS-UNSIGN-WRK3.
007612
007613 3342-CONTINUE.
007614
007615     IF (PB-I-LF-RATE = ZERO  AND
007616         PB-I-AH-RATE = ZERO)
007617         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
007618            WS-AH-SPECIAL-CALC-CD = 'O'
007619              NEXT SENTENCE
007620         ELSE
007621             GO TO 3345-EDIT-CONTINUE.
007622
007623     IF  PB-RECORD-BILL   =  'B' OR  'L'
007624         NEXT SENTENCE
007625     ELSE
007626     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
007627        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
007628           IF (PB-REISSUED-CERT         OR
007629               PB-POLICY-IS-DECLINED    OR
007630               PB-POLICY-IS-VOIDED)
007631              NEXT SENTENCE
007632           ELSE
007633              IF WS-PREM-REJECT-SW = SPACE
007634                 MOVE ER-2652    TO WS-ERROR
007635                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007636                 GO TO 3344-CHECK-AH
007637              ELSE
007638                 MOVE ER-2650    TO WS-ERROR
007639                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007640                 GO TO 3344-CHECK-AH.
007641
007642***
007643***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
007644***
007645
007646     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
007647         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
007648            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
007649             (1 + WS-TOL-LF-PREM-PCT)
007650         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
007651            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
007652             (1 - WS-TOL-LF-PREM-PCT)
007653     ELSE
007654         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
007655         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
007656
007657***
007658***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
007659***
007660
007661     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
007662         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
007663          WS-TOL-LF-PREM.
007664
007665     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
007666         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
007667          WS-TOL-LF-PREM.
007668
007669     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
007670        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
007671
007672     IF PB-REISSUED-CERT
007673        or PB-POLICY-IS-DECLINED
007674        or PB-POLICY-IS-VOIDED
007675        continue
007676     ELSE
007677        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
007678              > WS-TOL-LF-HIGH-PREM-AMT)
007679           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
007680              < WS-TOL-LF-LOW-PREM-AMT))
007681                      or
007682           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
007683              > WS-TOL-LF-HIGH-PREM-PCT)
007684           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
007685              < WS-TOL-LF-LOW-PREM-PCT))
007686           IF WS-PREM-REJECT-SW = SPACE
007687              MOVE ER-2652       TO WS-ERROR
007688              PERFORM 9900-ERROR-FORMAT
007689                                 THRU 9900-EXIT
007690           ELSE
007691              MOVE ER-2650       TO WS-ERROR
007692              PERFORM 9900-ERROR-FORMAT
007693                                 THRU 9900-EXIT
007694           end-if
007695        end-if
007696     end-if
007697
007698*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
007699*        IF  PB-RECORD-BILL   =  'B' OR  'L'
007700*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
007701*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
007702
007703     IF WS-ERROR  =  ER-2650  OR  ER-2652
007704        IF (PB-RECORD-BILL   =  'B' OR  'L')
007705                      OR
007706           ((PB-COMPANY-ID = 'DCC' or 'VPP')
007707           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
007708           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
007709           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
007710        END-IF
007711     END-IF
007712
007713     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
007714        IF WS-COMP-MAX-CAP GREATER THAN +0
007715           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
007716              IF (PB-REISSUED-CERT         OR
007717                  PB-POLICY-IS-DECLINED    OR
007718                  PB-POLICY-IS-VOIDED)
007719                 NEXT SENTENCE
007720              ELSE
007721                  MOVE ER-2646   TO  WS-ERROR
007722                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007723
007724 3344-CVL-TOLERANCE-CHECK.
007725
007726      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
007727          GO TO 3344-CHECK-AH.
007728
007729      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
007730          GO TO 3344-CHECK-AH.
007731
007732      MOVE ZERO                  TO  WS-UNSIGN-WRK5
007733                                     WS-UNSIGN-WRK6.
007734
007735      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
007736          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
007737                                 + PB-I-LF-PREMIUM-AMT
007738                                 - PB-I-LF-PREM-CALC.
007739
007740      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
007741          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
007742                                 + PB-I-LF-ALT-PREMIUM-AMT
007743                                 - PB-I-LF-ALT-PREM-CALC.
007744
007745      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
007746          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
007747              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
007748                 MOVE ER-2652    TO  WS-ERROR
007749                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007750              ELSE
007751                 MOVE ER-2650    TO  WS-ERROR
007752                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007753
007754      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
007755          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
007756              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
007757                 MOVE ER-2652    TO  WS-ERROR
007758                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
007759              ELSE
007760                 MOVE ER-2650    TO  WS-ERROR
007761                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007762
007763 3344-CHECK-AH.
007764
007765****************************************************************
007766***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
007767***
007768
007769     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
007770         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
007771             (1 + WS-TOL-AH-PREM-PCT)
007772         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
007773             (1 - WS-TOL-AH-PREM-PCT)
007774     ELSE
007775         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
007776         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
007777
007778***
007779***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
007780***
007781
007782     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
007783         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
007784
007785     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
007786         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
007787
007788     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
007789        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
007790
007791     IF (PB-REISSUED-CERT)
007792        OR (PB-POLICY-IS-DECLINED)
007793        OR (PB-POLICY-IS-VOIDED)
007794        OR (AM-DCC-PRODUCT-CODE = 'DDF')
007795        CONTINUE
007796     ELSE
007797        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
007798              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
007799                          or
007800           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
007801              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
007802           IF WS-PREM-REJECT-SW = SPACE
007803              MOVE ER-3052       TO WS-ERROR
007804              PERFORM 9900-ERROR-FORMAT
007805                                 THRU 9900-EXIT
007806           ELSE
007807              MOVE ER-3050       TO WS-ERROR
007808              PERFORM 9900-ERROR-FORMAT
007809                                 THRU 9900-EXIT
007810           END-IF
007811        END-IF
007812     END-IF
007813
007814     if (pb-company-id = 'DCC' or 'VPP')
007815        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
007816        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
007817        and (pb-i-policy-is-monthly)
007818        compute ws-tol-ah-high-prem-amt =
007819           pb-i-tot-fees-calc + ws-tol-ah-prem
007820        compute ws-tol-ah-low-prem-amt =
007821           pb-i-tot-fees-calc - ws-tol-ah-prem
007822        if ws-tol-ah-prem-pct > zeros
007823           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
007824              (1 + ws-tol-ah-prem-pct)
007825           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
007826              (1 - ws-tol-ah-prem-pct)
007827        else
007828           move +9999999.99      to ws-tol-ah-high-prem-pct
007829           move +0               to ws-tol-ah-low-prem-pct
007830        end-if
007831        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
007832            or
007833           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
007834                          or
007835           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
007836           or
007837           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
007838            move er-3049         to ws-error
007839           perform 9900-error-format
007840                                 thru 9900-exit
007841
007842        end-if
007843     end-if
007844
007845     IF  WS-ERROR  =  ER-3050   OR   ER-3052
007846         IF  PB-RECORD-BILL   =  'B' OR 'A'
007847             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
007848             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
007849
007850     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
007851        IF WS-COMP-MAX-CAP GREATER THAN +0
007852           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
007853              IF (PB-REISSUED-CERT         OR
007854                  PB-POLICY-IS-DECLINED    OR
007855                  PB-POLICY-IS-VOIDED)
007856                 NEXT SENTENCE
007857              ELSE
007858                  MOVE ER-2646   TO  WS-ERROR
007859                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007860
007861     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
007862        (WS-COMP-MAX-CAP EQUAL +0)
007863           GO TO 3345-EDIT-CONTINUE.
007864
007865     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
007866        GREATER THAN WS-COMP-MAX-CAP
007867           MOVE ER-2646          TO  WS-ERROR
007868           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
007869
007870 3345-EDIT-CONTINUE.
007871
007872*    IF PB-COMPANY-ID    EQUAL    'NCL'
007873*       IF PB-ENTRY-BATCH   NUMERIC
007874*          IF PB-ISSUE
007875*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
007876*          ELSE
007877*              IF PB-CANCELLATION
007878*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
007879
007880*    IF  PB-COMPANY-ID    EQUAL    'HER'
007881*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
007882*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
007883*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
007884*        ELSE
007885*            MOVE  ER-1909            TO  WS-ERROR
007886*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
007887
007888     IF PB-I-POLICY-ACCEPTED
007889        IF PB-POLICY-IS-DECLINED  OR
007890           PB-REISSUED-CERT  OR
007891           PB-REIN-ONLY-CERT  OR
007892           PB-POLICY-IS-VOIDED
007893            MOVE  ER-1891         TO  WS-ERROR
007894            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
007895        ELSE
007896            MOVE SPACE            TO  PB-BATCH-ENTRY
007897            MOVE '2'              TO  PB-I-ENTRY-STATUS.
007898
007899     IF PB-I-POLICY-DECLINED
007900        IF PB-REISSUED-CERT  OR
007901           PB-REIN-ONLY-CERT  OR
007902           PB-POLICY-IS-VOIDED
007903            MOVE  ER-1906         TO  WS-ERROR
007904            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
007905        ELSE
007906            MOVE  'D'             TO  PB-BATCH-ENTRY
007907                                      PB-I-ENTRY-STATUS.
007908
007909     IF PB-I-NEEDS-UNDERWRITING
007910        IF PB-POLICY-IS-DECLINED OR
007911           PB-REISSUED-CERT  OR
007912           PB-REIN-ONLY-CERT  OR
007913           PB-POLICY-IS-VOIDED
007914            MOVE  ER-1907         TO  WS-ERROR
007915            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
007916        ELSE
007917            MOVE 'U'              TO  PB-BATCH-ENTRY
007918                                      PB-I-ENTRY-STATUS.
007919
007920     IF PB-NEEDS-UNDERWRITING
007921        MOVE  ER-1901             TO  WS-ERROR
007922        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
007923
007924     IF PB-COMPANY-ID = 'DCC' or 'VPP'
007925        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
007926        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
007927        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
007928           AND (NOT WS-LF-CASH))
007929                           OR
007930           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
007931           AND (NOT WS-AH-CASH)))
007932                       AND
007933           (PB-I-ENTRY-STATUS NOT = '5')
007934           MOVE 'M'              TO PB-BATCH-ENTRY
007935                                    PB-I-ENTRY-STATUS
007936        END-IF
007937     END-IF
007938
007939     move pending-business       to ws-passed-erpndb
007940     move ' '                    to ws-exceed-limit-yn
007941     perform 7780-call-agg       thru 7780-exit
007942*    display ' el050 exceed ' ws-exceed-limit-yn
007943     if ws-exceed-limit-yn = 'Y'
007944        MOVE  ER-9813            TO WS-ERROR
007945        move 'Y'                 to ws-9813-sw
007946        PERFORM  9900-ERROR-FORMAT
007947                                 THRU 9900-EXIT
007948     end-if
007949
007950     if (PB-EXCEEDED-LIMIT-FORCED)
007951        and (ws-9813-sw = 'Y')
007952        subtract +1 from PB-NO-OF-ERRORS
007953        move er-9823             to ws-error
007954        PERFORM  9900-ERROR-FORMAT
007955                                 THRU 9900-EXIT
007956     end-if
007957
007958     IF  PB-COMPANY-ID NOT = 'NCL'
007959         GO TO 3999-END-EDIT.
007960
007961     IF PB-REISSUED-CERT  OR
007962        PB-POLICY-IS-DECLINED  OR
007963        PB-POLICY-IS-VOIDED  OR
007964        PB-I-OB
007965         GO TO 3999-END-EDIT.
007966
007967     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
007968         MOVE  ER-2644            TO  WS-ERROR
007969         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
007970         GO TO 3999-END-EDIT.
007971
007972     MOVE 'N'                     TO  FORM-MASTER-SW.
007973     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
007974
007975     IF NOT FORM-MASTER-FOUND
007976         GO TO 3999-END-EDIT.
007977
007978     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
007979                                      FORM-MASTER-AH-SW.
007980
007981     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
007982         MOVE  +1                 TO SUB6
007983         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
007984
007985     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
007986         MOVE  +1                 TO SUB6
007987         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
007988
007989     IF LF-FORM-MASTER-FOUND  OR
007990        AH-FORM-MASTER-FOUND
007991         GO TO 3360-CHECK-FORM-LIMITS
007992     ELSE
007993         GO TO 3999-END-EDIT.
007994
007995******************************************************************
007996*                  3350-GET-ERFORM                               *
007997*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
007998*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
007999******************************************************************
008000
008001 3350-GET-ERFORM.
008002
008003     IF  WK-FORM-ADDR      EQUAL    ZEROS
008004         GO TO  3350-ERFORM-GETMAIN.
008005
008006     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
008007     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
008008     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
008009     MOVE 'Y'                     TO FORM-MASTER-SW.
008010
008011     IF PB-CANCELLATION
008012         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
008013            PB-SV-STATE          EQUAL   FO-STATE       AND
008014            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
008015              GO TO 3350-EXIT
008016         ELSE
008017             NEXT SENTENCE
008018     ELSE
008019         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
008020            PB-SV-STATE          EQUAL   FO-STATE       AND
008021            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
008022              GO TO 3350-EXIT.
008023
008024 3350-ERFORM-GETMAIN.
008025
008026     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
008027     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
008028
008029 3350-ERFORM-READ.
008030
008031     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
008032     MOVE  PB-SV-STATE            TO  FORM-STATE.
008033     IF PB-CANCELLATION
008034         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
008035     ELSE
008036         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
008037     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
008038
008039     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
008040
008041     IF FORM-MASTER-FOUND
008042       IF PB-CANCELLATION
008043          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
008044             PB-SV-STATE          EQUAL   FO-STATE       AND
008045             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
008046              GO  TO 3350-EXIT
008047          ELSE
008048              NEXT SENTENCE
008049       ELSE
008050          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
008051             PB-SV-STATE          EQUAL   FO-STATE       AND
008052             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
008053              GO  TO 3350-EXIT.
008054
008055     MOVE  'N'                    TO  FORM-MASTER-SW.
008056     MOVE  ER-1895                TO  WS-ERROR.
008057     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
008058
008059 3350-EXIT.
008060      EXIT.
008061
008062******************************************************************
008063*                  3355-EDIT-FORM-LF-BENEFITS                    *
008064*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
008065*   VALID FOR THE POLICY FORM USED.                              *
008066******************************************************************
008067
008068 3355-EDIT-FORM-LF-BENEFITS.
008069
008070     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
008071        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
008072         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
008073         GO TO   3355-EXIT.
008074
008075     IF  SUB6    LESS THAN   +40
008076         ADD  +1      TO  SUB6
008077         GO TO  3355-EDIT-FORM-LF-BENEFITS.
008078
008079     MOVE  ER-1896         TO  WS-ERROR.
008080     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
008081
008082 3355-EXIT.
008083      EXIT.
008084
008085******************************************************************
008086*                  3356-EDIT-FORM-AH-BENEFITS                    *
008087*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
008088*   VALID FOR THE POLICY FORM USED.                              *
008089******************************************************************
008090
008091 3356-EDIT-FORM-AH-BENEFITS.
008092
008093     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
008094        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
008095         MOVE  'Y'                TO  FORM-MASTER-AH-SW
008096         GO TO  3356-EXIT.
008097
008098      IF  SUB6    LESS THAN     +40
008099          ADD  +1      TO  SUB6
008100          GO TO  3356-EDIT-FORM-AH-BENEFITS.
008101
008102     MOVE  ER-1897         TO  WS-ERROR.
008103     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
008104
008105 3356-EXIT.
008106      EXIT.
008107
008108******************************************************************
008109*                  3357-BENEFIT-SEARCH                           *
008110*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
008111*   CANCELLATIONS ONLY.                                          *
008112******************************************************************
008113 3357-BENEFIT-SEARCH.
008114     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
008115         MOVE +1                          TO SUB6
008116         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
008117
008118     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
008119         MOVE +1                          TO SUB6
008120         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
008121
008122 3357-EXIT.
008123     EXIT.
008124
008125******************************************************************
008126*                  3358-BENEFIT-LIFE-SEARCH                      *
008127*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
008128*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
008129*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
008130******************************************************************
008131 3358-BENEFIT-LIFE-SEARCH.
008132     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
008133       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
008134         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
008135           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
008136              IF FO-PLAN-REFUND-METHOD (SUB6)
008137                     IS GREATER THAN SPACES
008138                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
008139                                          WS-LF-REFUND-CALC
008140                 GO TO 3358-EXIT.
008141
008142     IF SUB6 LESS THAN +40
008143         ADD +1                 TO SUB6
008144         GO TO 3358-BENEFIT-LIFE-SEARCH.
008145
008146 3358-EXIT.
008147     EXIT.
008148******************************************************************
008149*                  3359-BENEFIT-AH-SEARCH                        *
008150*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
008151*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
008152*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
008153******************************************************************
008154 3359-BENEFIT-AH-SEARCH.
008155     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
008156       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
008157         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
008158           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
008159              IF FO-PLAN-REFUND-METHOD (SUB6)
008160                      IS GREATER THAN SPACES
008161                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
008162                                          WS-AH-REFUND-CALC
008163                 GO TO 3359-EXIT.
008164
008165     IF SUB6 LESS THAN +40
008166         ADD +1                 TO SUB6
008167         GO TO 3359-BENEFIT-AH-SEARCH.
008168
008169 3359-EXIT.
008170     EXIT.
008171
008172******************************************************************
008173*                  3360-CHECK-FORM-LIMITS                        *
008174*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
008175*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
008176******************************************************************
008177
008178 3360-CHECK-FORM-LIMITS.
008179
008180     IF FO-IND-GRP-CD = 'I'  OR  'G'
008181         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
008182
008183     IF NOT LF-FORM-MASTER-FOUND
008184         GO TO 3360-CHECK-FORM-AH-LIMITS.
008185
008186 3360-CHECK-FORM-LF-MIN-ISS-AGE.
008187
008188     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
008189       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
008190        WS-LF-JOINT-INDICATOR = 'J'  AND
008191        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
008192         IF PB-COMPANY-ID = 'NCL'
008193            MOVE  ER-1911          TO  WS-ERROR
008194            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
008195         ELSE
008196            MOVE  ER-1892          TO  WS-ERROR
008197            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
008198
008199 3360-CHECK-FORM-LF-ATT-AGE.
008200
008201     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
008202
008203     IF  FO-MAX-ATT-AGE     NUMERIC  AND
008204         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
008205         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
008206            IF PB-COMPANY-ID = 'NCL'
008207                MOVE  ER-1913      TO  WS-ERROR
008208                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
008209            ELSE
008210                MOVE  ER-1894      TO  WS-ERROR
008211                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
008212
008213 3360-CHECK-FORM-LF-MAX-ISS-AGE.
008214
008215     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
008216         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
008217         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
008218            IF PB-COMPANY-ID = 'NCL'
008219                MOVE  ER-1914      TO  WS-ERROR
008220                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
008221            ELSE
008222                MOVE  ER-1899      TO  WS-ERROR
008223                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
008224
008225 3360-CHECK-FORM-LF-TERM-BAMT.
008226
008227     IF  FO-LF-MAX-TERM   NUMERIC   AND
008228         FO-LF-MAX-TERM   GREATER THAN   ZEROS
008229         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
008230           IF  PB-COMPANY-ID = 'NCL'
008231               MOVE  ER-1916       TO  WS-ERROR
008232               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
008233           ELSE
008234               MOVE  ER-1902       TO  WS-ERROR
008235               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
008236
008237     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
008238                                    PB-I-LF-ALT-BENEFIT-AMT.
008239
008240     IF  FO-MAX-LF-AMT   NUMERIC   AND
008241         FO-MAX-LF-AMT   GREATER THAN   ZEROS
008242         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
008243             IF  PB-COMPANY-ID = 'NCL'
008244                 MOVE  ER-1918     TO  WS-ERROR
008245                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
008246             ELSE
008247                 MOVE  ER-1904     TO  WS-ERROR
008248                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
008249
008250******************************************************************
008251*                  3360-CHECK-FORM-AH-LIMITS                     *
008252*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
008253*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
008254******************************************************************
008255
008256 3360-CHECK-FORM-AH-LIMITS.
008257
008258     IF NOT AH-FORM-MASTER-FOUND
008259         GO TO 3999-END-EDIT.
008260
008261 3360-CHECK-FORM-AH-MIN-ISS-AGE.
008262
008263     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
008264       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
008265        WS-AH-JOINT-INDICATOR = 'J'  AND
008266        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
008267         IF PB-COMPANY-ID = 'NCL'
008268            MOVE  ER-1912          TO  WS-ERROR
008269            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
008270         ELSE
008271            MOVE  ER-1893          TO  WS-ERROR
008272            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
008273
008274 3360-CHECK-FORM-AH-ATT-AGE.
008275
008276     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
008277
008278     IF  FO-MAX-ATT-AGE     NUMERIC     AND
008279         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
008280         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
008281            IF PB-COMPANY-ID = 'NCL'
008282                MOVE  ER-1913      TO  WS-ERROR
008283                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
008284            ELSE
008285                MOVE  ER-1894      TO  WS-ERROR
008286                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
008287
008288 3360-CHECK-FORM-AH-MAX-ISS-AGE.
008289
008290     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
008291         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
008292         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
008293            IF PB-COMPANY-ID = 'NCL'
008294                MOVE  ER-1915      TO  WS-ERROR
008295                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
008296            ELSE
008297                MOVE  ER-1900      TO  WS-ERROR
008298                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
008299
008300 3360-CHECK-FORM-AH-TERM-BAMT.
008301
008302     IF  FO-AH-MAX-TERM    NUMERIC   AND
008303         FO-AH-MAX-TERM    GREATER THAN  +0
008304         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
008305             IF  PB-COMPANY-ID = 'NCL'
008306                 MOVE  ER-1917     TO  WS-ERROR
008307                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
008308             ELSE
008309                  MOVE  ER-1903    TO  WS-ERROR
008310                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
008311
008312     IF  FO-MAX-AH-AMT    NUMERIC   AND
008313         FO-MAX-AH-AMT    GREATER THAN  +0
008314         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
008315             IF  PB-COMPANY-ID = 'NCL'
008316                 MOVE  ER-1919     TO  WS-ERROR
008317                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
008318             ELSE
008319                 MOVE  ER-1905     TO  WS-ERROR
008320                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
008321
008322     GO TO 3999-END-EDIT.
008323
008324******************************************************************
008325     EJECT
008326 3400-edit-vin.
008327
008328     move spaces                 to hldi-pass-area
008329     MOVE PB-I-VIN               TO WS-WORK-VIN
008330     MOVE +8                     TO V2
008331     MOVE ZEROS                  TO WS-VIN-TOTAL
008332     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
008333      (V1 > 17)
008334        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
008335           MOVE ER-3825          TO WS-ERROR
008336           PERFORM 9900-ERROR-FORMAT
008337                                 THRU 9900-EXIT
008338        ELSE
008339           IF V1 = 8
008340              MOVE 10            TO V2
008341           END-IF
008342           IF V1 = 9
008343              MOVE 0             TO V2
008344           END-IF
008345           IF V1 = 10
008346              MOVE 9             TO V2
008347           END-IF
008348           IF WS-WORK-VIN (V1:1) NUMERIC
008349              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
008350               + (WS-WORK-VIN-N (V1) * V2)
008351           ELSE
008352              MOVE WS-WORK-VIN (V1:1)
008353                            TO WS-HEX-BYTE
008354              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
008355              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
008356               + (WS-NUM (V3) * V2)
008357           END-IF
008358           COMPUTE V2 = V2 - 1
008359        END-IF
008360     END-PERFORM
008361     MOVE ZEROS                  TO WS-VIN-REMAINDER
008362     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
008363        REMAINDER WS-VIN-REMAINDER
008364     IF ((WS-WORK-VIN (9:1) = 'X')
008365        AND (WS-VIN-REMAINDER = 10))
008366                OR
008367        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
008368        if pb-company-id = 'VPP'
008369           perform 3410-check-with-hldi
008370                                 thru 3410-exit
008371        end-if
008372     ELSE
008373        IF WS-WORK-VIN (1:1) > 0 AND < 6
008374           MOVE ER-3826          TO WS-ERROR
008375           PERFORM 9900-ERROR-FORMAT
008376                                 THRU 9900-EXIT
008377        ELSE
008378           MOVE ER-3827          TO WS-ERROR
008379           PERFORM 9900-ERROR-FORMAT
008380                                 THRU 9900-EXIT
008381        END-IF
008382     END-IF
008383
008384     .
008385 3400-exit.
008386     exit.
008387
008388 3410-check-with-hldi.
008389
008390     move spaces                 to hldi-pass-area
008391     move pb-i-vin               to pa-vin
008392     perform 7785-call-hldi      thru 7785-exit
008393
008394*    display ' back to EL050 from elhldi '
008395*    display 'PA-VIN        ' PA-VIN
008396*    display 'PA-ErrorCode  ' PA-ErrorCode
008397*    display 'PA-ErrorDesc  ' PA-ErrorDesc
008398*    display 'PA-ModelYear  ' PA-ModelYear
008399*    display 'PA-MakeName   ' PA-MakeName
008400*    display 'PA-ModelName  ' PA-ModelName
008401*    display 'PA-SeriesName ' PA-SeriesName
008402
008403     if pa-errorcode (1:1) not = '0'
008404        move spaces              to hldi-pass-area
008405        move pb-i-vin            to pa-vin
008406*       move pa-errordesc        to pa-seriesname
008407*       perform 7786-call-hldim  thru 7786-exit
008408*       display ' back to EL050 from elhldim '
008409*       display 'PA-VIN        ' PA-VIN
008410*       display 'PA-ErrorCode  ' PA-ErrorCode
008411*       display 'PA-ErrorDesc  ' PA-ErrorDesc
008412*       display 'PA-ModelYear  ' PA-ModelYear
008413*       display 'PA-MakeName   ' PA-MakeName
008414*       display 'PA-ModelName  ' PA-ModelName
008415*       display 'PA-SeriesName ' PA-SeriesName
008416     end-if
008417
008418     .
008419 3410-exit.
008420     exit.
008421
008422
008423******************************************************************
008424*                  E D I T   C A N C E L                         *
008425******************************************************************
008426
008427 3700-EDIT-CANCEL.
008428     IF PB-COMPANY-ID = 'DMD'
008429         MOVE ZEROS                   TO WS-RES-STATE-TAX
008430                                         WS-RES-MUNI-TAX
008431                                         PB-CI-STATE-TAX
008432                                         PB-CI-MUNI-TAX
008433         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
008434
008435*    IF PB-COMPANY-ID  EQUAL  'NCL'
008436*       IF PB-ENTRY-BATCH  NUMERIC
008437*          IF PB-CANCELLATION
008438*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
008439*          ELSE
008440*             IF PB-ISSUE
008441*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
008442
008443     IF PB-C-INT-ON-REFS NOT NUMERIC
008444        MOVE ZEROS               TO PB-C-INT-ON-REFS
008445     END-IF
008446
008447*    IF PB-C-MICROFILM-NO  NOT NUMERIC
008448*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
008449
008450     IF CM-ENTRY-STATUS = 'V'
008451        MOVE ER-2780             TO WS-ERROR
008452        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
008453        GO TO 3999-END-EDIT.
008454
008455     IF CM-ENTRY-STATUS = 'D'
008456        MOVE ER-2781             TO WS-ERROR
008457        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
008458        GO TO 3999-END-EDIT.
008459
008460     IF CM-ENTRY-STATUS = 'U'
008461        MOVE ER-2782             TO WS-ERROR
008462        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008463
008464***************************************************************
008465*                                                             *
008466*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
008467*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
008468*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
008469*   OF ANOTHER COVERAGE.                                      *
008470*                                                             *
008471***************************************************************
008472
008473     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
008474                                    PB-C-AH-CANCEL-VOID-SW.
008475
008476
008477     if pb-company-id = 'DCC' or 'VPP'
008478        if ((pb-ci-lf-cancel-amt <> zeros)
008479                       or
008480            (pb-ci-ah-cancel-amt <> zeros))
008481           MOVE ER-3068          TO WS-ERROR
008482           PERFORM 9900-ERROR-FORMAT
008483                                 THRU 9900-EXIT
008484           GO TO 3999-END-EDIT
008485        end-if
008486     end-if
008487
008488     IF PB-C-LF-CANCEL-AMT = ZERO
008489        NEXT SENTENCE
008490     ELSE
008491        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
008492           AND
008493           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
008494               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
008495               MOVE ER-2745           TO WS-ERROR
008496               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008497
008498     IF PB-C-AH-CANCEL-AMT = ZERO
008499        NEXT SENTENCE
008500     ELSE
008501        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
008502           AND
008503           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
008504               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
008505               MOVE ER-2745           TO WS-ERROR
008506               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008507
008508     IF WS-LF-EARNINGS-CALC = '4'
008509        MOVE '4'                   TO WS-LF-REFUND-CALC.
008510
008511     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
008512     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
008513     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
008514     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
008515     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
008516     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
008517
008518     MOVE ZERO                     TO PB-C-LF-REF-CALC
008519                                      PB-C-AH-REF-CALC.
008520     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
008521
008522******************************************************************
008523*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
008524*             TO VALIDATE COVERAGE.                              *
008525******************************************************************
008526
008527     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
008528        PB-C-LF-CANCEL-AMT = ZEROS
008529          MOVE 'N'                 TO WS-LF-CANCEL-SW
008530      ELSE
008531          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
008532
008533     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
008534        PB-C-AH-CANCEL-AMT = ZEROS
008535          MOVE 'N'                 TO WS-AH-CANCEL-SW
008536      ELSE
008537          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
008538
008539     EVALUATE TRUE
008540         WHEN PB-CANCEL-FORCE             OR
008541              PB-CANCEL-DATE-FORCED       OR
008542              PB-FORCE-OFF
008543                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
008544                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
008545                  END-IF
008546         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
008547               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
008548              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
008549                  MOVE ZEROES TO PB-CI-CANCEL-FEE
008550         WHEN OTHER
008551              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
008552                 MOVE ER-2794              TO WS-ERROR
008553              ELSE
008554                 MOVE ER-2749              TO WS-ERROR
008555              END-IF
008556              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
008557     END-EVALUATE.
008558
008559
008560*    IF  PB-COMPANY-ID    EQUAL    'HER'
008561*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
008562*            MOVE  ER-1909            TO  WS-ERROR
008563*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
008564*        ELSE
008565*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
008566
008567     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
008568     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
008569        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
008570     ELSE
008571        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
008572     END-IF
008573     .
008574 3705-EDIT-CANCEL-DT.
008575
008576     IF LF-COVERAGE-CANCELLED
008577        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
008578         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
008579         MOVE WS-CURRENT-MONTH-END
008580                                 TO DC-BIN-DATE-2
008581         SET ELAPSED-BETWEEN-BIN TO TRUE
008582*        MOVE 1                  TO DC-OPTION-CODE
008583         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
008584         IF DATE-CONVERSION-ERROR
008585            NEXT SENTENCE
008586          ELSE
008587             IF DC-ELAPSED-DAYS GREATER +180
008588                IF PB-CANCEL-DATE-FORCED  OR
008589                   PB-CANCEL-DATE-FORCED-NO-FEE
008590                      MOVE ER-2751  TO WS-ERROR
008591                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
008592                 ELSE
008593                   MOVE ER-2752  TO WS-ERROR
008594                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008595
008596     IF AH-COVERAGE-CANCELLED
008597        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
008598         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
008599         MOVE WS-CURRENT-MONTH-END
008600                                 TO DC-BIN-DATE-2
008601         SET ELAPSED-BETWEEN-BIN TO TRUE
008602*        MOVE 1                  TO DC-OPTION-CODE
008603         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
008604         IF DATE-CONVERSION-ERROR
008605            NEXT SENTENCE
008606          ELSE
008607             IF DC-ELAPSED-DAYS GREATER +180
008608                IF PB-CANCEL-DATE-FORCED OR
008609                   PB-CANCEL-DATE-FORCED-NO-FEE
008610                      MOVE ER-2751  TO WS-ERROR
008611                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
008612                 ELSE
008613                   MOVE ER-2752  TO WS-ERROR
008614                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008615
008616     IF WS-ERROR = ER-2752
008617        AND (PB-COMPANY-ID = 'ABL'
008618         OR  PB-COMPANY-ID = 'FGL'
008619         OR  PB-COMPANY-ID = 'IST'
008620         OR  PB-COMPANY-ID = 'JHL'
008621         OR  PB-COMPANY-ID = 'LAP'
008622         OR  PB-COMPANY-ID = 'LBL'
008623         OR  PB-COMPANY-ID = 'NCB'
008624         OR  PB-COMPANY-ID = 'NLI'
008625         OR  PB-COMPANY-ID = 'OFI'
008626         OR  PB-COMPANY-ID = 'PLI'
008627         OR  PB-COMPANY-ID = 'TAO'
008628         OR  PB-COMPANY-ID = 'TIC'
008629         OR  PB-COMPANY-ID = 'HER'
008630         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
008631         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
008632            SUBTRACT +1          FROM PB-NO-OF-ERRORS
008633            MOVE ER-2762     TO WS-ERROR
008634            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008635
008636     IF LF-COVERAGE-CANCELLED
008637        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
008638        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
008639             MOVE ER-2733         TO WS-ERROR
008640             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008641
008642     IF AH-COVERAGE-CANCELLED
008643        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
008644        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
008645              MOVE ER-2733        TO WS-ERROR
008646              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008647
008648     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
008649        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
008650        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
008651           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
008652            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
008653              IF PB-COMPANY-ID NOT = 'LAP'
008654               MOVE ER-2704            TO WS-ERROR
008655               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
008656
008657     IF CERT-WAS-NOT-FOUND
008658         GO TO 3999-END-EDIT.
008659
008660     IF PB-COMPANY-ID EQUAL 'CDC'
008661        IF LF-COVERAGE-CANCELLED
008662           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
008663            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
008664            MOVE PB-C-LF-CANCEL-DT
008665                                 TO DC-BIN-DATE-2
008666            SET ELAPSED-BETWEEN-BIN TO TRUE
008667*           MOVE 1               TO DC-OPTION-CODE
008668            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
008669            IF DATE-CONVERSION-ERROR
008670               NEXT SENTENCE
008671             ELSE
008672                IF DC-ELAPSED-DAYS GREATER +60
008673                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
008674
008675     IF PB-COMPANY-ID EQUAL 'CDC'
008676        IF AH-COVERAGE-CANCELLED
008677           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
008678            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
008679            MOVE PB-C-AH-CANCEL-DT
008680                                 TO DC-BIN-DATE-2
008681            MOVE +0              TO DC-ELAPSED-DAYS
008682                                    DC-ELAPSED-MONTHS
008683            SET ELAPSED-BETWEEN-BIN  TO TRUE
008684*           MOVE 1               TO DC-OPTION-CODE
008685            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
008686            IF DATE-CONVERSION-ERROR
008687               NEXT SENTENCE
008688             ELSE
008689                IF DC-ELAPSED-DAYS GREATER +60
008690                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
008691
008692     MOVE +0                     TO DC-ELAPSED-DAYS
008693                                    DC-ELAPSED-MONTHS.
008694
008695     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
008696        (WS-AH-SPECIAL-CALC-CD = 'Z')
008697          MOVE 'Z'                TO PB-CI-OB-FLAG
008698          MOVE ER-2767            TO WS-ERROR
008699          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
008700          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
008701          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
008702          GO TO 3775-OVER-REF-CHK
008703        ELSE
008704          MOVE ZEROS              TO PB-CI-LIVES
008705                                     PB-C-LIVES
008706          IF PB-CI-OB-FLAG NOT = 'B'
008707             MOVE SPACE           TO PB-CI-OB-FLAG.
008708
008709     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
008710         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
008711     ELSE
008712         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
008713
008714     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
008715        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
008716            MOVE ER-2760         TO WS-ERROR
008717            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008718
008719     IF LF-COVERAGE-CANCELLED
008720        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
008721         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
008722            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
008723               MOVE ER-2774       TO WS-ERROR
008724               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008725
008726     IF AH-COVERAGE-CANCELLED
008727        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
008728         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
008729            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
008730               MOVE ER-2775       TO WS-ERROR
008731               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008732
008733     IF LF-COVERAGE-CANCELLED
008734        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
008735         IF PB-C-LF-CANCEL-DT = LOW-VALUES
008736            MOVE ER-2776         TO WS-ERROR
008737            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008738
008739     IF AH-COVERAGE-CANCELLED
008740        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
008741         IF PB-C-AH-CANCEL-DT = LOW-VALUES
008742            MOVE ER-2777         TO WS-ERROR
008743            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008744
008745     IF LF-COVERAGE-CANCELLED
008746        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
008747        if pb-ci-lf-expire-dt = low-values or spaces
008748           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
008749           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
008750           MOVE PB-CI-EXTENTION-DAYS
008751                                 TO DC-ELAPSED-DAYS
008752           SET BIN-PLUS-ELAPSED  TO TRUE
008753           PERFORM 8500-DATE-CONVERT
008754                                 THRU 8500-EXIT
008755           IF DATE-CONVERSION-ERROR
008756              move low-values    to dc-bin-date-2
008757           end-if
008758        else
008759           move pb-ci-lf-expire-dt
008760                                 to dc-bin-date-2
008761        end-if
008762        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
008763           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
008764                             OR  'FIA'
008765              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
008766           ELSE
008767              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
008768              MOVE ER-2731       TO WS-ERROR
008769              PERFORM 9900-ERROR-FORMAT
008770                                 THRU 9900-EXIT
008771           end-if
008772        end-if
008773     end-if
008774
008775*    IF LF-COVERAGE-CANCELLED
008776*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
008777*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
008778*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
008779*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
008780*        SET BIN-PLUS-ELAPSED      TO TRUE
008781*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
008782*        IF DATE-CONVERSION-ERROR
008783*           NEXT SENTENCE
008784*         ELSE
008785*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
008786*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
008787*                            OR  'FIA'
008788*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
008789*              ELSE
008790*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
008791*               MOVE ER-2731       TO WS-ERROR
008792*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008793     .
008794 3705-EDIT-AH-CANCEL-DT.
008795
008796     IF AH-COVERAGE-CANCELLED
008797        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
008798        if pb-ci-AH-expire-dt = low-values or spaces
008799           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
008800           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
008801           MOVE PB-CI-EXTENTION-DAYS
008802                                 TO DC-ELAPSED-DAYS
008803           SET BIN-PLUS-ELAPSED  TO TRUE
008804           PERFORM 8500-DATE-CONVERT
008805                                 THRU 8500-EXIT
008806           IF DATE-CONVERSION-ERROR
008807              move low-values    to dc-bin-date-2
008808           end-if
008809        else
008810           move pb-ci-ah-expire-dt
008811                                 to dc-bin-date-2
008812        end-if
008813        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
008814           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
008815                             OR  'FIA'
008816              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
008817           ELSE
008818              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
008819              MOVE ER-2771       TO WS-ERROR
008820              PERFORM 9900-ERROR-FORMAT
008821                                 THRU 9900-EXIT
008822           end-if
008823        end-if
008824     end-if
008825
008826*    IF AH-COVERAGE-CANCELLED
008827*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
008828*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
008829*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
008830*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
008831**       MOVE 6                    TO DC-OPTION-CODE
008832*        SET BIN-PLUS-ELAPSED      TO TRUE
008833*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
008834*        IF DATE-CONVERSION-ERROR
008835*           NEXT SENTENCE
008836*         ELSE
008837*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
008838*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
008839*                             OR 'FIA'
008840*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
008841*             ELSE
008842*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
008843*              MOVE ER-2771       TO WS-ERROR
008844*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008845     .
008846 3705-EDIT-CONTINUED.
008847
008848*    IF LF-COVERAGE-CANCELLED
008849*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
008850*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
008851*            MOVE ER-2727         TO WS-ERROR
008852*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008853*
008854*    IF AH-COVERAGE-CANCELLED
008855*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
008856*        IF PB-COMPANY-ID = 'ACE'
008857*           MOVE ER-2727        TO WS-ERROR
008858*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
008859*        ELSE
008860*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
008861*              MOVE ER-2727     TO WS-ERROR
008862*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008863
008864     IF PB-COMPANY-ID = 'ACE'
008865       IF AH-COVERAGE-CANCELLED
008866         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
008867           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
008868              MOVE ER-2732      TO WS-ERROR
008869              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008870
008871     IF PB-COMPANY-ID      EQUAL   'HER'
008872        IF WS-ERROR        EQUAL   ER-2727
008873            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
008874            MOVE  ER-2725          TO  WS-ERROR
008875            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
008876
008877     IF PB-C-CLAIM-CREATED-CANCEL
008878            MOVE ER-2748         TO WS-ERROR
008879            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008880
008881     IF PB-C-LAST-NAME NOT = SPACES
008882         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
008883            MOVE ER-2747         TO WS-ERROR
008884            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008885
008886 3710-EDIT-LUMP-SUM-PRIOR.
008887
008888     IF AH-COVERAGE-CANCELLED
008889         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
008890             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
008891                MOVE ER-2735    TO WS-ERROR
008892                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008893
008894     IF LF-COVERAGE-CANCELLED
008895         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
008896             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
008897                MOVE ER-2735    TO WS-ERROR
008898                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008899
008900 3710-EDIT-PRIOR-DEATH.
008901
008902*    IF LF-COVERAGE-CANCELLED
008903*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
008904*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
008905*           (NOT PB-CI-OB)
008906*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
008907*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
008908*                   MOVE ER-2732  TO WS-ERROR
008909*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008910*
008911*    IF AH-COVERAGE-CANCELLED
008912*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
008913*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
008914*           (NOT PB-CI-OB)
008915*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
008916*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
008917*                   MOVE ER-2732  TO WS-ERROR
008918*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008919
008920     IF PB-CI-DEATH-DT NOT = LOW-VALUES
008921         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
008922            (NOT PB-COMP-LF-CANCEL)
008923             NEXT SENTENCE
008924         ELSE
008925           IF PB-C-LF-CANCEL-VOIDED
008926              NEXT SENTENCE
008927           ELSE
008928              MOVE ER-2753      TO WS-ERROR
008929              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
008930
008931     IF CANCEL-FUTURE-DT
008932         GO TO 3999-END-EDIT.
008933
008934 3715-GET-REMAIN-TERM-LF.
008935
008936     IF NO-LF-BENEFIT-MATCH  OR
008937        WS-LF-BENEFIT-CD = ZEROS
008938        GO TO 3730-GET-AH-REMAIN-TERM.
008939
008940     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
008941     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
008942     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
008943     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
008944     MOVE PB-SV-STATE            TO CP-STATE.
008945     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
008946     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
008947     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
008948     MOVE '2'                    TO CP-PROCESS-TYPE.
008949     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
008950     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
008951     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
008952
008953     IF (PB-COMPANY-ID = 'CID')
008954        AND (CP-STATE-STD-ABBRV = 'WI')
008955        MOVE '7'                 TO CP-REM-TERM-METHOD
008956        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
008957     ELSE
008958        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
008959        MOVE WS-REM-TRM-CALC-OPTION
008960                                 TO CP-REM-TRM-CALC-OPTION
008961     END-IF
008962
008963**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
008964     IF (PB-COMPANY-ID = 'CID')
008965        AND (CP-STATE-STD-ABBRV = 'MO')
008966        AND (PB-CERT-EFF-DT >= X'9B41')
008967        AND (PB-CERT-EFF-DT <= X'A2FB')
008968        MOVE '7'                 TO CP-REM-TERM-METHOD
008969        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
008970     END-IF
008971
008972     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
008973                                    CP-LOAN-TERM.
008974     IF CP-TRUNCATED-LIFE
008975        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
008976
008977     IF CP-TERM-IS-DAYS
008978         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
008979     ELSE
008980         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
008981
008982     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
008983
008984     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
008985
008986     IF LF-COVERAGE-CANCELLED
008987        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
008988        NEXT SENTENCE
008989      ELSE
008990          GO TO 3730-GET-AH-REMAIN-TERM.
008991
008992 3720-GET-LF-REFUND.
008993
008994     IF PB-C-LF-CANCEL-VOIDED
008995        GO TO 3730-GET-AH-REMAIN-TERM
008996     end-if
008997
008998     IF PB-COMPANY-ID EQUAL 'BOA'
008999         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
009000         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
009001         GO TO 3730-GET-AH-REMAIN-TERM.
009002
009003     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
009004        (WS-AH-SPECIAL-CALC-CD = 'M')
009005         MOVE ER-2767            TO WS-ERROR
009006         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009007         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
009008         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
009009         GO TO 3780-UPDATE-CANCEL-CERT.
009010
009011*    if (ws-lf-earnings-calc = '6')
009012*       or (pb-c-lf-refund-override = '6')
009013*       move cp-remaining-term-1 to cp-remaining-term-2
009014*    end-if
009015     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
009016
009017     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
009018     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
009019     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
009020     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
009021     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
009022     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
009023
009024     IF PB-COMPANY-ID = 'DCC'
009025        AND (AM-DCC-PRODUCT-CODE = 'DDF')
009026
009027        IF PDEF-MASTER-FOUND
009028           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
009029              (V1 > +8)
009030              OR (PD-PROD-CODE (V1) = 'L')
009031           END-PERFORM
009032           IF V1 < +9
009033              MOVE PD-MAX-AMT (V1)
009034                           TO CP-R-MAX-TOT-BEN
009035                              EC-AM-LF-MAX-TOT-BEN
009036           END-IF
009037        ELSE
009038
009039        MOVE ' '                 TO PDEF-MASTER-SW
009040        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
009041        MOVE PB-STATE            TO ERPDEF-STATE
009042        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
009043           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
009044        END-IF
009045        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
009046        MOVE 'A'                 TO ERPDEF-BEN-TYPE
009047        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
009048        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
009049        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
009050        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
009051        IF PDEF-MASTER-FOUND
009052           MOVE 'N'              TO PDEF-MASTER-SW
009053           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
009054           IF PDEF-MASTER-FOUND
009055              IF (ERPDEF-KEY-SAVE (1:16) =
009056                           PD-CONTROL-PRIMARY (1:16))
009057                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
009058                 CONTINUE
009059              ELSE
009060                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
009061                 IF (ERPDEF-KEY-SAVE (1:16) =
009062                           PD-CONTROL-PRIMARY (1:16))
009063                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
009064                    CONTINUE
009065                 ELSE
009066                    MOVE 'N'     TO PDEF-MASTER-SW
009067                 END-IF
009068              END-IF
009069
009070              IF PDEF-MASTER-FOUND
009071                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
009072                    (V1 > +8)
009073                    OR (PD-PROD-CODE (V1) = 'L')
009074                 END-PERFORM
009075                 IF V1 < +9
009076                    MOVE PD-MAX-AMT (V1)
009077                                 TO CP-R-MAX-TOT-BEN
009078                                    EC-AM-LF-MAX-TOT-BEN
009079                 END-IF
009080              END-IF
009081           END-IF
009082           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
009083        END-IF
009084        END-IF
009085     END-IF
009086
009087     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
009088
009089     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
009090
009091     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
009092                                    PB-C-LF-REM-TERM.
009093
009094     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
009095     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
009096
009097     IF PB-COMPANY-ID EQUAL 'FLC'
009098        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
009099           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
009100           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
009101                    + PB-CI-LF-ALT-PREMIUM-AMT)
009102                    - CM-LF-ITD-DEATH-AMT
009103           IF PB-C-LF-REF-CALC LESS THAN +0
009104              MOVE +0            TO PB-C-LF-REF-CALC
009105              GO TO 3730-GET-AH-REMAIN-TERM
009106           ELSE
009107              GO TO 3730-GET-AH-REMAIN-TERM.
009108
009109     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
009110                            OR '4' OR '5' OR '6' OR '8'
009111                            OR '9' OR 'G'
009112        MOVE PB-C-LF-REFUND-OVERRIDE
009113                                 TO CP-EARNING-METHOD.
009114
009115     if pb-company-id = 'AHL'
009116        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
009117        if cp-class-code = spaces
009118           move zeros            to cp-class-code
009119        end-if
009120     ELSE
009121        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
009122     END-IF
009123
009124*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
009125     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
009126     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
009127                                    CP-RATING-BENEFIT-AMT.
009128     IF CP-STATE-STD-ABBRV = 'OR'
009129         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
009130                                         PB-CI-LF-ALT-BENEFIT-AMT.
009131     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
009132     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
009133     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
009134     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
009135     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
009136     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
009137     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
009138     IF WS-DEFAULT-APR NOT NUMERIC
009139         MOVE ZEROS TO WS-DEFAULT-APR.
009140
009141****   N O T E   ****
009142*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
009143*      THE OH HARD CODING IN ELCRFNDP
009144
009145     IF PB-COMPANY-ID = 'CID'
009146        IF CP-STATE-STD-ABBRV = 'OH'
009147           MOVE WS-LF-EARNINGS-CALC
009148                                 TO CP-EARNING-METHOD
009149        END-IF
009150     END-IF
009151
009152****   N O T E   ****
009153
009154*    IF CP-EARN-AS-NET-PAY
009155*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
009156*           IF WS-DEFAULT-APR GREATER THAN ZEROS
009157*               MOVE WS-DEFAULT-APR
009158*                                TO  CP-LOAN-APR
009159*               MOVE ER-3780     TO  WS-ERROR
009160*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
009161*           ELSE
009162*               MOVE ER-3781     TO  WS-ERROR
009163*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
009164
009165*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
009166
009167     move ' '                    to cp-ext-days-calc
009168     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
009169
009170     IF CP-REFUND-TYPE-USED NOT = SPACE
009171         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
009172
009173     IF CP-ERROR-RATE-IS-ZERO OR
009174        CP-ERROR-RATE-NOT-FOUND
009175        MOVE ER-2740             TO WS-ERROR
009176        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009177
009178     IF CP-ERROR-RATE-FILE-NOTOPEN
009179        MOVE ER-2617             TO WS-ERROR
009180        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009181
009182     IF PB-COMPANY-ID = 'DCC' or 'VPP'
009183        AND PB-CI-ENTRY-STATUS = 'M'
009184        MOVE +0                  TO PB-C-LF-REF-CALC
009185     ELSE
009186        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
009187     END-IF
009188
009189     IF WS-LF-EARNINGS-CALC NOT = 'B'
009190         GO TO 3730-GET-AH-REMAIN-TERM.
009191
009192*    IF WS-LF-SPECIAL-CALC-CD = 'L'
009193*       ADD +1                   TO PB-C-LF-REM-TERM
009194*                                   CP-REMAINING-TERM
009195*                                   CP-ORIGINAL-TERM.
009196
009197     MOVE 'L'                    TO CP-BENEFIT-TYPE.
009198     MOVE '2'                    TO CP-EARNING-METHOD
009199                                    CP-RATING-METHOD.
009200
009201     IF PB-COMPANY-ID = 'CID'
009202        IF (CP-STATE-STD-ABBRV = 'MN')
009203           AND (PB-CERT-EFF-DT > X'A4FF')
009204           AND (WS-LF-EARNINGS-CALC = 'B')
009205           MOVE '5'              TO CP-EARNING-METHOD
009206           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
009207        END-IF
009208     END-IF
009209
009210     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
009211                                        CP-REMAINING-BENEFIT
009212                                        CP-RATING-BENEFIT-AMT.
009213     IF CP-STATE-STD-ABBRV = 'OR'
009214         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
009215                                         PB-CI-LF-ALT-BENEFIT-AMT.
009216     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
009217     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
009218
009219     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
009220
009221     IF CP-ERROR-RATE-IS-ZERO OR
009222        CP-ERROR-RATE-NOT-FOUND
009223        MOVE ER-2740             TO WS-ERROR
009224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009225
009226     IF CP-ERROR-RATE-FILE-NOTOPEN
009227        MOVE ER-2617             TO WS-ERROR
009228        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009229
009230     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
009231
009232******************************************************************
009233
009234     EJECT
009235 3730-GET-AH-REMAIN-TERM.
009236     IF NO-AH-BENEFIT-MATCH  OR
009237        WS-AH-BENEFIT-CD = ZEROS
009238         GO TO 3770-CHECK-REFUNDS.
009239
009240     IF PB-CI-AH-LUMP-SUM-DISAB
009241         IF  PB-C-AH-CANCEL-AMT = ZERO
009242            IF NOT PB-COMP-AH-CANCEL
009243             GO TO 3770-CHECK-REFUNDS.
009244
009245     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
009246     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
009247     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
009248     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
009249     MOVE PB-SV-STATE            TO CP-STATE.
009250     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
009251     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
009252     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
009253     MOVE '2'                    TO CP-PROCESS-TYPE.
009254     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
009255     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
009256     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
009257
009258     IF (PB-COMPANY-ID = 'CID')
009259        AND (CP-STATE-STD-ABBRV = 'WI')
009260        MOVE '7'                 TO CP-REM-TERM-METHOD
009261        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
009262     ELSE
009263        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
009264        MOVE WS-REM-TRM-CALC-OPTION
009265                                 TO CP-REM-TRM-CALC-OPTION
009266     END-IF
009267
009268     IF (PB-COMPANY-ID = 'CID')
009269        AND (CP-STATE-STD-ABBRV = 'MO')
009270        AND (PB-CERT-EFF-DT >= X'9B41')
009271        AND (PB-CERT-EFF-DT <= X'A2FB')
009272        MOVE '7'                 TO CP-REM-TERM-METHOD
009273        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
009274     END-IF
009275
009276     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
009277                                    CP-LOAN-TERM.
009278     IF NOT CP-TERM-IS-DAYS
009279         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
009280
009281     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
009282
009283     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
009284
009285     IF AH-COVERAGE-CANCELLED
009286        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
009287        NEXT SENTENCE
009288      ELSE
009289         GO TO 3770-CHECK-REFUNDS.
009290
009291 3740-GET-AH-REFUND.
009292
009293     IF PB-C-AH-CANCEL-VOIDED
009294        GO TO 3780-UPDATE-CANCEL-CERT
009295     END-IF
009296
009297     IF PB-COMPANY-ID = 'BOA'
009298         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
009299         GO TO 3770-CHECK-REFUNDS.
009300
009301     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
009302*    MOVE ' '                    TO DC-OPTION-CODE
009303     SET BIN-TO-GREG             TO TRUE
009304     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
009305     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
009306                                    PB-C-AH-REM-TERM.
009307     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
009308     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
009309
009310     IF PB-COMPANY-ID EQUAL 'FLC'
009311        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
009312           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
009313           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
009314                    - CM-AH-ITD-AH-PMT)
009315           IF PB-C-AH-REF-CALC LESS THAN +0
009316              MOVE +0            TO PB-C-AH-REF-CALC
009317              GO TO 3770-CHECK-REFUNDS
009318           ELSE
009319              GO TO 3770-CHECK-REFUNDS.
009320
009321     IF PB-COMPANY-ID = 'DCC'
009322        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
009323            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
009324           MOVE 'S'              TO CP-EARNING-METHOD
009325        END-IF
009326     END-IF
009327
009328     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
009329                            OR '4' OR '5' OR '6' OR '8'
009330                            OR '9' OR 'G' OR 'S'
009331        MOVE PB-C-AH-REFUND-OVERRIDE
009332                                 TO CP-EARNING-METHOD.
009333
009334     if pb-company-id = 'AHL'
009335        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
009336        if cp-class-code = spaces
009337           move zeros            to cp-class-code
009338        end-if
009339     ELSE
009340        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
009341     END-IF
009342*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
009343     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
009344     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
009345                                    CP-RATING-BENEFIT-AMT.
009346     IF CP-STATE-STD-ABBRV = 'OR'
009347         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
009348                                         PB-CI-AH-TERM.
009349     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
009350     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
009351     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
009352     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
009353     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
009354     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
009355
009356     IF CP-STATE-STD-ABBRV = 'OH'
009357        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
009358                                AND 'CID' AND 'DCC' and 'VPP'
009359                                AND 'AHL')
009360           IF (CP-ORIGINAL-TERM GREATER 60) AND
009361              (DC-GREG-DATE-CYMD GREATER 19831101) AND
009362              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
009363              MOVE '6' TO CP-EARNING-METHOD
009364           END-IF
009365        END-IF
009366        IF PB-COMPANY-ID = 'CID'
009367           IF NO-LIFE-COVERAGE
009368              IF CP-CRITICAL-PERIOD
009369                 MOVE '2'       TO CP-EARNING-METHOD
009370              ELSE
009371                 MOVE '6'       TO CP-EARNING-METHOD
009372              END-IF
009373           ELSE
009374              IF WS-LF-COVERAGE-TYPE = 'L'
009375                 MOVE '2'       TO CP-EARNING-METHOD
009376              ELSE
009377                 IF (PB-CI-LF-TERM > +60) OR
009378                    (WS-LF-EARNINGS-CALC = '5')
009379                    IF CP-CRITICAL-PERIOD
009380                       MOVE '2'  TO CP-EARNING-METHOD
009381                    ELSE
009382                       MOVE '6'  TO CP-EARNING-METHOD
009383                    END-IF
009384                 ELSE
009385                    MOVE '1'     TO CP-EARNING-METHOD
009386                 END-IF
009387              END-IF
009388           END-IF
009389        END-IF
009390     END-IF
009391
009392*    IF CP-STATE-STD-ABBRV = 'VA'
009393*       IF DC-GREG-DATE-CYMD GREATER 19921231
009394*          IF CP-ORIGINAL-TERM GREATER 61
009395*             MOVE '6' TO CP-EARNING-METHOD
009396*          ELSE
009397*             MOVE '1' TO CP-EARNING-METHOD.
009398
009399     IF WS-DEFAULT-APR NOT NUMERIC
009400         MOVE ZEROS TO WS-DEFAULT-APR.
009401
009402     IF CP-EARN-AS-NET-PAY
009403         IF CP-LOAN-APR NOT GREATER THAN ZEROS
009404            IF WS-DEFAULT-APR GREATER THAN ZEROS
009405                MOVE WS-DEFAULT-APR
009406                                 TO  CP-LOAN-APR
009407                MOVE ER-3780     TO  WS-ERROR
009408                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
009409            ELSE
009410                MOVE ER-3781     TO  WS-ERROR
009411                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
009412
009413     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
009414
009415
009416     IF PB-COMPANY-ID = 'DCC'
009417        AND CP-CANCEL-REASON = 'R'
009418        MOVE 'G'                 TO CP-DDF-SPEC-CALC
009419        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
009420     END-IF
009421
009422     IF PB-COMPANY-ID = 'DCC'
009423        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
009424        AND (CP-EARNING-METHOD = 'D')
009425        AND (CP-CANCEL-REASON NOT = 'R')
009426        CONTINUE
009427     ELSE
009428        GO TO 3750-CONTINUE
009429     END-IF
009430
009431     MOVE ' '                    TO DD-IU-SW
009432     IF NOT PDEF-MASTER-FOUND
009433        MOVE ' '                 TO PDEF-MASTER-SW
009434        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
009435        MOVE PB-STATE            TO ERPDEF-STATE
009436        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
009437           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
009438        END-IF
009439        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
009440        MOVE 'A'                 TO ERPDEF-BEN-TYPE
009441        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
009442        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
009443        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
009444        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
009445        IF PDEF-MASTER-FOUND
009446           MOVE 'N'              TO PDEF-MASTER-SW
009447           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
009448           IF PDEF-MASTER-FOUND
009449              IF (ERPDEF-KEY-SAVE (1:16) =
009450                           PD-CONTROL-PRIMARY (1:16))
009451                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
009452                 CONTINUE
009453              ELSE
009454                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
009455                 IF (ERPDEF-KEY-SAVE (1:16) =
009456                           PD-CONTROL-PRIMARY (1:16))
009457                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
009458                    CONTINUE
009459                 ELSE
009460                    MOVE ER-2740 TO WS-ERROR
009461                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009462                    GO TO 3770-CHECK-REFUNDS
009463                 END-IF
009464              END-IF
009465           END-IF
009466           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
009467        END-IF
009468     END-IF
009469
009470     IF PDEF-MASTER-FOUND
009471        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
009472           (V1 > +8)
009473           OR (PD-PROD-CODE (V1) = 'I')
009474        END-PERFORM
009475        IF V1 < +9
009476           SET DD-IU-PRESENT        TO TRUE
009477        END-IF
009478        IF WS-AH-DCC-TRUNC = 'T'
009479           MOVE PB-CI-LOAN-TERM     TO WS-TERM
009480        ELSE
009481           MOVE CP-ORIGINAL-TERM    TO WS-TERM
009482        END-IF
009483        EVALUATE TRUE
009484           WHEN WS-TERM > +168
009485              MOVE 15               TO V1
009486           WHEN WS-TERM > +156
009487              MOVE 14               TO V1
009488           WHEN WS-TERM > +144
009489              MOVE 13               TO V1
009490           WHEN WS-TERM > +132
009491              MOVE 12               TO V1
009492           WHEN WS-TERM > +120
009493              MOVE 11               TO V1
009494           WHEN WS-TERM > +108
009495              MOVE 10               TO V1
009496           WHEN WS-TERM > +96
009497              MOVE 9                TO V1
009498           WHEN WS-TERM > +84
009499              MOVE 8                TO V1
009500           WHEN WS-TERM > +72
009501              MOVE 7                TO V1
009502           WHEN WS-TERM > +60
009503              MOVE 6                TO V1
009504           WHEN WS-TERM > +48
009505              MOVE 5                TO V1
009506           WHEN WS-TERM > +36
009507              MOVE 4                TO V1
009508           WHEN WS-TERM > +24
009509              MOVE 3                TO V1
009510           WHEN WS-TERM > +12
009511              MOVE 2                TO V1
009512           WHEN OTHER
009513              MOVE 1                TO V1
009514        END-EVALUATE
009515
009516        EVALUATE TRUE
009517*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
009518*             < +13)
009519*             AND (DD-IU-PRESENT)
009520*             MOVE 2                TO V2
009521*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
009522*             MOVE 1                TO V2
009523           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
009524              MOVE 2                TO V2
009525           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
009526              MOVE 3                TO V2
009527           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
009528              MOVE 4                TO V2
009529           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
009530              MOVE 5                TO V2
009531           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
009532              MOVE 6                TO V2
009533           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
009534              MOVE 7                TO V2
009535           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
009536              MOVE 8                TO V2
009537           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
009538              MOVE 9                TO V2
009539           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
009540              MOVE 10               TO V2
009541           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
009542              MOVE 11               TO V2
009543           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
009544              MOVE 12               TO V2
009545           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
009546              MOVE 13               TO V2
009547           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
009548              MOVE 14               TO V2
009549           WHEN OTHER
009550              MOVE 15               TO V2
009551        END-EVALUATE
009552
009553        MOVE PD-UEP-FACTOR (V1 V2 + 1)
009554                                 TO CP-DDF-LO-FACT
009555        MOVE PD-UEP-FACTOR (V1 V2)
009556                                 TO CP-DDF-HI-FACT
009557
009558        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
009559        MOVE CM-AH-CLP     TO CP-DDF-CLP
009560
009561        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
009562           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
009563        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
009564        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
009565
009566        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
009567           + PD-1ST-YR-ADMIN-ALLOW
009568
009569        MOVE 'G'                 TO CP-DDF-SPEC-CALC
009570*       IF PI-CLP-YN = 'Y'
009571*          MOVE 'C'              TO CP-DDF-SPEC-CALC
009572*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
009573*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
009574*       END-IF
009575
009576        IF DD-IU-PRESENT
009577           MOVE 'I'              TO CP-EARNING-METHOD
009578        END-IF
009579        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
009580                                     CP-CLP-RATE-UP
009581        IF CP-IU-RATE-UP NOT = ZEROS
009582           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
009583              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
009584           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
009585              / (1 - WS-WORK-FACT)
009586        END-IF
009587     END-IF
009588
009589     .
009590 3750-CONTINUE.
009591
009592     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
009593
009594     IF CP-REFUND-TYPE-USED NOT = SPACE
009595         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
009596
009597     IF CP-ERROR-RATE-IS-ZERO OR
009598        CP-ERROR-RATE-NOT-FOUND
009599        MOVE ER-2740             TO WS-ERROR
009600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009601
009602     IF CP-ERROR-RATE-FILE-NOTOPEN
009603        MOVE ER-2617             TO WS-ERROR
009604        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009605
009606     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
009607        AND (PB-CI-ENTRY-STATUS = 'M')
009608        MOVE +0                  TO PB-C-AH-REF-CALC
009609     ELSE
009610        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
009611     END-IF
009612
009613     if pb-company-id = 'VPP'
009614        MOVE cm-ah-clp           to cp-original-premium
009615        move zeros               to cp-calc-refund
009616        perform 7600-get-refund  thru 7600-exit
009617        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
009618           move cp-calc-refund   to pb-c-ah-rfnd-clp
009619        else
009620           move zeros            to pb-c-ah-rfnd-clp
009621        end-if
009622        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
009623           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
009624           pb-ci-cancel-fee
009625     end-if
009626     IF PB-COMPANY-ID = 'DCC'
009627        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
009628        AND (CP-EARNING-METHOD = 'D' OR 'I')
009629        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
009630        MOVE 'C'                 TO CP-DDF-SPEC-CALC
009631        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
009632        MOVE ZEROS               TO CP-1ST-YR-ALLOW
009633        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
009634        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
009635*       if pb-c-cancel-amt < +0
009636*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
009637*       end-if
009638*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
009639     END-IF
009640
009641     .
009642 3770-CHECK-REFUNDS.
009643
009644     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
009645        IF PB-C-LF-CANCEL-VOID-SW = SPACE
009646           MOVE ER-2766          TO WS-ERROR
009647           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009648           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
009649           IF PB-C-LF-REF-CALC LESS THAN ZERO
009650              MOVE ZEROS         TO PB-C-LF-REF-CALC.
009651
009652     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
009653        IF PB-C-AH-CANCEL-VOID-SW = SPACE
009654           MOVE ER-2766          TO WS-ERROR
009655           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009656           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
009657           IF PB-C-AH-REF-CALC LESS THAN ZERO
009658              MOVE ZEROS         TO PB-C-AH-REF-CALC.
009659
009660     IF PB-COMP-LF-CANCEL
009661        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
009662        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
009663           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
009664              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
009665
009666     IF PB-COMP-AH-CANCEL
009667        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
009668        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
009669           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
009670              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
009671
009672     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
009673             GIVING WS-UNSIGN-WRK1
009674     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
009675             GIVING WS-UNSIGN-WRK2.
009676
009677     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
009678         MOVE ZERO TO WS-UNSIGN-WRK1.
009679
009680     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
009681         MOVE ZERO TO WS-UNSIGN-WRK2.
009682
009683     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
009684
009685 EJECT
009686
009687 3772-CONTINUE.
009688
009689**********************************
009690*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
009691*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
009692*** DOUBLES THE TOLERANCE AMOUNT.
009693***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
009694**********************************
009695     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
009696     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
009697         IF WS-REF-REJECT-SW = SPACE
009698             MOVE ER-2754        TO WS-ERROR
009699             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009700           ELSE
009701             MOVE ER-2736        TO WS-ERROR
009702             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009703**********************************
009704
009705 3773-CONTINUE.
009706
009707     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
009708        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
009709           MOVE ER-2723          TO WS-ERROR
009710           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009711
009712     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
009713        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
009714           MOVE ER-2724          TO WS-ERROR
009715           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009716
009717     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
009718         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
009719             (1 + WS-LF-REFUND-OVS-PCT)
009720     ELSE
009721         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
009722
009723     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
009724         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
009725             (1 - WS-TOL-LF-REFUND-PCT)
009726     ELSE
009727         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
009728
009729     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
009730        AND (PB-CI-ENTRY-STATUS = 'M')
009731        AND (PB-C-LF-CANCEL-AMT > +0)
009732        MOVE ER-3843             TO WS-ERROR
009733        PERFORM 9900-ERROR-FORMAT
009734                                 THRU 9900-EXIT
009735     END-IF
009736     EVALUATE TRUE
009737        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
009738           CONTINUE
009739        WHEN PB-C-LF-CANCEL-AMT = +0
009740                 AND PB-C-LF-REF-CALC > +0
009741           CONTINUE
009742        WHEN WS-LF-REFUND-OVS-AMT = 0
009743                 AND WS-TOL-LF-REFUND = 0
009744           CONTINUE
009745        WHEN OTHER
009746           IF WS-TOL-LF-REFUND  = +0
009747              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
009748           END-IF
009749           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
009750                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
009751                          (PB-C-LF-CANCEL-AMT))
009752              CONTINUE
009753           ELSE
009754              IF WS-LF-REFUND-OVS-AMT = +0
009755                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
009756              END-IF
009757              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
009758                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
009759                                       PB-C-LF-CANCEL-AMT)
009760                 CONTINUE
009761              ELSE
009762                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
009763                   MOVE ER-2754   TO  WS-ERROR
009764                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009765                 ELSE
009766                    MOVE ER-2736   TO  WS-ERROR
009767                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009768                 END-IF
009769              END-IF
009770           END-IF
009771     END-EVALUATE.
009772
009773     EVALUATE TRUE
009774        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
009775           CONTINUE
009776        WHEN PB-C-LF-CANCEL-AMT = +0
009777                 AND PB-C-LF-REF-CALC > +0
009778           CONTINUE
009779        WHEN OTHER
009780           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
009781               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
009782              CONTINUE
009783           ELSE
009784              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
009785               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
009786                CONTINUE
009787              ELSE
009788                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
009789                     MOVE ER-2754   TO  WS-ERROR
009790                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009791                 ELSE
009792                     MOVE ER-2736   TO  WS-ERROR
009793                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009794                 END-IF
009795              END-IF
009796           END-IF
009797     END-EVALUATE.
009798
009799     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
009800         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
009801             (1 + WS-AH-REFUND-OVS-PCT)
009802     ELSE
009803         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
009804
009805     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
009806         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
009807             (1 - WS-TOL-AH-REFUND-PCT)
009808     ELSE
009809         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
009810
009811     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
009812        AND (PB-CI-ENTRY-STATUS = 'M')
009813        AND (PB-C-AH-CANCEL-AMT > +0)
009814        MOVE ER-3843             TO WS-ERROR
009815        PERFORM 9900-ERROR-FORMAT
009816                                 THRU 9900-EXIT
009817     END-IF
009818     EVALUATE TRUE
009819        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
009820           CONTINUE
009821*       WHEN PB-C-AH-REF-CALC = +0 AND
009822*                  PB-C-AH-CANCEL-AMT > +0
009823        WHEN PB-C-AH-CANCEL-AMT = +0 AND
009824                   PB-C-AH-REF-CALC > +0
009825           CONTINUE
009826        WHEN WS-AH-REFUND-OVS-AMT = +0
009827                AND WS-TOL-AH-REFUND = +0
009828           CONTINUE
009829        WHEN OTHER
009830           IF WS-TOL-AH-REFUND = +0
009831              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
009832           END-IF
009833           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
009834               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
009835                                         PB-C-AH-CANCEL-AMT)
009836              CONTINUE
009837           ELSE
009838              IF WS-AH-REFUND-OVS-AMT = +0
009839                 MOVE +9999999.99 TO
009840                         WS-AH-REFUND-OVS-AMT
009841              END-IF
009842              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
009843                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
009844                                         PB-C-AH-CANCEL-AMT)
009845                 CONTINUE
009846              ELSE
009847                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
009848                    MOVE ER-2754   TO  WS-ERROR
009849                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009850                 ELSE
009851                    MOVE ER-2736   TO  WS-ERROR
009852                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009853                 END-IF
009854              END-IF
009855           END-IF
009856     END-EVALUATE.
009857
009858     EVALUATE TRUE
009859        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
009860           CONTINUE
009861*       WHEN PB-C-AH-REF-CALC > +0 AND
009862*                  PB-C-AH-CANCEL-AMT = +0
009863        WHEN PB-C-AH-CANCEL-AMT > +0 AND
009864                   PB-C-AH-REF-CALC = +0
009865           CONTINUE
009866        WHEN OTHER
009867           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
009868               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
009869              CONTINUE
009870           ELSE
009871              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
009872                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
009873                 CONTINUE
009874              ELSE
009875                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
009876                     MOVE ER-2754   TO  WS-ERROR
009877                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009878                 ELSE
009879                     MOVE ER-2736   TO  WS-ERROR
009880                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009881                 END-IF
009882              END-IF
009883           END-IF
009884     END-EVALUATE.
009885
009886     IF (PB-C-LF-CANCEL-AMT = ZERO)
009887        AND (PB-C-AH-CANCEL-AMT = ZERO)
009888        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
009889           AND  PB-C-LF-REF-CALC < +1.00
009890           AND  PB-C-AH-REF-CALC < +1.00
009891           CONTINUE
009892        ELSE
009893           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
009894              AND (PB-CI-ENTRY-STATUS = 'M')
009895              CONTINUE
009896           ELSE
009897              MOVE ER-2741       TO WS-ERROR
009898              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
009899           END-IF
009900        END-IF
009901     END-IF
009902
009903     IF (PB-C-LF-CANCEL-AMT = ZERO
009904        AND WS-LF-BENEFIT-CD NOT = ZERO
009905        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
009906        AND PB-C-LF-REF-CALC NOT = ZERO)
009907        OR
009908        (PB-C-LF-CANCEL-AMT = ZERO
009909        AND WS-LF-BENEFIT-CD NOT = ZERO
009910        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
009911             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
009912                AND PB-C-LF-REF-CALC LESS THAN +1.00
009913                NEXT SENTENCE
009914             ELSE
009915                MOVE ER-2739        TO WS-ERROR
009916                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009917
009918     IF (PB-C-AH-CANCEL-AMT = ZERO
009919        AND WS-AH-BENEFIT-CD NOT = ZERO
009920        AND NOT PB-CI-AH-LUMP-SUM-DISAB
009921        AND PB-C-AH-REF-CALC NOT = ZERO)
009922        OR
009923        (PB-C-AH-CANCEL-AMT = ZERO
009924        AND WS-AH-BENEFIT-CD NOT = ZERO
009925        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
009926             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
009927                AND PB-C-AH-REF-CALC LESS THAN +1.00
009928                NEXT SENTENCE
009929             ELSE
009930                MOVE ER-2738        TO WS-ERROR
009931                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009932
009933 3775-OVER-REF-CHK.
009934
009935     IF PB-CI-ENTRY-STATUS = '5'
009936        GO TO 3780-UPDATE-CANCEL-CERT.
009937
009938     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
009939                              PB-CI-LF-ALT-PREMIUM-AMT.
009940
009941     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
009942        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
009943                                 PB-C-LF-REF-CALC
009944      ELSE
009945        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
009946                                 PB-C-LF-CANCEL-AMT.
009947
009948     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
009949        MOVE ER-2755             TO WS-ERROR
009950        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009951
009952     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
009953
009954     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
009955        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
009956                                 PB-C-AH-REF-CALC
009957      ELSE
009958        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
009959                                 PB-C-AH-CANCEL-AMT.
009960
009961     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
009962        MOVE ER-2778             TO WS-ERROR
009963        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009964
009965     IF PB-CI-OB-FLAG NOT = 'Z'
009966        NEXT SENTENCE
009967       ELSE
009968         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
009969            MOVE ER-2757           TO WS-ERROR
009970            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009971
009972 3780-UPDATE-CANCEL-CERT.
009973
009974     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
009975        MOVE ER-2728              TO WS-ERROR
009976        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009977
009978     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
009979         MOVE ER-2729              TO WS-ERROR
009980         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
009981
009982     IF PB-CI-LF-BENEFIT-CD = ZERO
009983         GO TO 3780-UPDATE-CONT-1.
009984
009985     IF PB-C-LF-CANCEL-DT = LOW-VALUE
009986         GO TO 3780-UPDATE-CONT-1.
009987
009988     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
009989       AND
009990        (PB-C-LF-CANCEL-AMT NEGATIVE)
009991       AND
009992        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
009993       AND
009994        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
009995            NEXT SENTENCE
009996       ELSE
009997        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
009998          AND
009999***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
010000***       AND
010001           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
010002            IF PB-C-LF-CANCEL-VOID-SW = SPACE
010003               MOVE ER-2730      TO WS-ERROR
010004               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010005               GO TO 3999-END-EDIT
010006            ELSE
010007               GO TO 3999-END-EDIT
010008        ELSE
010009            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
010010               MOVE ER-2765           TO WS-ERROR
010011               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010012               GO TO 3785-CHECK-REF-INT.
010013*              GO TO 3999-END-EDIT.
010014
010015 3780-UPDATE-CONT-1.
010016     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
010017
010018     IF PB-CI-AH-BENEFIT-CD = ZERO
010019         GO TO 3780-UPDATE-CONT-2.
010020
010021     IF PB-C-AH-CANCEL-DT = LOW-VALUE
010022         GO TO 3780-UPDATE-CONT-2.
010023
010024     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
010025
010026     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
010027       AND
010028        (PB-C-AH-CANCEL-AMT NEGATIVE)
010029       AND
010030        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
010031       AND
010032        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
010033            NEXT SENTENCE
010034       ELSE
010035        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
010036          AND
010037***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
010038***       AND
010039           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
010040           IF WS-AH-CLAIM-RESCINDED <> 'Y'
010041            IF PB-C-AH-CANCEL-VOID-SW = SPACE
010042               MOVE ER-2773      TO WS-ERROR
010043               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010044               GO TO 3999-END-EDIT
010045            ELSE
010046               GO TO 3999-END-EDIT
010047            END-IF
010048           ELSE
010049             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
010050                IF MSTR-CERT-NO = W-CL-CERT-NO
010051                   MOVE ER-2890 TO WS-ERROR
010052                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010053                   GO TO 3999-END-EDIT
010054                ELSE
010055                   MOVE ER-2898 TO WS-ERROR
010056                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010057                   GO TO 3999-END-EDIT
010058                END-IF
010059             ELSE
010060                GO TO 3785-CHECK-REF-INT
010061             END-IF
010062           END-IF
010063          ELSE
010064            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
010065              IF WS-AH-CLAIM-RESCINDED = 'Y'
010066                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
010067                   IF MSTR-CERT-NO = W-CL-CERT-NO
010068                      MOVE ER-2890 TO WS-ERROR
010069                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010070                      GO TO 3999-END-EDIT
010071                   ELSE
010072                      MOVE ER-2898 TO WS-ERROR
010073                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010074                      GO TO 3999-END-EDIT
010075                   END-IF
010076                ELSE
010077                   MOVE ER-2765 TO WS-ERROR
010078                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010079                   GO TO 3785-CHECK-REF-INT
010080                END-IF
010081              ELSE
010082               MOVE ER-2765      TO WS-ERROR
010083               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010084               GO TO 3785-CHECK-REF-INT.
010085*              GO TO 3999-END-EDIT.
010086
010087 3780-UPDATE-CONT-2.
010088
010089     IF PB-C-LF-CANCEL-AMT NOT = ZERO
010090        AND WS-LF-BENEFIT-CD = ZERO
010091           MOVE ER-2743           TO WS-ERROR
010092           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
010093
010094     IF PB-C-AH-CANCEL-AMT NOT = ZERO
010095        AND WS-AH-BENEFIT-CD = ZERO
010096           MOVE ER-2744           TO WS-ERROR
010097           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
010098
010099     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
010100        (PB-C-AH-CANCEL-AMT NEGATIVE))
010101        AND
010102        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
010103         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
010104           MOVE ER-2746           TO WS-ERROR
010105           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
010106
010107     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
010108       AND
010109        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
010110             MOVE ER-2737        TO WS-ERROR
010111             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
010112
010113     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
010114       AND
010115        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
010116             MOVE ER-2737        TO WS-ERROR
010117             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
010118
010119     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
010120         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
010121             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
010122             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
010123         ELSE
010124             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
010125                 MOVE ER-2768    TO WS-ERROR
010126                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010127             ELSE
010128                 MOVE ER-2756    TO WS-ERROR
010129                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
010130
010131     IF CERT-PEND-ISSUE-RETURNED
010132        MOVE ER-2772             TO WS-ERROR
010133        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
010134
010135 3785-CHECK-REF-INT.
010136
010137*    IF PB-STATE NOT = 'NH' and 'TN'
010138     IF PB-STATE NOT = 'NH'
010139        GO TO 3999-END-EDIT
010140     END-IF
010141
010142     MOVE ER-2796                TO WS-ERROR
010143     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
010144
010145     IF (PB-C-REF-INTERFACE-SW = 'Y')
010146        OR (CM-REF-INTERFACE-SW = 'Y')
010147        MOVE ER-2793             TO WS-ERROR
010148        PERFORM 9900-ERROR-FORMAT
010149                                 THRU 9900-EXIT
010150     END-IF
010151
010152     MOVE +0                     TO WS-PAYMENT-AMT
010153     if pb-state = 'NH'
010154        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
010155               PB-C-AH-CANCEL-DT
010156           GO TO 3999-END-EDIT
010157        END-IF
010158     end-if
010159
010160***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
010161***-_-
010162***-_-   For TN it's only flat cancels
010163***-_-
010164***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
010165
010166     if pb-state = 'TN'
010167        if ((pb-c-lf-cancel-dt <> low-values)
010168           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
010169                      or
010170           ((pb-c-ah-cancel-dt <> low-values)
010171           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
010172           GO TO 3999-END-EDIT
010173        END-IF
010174     end-if
010175
010176     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
010177        GO TO 3999-END-EDIT
010178     END-IF
010179
010180***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
010181***-_-
010182***-_-   if cancel date within 15 days of effective date, bypass
010183***-_-
010184***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
010185
010186     IF PB-STATE NOT = 'NH'
010187        GO TO 3785-CONTINUE
010188     END-IF
010189
010190     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
010191     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
010192     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
010193        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
010194     END-IF
010195     MOVE '1'                    TO DC-OPTION-CODE
010196     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
010197     IF NO-CONVERSION-ERROR
010198        IF DC-ELAPSED-DAYS < +16
010199           GO TO 3999-END-EDIT
010200        END-IF
010201     END-IF
010202
010203***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
010204***-_-
010205***-_-   if cancel date within 30 days of current date then
010206***-_-   bypass else subtract 15 days from period
010207***-_-
010208***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
010209
010210     MOVE +0                     TO DC-ELAPSED-DAYS
010211     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
010212     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
010213     MOVE '1'                    TO DC-OPTION-CODE
010214     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
010215     IF NO-CONVERSION-ERROR
010216        IF DC-ELAPSED-DAYS > +30
010217           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
010218        ELSE
010219           GO TO 3999-END-EDIT
010220        END-IF
010221     ELSE
010222        GO TO 3999-END-EDIT
010223     END-IF
010224
010225     .
010226 3785-CONTINUE.
010227
010228     if pb-state = 'TN'
010229        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
010230        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
010231        MOVE '1'                 TO DC-OPTION-CODE
010232        PERFORM 8500-DATE-CONVERT
010233                                 THRU 8500-EXIT
010234        IF no-CONVERSION-ERROR
010235           IF DC-ELAPSED-DAYS < +16
010236              GO TO 3999-END-EDIT
010237           END-IF
010238        END-IF
010239     end-if
010240
010241***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
010242***-_-
010243***-_-   'NH' is 10%, TN is 3.5%
010244***-_-
010245***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
010246
010247*    if pb-state = 'NH'
010248*       move +1.10               to ws-work-rate
010249*    else
010250*       move +1.035              to ws-work-rate
010251*    end-if
010252     compute ws-work-rate = (1 + ws-st-refund-int-rate)
010253
010254     COMPUTE WS-PAYMENT-AMT ROUNDED =
010255        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
010256           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
010257
010258     IF WS-PAYMENT-AMT < 10.00
010259        GO TO 3999-END-EDIT
010260     END-IF
010261
010262*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
010263
010264     if (cm-soc-sec-no(1:9) numeric)
010265        and (cm-soc-sec-no(1:9) not = zeros)
010266        GO TO 3999-END-EDIT
010267     END-IF
010268
010269     MOVE ER-2795                TO WS-ERROR
010270     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
010271
010272     GO TO 3999-END-EDIT.
010273******************************************************************
010274     EJECT
010275 3990-FILES-NOT-OPEN.
010276
010277     MOVE ER-2617                TO WS-ERROR.
010278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
010279     GO TO 9990-RETURN.
010280
010281 3999-END-EDIT.
010282
010283
010284     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
010285
010286     IF PB-CANCELLATION AND CERT-WAS-FOUND
010287         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
010288         IF CERTIFICATE-MASTER = ELCERT-SAVE
010289             PERFORM 9250-UNLOCK-RETURN
010290             GO TO 9990-RETURN
010291          ELSE
010292             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
010293             GO TO 9990-RETURN.
010294
010295     IF PB-CANCELLATION
010296          GO TO 9990-RETURN.
010297
010298     IF CERT-WAS-NOT-FOUND
010299        MOVE SPACES              TO CERTIFICATE-MASTER.
010300
010301     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
010302
010303     IF CERT-WAS-FOUND
010304         IF CERTIFICATE-MASTER = ELCERT-SAVE
010305             PERFORM 9250-UNLOCK-RETURN
010306          ELSE
010307            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
010308      ELSE
010309         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
010310
010311*    if pb-company-id = 'VPP'
010312*       perform 8150-read-elcrtt thru 8150-exit
010313*       if ws-vehicle-odometer numeric
010314*          if ws-vehicle-odometer > 6000
010315*             move er-1583       to ws-error
010316*             PERFORM 9900-ERROR-FORMAT
010317*                                THRU 9900-EXIT
010318*          end-if
010319*       end-if
010320*    end-if
010321
010322     if (pb-cert-sfx not = ' ')
010323                 or
010324        (pb-i-entry-status = 'V')
010325        perform 7320-CHECK-FOR-OPEN-CLMS-issue
010326                                 thru 7320-exit
010327     end-if
010328
010329     perform 8145-read-elcrtt-upd thru 8145-exit
010330     if not elcrtt-found
010331        move 'CS'                to certificate-trailers
010332        move cm-control-primary  to cs-control-primary
010333        move 'C'                 TO cs-trailer-type
010334        move zeros               to cs-vehicle-odometer
010335     end-if
010336
010337     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
010338        IF ((PB-COMPANY-ID = 'DCC')
010339           AND (PB-CARRIER = '2' OR '4' OR '6'))
010340                         or
010341           (pb-company-id = 'CID' or 'VPP')
010342           IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
010343               or (hldi-pass-area not = spaces)
010344               move pa-modelyear        to cs-year
010345               move pa-makename         to cs-make
010346               move pa-modelname        to cs-model
010347               move pa-seriesname       to cs-future
010348               MOVE PB-I-VIN            TO CS-VIN-NUMBER
010349               move 'Y'                 to elcrtt-update-sw
010350           end-if
010351        end-if
010352     end-if
010353
010354     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
010355        IF WS-INS-AGE-SET = 'Y'
010356           MOVE WS-INS-AGE-DEFAULTED
010357                                 TO CS-INS-AGE-DEFAULT-FLAG
010358           move 'Y'              to elcrtt-update-sw
010359        END-IF
010360        IF WS-JNT-AGE-SET = 'Y'
010361           MOVE WS-JNT-AGE-DEFAULTED
010362                                 TO CS-JNT-AGE-DEFAULT-FLAG
010363           move 'Y'              to elcrtt-update-sw
010364        END-IF
010365     end-if
010366
010367     IF PB-I-LETTER-REQD = 'Y'
010368        MOVE ER-1577             TO WS-ERROR
010369        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010370     ELSE
010371     IF PB-I-LETTER-REQD = 'N'
010372        MOVE ER-1584             TO WS-ERROR
010373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010374     END-IF.
010375
010376     move cs-ins-age-default-flag to ws-ins-age-defaulted
010377     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
010378     move cs-vehicle-odometer    to ws-vehicle-odometer
010379
010380     if ws-ins-age-defaulted = 'Y'
010381        move er-1573             to ws-error
010382        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010383     end-if
010384
010385     if ws-jnt-age-defaulted = 'Y'
010386        move er-1574             to ws-error
010387        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010388     end-if
010389
010390***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
010391***                                                           ****
010392***  Set an error if the state requires verification of agent ****
010393***  and agent hasn't verified yet and the status is not =    ****
010394***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
010395***  and the entry date > 09/01/2015.                         ****
010396***                                                           ****
010397***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
010398
010399     if (pb-input-dt >= X'AD81')    *> 09/01/2015
010400        and (pb-i-entry-status not = '5' and 'D' and 'V')
010401        and (pb-account (9:2) not = 'OB')
010402        if (ws-st-agent-sig-edit = 'Y')
010403           and (am-report-code-1 not = 'CONLEY')
010404           evaluate true
010405              when cs-agent-edit-status = 'C'
010406                 move er-1743    to ws-error
010407                 perform 9900-error-format
010408                                 thru 9900-exit
010409              when cs-agent-edit-status = 'S'
010410                 move er-1744    to ws-error
010411                 perform 9900-error-format
010412                                 thru 9900-exit
010413              when cs-agent-edit-status = 'M'
010414                 move er-1745    to ws-error
010415                 perform 9900-error-format
010416                                 thru 9900-exit
010417              when cs-agent-edit-status = 'R'
010418                 move er-1747    to ws-error
010419                 perform 9900-error-format
010420                                 thru 9900-exit
010421              when cs-agent-edit-status = 'N'
010422                 move er-1748    to ws-error
010423                 perform 9900-error-format
010424                                 thru 9900-exit
010425              when cs-agent-edit-status <> 'V' and 'U' and
010426                                           'R' and 'N' and
010427                                           'H'
010428                 move er-1746    to ws-error
010429                 perform 9900-error-format
010430                                 thru 9900-exit
010431           end-evaluate
010432        end-if
010433     end-if
010434
010435*    move ' ' to cs-claim-verification-status
010436*    move 'Y' to elcrtt-update-sw
010437
010438     if cs-claim-verification-status = ' ' or 'R'
010439        move pb-state            to pa-clmhs-state
010440        move pb-account          to pa-account
010441        move ws-greg-eff-date    to pa-eff-dt
010442        move pb-cert-no          to pa-cert-no
010443        perform 7795-call-sqlclmhs
010444                                 thru 7795-exit
010445        if pa-clm-count > 0
010446           if cs-claim-verification-status = ' '
010447              move 'R'           to cs-claim-verification-status
010448*             display 'Updating elcrtt ' pb-state ' '
010449*                pb-account ' ' pb-cert-no
010450              move 'Y'           to elcrtt-update-sw
010451           end-if
010452        else
010453           if cs-claim-verification-status = 'R'
010454              move ' '           to cs-claim-verification-status
010455              move 'Y'           to elcrtt-update-sw
010456           end-if
010457        end-if
010458     end-if
010459
010460     if cs-claim-verification-status <> ' '
010461        evaluate true
010462           when cs-claim-verification-status = 'R'
010463              move er-1749    to ws-error
010464              perform 9900-error-format
010465                              thru 9900-exit
010466           when cs-claim-verification-status = 'W'
010467              move er-1750    to ws-error
010468              perform 9900-error-format
010469                              thru 9900-exit
010470           when cs-claim-verification-status = 'I'
010471              move er-1751    to ws-error
010472              perform 9900-error-format
010473                              thru 9900-exit
010474           when cs-claim-verification-status = 'K'
010475              move er-1761    to ws-error
010476              perform 9900-error-format
010477                              thru 9900-exit
010478           when cs-claim-verification-status = 'A'
010479              move er-1752    to ws-error
010480              perform 9900-error-format
010481                              thru 9900-exit
010482           when cs-claim-verification-status = 'B'
010483              move er-1754    to ws-error
010484              perform 9900-error-format
010485                              thru 9900-exit
010486           when cs-claim-verification-status = 'C'
010487              move er-1753    to ws-error
010488              perform 9900-error-format
010489                              thru 9900-exit
010490           when cs-claim-verification-status = 'D'
010491              move er-1757    to ws-error
010492              perform 9900-error-format
010493                              thru 9900-exit
010494           when cs-claim-verification-status = 'E'
010495              move er-1758    to ws-error
010496              perform 9900-error-format
010497                              thru 9900-exit
010498           when cs-claim-verification-status = 'F'
010499              move er-1759    to ws-error
010500              perform 9900-error-format
010501                              thru 9900-exit
010502           when cs-claim-verification-status = 'G'
010503              move er-1760    to ws-error
010504              perform 9900-error-format
010505                              thru 9900-exit
010506*          when cs-claim-verification-status = 'H'
010507*             move er-1756    to ws-error
010508*             perform 9900-error-format
010509*                             thru 9900-exit
010510*          when cs-claim-verification-status = 'J'
010511*             move er-1755    to ws-error
010512*             perform 9900-error-format
010513*                             thru 9900-exit
010514        end-evaluate
010515     end-if
010516
010517     IF ELCRTT-UPDATE
010518        perform 8150-update-elcrtt thru 8150-exit
010519*       display ' back from 8150 ' elcrtt-file-status
010520     else
010521        if elcrtt-found
010522           perform 8155-unlock-elcrtt
010523                                 thru 8155-exit
010524        end-if
010525     end-if
010526
010527     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
010528     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
010529        AND (WS-NO-SECURE-PAY))
010530                  OR
010531        (WS-LF-SPECIAL-CALC-CD = 'O'
010532        OR WS-AH-SPECIAL-CALC-CD = 'O')
010533        SET SKIP-ADDR-EDIT       TO TRUE
010534     END-IF
010535
010536     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
010537        AND (NOT SKIP-ADDR-EDIT)
010538        MOVE ER-2963             TO WS-ERROR
010539        PERFORM 9900-ERROR-FORMAT
010540                                 THRU 9900-EXIT
010541        GO TO 9990-RETURN
010542     END-IF
010543
010544     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
010545
010546     IF ERPNDM-FOUND NOT = 'X'
010547        move 'Y'                 to erpndm-unlock-sw
010548        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
010549           OR (PM-CITY        = SPACES OR LOW-VALUES)
010550           OR (PM-STATE       = SPACES OR LOW-VALUES)
010551           OR (PM-ZIP         = SPACES OR LOW-VALUES)
010552           or (pm-zip-code    = zeros)
010553           or (pm-zip-code not numeric))
010554           AND (NOT SKIP-ADDR-EDIT)
010555           MOVE ER-2694          TO WS-ERROR
010556           PERFORM 9900-ERROR-FORMAT
010557                                 THRU 9900-EXIT
010558        END-IF
010559        MOVE ' '                 TO STATE-RECORD-ERROR
010560        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
010561        MOVE PM-STATE            TO CNTL-ACCESS
010562        MOVE '3'                 TO CNTL-REC-TYPE
010563        MOVE +0                  TO CNTL-SEQ-NO
010564        MOVE '0'                 TO RC-SW-2
010565        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
010566        IF (NO-STATE-RECORD)
010567           OR (CF-RECORD-TYPE NOT = '3')
010568           OR (PM-STATE NOT = CF-STATE-CODE)
010569           IF (PM-STATE = SPACES)
010570              AND (SKIP-ADDR-EDIT)
010571              CONTINUE
010572           ELSE
010573              MOVE ER-2963       TO WS-ERROR
010574              PERFORM 9900-ERROR-FORMAT
010575                                 THRU 9900-EXIT
010576           END-IF
010577        END-IF
010578        if (ws-error not = er-2963 and er-2694)
010579           and (pm-city-st-zip-verified = ' ')
010580           and (pb-company-id = 'CID')
010581           move spaces           to zipcd-pass-area
010582           move pm-zip-code      to pa-zip
010583           move pm-city          to pa-city
010584           move pm-state         to pa-state
010585           perform 7790-call-zip-verify
010586                                 thru 7790-exit
010587           if pa-errorcode-zip (1:1) = ' '
010588                    move 'Y'     to pm-city-st-zip-verified
010589                    PERFORM 8102-REWRITE-ERPNDM
010590                                 THRU 8102-EXIT
010591                    move 'N'     to erpndm-unlock-sw
010592           else
010593              MOVE ER-3061       TO WS-ERROR
010594              PERFORM 9900-ERROR-FORMAT
010595                                 THRU 9900-EXIT
010596           end-if
010597        end-if
010598
010599        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
010600           MOVE ER-2883          TO WS-ERROR
010601           PERFORM 9900-ERROR-FORMAT
010602                                 THRU 9900-EXIT
010603        END-IF
010604        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
010605           MOVE ' '                 TO STATE-RECORD-ERROR
010606           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
010607           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
010608           MOVE '3'                 TO CNTL-REC-TYPE
010609           MOVE +0                  TO CNTL-SEQ-NO
010610           MOVE '0'                 TO RC-SW-2
010611           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
010612           IF NO-STATE-RECORD
010613              OR (CF-RECORD-TYPE NOT = '3')
010614              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
010615              MOVE ER-2964          TO WS-ERROR
010616              PERFORM 9900-ERROR-FORMAT
010617                                    THRU 9900-EXIT
010618           END-IF
010619        END-IF
010620     ELSE
010621        IF NOT SKIP-ADDR-EDIT
010622           MOVE ER-2393          TO WS-ERROR
010623           PERFORM 9900-ERROR-FORMAT
010624                                 THRU 9900-EXIT
010625        END-IF
010626     END-IF
010627
010628     if need-to-unlock-erpndm
010629        perform 8104-unlock-erpndm
010630                                 thru 8104-exit
010631     end-if
010632
010633     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
010634
010635     IF (ERMAIL-FOUND = ' ' AND
010636        ERPNDM-FOUND = ' ')
010637        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
010638           MA-PROFILE-INFO = PM-PROFILE-INFO AND
010639           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
010640          OR
010641           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
010642          OR
010643           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
010644           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
010645           GO TO 3999-UNLOCK-ERMAIL.
010646
010647
010648     IF ERPNDM-FOUND = 'X'
010649        GO TO 3999-UNLOCK-ERMAIL.
010650
010651     IF PM-INSURED-LAST-NAME      = SPACES
010652        AND PM-INSURED-FIRST-NAME = SPACES
010653        AND PM-ADDRESS-LINE-1     = SPACES
010654        AND PM-ADDRESS-LINE-2     = SPACES
010655        AND PM-CITY-STATE         = SPACES
010656        AND PM-CRED-BENE-NAME     = SPACES
010657        AND PM-CRED-BENE-ADDR     = SPACES
010658        AND PM-CRED-BENE-CTYST    = SPACES
010659        GO TO 3999-UNLOCK-ERMAIL
010660     END-IF
010661
010662     MOVE SPACES                 TO MAILING-DATA.
010663
010664     MOVE 'MA'                   TO MA-RECORD-ID.
010665     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
010666     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
010667     MOVE PB-SV-CARRIER          TO MA-CARRIER.
010668     MOVE PB-SV-GROUPING         TO MA-GROUPING.
010669     MOVE PB-SV-STATE            TO MA-STATE.
010670     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
010671     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
010672
010673     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
010674     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
010675
010676     IF ERMAIL-FOUND = ' '
010677        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
010678     ELSE
010679        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
010680        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
010681        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
010682
010683
010684     GO TO 9990-RETURN.
010685
010686 3999-UNLOCK-ERMAIL.
010687     IF ERMAIL-FOUND = ' '
010688        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
010689
010690     GO TO 9990-RETURN.
010691******************************************************************
010692
010693     EJECT
010694 4000-UPDATE-CANCELLED-CERT.
010695     IF CERT-WAS-NOT-FOUND
010696        GO TO 4299-EXIT.
010697
010698*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
010699
010700     IF PB-C-INT-ON-REFS > ZEROS
010701        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
010702     END-IF
010703     IF PB-C-REF-INTERFACE-SW = 'Y'
010704        MOVE PB-C-REF-INTERFACE-SW
010705                                 TO CM-ref-INTERFACE-SW
010706     END-IF
010707*    IF ERMAIL-FOUND = ' '
010708*       PERFORM 8140-UNLOCK-ERMAIL
010709*                                THRU 8140-EXIT
010710*    end-if
010711
010712     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
010713     IF ERMAIL-FOUND = 'X'
010714        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
010715        OR (MA-CITY        = SPACES OR LOW-VALUES)
010716        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
010717        OR (MA-ZIP         = SPACES OR LOW-VALUES))
010718           MOVE ER-2694          TO WS-ERROR
010719           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
010720     END-IF
010721
010722     IF PB-C-POST-CARD-IND = 'Y'
010723        MOVE +8                  TO SUB
010724*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
010725        IF ERMAIL-FOUND = ' '
010726           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
010727              (SUB > +7)
010728              OR (MA-MAIL-STATUS (SUB) = '1')
010729           END-PERFORM
010730        END-IF
010731        IF (SUB > +7)
010732           OR (ERMAIL-FOUND = 'X')
010733           MOVE ER-3789          TO WS-ERROR
010734           PERFORM 9900-ERROR-FORMAT
010735                                 THRU 9900-EXIT
010736        END-IF
010737     ELSE
010738        MOVE 'N'                 TO PB-C-POST-CARD-IND
010739     END-IF
010740
010741     IF ERMAIL-FOUND = ' '
010742        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
010743     END-IF.
010744
010745     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
010746
010747     IF PB-CI-OB-FLAG = 'Z'
010748        GO TO 4150-SUMMARY-CERT-CANCEL.
010749
010750     perform 8145-read-elcrtt-upd thru 8145-exit
010751     if not elcrtt-found
010752        move 'CS'                to certificate-trailers
010753        move cm-control-primary  to cs-control-primary
010754        move 'C'                 TO cs-trailer-type
010755        move zeros               to cs-vehicle-odometer
010756     end-if
010757
010758     if pb-lf-refund-type <> cs-lf-refund-method
010759        move pb-lf-refund-type   to cs-lf-refund-method
010760        set elcrtt-update to true
010761     end-if
010762     if pb-ah-refund-type <> cs-ah-refund-method
010763        move pb-ah-refund-type   to cs-ah-refund-method
010764        set elcrtt-update to true
010765     end-if
010766
010767     IF PB-C-LF-CANCEL-VOIDED
010768         PERFORM 4200-REVERSE-LF-CANCEL.
010769     IF PB-C-AH-CANCEL-VOIDED
010770         PERFORM 4200-REVERSE-AH-CANCEL.
010771
010772     IF ELCRTT-UPDATE
010773        perform 8150-update-elcrtt thru 8150-exit
010774     else
010775        if elcrtt-found
010776           perform 8155-unlock-elcrtt
010777                                 thru 8155-exit
010778        end-if
010779     end-if
010780
010781     .
010782 4100-APPLY-LF-CANCEL.
010783
010784     MOVE +0                     TO WS-SUB.
010785
010786 4100-CHECK-LF-ERRORS.
010787
010788     ADD +1                       TO WS-SUB.
010789
010790     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
010791        IF LF-COVERAGE-CANCELLED
010792           GO TO 4100-LF-CANCEL-CONT
010793        ELSE
010794           GO TO 4100-UPDATE-LF-COVERAGE.
010795
010796     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
010797                                   ER-2729 OR
010798                                   ER-2730 OR
010799                                   ER-2731 OR
010800                                   ER-2732 OR
010801                                   ER-2737 OR
010802                                   ER-2740 OR
010803                                   ER-2743 OR
010804                                   ER-2749 OR
010805                                   ER-2750 OR
010806                                   ER-2755 OR
010807                                   ER-2757 OR
010808                                   ER-2760 OR
010809                                   ER-2772 OR
010810                                   ER-2774 OR
010811                                   ER-2776 OR
010812                                   ER-2794
010813        GO TO 4100-UPDATE-LF-COVERAGE.
010814
010815     GO TO 4100-CHECK-LF-ERRORS.
010816
010817 4100-UPDATE-LF-COVERAGE.
010818
010819     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
010820     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
010821     IF NOT CM-LF-DEATH-CLAIM-APPLIED
010822        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
010823     END-IF
010824     MOVE PB-CI-CREDIT-INTERFACE-SW-2
010825                                      TO CM-CREDIT-INTERFACE-SW-2.
010826     IF CM-LF-CANCEL-DT = LOW-VALUE
010827         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
010828
010829     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
010830         MOVE SPACES                  TO CM-LF-EXIT-BATCH
010831                                         CM-LF-STATUS-AT-CANCEL.
010832
010833     GO TO 4100-APPLY-AH-CANCEL.
010834
010835 4100-LF-CANCEL-CONT.
010836     IF PB-C-LF-CANCEL-VOIDED
010837         GO TO 4100-APPLY-AH-CANCEL.
010838
010839     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
010840         GO TO 4100-APPLY-AH-CANCEL.
010841
010842     IF PB-C-LF-CANCEL-AMT GREATER ZERO
010843        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
010844           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
010845        ELSE
010846           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
010847
010848     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
010849     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
010850
010851     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
010852         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
010853
010854     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
010855        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
010856         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
010857         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
010858
010859     IF PB-RECORD-RETURNED
010860        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
010861      ELSE
010862        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
010863
010864 4100-APPLY-AH-CANCEL.
010865
010866     MOVE +0                      TO WS-SUB.
010867
010868 4100-CHECK-AH-ERRORS.
010869
010870     ADD +1                       TO WS-SUB.
010871
010872     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
010873        IF AH-COVERAGE-CANCELLED
010874           GO TO 4100-AH-CANCEL-CONT
010875        ELSE
010876           GO TO 4100-UPDATE-AH-COVERAGE.
010877
010878     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
010879                                   ER-2729 OR
010880                                   ER-2732 OR
010881                                   ER-2737 OR
010882                                   ER-2740 OR
010883                                   ER-2744 OR
010884                                   ER-2749 OR
010885                                   ER-2750 OR
010886                                   ER-2755 OR
010887                                   ER-2757 OR
010888                                   ER-2760 OR
010889                                   ER-2771 OR
010890                                   ER-2772 OR
010891                                   ER-2773 OR
010892                                   ER-2775 OR
010893                                   ER-2777 OR
010894                                   ER-2778 OR
010895                                   ER-2794
010896        GO TO 4100-UPDATE-AH-COVERAGE.
010897
010898     GO TO 4100-CHECK-AH-ERRORS.
010899
010900 4100-UPDATE-AH-COVERAGE.
010901
010902     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
010903     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
010904     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
010905     MOVE PB-CI-CREDIT-INTERFACE-SW-2
010906                                      TO CM-CREDIT-INTERFACE-SW-2.
010907     IF CM-AH-CANCEL-DT = LOW-VALUE
010908         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
010909
010910     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
010911         MOVE SPACES                  TO CM-AH-EXIT-BATCH
010912                                         CM-AH-STATUS-AT-CANCEL.
010913
010914     IF LF-COVERAGE-CANCELLED
010915         IF PB-RECORD-RETURNED
010916              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
010917          ELSE
010918              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
010919
010920     GO TO 4299-EXIT.
010921
010922 4100-AH-CANCEL-CONT.
010923     IF PB-C-AH-CANCEL-VOIDED
010924         GO TO 4299-EXIT.
010925
010926     if cm-credit-interface-sw-2 = ' '
010927        if pb-fatal-errors or pb-unforced-errors
010928           move '4'              to cm-credit-interface-sw-2
010929        else
010930           move '1'              to cm-credit-interface-sw-2
010931        end-if
010932     end-if
010933
010934     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
010935         GO TO 4299-EXIT.
010936
010937     IF PB-C-AH-CANCEL-AMT GREATER ZERO
010938        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
010939           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
010940        ELSE
010941           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
010942
010943     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
010944     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
010945
010946     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
010947         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
010948
010949     IF CM-AH-STATUS-AT-CANCEL = SPACE
010950         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
010951         MOVE '8'                TO CM-AH-CURRENT-STATUS.
010952
010953     IF PB-RECORD-RETURNED
010954        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
010955      ELSE
010956        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
010957
010958     GO TO 4299-EXIT.
010959
010960 4150-SUMMARY-CERT-CANCEL.
010961     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
010962
010963     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
010964        COMPUTE CM-LF-ITD-CANCEL-AMT =
010965                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
010966     ELSE
010967        COMPUTE CM-LF-ITD-CANCEL-AMT =
010968                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
010969
010970     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
010971        COMPUTE CM-AH-ITD-CANCEL-AMT =
010972                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
010973     ELSE
010974        COMPUTE CM-AH-ITD-CANCEL-AMT =
010975                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
010976
010977     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
010978        NEXT SENTENCE
010979     ELSE
010980        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
010981
010982     GO TO 4299-EXIT.
010983
010984 4200-REVERSE-LF-CANCEL.
010985     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
010986
010987     IF CM-LF-CANCEL-APPLIED
010988        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
010989        MOVE SPACES                TO CM-LF-EXIT-BATCH
010990        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
010991
010992     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
010993
010994     IF PB-RECORD-RETURNED
010995        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
010996       ELSE
010997        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
010998
010999 4200-REVERSE-LF-EXIT.
011000       EXIT.
011001
011002 4200-REVERSE-AH-CANCEL.
011003     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
011004
011005     IF CM-AH-CANCEL-APPLIED
011006        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
011007        MOVE SPACES                TO CM-AH-EXIT-BATCH
011008        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
011009
011010     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
011011
011012     IF PB-RECORD-RETURNED
011013        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
011014       ELSE
011015        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
011016
011017 4200-REVERSE-AH-EXIT.
011018       EXIT.
011019
011020 4299-EXIT.
011021       EXIT.
011022       EJECT
011023
011024 4500-UPDATE-NEW-CERT.
011025     IF CERT-WAS-FOUND
011026         NEXT SENTENCE
011027       ELSE
011028         GO TO 4520-BUILD-NEW-KEY.
011029
011030     IF  CLASIC-CREATED-CERT
011031         GO TO 4999-EXIT.
011032
011033     IF  CERT-WAS-CREATED-FOR-CLAIM
011034         GO TO 4520-BUILD-NEW-KEY.
011035
011036     IF CERT-ADDED-BATCH
011037        IF CM-RECORD-ID = 'CM'
011038            GO TO 4999-EXIT.
011039
011040 4520-BUILD-NEW-KEY.
011041* BUILD CONTROL PRIMARY
011042
011043     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
011044                                       CM-COMPANY-CD-A1
011045                                       CM-COMPANY-CD-A2
011046                                       CM-COMPANY-CD-A4
011047                                       CM-COMPANY-CD-A5.
011048
011049     MOVE PB-SV-CARRIER             TO CM-CARRIER.
011050     MOVE PB-SV-GROUPING            TO CM-GROUPING.
011051     MOVE PB-SV-STATE               TO CM-STATE.
011052     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
011053     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
011054     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
011055     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
011056
011057     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
011058
011059     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
011060     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
011061     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
011062     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
011063
011064     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
011065        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
011066
011067     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
011068         MOVE PB-SV-STATE            TO CM-SSN-STATE
011069         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
011070         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
011071         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
011072     ELSE
011073         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
011074
011075     IF PB-COMPANY-ID   EQUAL  'CRI'
011076         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
011077         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
011078         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
011079         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
011080         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
011081
011082     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
011083        (CM-INSURED-INITIALS  = SPACES OR ZERO)
011084         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
011085
011086     IF PB-COMPANY-ID  = 'LBL'
011087        IF PB-I-JOINT-COVERAGE
011088            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
011089                                           PB-I-MEMBER-NO
011090            GO TO 4550-CONT-CERT-PROCESS.
011091
011092     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
011093        NEXT SENTENCE
011094     ELSE
011095        GO TO 4540-BUILD-MEMBER-NO.
011096
011097******************************************************************
011098*                                                                *
011099*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
011100*    FOR 'MON'.                                                  *
011101*                                                                *
011102******************************************************************
011103
011104     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
011105     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
011106     MOVE +1                     TO WS-SUB1
011107                                    WS-SUB2.
011108
011109 4530-EDIT-MEMB-NAME.
011110
011111     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
011112        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
011113        ADD +1                       TO WS-SUB2.
011114
011115     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
011116        ADD +1                       TO WS-SUB1
011117        GO TO 4530-EDIT-MEMB-NAME.
011118
011119     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
011120     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
011121     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
011122*    MOVE SPACE                      TO DC-OPTION-CODE.
011123     SET  BIN-TO-GREG                TO TRUE.
011124     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
011125     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
011126
011127     GO TO 4550-CONT-CERT-PROCESS.
011128
011129******************************************************************
011130*    END FOR 'MON' CODE FOR MEMBER NO.                           *
011131******************************************************************
011132
011133 4540-BUILD-MEMBER-NO.
011134
011135     IF PB-I-MEMBER-NO  = SPACES OR ZERO
011136         MOVE PB-SV-STATE            TO CM-MEMB-STATE
011137         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
011138         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
011139         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
011140     ELSE
011141         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
011142
011143     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
011144        (CM-INSURED-INITIALS  = SPACES OR ZERO)
011145         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
011146
011147 4550-CONT-CERT-PROCESS.
011148
011149*    IF PB-I-MICROFILM-NO  NOT NUMERIC
011150*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
011151*    ELSE
011152*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
011153
011154     IF CERT-WAS-CREATED-FOR-CLAIM
011155        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
011156        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
011157
011158     IF CERT-AND-CLAIM-ONLINE
011159        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
011160        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
011161
011162     MOVE 'CM'                     TO CM-RECORD-ID.
011163     MOVE LOW-VALUES               TO CM-STATUS-DATA.
011164
011165     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
011166        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
011167        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
011168     ELSE
011169        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
011170        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
011171
011172     MOVE ZERO                     TO CM-LOAN-BALANCE.
011173     MOVE '1'                      TO CM-PREMIUM-TYPE.
011174     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
011175     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
011176     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
011177     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
011178     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
011179                                      CM-LF-ITD-CANCEL-AMT
011180                                      CM-LF-ITD-DEATH-AMT
011181                                      CM-AH-ITD-AH-PMT
011182                                      CM-AH-ITD-LUMP-PMT
011183                                      CM-AH-ITD-CANCEL-AMT
011184                                      CM-LF-NSP-PREMIUM-AMT
011185                                      CM-AH-NSP-PREMIUM-AMT.
011186*                                     CM-CLAIM-DEDUCT-WITHHELD
011187*                                     CM-CANCEL-DEDUCT-WITHHELD.
011188     if pb-i-loan-apr = +99.9999
011189        move zeros                 to cm-loan-apr
011190     else
011191        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
011192     end-if
011193     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
011194     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
011195     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
011196     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
011197     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
011198     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
011199     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
011200     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
011201     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
011202     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
011203     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
011204
011205     IF PB-I-LIVES NOT NUMERIC
011206         MOVE ZERO                 TO PB-I-LIVES.
011207
011208     IF PB-I-NUM-BILLED NOT NUMERIC
011209         MOVE ZERO                 TO PB-I-NUM-BILLED.
011210
011211     MOVE PB-I-LIVES               TO CM-LIVES.
011212     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
011213
011214     IF PB-COMPANY-ID EQUAL  'DMD'
011215         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
011216         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
011217
011218     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
011219     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
011220     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
011221     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
011222     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
011223     MOVE PB-I-LF-CLP              TO CM-LF-CLP
011224
011225     IF PB-I-LF-POLICY-FEE NUMERIC
011226        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
011227     ELSE
011228        MOVE +0                    TO CM-LF-POLICY-FEE.
011229
011230     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
011231        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
011232        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
011233     ELSE
011234        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
011235
011236     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
011237     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
011238     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
011239     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
011240     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
011241     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
011242     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
011243     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
011244     MOVE PB-I-AH-CLP              TO CM-AH-CLP
011245
011246     IF PB-I-CANCEL-FEE NUMERIC
011247        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
011248     ELSE
011249        MOVE +0                  TO CM-CANCEL-FEE
011250     END-IF
011251
011252     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
011253        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
011254     ELSE
011255        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
011256
011257     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
011258     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
011259
011260     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
011261                                      CM-LF-DEATH-EXIT-DT
011262                                      CM-AH-SETTLEMENT-EXIT-DT.
011263
011264*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
011265*                       'TIH' OR 'OFL' OR 'FLA' OR
011266*                       'TII' OR 'TMS' OR 'CRI' OR
011267*                       'NCL'
011268     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
011269
011270     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
011271         IF WS-LF-SPECIAL-CALC-CD = 'O'
011272            MOVE '2'                TO CM-PREMIUM-TYPE.
011273
011274     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
011275         IF WS-AH-SPECIAL-CALC-CD = 'O'
011276            MOVE '2'                TO CM-PREMIUM-TYPE.
011277
011278     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
011279         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
011280     ELSE
011281         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
011282         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
011283
011284     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
011285     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
011286     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
011287     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
011288     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
011289     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
011290     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
011291     MOVE SPACE                     TO CM-PAYMENT-MODE.
011292
011293     IF PB-NO-MONTHS-SKIPPED
011294         MOVE SPACE                 TO CM-SKIP-CODE
011295     ELSE
011296         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
011297
011298     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
011299     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
011300                                       CM-LF-STATUS-AT-CANCEL.
011301
011302     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
011303     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
011304                                       CM-AH-STATUS-AT-CANCEL.
011305
011306     MOVE '1'                       TO CM-ENTRY-STATUS.
011307
011308     IF PB-REISSUED-CERT
011309        MOVE '5'                    TO CM-ENTRY-STATUS.
011310
011311     IF PB-MONTHLY-CERT
011312        MOVE 'M'                    TO CM-ENTRY-STATUS.
011313
011314     IF PB-CASH-CERT
011315        MOVE 'C'                    TO CM-ENTRY-STATUS.
011316
011317     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
011318     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
011319     IF PB-POLICY-IS-DECLINED
011320        MOVE 'D'                    TO CM-ENTRY-STATUS.
011321
011322     IF PB-POLICY-IS-VOIDED
011323        MOVE 'V'                    TO CM-ENTRY-STATUS.
011324
011325     IF PB-NEEDS-UNDERWRITING
011326        MOVE 'U'                    TO CM-ENTRY-STATUS.
011327
011328     IF PB-REIN-ONLY-CERT
011329        MOVE '9'                    TO CM-ENTRY-STATUS.
011330
011331     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
011332         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
011333     ELSE
011334         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
011335
011336     IF PB-RECORD-RETURNED
011337        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
011338      ELSE
011339        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
011340
011341     IF PB-I-MAIL-ADDRS-PRESENT
011342        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
011343
011344     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
011345                                       CM-ENTRY-DT.
011346
011347 4999-EXIT.
011348     EXIT.
011349     EJECT
011350
011351 5000-PROCESS-REPS.
011352
011353     MOVE ' '                    TO AGTC-MASTER-SW
011354     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
011355     MOVE CO-TYPE                TO AGTC-TYPE
011356     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
011357     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
011358
011359     IF (AGTC-MASTER-SW NOT = 'N')
011360        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
011361        AND (PB-CERT-EFF-DT = AG-EXP-DT)
011362        PERFORM 8583-READ-ERAGTC-NEXT
011363                                 THRU 8583-EXIT
011364     END-IF
011365
011366     IF AGTC-MASTER-SW = 'N'
011367        CONTINUE
011368     ELSE
011369        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
011370           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
011371              AND (PB-CERT-EFF-DT < AG-EXP-DT)
011372              MOVE 'Y'           TO AGTC-MASTER-SW
011373           END-IF
011374        END-IF
011375     END-IF
011376
011377     .
011378 5000-EXIT.
011379     EXIT.
011380
011381
011382 6370-EDIT-INPUT-LF-CODE.
011383     move ' ' to ws-benefit-cd-chg-sw
011384     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
011385        MOVE +1                  TO SUB
011386        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
011387        SET ELCNTL-FILE-ADDRESSED   TO TRUE
011388        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
011389        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
011390        GO TO 6370-SEARCH-LOOP.
011391
011392     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
011393
011394     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
011395     MOVE SPACES                 TO CNTL-ACCESS.
011396*    MOVE 'L'                    TO CNTL-REC-TYPE.
011397     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
011398     MOVE +0                     TO CNTL-SEQ-NO.
011399     MOVE '4' TO RC-SW-2.
011400     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
011401
011402     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
011403        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
011404        GO TO 6370-NO-LF-FOUND.
011405
011406     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
011407     MOVE +1                     TO SUB.
011408
011409 6370-SEARCH-LOOP.
011410     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
011411         GO TO 6370-NO-LF-FOUND.
011412
011413     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
011414        if (pb-i-lf-benefit-cd not = zeros and spaces)
011415           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
011416           set benefit-code-chg to true
011417        end-if
011418        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
011419        GO TO 6370-HER-NET-PAY-CHECK.
011420
011421     ADD 1   TO SUB.
011422*    IF SUB GREATER 120
011423     IF SUB GREATER 200
011424         GO TO 6370-NO-LF-FOUND.
011425
011426     GO TO 6370-SEARCH-LOOP.
011427
011428 6370-NO-LF-FOUND.
011429
011430     if (pb-i-lf-benefit-cd not = zeros and spaces)
011431        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
011432        set benefit-code-chg to true
011433     end-if
011434     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
011435
011436 6370-HER-NET-PAY-CHECK.
011437
011438     IF PB-COMPANY-ID = 'CID'
011439        IF PB-SV-STATE = 'CA' OR 'MN'
011440           IF PB-I-LF-BENEFIT-CD = '02'
011441              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
011442           ELSE
011443              IF PB-I-LF-BENEFIT-CD = '04'
011444                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
011445              END-IF
011446           END-IF
011447        END-IF
011448     END-IF
011449
011450     IF PB-COMPANY-ID NOT = 'HER'
011451         GO TO 6370-EXIT.
011452
011453     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
011454         GO TO 6370-EXIT.
011455
011456     IF PB-I-LF-TERM NOT NUMERIC
011457         MOVE ZEROS              TO PB-I-LF-TERM.
011458
011459     IF PB-I-LOAN-TERM NOT NUMERIC
011460         MOVE ZEROS              TO PB-I-LOAN-TERM.
011461
011462     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
011463         GO TO 6370-EXIT.
011464
011465     IF PB-I-LF-BENEFIT-CD = '33'
011466         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
011467
011468     IF PB-I-LF-BENEFIT-CD = '34'
011469         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
011470
011471 6370-EXIT.
011472     EXIT.
011473     EJECT
011474
011475 6380-EDIT-INPUT-AH-CODE.
011476     IF WK-AH-EDIT-ADDR NOT = ZEROS
011477        MOVE +1                  TO SUB
011478        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
011479        SET ELCNTL-FILE-ADDRESSED   TO TRUE
011480        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
011481        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
011482        GO TO 6380-SEARCH-LOOP.
011483
011484     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
011485
011486     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
011487     MOVE SPACES                 TO CNTL-ACCESS.
011488     MOVE 'A'                    TO CNTL-REC-TYPE.
011489*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
011490     MOVE +0                     TO CNTL-SEQ-NO.
011491     MOVE '5' TO RC-SW-2.
011492     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
011493
011494     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
011495        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
011496        GO TO 6380-NO-AH-FOUND.
011497
011498     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
011499     MOVE +1 TO SUB.
011500
011501 6380-SEARCH-LOOP.
011502     IF CF-AH-CODE-OUT (SUB) = ZEROS
011503         GO TO 6380-NO-AH-FOUND.
011504
011505     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
011506         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
011507         GO TO 6380-CSO-AH-ONLY-CHECKS.
011508
011509     ADD 1   TO SUB.
011510     IF SUB GREATER THAN 96
011511*    IF SUB GREATER THAN 300
011512         GO TO 6380-NO-AH-FOUND.
011513
011514     GO TO 6380-SEARCH-LOOP.
011515
011516 6380-NO-AH-FOUND.
011517
011518     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
011519
011520     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
011521         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
011522     ELSE
011523         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
011524
011525 6380-CSO-AH-ONLY-CHECKS.
011526
011527     IF PB-COMPANY-ID = 'CSO' OR 'CID'
011528        NEXT SENTENCE
011529      ELSE
011530        GO TO 6380-EXIT.
011531
011532     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
011533         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
011534
011535
011536     GO TO 6380-EXIT
011537     .
011538 6380-CSO-LIFE-WITH-AH-CHECKS.
011539
011540
011541     .
011542 6380-EXIT.
011543     EXIT.
011544
011545     EJECT
011546
011547 6400-COMPUTE-EXTENSION-DAYS.
011548
011549******************************************************************
011550*                                                                *
011551*                   COMPUTE EXTENSION DAYS                       *
011552*                                                                *
011553*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
011554*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
011555*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
011556*    THE EXTENSION DAYS.                                         *
011557*                                                                *
011558******************************************************************
011559
011560     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
011561     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
011562
011563******************************************************************
011564*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
011565*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
011566******************************************************************
011567
011568     IF DC-ELAPSED-MONTHS GREATER THAN +0
011569        COMPUTE WS-ODD-DAYS-OVER =
011570               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
011571     ELSE
011572        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
011573
011574     IF WS-ODD-DAYS-OVER = ZEROS
011575           GO TO 6499-EXIT
011576     ELSE
011577        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
011578           IF WS-WDF-MONTH = 02
011579              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
011580              ADD 2       TO  WS-ODD-DAYS-OVER
011581              GO TO 6499-EXIT
011582           ELSE
011583              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
011584                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
011585                 GO TO 6499-EXIT
011586               ELSE
011587                 GO TO 6499-EXIT
011588        ELSE
011589           GO TO 6499-EXIT.
011590
011591 6412-CHECK-TO-DAY.
011592
011593        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
011594           IF WS-WDT-DAY = 28
011595              ADD 2              TO WS-ODD-DAYS-OVER
011596           ELSE
011597              IF WS-WDT-DAY = 29
011598                 ADD 1           TO WS-ODD-DAYS-OVER
011599              ELSE
011600                 NEXT SENTENCE
011601        ELSE
011602           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
011603              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
011604
011605     GO TO 6499-EXIT.
011606
011607
011608 6415-CHECK-LEAP-YEAR.
011609
011610     IF DC-DAYS-IN-MONTH = 29
011611        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
011612
011613 6415-EXIT.
011614     EXIT.
011615
011616 6499-EXIT.
011617      EXIT.
011618
011619 6500-END.
011620     EXIT.
011621
011622
011623******************************************************************
011624************* PROCEDURE DIVISION FOR EL050 ***********************
011625********************** ELC50PD END *******************************
011626
      *<<((file: ELC50PD))
000421     EJECT
000422
000423**START***********************************************************
000424*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
000425*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
000426******************************************************************
000427*
000428 6600-GET-STATE-MUNICIPAL-TAX.
000429
000430     IF PB-COMPANY-ID NOT = 'DMD'
000431         GO TO 6640-EXIT.
000432
000433     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
000434     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
000435     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
000436*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
000437*
000438***  Y2K PROJ 7744
000439     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
000440     SET BIN-TO-GREG          TO TRUE.
000441     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
000442
000443     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
000444
000445     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
000446     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
000447
000448     
      * EXEC CICS HANDLE CONDITION
000449*        INVREQ    (6610-START-BROWSE)
000450*        NOTOPEN   (6630-ERRESS-PROBLEM)
000451*        NOTFND    (6630-END-OF-FILE)
000452*    END-EXEC.
      *    MOVE '"$8JI                 ! # #00019603' TO DFHEIV0
           MOVE X'2224384A4920202020202020' &
                X'202020202020202020202120' &
                X'2320233030303139363033' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000453
000454 6610-START-BROWSE.
000455
000456     
      * EXEC CICS HANDLE CONDITION
000457*        NOTFND    (6630-END-OF-FILE)
000458*        DISABLED  (6630-ERRESS-PROBLEM)
000459*        NOTOPEN   (6630-ERRESS-PROBLEM)
000460*        ENDFILE   (6630-END-OF-FILE)
000461*    END-EXEC.
      *    MOVE '"$IcJ''                ! $ #00019611' TO DFHEIV0
           MOVE X'222449634A27202020202020' &
                X'202020202020202020202120' &
                X'2420233030303139363131' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000462
000463     
      * EXEC CICS STARTBR
000464*        DATASET (FILE-ID-ERRESS)
000465*        RIDFLD  (WS-ERRESS-KEY)
000466*        GTEQ
000467*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &   #00019618' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'2020233030303139363138' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESS, 
                 WS-ERRESS-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000468
000469 6620-READ-NEXT-ERRESS-MASTER.
000470
000471     
      * EXEC CICS HANDLE CONDITION
000472*        NOTFND    (6630-END-OF-FILE)
000473*        ENDFILE   (6630-END-OF-FILE)
000474*        DISABLED  (6630-ERRESS-PROBLEM)
000475*        NOTOPEN   (6630-ERRESS-PROBLEM)
000476*    END-EXEC.
      *    MOVE '"$I''cJ                ! % #00019626' TO DFHEIV0
           MOVE X'22244927634A202020202020' &
                X'202020202020202020202120' &
                X'2520233030303139363236' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000477
000478     
      * EXEC CICS READNEXT
000479*        DATASET (FILE-ID-ERRESS)
000480*        INTO    (RESIDENT-STATE-TAX-MASTER)
000481*        RIDFLD  (WS-ERRESS-KEY)
000482*    END-EXEC.
           MOVE LENGTH OF
            RESIDENT-STATE-TAX-MASTER
             TO DFHEIV12
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.IL                  )   #00019633' TO DFHEIV0
           MOVE X'262E494C2020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303139363333' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESS, 
                 RESIDENT-STATE-TAX-MASTER, 
                 DFHEIV12, 
                 WS-ERRESS-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000483
000484     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
000485        
      * EXEC CICS ENDBR
000486*            DATASET (FILE-ID-ERRESS)
000487*       END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00019640' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303139363430' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
000488        GO TO 6630-END-OF-FILE.
000489
000490     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
000491        NEXT SENTENCE
000492      ELSE
000493        GO TO 6620-READ-NEXT-ERRESS-MASTER.
000494
000495*IS IT LIFE(1) OR IS IT P&C(2) ?????
000496*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
000497*
000498     MOVE +2                     TO WS-SUB1.
000499
000500     IF PB-ISSUE
000501     IF PB-I-POLICY-FORM-NO (6:1) = '1'
000502        MOVE +1                  TO WS-SUB1.
000503
000504     IF PB-CANCELLATION
000505     IF PB-C-POLICY-FORM-NO (6:1) = '1'
000506        MOVE +1                  TO WS-SUB1.
000507*
000508*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
000509*
000510***  Y2K PROJ 7744
000511     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
000512***  Y2K PROJ 7744
000513
000514*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
000515* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
000516* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
000517
000518     ADD 1                    TO WS-YEAR-YY.
000519
000520     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
000521         MOVE RES-REN-STATE-TAX (WS-SUB1)
000522                              TO WS-RES-STATE-TAX
000523         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
000524                              TO WS-RES-MUNI-TAX
000525     ELSE
000526         MOVE RES-1YR-STATE-TAX (WS-SUB1)
000527                              TO WS-RES-STATE-TAX
000528         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
000529                              TO WS-RES-MUNI-TAX.
000530
000531*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
000532
000533     IF PB-CANCELLATION
000534         GO TO 6640-CANCEL-TAX.
000535
000536     IF PB-I-LF-PREMIUM-AMT > ZEROS
000537         COMPUTE PB-I-STATE-TAX ROUNDED =
000538                                   PB-I-LF-PREMIUM-AMT
000539                                 * WS-RES-STATE-TAX
000540         COMPUTE PB-I-MUNI-TAX ROUNDED =
000541                                   PB-I-LF-PREMIUM-AMT
000542                                 * WS-RES-MUNI-TAX
000543     ELSE
000544     IF PB-I-AH-PREMIUM-AMT > ZEROS
000545         COMPUTE PB-I-STATE-TAX ROUNDED =
000546                                   PB-I-AH-PREMIUM-AMT
000547                                 * WS-RES-STATE-TAX
000548         COMPUTE PB-I-MUNI-TAX ROUNDED =
000549                                   PB-I-AH-PREMIUM-AMT
000550                                 * WS-RES-MUNI-TAX.
000551
000552     
      * EXEC CICS ENDBR
000553*         DATASET (FILE-ID-ERRESS)
000554*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00019707' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303139373037' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000555
000556     GO TO 6640-EXIT.
000557
000558 6640-CANCEL-TAX.
000559     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
000560
000561     IF PB-C-LF-CANCEL-AMT > ZEROS
000562         COMPUTE PB-CI-STATE-TAX ROUNDED =
000563                                   PB-C-LF-CANCEL-AMT
000564                                 * WS-RES-STATE-TAX
000565         COMPUTE PB-CI-MUNI-TAX ROUNDED =
000566                                   PB-C-LF-CANCEL-AMT
000567                                *  WS-RES-MUNI-TAX
000568     ELSE
000569     IF PB-C-AH-CANCEL-AMT > ZEROS
000570         COMPUTE PB-CI-STATE-TAX ROUNDED =
000571                                   PB-C-AH-CANCEL-AMT
000572                                 * WS-RES-STATE-TAX
000573         COMPUTE PB-CI-MUNI-TAX ROUNDED =
000574                                   PB-C-AH-CANCEL-AMT
000575                                *  WS-RES-MUNI-TAX.
000576
000577     
      * EXEC CICS ENDBR
000578*         DATASET (FILE-ID-ERRESS)
000579*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00019732' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303139373332' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000580
000581     GO TO 6640-EXIT.
000582
000583 6630-END-OF-FILE.
000584     MOVE ER-8002              TO WS-ERROR.
000585     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
000586
000587     GO TO 6640-EXIT.
000588
000589 6630-ERRESS-PROBLEM.
000590     MOVE ER-8044              TO WS-ERROR.
000591     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
000592
000593 6640-EXIT.
000594     EXIT.
000595
000596     EJECT
000597 6650-GET-RES-STATE-COMM.
000598
000599     IF PB-COMPANY-ID NOT = 'DMD'
000600         GO TO 6700-COMM-EXIT.
000601
000602     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
000603     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
000604     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
000605     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
000606     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
000607     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
000608     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
000609
000610*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
000611*
000612***  Y2K PROJ 7744
000613     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
000614     SET BIN-TO-GREG          TO TRUE.
000615     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
000616
000617     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
000618***  Y2K PROJ 7744
000619
000620     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
000621
000622     
      * EXEC CICS HANDLE CONDITION
000623*        INVREQ    (6660-START-BROWSE)
000624*        DISABLED  (6690-ERRESC-PROBLEM)
000625*        NOTOPEN   (6690-ERRESC-PROBLEM)
000626*        NOTFND    (6690-END-OF-FILE)
000627*    END-EXEC.
      *    MOVE '"$8cJI                ! & #00019777' TO DFHEIV0
           MOVE X'222438634A49202020202020' &
                X'202020202020202020202120' &
                X'2620233030303139373737' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000628
000629     
      * EXEC CICS RESETBR
000630*        DATASET (FILE-ID-ERRESC)
000631*        RIDFLD  (WS-ERRESC-KEY)
000632*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&4         G          &   #00019784' TO DFHEIV0
           MOVE X'263420202020202020202047' &
                X'202020202020202020202620' &
                X'2020233030303139373834' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESC, 
                 WS-ERRESC-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000633
000634 6660-START-BROWSE.
000635
000636     
      * EXEC CICS HANDLE CONDITION
000637*        NOTFND    (6690-END-OF-FILE)
000638*        DISABLED  (6690-ERRESC-PROBLEM)
000639*        NOTOPEN   (6690-ERRESC-PROBLEM)
000640*        ENDFILE   (6690-END-OF-FILE)
000641*    END-EXEC.
      *    MOVE '"$IcJ''                ! '' #00019791' TO DFHEIV0
           MOVE X'222449634A27202020202020' &
                X'202020202020202020202120' &
                X'2720233030303139373931' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000642
000643     
      * EXEC CICS STARTBR
000644*        DATASET (FILE-ID-ERRESC)
000645*        RIDFLD  (WS-ERRESC-KEY)
000646*        GTEQ
000647*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &   #00019798' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'2020233030303139373938' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESC, 
                 WS-ERRESC-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000648
000649     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
000650
000651 6670-READ-NEXT-ERRESC-MASTER.
000652
000653     
      * EXEC CICS HANDLE CONDITION
000654*        NOTFND    (6690-END-OF-FILE)
000655*        DISABLED  (6690-ERRESC-PROBLEM)
000656*        NOTOPEN   (6690-ERRESC-PROBLEM)
000657*        ENDFILE   (6690-END-OF-FILE)
000658*    END-EXEC.
      *    MOVE '"$IcJ''                ! ( #00019808' TO DFHEIV0
           MOVE X'222449634A27202020202020' &
                X'202020202020202020202120' &
                X'2820233030303139383038' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000659
000660     
      * EXEC CICS READNEXT
000661*        DATASET (FILE-ID-ERRESC)
000662*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
000663*        RIDFLD  (ERRESC-RECORD-KEY)
000664*    END-EXEC.
           MOVE LENGTH OF
            ACCOUNT-RESIDENT-ST-COMMISSION
             TO DFHEIV12
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.IL                  )   #00019815' TO DFHEIV0
           MOVE X'262E494C2020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303139383135' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESC, 
                 ACCOUNT-RESIDENT-ST-COMMISSION, 
                 DFHEIV12, 
                 ERRESC-RECORD-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000665
000666     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
000667        NEXT SENTENCE
000668     ELSE
000669        
      * EXEC CICS ENDBR
000670*            DATASET (FILE-ID-ERRESC)
000671*       END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00019824' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303139383234' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESC, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
000672        GO TO 6690-END-OF-FILE.
000673
000674     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
000675        
      * EXEC CICS ENDBR
000676*            DATASET (FILE-ID-ERRESC)
000677*       END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00019830' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303139383330' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESC, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
000678        GO TO 6690-END-OF-FILE.
000679
000680     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
000681        NEXT SENTENCE
000682      ELSE
000683        GO TO 6670-READ-NEXT-ERRESC-MASTER.
000684
000685* SEARCH FOR MATCHING CATEGORY CODE ENTRY
000686*
000687     MOVE ZEROS               TO WS-SUB WS-SUB1.
000688
000689     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
000690
000691     IF WS-SUB1 > ZERO
000692         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
000693             PERFORM 6680-SET-COMMISSION
000694         ELSE
000695             PERFORM 6680-SET-TABLE-CODE.
000696
000697     
      * EXEC CICS ENDBR
000698*         DATASET (FILE-ID-ERRESC)
000699*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00019852' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303139383532' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESC, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000700
000701     GO TO 6700-COMM-EXIT.
000702
000703 6680-SET-TABLE-CODE.
000704     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
000705        MOVE ZEROS             TO WS-SUB1
000706     ELSE
000707* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
000708* TO COMPUTE AH COMMISSION.
000709        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
000710        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
000711        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
000712        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
000713        PERFORM 6680-READ-CTBL-TABLE
000714        IF WS-CTBL-READ-SW NOT = 'Y'
000715           MOVE ZEROS          TO WS-SUB1.
000716
000717 6680-READ-CTBL-TABLE.
000718*
000719* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
000720* TO COMPUTE LIFE COMMISSION
000721
000722     IF CTBL-SW = '0540'
000723        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
000724        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
000725        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
000726
000727     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
000728
000729     IF CTBL-TABLE-FOUND
000730        IF CTBL-SW = '0530'
000731             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
000732                                    * PB-I-AH-TERM
000733             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
000734             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
000735        ELSE
000736             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
000737             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
000738             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
000739     ELSE
000740        IF FIRST-TIME-THROUGH
000741            GO TO 6680-READ-CTBL-TABLE
000742        ELSE
000743            MOVE ZEROS         TO WS-SUB1.
000744
000745 6680-SET-COMMISSION.
000746     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
000747           MOVE ZEROS          TO WS-SUB1
000748       ELSE
000749           MOVE RESC-COMMISSION-PER (WS-SUB)
000750                               TO WS-COMMISSION
000751           IF CTBL-SW = '0530'
000752               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
000753           ELSE
000754               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
000755
000756 6680-SEARCH-CATEGORY.
000757     ADD +1                   TO WS-SUB.
000758     IF WS-SUB > +12
000759         GO TO 6680-EXIT.
000760
000761     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
000762          MOVE WS-SUB         TO WS-SUB1
000763          GO TO 6680-EXIT.
000764
000765     GO TO 6680-SEARCH-CATEGORY.
000766
000767 6680-EXIT.
000768     EXIT.
000769
000770 6690-END-OF-FILE.
000771     GO TO 6700-COMM-EXIT.
000772
000773 6690-ERRESC-PROBLEM.
000774      MOVE ER-8030              TO WS-ERROR.
000775      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
000776
000777      GO TO 6700-COMM-EXIT.
000778
000779 6700-COMM-EXIT.
000780     EXIT.
000781
000782 7000-GET-RATE.
000783     
      * EXEC CICS LINK
000784*        PROGRAM    ('ELRATE')
000785*        COMMAREA   (CALCULATION-PASS-AREA)
000786*        LENGTH     (CP-COMM-LENGTH)
000787*    END-EXEC.
           MOVE 'ELRATE' TO DFHEIV1
      *    MOVE '."C                   (   #00019938' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303139393338' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 CALCULATION-PASS-AREA, 
                 CP-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000788
000789 7000-EXIT.
000790     EXIT.
000791     EJECT
000792 7100-FIND-BENEFIT-IN-STATE.
000793     MOVE 'N'                    TO BEN-SEARCH-SW.
000794
000795     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
000796         VARYING SUB3 FROM 1 BY 1 UNTIL
000797            ((SUB3 GREATER 50) OR
000798              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
000799               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
000800
000801     IF SUB3 NOT = 51
000802         MOVE 'Y'                TO BEN-SEARCH-SW.
000803
000804     GO TO 7199-EXIT.
000805
000806 7100-BENEFIT-DUMMY.
000807
000808 7100-DUMMY-EXIT.
000809     EXIT.
000810
000811 7199-EXIT.
000812     EXIT.
000813     EJECT
000814 7200-FIND-BENEFIT.
000815     MOVE 'N'                    TO BEN-SEARCH-SW.
000816
000817     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
000818         VARYING SUB3 FROM 1 BY 1 UNTIL
000819            ((SUB3 GREATER 8) OR
000820            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
000821
000822     IF SUB3 NOT = 9
000823         MOVE 'Y'                TO BEN-SEARCH-SW.
000824
000825     GO TO 7200-EXIT.
000826
000827 7200-BENEFIT-DUMMY.
000828
000829 7200-DUMMY-EXIT.
000830     EXIT.
000831
000832 7200-EXIT.
000833     EXIT.
000834     EJECT
000835 7250-LOOK-FOR-RESCINDED-CLAIM.
000836     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
000837                                    W-CL-COMP-CD.
000838     MOVE PB-CERT-NO             TO MSTR-CERT-NO
000839                                    W-CL-CERT-NO.
000840
000841     
      * EXEC CICS HANDLE CONDITION
000842*        NOTFND  (7250-CONTINUE)
000843*        ENDFILE (7250-CONTINUE)
000844*    END-EXEC.
      *    MOVE '"$I''                  ! ) #00019996' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'2920233030303139393936' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000845
000846     
      * EXEC CICS IGNORE CONDITION
000847*        DUPKEY
000848*    END-EXEC.
      *    MOVE '"*$                   !   #00020001' TO DFHEIV0
           MOVE X'222A24202020202020202020' &
                X'202020202020202020202120' &
                X'2020233030303230303031' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000849
000850     
      * EXEC CICS STARTBR
000851*        DATASET   (CLMS-ID)
000852*        RIDFLD    (ELMSTR-KEY)
000853*        GENERIC   EQUAL
000854*        KEYLENGTH (ELMSTR-LENGTH)
000855*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,   KG    E          &   #00020005' TO DFHEIV0
           MOVE X'262C2020204B472020202045' &
                X'202020202020202020202620' &
                X'2020233030303230303035' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 ELMSTR-KEY, 
                 ELMSTR-LENGTH, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000856
000857     MOVE 'Y'                    TO W-BROWSE-SW.
000858
000859 7250-NEXT-CLAIM.
000860
000861     
      * EXEC CICS READNEXT
000862*        DATASET   (CLMS-ID)
000863*        RIDFLD    (ELMSTR-KEY)
000864*        SET       (ADDRESS OF CLAIM-MASTER)
000865*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )   #00020016' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303230303136' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELMSTR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CLAIM-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000866
000867     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
000868        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
000869         GO TO 7250-CONTINUE
000870     END-IF.
000871
000872     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
000873        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
000874        PB-SV-STATE    NOT = CL-CERT-STATE     OR
000875        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
000876        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
000877         GO TO 7250-NEXT-CLAIM
000878     END-IF.
000879
000880     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
000881        OR (CL-CLAIM-TYPE = 'I')
000882        OR (CL-CLAIM-TYPE = 'G')
000883        OR (CL-CLAIM-TYPE = 'F')
000884        OR (CL-CLAIM-TYPE = 'B')
000885        OR (CL-CLAIM-TYPE = 'H')
000886          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
000887              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
000888              GO TO 7250-CONTINUE
000889          END-IF
000890     END-IF.
000891
000892     GO TO 7250-NEXT-CLAIM.
000893
000894 7250-CONTINUE.
000895
000896     IF W-BROWSE-SW = 'Y'
000897         
      * EXEC CICS ENDBR
000898*            DATASET   (CLMS-ID)
000899*        END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00020052' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303230303532' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
000900         MOVE 'N' TO W-BROWSE-SW
000901     END-IF.
000902
000903 7250-EXIT.
000904     EXIT.
000905     EJECT
000906 7300-CHECK-FOR-OPEN-CLMS.
000907
000908*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
000909*    MOVE SPACES                 TO CNTL-ACCESS.
000910*    MOVE '1'                    TO CNTL-REC-TYPE.
000911*    MOVE +0                     TO CNTL-SEQ-NO.
000912
000913*    MOVE '3'                    TO RC-SW-1.
000914*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
000915
000916*    IF NOT CF-COMPANY-MASTER
000917*         PERFORM 0099-COMPANY-NOT-FOUND
000918*         GO TO 7300-EXIT.
000919
000920     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
000921                                    W-CL-COMP-CD.
000922     MOVE PB-CERT-NO             TO MSTR-CERT-NO
000923                                    W-CL-CERT-NO.
000924
000925     
      * EXEC CICS HANDLE CONDITION
000926*        NOTFND  (7300-CONTINUE)
000927*        ENDFILE (7300-CONTINUE)
000928*    END-EXEC.
      *    MOVE '"$I''                  ! * #00020080' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'2A20233030303230303830' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000929
000930     
      * EXEC CICS IGNORE CONDITION
000931*        DUPKEY
000932*    END-EXEC.
      *    MOVE '"*$                   !   #00020085' TO DFHEIV0
           MOVE X'222A24202020202020202020' &
                X'202020202020202020202120' &
                X'2020233030303230303835' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000933
000934     
      * EXEC CICS STARTBR
000935*        DATASET   (CLMS-ID)
000936*        RIDFLD    (ELMSTR-KEY)
000937*        GENERIC   EQUAL
000938*        KEYLENGTH (ELMSTR-LENGTH)
000939*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,   KG    E          &   #00020089' TO DFHEIV0
           MOVE X'262C2020204B472020202045' &
                X'202020202020202020202620' &
                X'2020233030303230303839' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 ELMSTR-KEY, 
                 ELMSTR-LENGTH, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000940
000941     MOVE 'Y'                    TO W-BROWSE-SW.
000942
000943 7300-NEXT-CLAIM.
000944
000945     
      * EXEC CICS READNEXT
000946*        DATASET   (CLMS-ID)
000947*        RIDFLD    (ELMSTR-KEY)
000948*        SET       (ADDRESS OF CLAIM-MASTER)
000949*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )   #00020100' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303230313030' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELMSTR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CLAIM-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
000950
000951     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
000952        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
000953         GO TO 7300-CONTINUE.
000954
000955     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
000956        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
000957        PB-SV-STATE    NOT = CL-CERT-STATE     OR
000958        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
000959        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
000960         GO TO 7300-NEXT-CLAIM.
000961
000962*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
000963     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
000964        OR (CL-CLAIM-TYPE = 'I')
000965        OR (CL-CLAIM-TYPE = 'G')
000966        OR (CL-CLAIM-TYPE = 'F')
000967        OR (CL-CLAIM-TYPE = 'B')
000968        OR (CL-CLAIM-TYPE = 'H')
000969        IF CLAIM-IS-OPEN
000970           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
000971             AND PB-C-AH-CANCEL-DT > SPACES
000972              MOVE ER-2896        TO WS-ERROR
000973              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
000974           END-IF
000975           EVALUATE TRUE
000976             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
000977                 MOVE ER-2884      TO WS-ERROR
000978             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
000979                 MOVE ER-2887      TO WS-ERROR
000980             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
000981                 MOVE ER-2886      TO WS-ERROR
000982             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
000983                 MOVE ER-2888      TO WS-ERROR
000984             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
000985                 MOVE ER-2885      TO WS-ERROR
000986             WHEN OTHER
000987                 MOVE ER-2768      TO WS-ERROR
000988           END-EVALUATE
000989           IF PB-C-AH-CANCEL-VOIDED OR
000990              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
000991                NOT AH-COVERAGE-CANCELLED)
000992               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
000993               MOVE ER-2768      TO WS-ERROR
000994           END-IF
000995           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
000996           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
000997              PB-FORCE-CODE NOT EQUAL '8'
000998               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
000999           END-IF
001000           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
001001           GO TO 7300-NEXT-CLAIM
001002        ELSE
001003           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
001004*****THIS IS A RESCISSION OR REFORMATION
001005              IF AH-COVERAGE-CANCELLED
001006                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
001007                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
001008                    MOVE 1                   TO DC-ELAPSED-DAYS
001009                    MOVE ZERO                TO DC-ELAPSED-MONTHS
001010                    SET BIN-PLUS-ELAPSED     TO TRUE
001011                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
001012                    IF NO-CONVERSION-ERROR
001013                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
001014                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
001015                          MOVE ER-2897 TO WS-ERROR
001016                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001017                          GO TO 7300-NEXT-CLAIM
001018                       END-IF
001019                    END-IF
001020                 ELSE
001021                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
001022                      IF MSTR-CERT-NO = W-CL-CERT-NO
001023                         MOVE ER-2890 TO WS-ERROR
001024                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001025                         GO TO 7300-NEXT-CLAIM
001026                      ELSE
001027                         MOVE ER-2898 TO WS-ERROR
001028                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001029                         GO TO 7300-NEXT-CLAIM
001030                      END-IF
001031                   END-IF
001032                 END-IF
001033              END-IF
001034           ELSE
001035              IF CL-DENIAL-TYPE = '1'  AND
001036                 CL-TOTAL-PAID-AMT = 0
001037                    GO TO 7300-NEXT-CLAIM
001038              END-IF
001039              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
001040               AND PB-C-AH-CANCEL-DT > SPACES
001041                 MOVE ER-2756        TO WS-ERROR
001042                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001043                 GO TO 7300-NEXT-CLAIM
001044              END-IF
001045           END-IF
001046        END-IF
001047     ELSE
001048*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
001049        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
001050          OR (CL-CLAIM-TYPE = 'O')
001051           IF (CLAIM-IS-OPEN)
001052              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
001053                 <> zeros
001054              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
001055                 <> zeros)
001056              MOVE ER-2889      TO WS-ERROR
001057              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001058              GO TO 7300-NEXT-CLAIM
001059           ELSE
001060              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
001061*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
001062                 IF (LF-COVERAGE-CANCELLED AND
001063                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
001064                      IF MSTR-CERT-NO = W-CL-CERT-NO
001065                         MOVE ER-2890 TO WS-ERROR
001066                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001067                         GO TO 7300-NEXT-CLAIM
001068                      ELSE
001069                         MOVE ER-2898 TO WS-ERROR
001070                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001071                         GO TO 7300-NEXT-CLAIM
001072                      END-IF
001073                 END-IF
001074              ELSE
001075                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
001076                    and (CL-TOTAL-PAID-AMT = 0)
001077                    GO TO 7300-NEXT-CLAIM
001078                 END-IF
001079                 IF (
001080                      (AH-COVERAGE-CANCELLED)
001081                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
001082                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
001083                      and (pb-ci-ah-cancel-amt +
001084                         pb-c-ah-cancel-amt) <> zeros
001085                    )
001086                               OR
001087                    (
001088                      (LF-COVERAGE-CANCELLED)
001089                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
001090                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
001091                      and (pb-ci-lf-cancel-amt +
001092                         pb-c-lf-cancel-amt) <> zeros
001093                    )
001094                       IF CL-CLAIM-TYPE = 'O'
001095                          MOVE ER-2998 TO WS-ERROR
001096                       ELSE
001097                          MOVE ER-2965 TO WS-ERROR
001098                       END-IF
001099                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001100                       GO TO 7300-NEXT-CLAIM
001101                 END-IF
001102                 IF LF-COVERAGE-CANCELLED
001103                  IF CL-TOTAL-PAID-AMT > 0
001104                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
001105                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
001106                        MOVE ER-2891 TO WS-ERROR
001107                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001108                        GO TO 7300-NEXT-CLAIM
001109                      END-IF
001110                    ELSE
001111****only show this error if cert num matches exactly
001112                      IF PB-CERT-NO = CL-CERT-NO
001113                         IF CL-CLAIM-TYPE = 'O'
001114                            MOVE ER-2895 TO WS-ERROR
001115                         ELSE
001116                            MOVE ER-2892 TO WS-ERROR
001117                         END-IF
001118                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
001119                         GO TO 7300-NEXT-CLAIM
001120                      END-IF
001121                    END-IF
001122                  END-IF
001123                 END-IF
001124              END-IF
001125           END-IF
001126        END-IF
001127     END-IF
001128
001129     GO TO 7300-NEXT-CLAIM.
001130
001131 7300-CONTINUE.
001132
001133     IF W-BROWSE-SW = 'Y'
001134         
      * EXEC CICS ENDBR
001135*            DATASET   (CLMS-ID)
001136*        END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00020289' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303230323839' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001137
001138 7300-EXIT.
001139     EXIT.
001140     EJECT
001141
001142 7320-CHECK-FOR-OPEN-CLMS-issue.
001143
001144     move ' '                    to w-browse-sw
001145     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
001146                                    W-CL-COMP-CD
001147     MOVE PB-CERT-NO(1:10)       TO MSTR-CERT-NO
001148                                    W-CL-CERT-NO
001149
001150     
      * EXEC CICS HANDLE CONDITION
001151*        NOTFND  (7320-CONTINUE)
001152*        ENDFILE (7320-CONTINUE)
001153*    END-EXEC.
      *    MOVE '"$I''                  ! + #00020305' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'2B20233030303230333035' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001154
001155     
      * EXEC CICS IGNORE CONDITION
001156*        DUPKEY
001157*    END-EXEC.
      *    MOVE '"*$                   !   #00020310' TO DFHEIV0
           MOVE X'222A24202020202020202020' &
                X'202020202020202020202120' &
                X'2020233030303230333130' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001158
001159     
      * EXEC CICS STARTBR
001160*        DATASET   (CLMS-ID)
001161*        RIDFLD    (ELMSTR-KEY)
001162*        GENERIC   EQUAL
001163*        KEYLENGTH (ELMSTR-LENGTH)
001164*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,   KG    E          &   #00020314' TO DFHEIV0
           MOVE X'262C2020204B472020202045' &
                X'202020202020202020202620' &
                X'2020233030303230333134' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 ELMSTR-KEY, 
                 ELMSTR-LENGTH, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001165
001166     MOVE 'Y'                    TO W-BROWSE-SW.
001167
001168 7320-NEXT-CLAIM.
001169
001170     
      * EXEC CICS READNEXT
001171*        DATASET   (CLMS-ID)
001172*        RIDFLD    (ELMSTR-KEY)
001173*        SET       (ADDRESS OF CLAIM-MASTER)
001174*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )   #00020325' TO DFHEIV0
           MOVE X'262E53202020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303230333235' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELMSTR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CLAIM-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001175
001176     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
001177        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
001178         GO TO 7320-CONTINUE.
001179
001180     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
001181        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
001182        PB-SV-STATE    NOT = CL-CERT-STATE     OR
001183        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
001184        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
001185         GO TO 7320-NEXT-CLAIM.
001186
001187     IF CLAIM-IS-OPEN
001188        MOVE ER-3273             TO WS-ERROR
001189        PERFORM 9900-ERROR-FORMAT
001190                                 THRU 9900-EXIT
001191     END-IF
001192     if pb-i-entry-status = 'V'
001193        IF CLAIM-IS-OPEN
001194             OR
001195           CL-LAST-PMT-DT NOT = LOW-VALUES
001196             OR
001197           CL-LAST-PMT-AMT > 0
001198           MOVE ER-3281          TO WS-ERROR
001199           PERFORM 9900-ERROR-FORMAT
001200                                 THRU 9900-EXIT
001201        END-IF
001202     END-IF
001203
001204     GO TO 7320-NEXT-CLAIM.
001205
001206 7320-CONTINUE.
001207
001208     IF W-BROWSE-SW = 'Y'
001209         
      * EXEC CICS ENDBR
001210*            DATASET   (CLMS-ID)
001211*        END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00020364' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303230333634' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001212
001213 7320-EXIT.
001214     EXIT.
001215     EJECT
001216
001217 7400-GET-REMAIN-TERM.
001218     
      * EXEC CICS LINK
001219*        PROGRAM    ('ELRTRM')
001220*        COMMAREA   (CALCULATION-PASS-AREA)
001221*        LENGTH     (CP-COMM-LENGTH)
001222*    END-EXEC.
           MOVE 'ELRTRM' TO DFHEIV1
      *    MOVE '."C                   (   #00020373' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230333733' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 CALCULATION-PASS-AREA, 
                 CP-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001223
001224 7400-EXIT.
001225     EXIT.
001226     EJECT
001227
001228 7500-GET-REMAIN-AMOUNT.
001229     
      * EXEC CICS LINK
001230*        PROGRAM    ('ELRAMT')
001231*        COMMAREA   (CALCULATION-PASS-AREA)
001232*        LENGTH     (CP-COMM-LENGTH)
001233*    END-EXEC.
           MOVE 'ELRAMT' TO DFHEIV1
      *    MOVE '."C                   (   #00020384' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230333834' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 CALCULATION-PASS-AREA, 
                 CP-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001234
001235 7500-EXIT.
001236     EXIT.
001237     EJECT
001238
001239 7600-GET-REFUND.
001240     
      * EXEC CICS LINK
001241*        PROGRAM    ('ELRFND')
001242*        COMMAREA   (CALCULATION-PASS-AREA)
001243*        LENGTH     (CP-COMM-LENGTH)
001244*    END-EXEC.
           MOVE 'ELRFND' TO DFHEIV1
      *    MOVE '."C                   (   #00020395' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230333935' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 CALCULATION-PASS-AREA, 
                 CP-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001245
001246 7600-EXIT.
001247     EXIT.
001248     EJECT
001249 7700-CALL-DL1.
001250     
      * EXEC CICS LINK
001251*        PROGRAM    ('DLO001')
001252*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
001253*        LENGTH     (DLO001-COMM-LENGTH)
001254*    END-EXEC.
           MOVE 'DLO001' TO DFHEIV1
      *    MOVE '."C                   (   #00020405' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230343035' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-MASTER-POLICY-FORM, 
                 DLO001-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001255
001256 7700-EXIT.
001257     EXIT.
001258
001259 7710-CALL-DL2.
001260     
      * EXEC CICS LINK
001261*        PROGRAM    ('DLO002')
001262*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
001263*        LENGTH     (DLO002-COMM-LENGTH)
001264*    END-EXEC.
           MOVE 'DLO002' TO DFHEIV1
      *    MOVE '."C                   (   #00020415' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230343135' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-INTERNAL-POLICY-FORM, 
                 DLO002-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001265
001266 7710-EXIT.
001267     EXIT.
001268
001269 7720-CALL-DL3.
001270     
      * EXEC CICS LINK
001271*        PROGRAM    ('DLO003')
001272*        COMMAREA   (WS-DLO-VALID-BANK-ID)
001273*        LENGTH     (DLO003-COMM-LENGTH)
001274*    END-EXEC.
           MOVE 'DLO003' TO DFHEIV1
      *    MOVE '."C                   (   #00020425' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230343235' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-VALID-BANK-ID, 
                 DLO003-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001275
001276 7720-EXIT.
001277     EXIT.
001278
001279 7730-CALL-DL7.
001280     
      * EXEC CICS LINK
001281*        PROGRAM    ('DLO007')
001282*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
001283*        LENGTH     (DLO007-COMM-LENGTH)
001284*    END-EXEC.
           MOVE 'DLO007' TO DFHEIV1
      *    MOVE '."C                   (   #00020435' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230343335' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-CERT-UNDRWRTR-ASSIGN, 
                 DLO007-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001285
001286 7730-EXIT.
001287     EXIT.
001288
001289 7740-CALL-DL11.
001290     
      * EXEC CICS LINK
001291*        PROGRAM    ('DLO011')
001292*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
001293*        LENGTH     (DLO011-COMM-LENGTH)
001294*    END-EXEC.
           MOVE 'DLO011' TO DFHEIV1
      *    MOVE '."C                   (   #00020445' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230343435' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-PREM-RATES-BEN-TYPE, 
                 DLO011-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001295
001296 7740-EXIT.
001297     EXIT.
001298
001299 7750-CALL-DL17.
001300     
      * EXEC CICS LINK
001301*        PROGRAM    ('DLO017')
001302*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
001303*        LENGTH     (DLO017-COMM-LENGTH)
001304*    END-EXEC.
           MOVE 'DLO017' TO DFHEIV1
      *    MOVE '."C                   (   #00020455' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230343535' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-VALID-RATE-CODE, 
                 DLO017-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001305
001306 7750-EXIT.
001307     EXIT.
001308
001309 7755-CALL-DL19.
001310     
      * EXEC CICS LINK
001311*        PROGRAM    ('DLO019')
001312*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
001313*        LENGTH     (DLO019-COMM-LENGTH)
001314*    END-EXEC.
           MOVE 'DLO019' TO DFHEIV1
      *    MOVE '."C                   (   #00020465' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230343635' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-ORIG-COV-CAT, 
                 DLO019-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001315
001316 7755-EXIT.
001317     EXIT.
001318
001319 7760-CALL-DL21.
001320     
      * EXEC CICS LINK
001321*        PROGRAM    ('DLO021')
001322*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
001323*        LENGTH     (DLO021-COMM-LENGTH)
001324*    END-EXEC.
           MOVE 'DLO021' TO DFHEIV1
      *    MOVE '."C                   (   #00020475' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230343735' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-VALID-LOAN-OFFICER, 
                 DLO021-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001325
001326 7760-EXIT.
001327     EXIT.
001328
001329 7770-CALL-DL22.
001330     
      * EXEC CICS LINK
001331*        PROGRAM    ('DLO022')
001332*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
001333*        LENGTH     (DLO022-COMM-LENGTH)
001334*    END-EXEC.
           MOVE 'DLO022' TO DFHEIV1
      *    MOVE '."C                   (   #00020485' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230343835' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-VALID-STATE-CODE, 
                 DLO022-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001335
001336 7770-EXIT.
001337     EXIT.
001338
001339     EJECT
001340
001341 7780-CALL-AGG.
001342     
      * EXEC CICS LINK
001343*        PROGRAM    ('ELAGGO')
001344*        COMMAREA   (WS-PASS-to-pemaggo)
001345*        LENGTH     (ws-passed-key-LENGTH)
001346*    END-EXEC.
           MOVE 'ELAGGO' TO DFHEIV1
      *    MOVE '."C                   (   #00020497' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230343937' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-PASS-to-pemaggo, 
                 ws-passed-key-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001347
001348 7780-EXIT.
001349     EXIT.
001350
001351 7785-CALL-HLDI.
001352     
      * EXEC CICS LINK
001353*        PROGRAM    ('ELHLDI')
001354*        COMMAREA   (HLDI-PASS-AREA)
001355*        LENGTH     (HLDI-PASS-AREA-LEN)
001356*    END-EXEC.
           MOVE 'ELHLDI' TO DFHEIV1
      *    MOVE '."C                   (   #00020507' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230353037' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 HLDI-PASS-AREA, 
                 HLDI-PASS-AREA-LEN, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001357
001358 7785-EXIT.
001359     EXIT.
001360
001361 7786-CALL-HLDIM.
001362     
      * EXEC CICS LINK
001363*        PROGRAM    ('ELHLDIM')
001364*        COMMAREA   (HLDI-PASS-AREA)
001365*        LENGTH     (HLDI-PASS-AREA-LEN)
001366*    END-EXEC.
           MOVE 'ELHLDIM' TO DFHEIV1
      *    MOVE '."C                   (   #00020517' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230353137' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 HLDI-PASS-AREA, 
                 HLDI-PASS-AREA-LEN, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001367
001368 7786-EXIT.
001369     EXIT.
001370
001371 7790-CALL-ZIP-VERIFY.
001372
001373     
      * EXEC CICS LINK
001374*        PROGRAM    ('WSZIPCD')
001375*        COMMAREA   (ZIPCD-PASS-AREA)
001376*        LENGTH     (ZIPCD-PASS-AREA-LEN)
001377*    END-EXEC.
           MOVE 'WSZIPCD' TO DFHEIV1
      *    MOVE '."C                   (   #00020528' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230353238' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ZIPCD-PASS-AREA, 
                 ZIPCD-PASS-AREA-LEN, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001378
001379 7790-EXIT.
001380     EXIT.
001381
001382 7795-call-sqlclmhs.
001383
001384     
      * EXEC CICS LINK
001385*        PROGRAM    ('SQLCLMHS')
001386*        COMMAREA   (clmhs-PASS-AREA)
001387*        LENGTH     (clmhs-PASS-AREA-LEN)
001388*    END-EXEC.
           MOVE 'SQLCLMHS' TO DFHEIV1
      *    MOVE '."C                   (   #00020539' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230353339' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 clmhs-PASS-AREA, 
                 clmhs-PASS-AREA-LEN, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001389
001390 7795-EXIT.
001391     EXIT.
001392
001393 7800-REWRITE-CERT.
001394******************************************************************
001395*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
001396*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
001397******************************************************************
001398
001399     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
001400        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
001401        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
001402        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
001403               
      * EXEC CICS REWRITE
001404*                  DATASET (CERT-ID)
001405*                  FROM    (CERTIFICATE-MASTER)
001406*              END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV11
      *    MOVE '&& L                  %   #00020558' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303230353538' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CERT-ID, 
                 CERTIFICATE-MASTER, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
001407        GO TO 7800-EXIT.
001408
001409       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
001410       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
001411
001412 7800-EXIT.
001413      EXIT.
001414
001415 7900-DELETE-CERT.
001416     
      * EXEC CICS DELETE
001417*        DATASET (CERT-ID)
001418*    END-EXEC.
      *    MOVE '&(                    &   #00020571' TO DFHEIV0
           MOVE X'262820202020202020202020' &
                X'202020202020202020202620' &
                X'2020233030303230353731' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CERT-ID, 
                 ELMSTR-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001419
001420 7900-EXIT.
001421     EXIT.
001422
001423 8000-WRITE-CERT.
001424     
      * EXEC CICS HANDLE CONDITION
001425*        DUPKEY    (8000-FREE-MAIN)
001426*    END-EXEC.
      *    MOVE '"$$                   ! , #00020579' TO DFHEIV0
           MOVE X'222424202020202020202020' &
                X'202020202020202020202120' &
                X'2C20233030303230353739' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001427
001428     
      * EXEC CICS WRITE
001429*        DATASET     (CERT-ID)
001430*        FROM        (CERTIFICATE-MASTER)
001431*        RIDFLD      (ELCERT-KEY)
001432*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00020583' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'2020233030303230353833' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CERT-ID, 
                 CERTIFICATE-MASTER, 
                 DFHEIV11, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001433
001434 8000-FREE-MAIN.
001435
001436 8000-EXIT.
001437      EXIT.
001438      EJECT
001439
001440 8100-READ-ERPNDM.
001441     
      * EXEC CICS HANDLE CONDITION
001442*         NOTFND     (8100-NOTFND)
001443*         ENDFILE    (8100-NOTFND)
001444*    END-EXEC.
      *    MOVE '"$I''                  ! - #00020596' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'2D20233030303230353936' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001445
001446     MOVE SPACES                 TO ERPNDM-FOUND.
001447     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
001448
001449     
      * EXEC CICS READ UPDATE
001450*         DATASET   (FILE-ERPNDM)
001451*         RIDFLD    (PM-CONTROL-PRIMARY)
001452*         INTO      (PENDING-MAILING-DATA)
001453*    END-EXEC.
           MOVE LENGTH OF
            PENDING-MAILING-DATA
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00020604' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303230363034' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERPNDM, 
                 PENDING-MAILING-DATA, 
                 DFHEIV11, 
                 PM-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001454
001455     GO TO 8100-EXIT.
001456
001457 8100-NOTFND.
001458
001459     MOVE 'X'                    TO ERPNDM-FOUND.
001460     MOVE ER-2694                TO WS-ERROR.
001461     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
001462     MOVE ER-2883                TO WS-ERROR
001463     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
001464
001465     .
001466 8100-EXIT.
001467     EXIT.
001468
001469 8102-REWRITE-ERPNDM.
001470
001471     
      * EXEC CICS REWRITE
001472*         DATASET    (FILE-ERPNDM)
001473*         FROM       (PENDING-MAILING-DATA)
001474*    END-EXEC
           MOVE LENGTH OF
            PENDING-MAILING-DATA
             TO DFHEIV11
      *    MOVE '&& L                  %   #00020626' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303230363236' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERPNDM, 
                 PENDING-MAILING-DATA, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
001475
001476     .
001477 8102-EXIT.
001478     EXIT.
001479
001480 8104-UNLOCK-ERPNDM.
001481
001482     
      * EXEC CICS UNLOCK
001483*         DATASET   (FILE-ERPNDM)
001484*    END-EXEC
      *    MOVE '&*                    #   #00020637' TO DFHEIV0
           MOVE X'262A20202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303230363337' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERPNDM, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
001485
001486     .
001487 8104-EXIT.
001488     EXIT.
001489
001490 8110-READ-ERMAIL.
001491     
      * EXEC CICS HANDLE CONDITION
001492*         NOTFND     (8110-NOTFND)
001493*         ENDFILE    (8110-NOTFND)
001494*    END-EXEC.
      *    MOVE '"$I''                  ! . #00020646' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'2E20233030303230363436' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001495
001496     MOVE SPACES                 TO ERMAIL-FOUND.
001497     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
001498     MOVE PB-SV-CARRIER          TO MA-CARRIER.
001499     MOVE PB-SV-GROUPING         TO MA-GROUPING.
001500     MOVE PB-SV-STATE            TO MA-STATE.
001501
001502     
      * EXEC CICS READ
001503*         UPDATE
001504*         DATASET   (FILE-ERMAIL)
001505*         RIDFLD    (MA-CONTROL-PRIMARY)
001506*         INTO      (MAILING-DATA)
001507*    END-EXEC.
           MOVE LENGTH OF
            MAILING-DATA
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00020657' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303230363537' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERMAIL, 
                 MAILING-DATA, 
                 DFHEIV11, 
                 MA-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001508
001509     GO TO 8110-EXIT.
001510
001511 8110-NOTFND.
001512     MOVE 'X'                    TO ERMAIL-FOUND.
001513
001514 8110-EXIT.
001515     EXIT.
001516
001517 8120-REWRITE-ERMAIL.
001518     
      * EXEC CICS REWRITE
001519*         DATASET    (FILE-ERMAIL)
001520*         FROM       (MAILING-DATA)
001521*    END-EXEC.
           MOVE LENGTH OF
            MAILING-DATA
             TO DFHEIV11
      *    MOVE '&& L                  %   #00020673' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303230363733' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERMAIL, 
                 MAILING-DATA, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001522
001523 8120-EXIT.
001524     EXIT.
001525
001526 8130-WRITE-ERMAIL.
001527     
      * EXEC CICS HANDLE CONDITION
001528*         DUPKEY   (8130-EXIT)
001529*    END-EXEC.
      *    MOVE '"$$                   ! / #00020682' TO DFHEIV0
           MOVE X'222424202020202020202020' &
                X'202020202020202020202120' &
                X'2F20233030303230363832' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001530
001531     
      * EXEC CICS WRITE
001532*         DATASET     (FILE-ERMAIL)
001533*         RIDFLD      (MA-CONTROL-PRIMARY)
001534*         FROM        (MAILING-DATA)
001535*    END-EXEC.
           MOVE LENGTH OF
            MAILING-DATA
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00020686' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'2020233030303230363836' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERMAIL, 
                 MAILING-DATA, 
                 DFHEIV11, 
                 MA-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001536
001537 8130-EXIT.
001538     EXIT.
001539
001540 8140-UNLOCK-ERMAIL.
001541     
      * EXEC CICS UNLOCK
001542*         DATASET   (FILE-ERMAIL)
001543*    END-EXEC.
      *    MOVE '&*                    #   #00020696' TO DFHEIV0
           MOVE X'262A20202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303230363936' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERMAIL, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001544
001545 8140-EXIT.
001546     EXIT.
001547
001548 8145-read-elcrtt-upd.
001549
001550     move ' '                    to elcrtt-found-sw
001551                                    elcrtt-update-sw
001552     
      * EXEC CICS HANDLE CONDITION
001553*        NOTFND   (8145-exit)
001554*    END-EXEC
      *    MOVE '"$I                   ! 0 #00020707' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3020233030303230373037' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
001555
001556     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
001557     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
001558
001559     
      * EXEC CICS READ UPDATE
001560*        DATASET  (CRTT-ID)
001561*        RIDFLD   (WS-ELCRTT-KEY)
001562*        INTO     (CERTIFICATE-TRAILERS)
001563*    END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00020714' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303230373134' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
001564
001565     set elcrtt-found to true
001566
001567     .
001568 8145-exit.
001569     exit.
001570
001571 8150-UPDATE-ELCRTT.
001572
001573     if elcrtt-found
001574         
      * EXEC CICS REWRITE
001575*           DATASET  (CRTT-ID)
001576*           FROM     (CERTIFICATE-TRAILERS)
001577*        END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00020729' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303230373239' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
001578     ELSE
001579        
      * EXEC CICS WRITE
001580*          DATASET  (CRTT-ID)
001581*          RIDFLD   (WS-ELCRTT-KEY)
001582*          FROM     (CERTIFICATE-TRAILERS)
001583*       END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00020734' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'2020233030303230373334' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
001584     end-if
001585
001586     .
001587 8150-EXIT.
001588     EXIT.
001589
001590 8155-unlock-elcrtt.
001591
001592     
      * EXEC CICS UNLOCK
001593*       DATASET  (CRTT-ID)
001594*    END-EXEC
      *    MOVE '&*                    #   #00020747' TO DFHEIV0
           MOVE X'262A20202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303230373437' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
001595
001596     .
001597 8155-exit.
001598     exit.
001599
001600 8190-UPDATE-REFUND-CLAIM-FLAG.
001601     
      * EXEC CICS HANDLE CONDITION
001602*        NOTFND   (8190-NOTFND)
001603*    END-EXEC.
      *    MOVE '"$I                   ! 1 #00020756' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3120233030303230373536' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001604
001605     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
001606     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
001607
001608     
      * EXEC CICS READ
001609*        UPDATE
001610*        DATASET  (CRTT-ID)
001611*        RIDFLD   (WS-ELCRTT-KEY)
001612*        INTO     (CERTIFICATE-TRAILERS)
001613*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00020763' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303230373633' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001614
001615     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
001616     
      * EXEC CICS REWRITE
001617*       DATASET  (CRTT-ID)
001618*       FROM     (CERTIFICATE-TRAILERS)
001619*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00020771' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303230373731' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001620
001621     GO TO 8190-EXIT.
001622
001623 8190-NOTFND.
001624
001625     MOVE SPACES       TO CERTIFICATE-TRAILERS.
001626     MOVE 'CS'         TO CS-RECORD-ID.
001627     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
001628     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
001629     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
001630     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
001631     
      * EXEC CICS WRITE
001632*       DATASET  (CRTT-ID)
001633*       RIDFLD   (WS-ELCRTT-KEY)
001634*       FROM     (CERTIFICATE-TRAILERS)
001635*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00020786' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'2020233030303230373836' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001636
001637 8190-EXIT.
001638     EXIT.
001639
001640 8195-UPDATE-AGE-FLAGS.
001641     
      * EXEC CICS HANDLE CONDITION
001642*        NOTFND   (8195-NOTFND)
001643*    END-EXEC.
      *    MOVE '"$I                   ! 2 #00020796' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3220233030303230373936' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001644
001645     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
001646     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
001647
001648     
      * EXEC CICS READ
001649*        UPDATE
001650*        DATASET  (CRTT-ID)
001651*        RIDFLD   (WS-ELCRTT-KEY)
001652*        INTO     (CERTIFICATE-TRAILERS)
001653*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00020803' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303230383033' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001654
001655     IF WS-INS-AGE-SET = 'Y'
001656        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
001657     END-IF
001658     IF WS-JNT-AGE-SET = 'Y'
001659        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
001660     END-IF
001661
001662     
      * EXEC CICS REWRITE
001663*       DATASET  (CRTT-ID)
001664*       FROM     (CERTIFICATE-TRAILERS)
001665*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00020817' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303230383137' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001666
001667     GO TO 8195-EXIT.
001668
001669 8195-NOTFND.
001670
001671     MOVE SPACES       TO CERTIFICATE-TRAILERS.
001672     MOVE 'CS'         TO CS-RECORD-ID.
001673     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
001674     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
001675     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
001676     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
001677     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
001678     
      * EXEC CICS WRITE
001679*       DATASET  (CRTT-ID)
001680*       RIDFLD   (WS-ELCRTT-KEY)
001681*       FROM     (CERTIFICATE-TRAILERS)
001682*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00020833' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'2020233030303230383333' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001683
001684 8195-EXIT.
001685     EXIT.
001686
001687 8200-READ-REIN-TABLE.
001688     
      * EXEC CICS HANDLE CONDITION
001689*         NOTFND   (8200-NOTFND)
001690*    END-EXEC.
      *    MOVE '"$I                   ! 3 #00020843' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3320233030303230383433' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001691
001692     
      * EXEC CICS READ
001693*        DATASET     (REIN-ID)
001694*        SET         (ADDRESS OF REINSURANCE-RECORD)
001695*        RIDFLD      (ERREIN-KEY)
001696*    END-EXEC.
      *    MOVE '&"S        E          (   #00020847' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303230383437' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 REIN-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERREIN-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF REINSURANCE-RECORD TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001697
001698     GO TO 8200-EXIT.
001699
001700 8200-NOTFND.
001701     MOVE 'N'             TO WS-REIN-READ-SW.
001702
001703 8200-EXIT.
001704      EXIT.
001705      EJECT
001706
001707 8300-READ-CTBL-TABLE.
001708     
      * EXEC CICS HANDLE CONDITION
001709*        NOTFND    (8300-NOTFND)
001710*        DISABLED  (8300-ERRESS-PROBLEM)
001711*        NOTOPEN   (8300-ERRESS-PROBLEM)
001712*        ENDFILE   (8300-NOTFND)
001713*    END-EXEC.
      *    MOVE '"$IcJ''                ! 4 #00020863' TO DFHEIV0
           MOVE X'222449634A27202020202020' &
                X'202020202020202020202120' &
                X'3420233030303230383633' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001714
001715     
      * EXEC CICS READ
001716*        DATASET     (CTBL-ID)
001717*        SET         (ADDRESS OF COMM-TABLE-RECORD)
001718*        RIDFLD      (ERCTBL-KEY)
001719*    END-EXEC.
      *    MOVE '&"S        E          (   #00020870' TO DFHEIV0
           MOVE X'262253202020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303230383730' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CTBL-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERCTBL-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF COMM-TABLE-RECORD TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001720
001721     MOVE 'Y'                          TO WS-CTBL-READ-SW.
001722
001723     GO TO 8300-EXIT.
001724
001725 8300-NOTFND.
001726
001727     IF CTBL-SW = '0530'
001728         MOVE 'AA'                     TO WS-AH-COMP-CD
001729         MOVE '0550'                   TO CTBL-SW
001730         MOVE '1'                      TO WS-CTBL-READ-SW
001731         GO TO 8300-EXIT.
001732
001733     IF CTBL-SW = '0540'
001734         MOVE 'AA'                     TO WS-LF-COMP-CD
001735         MOVE '0550'                   TO CTBL-SW
001736         MOVE '1'                      TO WS-CTBL-READ-SW
001737         GO TO 8300-EXIT.
001738
001739     IF CTBL-SW = '0550'
001740         MOVE '2'                      TO WS-CTBL-READ-SW
001741         GO TO 8300-EXIT.
001742
001743     GO TO 8300-EXIT.
001744
001745 8300-ERRESS-PROBLEM.
001746
001747      MOVE ER-8050              TO WS-ERROR.
001748      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
001749
001750     GO TO 8300-EXIT.
001751
001752 8300-EXIT.
001753      EXIT.
001754      EJECT
001755
001756
001757 8400-GETMAIN-ERFORM.
001758
001759     
      * EXEC CICS   GETMAIN
001760*        LENGTH  (500)
001761*        SET     (ADDRESS OF FORM-MASTER)
001762*    END-EXEC.
           MOVE 500
             TO DFHEIV11
      *    MOVE '," L                  $   #00020914' TO DFHEIV0
           MOVE X'2C22204C2020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303230393134' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 DFHEIV11, 
                 DFHEIV99
           SET ADDRESS OF FORM-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001763
001764     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
001765
001766 8400-EXIT.
001767      EXIT.
001768
001769 8450-READ-FORM-MASTER.
001770
001771     
      * EXEC CICS  HANDLE CONDITION
001772*        NOTFND   (8450-FORM-NOT-FOUND)
001773*        ENDFILE  (8450-FORM-NOT-FOUND)
001774*    END-EXEC.
      *    MOVE '"$I''                  ! 5 #00020926' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'3520233030303230393236' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001775
001776     
      * EXEC CICS   READ
001777*        DATASET   (FORM-ID)
001778*        RIDFLD    (ERFORM-KEY)
001779*        INTO      (FORM-MASTER)
001780*        GTEQ
001781*    END-EXEC.
           MOVE LENGTH OF
            FORM-MASTER
             TO DFHEIV11
      *    MOVE '&"IL       G          (   #00020931' TO DFHEIV0
           MOVE X'2622494C2020202020202047' &
                X'202020202020202020202820' &
                X'2020233030303230393331' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FORM-ID, 
                 FORM-MASTER, 
                 DFHEIV11, 
                 ERFORM-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001782
001783     MOVE  'Y'           TO  FORM-MASTER-SW.
001784
001785     GO TO  8450-EXIT.
001786
001787 8450-FORM-NOT-FOUND.
001788
001789     MOVE  'N'           TO  FORM-MASTER-SW.
001790
001791 8450-EXIT.
001792      EXIT.
001793
001794 8500-DATE-CONVERT.
001795     
      * EXEC CICS LINK
001796*        PROGRAM    ('ELDATCV')
001797*        COMMAREA   (DATE-CONVERSION-DATA)
001798*        LENGTH     (DC-COMM-LENGTH)
001799*    END-EXEC.
           MOVE 'ELDATCV' TO DFHEIV1
      *    MOVE '."C                   (   #00020950' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303230393530' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 DATE-CONVERSION-DATA, 
                 DC-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001800
001801 8500-EXIT.
001802     EXIT.
001803     EJECT
001804
001805 8555-RELOAD-CONTROL-FILE.
001806     CONTINUE.
001807
001808 8555-EXIT.
001809     EXIT.
001810
001811 8557-GETMAIN-ERPLAN.
001812
001813     
      * EXEC CICS GETMAIN
001814*        LENGTH    (840)
001815*        SET       (ADDRESS OF PLAN-RECORDS)
001816*    END-EXEC.
           MOVE 840
             TO DFHEIV11
      *    MOVE '," L                  $   #00020968' TO DFHEIV0
           MOVE X'2C22204C2020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303230393638' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 DFHEIV11, 
                 DFHEIV99
           SET ADDRESS OF PLAN-RECORDS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001817
001818     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
001819
001820 8557-EXIT.
001821     EXIT.
001822
001823 8560-GETMAIN.
001824     
      * EXEC CICS GETMAIN
001825*        LENGTH    (2000)
001826*        SET       (ADDRESS OF ACCOUNT-MASTER)
001827*    END-EXEC.
           MOVE 2000
             TO DFHEIV11
      *    MOVE '," L                  $   #00020979' TO DFHEIV0
           MOVE X'2C22204C2020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303230393739' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 DFHEIV11, 
                 DFHEIV99
           SET ADDRESS OF ACCOUNT-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001828
001829     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
001830
001831 8560-EXIT.
001832     EXIT.
001833
001834 8570-START-ACCOUNT-MASTER.
001835     
      * EXEC CICS HANDLE CONDITION
001836*        NOTFND    (0199-ACCT-NOT-FOUND)
001837*        ENDFILE   (0199-ACCT-NOT-FOUND)
001838*    END-EXEC.
      *    MOVE '"$I''                  ! 6 #00020990' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'3620233030303230393930' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001839
001840     
      * EXEC CICS STARTBR
001841*        DATASET    (ACCT-ID)
001842*        RIDFLD     (ERACCT-KEY)
001843*        GTEQ
001844*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &   #00020995' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'2020233030303230393935' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 ACCT-ID, 
                 ERACCT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001845
001846 8570-EXIT.
001847     EXIT.
001848
001849 8580-READ-ACCOUNT-MASTER.
001850     
      * EXEC CICS HANDLE CONDITION
001851*        NOTFND    (0199-ACCT-NOT-FOUND)
001852*        ENDFILE   (0199-ACCT-NOT-FOUND)
001853*    END-EXEC.
      *    MOVE '"$I''                  ! 7 #00021005' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'3720233030303231303035' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001854
001855     
      * EXEC CICS READNEXT
001856*        DATASET     (ACCT-ID)
001857*        INTO        (ACCOUNT-MASTER)
001858*        RIDFLD      (ERACCT-KEY)
001859*    END-EXEC.
           MOVE LENGTH OF
            ACCOUNT-MASTER
             TO DFHEIV12
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.IL                  )   #00021010' TO DFHEIV0
           MOVE X'262E494C2020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303231303130' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 ACCT-ID, 
                 ACCOUNT-MASTER, 
                 DFHEIV12, 
                 ERACCT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001860
001861 8580-EXIT.
001862     EXIT.
001863
001864 8582-READ-COMPENSATION-MASTER.
001865     
      * EXEC CICS HANDLE CONDITION
001866*        NOTFND    (8582-COMP-NOT-FOUND)
001867*        ENDFILE   (8582-COMP-NOT-FOUND)
001868*    END-EXEC.
      *    MOVE '"$I''                  ! 8 #00021020' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'3820233030303231303230' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001869
001870     
      * EXEC CICS READ
001871*        DATASET     (COMP-ID)
001872*        INTO        (COMPENSATION-MASTER)
001873*        RIDFLD      (ERCOMP-KEY)
001874*    END-EXEC.
           MOVE LENGTH OF
            COMPENSATION-MASTER
             TO DFHEIV11
      *    MOVE '&"IL       E          (   #00021025' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303231303235' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 COMP-ID, 
                 COMPENSATION-MASTER, 
                 DFHEIV11, 
                 ERCOMP-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001875
001876     MOVE 'Y'                    TO COMP-MASTER-SW
001877
001878     GO TO 8582-EXIT
001879     .
001880 8582-COMP-NOT-FOUND.
001881
001882     MOVE 'N'                    TO COMP-MASTER-SW.
001883
001884 8582-EXIT.
001885     EXIT.
001886
001887 8583-READ-ERAGTC.
001888
001889     
      * EXEC CICS HANDLE CONDITION
001890*        NOTFND    (8583-AGTC-NOT-FOUND)
001891*        ENDFILE   (8583-AGTC-NOT-FOUND)
001892*    END-EXEC.
      *    MOVE '"$I''                  ! 9 #00021044' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'3920233030303231303434' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001893
001894     
      * EXEC CICS STARTBR
001895*        DATASET    (AGTC-ID)
001896*        RIDFLD     (ERAGTC-KEY)
001897*        GTEQ
001898*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &   #00021049' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'2020233030303231303439' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 AGTC-ID, 
                 ERAGTC-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001899
001900 8583-READ-ERAGTC-NEXT.
001901
001902     
      * EXEC CICS READNEXT
001903*        DATASET     (AGTC-ID)
001904*        INTO        (AGENT-COMMISSIONS)
001905*        RIDFLD      (ERAGTC-KEY)
001906*    END-EXEC.
           MOVE LENGTH OF
            AGENT-COMMISSIONS
             TO DFHEIV12
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.IL                  )   #00021057' TO DFHEIV0
           MOVE X'262E494C2020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303231303537' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 AGTC-ID, 
                 AGENT-COMMISSIONS, 
                 DFHEIV12, 
                 ERAGTC-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001907
001908*    MOVE 'Y'                    TO AGTC-MASTER-SW
001909
001910     GO TO 8583-EXIT
001911     .
001912 8583-AGTC-NOT-FOUND.
001913
001914     MOVE 'N'                    TO AGTC-MASTER-SW.
001915
001916 8583-EXIT.
001917     EXIT.
001918
001919 8584-READ-BANK-CROSS-REF.
001920     
      * EXEC CICS HANDLE CONDITION
001921*        NOTFND    (8584-BXRF-NOT-FOUND)
001922*        ENDFILE   (8584-BXRF-NOT-FOUND)
001923*    END-EXEC.
      *    MOVE '"$I''                  ! : #00021075' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'3A20233030303231303735' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001924
001925     
      * EXEC CICS READ
001926*        DATASET     (BXRF-ID)
001927*        INTO        (BANK-CROSS-REFERENCE)
001928*        RIDFLD      (ERBXRF-KEY)
001929*        LENGTH      (BXRF-REC-LENGTH)
001930*    END-EXEC.
      *    MOVE '&"IL       E          (   #00021080' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303231303830' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 BXRF-ID, 
                 BANK-CROSS-REFERENCE, 
                 BXRF-REC-LENGTH, 
                 ERBXRF-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001931
001932     MOVE 'Y'                    TO BXRF-MASTER-SW
001933
001934     GO TO 8584-EXIT
001935     .
001936 8584-BXRF-NOT-FOUND.
001937
001938     MOVE 'N'                    TO BXRF-MASTER-SW.
001939
001940 8584-EXIT.
001941     EXIT.
001942
001943 8585-READ-PLAN-MASTER.
001944
001945     
      * EXEC CICS HANDLE CONDITION
001946*        NOTFND    (8585-PLAN-NOT-FOUND)
001947*        ENDFILE   (8585-PLAN-NOT-FOUND)
001948*    END-EXEC.
      *    MOVE '"$I''                  ! ; #00021100' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'3B20233030303231313030' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001949
001950     
      * EXEC CICS READ
001951*        DATASET     (PLAN-ID)
001952*        INTO        (PLAN-MASTER)
001953*        RIDFLD      (ERPLAN-KEY)
001954*    END-EXEC.
           MOVE LENGTH OF
            PLAN-MASTER
             TO DFHEIV11
      *    MOVE '&"IL       E          (   #00021105' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'2020233030303231313035' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PLAN-ID, 
                 PLAN-MASTER, 
                 DFHEIV11, 
                 ERPLAN-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
001955
001956     MOVE 'Y'                    TO PLAN-MASTER-SW.
001957
001958     GO TO 8585-EXIT.
001959
001960 8585-PLAN-NOT-FOUND.
001961
001962     MOVE 'N'                    TO PLAN-MASTER-SW.
001963
001964 8585-EXIT.
001965     EXIT.
001966
001967 8586-READ-LOAN-OFFICER.
001968
001969     
      * EXEC CICS READ
001970*        DATASET     (LOFC-ID)
001971*        INTO        (LOAN-OFFICER-MASTER)
001972*        RIDFLD      (ERLOFC-KEY)
001973*        RESP        (WS-RESPONSE)
001974*    END-EXEC
           MOVE LENGTH OF
            LOAN-OFFICER-MASTER
             TO DFHEIV11
      *    MOVE '&"IL       E          (  N#00021124' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303231313234' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 LOFC-ID, 
                 LOAN-OFFICER-MASTER, 
                 DFHEIV11, 
                 ERLOFC-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
001975
001976     IF WS-RESP-NORMAL
001977        MOVE 'Y'                 TO LOFC-MASTER-SW
001978     ELSE
001979        MOVE 'N'                 TO LOFC-MASTER-SW
001980     END-IF
001981
001982     .
001983 8586-EXIT.
001984     EXIT.
001985
001986 8587-START-ERPDEF.
001987
001988     
      * EXEC CICS STARTBR
001989*       DATASET   (PDEF-ID)
001990*       RIDFLD    (ERPDEF-KEY)
001991*       GTEQ
001992*       RESP      (WS-RESPONSE)
001993*    END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &  N#00021143' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'204E233030303231313433' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PDEF-ID, 
                 ERPDEF-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
001994
001995     IF WS-RESP-NORMAL
001996        MOVE 'Y'                 TO PDEF-MASTER-SW
001997     ELSE
001998        MOVE 'N'                 TO PDEF-MASTER-SW
001999     END-IF
002000
002001     .
002002 8587-EXIT.
002003     EXIT.
002004
002005 8588-READ-ERPDEF.
002006
002007     
      * EXEC CICS READNEXT
002008*       DATASET   (PDEF-ID)
002009*       RIDFLD    (ERPDEF-KEY)
002010*       INTO      (PRODUCT-MASTER)
002011*       RESP      (WS-RESPONSE)
002012*    END-EXEC
           MOVE LENGTH OF
            PRODUCT-MASTER
             TO DFHEIV12
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.IL                  )  N#00021162' TO DFHEIV0
           MOVE X'262E494C2020202020202020' &
                X'202020202020202020202920' &
                X'204E233030303231313632' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PDEF-ID, 
                 PRODUCT-MASTER, 
                 DFHEIV12, 
                 ERPDEF-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
002013
002014     IF WS-RESP-NORMAL
002015        MOVE 'Y'                 TO PDEF-MASTER-SW
002016     ELSE
002017        MOVE 'N'                 TO PDEF-MASTER-SW
002018     END-IF
002019
002020     .
002021 8588-EXIT.
002022     EXIT.
002023
002024 8589-ENDBR-ERPDEF.
002025
002026     
      * EXEC CICS ENDBR
002027*       DATASET   (PDEF-ID)
002028*    END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00021181' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303231313831' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PDEF-ID, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
002029
002030     .
002031 8589-EXIT.
002032     EXIT.
002033
002034 8590-READ-CERT-MASTER.
002035     IF PB-COMPANY-ID = 'UCL'
002036         GO TO 8690-READ-CERT-MASTER-UCL.
002037
002038     
      * EXEC CICS HANDLE CONDITION
002039*         NOTFND    (0299-CERT-NOT-FOUND)
002040*    END-EXEC.
      *    MOVE '"$I                   ! < #00021193' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3C20233030303231313933' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002041
002042     
      * EXEC CICS READ
002043*        DATASET     (CERT-ID)
002044*        INTO        (CERTIFICATE-MASTER)
002045*        RIDFLD      (ELCERT-KEY)
002046*        UPDATE
002047*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00021197' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303231313937' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CERT-ID, 
                 CERTIFICATE-MASTER, 
                 DFHEIV11, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002048
002049 8590-EXIT.
002050     EXIT.
002051
002052 8690-READ-CERT-MASTER-UCL.
002053     
      * EXEC CICS HANDLE CONDITION
002054*         NOTFND    (8700-READ-CERT-MASTER)
002055*    END-EXEC.
      *    MOVE '"$I                   ! = #00021208' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3D20233030303231323038' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002056
002057 8690-READ-CERT-CONT.
002058     
      * EXEC CICS READ
002059*        DATASET     (CERT-ID)
002060*        INTO        (CERTIFICATE-MASTER)
002061*        RIDFLD      (ELCERT-KEY)
002062*        UPDATE
002063*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00021213' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'2020233030303231323133' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CERT-ID, 
                 CERTIFICATE-MASTER, 
                 DFHEIV11, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002064
002065     GO TO 8590-EXIT.
002066
002067 8700-READ-CERT-MASTER.
002068     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
002069     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
002070     
      * EXEC CICS HANDLE CONDITION
002071*         DUPKEY    (8720-COMP-ACCOUNTS)
002072*         ENDFILE   (8730-END-BROWSE)
002073*         NOTFND    (8740-NOT-FOUND)
002074*    END-EXEC.
      *    MOVE '"$$''I                 ! > #00021225' TO DFHEIV0
           MOVE X'222424274920202020202020' &
                X'202020202020202020202120' &
                X'3E20233030303231323235' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002075
002076     
      * EXEC CICS STARTBR
002077*        DATASET     ('ELCERT5')
002078*        RIDFLD      (ELCERT2-KEY)
002079*        EQUAL
002080*    END-EXEC.
           MOVE 'ELCERT5' TO DFHEIV1
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         E          &   #00021231' TO DFHEIV0
           MOVE X'262C20202020202020202045' &
                X'202020202020202020202620' &
                X'2020233030303231323331' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ELCERT2-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002081
002082 8710-READ-NEXT.
002083     
      * EXEC CICS READNEXT
002084*        DATASET     ('ELCERT5')
002085*        INTO        (CERTIFICATE-MASTER)
002086*        RIDFLD      (ELCERT2-KEY)
002087*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV12
           MOVE 'ELCERT5' TO DFHEIV1
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.IL                  )   #00021238' TO DFHEIV0
           MOVE X'262E494C2020202020202020' &
                X'202020202020202020202920' &
                X'2020233030303231323338' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 CERTIFICATE-MASTER, 
                 DFHEIV12, 
                 ELCERT2-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002088
002089 8720-COMP-ACCOUNTS.
002090     
      * EXEC CICS ENTER
002091*         TRACEID (001)
002092*         FROM (PB-C-LAST-NAME)
002093*    END-EXEC.
           MOVE 001
             TO DFHEIV11
      *    MOVE ':$F                   %   #00021245' TO DFHEIV0
           MOVE X'3A2446202020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303231323435' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV11, 
                 PB-C-LAST-NAME, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002094
002095     
      * EXEC CICS ENTER
002096*         TRACEID (002)
002097*         FROM (CM-INSURED-LAST-NAME)
002098*    END-EXEC.
           MOVE 002
             TO DFHEIV11
      *    MOVE ':$F                   %   #00021250' TO DFHEIV0
           MOVE X'3A2446202020202020202020' &
                X'202020202020202020202520' &
                X'2020233030303231323530' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV11, 
                 CM-INSURED-LAST-NAME, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002099
002100     IF PB-CERT-NO NOT = CM-CERT-NO
002101         GO TO 8730-END-BROWSE.
002102
002103     IF PB-ACCOUNT = CM-ACCOUNT
002104         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
002105             MOVE ER-2799        TO WS-ERROR
002106             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002107             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
002108             GO TO 8730-END-BROWSE.
002109
002110     GO TO 8710-READ-NEXT.
002111
002112 8730-END-BROWSE.
002113     
      * EXEC CICS ENDBR
002114*         DATASET    ('ELCERT5')
002115*    END-EXEC.
           MOVE 'ELCERT5' TO DFHEIV1
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00021268' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303231323638' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002116
002117 8740-NOT-FOUND.
002118     GO TO 0299-CERT-NOT-FOUND.
002119
002120 8750-START-ELSTAT.
002121
002122     
      * EXEC CICS STARTBR
002123*       DATASET   (STAT-ID)
002124*       RIDFLD    (ELSTAT-KEY)
002125*       GTEQ
002126*       RESP      (WS-RESPONSE)
002127*    END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &  N#00021277' TO DFHEIV0
           MOVE X'262C20202020202020202047' &
                X'202020202020202020202620' &
                X'204E233030303231323737' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 STAT-ID, 
                 ELSTAT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
002128
002129     IF WS-RESP-NORMAL
002130        MOVE 'Y'                 TO STAT-MASTER-SW
002131     ELSE
002132        MOVE 'N'                 TO STAT-MASTER-SW
002133     END-IF
002134
002135     .
002136 8750-EXIT.
002137     EXIT.
002138
002139 8752-READ-ELSTAT.
002140
002141     
      * EXEC CICS READNEXT
002142*       DATASET   (STAT-ID)
002143*       RIDFLD    (ELSTAT-KEY)
002144*       INTO      (STATE-FILE)
002145*       RESP      (WS-RESPONSE)
002146*    END-EXEC
           MOVE LENGTH OF
            STATE-FILE
             TO DFHEIV12
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.IL                  )  N#00021296' TO DFHEIV0
           MOVE X'262E494C2020202020202020' &
                X'202020202020202020202920' &
                X'204E233030303231323936' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 STAT-ID, 
                 STATE-FILE, 
                 DFHEIV12, 
                 ELSTAT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
002147
002148     IF WS-RESP-NORMAL
002149        MOVE 'Y'                 TO STAT-MASTER-SW
002150     ELSE
002151        MOVE 'N'                 TO STAT-MASTER-SW
002152     END-IF
002153
002154     .
002155 8752-EXIT.
002156     EXIT.
002157
002158 8800-GET-COMP-RATE.
002159     MOVE +1 TO IB.
002160     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
002161         ADD +9 TO IB
002162         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
002163             ADD +9 TO IB
002164             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
002165                MOVE ZEROS       TO WS-WK-RATE
002166                GO TO 8800-EXIT.
002167
002168     IF PB-I-AGE GREATER CT-AGE (1)
002169         ADD +3 TO IB
002170         IF PB-I-AGE GREATER CT-AGE (2)
002171             ADD +3 TO IB
002172             IF PB-I-AGE GREATER CT-AGE (3)
002173                MOVE ZEROS       TO WS-WK-RATE
002174                GO TO 8800-EXIT.
002175
002176     IF WS-WORK-TERM GREATER CT-TRM (1)
002177         ADD +1 TO IB
002178         IF WS-WORK-TERM GREATER CT-TRM (2)
002179             ADD +1 TO IB
002180             IF WS-WORK-TERM GREATER CT-TRM (3)
002181                MOVE ZEROS       TO WS-WK-RATE
002182                GO TO 8800-EXIT.
002183
002184     IF CT-RT (IB) NOT NUMERIC
002185         MOVE CT-RT-R (IB) TO CTBL-TABLE
002186         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
002187         GO TO 8800-GET-COMP-RATE.
002188
002189     MOVE CT-RT (IB) TO WS-WK-RATE.
002190
002191 8800-EXIT.
002192     EXIT.
002193     EJECT
002194 8900-ADDRESS-FILE.
002195     IF ERACCT-FILE-ADDRESSED
002196         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
002197         GO TO 8900-ADDRESS-EXIT.
002198
002199     IF ELCNTL-FILE-ADDRESSED
002200         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
002201         GO TO 8900-ADDRESS-EXIT.
002202
002203     IF ERPLAN-FILE-ADDRESSED
002204         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
002205         GO TO 8900-ADDRESS-EXIT.
002206
002207     IF ERFORM-FILE-ADDRESSED
002208         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
002209         GO TO 8900-ADDRESS-EXIT.
002210
002211 8900-ADDRESS-EXIT.
002212     EXIT.
002213
002214 9000-READ-CONTROL.
002215     
      * EXEC CICS HANDLE CONDITION
002216*        NOTFND    (9000-NOTFND)
002217*    END-EXEC.
      *    MOVE '"$I                   ! ? #00021370' TO DFHEIV0
           MOVE X'222449202020202020202020' &
                X'202020202020202020202120' &
                X'3F20233030303231333730' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002218
002219     
      * EXEC CICS READ
002220*        DATASET     (CNTL-ID)
002221*        SET         (ADDRESS OF CONTROL-FILE)
002222*        RIDFLD      (ELCNTL-KEY)
002223*        GTEQ
002224*    END-EXEC.
      *    MOVE '&"S        G          (   #00021374' TO DFHEIV0
           MOVE X'262253202020202020202047' &
                X'202020202020202020202820' &
                X'2020233030303231333734' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CNTL-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELCNTL-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CONTROL-FILE TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002225
002226     GO TO 9000-EXIT.
002227
002228 9000-NOTFND.
002229     IF RC-SW-1 = '1'
002230        MOVE ER-2616              TO WS-ERROR
002231        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002232        GO TO 9000-EXIT.
002233
002234     IF RC-SW-1 = '2'
002235        MOVE ER-2602              TO WS-ERROR
002236        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
002237
002238 9000-EXIT.
002239      EXIT.
002240
002241     EJECT
002242 9100-READ-CONTROL.
002243     
      * EXEC CICS HANDLE CONDITION
002244*        NOTFND  (9100-NOTFND)
002245*        ENDFILE (9100-NOTFND)
002246*    END-EXEC.
      *    MOVE '"$I''                  ! @ #00021398' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'4020233030303231333938' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002247
002248     
      * EXEC CICS READ
002249*        DATASET     (CNTL-ID)
002250*        INTO        (CONTROL-FILE)
002251*        RIDFLD      (ELCNTL-KEY)
002252*        GTEQ
002253*    END-EXEC.
           MOVE LENGTH OF
            CONTROL-FILE
             TO DFHEIV11
      *    MOVE '&"IL       G          (   #00021403' TO DFHEIV0
           MOVE X'2622494C2020202020202047' &
                X'202020202020202020202820' &
                X'2020233030303231343033' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CNTL-ID, 
                 CONTROL-FILE, 
                 DFHEIV11, 
                 ELCNTL-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002254
002255     GO TO 9100-EXIT.
002256
002257 9100-NOTFND.
002258
002259     IF RC-SW-2 = '0'
002260        MOVE '1'                  TO STATE-RECORD-ERROR
002261        GO TO 9100-EXIT
002262     END-IF
002263
002264     IF RC-SW-2 = '1'
002265        MOVE '1'                  TO LF-BENEFIT-ERROR
002266        MOVE ER-2604              TO WS-ERROR
002267        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002268        GO TO 9100-EXIT.
002269
002270     IF RC-SW-2 = '2'
002271        MOVE '1'                  TO AH-BENEFIT-ERROR
002272        MOVE ER-2605              TO WS-ERROR
002273        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002274        GO TO 9100-EXIT.
002275
002276     IF RC-SW-2 = '3'
002277         MOVE ER-2603           TO WS-ERROR
002278         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
002279         GO TO 9100-EXIT.
002280
002281     IF RC-SW-2 = '4'
002282         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
002283         GO TO 9100-EXIT.
002284
002285     IF RC-SW-2 = '5'
002286         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
002287         IF WS-AH-INPUT-CD-1 = SPACE
002288             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
002289         ELSE
002290             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
002291
002292 9100-EXIT.
002293      EXIT.
002294     EJECT
002295 9200-CONTROL-GETMAIN.
002296     
      * EXEC CICS GETMAIN
002297*         LENGTH   (750)
002298*         SET      (ADDRESS OF CONTROL-FILE)
002299*    END-EXEC.
           MOVE 750
             TO DFHEIV11
      *    MOVE '," L                  $   #00021451' TO DFHEIV0
           MOVE X'2C22204C2020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303231343531' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 DFHEIV11, 
                 DFHEIV99
           SET ADDRESS OF CONTROL-FILE TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002300
002301     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
002302
002303 9200-EXIT.
002304     EXIT.
002305
002306 9250-UNLOCK-RETURN.
002307     
      * EXEC CICS UNLOCK
002308*        DATASET   (CERT-ID)
002309*    END-EXEC.
      *    MOVE '&*                    #   #00021462' TO DFHEIV0
           MOVE X'262A20202020202020202020' &
                X'202020202020202020202320' &
                X'2020233030303231343632' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CERT-ID, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002310
002311 9300-ABEND.
002312     MOVE DFHEIBLK               TO WS-ERROR-LINE.
002313
002314     
      * EXEC CICS LINK
002315*        PROGRAM   ('EL004')
002316*        COMMAREA  (WS-ERROR-LINE)
002317*        LENGTH    (72)
002318*    END-EXEC.
           MOVE 'EL004' TO DFHEIV1
           MOVE 72
             TO DFHEIV11
      *    MOVE '."C                   (   #00021469' TO DFHEIV0
           MOVE X'2E2243202020202020202020' &
                X'202020202020202020202820' &
                X'2020233030303231343639' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-ERROR-LINE, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002319
002320     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
002321
002322     
      * EXEC CICS ABEND
002323*        ABCODE ('EL50')
002324*    END-EXEC.
           MOVE 'EL50' TO DFHEIV5
      *    MOVE '.,A                   "   #00021477' TO DFHEIV0
           MOVE X'2E2C41202020202020202020' &
                X'202020202020202020202220' &
                X'2020233030303231343737' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV5
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002325
002326     EJECT
002327
002328******************************************************************
002329*                                                                *
002330*            E R R O R   F O R M A T   R O U T I N E             *
002331*                                                                *
002332******************************************************************
002333
002334 9900-ERROR-FORMAT.
002335
002336     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
002337                    PB-COMMON-ERROR (2) OR
002338                    PB-COMMON-ERROR (3) OR
002339                    PB-COMMON-ERROR (4) OR
002340                    PB-COMMON-ERROR (5) OR
002341                    PB-COMMON-ERROR (6) OR
002342                    PB-COMMON-ERROR (7) OR
002343                    PB-COMMON-ERROR (8) OR
002344                    PB-COMMON-ERROR (9) OR
002345                    PB-COMMON-ERROR (10)
002346        GO TO 9900-EXIT.
002347
002348     IF PB-NO-OF-ERRORS = +10
002349        GO TO 9900-EXIT.
002350
002351     ADD +1  TO PB-NO-OF-ERRORS.
002352     MOVE WS-ERROR               TO PB-COMMON-ERROR
002353                                       (PB-NO-OF-ERRORS).
002354 9900-EXIT.
002355     EXIT.
002356
002357 9990-RETURN.
002358     IF BROWSE-STARTED
002359        
      * EXEC CICS ENDBR
002360*            DATASET  (ACCT-ID)
002361*       END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00021514' TO DFHEIV0
           MOVE X'263220202020202020202020' &
                X'202020202020202020202420' &
                X'2020233030303231353134' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 ACCT-ID, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002362
002363 9990-EXIT.
002364     EXIT.
002365
002366
002367****Check for CRTO record, add one if not found.
002368 9991-CHECK-FOR-ELCRTO.
002369      
      * EXEC CICS HANDLE CONDITION
002370*         NOTFND  (9991-CRTO-NOT-FOUND)
002371*         ENDFILE (9991-CRTO-NOT-FOUND)
002372*     END-EXEC.
      *    MOVE '"$I''                  ! A #00021524' TO DFHEIV0
           MOVE X'222449272020202020202020' &
                X'202020202020202020202120' &
                X'4120233030303231353234' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002373     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
002374     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
002375     MOVE +0                     TO ELCRTO-SEQ-NO
002376
002377     
      * EXEC CICS READ
002378*       DATASET   ('ELCRTO')
002379*       INTO      (ORIGINAL-CERTIFICATE)
002380*       RIDFLD    (ELCRTO-KEY)
002381*       GTEQ
002382*       RESP      (WS-RESPONSE)
002383*    END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&"IL       G          (  N#00021532' TO DFHEIV0
           MOVE X'2622494C2020202020202047' &
                X'202020202020202020202820' &
                X'204E233030303231353332' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 ELCRTO-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
002384
002385     IF WS-RESP-NORMAL
002386        AND (OC-CONTROL-PRIMARY (1:33) =
002387                 PB-CONTROL-BY-ACCOUNT (1:33))
002388        AND (OC-RECORD-TYPE =  'I')
002389           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
002390               GO TO 9991-CHECK-INDICATORS
002391           ELSE
002392               SUBTRACT +1 FROM OC-KEY-SEQ-NO
002393               GO TO 9991-CRTO-ADD-REC
002394           END-IF
002395     END-IF.
002396
002397 9991-CRTO-NOT-FOUND.
002398
002399     MOVE SPACES              TO ORIGINAL-CERTIFICATE
002400     MOVE 'OC'                TO OC-RECORD-ID
002401     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
002402                              TO OC-CONTROL-PRIMARY (1:33)
002403     MOVE +4096               TO OC-KEY-SEQ-NO.
002404
002405 9991-CRTO-ADD-REC.
002406
002407     MOVE 'E050'              TO OC-LAST-MAINT-BY
002408     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
002409     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
002410     MOVE 'I'                 TO OC-RECORD-TYPE
002411     IF PB-ISSUE
002412         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
002413         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
002414         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
002415         MOVE PB-I-AGE               TO OC-INS-AGE
002416         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
002417         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
002418         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
002419         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
002420         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
002421         MOVE PB-I-LF-TERM           TO OC-LF-TERM
002422         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
002423         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
002424         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
002425         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
002426         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
002427         IF PB-I-JOINT-COMMISSION > +0
002428             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
002429         ELSE
002430             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
002431         END-IF
002432         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
002433         MOVE +0                     TO OC-LF-CANCEL-AMT
002434                                        OC-LF-ITD-CANCEL-AMT
002435         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
002436         MOVE PB-I-AH-TERM           TO OC-AH-TERM
002437         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
002438         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
002439         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
002440         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
002441         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
002442         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
002443         MOVE +0                     TO OC-AH-CANCEL-AMT
002444                                        OC-AH-ITD-CANCEL-AMT
002445         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
002446         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
002447         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
002448     ELSE
002449         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
002450         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
002451         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
002452         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
002453         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
002454         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
002455         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
002456         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
002457         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
002458          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
002459             MOVE SPACES             TO OC-LF-BENCD
002460             MOVE ZEROS              TO OC-LF-TERM
002461                                        OC-LF-BEN-AMT
002462                                        OC-LF-PRM-AMT
002463                                        OC-LF-ALT-BEN-AMT
002464                                        OC-LF-ALT-PRM-AMT
002465                                        OC-LF-COMM-PCT
002466                                        OC-LF-CANCEL-AMT
002467             MOVE LOW-VALUES         TO OC-LF-EXP-DT
002468             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
002469         ELSE
002470             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
002471             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
002472             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
002473             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
002474             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
002475             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
002476             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
002477             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
002478             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
002479             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
002480         END-IF
002481         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
002482         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
002483          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
002484             MOVE SPACES             TO OC-AH-BENCD
002485             MOVE ZEROS              TO OC-AH-TERM
002486                                        OC-AH-BEN-AMT
002487                                        OC-AH-PRM-AMT
002488                                        OC-AH-COMM-PCT
002489                                        OC-AH-CANCEL-AMT
002490                                        OC-AH-CP
002491             MOVE LOW-VALUES         TO OC-AH-EXP-DT
002492             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
002493         ELSE
002494             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
002495             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
002496             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
002497             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
002498             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
002499             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
002500             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
002501             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
002502             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
002503         END-IF
002504         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
002505         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
002506         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
002507         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
002508     END-IF
002509     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
002510
002511     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
002512
002513     
      * EXEC CICS READ
002514*         DATASET   (FILE-ERMAIL)
002515*         RIDFLD    (MA-CONTROL-PRIMARY)
002516*         INTO      (MAILING-DATA)
002517*         RESP      (WS-RESPONSE)
002518*    END-EXEC
           MOVE LENGTH OF
            MAILING-DATA
             TO DFHEIV11
      *    MOVE '&"IL       E          (  N#00021668' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303231363638' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERMAIL, 
                 MAILING-DATA, 
                 DFHEIV11, 
                 MA-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
002519
002520     IF WS-RESP-NORMAL
002521         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
002522     END-IF.
002523
002524     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
002525     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
002526
002527     
      * EXEC CICS READ
002528*         DATASET  (CRTT-ID)
002529*         RIDFLD   (WS-ELCRTT-KEY)
002530*         INTO     (CERTIFICATE-TRAILERS)
002531*         RESP     (WS-RESPONSE)
002532*    END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&"IL       E          (  N#00021682' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303231363832' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
002533
002534     IF WS-RESP-NORMAL
002535         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
002536         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
002537     END-IF.
002538
002539     
      * EXEC CICS WRITE
002540*       DATASET   ('ELCRTO')
002541*       FROM      (ORIGINAL-CERTIFICATE)
002542*       RIDFLD    (OC-CONTROL-PRIMARY)
002543*       RESP      (WS-RESPONSE)
002544*    END-EXEC.
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&$ L                  ''  N#00021694' TO DFHEIV0
           MOVE X'2624204C2020202020202020' &
                X'202020202020202020202720' &
                X'204E233030303231363934' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 OC-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002545
002546     GO TO 9991-EXIT.
002547
002548 9991-CHECK-INDICATORS.
002549
002550     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
002551         GO TO 9991-EXIT
002552     END-IF.
002553
002554     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
002555         GO TO 9991-EXIT
002556     END-IF.
002557
002558     
      * EXEC CICS READ
002559*       DATASET   ('ELCRTO')
002560*       INTO      (ORIGINAL-CERTIFICATE)
002561*       RIDFLD    (OC-CONTROL-PRIMARY)
002562*       UPDATE
002563*       RESP      (WS-RESPONSE)
002564*    END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&"IL       EU         (  N#00021713' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'552020202020202020202820' &
                X'204E233030303231373133' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 OC-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
002565     IF WS-RESP-NORMAL
002566        IF PB-ISSUE
002567          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
002568          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
002569          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
002570          MOVE PB-I-AGE               TO OC-INS-AGE
002571          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
002572          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
002573          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
002574          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
002575          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
002576          MOVE PB-I-LF-TERM           TO OC-LF-TERM
002577          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
002578          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
002579          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
002580          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
002581          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
002582          IF PB-I-JOINT-COMMISSION > +0
002583              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
002584          ELSE
002585              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
002586          END-IF
002587          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
002588          MOVE PB-I-AH-TERM           TO OC-AH-TERM
002589          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
002590          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
002591          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
002592          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
002593          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
002594          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
002595          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
002596
002597          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
002598          
      * EXEC CICS READ
002599*             DATASET   (FILE-ERMAIL)
002600*             RIDFLD    (MA-CONTROL-PRIMARY)
002601*             INTO      (MAILING-DATA)
002602*             RESP      (WS-RESPONSE)
002603*         END-EXEC
           MOVE LENGTH OF
            MAILING-DATA
             TO DFHEIV11
      *    MOVE '&"IL       E          (  N#00021753' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303231373533' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERMAIL, 
                 MAILING-DATA, 
                 DFHEIV11, 
                 MA-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
002604          IF WS-RESP-NORMAL
002605             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
002606          END-IF
002607
002608          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
002609          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
002610          
      * EXEC CICS READ
002611*             DATASET  (CRTT-ID)
002612*             RIDFLD   (WS-ELCRTT-KEY)
002613*             INTO     (CERTIFICATE-TRAILERS)
002614*             RESP     (WS-RESPONSE)
002615*         END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&"IL       E          (  N#00021765' TO DFHEIV0
           MOVE X'2622494C2020202020202045' &
                X'202020202020202020202820' &
                X'204E233030303231373635' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
002616          IF WS-RESP-NORMAL
002617             MOVE CS-INS-AGE-DEFAULT-FLAG TO
002618                               OC-INS-AGE-DEFAULT-FLAG
002619             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
002620                               OC-JNT-AGE-DEFAULT-FLAG
002621          END-IF
002622
002623        ELSE
002624          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
002625             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
002626             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
002627             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
002628          END-IF
002629          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
002630             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
002631             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
002632             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
002633          END-IF
002634          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
002635        END-IF
002636        
      * EXEC CICS REWRITE
002637*          DATASET   ('ELCRTO')
002638*          FROM      (ORIGINAL-CERTIFICATE)
002639*          RESP      (WS-RESPONSE)
002640*       END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&& L                  %  N#00021791' TO DFHEIV0
           MOVE X'2626204C2020202020202020' &
                X'202020202020202020202520' &
                X'204E233030303231373931' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
002641     END-IF.
002642
002643 9991-EXIT.
002644     EXIT.
002645
002646
002647 9999-RETURN.
002648     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
002649
002650     
      * EXEC CICS RETURN
002651*    END-EXEC.
      *    MOVE '.(                    ''   #00021805' TO DFHEIV0
           MOVE X'2E2820202020202020202020' &
                X'202020202020202020202720' &
                X'2020233030303231383035' TO DFHEIV0
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
002652
002653     
      * GOBACK.
           MOVE '9%                    "   ' TO DFHEIV0
           MOVE 'EL050' TO DFHEIV1
           CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
           GOBACK.

       9999-DFHBACK SECTION.
           MOVE '9%                    "   ' TO DFHEIV0
           MOVE 'EL050' TO DFHEIV1
           CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
           GOBACK.
       9999-DFHEXIT.
           IF DFHEIGDJ EQUAL 0001
               NEXT SENTENCE
           ELSE IF DFHEIGDJ EQUAL 2
               GO TO 9300-ABEND,
                     3990-FILES-NOT-OPEN
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 3
               GO TO 6610-START-BROWSE,
                     6630-ERRESS-PROBLEM,
                     6630-END-OF-FILE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 4
               GO TO 6630-END-OF-FILE,
                     6630-ERRESS-PROBLEM,
                     6630-ERRESS-PROBLEM,
                     6630-END-OF-FILE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 5
               GO TO 6630-END-OF-FILE,
                     6630-END-OF-FILE,
                     6630-ERRESS-PROBLEM,
                     6630-ERRESS-PROBLEM
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 6
               GO TO 6660-START-BROWSE,
                     6690-ERRESC-PROBLEM,
                     6690-ERRESC-PROBLEM,
                     6690-END-OF-FILE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 7
               GO TO 6690-END-OF-FILE,
                     6690-ERRESC-PROBLEM,
                     6690-ERRESC-PROBLEM,
                     6690-END-OF-FILE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 8
               GO TO 6690-END-OF-FILE,
                     6690-ERRESC-PROBLEM,
                     6690-ERRESC-PROBLEM,
                     6690-END-OF-FILE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 9
               GO TO 7250-CONTINUE,
                     7250-CONTINUE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 10
               GO TO 7300-CONTINUE,
                     7300-CONTINUE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 11
               GO TO 7320-CONTINUE,
                     7320-CONTINUE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 12
               GO TO 8000-FREE-MAIN
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 13
               GO TO 8100-NOTFND,
                     8100-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 14
               GO TO 8110-NOTFND,
                     8110-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 15
               GO TO 8130-EXIT
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 16
               GO TO 8145-exit
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 17
               GO TO 8190-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 18
               GO TO 8195-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 19
               GO TO 8200-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 20
               GO TO 8300-NOTFND,
                     8300-ERRESS-PROBLEM,
                     8300-ERRESS-PROBLEM,
                     8300-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 21
               GO TO 8450-FORM-NOT-FOUND,
                     8450-FORM-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 22
               GO TO 0199-ACCT-NOT-FOUND,
                     0199-ACCT-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 23
               GO TO 0199-ACCT-NOT-FOUND,
                     0199-ACCT-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 24
               GO TO 8582-COMP-NOT-FOUND,
                     8582-COMP-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 25
               GO TO 8583-AGTC-NOT-FOUND,
                     8583-AGTC-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 26
               GO TO 8584-BXRF-NOT-FOUND,
                     8584-BXRF-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 27
               GO TO 8585-PLAN-NOT-FOUND,
                     8585-PLAN-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 28
               GO TO 0299-CERT-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 29
               GO TO 8700-READ-CERT-MASTER
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 30
               GO TO 8720-COMP-ACCOUNTS,
                     8730-END-BROWSE,
                     8740-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 31
               GO TO 9000-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 32
               GO TO 9100-NOTFND,
                     9100-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 33
               GO TO 9991-CRTO-NOT-FOUND,
                     9991-CRTO-NOT-FOUND
               DEPENDING ON DFHEIGDI.
           MOVE '9%                    "   ' TO DFHEIV0
           MOVE 'EL050' TO DFHEIV1
           CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
           GOBACK.
