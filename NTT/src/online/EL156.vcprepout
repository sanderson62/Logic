      *((program: EL156.cl2))
000001 IDENTIFICATION DIVISION.                                         
000002                                                                  
000003 PROGRAM-ID. EL156 .                              
000004*              PROGRAM CONVERTED BY                               
000005*              COBOL CONVERSION AID PO 5785-ABJ                   
000006*              CONVERSION DATE 05/17/94 13:55:56.                 
000007*                            VMOD=2.098                           
000008*                                                                 
000009*                                                                 
000010*AUTHOR.     LOGIC,INC.                                           
000011*            DALLAS, TEXAS.                                       
000012                                                                  
000013*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING              
000014                                                                  
000015******************************************************************
000016*                   C H A N G E   L O G                           
000017*                                                                 
000018* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.                
000019*-----------------------------------------------------------------
000020*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE            
000021* EFFECTIVE    NUMBER                                             
000022*-----------------------------------------------------------------
000023* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
000024* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC     
000025* 052506    2006030600001  AJRA  ADD PROOF DATE                   
000026* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC 
000027* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR         
000028* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS   
000029* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
000030* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4             
000031* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA   
000032* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL 
000033* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN              
000034* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
000035* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT          
000036* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
000037* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC       
000038* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN       
000039* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE             
000040* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN           
000041* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
000042* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
000043* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS 
000044* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
000045* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF    
000046* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5             
000047* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE  
000048* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND          
000049* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
000050* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT   
000051* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD 
000052* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS        
000053* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES          
000054* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
000055* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES         
000056* 070714    2014052800001  PEMA  correct read on erpdef for DCC   
000057* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality  
000058* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS                 
000059* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
000060* 110515  IR2015103000001  TANA  Check app level for 3550 message 
000061* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING      
000062* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME       
000063* 050616  CR2015030200004  TANA  Additional pmt Pd thru exp date  
000064* 013017  CR2016053100001  PEMA  ACH PROCESSING                   
000065* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS            
000066* 102617    2017101800003  TANA  Fix family leave auth level      
000067* 022718    2017100200004  TANA  Set hold & pays > than 30 days   
000068* 031218    2018030800002  TANA  Handle offline pmts w/ hold & pay
000069* 082218  CR2018051400001  TANA  Hold and Pay                     
000070* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE             
000071* 112018  CR2018102900001  TANA  REQUIRE EOB NOTE STARTING WITH F 
000072* 040819  IR2019030400004  TANA  ADD EDITS FOR HOLD AND PAY       
000073* 043019  IR2019041900001  TANA  Correct total claim pymts msg    
000074* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL  
000075* 090821  CR2021081200003  PEMA  Add error if inc > act cnc dt    
000076* 022122  CR2021100800003  TANA  Add B and H claim types          
000077******************************************************************
000078                                                                  
000079     EJECT                                                        
000080 ENVIRONMENT DIVISION.                                            
000081                                                                  
000082 DATA DIVISION.                                                   
000083                                                                  
000084 WORKING-STORAGE SECTION.                                         
000085                                                                  
000086 77  FILLER  PIC X(32)  VALUE '********************************'. 
000087 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'. 
000088 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'. 
000089 77  WS-SSN  PIC X(9) VALUE ZEROS.                                
000090 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.             
000091 77  C0                          PIC S999 COMP-3 VALUE +0.        
000092 77  C1                          PIC S999 COMP-3 VALUE +0.        
000093 77  C2                          PIC S999 COMP-3 VALUE +0.        
000094 77  C3                          PIC S999 COMP-3 VALUE +0.        
000095 77  s1                          PIC S999 COMP-3 VALUE +0.        
000096 77  s2                          pic s999 comp-3 value +0.        
000097 77  P1                          PIC S999 COMP-3 VALUE +0.        
000098 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.    
000099 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.    
000100 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.    
000101 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.    
000102 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.                
000103 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.          
000104 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0. 
000105 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.        
000106 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.   
000107 77  ws-max-bens                 pic s999 comp-3 value +0.        
000108 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.       
000109 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.    
000110 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.       
000111 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.    
000112 77  ws-pd-bens                  pic s9(5) comp-3 value +0.       
000113 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.      
000114 77  WS-ATT-AGE                  PIC S9(3)V99    COMP-3 VALUE +0. 
000115 77  WS-EDIT-AGE                 PIC S999       COMP-3 VALUE ZERO.
000116 77  ws-MAX-TOT-BEN              pic s9(7)v99 comp-3 value +0.    
000117                                                                  
000118                                                                  
000119                                                                  
000120*    COPY ELCSCTM.                                                
      *>>((file: ELCSCTM))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCSCTM                             *
000005*                            VMOD=2.001                          *
000006*                                                                *
000007*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
000008*                                                                *
000009******************************************************************
000010 01  SECURITY-MESSAGE.                                            
000011     12  FILLER                          PIC X(30)                
000012            VALUE '** LOGIC SECURITY VIOLATION -'.                
000013     12  SM-READ                         PIC X(6).                
000014     12  FILLER                          PIC X(5)                 
000015            VALUE ' PGM='.                                        
000016     12  SM-PGM                          PIC X(6).                
000017     12  FILLER                          PIC X(5)                 
000018            VALUE ' OPR='.                                        
000019     12  SM-PROCESSOR-ID                 PIC X(4).                
000020     12  FILLER                          PIC X(6)                 
000021            VALUE ' TERM='.                                       
000022     12  SM-TERMID                       PIC X(4).                
000023     12  FILLER                          PIC XX   VALUE SPACE.    
000024     12  SM-JUL-DATE                     PIC 9(5).                
000025     12  FILLER                          PIC X    VALUE SPACE.    
000026     12  SM-TIME                         PIC 99.99.               
000027                                                                  
      *<<((file: ELCSCTM))
000121                                                                  
000122*    COPY ELCSCRTY.                                               
      *>>((file: ELCSCRTY))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCSCRTY                            *
000005*                            VMOD=2.001                          *
000006*                                                                *
000007*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
000008*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
000009*        SAVED IN PI-SECURITY-ADDRESS.                           *
000010*                                                                *
000011******************************************************************
000012 01  SECURITY-CONTROL.                                            
000013     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.  
000014     12  FILLER                       PIC XX    VALUE 'SC'.       
000015     12  SC-CREDIT-CODES.                                         
000016         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.             
000017             20  SC-CREDIT-DISPLAY    PIC X.                      
000018             20  SC-CREDIT-UPDATE     PIC X.                      
000019     12  SC-CLAIMS-CODES.                                         
000020         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.             
000021             20  SC-CLAIMS-DISPLAY    PIC X.                      
000022             20  SC-CLAIMS-UPDATE     PIC X.                      
      *<<((file: ELCSCRTY))
000123                                                                  
000124 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.        
000125 01  WS-DATE-AREA.                                                
000126     12  SAVE-DATE           PIC X(8)    VALUE SPACES.            
000127     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.            
000128     12  SAVE-DATE-CCYYMMDD.                                      
000129         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.    
000130         16  SAVE-DATE-YMD.                                       
000131             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.    
000132             20  FILLER              PIC X(04)   VALUE SPACES.    
000133                                                                  
000134 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.          
000135 01  STANDARD-AREAS.                                              
000136     12  WS-RESPONSE         PIC S9(8)   COMP.                    
000137         88  WS-RESP-NORMAL              VALUE +00.               
000138         88  WS-RESP-ERROR               VALUE +01.               
000139         88  WS-RESP-NOTFND              VALUE +13.               
000140         88  WS-RESP-DUPREC              VALUE +14.               
000141         88  WS-RESP-ENDFILE             VALUE +20.               
000142     12  PMT-HEAD-A.                                              
000143         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.       
000144         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.      
000145         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
000146-        '     RESERVES  TYPE    AMOUNT'.                         
000147     12  PMT-HEAD-B.                                              
000148         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.    
000149         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.    
000150         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.      
000151     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.       
000152     12  GETMAIN-SPACE       PIC X       VALUE SPACE.             
000153     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.          
000154     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.          
000155     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.          
000156     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.          
000157     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.            
000158     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.           
000159     12  PGM-NAME            PIC X(8).                            
000160     12  TIME-IN             PIC S9(7).                           
000161     12  TIME-OUT-R  REDEFINES TIME-IN.                           
000162         16  FILLER          PIC X.                               
000163         16  TIME-OUT        PIC 99V99.                           
000164         16  FILLER          PIC XX.                              
000165     12  XCTL-005            PIC X(8)    VALUE 'EL005'.           
000166     12  XCTL-010            PIC X(8)    VALUE 'EL010'.           
000167     12  XCTL-126            PIC X(8)    VALUE 'EL126'.           
000168     12  XCTL-141            PIC X(8)    VALUE 'EL141'.           
000169     12  XCTL-157            PIC X(8)    VALUE 'EL157'.           
000170     12  XCTL-155            PIC X(8)    VALUE 'EL155'.           
000171     12  XCTL-130            PIC X(8)    VALUE 'EL130'.           
000172     12  XCTL-132            PIC X(8)    VALUE 'EL132'.           
000173     12  LINK-001            PIC X(8)    VALUE 'EL001'.           
000174     12  LINK-004            PIC X(8)    VALUE 'EL004'.           
000175     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.          
000176     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.         
000177     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.          
000178     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.          
000179     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.      
000180     12  WS-BLANK            PIC X       VALUE ' '.               
000181                                                                  
000182 01  MISC-WORK-AREAS.                                             
000183     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.   
000184     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.   
000185     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.   
000186     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.   
000187     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.   
000188     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.   
000189     12  W-REM                   PIC S999      COMP-3 VALUE +0.   
000190     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.   
000191     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.            
000192     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.            
000193     12  W-CALLED-NAME           PIC X(08).                       
000194     12  W-EOB-CODES.                                             
000195         16  W-EOB-CODE-GRP OCCURS 5 TIMES.                       
000196             20  W-EOB-CODE      PIC XXX.                         
000197             20  W-EOB-FILLER    PIC X.                           
000198     12  W-EOB-NDX               PIC S9        VALUE ZERO.        
000199     12  W-NAME-LAST             PIC X(15).                       
000200     12  W-NAME-FIRST            PIC X(15).                       
000201     12  W-NAME-MIDDLE.                                           
000202         16  FILLER              PIC X.                           
000203         16  W-NAME-MIDDLE-2     PIC X.                           
000204         16  FILLER              PIC X(13).                       
000205     12  W-DMD-CHECK-NO.                                          
000206         16  W-DMD-CHECK-NO-1    PIC X(4).                        
000207         16  W-DMD-CHECK-NO-2    PIC X.                           
000208         16  W-DMD-CHECK-NO-3    PIC XX.                          
000209                                                                  
000210     12  WS-COMPUTE-FROM-DT  PIC XX.                              
000211     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.       
000212     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.       
000213     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.       
000214     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.          
000215     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.          
000216     12  WS-PRINTED-SW       PIC X VALUE SPACES.                  
000217         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.                 
000218         88  PAYMENT-NOT-PRINTED       VALUE 'N'.                 
000219     12  WS-RELEASED-SW      PIC X VALUE SPACES.                  
000220         88  PAYMENT-NOT-RELEASED      VALUE 'N'.                 
000221     12  WS-UPDATE-SW        PIC X VALUE ' '.                     
000222     12  WS-GROUPING.                                             
000223         16  WS-GROUP-1      PIC X VALUE SPACES.                  
000224         16  FILLER          PIC X(05) VALUE SPACES.              
000225     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.                     
000226     12  WS-BROWSE-START-SW  PIC X VALUE ' '.                     
000227     12  WS-WORK-STATE-ACCT.                                      
000228         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.            
000229         16  FILLER          PIC X       VALUE '/'.               
000230         16  WS-WORK-STATE   PIC XX      VALUE SPACES.            
000231     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.        
000232     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.            
000233     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.            
000234     12  QID.                                                     
000235         16  QID-TERM        PIC X(4)    VALUE SPACES.            
000236         16  FILLER          PIC X(4)    VALUE '156A'.            
000237     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.        
000238     12  SUB-1               PIC S9(4)   VALUE +0     COMP.       
000239     12  FIRST-ENTRY         PIC X       VALUE 'N'.               
000240     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.            
000241     12  BENE-FOUND-SW       PIC X       VALUE SPACE.             
000242     12  FOUND-TOL-SW        PIC X       VALUE 'N'.               
000243     12  RETURNED-FROM-B     PIC X       VALUE 'N'.               
000244     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.            
000245     12  WS-STATUS           PIC X       VALUE SPACES.            
000246     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.        
000247     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.        
000248     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.        
000249     12  ws-extended-exp-dt  pic xx      value low-values.        
000250     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.        
000251     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.        
000252     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.        
000253     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.        
000254     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.            
000255     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.             
000256     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.  
000257     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.  
000258     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.  
000259     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.  
000260     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.  
000261     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.  
000262     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.  
000263     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.  
000264     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.              
000265     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.              
000266     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.             
000267     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.             
000268     12  WS-EARNING-METHOD   PIC X         VALUE ' '.             
000269     12  WS-CALC-METHOD      PIC X         VALUE ' '.             
000270     12  WS-PAY-TYPE         PIC X         VALUE ' '.             
000271     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.   
000272     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.   
000273     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.        
000274     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).             
000275     12  WORK-DATE-FROM.                                          
000276         16  WDF-MONTH       PIC 99        VALUE ZERO.            
000277         16  WDF-DAY         PIC 99        VALUE ZERO.            
000278         16  WDF-YEAR        PIC 99        VALUE ZERO.            
000279     12  WORK-DATE-THRU.                                          
000280         16  WDT-MONTH       PIC 99        VALUE ZERO.            
000281         16  WDT-DAY         PIC 99        VALUE ZERO.            
000282         16  WDT-YEAR        PIC 99        VALUE ZERO.            
000283     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.            
000284     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.            
000285     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.            
000286     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.            
000287     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.            
000288     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.            
000289     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.            
000290     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.            
000291     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.            
000292     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.               
000293     12  WS-PY-WK REDEFINES WS-PY-WORK.                           
000294         16  WS-PY-NUM       PIC S9(7)V99.                        
000295         16  WS-PY-SIGN      PIC X.                               
000296     12  WS-DY-WORK          PIC S9(5).                           
000297     12  WS-DY-WK REDEFINES WS-DY-WORK.                           
000298         16  WS-DY-NUM       PIC S9(4).                           
000299         16  WS-DY-SIGN      PIC X.                               
000300     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.               
000301         88  COMP-REC-FOUND              VALUE 'Y'.               
000302     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.               
000303         88  BENEFIT-FOUND       VALUE 'Y'.                       
000304         88  NO-BENEFIT-FOUND    VALUE 'N'.                       
000305     12  WS-TERMS.                                                
000306         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.             
000307         16  FILLER          PIC X       VALUE '/'.               
000308         16  WST-REM         PIC ZZ9     VALUE ZEROS.             
000309         16  WST-REM-DAYS-GRP.                                    
000310             20  WST-SLASH   PIC X       VALUE '/'.               
000311             20  WST-REM-DAYS                                     
000312                             PIC --9.                             
000313     12  WS-ACCESS.                                               
000314         16  FILLER          PIC XX      VALUE SPACES.            
000315         16  WS-BEN-CD       PIC XX      VALUE SPACES.            
000316     12  WS-STATE-ACCESS.                                         
000317         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.            
000318         16  FILLER          PIC XX      VALUE SPACES.            
000319     12  WS-CARR-ACCESS.                                          
000320         16  FILLER          PIC X(3)    VALUE SPACES.            
000321         16  WS-CARR         PIC X       VALUE SPACES.            
000322     12  DATE-WORK.                                               
000323         16  FILLER          PIC XX      VALUE SPACES.            
000324         16  NUM-WORK        PIC X(6)    VALUE SPACES.            
000325     12  WS-SAVE-INPUT.                                           
000326         16  WS-PMTTYPE      PIC X       VALUE SPACE.             
000327         16  WS-PAYEE        PIC XX      VALUE SPACE.             
000328         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.            
000329         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.            
000330         16  WS-OFFLINE      PIC X       VALUE SPACE.             
000331         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.            
000332         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.                 
000333         16  WS-EPYFROM      PIC 9(6)    VALUE 0.                 
000334         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.                 
000335         16  WS-EDAYS        PIC S9(5)    VALUE +0.               
000336         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.               
000337         16  WS-ERESV        PIC S9(7)V99 VALUE +0.               
000338         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.                
000339         16  WS-ETYPE        PIC X       VALUE SPACE.             
000340         16  WS-CASH         PIC X       VALUE SPACE.             
000341         16  WS-GROUPED      PIC X       VALUE SPACE.             
000342         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.               
000343         16  WS-AIGFROM      PIC 9(6)    VALUE 0.                 
000344         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.            
000345         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.                 
000346         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.               
000347         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.             
000348         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.             
000349         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.             
000350         16  ws-int-to-rem-borr pic x value spaces.               
000351     12  LAST-ERROR-LINE.                                         
000352         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.            
000353         16  FILLER              PIC X(30)                        
000354             VALUE ' FATAL ERRORS ENCOUNTERED'.                   
000355         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.           
000356         16  FILLER              PIC X(28)                        
000357             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.                
000358     12  WS-CHECK-AREA.                                           
000359         16  WS-CHECK-CARR       PIC X   VALUE SPACES.            
000360         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.            
000361     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).       
000362     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.               
000363         16  FILLER              PIC XX.                          
000364         16  WS-A-CHECK-NUM-5    PIC 9(5).                        
000365     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.              
000366         16  FILLER              PIC X.                           
000367         16  WS-A-CHECK-NUM-6    PIC 9(6).                        
000368     12  OPTION-1-SAVE-AREA.                                      
000369         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.    
000370         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.    
000371     12  WS-WORK-ZIP.                                             
000372         16  WS-ZIP              PIC X(5)  VALUE ZEROS.           
000373         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.           
000374     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP                     
000375                                 PIC 9(9).                        
000376     12  WS-FLI-PMTNOTE.                                          
000377         16  WS-PMTOPTION        PIC XX.                          
000378         16  WS-DOCNAME          PIC X(28).                       
000379         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.                 
000380             20  WS-AMOUNT       PIC X(8).                        
000381             20  FILLER          PIC X(20).                       
000382         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.                
000383             20  WS-NUM-AMT      PIC 9(6)V99.                     
000384             20  FILLER          PIC X(20).                       
000385                                                                  
000386     12  WS-HAN-PMTNOTE.                                          
000387         16  WS-HAN-PMT-CODE     PIC X.                           
000388         16  WS-HAN-PMT-NOTE     PIC X(39).                       
000389                                                                  
000390     12  WS-NCL-PMT-OPTION       PIC XX.                          
000391         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.  
000392                                                                  
000393     12  WS-CLAIM-SEQUENCE.                                       
000394         16  FILLER              PIC X VALUE '('.                 
000395         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.           
000396         16  FILLER              PIC X(04) VALUE ' OF '.          
000397         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.           
000398         16  FILLER              PIC X VALUE ')'.                 
000399                                                                  
000400     12  WS-REFUND-AMT           PIC Z(7).99.                     
000401     12  WS-CALC-INT             PIC S9(7)V99.                    
000402     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.     
000403                                                                  
000404     12  SUB                     PIC 99 VALUE ZEROS.              
000405                                                                  
000406     12  WS-BOANOTE1.                                             
000407         16  WS-BOANOTE1-DESC    PIC X(11).                       
000408         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.                
000409         16  FILLER              PIC X(17).                       
000410     12  WS-BOANOTE2.                                             
000411         16  WS-BOANOTE2-DESC    PIC X(11).                       
000412         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.                
000413         16  FILLER              PIC X(17).                       
000414                                                                  
000415     12  WS-NCLNOTE1.                                             
000416         16  WS-NCLNOTE1-DESC    PIC X(11).                       
000417         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.                
000418         16  FILLER              PIC X(17).                       
000419     12  WS-NCLNOTE2.                                             
000420         16  WS-NCLNOTE2-DESC    PIC X(11).                       
000421         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.                
000422         16  FILLER              PIC X(17).                       
000423                                                                  
000424     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES. 
000425     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.                      
000426     12  WS-SAVE-APPROVED-LEVEL  PIC X.                           
000427     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.         
000428     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.      
000429     12  WS-LETTER-SW            PIC X          VALUE 'N'.        
000430     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.        
000431     12  WS-BROWSE-SW            PIC X          VALUE 'N'.        
000432     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.        
000433     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.        
000434                                                                  
000435     12  WS-AIG-WORK-AREAS.                                       
000436         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.               
000437             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.               
000438         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.               
000439             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.               
000440         16  WS-FROM-DATE-MDY.                                    
000441             20  WS-FROM-MO      PIC 99.                          
000442             20  WS-FROM-DA      PIC 99.                          
000443             20  WS-FROM-YR      PIC 99.                          
000444         16  WS-TEMP-DATE-MDY.                                    
000445             20  WS-TEMP-MO      PIC 99.                          
000446             20  WS-TEMP-DA      PIC 99.                          
000447             20  WS-TEMP-YR      PIC 99.                          
000448         16  WS-BIN-FROM-DT      PIC XX.                          
000449         16  WS-TEMP-INC-MDY.                                     
000450             20  WS-TEMP-INC-MO  PIC 99.                          
000451             20  WS-TEMP-INC-DA  PIC 99.                          
000452             20  WS-TEMP-INC-YR  PIC 99.                          
000453         16  WS-PMT-DUE-MDY.                                      
000454             20  WS-PMT-DUE-MO   PIC 99.                          
000455             20  WS-PMT-DUE-DA   PIC 99.                          
000456             20  WS-PMT-DUE-YR   PIC 99.                          
000457         16  WS-PMT-DUE-DT       PIC XX.                          
000458         16  WS-NEXT-PMT-DUE-DT  PIC XX.                          
000459         16  WS-RETRO-ELIM-DT    PIC XX.                          
000460         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.   
000461             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.   
000462         16  WS-SAVE-DUE-DA      PIC 99.                          
000463         16  WS-CDAYS            PIC S9(05).                      
000464         16  WS-DAYS-OFF         PIC S9(05).                      
000465         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.             
000466             88  ELIM-SATISFIED            VALUE 'Y'.             
000467         16  WS-AIG-CHECKNO.                                      
000468             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
000469             20  WS-A-CHECKNO-3-7.                                
000470                 24  FILLER              PIC X(3)    VALUE SPACES.
000471                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
000472                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.  
000473         16  WS-AIG-GROUPING.                                     
000474             20  WS-A-BENE               PIC XXX.                 
000475             20  FILLER                  PIC XXX.                 
000476         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.   
000477             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.   
000478             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.   
000479         16  WS-AIG-UNEMPLY-DESC         PIC X(60)                
000480                 VALUE 'UNEMPLOYMENT PAYMENT'.                    
000481         16  WS-CHK-THRU-DT              PIC XX.                  
000482         16  WS-HOLD-BIN-DATE-1          PIC XX.                  
000483                                                                  
000484 01  MISC-CSO-AREA.                                               
000485     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.   
000486     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.          
000487     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.    
000488         88  APPROVAL-NEEDED                        VALUE 'Y'.    
000489     12  WS-APPROV-NOTE                  PIC X(43)                
000490         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.     
000491     12  WS-3550-APPROV-NOTE             PIC X(43)                
000492         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.     
000493     12  WS-DUPE-APPROV-NOTE             PIC X(43)                
000494         VALUE 'APPROVAL NEEDED - DUPLICATE PAYMENT EXISTS '.     
000495     12  WS-REAUDIT-NOTE                 PIC X(43)                
000496         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.     
000497     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.        
000498     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.        
000499     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.       
000500     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.       
000501     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.       
000502     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.       
000503     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.      
000504         88 PAYEE-STATE-FOUND                     VALUE 'Y'.      
000505     12  WS-PAYEE-CITY-STATE     PIC X(30).                       
000506     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.                   
000507         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).           
000508     12  WS-PD-DAYS              PIC S9(5) VALUE +0.              
000509     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.       
000510     12  WS-WORK-NAME            PIC X(30).                       
000511     12  FILLER  REDEFINES WS-WORK-NAME.                          
000512         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).             
000513     12  WS-INSURED-NAME         PIC X(30).                       
000514     12  FILLER  REDEFINES WS-INSURED-NAME.                       
000515         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).          
000516     12  WS-PAYEE-NAME           PIC X(30).                       
000517     12  FILLER  REDEFINES WS-PAYEE-NAME.                         
000518         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).            
000519     12  WS-HOLD-UNTIL-SW        PIC X VALUE SPACES.              
000520         88  HOLD-UNTIL-CHK            VALUE 'Y'.                 
000521         88  HOLD-UNTIL-PMT            VALUE 'P'.                 
000522     12  WS-HOLD-UNTIL-DT        PIC X(02) VALUE ZERO.            
000523     12  WS-UNPAID-HOLD-UNTIL-SW PIC X VALUE SPACES.              
000524         88  UNPAID-HOLD-UNTIL-EXISTS  VALUE 'Y'.                 
000525     12  WS-DUPE-VOID-PMT-SW     PIC X VALUE SPACES.              
000526         88  DUPE-VOID-PMT-EXISTS      VALUE 'Y'.                 
000527     12  WS-CHECK-ALL-PMTS-SW    PIC X VALUE SPACES.              
000528         88  CHECK-ALL-PMTS            VALUE 'Y'.                 
000529     12  WS-TOT-AMOUNT-PAID      PIC S9(7)V99  COMP-3 VALUE ZERO. 
000530     12  WS-UNPD-HOLD-UNTIL-DT   PIC X(02) VALUE ZERO.            
000531                                                                  
000532                                                                  
000533 01  ERROR-MESSAGES.                                              
000534     12  ER-0000                 PIC X(4)  VALUE '0000'.          
000535     12  ER-0004                 PIC X(4)  VALUE '0004'.          
000536     12  ER-0008                 PIC X(4)  VALUE '0008'.          
000537     12  ER-0019                 PIC X(4)  VALUE '0019'.          
000538     12  ER-0029                 PIC X(4)  VALUE '0029'.          
000539     12  ER-0042                 PIC X(4)  VALUE '0042'.          
000540     12  ER-0070                 PIC X(4)  VALUE '0070'.          
000541     12  ER-0130                 PIC X(4)  VALUE '0130'.          
000542     12  ER-0149                 PIC X(4)  VALUE '0149'.          
000543     12  ER-0154                 PIC X(4)  VALUE '0154'.          
000544     12  ER-0168                 PIC X(4)  VALUE '0168'.          
000545     12  ER-0169                 PIC X(4)  VALUE '0169'.          
000546     12  ER-0172                 PIC X(4)  VALUE '0174'.          
000547     12  ER-0198                 PIC X(4)  VALUE '0198'.          
000548     12  ER-0204                 PIC X(4)  VALUE '0204'.          
000549     12  ER-0206                 PIC X(4)  VALUE '0206'.          
000550     12  ER-0252                 PIC X(4)  VALUE '0252'.          
000551     12  ER-0254                 PIC X(4)  VALUE '0254'.          
000552     12  ER-0282                 PIC X(4)  VALUE '0282'.          
000553     12  ER-0283                 PIC X(4)  VALUE '0283'.          
000554     12  ER-0294                 PIC X(4)  VALUE '0294'.          
000555     12  ER-0338                 PIC X(4)  VALUE '0338'.          
000556     12  ER-0419                 PIC X(4)  VALUE '0419'.          
000557     12  ER-0420                 PIC X(4)  VALUE '0420'.          
000558     12  ER-0421                 PIC X(4)  VALUE '0421'.          
000559     12  ER-0422                 PIC X(4)  VALUE '0422'.          
000560     12  ER-0433                 PIC X(4)  VALUE '0433'.          
000561     12  ER-0436                 PIC X(4)  VALUE '0436'.          
000562     12  ER-0437                 PIC X(4)  VALUE '0437'.          
000563     12  ER-0438                 PIC X(4)  VALUE '0438'.          
000564     12  ER-0439                 PIC X(4)  VALUE '0439'.          
000565     12  ER-0440                 PIC X(4)  VALUE '0440'.          
000566     12  ER-0441                 PIC X(4)  VALUE '0441'.          
000567     12  ER-0442                 PIC X(4)  VALUE '0442'.          
000568     12  ER-0443                 PIC X(4)  VALUE '0443'.          
000569     12  ER-0444                 PIC X(4)  VALUE '0444'.          
000570     12  ER-0445                 PIC X(4)  VALUE '0445'.          
000571     12  ER-0446                 PIC X(4)  VALUE '0446'.          
000572     12  ER-0447                 PIC X(4)  VALUE '0447'.          
000573     12  ER-0448                 PIC X(4)  VALUE '0448'.          
000574     12  ER-0449                 PIC X(4)  VALUE '0449'.          
000575     12  ER-0452                 PIC X(4)  VALUE '0452'.          
000576     12  ER-0458                 PIC X(4)  VALUE '0458'.          
000577     12  ER-0459                 PIC X(4)  VALUE '0459'.          
000578     12  ER-0460                 PIC X(4)  VALUE '0460'.          
000579     12  ER-0461                 PIC X(4)  VALUE '0461'.          
000580     12  ER-0462                 PIC X(4)  VALUE '0462'.          
000581     12  ER-0463                 PIC X(4)  VALUE '0463'.          
000582     12  ER-0464                 PIC X(4)  VALUE '0464'.          
000583     12  ER-0465                 PIC X(4)  VALUE '0465'.          
000584     12  ER-0466                 PIC X(4)  VALUE '0466'.          
000585     12  ER-0467                 PIC X(4)  VALUE '0467'.          
000586     12  ER-0468                 PIC X(4)  VALUE '0468'.          
000587     12  ER-0469                 PIC X(4)  VALUE '0469'.          
000588     12  ER-0473                 PIC X(4)  VALUE '0473'.          
000589     12  ER-0474                 PIC X(4)  VALUE '0474'.          
000590     12  ER-0475                 PIC X(4)  VALUE '0475'.          
000591     12  ER-0476                 PIC X(4)  VALUE '0476'.          
000592     12  ER-0477                 PIC X(4)  VALUE '0477'.          
000593     12  ER-0478                 PIC X(4)  VALUE '0478'.          
000594     12  ER-0479                 PIC X(4)  VALUE '0479'.          
000595     12  ER-0481                 PIC X(4)  VALUE '0481'.          
000596     12  ER-0491                 PIC X(4)  VALUE '0491'.          
000597     12  ER-0492                 PIC X(4)  VALUE '0492'.          
000598     12  ER-0493                 PIC X(4)  VALUE '0493'.          
000599     12  ER-0494                 PIC X(4)  VALUE '0494'.          
000600     12  ER-0495                 PIC X(4)  VALUE '0495'.          
000601     12  ER-0499                 PIC X(4)  VALUE '0499'.          
000602     12  ER-0500                 PIC X(4)  VALUE '0500'.          
000603     12  ER-0501                 PIC X(4)  VALUE '0501'.          
000604     12  ER-0502                 PIC X(4)  VALUE '0502'.          
000605     12  ER-0508                 PIC X(4)  VALUE '0508'.          
000606     12  ER-0513                 PIC X(4)  VALUE '0513'.          
000607     12  ER-0518                 PIC X(4)  VALUE '0518'.          
000608     12  ER-0524                 PIC X(4)  VALUE '0524'.          
000609     12  ER-0525                 PIC X(4)  VALUE '0525'.          
000610     12  ER-0526                 PIC X(4)  VALUE '0526'.          
000611     12  ER-0530                 PIC X(4)  VALUE '0530'.          
000612     12  ER-0540                 PIC X(4)  VALUE '0540'.          
000613     12  ER-0541                 PIC X(4)  VALUE '0541'.          
000614     12  ER-0542                 PIC X(4)  VALUE '0542'.          
000615     12  ER-0543                 PIC X(4)  VALUE '0543'.          
000616     12  ER-0545                 PIC X(4)  VALUE '0545'.          
000617     12  ER-0552                 PIC X(4)  VALUE '0552'.          
000618     12  ER-0555                 PIC X(4)  VALUE '0555'.          
000619     12  ER-0556                 PIC X(4)  VALUE '0556'.          
000620     12  ER-0557                 PIC X(4)  VALUE '0557'.          
000621     12  ER-0572                 PIC X(4)  VALUE '0572'.          
000622     12  ER-0573                 PIC X(4)  VALUE '0573'.          
000623     12  ER-0594                 PIC X(4)  VALUE '0594'.          
000624     12  ER-0616                 PIC X(4)  VALUE '0616'.          
000625     12  ER-0617                 PIC X(4)  VALUE '0617'.          
000626     12  ER-0618                 PIC X(4)  VALUE '0618'.          
000627     12  ER-0657                 PIC X(4)  VALUE '0657'.          
000628     12  ER-0658                 PIC X(4)  VALUE '0658'.          
000629     12  ER-0699                 PIC X(4)  VALUE '0699'.          
000630     12  ER-0730                 PIC X(4)  VALUE '0730'.          
000631     12  ER-0737                 PIC X(4)  VALUE '0737'.          
000632     12  ER-0760                 PIC X(4)  VALUE '0760'.          
000633     12  ER-0768                 PIC X(4)  VALUE '0768'.          
000634     12  ER-0769                 PIC X(4)  VALUE '0769'.          
000635     12  ER-0770                 PIC X(4)  VALUE '0770'.          
000636     12  ER-0802                 PIC X(4)  VALUE '0802'.          
000637     12  ER-0803                 PIC X(4)  VALUE '0803'.          
000638     12  ER-0819                 PIC X(4)  VALUE '0819'.          
000639     12  ER-0834                 PIC X(4)  VALUE '0834'.          
000640     12  ER-0836                 PIC X(4)  VALUE '0836'.          
000641     12  ER-0844                 PIC X(4)  VALUE '0844'.          
000642     12  ER-0845                 PIC X(4)  VALUE '0845'.          
000643     12  ER-0846                 PIC X(4)  VALUE '0846'.          
000644     12  ER-0849                 PIC X(4)  VALUE '0849'.          
000645     12  ER-0851                 PIC X(4)  VALUE '0851'.          
000646     12  ER-0872                 PIC X(4)  VALUE '0872'.          
000647     12  ER-0873                 PIC X(4)  VALUE '0873'.          
000648     12  ER-0874                 PIC X(4)  VALUE '0874'.          
000649     12  ER-0879                 PIC X(4)  VALUE '0879'.          
000650     12  ER-0919                 PIC X(4)  VALUE '0919'.          
000651     12  ER-0921                 PIC X(4)  VALUE '0921'.          
000652     12  ER-0923                 PIC X(4)  VALUE '0923'.          
000653     12  ER-0925                 PIC X(4)  VALUE '0925'.          
000654     12  ER-0944                 PIC X(4)  VALUE '0944'.          
000655     12  ER-0945                 PIC X(4)  VALUE '0945'.          
000656     12  ER-0946                 PIC X(4)  VALUE '0946'.          
000657     12  ER-0947                 PIC X(4)  VALUE '0947'.          
000658     12  ER-0948                 PIC X(4)  VALUE '0948'.          
000659     12  ER-0949                 PIC X(4)  VALUE '0949'.          
000660     12  ER-0950                 PIC X(4)  VALUE '0950'.          
000661     12  ER-0951                 PIC X(4)  VALUE '0951'.          
000662     12  ER-0954                 PIC X(4)  VALUE '0954'.          
000663     12  ER-0956                 PIC X(4)  VALUE '0956'.          
000664     12  ER-0967                 PIC X(4)  VALUE '0967'.          
000665     12  ER-0968                 PIC X(4)  VALUE '0968'.          
000666     12  ER-0974                 PIC X(4)  VALUE '0974'.          
000667     12  ER-0975                 PIC X(4)  VALUE '0975'.          
000668     12  ER-1561                 PIC X(4)  VALUE '1561'.          
000669     12  ER-1566                 PIC X(4)  VALUE '1566'.          
000670     12  ER-1567                 PIC X(4)  VALUE '1567'.          
000671     12  ER-1569                 PIC X(4)  VALUE '1569'.          
000672     12  er-1582                 pic x(4)  value '1582'.          
000673     12  er-1657                 pic x(4)  value '1657'.          
000674     12  er-1658                 pic x(4)  value '1658'.          
000675     12  er-1667                 pic x(4)  value '1667'.          
000676     12  er-1670                 pic x(4)  value '1670'.          
000677     12  er-1671                 pic x(4)  value '1671'.          
000678     12  er-1672                 pic x(4)  value '1672'.          
000679     12  er-1673                 pic x(4)  value '1673'.          
000680     12  er-1674                 pic x(4)  value '1674'.          
000681     12  er-1677                 pic x(4)  value '1677'.          
000682     12  er-1681                 pic x(4)  value '1681'.          
000683     12  ER-1775                 PIC X(4)  VALUE '1775'.          
000684     12  ER-1880                 PIC X(4)  VALUE '1880'.          
000685     12  ER-1930                 PIC X(4)  VALUE '1930'.          
000686     12  ER-2044                 PIC X(4)  VALUE '2044'.          
000687     12  ER-3140                 PIC X(4)  VALUE '3140'.          
000688     12  ER-3141                 PIC X(4)  VALUE '3141'.          
000689     12  ER-3255                 PIC X(4)  VALUE '3255'.          
000690     12  ER-3272                 PIC X(4)  VALUE '3272'.          
000691     12  ER-3276                 PIC X(4)  VALUE '3276'.          
000692     12  ER-3277                 PIC X(4)  VALUE '3277'.          
000693     12  ER-3278                 PIC X(4)  VALUE '3278'.          
000694     12  ER-3279                 PIC X(4)  VALUE '3279'.          
000695     12  ER-3280                 PIC X(4)  VALUE '3280'.          
000696     12  ER-3516                 PIC X(4)  VALUE '3516'.          
000697     12  ER-3527                 PIC X(4)  VALUE '3527'.          
000698     12  ER-3528                 PIC X(4)  VALUE '3528'.          
000699     12  ER-3529                 PIC X(4)  VALUE '3529'.          
000700     12  ER-3530                 PIC X(4)  VALUE '3530'.          
000701     12  ER-3531                 PIC X(4)  VALUE '3531'.          
000702     12  ER-3532                 PIC X(4)  VALUE '3532'.          
000703     12  ER-3533                 PIC X(4)  VALUE '3533'.          
000704     12  ER-3534                 PIC X(4)  VALUE '3534'.          
000705     12  ER-3535                 PIC X(4)  VALUE '3535'.          
000706     12  ER-3536                 PIC X(4)  VALUE '3536'.          
000707     12  ER-3537                 PIC X(4)  VALUE '3537'.          
000708     12  ER-3538                 PIC X(4)  VALUE '3538'.          
000709     12  ER-3539                 PIC X(4)  VALUE '3539'.          
000710     12  ER-3540                 PIC X(4)  VALUE '3540'.          
000711     12  ER-3541                 PIC X(4)  VALUE '3541'.          
000712     12  ER-3542                 PIC X(4)  VALUE '3542'.          
000713     12  ER-3543                 PIC X(4)  VALUE '3543'.          
000714     12  ER-3546                 PIC X(4)  VALUE '3546'.          
000715     12  ER-3549                 PIC X(4)  VALUE '3549'.          
000716     12  ER-3551                 PIC X(4)  VALUE '3551'.          
000717     12  ER-3818                 PIC X(4)  VALUE '3818'.          
000718     12  ER-7540                 PIC X(4)  VALUE '7540'.          
000719     12  ER-7576                 PIC X(4)  VALUE '7576'.          
000720     12  ER-7579                 PIC X(4)  VALUE '7579'.          
000721     12  ER-7580                 PIC X(4)  VALUE '7580'.          
000722     12  ER-7583                 PIC X(4)  VALUE '7583'.          
000723     12  ER-7585                 PIC X(4)  VALUE '7585'.          
000724     12  ER-7830                 PIC X(4)  VALUE '7830'.          
000725     12  ER-7831                 PIC X(4)  VALUE '7831'.          
000726     12  ER-7832                 PIC X(4)  VALUE '7832'.          
000727     12  ER-7833                 PIC X(4)  VALUE '7833'.          
000728     12  ER-7834                 PIC X(4)  VALUE '7834'.          
000729     12  ER-7835                 PIC X(4)  VALUE '7835'.          
000730     12  ER-7836                 PIC X(4)  VALUE '7836'.          
000731     12  ER-7837                 PIC X(4)  VALUE '7837'.          
000732     12  ER-7838                 PIC X(4)  VALUE '7838'.          
000733     12  ER-7841                 PIC X(4)  VALUE '7841'.          
000734     12  ER-7844                 PIC X(4)  VALUE '7844'.          
000735     12  ER-7845                 PIC X(4)  VALUE '7845'.          
000736     12  ER-8000                 PIC X(4)  VALUE '8000'.          
000737     12  ER-8051                 PIC X(4)  VALUE '8051'.          
000738     12  ER-8052                 PIC X(4)  VALUE '8052'.          
000739     12  ER-8053                 PIC X(4)  VALUE '8053'.          
000740     12  ER-8054                 PIC X(4)  VALUE '8054'.          
000741     12  ER-8055                 PIC X(4)  VALUE '8055'.          
000742     12  ER-8056                 PIC X(4)  VALUE '8056'.          
000743     12  ER-8057                 PIC X(4)  VALUE '8057'.          
000744     12  ER-8058                 PIC X(4)  VALUE '8058'.          
000745     12  ER-8059                 PIC X(4)  VALUE '8059'.          
000746     12  ER-8060                 PIC X(4)  VALUE '8060'.          
000747     12  ER-8061                 PIC X(4)  VALUE '8061'.          
000748     12  ER-8062                 PIC X(4)  VALUE '8062'.          
000749     12  ER-8063                 PIC X(4)  VALUE '8063'.          
000750     12  ER-8064                 PIC X(4)  VALUE '8064'.          
000751     12  ER-8065                 PIC X(4)  VALUE '8065'.          
000752     12  ER-8066                 PIC X(4)  VALUE '8066'.          
000753     12  ER-8146                 PIC X(4)  VALUE '8146'.          
000754     12  ER-8147                 PIC X(4)  VALUE '8147'.          
000755     12  ER-8152                 PIC X(4)  VALUE '8152'.          
000756     12  ER-8153                 PIC X(4)  VALUE '8153'.          
000757     12  ER-8154                 PIC X(4)  VALUE '8154'.          
000758     12  ER-8155                 PIC X(4)  VALUE '8155'.          
000759     12  ER-8310                 PIC X(4)  VALUE '8310'.          
000760     12  ER-8311                 PIC X(4)  VALUE '8311'.          
000761     12  ER-8312                 PIC X(4)  VALUE '8312'.          
000762     12  ER-8313                 PIC X(4)  VALUE '8313'.          
000763     12  ER-8314                 PIC X(4)  VALUE '8314'.          
000764     12  ER-8315                 PIC X(4)  VALUE '8315'.          
000765     12  ER-8316                 PIC X(4)  VALUE '8316'.          
000766     12  ER-8317                 PIC X(4)  VALUE '8317'.          
000767                                                                  
000768 01  CSO-WORK-FIELDS.                                             
000769     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.                 
000770       88  ERROR-ON-OUTPUT             VALUE 'Y'.                 
000771                                                                  
000772     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.           
000773     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.              
000774         88  CERT-NOTE-ADDED           VALUE 'Y'.                 
000775     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.              
000776         88  ORIG-NOTE-ADDED           VALUE 'Y'.                 
000777     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.        
000778                                                                  
000779     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.        
000780                                                                  
000781 01  SC-NP6-CERT-NOTE.                                            
000782     12  FILLER                  PIC X(12)                        
000783               VALUE 'REM BENEFIT '.                              
000784     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.                  
000785     12  SC-NP6-COMM             PIC X(8)                         
000786               VALUE ' + 6 MO '.                                  
000787     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.                  
000788     12  FILLER                  PIC X(12)                        
000789               VALUE ' = AMT PAID '.                              
000790     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.                  
000791                                                                  
000792 01  SC-NP6-ORIG-NOTE.                                            
000793     12  FILLER                  PIC X(63)  VALUE                 
000794         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.     
000795                                                                  
000796 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.                
000797     88  PDEF-FOUND                   VALUE 'Y'.                  
000798                                                                  
000799 01  filler.                                                      
000800     05  ws-eracct-startbr-ind   pic x  value spaces.             
000801         88  eracct-browse-started  value 'Y'.                    
000802     05  ws-lo-acct-dt           pic xx value low-values.         
000803     05  ws-hi-acct-dt           pic xx value low-values.         
000804     05  ws-acct-status          pic x value spaces.              
000805         88  acct-cancelled          value '3'.                   
000806     05  WS-I-SAY-STOP-IND       PIC X  VALUE ' '.                
000807         88  i-say-STOP            value 'S'.                     
000808                                                                  
000809 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.                
000810     88  ACCT-FOUND                   VALUE 'Y'.                  
000811                                                                  
000812 01  CTBL-KEY-SAVE               PIC X(5).                        
000813 01  CTBL-KEY.                                                    
000814     05  CTBL-COMPANY-CD         PIC X.                           
000815     05  CTBL-TABLE              PIC XXX.                         
000816     05  CTBL-BEN-TYPE           PIC X.                           
000817     05  CTBL-BEN-CODE           PIC XX.                          
000818                                                                  
000819 01  ERPDEF-KEY-SAVE             PIC X(18).                       
000820 01  ERPDEF-KEY.                                                  
000821     12  ERPDEF-COMPANY-CD       PIC X.                           
000822     12  ERPDEF-STATE            PIC XX.                          
000823     12  ERPDEF-PROD-CD          PIC XXX.                         
000824     12  F                       PIC X(7).                        
000825     12  ERPDEF-BEN-TYPE         PIC X.                           
000826     12  ERPDEF-BEN-CODE         PIC XX.                          
000827     12  ERPDEF-EXP-DT           PIC XX.                          
000828                                                                  
000829 01  ELCRTT-KEY.                                                  
000830     05  CTRLR-COMP-CD       PIC X.                               
000831     05  CTRLR-CARRIER       PIC X.                               
000832     05  CTRLR-GROUPING      PIC X(6).                            
000833     05  CTRLR-STATE         PIC X(2).                            
000834     05  CTRLR-ACCOUNT       PIC X(10).                           
000835     05  CTRLR-EFF-DT        PIC XX.                              
000836     05  CTRLR-CERT-NO       PIC X(11).                           
000837     05  CTRLR-REC-TYPE      PIC X.                               
000838                                                                  
000839 01  ACCESS-KEYS.                                                 
000840     12  ELARCH-KEY.                                              
000841         16  ARCH-CO             PIC X.                           
000842         16  ARCH-NUMBER         PIC S9(08) COMP.                 
000843         16  ARCH-REC-TYPE       PIC X.                           
000844         16  ARCH-SEQ            PIC S9(04) COMP.                 
000845     12  ELMSTR-KEY.                                              
000846         16  MSTR-COMP-CD        PIC X.                           
000847         16  MSTR-CARRIER        PIC X.                           
000848         16  MSTR-CLAIM-NO       PIC X(7).                        
000849         16  MSTR-CERT-NO        PIC X(11).                       
000850     12  ELCNTL-KEY.                                              
000851         16  CNTL-COMP-ID        PIC X(3).                        
000852         16  CNTL-REC-TYPE       PIC X.                           
000853         16  CNTL-ACCESS         PIC X(4).                        
000854         16  CNTL-SEQ-NO         PIC S9(4)    COMP.               
000855     12  ELCERT-KEY.                                              
000856         16  CERT-COMP-CD        PIC X.                           
000857         16  CERT-CARRIER        PIC X.                           
000858         16  CERT-GROUPING       PIC X(6).                        
000859         16  CERT-STATE          PIC XX.                          
000860         16  CERT-ACCOUNT        PIC X(10).                       
000861         16  CERT-EFF-DT         PIC XX.                          
000862         16  CERT-CERT-NO        PIC X(11).                       
000863     12  ELTRLR-KEY.                                              
000864         16  TRLR-COMP-CD        PIC X.                           
000865         16  TRLR-CARRIER        PIC X.                           
000866         16  TRLR-CLAIM-NO       PIC X(7).                        
000867         16  TRLR-CERT-NO        PIC X(11).                       
000868         16  TRLR-SEQ-NO         PIC S9(4)   COMP.                
000869     12  ELACTQ-KEY.                                              
000870         16  ACTQ-COMP-CD        PIC X.                           
000871         16  ACTQ-CARRIER        PIC X.                           
000872         16  ACTQ-CLAIM-NO       PIC X(7).                        
000873         16  ACTQ-CERT-NO        PIC X(11).                       
000874     12  W-NOTE-KEY.                                              
000875         16  W-NOTE-COMP-CD      PIC X.                           
000876         16  W-NOTE-CERT-KEY.                                     
000877             20  W-NOTE-CARRIER  PIC X.                           
000878             20  W-NOTE-GROUPING PIC X(6).                        
000879             20  W-NOTE-STATE    PIC XX.                          
000880             20  W-NOTE-ACCOUNT  PIC X(10).                       
000881             20  W-NOTE-EFF-DT   PIC XX.                          
000882             20  W-NOTE-CERT-NO  PIC X(11).                       
000883     12  WS-ERACCT-SAVE-KEY      PIC X(20).                       
000884     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).                     
000885     12  ERACCT-KEY.                                              
000886         16  ERACCT-PARTIAL-KEY.                                  
000887             20  ACCT-COMP-CD    PIC X.                           
000888             20  ACCT-CARRIER    PIC X.                           
000889             20  ACCT-GROUPING   PIC X(6).                        
000890             20  ACCT-STATE      PIC XX.                          
000891             20  ACCT-ACCOUNT    PIC X(10).                       
000892         16  ACCT-EXP-DT         PIC XX.                          
000893         16  FILLER              PIC X(4) VALUE SPACES.           
000894     12  ELCHKQ-KEY.                                              
000895         16  CHKQ-COMP-CD        PIC X.                           
000896         16  CHKQ-CONTROL        PIC S9(8) COMP.                  
000897         16  CHKQ-SEQ-NO         PIC S9(4) COMP.                  
000898     12  ELBENE-KEY.                                              
000899         16  BENE-COMP-CD         PIC X.                          
000900         16  BENE-RECORD-TYPE     PIC X.                          
000901         16  BENE-NUMBER          PIC X(10).                      
000902     12  ERCOMP-KEY.                                              
000903         16  COMP-COMP-CD        PIC X.                           
000904         16  COMP-CARRIER        PIC X.                           
000905         16  COMP-GROUP          PIC X(06).                       
000906         16  COMP-FIN-RESP       PIC X(10).                       
000907         16  COMP-ACCOUNT        PIC X(10).                       
000908         16  COMP-TYPE           PIC X.                           
000909                                                                  
000910     12  DLO035-KEY.                                              
000911         16  DL35-PROCESS-TYPE   PIC X.                           
000912         16  DL35-CREDIT-CARD    PIC X(20).                       
000913         16  DL35-BEN-TYPE       PIC XX.                          
000914         16  DL35-PAYMENT-AMT    PIC 9(7)V99.                     
000915         16  DL35-RETURN-CODE    PIC XX.                          
000916                                                                  
000917     EJECT                                                        
000918*    COPY ELCDATE.                                                
      *>>((file: ELCDATE))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCDATE.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000006*                            VMOD=2.003                           
000007*                                                                *
000008*                                                                *
000009*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
000010*                 LENGTH = 200                                   *
000011******************************************************************
000012                                                                  
000013 01  DATE-CONVERSION-DATA.                                        
000014     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200. 
000015     12  DC-OPTION-CODE                PIC X.                     
000016         88  BIN-TO-GREG                VALUE ' '.                
000017         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                
000018         88  EDIT-GREG-TO-BIN           VALUE '2'.                
000019         88  YMD-GREG-TO-BIN            VALUE '3'.                
000020         88  MDY-GREG-TO-BIN            VALUE '4'.                
000021         88  JULIAN-TO-BIN              VALUE '5'.                
000022         88  BIN-PLUS-ELAPSED           VALUE '6'.                
000023         88  FIND-CENTURY               VALUE '7'.                
000024         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                
000025         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                
000026         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                
000027         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                
000028         88  JULIAN-TO-BIN-3            VALUE 'C'.                
000029         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                
000030         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                
000031         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                
000032         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                
000033         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.      
000034         88  CHECK-LEAP-YEAR            VALUE 'H'.                
000035         88  BIN-3-TO-GREG              VALUE 'I'.                
000036         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                
000037         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                
000038         88  CYMD-GREG-TO-BIN           VALUE 'L'.                
000039         88  MDCY-GREG-TO-BIN           VALUE 'M'.                
000040         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                
000041         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                
000042         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                
000043         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                
000044         88  THREE-CHARACTER-BIN                                  
000045                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.    
000046         88  GREGORIAN-TO-BIN                                     
000047                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'. 
000048         88  BIN-TO-GREGORIAN                                     
000049                  VALUES ' ' '1' 'I' '8' 'G'.                     
000050         88  JULIAN-TO-BINARY                                     
000051                  VALUES '5' 'C' 'E' 'F'.                         
000052     12  DC-ERROR-CODE                 PIC X.                     
000053         88  NO-CONVERSION-ERROR        VALUE ' '.                
000054         88  DATE-CONVERSION-ERROR                                
000055                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.     
000056         88  DATE-IS-ZERO               VALUE '1'.                
000057         88  DATE-IS-NON-NUMERIC        VALUE '2'.                
000058         88  DATE-IS-INVALID            VALUE '3'.                
000059         88  DATE1-GREATER-DATE2        VALUE '4'.                
000060         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                
000061         88  DATE-INVALID-OPTION        VALUE '9'.                
000062         88  INVALID-CENTURY            VALUE 'A'.                
000063         88  ONLY-CENTURY               VALUE 'B'.                
000064         88  ONLY-LEAP-YEAR             VALUE 'C'.                
000065         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.           
000066     12  DC-END-OF-MONTH               PIC X.                     
000067         88  CALCULATE-END-OF-MONTH     VALUE '1'.                
000068     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.      
000069         88  USE-NORMAL-PROCESS         VALUE ' '.                
000070         88  ADJUST-DOWN-100-YRS        VALUE '1'.                
000071         88  ADJUST-UP-100-YRS          VALUE '2'.                
000072     12  FILLER                        PIC X.                     
000073     12  DC-CONVERSION-DATES.                                     
000074         16  DC-BIN-DATE-1             PIC XX.                    
000075         16  DC-BIN-DATE-2             PIC XX.                    
000076         16  DC-GREG-DATE-1-EDIT       PIC X(08).                 
000077         16  DC-GREG-DATE-1-EDIT-R REDEFINES                      
000078                       DC-GREG-DATE-1-EDIT.                       
000079             20  DC-EDIT1-MONTH        PIC 99.                    
000080             20  SLASH1-1              PIC X.                     
000081             20  DC-EDIT1-DAY          PIC 99.                    
000082             20  SLASH1-2              PIC X.                     
000083             20  DC-EDIT1-YEAR         PIC 99.                    
000084         16  DC-GREG-DATE-2-EDIT       PIC X(08).                 
000085         16  DC-GREG-DATE-2-EDIT-R REDEFINES                      
000086                     DC-GREG-DATE-2-EDIT.                         
000087             20  DC-EDIT2-MONTH        PIC 99.                    
000088             20  SLASH2-1              PIC X.                     
000089             20  DC-EDIT2-DAY          PIC 99.                    
000090             20  SLASH2-2              PIC X.                     
000091             20  DC-EDIT2-YEAR         PIC 99.                    
000092         16  DC-GREG-DATE-1-YMD        PIC 9(06).                 
000093         16  DC-GREG-DATE-1-YMD-R  REDEFINES                      
000094                     DC-GREG-DATE-1-YMD.                          
000095             20  DC-YMD-YEAR           PIC 99.                    
000096             20  DC-YMD-MONTH          PIC 99.                    
000097             20  DC-YMD-DAY            PIC 99.                    
000098         16  DC-GREG-DATE-1-MDY        PIC 9(06).                 
000099         16  DC-GREG-DATE-1-MDY-R REDEFINES                       
000100                      DC-GREG-DATE-1-MDY.                         
000101             20  DC-MDY-MONTH          PIC 99.                    
000102             20  DC-MDY-DAY            PIC 99.                    
000103             20  DC-MDY-YEAR           PIC 99.                    
000104         16  DC-GREG-DATE-1-ALPHA.                                
000105             20  DC-ALPHA-MONTH        PIC X(10).                 
000106             20  DC-ALPHA-DAY          PIC 99.                    
000107             20  FILLER                PIC XX.                    
000108             20  DC-ALPHA-CENTURY.                                
000109                 24 DC-ALPHA-CEN-N     PIC 99.                    
000110             20  DC-ALPHA-YEAR         PIC 99.                    
000111         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.        
000112         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.        
000113         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.        
000114         16  DC-JULIAN-DATE            PIC 9(05).                 
000115         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE             
000116                                       PIC 9(05).                 
000117         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.               
000118             20  DC-JULIAN-YEAR        PIC 99.                    
000119             20  DC-JULIAN-DAYS        PIC 999.                   
000120         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.    
000121         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3. 
000122         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3. 
000123     12  DATE-CONVERSION-VARIBLES.                                
000124         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.         
000125         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.       
000126             20  FILLER                PIC 9(3).                  
000127             20  HOLD-CEN-1-CCYY.                                 
000128                 24  HOLD-CEN-1-CC     PIC 99.                    
000129                 24  HOLD-CEN-1-YY     PIC 99.                    
000130             20  HOLD-CEN-1-MO         PIC 99.                    
000131             20  HOLD-CEN-1-DA         PIC 99.                    
000132         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.         
000133             20  HOLD-CEN-1-R-MO       PIC 99.                    
000134             20  HOLD-CEN-1-R-DA       PIC 99.                    
000135             20  HOLD-CEN-1-R-CCYY.                               
000136                 24  HOLD-CEN-1-R-CC   PIC 99.                    
000137                 24  HOLD-CEN-1-R-YY   PIC 99.                    
000138             20  FILLER                PIC 9(3).                  
000139         16  HOLD-CENTURY-1-X.                                    
000140             20  FILLER                PIC X(3)  VALUE SPACES.    
000141             20  HOLD-CEN-1-X-CCYY.                               
000142                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.       
000143                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.       
000144             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.       
000145             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.       
000146         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.       
000147             20  HOLD-CEN-1-R-X-MO     PIC XX.                    
000148             20  HOLD-CEN-1-R-X-DA     PIC XX.                    
000149             20  HOLD-CEN-1-R-X-CCYY.                             
000150                 24  HOLD-CEN-1-R-X-CC PIC XX.                    
000151                 24  HOLD-CEN-1-R-X-YY PIC XX.                    
000152             20  FILLER                PIC XXX.                   
000153         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                   
000154         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                   
000155         16  DC-JULIAN-DATE-1          PIC 9(07).                 
000156         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.       
000157             20  DC-JULIAN-1-CCYY.                                
000158                 24  DC-JULIAN-1-CC    PIC 99.                    
000159                 24  DC-JULIAN-1-YR    PIC 99.                    
000160             20  DC-JULIAN-DA-1        PIC 999.                   
000161         16  DC-JULIAN-DATE-2          PIC 9(07).                 
000162         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.       
000163             20  DC-JULIAN-2-CCYY.                                
000164                 24  DC-JULIAN-2-CC    PIC 99.                    
000165                 24  DC-JULIAN-2-YR    PIC 99.                    
000166             20  DC-JULIAN-DA-2        PIC 999.                   
000167         16  DC-GREG-DATE-A-EDIT.                                 
000168             20  DC-EDITA-MONTH        PIC 99.                    
000169             20  SLASHA-1              PIC X VALUE '/'.           
000170             20  DC-EDITA-DAY          PIC 99.                    
000171             20  SLASHA-2              PIC X VALUE '/'.           
000172             20  DC-EDITA-CCYY.                                   
000173                 24  DC-EDITA-CENT     PIC 99.                    
000174                 24  DC-EDITA-YEAR     PIC 99.                    
000175         16  DC-GREG-DATE-B-EDIT.                                 
000176             20  DC-EDITB-MONTH        PIC 99.                    
000177             20  SLASHB-1              PIC X VALUE '/'.           
000178             20  DC-EDITB-DAY          PIC 99.                    
000179             20  SLASHB-2              PIC X VALUE '/'.           
000180             20  DC-EDITB-CCYY.                                   
000181                 24  DC-EDITB-CENT     PIC 99.                    
000182                 24  DC-EDITB-YEAR     PIC 99.                    
000183         16  DC-GREG-DATE-CYMD         PIC 9(08).                 
000184         16  DC-GREG-DATE-CYMD-R REDEFINES                        
000185                              DC-GREG-DATE-CYMD.                  
000186             20  DC-CYMD-CEN           PIC 99.                    
000187             20  DC-CYMD-YEAR          PIC 99.                    
000188             20  DC-CYMD-MONTH         PIC 99.                    
000189             20  DC-CYMD-DAY           PIC 99.                    
000190         16  DC-GREG-DATE-MDCY         PIC 9(08).                 
000191         16  DC-GREG-DATE-MDCY-R REDEFINES                        
000192                              DC-GREG-DATE-MDCY.                  
000193             20  DC-MDCY-MONTH         PIC 99.                    
000194             20  DC-MDCY-DAY           PIC 99.                    
000195             20  DC-MDCY-CEN           PIC 99.                    
000196             20  DC-MDCY-YEAR          PIC 99.                    
000197    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      
000198        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        
000199    12  DC-EL310-DATE                  PIC X(21).                 
000200    12  FILLER                         PIC X(28).                 
      *<<((file: ELCDATE))
000919     EJECT                                                        
000920*    COPY ELCLOGOF.                                               
      *>>((file: ELCLOGOF))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCLOGOF.                           *
000005*                            VMOD=2.001                          *
000006*                                                                *
000007*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
000008*                                                                *
000009******************************************************************
000010 01  CLASIC-LOGOFF.                                               
000011     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.       
000012     12  LOGOFF-TEXT.                                             
000013         16  FILLER          PIC X(5)    VALUE SPACES.            
000014         16  LOGOFF-MSG.                                          
000015             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.            
000016             20  FILLER      PIC X       VALUE SPACES.            
000017             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.            
000018         16  FILLER          PIC X(80)                            
000019           VALUE '* YOU ARE NOW LOGGED OFF'.                      
000020         16  FILLER          PIC X(7)    VALUE '* LOGIC'.         
000021         16  FILLER          PIC X       VALUE QUOTE.             
000022         16  LOGOFF-SYS-MSG  PIC X(17)                            
000023           VALUE 'S CLAS-IC SYSTEM '.                             
000024     12  TEXT-MESSAGES.                                           
000025         16  UNACCESS-MSG    PIC X(29)                            
000026             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.              
000027         16  PGMIDERR-MSG    PIC X(17)                            
000028             VALUE 'PROGRAM NOT FOUND'.                           
      *<<((file: ELCLOGOF))
000921     EJECT                                                        
000922*    COPY ELCCALC.                                                
      *>>((file: ELCCALC))
000001******************************************************************
000002*                                                                *
000003*                           ELCCALC.                            * 
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000005*                            VMOD=2.025                          *
000006*                                                                *
000007*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
000008*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
000009*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
000010*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
000011*                                                                *
000012*  PASSED TO ELRTRM                                              *
000013*  -----------------                                             *
000014*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
000015*  ORIGINAL TERM                                                 *
000016*  BEGINNING DATE                                                *
000017*  ENDING DATE                                                   *
000018*  COMPANY I.D.                                                  *
000019*  ACCOUNT MASTER USER FIELD                                     *
000020*  PROCESS SWITCH (CANCEL, CLAIM)                                *
000021*  FREE LOOK DAYS                                                *
000022*                                                                *
000023*  RETURNED FROM ELRTRM                                          *
000024*  ---------------------                                         *
000025*  REMAINING TERM 1 - USED FOR EARNINGS                          *
000026*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
000027*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
000028*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
000029*----------------------------------------------------------------*
000030*  PASSED TO ELRAMT                                              *
000031*  ----------------                                              *
000032*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
000033*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
000034*  ORIGINAL AMOUNT                                               *
000035*  ALTERNATE BENEFIT (BALLON)                                    *
000036*  A.P.R. - NET PAY ONLY                                         *
000037*  METHOD                                                         
000038*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
000039*  COMPANY I.D.                                                  *
000040*  BENEFIT TYPE                                                  *
000041*                                                                *
000042*  RETURNED FROM ELRAMT                                          *
000043*  --------------------                                          *
000044*  REMAINING AMOUNT 1 - CURRENT                                  *
000045*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
000046*  REMAINING AMOUNT FACTOR                                        
000047*----------------------------------------------------------------*
000048*  PASSED TO ELRESV                                              *
000049*  -----------------                                             *
000050*  CERTIFICATE EFFECTIVE DATE                                    *
000051*  VALUATION DATE                                                *
000052*  PAID THRU DATE                                                *
000053*  BENEFIT                                                       *
000054*  INCURRED DATE                                                 *
000055*  REPORTED DATE                                                 *
000056*  ISSUE AGE                                                     *
000057*  TERM                                                          *
000058*  CDT PERCENT                                                   *
000059*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
000060* *CLAIM TYPE (LIFE, A/H)                                        *
000061* *REMAINING BENEFIT (FROM ELRAMT)                               *
000062* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
000063*                                                                *
000064*  RETURNED FROM ELRESV                                          *
000065*  --------------------                                          *
000066*  CDT TABLE USED                                                *
000067*  CDT FACTOR USED                                               *
000068*  PAY TO CURRENT RESERVE                                        *
000069*  I.B.N.R. - A/H ONLY                                           *
000070*  FUTURE (ACCRUED) AH ONLY                                      *
000071*----------------------------------------------------------------*
000072*  PASSED TO ELRATE                                              *
000073*  ----------------                                              *
000074*  CERT ISSUE DATE                                               *
000075*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
000076*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
000077*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
000078*  STATE CODE (CLIENT DEFINED)                                   *
000079*  STATE CODE (STANDARD P.O. ABBRV)                              *
000080*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
000081*  DEVIATION CODE                                                *
000082*  ISSUE AGE                                                     *
000083*  ORIGINAL BENEFIT AMOUNT                                       *
000084*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
000085*  PROCESS TYPE (ISSUE OR CANCEL)                                *
000086*  BENEFIT KIND (LIFE OR A/H)                                    *
000087*  A.P.R.                                                        *
000088*  METHOD                                                         
000089*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
000090*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
000091*  COMPANY I.D. (3 CHARACTER)                                    *
000092*  BENEFIT CODE                                                  *
000093*  BENEFIT OVERRIDE CODE                                         *
000094*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
000095*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
000096*  JOINT INDICATOR (CSL ONLY)                                    *
000097*  FIRST PAYMENT DATE (CSL ONLY)                                 *
000098*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
000099*                                                                *
000100*  RETURNED FROM ELRATE                                          *
000101*  --------------------                                          *
000102*  CALCULATED PREMIUM                                            *
000103*  PREMIUM RATE                                                  *
000104*  MORTALITY CODE                                                *
000105*  MAX ATTAINED AGE                                              *
000106*  MAX AGE                                                       *
000107*  MAX TERM                                                      *
000108*  MAX MONTHLY BENEFIT                                           *
000109*  MAX TOTAL BENIFIT                                             *
000110*  COMPOSITE RATE (OPEN-END ONLY)                                *
000111*----------------------------------------------------------------*
000112*  PASSED TO ELRFND                                              *
000113*  ----------------                                              *
000114*  CERT ISSUE DATE                                               *
000115*  REFUND DATE                                                   *
000116*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
000117*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
000118*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
000119*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
000120*  STATE CODE (CLIENT DEFINED)                                   *
000121*  STATE CODE (STANDARD P.O. ABBRV)                              *
000122*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
000123*  DEVIATION CODE                                                *
000124*  ISSUE AGE                                                     *
000125*  ORIGINAL BENEFIT AMOUNT                                       *
000126*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
000127*  PROCESS TYPE (CANCEL)                                         *
000128*  BENEFIT KIND (LIFE OR A/H)                                    *
000129*  A.P.R.                                                        *
000130*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
000131*  RATING METHOD -  (CODE FROM BENEFIT)                          *
000132*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
000133*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
000134*  COMPANY I.D. (3 CHARACTER)                                    *
000135*  BENEFIT CODE                                                  *
000136*  BENEFIT OVERRIDE CODE                                         *
000137*                                                                *
000138*  RETURNED FROM ELRFND                                          *
000139*  --------------------                                          *
000140*  CALCULATED REFUND                                             *
000141*----------------------------------------------------------------*
000142*  PASSED TO ELEARN                                              *
000143*  ----------------                                              *
000144*  CERT ISSUE DATE                                               *
000145*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
000146*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
000147*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
000148*  STATE CODE (CLIENT DEFINED)                                   *
000149*  STATE CODE (STANDARD P.O. ABBRV)                              *
000150*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
000151*  DEVIATION CODE                                                *
000152*  ISSUE AGE                                                     *
000153*  ORIGINAL BENEFIT AMOUNT                                       *
000154*  BENEFIT KIND (LIFE OR A/H)                                    *
000155*  A.P.R.                                                        *
000156*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
000157*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
000158*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
000159*  COMPANY I.D. (3 CHARACTER)                                    *
000160*  BENEFIT CODE                                                  *
000161*  BENEFIT OVERRIDE CODE                                         *
000162*                                                                *
000163*  RETURNED FROM ELEARN                                          *
000164*  --------------------                                          *
000165*  INDICATED  EARNINGS                                           *
000166*----------------------------------------------------------------*
000167*                 LENGTH = 450                                   *
000168*                                                                *
000169******************************************************************
000170******************************************************************
000171*                   C H A N G E   L O G                           
000172*                                                                 
000173* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.                
000174*-----------------------------------------------------------------
000175*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE            
000176* EFFECTIVE    NUMBER                                             
000177*-----------------------------------------------------------------
000178* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING       
000179* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION    
000180* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS        
000181* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
000182* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD            
000183* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL            
000184* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6    
000185* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING     
000186* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT            
000187* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS                
000188* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE      
000189* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.   
000190******************************************************************
000191                                                                  
000192 01  CALCULATION-PASS-AREA.                                       
000193     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450   
000194                                     COMP.                        
000195                                                                  
000196     12  CP-RETURN-CODE            PIC X             VALUE ZERO.  
000197       88  NO-CP-ERROR                             VALUE ZERO.    
000198       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8' 
000199                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
000200       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.     
000201       88  CP-ERROR-IN-DATES                       VALUE '2'.     
000202       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.     
000203       88  CP-ERROR-IN-TERMS                       VALUE '4'.     
000204       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.     
000205       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.     
000206       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.     
000207       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.     
000208       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.     
000209       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.     
000210       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.     
000211       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.     
000212       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.     
000213       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.     
000214       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.     
000215       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.     
000216       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.     
000217       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.     
000218                                                                  
000219     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.  
000220       88  NO-CP-ERROR-2                           VALUE ZERO.    
000221***********************  INPUT AREAS **************************** 
000222                                                                  
000223     12  CP-CALCULATION-AREA.                                     
000224         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.  
000225         16  CP-CERT-EFF-DT        PIC XX.                        
000226         16  CP-VALUATION-DT       PIC XX.                        
000227         16  CP-PAID-THRU-DT       PIC XX.                        
000228         16  CP-BENEFIT-TYPE       PIC X.                         
000229           88  CP-AH                               VALUE 'A' 'D'  
000230                                                   'I' 'U'.       
000231           88  CP-REDUCING-LIFE                    VALUE 'R'.     
000232           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'. 
000233         16  CP-INCURRED-DT        PIC XX.                        
000234         16  CP-REPORTED-DT        PIC XX.                        
000235         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE. 
000236         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE. 
000237         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO   
000238                                     COMP-3.                      
000239         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO   
000240                                     COMP-3.                      
000241         16  CP-CDT-METHOD         PIC X.                         
000242           88  CP-CDT-ROUND-NEAR                   VALUE '1'.     
000243           88  CP-CDT-ROUND-HIGH                   VALUE '2'.     
000244           88  CP-CDT-INTERPOLATED                 VALUE '3'.     
000245         16  CP-CLAIM-TYPE         PIC X.                         
000246           88  CP-AH-CLAIM                         VALUE 'A'.     
000247           88  CP-LIFE-CLAIM                       VALUE 'L'.     
000248         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO   
000249                                     COMP-3.                      
000250         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO   
000251                                     COMP-3.                      
000252         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO   
000253                                     COMP-3.                      
000254         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO   
000255                                     COMP-3.                      
000256         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO   
000257                                     COMP-3.                      
000258         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO   
000259                                     COMP-3.                      
000260         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO   
000261                                     COMP-3.                      
000262         16  CP-REM-TERM-METHOD    PIC X.                         
000263           88  CP-EARN-AFTER-15TH                  VALUE '1'.     
000264           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.     
000265           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.     
000266           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.     
000267           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.     
000268           88  CP-EARN-AFTER-14TH                  VALUE '6'.     
000269           88  CP-EARN-AFTER-16TH                  VALUE '7'.     
000270         16  CP-EARNING-METHOD     PIC X.                         
000271           88  CP-EARN-BY-R78                      VALUE '1' 'R'. 
000272           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'. 
000273           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'. 
000274           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'. 
000275           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'. 
000276           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'. 
000277           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'. 
000278           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'. 
000279           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.     
000280           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.     
000281           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.     
000282           88  CP-GAP-ACTUARIAL                    VALUE 'S'.     
000283           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'. 
000284           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.     
000285         16  CP-PROCESS-TYPE       PIC X.                         
000286           88  CP-CLAIM                            VALUE '1'.     
000287           88  CP-CANCEL                           VALUE '2'.     
000288           88  CP-ISSUE                            VALUE '3'.     
000289         16  CP-SPECIAL-CALC-CD    PIC X.                         
000290           88  CP-OUTSTANDING-BAL              VALUE 'O'.         
000291           88  CP-1-MTH-INTEREST               VALUE ' '.         
000292           88  CP-0-MTH-INTEREST               VALUE 'A'.         
000293           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.         
000294           88  CP-CRITICAL-PERIOD              VALUE 'C'.         
000295           88  CP-TERM-IS-DAYS                 VALUE 'D'.         
000296           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.         
000297           88  CP-FARM-PLAN                    VALUE 'F'.         
000298           88  CP-RATE-AS-STANDARD             VALUE 'G'.         
000299           88  CP-2-MTH-INTEREST               VALUE 'I'.         
000300           88  CP-3-MTH-INTEREST               VALUE 'J'.         
000301           88  CP-4-MTH-INTEREST               VALUE 'K'.         
000302           88  CP-BALLOON-LAST-PMT             VALUE 'L'.         
000303           88  CP-MORTGAGE-REC                 VALUE 'M'.         
000304           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.         
000305           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.         
000306           88  CP-NET-PAY-SIMPLE               VALUE 'S'.         
000307           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'  
000308                                                     'W' 'X'.     
000309           88  CP-TRUNCATE-0-MTH               VALUE 'T'.         
000310           88  CP-TRUNCATE-1-MTH               VALUE 'U'.         
000311           88  CP-TRUNCATE-2-MTH               VALUE 'V'.         
000312           88  CP-TRUNCATE-3-MTH               VALUE 'W'.         
000313           88  CP-TRUNCATE-4-MTH               VALUE 'X'.         
000314           88  CP-SUMMARY-REC                  VALUE 'Z'.         
000315           88  CP-PROPERTY-BENEFIT             VALUE '2'.         
000316           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.         
000317           88  CP-AD-D-BENEFIT                 VALUE '4'.         
000318           88  CP-CSL-METH-1                   VALUE '5'.         
000319           88  CP-CSL-METH-2                   VALUE '6'.         
000320           88  CP-CSL-METH-3                   VALUE '7'.         
000321           88  CP-CSL-METH-4                   VALUE '8'.         
000322                                                                  
000323         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO     
000324                                     COMP-3.                      
000325         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.    
000326         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.    
000327         16  CP-STATE              PIC XX          VALUE SPACE.   
000328         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.   
000329         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.    
000330           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'        
000331               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'. 
000332         16  CP-R78-OPTION         PIC X.                         
000333           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.     
000334           88  CP-TERM-TIMES-TERM                  VALUE '1'.     
000335                                                                  
000336         16  CP-COMPANY-CD         PIC X             VALUE SPACE. 
000337         16  CP-IBNR-RESERVE-SW    PIC X.                         
000338         16  CP-CLAIM-STATUS       PIC X.                         
000339         16  CP-RATE-FILE          PIC X.                         
000340         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO   
000341                                     COMP-3.                      
000342                                                                  
000343         16  CP-LIFE-OVERRIDE-CODE PIC X.                         
000344         16  CP-AH-OVERRIDE-CODE   PIC X.                         
000345                                                                  
000346         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO   
000347                                     COMP-3.                      
000348         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT      
000349                                   PIC S9(5)V99 COMP-3.           
000350         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO   
000351                                     COMP-3.                      
000352         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO   
000353                                     COMP-3.                      
000354         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO   
000355                                     COMP-3.                      
000356         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM  
000357                                  PIC S9(7)V99 COMP-3.            
000358                                                                  
000359         16  CP-PAID-FROM-DATE     PIC X(02).                     
000360         16  CP-CLAIM-CALC-METHOD  PIC X(01).                     
000361         16  CP-EXT-DAYS-CALC      PIC X.                         
000362           88  CP-EXT-NO-CHG                   VALUE ' '.         
000363           88  CP-EXT-CHG-LF                   VALUE '1'.         
000364           88  CP-EXT-CHG-AH                   VALUE '2'.         
000365           88  CP-EXT-CHG-LF-AH                VALUE '3'.         
000366         16  CP-DOMICILE-STATE     PIC XX.                        
000367         16  CP-CARRIER            PIC X.                         
000368         16  CP-REIN-FLAG          PIC X.                         
000369         16  CP-REM-TRM-CALC-OPTION PIC X.                        
000370           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'             
000371                      '2' '3' '4' '5'.                            
000372           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.            
000373           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.    
000374           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.    
000375           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.            
000376           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.            
000377           88  CP-EXT-30-DAY-MONTH          VALUE '3'.            
000378           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.            
000379           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.            
000380         16  CP-SIG-SWITCH         PIC X.                         
000381         16  CP-RATING-METHOD      PIC X.                         
000382           88  CP-RATE-AS-R78                      VALUE '1' 'R'. 
000383           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'. 
000384           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'. 
000385           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'. 
000386           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'. 
000387           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'. 
000388           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'. 
000389           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'. 
000390           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.     
000391         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS   
000392                                     COMP-3.                      
000393         16  CP-BEN-CATEGORY       PIC X.                         
000394         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.  
000395         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE             
000396                                   PIC S99V9(5) COMP-3.           
000397         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.  
000398         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE             
000399                                   PIC S99V9(5) COMP-3.           
000400         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.  
000401         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.              
000402         16  CP-EXPIRE-DT          PIC XX.                        
000403         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.              
000404         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.  
000405         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.  
000406         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.  
000407         16  CP-DDF-SPEC-CALC      PIC X.                         
000408             88  CP-CALC-GROSS-FEE        VALUE 'G'.              
000409             88  CP-CALC-CLP              VALUE 'C'.              
000410         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
000411         16  CP-CANCEL-REASON      PIC X.                         
000412         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.  
000413         16  CP-PMT-MODE           PIC X.                         
000414         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.      
000415         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.   
000416         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.  
000417         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.  
000418         16  FILLER                PIC X.                         
000419                                                                  
000420***************    OUTPUT FROM ELRESV   ************************  
000421                                                                  
000422         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.  
000423                                                                  
000424         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO   
000425                                     COMP-3.                      
000426         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO      
000427                                     COMP-3.                      
000428         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO      
000429                                     COMP-3.                      
000430         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO      
000431                                     COMP-3.                      
000432         16  FILLER                PIC X(09).                     
000433***************    OUTPUT FROM ELRTRM   ************************* 
000434                                                                  
000435         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO      
000436                                     COMP-3.                      
000437         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO      
000438                                     COMP-3.                      
000439         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO      
000440                                     COMP-3.                      
000441         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO      
000442                                     COMP-3.                      
000443         16  FILLER                PIC X(12).                     
000444                                                                  
000445***************    OUTPUT FROM ELRAMT   ************************* 
000446                                                                  
000447         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO      
000448                                     COMP-3.                      
000449         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO      
000450                                     COMP-3.                      
000451         16  FILLER                PIC X(12).                     
000452                                                                  
000453***************    OUTPUT FROM ELRATE   ************************* 
000454                                                                  
000455         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO      
000456                                     COMP-3.                      
000457         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO      
000458                                     COMP-3.                      
000459         16  CP-MORTALITY-CODE     PIC X(4).                      
000460         16  CP-RATE-EDIT-FLAG     PIC X.                         
000461             88  CP-RATES-NEED-APR                  VALUE '1'.    
000462         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO      
000463                                     COMP-3.                      
000464         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.  
000465         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.  
000466         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM              
000467                                   PIC S9(7)V99 COMP-3.           
000468         16  FILLER                PIC X(07).                     
000469                                                                  
000470***************    OUTPUT FROM ELRFND   ************************* 
000471                                                                  
000472         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO      
000473                                     COMP-3.                      
000474         16  CP-REFUND-TYPE-USED   PIC X.                         
000475           88  CP-R-AS-R78                         VALUE '1'.     
000476           88  CP-R-AS-PRORATA                     VALUE '2'.     
000477           88  CP-R-AS-CALIF                       VALUE '3'.     
000478           88  CP-R-AS-TEXAS                       VALUE '4'.     
000479           88  CP-R-AS-FARM-PLAN                   VALUE '4'.     
000480           88  CP-R-AS-NET-PAY                     VALUE '5'.     
000481           88  CP-R-AS-ANTICIPATION                VALUE '6'.     
000482           88  CP-R-AS-MEAN                        VALUE '8'.     
000483           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.     
000484           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.     
000485           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.     
000486           88  CP-R-AS-SPP-DDF                     VALUE 'D'.     
000487           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.     
000488           88  CP-R-AS-REPOSSESSION                VALUE 'R'.     
000489         16  FILLER                PIC X(12).                     
000490                                                                  
000491***************    OUTPUT FROM ELEARN   ************************* 
000492                                                                  
000493         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO      
000494                                     COMP-3.                      
000495         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO      
000496                                     COMP-3.                      
000497         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO      
000498                                     COMP-3.                      
000499         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO      
000500                                     COMP-3.                      
000501         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO      
000502                                     COMP-3.                      
000503         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO      
000504                                     COMP-3.                      
000505         16  CP-EARNING-TYPE-USED  PIC X.                         
000506           88  CP-E-AS-SPECIAL                     VALUE 'S'.     
000507           88  CP-E-AS-R78                         VALUE '1'.     
000508           88  CP-E-AS-PRORATA                     VALUE '2'.     
000509           88  CP-E-AS-TEXAS                       VALUE '4'.     
000510           88  CP-E-AS-FARM-PLAN                   VALUE '4'.     
000511           88  CP-E-AS-NET-PAY                     VALUE '5'.     
000512           88  CP-E-AS-ANTICIPATION                VALUE '6'.     
000513           88  CP-E-AS-MEAN                        VALUE '8'.     
000514           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.     
000515         16  FILLER                PIC X(12).                     
000516                                                                  
000517***************    OUTPUT FROM ELPMNT   ************************* 
000518                                                                  
000519         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO      
000520                                     COMP-3.                      
000521         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO      
000522                                     COMP-3.                      
000523         16  FILLER                PIC X(12).                     
000524                                                                  
000525***************   MISC WORK AREAS    *****************************
000526         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO      
000527                                     COMP-3.                      
000528         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO      
000529                                     COMP-3.                      
000530         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO      
000531                                     COMP-3.                      
000532         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO      
000533                                     COMP-3.                      
000534         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO      
000535                                     COMP-3.                      
000536         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO      
000537                                     COMP-3.                      
000538         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.    
000539             88  OPEN-RATE-FILE                   VALUE 'O'.      
000540             88  CLOSE-RATE-FILE                  VALUE 'C'.      
000541             88  IO-ERROR                         VALUE 'E'.      
000542                                                                  
000543         16  CP-FIRST-PAY-DATE     PIC XX.                        
000544                                                                  
000545         16  CP-JOINT-INDICATOR    PIC X.                         
000546                                                                  
000547         16  CP-RESERVE-REMAINING-TERM                            
000548                                   PIC S9(4)V9    VALUE ZERO      
000549                                     COMP-3.                      
000550                                                                  
000551         16  CP-INSURED-BIRTH-DT   PIC XX.                        
000552                                                                  
000553         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO      
000554                                     COMP-3.                      
000555                                                                  
000556         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO      
000557                                     COMP-3.                      
000558                                                                  
000559         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO      
000560                                     COMP-3.                      
000561                                                                  
000562         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO      
000563                                     COMP-3.                      
000564                                                                  
000565         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO      
000566                                     COMP-3.                      
000567                                                                  
000568         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS     
000569                                     COMP-3.                      
000570                                                                  
000571         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO      
000572                                     COMP-3.                      
000573                                                                  
000574         16  CP-ROA-REFUND         PIC X          VALUE 'N'.      
000575             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.      
000576                                                                  
000577         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO      
000578                                     COMP-3.                      
000579         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO      
000580                                     COMP-3.                      
000581         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.  
000582         16  cp-extra-periods      pic 9 value zeros.             
000583         16  cp-net-only-state     pic x value spaces.            
000584         16  FILLER                PIC X(13).                     
000585******************************************************************
      *<<((file: ELCCALC))
000923*    COPY ELCICALC.                                               
      *>>((file: ELCICALC))
000001******************************************************************
000002*                                                                *
000003*                           ELCCICALC.                           *
000004*                            VMOD=2.001                          *
000005*                                                                *
000006*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
000007*                 CALCULATION MODULE                             *
000008*                                                                *
000009*  PASSED TO ELCLMI                                              *
000010*  -----------------                                             *
000011*  STATE                                                         *
000012*  PRODUCT                                                       *
000013*  COVERAGE                                                      *
000014*  EFFECTIVE DATE                                                *
000015*  INCURRED DATE                                                 *
000016*  ESTABLISHED DATE                                              *
000017*  LAST PAID DATE                                                *
000018*  REPORTED DATE                                                 *
000019*  CLAIM PAYMENT AMOUNT                                          *
000020*                                                                *
000021*  RETURNED FROM ELRTRM                                          *
000022*  ---------------------                                         *
000023*  RETURN CODE                                                   *
000024*  CLAIM INTEREST DUE SWITCH Y/N                                 *
000025*  CLAIM INTEREST AMOUNT                                         *
000026*----------------------------------------------------------------*
000027*----------------------------------------------------------------*
000028*                 LENGTH = 100                                   *
000029*                                                                *
000030******************************************************************
000031******************************************************************
000032*                   C H A N G E   L O G                           
000033*                                                                 
000034* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.                
000035*-----------------------------------------------------------------
000036*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE            
000037* EFFECTIVE    NUMBER                                             
000038*-----------------------------------------------------------------
000039* 120905    2004040700004  PEMA  NEW COPYBOOK                     
000040* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA   
000041******************************************************************
000042                                                                  
000043 01  CLAIM-INT-PASS-AREA.                                         
000044     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100   
000045                                     COMP.                        
000046                                                                  
000047     12  CI-RETURN-CODE            PIC X             VALUE ZERO.  
000048       88  NO-CI-ERROR                             VALUE ZERO.    
000049       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
000050       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.     
000051       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.     
000052       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.     
000053       88  CP-AMT-LT-5000                          VALUE '4'.     
000054       88  CP-ERROR-IN-DATES                       VALUE '5'.     
000055       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.     
000056       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.     
000057       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.     
000058***********************  INPUT AREAS **************************** 
000059                                                                  
000060     12  CP-CALCULATION-AREA.                                     
000061         16  CP-COMPANY-CD         PIC X.                         
000062         16  CP-STATE              PIC XX.                        
000063         16  CP-PRODUCT            PIC XX.                        
000064         16  CP-COVERAGE           PIC XX.                        
000065         16  CP-INC-DT             PIC XX.                        
000066         16  CP-EST-DT             PIC XX.                        
000067         16  CP-LSTPD-DT           PIC XX.                        
000068         16  CP-RPT-DT             PIC XX.                        
000069         16  CP-PRF-DT             PIC XX.                        
000070         16  CP-EFF-DT             PIC XX.                        
000071         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.           
000072         16  CP-INT-RATE           PIC S99V9(5) COMP-3.           
000073         16  FILLER                PIC X(37).                     
000074                                                                  
000075***************    OUTPUT FROM ELCLMI   ************************  
000076                                                                  
000077         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.    
000078                                                                  
000079         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3. 
000080         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3. 
000081         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3. 
000082         16  FILLER                PIC X(19).                     
000083******************************************************************
      *<<((file: ELCICALC))
000924     EJECT                                                        
000925*    COPY ELCATTR.                                                
      *>>((file: ELCATTR))
000001******************************************************************
000002*                                                                *
000003*                            ELCATTR.                            *
000004*                            VMOD=2.001                          *
000005*                                                                *
000006*             LIST OF STANDARD ATTRIBUTE VALUES                  *
000007*                                                                *
000008*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
000009*                                                                *
000010*                   POS 1   P=PROTECTED                          *
000011*                           U=UNPROTECTED                        *
000012*                           S=ASKIP                              *
000013*                   POS 2   A=ALPHA/NUMERIC                      *
000014*                           N=NUMERIC                            *
000015*                   POS 3   N=NORMAL                             *
000016*                           B=BRIGHT                             *
000017*                           D=DARK                               *
000018*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
000019*                           OF=MODIFIED DATA TAG OFF             *
000020*                                                                *
000021*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
000022******************************************************************
000023 01  ATTRIBUTE-LIST.                                              
000024     12  AL-PABOF            PIC X       VALUE 'Y'.               
000025     12  AL-PABON            PIC X       VALUE 'Z'.               
000026     12  AL-PADOF            PIC X       VALUE '%'.               
000027     12  AL-PADON            PIC X       VALUE '_'.               
000028     12  AL-PANOF            PIC X       VALUE '-'.               
000029     12  AL-PANON            PIC X       VALUE '/'.               
000030     12  AL-SABOF            PIC X       VALUE '8'.               
000031     12  AL-SABON            PIC X       VALUE '9'.               
000032     12  AL-SADOF            PIC X       VALUE '@'.               
000033     12  AL-SADON            PIC X       VALUE QUOTE.             
000034     12  AL-SANOF            PIC X       VALUE '0'.               
000035     12  AL-SANON            PIC X       VALUE '1'.               
000036     12  AL-UABOF            PIC X       VALUE 'H'.               
000037     12  AL-UABON            PIC X       VALUE 'I'.               
000038     12  AL-UADOF            PIC X       VALUE '<'.               
000039     12  AL-UADON            PIC X       VALUE '('.               
000040     12  AL-UANOF            PIC X       VALUE ' '.               
000041     12  AL-UANON            PIC X       VALUE 'A'.               
000042     12  AL-UNBOF            PIC X       VALUE 'Q'.               
000043     12  AL-UNBON            PIC X       VALUE 'R'.               
000044     12  AL-UNDOF            PIC X       VALUE '*'.               
000045     12  AL-UNDON            PIC X       VALUE ')'.               
000046     12  AL-UNNOF            PIC X       VALUE '&'.               
000047     12  AL-UNNON            PIC X       VALUE 'J'.               
      *<<((file: ELCATTR))
000926     EJECT                                                        
000927*    COPY ELCEMIB.                                                
      *>>((file: ELCEMIB))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCEMIB.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000006*                            VMOD=2.005                          *
000007*                                                                *
000008*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
000009*                                                                *
000010******************************************************************
000011 01  ERROR-MESSAGE-INTERFACE-BLOCK.                               
000012     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.    
000013     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.            
000014     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.        
000015     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.     
000016     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.     
000017     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.     
000018     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.     
000019     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.     
000020     12  EMI-SWITCH1             PIC X        VALUE '1'.          
000021         88  EMI-NO-ERRORS                    VALUE '1'.          
000022         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.          
000023         88  EMI-ERRORS-COMPLETE              VALUE '3'.          
000024     12  EMI-SWITCH2             PIC X        VALUE '1'.          
000025         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.          
000026     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.          
000027         88  EMI-AREA1-EMPTY                  VALUE '1'.          
000028         88  EMI-AREA1-FULL                   VALUE '2'.          
000029     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.          
000030         88  EMI-AREA2-EMPTY                  VALUE '1'.          
000031         88  EMI-AREA2-FULL                   VALUE '2'.          
000032     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.          
000033         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.          
000034         88  EMI-BYPASS-NOTES                 VALUE 'N'.          
000035         88  EMI-BYPASS-WARNINGS              VALUE 'W'.          
000036         88  EMI-BYPASS-FORCABLES             VALUE 'F'.          
000037         88  EMI-BYPASS-FATALS                VALUE 'X'.          
000038     12  EMI-ERROR-LINES.                                         
000039         16  EMI-LINE1           PIC X(72)   VALUE SPACES.        
000040         16  EMI-LINE2           PIC X(72)   VALUE SPACES.        
000041         16  EMI-LINE3           PIC X(72)   VALUE SPACES.        
000042         16  EMI-CODE-LINE REDEFINES EMI-LINE3.                   
000043             20  EMI-ERR-CODES OCCURS 10 TIMES.                   
000044                 24  EMI-ERR-NUM         PIC X(4).                
000045                 24  EMI-FILLER          PIC X.                   
000046                 24  EMI-SEV             PIC X.                   
000047                 24  FILLER              PIC X.                   
000048             20  FILLER                  PIC X(02).               
000049     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.                 
000050         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX. 
000051             20  EMI-ERROR-NUMBER    PIC X(4).                    
000052             20  EMI-FILL            PIC X.                       
000053             20  EMI-SEVERITY        PIC X.                       
000054             20  FILLER              PIC X.                       
000055             20  EMI-ERROR-TEXT.                                  
000056                 24  EMI-TEXT-VARIABLE   PIC X(10).               
000057                 24  FILLER          PIC X(55).                   
000058     12  EMI-SEVERITY-SAVE           PIC X.                       
000059         88  EMI-NOTE                    VALUE 'N'.               
000060         88  EMI-WARNING                 VALUE 'W'.               
000061         88  EMI-FORCABLE                VALUE 'F'.               
000062         88  EMI-FATAL                   VALUE 'X'.               
000063     12  EMI-MESSAGE-FLAG            PIC X.                       
000064         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.               
000065         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.               
000066     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.    
000067     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.    
000068         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.       
000069         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.       
000070         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.       
000071     12  emi-claim-no                pic x(7).                    
000072     12  emi-claim-type              pic x(6).                    
000073     12  FILLER                      PIC X(124)  VALUE SPACES.    
000074     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.    
000075     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.    
000076     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).                    
000077     12  EMI-AH-OVERRIDE-L6          PIC X(6).                    
      *<<((file: ELCEMIB))
000928     EJECT                                                        
000929*    COPY ELCLNKLT.                                               
      *>>((file: ELCLNKLT))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                           ELCLNKLT                             *
000005*                            VMOD=2.003                          *
000006*                                                                *
000007*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
000008*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
000009*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
000010*                                                                *
000011*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
000012*   COMPLETING THE REQUIRED FIELDS.                              *
000013*                                                                *
000014*   THE CALLING PROGRAM SHOULD CHECK:                            *
000015*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
000016*                              9999 INDICATES AN UNKNOWN ABEND   *
000017*                                   WAS DETECTED.                *
000018*                              ALL OTHER VALUES ARE NORMAL ERROR *
000019*                              CODES FOUND IN THE ERROR FILE.    *
000020******************************************************************
000021 01  W-1523-LINKDATA.                                             
000022     12  W-1523-COMMON-PI-DATA.                                   
000023         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.   
000024         16  FILLER              PIC  X(67).                      
000025         16  W-1523-COMPANY-CD   PIC  X(01).                      
000026         16  FILLER              PIC  X(10).                      
000027         16  W-1523-CONTROL-IN-PROGRESS.                          
000028             20  W-1523-CARRIER  PIC  X(01).                      
000029             20  W-1523-GROUPING PIC  X(06).                      
000030             20  W-1523-STATE    PIC  X(02).                      
000031             20  W-1523-ACCOUNT  PIC  X(10).                      
000032             20  W-1523-CLAIM-CERT-GRP.                           
000033                 24  W-1523-CLAIM-NO                              
000034                                 PIC  X(07).                      
000035                 24  W-1523-CERT-NO.                              
000036                     28  W-1523-CERT-PRIME                        
000037                                 PIC  X(10).                      
000038                     28  W-1523-CERT-SFX                          
000039                                 PIC  X(01).                      
000040                 24  W-1523-CERT-EFF-DT                           
000041                                 PIC  X(02).                      
000042         16  FILLER              PIC X(265).                      
000043                                                                  
000044     12  W-1523-WORK-AREA.                                        
000045         16  W-1523-FORM-NUMBER  PIC  X(04).                      
000046         16  W-1523-NUMBER-COPIES                                 
000047                                 PIC  9(01).                      
000048         16  W-1523-ADDR-TYPE    PIC  X(02).                      
000049         16  W-1523-FOLLOW-UP-DATE                                
000050                                 PIC  X(02).                      
000051         16  W-1523-RESEND-DATE  PIC  X(02).                      
000052         16  W-1523-ERROR-CODE   PIC  9(04).                      
000053             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.            
000054             88  W-1523-FATAL-ERROR                               
000055                                    VALUES  0006 0013 0042        
000056                                            0154 0168 0169        
000057                                            0176 9999 0172        
000058                                            0179 0186 0281        
000059                                            0332 2055 3697        
000060                                            3698 3699 3770        
000061                                            3771 3772 7675        
000062                                            9106 9808 9883        
000063                                            9887.                 
000064             88  W-1523-STOP-ERRORS                               
000065                                    VALUES  0013 0042 0154        
000066                                            0168 0169 0172        
000067                                            0281 0332 2055        
000068                                            3698 3699 7675        
000069                                            9106 9808 9883        
000070                                            9999.                 
000071         16  W-1523-REASON       PIC  X(70).                      
000072         16  W-1523-ARCHIVE-NUMBER                                
000073                                 PIC  9(08).                      
000074     12  W-1523-POINTER-AREA.                                     
000075         16  W-1523-ACCT-POINTER PIC S9(08) COMP.                 
000076         16  W-1523-ACTY-POINTER PIC S9(08) COMP.                 
000077         16  W-1523-ARCH-POINTER PIC S9(08) COMP.                 
000078         16  W-1523-VAR-POINTER  PIC S9(08) COMP.                 
000079         16  W-1523-PROD-POINTER PIC S9(08) COMP.                 
      *<<((file: ELCLNKLT))
000930     EJECT                                                        
000931*    COPY ELCNWA.                                                 
      *>>((file: ELCNWA))
000001***************************************************************** 
000002*                                                               * 
000003*                                                               * 
000004*                            ELCNWA.                            * 
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000006*                            VMOD=2.003                         * 
000007*                                                               * 
000008*            M O V E   N A M E   W O R K   A R E A.             * 
000009*                                                               * 
000010*****************************************************************.
000011                                                                  
000012 01  WS-NAME-WORK-AREA.                                           
000013     05  WS-INSURED-LAST-NAME        PIC X(15).                   
000014     05  WS-INSURED-1ST-NAME         PIC X(12).                   
000015     05  WS-INSURED-MID-INIT         PIC X.                       
000016                                                                  
000017     05  WS-NAME-WORK.                                            
000018         10  WS-NW                   PIC X                        
000019             OCCURS 30 TIMES INDEXED BY NWA-INDEX.                
000020                                                                  
000021     05  WS-NAME-WORK2.                                           
000022         10  WS-NW2                  PIC X                        
000023             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3     
000024                                        NWA-INDEX0.               
000025                                                                  
000026     05  WS-NAME-SW                  PIC S9          VALUE ZERO   
000027                                     COMP-3.                      
000028                                                                  
      *<<((file: ELCNWA))
000932     EJECT                                                        
000933*    COPY ELCDMO.                                                 
      *>>((file: ELCDMO))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCDMO.                             *
000005*                            VMOD=2.004                          *
000006*                                                                *
000007*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
000008*        COMMUNICATION AREA                                      *
000009*   FILE TYPE = NA                                               *
000010*   RECORD SIZE = 110    RECFORM = FIXED                         *
000011*                                                                *
000012******************************************************************
000013 01  DMO-COMMUNICATION-AREA.                                      
000014     12  DM-RECORD-TYPE                  PIC  X(02).              
000015             88  DM-ISSUE-TRAN                VALUE 'CC'.         
000016             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.         
000017             88  DM-CLAIM-PAYMENT             VALUE 'DR'.         
000018     12  DM-DIST-CODE                    PIC  X(04).              
000019     12  DM-MAIL-CODE                    PIC  X(05).              
000020     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).              
000021     12  DM-INSURED-NAME                 PIC  X(30).              
000022     12  DM-CLAIM-NO                     PIC  X(07).              
000023     12  DM-CLAIM-TYPE                   PIC  X.                  
000024                                                                  
000025     12  DM-STATUS-DATA-AREA.                                     
000026         16  DM-CLAIM-STATUS             PIC  X.                  
000027             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.      
000028             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.      
000029             88  DM-CLOSED                        VALUE '3'.      
000030             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.      
000031             88  DM-DEFAULT                       VALUE '9'.      
000032         16  DM-STATUS-DATE              PIC  X(08).              
000033******YYYYMMDD                                                    
000034         16  DM-STAT-CHANGE-TYPE         PIC  X.                  
000035             88  DM-MANUAL-CLOSE                  VALUE 'C'.      
000036             88  DM-CLAIM-DENIED                  VALUE 'D'.      
000037             88  DM-FINAL-PAYMENT                 VALUE 'F'.      
000038             88  DM-INITIAL-PAYMENT               VALUE 'I'.      
000039             88  DM-AUTO-CLOSE                    VALUE 'Q'.      
000040             88  DM-RE-OPENED                     VALUE 'R'.      
000041             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.      
000042             88  DM-VOIDED-PAYMENT                VALUE 'V'.      
000043             88  DM-CLAIM-DELETED                 VALUE 'X'.      
000044         16  DM-STAT-CARRIER             PIC X.                   
000045                                                                  
000046     12  DM-DRAFT-DATA-AREA.                                      
000047         16  DM-PAYMENT-TYPE             PIC  X.                  
000048             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.     
000049         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).        
000050         16  DM-PAYMENT-DATE             PIC  X(08).              
000051******YYYYMMDD                                                    
000052         16  DM-CERT-NO                  PIC  X(11).              
000053         16  DM-TRLR-SEQ-NO              PIC  9(04).              
000054         16  DM-CARRIER                  PIC  X.                  
000055                                                                  
000056     12  DM-RETURN-CODE                  PIC  XX.                 
      *<<((file: ELCDMO))
000934     EJECT                                                        
000935*    COPY ELCDMDCD.                                               
      *>>((file: ELCDMDCD))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCDMDCD.                           *
000005*                            VMOD=2.001                          *
000006*                                                                *
000007*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
000008*       COMMUNICATIONS AREA                                      *
000009*                                                                *
000010******************************************************************
000011 01  CD-COMMUNICATION-AREA.                                       
000012     12  CD-SYSTEM-ID            PIC  X(02).                      
000013         88 CD-CLAIMS                      VALUE 'CL'.            
000014         88 CD-CREDIT                      VALUE 'CR'.            
000015     12  CD-RECORD-TYPE          PIC  X(02).                      
000016         88 CD-DENIAL-CODE                 VALUE 'DN'.            
000017         88 CD-EOB-CODE                    VALUE 'EO'.            
000018         88 CD-ICD9-CODE                   VALUE 'I9'.            
000019         88 CD-OCCUPATION-CODE             VALUE 'OC'.            
000020         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.            
000021         88 CD-CAUSE-CODE                  VALUE 'CS'.            
000022         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.            
000023         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.            
000024     12  CD-RECORD-KEY           PIC  X(06).                      
000025         88 CD-SUCCESSFUL                  VALUE 'OK'.            
000026     12  CD-RETURN-CODE          PIC  X(02).                      
000027     12  CD-CODE-DESCRIPTION     PIC  X(60).                      
000028     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).                      
000029     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).                      
000030     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).                      
      *<<((file: ELCDMDCD))
000936     EJECT                                                        
000937*    COPY ELCDCTB.                                                
      *>>((file: ELCDCTB))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCDCTB.                            *
000005*                            VMOD=2.002                          *
000006*                                                                *
000007*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
000008*       COMMUNICATIONS AREA                                      *
000009*                                                                *
000010******************************************************************
000011 01  DCT-COMMUNICATION-AREA.                                      
000012     12  DCT-BILLING-BANK-ID      PIC  X(05).                     
000013     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).                     
000014     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).                     
000015     12  DCT-PRODUCT-CODE         PIC  X(02).                     
000016     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).                     
000017     12  DCT-RETURN-CODE          PIC  X(02).                     
000018     12  DCT-MAIL-CODE            PIC  X(05).                     
000019     12  DCT-DISTRIBUTION-CODE    PIC  X(04).                     
000020     12  DCT-MSA-ACCT-NO          PIC  X(07).                     
      *<<((file: ELCDCTB))
000938     EJECT                                                        
000939 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.  
000940 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.   
000941 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.  
000942 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.   
000943                                 EJECT                            
000944*    COPY ELCINTF.                                                
      *>>((file: ELCINTF))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCINTF.                            *
000005*                            VMOD=2.017                          *
000006*                                                                *
000007*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
000008*                                                                *
000009*       LENGTH = 1024                                            *
000010*                                                                *
000011******************************************************************
000012*                   C H A N G E   L O G                           
000013*                                                                 
000014* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.                
000015*-----------------------------------------------------------------
000016*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE            
000017* EFFECTIVE    NUMBER                                             
000018*-----------------------------------------------------------------
000019* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY     
000020******************************************************************
000021 01  PROGRAM-INTERFACE-BLOCK.                                     
000022     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
000023     12  PI-CALLING-PROGRAM              PIC X(8).                
000024     12  PI-SAVED-PROGRAM-1              PIC X(8).                
000025     12  PI-SAVED-PROGRAM-2              PIC X(8).                
000026     12  PI-SAVED-PROGRAM-3              PIC X(8).                
000027     12  PI-SAVED-PROGRAM-4              PIC X(8).                
000028     12  PI-SAVED-PROGRAM-5              PIC X(8).                
000029     12  PI-SAVED-PROGRAM-6              PIC X(8).                
000030     12  PI-RETURN-TO-PROGRAM            PIC X(8).                
000031     12  PI-COMPANY-ID                   PIC XXX.                 
000032     12  PI-COMPANY-CD                   PIC X.                   
000033                                                                  
000034     12  PI-COMPANY-PASSWORD             PIC X(8).                
000035                                                                  
000036     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.          
000037                                                                  
000038     12  PI-CONTROL-IN-PROGRESS.                                  
000039         16  PI-CARRIER                  PIC X.                   
000040         16  PI-GROUPING                 PIC X(6).                
000041         16  PI-STATE                    PIC XX.                  
000042         16  PI-ACCOUNT                  PIC X(10).               
000043         16  PI-PRODUCER REDEFINES PI-ACCOUNT                     
000044                                         PIC X(10).               
000045         16  PI-CLAIM-CERT-GRP.                                   
000046             20  PI-CLAIM-NO             PIC X(7).                
000047             20  PI-CERT-NO.                                      
000048                 25  PI-CERT-PRIME       PIC X(10).               
000049                 25  PI-CERT-SFX         PIC X.                   
000050             20  PI-CERT-EFF-DT          PIC XX.                  
000051         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.            
000052             20  PI-PLAN-CODE            PIC X(2).                
000053             20  PI-REVISION-NUMBER      PIC X(3).                
000054             20  PI-PLAN-EFF-DT          PIC X(2).                
000055             20  PI-PLAN-EXP-DT          PIC X(2).                
000056             20  FILLER                  PIC X(11).               
000057         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.       
000058             20  PI-OE-REFERENCE-1.                               
000059                 25  PI-OE-REF-1-PRIME   PIC X(18).               
000060                 25  PI-OE-REF-1-SUFF    PIC XX.                  
000061                                                                  
000062     12  PI-SESSION-IN-PROGRESS          PIC X.                   
000063         88  CLAIM-SESSION                   VALUE '1'.           
000064         88  CREDIT-SESSION                  VALUE '2'.           
000065         88  WARRANTY-SESSION                VALUE '3'.           
000066         88  MORTGAGE-SESSION                VALUE '4'.           
000067         88  GENERAL-LEDGER-SESSION          VALUE '5'.           
000068                                                                  
000069                                                                  
000070*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
000071                                                                  
000072     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).                
000073     12  PI-ORIGINAL-COMPANY-CD          PIC X.                   
000074                                                                  
000075     12  PI-CREDIT-USER                  PIC X.                   
000076         88  PI-NOT-CREDIT-USER              VALUE 'N'.           
000077         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.           
000078                                                                  
000079     12  PI-CLAIM-USER                   PIC X.                   
000080         88  PI-NOT-CLAIM-USER               VALUE 'N'.           
000081         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.           
000082                                                                  
000083     12  PI-PROCESSOR-SYS-ACCESS         PIC X.                   
000084         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.           
000085         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.           
000086         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.           
000087         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.           
000088         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.           
000089                                                                  
000090     12  PI-PROCESSOR-ID                 PIC X(4).                
000091                                                                  
000092     12  PI-PROCESSOR-PASSWORD           PIC X(11).               
000093                                                                  
000094     12  PI-MEMBER-CAPTION               PIC X(10).               
000095                                                                  
000096     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.                   
000097         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.           
000098                                                                  
000099     12  PI-LIFE-OVERRIDE-L1             PIC X.                   
000100     12  PI-LIFE-OVERRIDE-L2             PIC XX.                  
000101     12  PI-LIFE-OVERRIDE-L6             PIC X(6).                
000102     12  PI-LIFE-OVERRIDE-L12            PIC X(12).               
000103                                                                  
000104     12  PI-AH-OVERRIDE-L1               PIC X.                   
000105     12  PI-AH-OVERRIDE-L2               PIC XX.                  
000106     12  PI-AH-OVERRIDE-L6               PIC X(6).                
000107     12  PI-AH-OVERRIDE-L12              PIC X(12).               
000108                                                                  
000109     12  PI-NEW-SYSTEM                   PIC X(2).                
000110                                                                  
000111     12  PI-PRIMARY-CERT-NO              PIC X(11).               
000112     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).               
000113         88  PI-USES-PAID-TO                 VALUE '1'.           
000114     12  PI-CRDTCRD-SYSTEM.                                       
000115         16  PI-CRDTCRD-USER             PIC X.                   
000116             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.           
000117             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.           
000118         16  PI-CC-MONTH-END-DT          PIC XX.                  
000119     12  PI-PROCESSOR-PRINTER            PIC X(4).                
000120                                                                  
000121     12  PI-OE-REFERENCE-2.                                       
000122         16  PI-OE-REF-2-PRIME           PIC X(10).               
000123         16  PI-OE-REF-2-SUFF            PIC X.                   
000124                                                                  
000125     12  PI-REM-TRM-CALC-OPTION          PIC X.                   
000126                                                                  
000127     12  PI-LANGUAGE-TYPE                PIC X.                   
000128             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.           
000129             88  PI-LANGUAGE-IS-FR           VALUE 'F'.           
000130             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.           
000131                                                                  
000132     12  PI-POLICY-LINKAGE-IND           PIC X.                   
000133         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.           
000134         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'            
000135                                                   LOW-VALUES.    
000136                                                                  
000137     12  PI-ALT-DMD-PRT-ID               PIC X(4).                
000138     12  PI-CLAIM-PW-SESSION             PIC X(1).                
000139         88  PI-CLAIM-CREDIT                 VALUE '1'.           
000140         88  PI-CLAIM-CONVEN                 VALUE '2'.           
000141                                                                  
000142     12  PI-PROCESSOR-CSR-IND            PIC X.                   
000143         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.       
000144         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.           
000145                                                                  
000146     12  FILLER                          PIC X(3).                
000147                                                                  
000148     12  PI-SYSTEM-LEVEL                 PIC X(145).              
000149                                                                  
000150     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES                
000151         PI-SYSTEM-LEVEL.                                         
000152                                                                  
000153         16  PI-ENTRY-CODES.                                      
000154             20  PI-ENTRY-CD-1           PIC X.                   
000155             20  PI-ENTRY-CD-2           PIC X.                   
000156                                                                  
000157         16  PI-RETURN-CODES.                                     
000158             20  PI-RETURN-CD-1          PIC X.                   
000159             20  PI-RETURN-CD-2          PIC X.                   
000160                                                                  
000161         16  PI-UPDATE-STATUS-SAVE.                               
000162             20  PI-UPDATE-BY            PIC X(4).                
000163             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.    
000164                                                                  
000165         16  PI-LOWER-CASE-LETTERS       PIC X.                   
000166             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.           
000167                                                                  
000168*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.                   
000169*            88  CLAIM-NO-UNIQUE             VALUE '1'.           
000170*            88  CARRIER-CLM-CNTL            VALUE '2'.           
000171                                                                  
000172         16  PI-CERT-ACCESS-CONTROL      PIC X.                   
000173             88  ST-ACCNT-CNTL               VALUE ' '.           
000174             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.           
000175             88  CARR-ST-ACCNT-CNTL          VALUE '2'.           
000176             88  ACCNT-CNTL                  VALUE '3'.           
000177             88  CARR-ACCNT-CNTL             VALUE '4'.           
000178                                                                  
000179         16  PI-PROCESSOR-CAP-LIST.                               
000180             20  PI-SYSTEM-CONTROLS.                              
000181                24 PI-SYSTEM-DISPLAY     PIC X.                   
000182                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.           
000183                24 PI-SYSTEM-MODIFY      PIC X.                   
000184                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.           
000185             20  FILLER                  PIC XX.                  
000186             20  PI-DISPLAY-CAP          PIC X.                   
000187                 88  DISPLAY-CAP             VALUE 'Y'.           
000188             20  PI-MODIFY-CAP           PIC X.                   
000189                 88  MODIFY-CAP              VALUE 'Y'.           
000190             20  PI-MSG-AT-LOGON-CAP     PIC X.                   
000191                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.           
000192             20  PI-FORCE-CAP            PIC X.                   
000193                 88  FORCE-CAP               VALUE 'Y'.           
000194                                                                  
000195         16  PI-PROGRAM-CONTROLS.                                 
000196             20  PI-PGM-PRINT-OPT        PIC X.                   
000197             20  PI-PGM-FORMAT-OPT       PIC X.                   
000198             20  PI-PGM-PROCESS-OPT      PIC X.                   
000199             20  PI-PGM-TOTALS-OPT       PIC X.                   
000200                                                                  
000201         16  PI-HELP-INTERFACE.                                   
000202             20  PI-LAST-ERROR-NO        PIC X(4).                
000203             20  PI-CURRENT-SCREEN-NO    PIC X(4).                
000204                                                                  
000205         16  PI-CARRIER-CONTROL-LEVEL    PIC X.                   
000206             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.         
000207                                                                  
000208         16  PI-CR-CONTROL-IN-PROGRESS.                           
000209             20  PI-CR-CARRIER           PIC X.                   
000210             20  PI-CR-GROUPING          PIC X(6).                
000211             20  PI-CR-STATE             PIC XX.                  
000212             20  PI-CR-ACCOUNT           PIC X(10).               
000213             20  PI-CR-FIN-RESP          PIC X(10).               
000214             20  PI-CR-TYPE              PIC X.                   
000215                                                                  
000216         16  PI-CR-BATCH-NUMBER          PIC X(6).                
000217                                                                  
000218         16  PI-CR-MONTH-END-DT          PIC XX.                  
000219                                                                  
000220         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.                   
000221             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.           
000222             88  PI-ZERO-CARRIER             VALUE '1'.           
000223             88  PI-ZERO-GROUPING            VALUE '2'.           
000224             88  PI-ZERO-CAR-GROUP           VALUE '3'.           
000225                                                                  
000226         16  PI-CARRIER-SECURITY         PIC X.                   
000227             88  PI-NO-CARRIER-SECURITY      VALUE ' '.           
000228                                                                  
000229         16  PI-ACCOUNT-SECURITY         PIC X(10).               
000230             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.        
000231             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.        
000232                                                                  
000233         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.      
000234             20  PI-ACCESS-CODE          OCCURS 10 TIMES          
000235                                         INDEXED BY PI-ACCESS-NDX 
000236                                         PIC X.                   
000237                                                                  
000238         16  PI-GA-BILLING-CONTROL       PIC X.                   
000239             88  PI-GA-BILLING               VALUE '1'.           
000240                                                                  
000241         16  PI-MAIL-PROCESSING          PIC X.                   
000242             88  PI-MAIL-YES                 VALUE 'Y'.           
000243                                                                  
000244         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).                
000245                                                                  
000246         16  PI-AR-SYSTEM.                                        
000247             20  PI-AR-PROCESSING-CNTL   PIC X.                   
000248                 88  PI-AR-PROCESSING        VALUE 'Y'.           
000249             20  PI-AR-SUMMARY-CODE      PIC X(6).                
000250             20  PI-AR-MONTH-END-DT      PIC XX.                  
000251                                                                  
000252         16  PI-MP-SYSTEM.                                        
000253             20  PI-MORTGAGE-USER            PIC X.               
000254                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.   
000255                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.   
000256             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.               
000257                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.   
000258                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.   
000259                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.   
000260                 88  PI-MP-PROD-CNTL                 VALUE '3'.   
000261                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.   
000262             20  PI-MP-MONTH-END-DT          PIC XX.              
000263             20  PI-MP-REFERENCE-NO.                              
000264                 24  PI-MP-REFERENCE-PRIME   PIC X(18).           
000265                 24  PI-MP-REFERENCE-SFX     PIC XX.              
000266                                                                  
000267         16  PI-LABEL-CONTROL            PIC X(01).               
000268             88  PI-CREATE-LABELS                    VALUE 'Y'.   
000269             88  PI-BYPASS-LABELS                    VALUE 'N'.   
000270                                                                  
000271         16  PI-BILL-GROUPING-CODE       PIC X(01).               
000272             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.   
000273                                                                  
000274         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).               
000275             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.   
000276             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.   
000277                                                                  
000278         16  FILLER                      PIC X(14).               
000279                                                                  
000280     12  PI-PROGRAM-WORK-AREA            PIC X(640).              
000281******************************************************************
      *<<((file: ELCINTF))
000945     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.             
000946         16  PI-SAVE-FORM        PIC X(12).                       
000947         16  PI-ACCT-KEY         PIC X(26).                       
000948         16  PI-PAYEE-NAME       PIC X(30).                       
000949         16  PI-DAILY-RATE       PIC S9(3)V99.                    
000950         16  PI-MONTH-END-SAVE   PIC XX.                          
000951         16  PI-BENEFIT-SAVE.                                     
000952             20  PI-BEN-DAYS     PIC 99.                          
000953             20  PI-BEN-TYPE     PIC X.                           
000954         16  PI-MANUAL-SW        PIC 9.                           
000955         16  PI-SAVE-CURSOR      PIC S9(4) COMP.                  
000956         16  PI-PASS-SW          PIC X.                           
000957         16  PI-PFKEY-USED       PIC X.                           
000958         16  PI-CK-ASSIGN        PIC X.                           
000959         16  PI-FATAL-COUNT      PIC 99.                          
000960         16  PI-FORCE-COUNT      PIC 99.                          
000961         16  PI-SAVE-INPUT.                                       
000962             20  PI-PMTTYPE      PIC X.                           
000963             20  PI-PAYEE.                                        
000964                 24  PI-PAYEE-TYPE PIC X.                         
000965                 24  PI-PAYEE-SEQ  PIC X.                         
000966                 24  PI-PAYEE-SEQ-NUM REDEFINES                   
000967                   PI-PAYEE-SEQ    PIC S9.                        
000968             20  PI-PMTNOTE1     PIC X(60).                       
000969             20  PI-PMTNOTE2     PIC X(60).                       
000970             20  PI-OFFLINE      PIC X.                           
000971             20  PI-ECHECKNO     PIC X(7).                        
000972             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.           
000973                 28  PI-ECHECKNO-N     PIC X.                     
000974                 28  PI-ECHECKNO-6     PIC X(6).                  
000975             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.          
000976                 24  PI-ECHECKNO-CR    PIC XX.                    
000977                 24  PI-ECHECKNO-5     PIC X(5).                  
000978             20  PI-HOLDTIL      PIC 9(6).                        
000979             20  PI-EPYFROM      PIC 9(6).                        
000980             20  PI-EPYTHRU      PIC 9(6).                        
000981             20  PI-EDAYS        PIC S9(5).                       
000982             20  PI-EPYAMT       PIC S9(7)V99.                    
000983             20  PI-ERESV        PIC S9(7)V99.                    
000984             20  PI-EEXPENS      PIC 9(6)V99.                     
000985             20  PI-ETYPE        PIC X.                           
000986             20  PI-CASH         PIC X.                           
000987             20  PI-GROUPED      PIC X.                           
000988             20  PI-INT-RATE     PIC S99V9(5).                    
000989             20  PI-AIGFROM      PIC 9(6).                        
000990             20  PI-LOAN-NO      PIC X(20).                       
000991             20  PI-PROOF-DATE   PIC 9(6).                        
000992             20  PI-PRINT-EOB-YN PIC X.                           
000993             20  PI-PRINT-CLM-FRM-YN PIC X.                       
000994             20  PI-PRINT-SURVEY-YN PIC X.                        
000995             20  PI-SPECIAL-RELEASE-YN PIC X.                     
000996             20  pi-int-to-rem-borr pic x.                        
000997         16  PI-SAVE-COMPUTED.                                    
000998             20  PI-CCHECKNO     PIC X(7).                        
000999             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.           
001000                 28  PI-CCHECKNO-N     PIC X.                     
001001                 28  PI-CCHECKNO-6     PIC X(6).                  
001002             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.          
001003                 24  PI-CCHECKNO-CR    PIC XX.                    
001004                 24  PI-CCHECKNO-5     PIC X(5).                  
001005             20  PI-CPYFROM      PIC XX.                          
001006             20  PI-CPYTHRU      PIC XX.                          
001007             20  PI-CDAYS        PIC S9(5).                       
001008             20  PI-CPYAMT       PIC S9(7)V99.                    
001009             20  PI-CRESV        PIC 9(6)V99.                     
001010             20  PI-CEXPENS      PIC 9(6)V99.                     
001011             20  PI-PMT-APPR-SW  PIC X.                           
001012                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.             
001013                 88 PI-PMT-GRADUATED   VALUE 'G'.                 
001014                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.             
001015         16  PI-PREV-CLMNO       PIC X(7).                        
001016         16  PI-LF-COVERAGE-TYPE PIC X.                           
001017         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.            
001018         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.            
001019         16  PI-PROVISIONAL-IND  PIC X.                           
001020             88 PI-PROV-PMT      VALUE 'P'.                       
001021         16  PI-PREV-TRLR-KEY    PIC X(22).                       
001022         16  PI-SPLIT-PMT-SW     PIC X.                           
001023         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.             
001024         16  PI-ACTIVITY-CODE    PIC 99.                          
001025         16  PI-RESET-SW         PIC X.                           
001026         16  PI-SPECIAL-BEN-SW   PIC X.                           
001027             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.                 
001028         16  PI-REDUND-PMTAMT    PIC S9(7)V99.                    
001029         16  PI-EXP-DT           PIC XX.                          
001030         16  PI-LOAN-DUE-DAY     PIC 99.                          
001031         16  PI-3RD-PARTY-SW     PIC X.                           
001032         16  PI-LOAN-UPDATE-SW   PIC X.                           
001033                                                                  
001034         16  PI-DMD-DATA.                                         
001035             20  PI-SV-CERT-KEY       PIC X(21).                  
001036             20  PI-SV-CERT-NO        PIC X(11).                  
001037             20  PI-SV-BEN            PIC X(10).                  
001038             20  PI-SV-CCN            PIC X(16).                  
001039             20  PI-INTEREST-PAID-IND PIC X.                      
001040                 88  PI-INTEREST-PAID  VALUE 'Y'.                 
001041             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.        
001042             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.        
001043             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.        
001044             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.        
001045         16  PI-AT-EOB-CODES.                                     
001046             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.         
001047         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.        
001048         16  PI-INT-DAYS              PIC S9(5) COMP-3.           
001049         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.        
001050         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).                  
001051         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).                 
001052         16  PI-CHECK-STATE-FOR-AK    PIC X(02).                  
001053         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.        
001054         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.        
001055         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.        
001056         16  PI-LF-BENEFIT-CD         PIC X(2).                   
001057         16  PI-EOB-CODES-EXIST PIC X.                            
001058         16  PI-SET-NOTE2-MDT   PIC X.                            
001059         16  PI-VFY-2ND-BENE          PIC X.                      
001060         16  PI-CLM-TYPE              PIC X.                      
001061         16  PI-APPROVAL-LEVEL        PIC X.                      
001062         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.           
001063         16  PI-REAUDIT-NEEDED        PIC X.                      
001064         16  PI-DCC-PRODUCT-CODE      PIC XXX.                    
001065         16  PI-AH-BENEFIT-CD         PIC XX.                     
001066         16  pi-ah-term               pic s999 comp-3.            
001067         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.        
001068         16  pi-max-ext               pic 999.                    
001069         16  pi-max-ext-used          pic x.                      
001070         16  PI-APPROVAL-3550-NEEDED  PIC X.                      
001071         16  PI-JOINT-COV-IND         PIC X.                      
001072             88  PI-JOINT-COVERAGE       VALUE 'J'.               
001073             88  PI-SINGLE-COVERAGE      VALUE ' '.               
001074         16  PI-JOINT-INSURED-IND     PIC X.                      
001075             88  PI-JOINT-INSURED        VALUE 'Y'.               
001076             88  PI-PRIMARY-INSURED      VALUE 'N'.               
001077         16  pi-int-payees-name       pic x(30).                  
001078         16  PI-RB-JOINT-COV-IND      PIC X.                      
001079             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.               
001080             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.               
001081         16  pi-ach-payment           pic x.                      
001082         16  PI-DUPE-APPROVAL-NEEDED  PIC X.                      
001083*00781          16  FILLER                   PIC X(176).          
001084*052506         16  FILLER                   PIC X(161).          
001085*031808         16  FILLER                   PIC X(154).          
001086*091808         16  FILLER                   PIC X(152).          
001087*041710         16  FILLER                   PIC X(94).           
001088         16  FILLER                   PIC X(33).                  
001089                                                                  
001090     EJECT                                                        
001091*    COPY ELCJPFX.                                                
      *>>((file: ELCJPFX))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCJPFX.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000006*                            VMOD=2.002                          *
000007*                                                                *
000008*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
000009*                                                                *
000010*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
000011*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
000012*        ELCNTL - CONTROL FILE                                   *
000013*        ELMSTR - CLAIM MASTERS                                  *
000014*        ELTRLR - ACTIVITY TRAILERS                              *
000015*        ELCHKQ - CHECK QUE                                      *
000016******************************************************************
000017 01  JOURNAL-RECORD.                                              
000018     12  jp-date                     pic s9(5) comp-3.            
000019     12  jp-time                     pic s9(7) comp-3.            
000020     12  JP-USER-ID                  PIC X(4).                    
000021     12  JP-FILE-ID                  PIC X(8).                    
000022     12  JP-PROGRAM-ID               PIC X(8).                    
000023     12  JP-RECORD-TYPE              PIC X.                       
000024         88 JP-ADD              VALUE 'A'.                        
000025         88 JP-BEFORE-CHANGE    VALUE 'B'.                        
000026         88 JP-AFTER-CHANGE     VALUE 'C'.                        
000027         88 JP-DELETE           VALUE 'D'.                        
000028         88 JP-GENERIC-DELETE   VALUE 'G'.                        
000029         88 JP-KEY-CHG-DELETE   VALUE 'K'.                        
000030         88 JP-KEY-CHG-ADD      VALUE 'N'.                        
000031     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.            
000032     12  JP-RECORD-AREA                                           
000033                                                                  
000034                                                                  
      *<<((file: ELCJPFX))
001092                             PIC X(750).                          
001093     EJECT                                                        
001094*    COPY ELCAID.                                                 
      *>>((file: ELCAID))
000001******************************************************************
000002*                                                                *
000003*                            ELCAID.                             *
000004*                            VMOD=2.001                          *
000005*                                                                *
000006*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
000007*                                                                *
000008*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
000009*  051007  2007041300002 Change PF22 from x'D5' to x'5B'          
000010******************************************************************
000011                                                                  
000012 01  DFHAID.                                                      
000013   02  DFHNULL   PIC  X  VALUE  ' '.                              
000014   02  DFHENTER  PIC  X  VALUE  QUOTE.                            
000015   02  DFHCLEAR  PIC  X  VALUE  '_'.                              
000016   02  DFHPEN    PIC  X  VALUE  '='.                              
000017   02  DFHOPID   PIC  X  VALUE  'W'.                              
000018   02  DFHPA1    PIC  X  VALUE  '%'.                              
000019   02  DFHPA2    PIC  X  VALUE  '>'.                              
000020   02  DFHPA3    PIC  X  VALUE  ','.                              
000021   02  DFHPF1    PIC  X  VALUE  '1'.                              
000022   02  DFHPF2    PIC  X  VALUE  '2'.                              
000023   02  DFHPF3    PIC  X  VALUE  '3'.                              
000024   02  DFHPF4    PIC  X  VALUE  '4'.                              
000025   02  DFHPF5    PIC  X  VALUE  '5'.                              
000026   02  DFHPF6    PIC  X  VALUE  '6'.                              
000027   02  DFHPF7    PIC  X  VALUE  '7'.                              
000028   02  DFHPF8    PIC  X  VALUE  '8'.                              
000029   02  DFHPF9    PIC  X  VALUE  '9'.                              
000030   02  DFHPF10   PIC  X  VALUE  ':'.                              
000031   02  DFHPF11   PIC  X  VALUE  '#'.                              
000032   02  DFHPF12   PIC  X  VALUE  '@'.                              
000033   02  DFHPF13   PIC  X  VALUE  'A'.                              
000034   02  DFHPF14   PIC  X  VALUE  'B'.                              
000035   02  DFHPF15   PIC  X  VALUE  'C'.                              
000036   02  DFHPF16   PIC  X  VALUE  'D'.                              
000037   02  DFHPF17   PIC  X  VALUE  'E'.                              
000038   02  DFHPF18   PIC  X  VALUE  'F'.                              
000039   02  DFHPF19   PIC  X  VALUE  'G'.                              
000040   02  DFHPF20   PIC  X  VALUE  'H'.                              
000041   02  DFHPF21   PIC  X  VALUE  'I'.                              
000042*00039    02  DFHPF22   PIC  X  VALUE  ''.                       
000043   02  DFHPF22   PIC  X  VALUE  '['.                              
000044   02  DFHPF23   PIC  X  VALUE  '.'.                              
000045   02  DFHPF24   PIC  X  VALUE  '<'.                              
000046   02  DFHMSRE   PIC  X  VALUE  'X'.                              
000047   02  DFHSTRF   PIC  X  VALUE  'h'.                              
000048   02  DFHTRIG   PIC  X  VALUE  '"'.                              
      *<<((file: ELCAID))
001095 01  FILLER    REDEFINES DFHAID.                                  
001096     12  FILLER              PIC X(8).                            
001097     12  PF-VALUES           PIC X       OCCURS 2.                
001098     EJECT                                                        
001099*    COPY EL156S.                                                 
      *>>((file: EL156S))
000001 01  EL156AI.                                                     
000002     05  FILLER            PIC  X(0012).                          
000003*    -------------------------------                              
000004     05  RUNDTEAL PIC S9(0004) COMP.                              
000005     05  RUNDTEAF PIC  X(0001).                                   
000006     05  FILLER REDEFINES RUNDTEAF.                               
000007         10  RUNDTEAA PIC  X(0001).                               
000008     05  RUNDTEAI PIC  X(0008).                                   
000009*    -------------------------------                              
000010     05  RUNTIMAL PIC S9(0004) COMP.                              
000011     05  RUNTIMAF PIC  X(0001).                                   
000012     05  FILLER REDEFINES RUNTIMAF.                               
000013         10  RUNTIMAA PIC  X(0001).                               
000014     05  RUNTIMAI PIC  X(0005).                                   
000015*    -------------------------------                              
000016     05  SEQUL PIC S9(0004) COMP.                                 
000017     05  SEQUF PIC  X(0001).                                      
000018     05  FILLER REDEFINES SEQUF.                                  
000019         10  SEQUA PIC  X(0001).                                  
000020     05  SEQUI PIC  X(0010).                                      
000021*    -------------------------------                              
000022     05  CLMNOL PIC S9(0004) COMP.                                
000023     05  CLMNOF PIC  X(0001).                                     
000024     05  FILLER REDEFINES CLMNOF.                                 
000025         10  CLMNOA PIC  X(0001).                                 
000026     05  CLMNOI PIC  X(0007).                                     
000027*    -------------------------------                              
000028     05  CARRL PIC S9(0004) COMP.                                 
000029     05  CARRF PIC  X(0001).                                      
000030     05  FILLER REDEFINES CARRF.                                  
000031         10  CARRA PIC  X(0001).                                  
000032     05  CARRI PIC  X(0001).                                      
000033*    -------------------------------                              
000034     05  CERTNOL PIC S9(0004) COMP.                               
000035     05  CERTNOF PIC  X(0001).                                    
000036     05  FILLER REDEFINES CERTNOF.                                
000037         10  CERTNOA PIC  X(0001).                                
000038     05  CERTNOI PIC  X(0010).                                    
000039*    -------------------------------                              
000040     05  SUFXL PIC S9(0004) COMP.                                 
000041     05  SUFXF PIC  X(0001).                                      
000042     05  FILLER REDEFINES SUFXF.                                  
000043         10  SUFXA PIC  X(0001).                                  
000044     05  SUFXI PIC  X(0001).                                      
000045*    -------------------------------                              
000046     05  CLMTYPL PIC S9(0004) COMP.                               
000047     05  CLMTYPF PIC  X(0001).                                    
000048     05  FILLER REDEFINES CLMTYPF.                                
000049         10  CLMTYPA PIC  X(0001).                                
000050     05  CLMTYPI PIC  X(0006).                                    
000051*    -------------------------------                              
000052     05  CLMSTATL PIC S9(0004) COMP.                              
000053     05  CLMSTATF PIC  X(0001).                                   
000054     05  FILLER REDEFINES CLMSTATF.                               
000055         10  CLMSTATA PIC  X(0001).                               
000056     05  CLMSTATI PIC  X(0006).                                   
000057*    -------------------------------                              
000058     05  LSTNMEL PIC S9(0004) COMP.                               
000059     05  LSTNMEF PIC  X(0001).                                    
000060     05  FILLER REDEFINES LSTNMEF.                                
000061         10  LSTNMEA PIC  X(0001).                                
000062     05  LSTNMEI PIC  X(0015).                                    
000063*    -------------------------------                              
000064     05  FSTNMEL PIC S9(0004) COMP.                               
000065     05  FSTNMEF PIC  X(0001).                                    
000066     05  FILLER REDEFINES FSTNMEF.                                
000067         10  FSTNMEA PIC  X(0001).                                
000068     05  FSTNMEI PIC  X(0012).                                    
000069*    -------------------------------                              
000070     05  MINITL PIC S9(0004) COMP.                                
000071     05  MINITF PIC  X(0001).                                     
000072     05  FILLER REDEFINES MINITF.                                 
000073         10  MINITA PIC  X(0001).                                 
000074     05  MINITI PIC  X(0001).                                     
000075*    -------------------------------                              
000076     05  PRIMHDGL PIC S9(0004) COMP.                              
000077     05  PRIMHDGF PIC  X(0001).                                   
000078     05  FILLER REDEFINES PRIMHDGF.                               
000079         10  PRIMHDGA PIC  X(0001).                               
000080     05  PRIMHDGI PIC  X(0012).                                   
000081*    -------------------------------                              
000082     05  PCERTNOL PIC S9(0004) COMP.                              
000083     05  PCERTNOF PIC  X(0001).                                   
000084     05  FILLER REDEFINES PCERTNOF.                               
000085         10  PCERTNOA PIC  X(0001).                               
000086     05  PCERTNOI PIC  X(0010).                                   
000087*    -------------------------------                              
000088     05  PSUFXL PIC S9(0004) COMP.                                
000089     05  PSUFXF PIC  X(0001).                                     
000090     05  FILLER REDEFINES PSUFXF.                                 
000091         10  PSUFXA PIC  X(0001).                                 
000092     05  PSUFXI PIC  X(0001).                                     
000093*    -------------------------------                              
000094     05  STATUSL PIC S9(0004) COMP.                               
000095     05  STATUSF PIC  X(0001).                                    
000096     05  FILLER REDEFINES STATUSF.                                
000097         10  STATUSA PIC  X(0001).                                
000098     05  STATUSI PIC  X(0010).                                    
000099*    -------------------------------                              
000100     05  LOANHL PIC S9(0004) COMP.                                
000101     05  LOANHF PIC  X(0001).                                     
000102     05  FILLER REDEFINES LOANHF.                                 
000103         10  LOANHA PIC  X(0001).                                 
000104     05  LOANHI PIC  X(0014).                                     
000105*    -------------------------------                              
000106     05  LOANNOL PIC S9(0004) COMP.                               
000107     05  LOANNOF PIC  X(0001).                                    
000108     05  FILLER REDEFINES LOANNOF.                                
000109         10  LOANNOA PIC  X(0001).                                
000110     05  LOANNOI PIC  X(0025).                                    
000111*    -------------------------------                              
000112     05  DUEDAYHL PIC S9(0004) COMP.                              
000113     05  DUEDAYHF PIC  X(0001).                                   
000114     05  FILLER REDEFINES DUEDAYHF.                               
000115         10  DUEDAYHA PIC  X(0001).                               
000116     05  DUEDAYHI PIC  X(0008).                                   
000117*    -------------------------------                              
000118     05  DUEDAYL PIC S9(0004) COMP.                               
000119     05  DUEDAYF PIC  X(0001).                                    
000120     05  FILLER REDEFINES DUEDAYF.                                
000121         10  DUEDAYA PIC  X(0001).                                
000122     05  DUEDAYI PIC  X(0002).                                    
000123*    -------------------------------                              
000124     05  ZINTHL PIC S9(0004) COMP.                                
000125     05  ZINTHF PIC  X(0001).                                     
000126     05  FILLER REDEFINES ZINTHF.                                 
000127         10  ZINTHA PIC  X(0001).                                 
000128     05  ZINTHI PIC  X(0009).                                     
000129*    -------------------------------                              
000130     05  ZINTL PIC S9(0004) COMP.                                 
000131     05  ZINTF PIC  X(0001).                                      
000132     05  FILLER REDEFINES ZINTF.                                  
000133         10  ZINTA PIC  X(0001).                                  
000134     05  ZINTI PIC  99V99999.                                     
000135*    -------------------------------                              
000136     05  PTHRHDGL PIC S9(0004) COMP.                              
000137     05  PTHRHDGF PIC  X(0001).                                   
000138     05  FILLER REDEFINES PTHRHDGF.                               
000139         10  PTHRHDGA PIC  X(0001).                               
000140     05  PTHRHDGI PIC  X(0014).                                   
000141*    -------------------------------                              
000142     05  PDTHRUL PIC S9(0004) COMP.                               
000143     05  PDTHRUF PIC  X(0001).                                    
000144     05  FILLER REDEFINES PDTHRUF.                                
000145         10  PDTHRUA PIC  X(0001).                                
000146     05  PDTHRUI PIC  X(0008).                                    
000147*    -------------------------------                              
000148     05  TOTPAIDL PIC S9(0004) COMP.                              
000149     05  TOTPAIDF PIC  X(0001).                                   
000150     05  FILLER REDEFINES TOTPAIDF.                               
000151         10  TOTPAIDA PIC  X(0001).                               
000152     05  TOTPAIDI PIC  X(0010).                                   
000153*    -------------------------------                              
000154     05  COVERL PIC S9(0004) COMP.                                
000155     05  COVERF PIC  X(0001).                                     
000156     05  FILLER REDEFINES COVERF.                                 
000157         10  COVERA PIC  X(0001).                                 
000158     05  COVERI PIC  X(0010).                                     
000159*    -------------------------------                              
000160     05  INCURL PIC S9(0004) COMP.                                
000161     05  INCURF PIC  X(0001).                                     
000162     05  FILLER REDEFINES INCURF.                                 
000163         10  INCURA PIC  X(0001).                                 
000164     05  INCURI PIC  X(0008).                                     
000165*    -------------------------------                              
000166     05  LSTDTEL PIC S9(0004) COMP.                               
000167     05  LSTDTEF PIC  X(0001).                                    
000168     05  FILLER REDEFINES LSTDTEF.                                
000169         10  LSTDTEA PIC  X(0001).                                
000170     05  LSTDTEI PIC  X(0008).                                    
000171*    -------------------------------                              
000172     05  CRTSTATL PIC S9(0004) COMP.                              
000173     05  CRTSTATF PIC  X(0001).                                   
000174     05  FILLER REDEFINES CRTSTATF.                               
000175         10  CRTSTATA PIC  X(0001).                               
000176     05  CRTSTATI PIC  X(0010).                                   
000177*    -------------------------------                              
000178     05  EFFECTL PIC S9(0004) COMP.                               
000179     05  EFFECTF PIC  X(0001).                                    
000180     05  FILLER REDEFINES EFFECTF.                                
000181         10  EFFECTA PIC  X(0001).                                
000182     05  EFFECTI PIC  X(0008).                                    
000183*    -------------------------------                              
000184     05  TERMSL PIC S9(0004) COMP.                                
000185     05  TERMSF PIC  X(0001).                                     
000186     05  FILLER REDEFINES TERMSF.                                 
000187         10  TERMSA PIC  X(0001).                                 
000188     05  TERMSI PIC  X(0011).                                     
000189*    -------------------------------                              
000190     05  STACCTL PIC S9(0004) COMP.                               
000191     05  STACCTF PIC  X(0001).                                    
000192     05  FILLER REDEFINES STACCTF.                                
000193         10  STACCTA PIC  X(0001).                                
000194     05  STACCTI PIC  X(0013).                                    
000195*    -------------------------------                              
000196     05  EXPDTEHL PIC S9(0004) COMP.                              
000197     05  EXPDTEHF PIC  X(0001).                                   
000198     05  FILLER REDEFINES EXPDTEHF.                               
000199         10  EXPDTEHA PIC  X(0001).                               
000200     05  EXPDTEHI PIC  X(0014).                                   
000201*    -------------------------------                              
000202     05  EXPDTEL PIC S9(0004) COMP.                               
000203     05  EXPDTEF PIC  X(0001).                                    
000204     05  FILLER REDEFINES EXPDTEF.                                
000205         10  EXPDTEA PIC  X(0001).                                
000206     05  EXPDTEI PIC  X(0008).                                    
000207*    -------------------------------                              
000208     05  BENECAPL PIC S9(0004) COMP.                              
000209     05  BENECAPF PIC  X(0001).                                   
000210     05  FILLER REDEFINES BENECAPF.                               
000211         10  BENECAPA PIC  X(0001).                               
000212     05  BENECAPI PIC  X(0013).                                   
000213*    -------------------------------                              
000214     05  BENEL PIC S9(0004) COMP.                                 
000215     05  BENEF PIC  X(0001).                                      
000216     05  FILLER REDEFINES BENEF.                                  
000217         10  BENEA PIC  X(0001).                                  
000218     05  BENEI PIC  X(0009).                                      
000219*    -------------------------------                              
000220     05  FORMTYPL PIC S9(0004) COMP.                              
000221     05  FORMTYPF PIC  X(0001).                                   
000222     05  FILLER REDEFINES FORMTYPF.                               
000223         10  FORMTYPA PIC  X(0001).                               
000224     05  FORMTYPI PIC  X(0001).                                   
000225*    -------------------------------                              
000226     05  PMTTYPEL PIC S9(0004) COMP.                              
000227     05  PMTTYPEF PIC  X(0001).                                   
000228     05  FILLER REDEFINES PMTTYPEF.                               
000229         10  PMTTYPEA PIC  X(0001).                               
000230     05  PMTTYPEI PIC  X(0001).                                   
000231*    -------------------------------                              
000232     05  PAYEEL PIC S9(0004) COMP.                                
000233     05  PAYEEF PIC  X(0001).                                     
000234     05  FILLER REDEFINES PAYEEF.                                 
000235         10  PAYEEA PIC  X(0001).                                 
000236     05  PAYEEI PIC  X(0002).                                     
000237*    -------------------------------                              
000238     05  CHECKNOL PIC S9(0004) COMP.                              
000239     05  CHECKNOF PIC  X(0001).                                   
000240     05  FILLER REDEFINES CHECKNOF.                               
000241         10  CHECKNOA PIC  X(0001).                               
000242     05  CHECKNOI PIC  X(0007).                                   
000243*    -------------------------------                              
000244     05  OFFLINEL PIC S9(0004) COMP.                              
000245     05  OFFLINEF PIC  X(0001).                                   
000246     05  FILLER REDEFINES OFFLINEF.                               
000247         10  OFFLINEA PIC  X(0001).                               
000248     05  OFFLINEI PIC  X(0001).                                   
000249*    -------------------------------                              
000250     05  HOLDTILL PIC S9(0004) COMP.                              
000251     05  HOLDTILF PIC  X(0001).                                   
000252     05  FILLER REDEFINES HOLDTILF.                               
000253         10  HOLDTILA PIC  X(0001).                               
000254     05  HOLDTILI PIC  X(0008).                                   
000255*    -------------------------------                              
000256     05  NOTE1L PIC S9(0004) COMP.                                
000257     05  NOTE1F PIC  X(0001).                                     
000258     05  FILLER REDEFINES NOTE1F.                                 
000259         10  NOTE1A PIC  X(0001).                                 
000260     05  NOTE1I PIC  X(0060).                                     
000261*    -------------------------------                              
000262     05  ITRB1L PIC S9(0004) COMP.                                
000263     05  ITRB1F PIC  X(0001).                                     
000264     05  FILLER REDEFINES ITRB1F.                                 
000265         10  ITRB1A PIC  X(0001).                                 
000266     05  ITRB1I PIC  X(0008).                                     
000267*    -------------------------------                              
000268     05  NOTE2L PIC S9(0004) COMP.                                
000269     05  NOTE2F PIC  X(0001).                                     
000270     05  FILLER REDEFINES NOTE2F.                                 
000271         10  NOTE2A PIC  X(0001).                                 
000272     05  NOTE2I PIC  X(0060).                                     
000273*    -------------------------------                              
000274     05  ITRB2L PIC S9(0004) COMP.                                
000275     05  ITRB2F PIC  X(0001).                                     
000276     05  FILLER REDEFINES ITRB2F.                                 
000277         10  ITRB2A PIC  X(0001).                                 
000278     05  ITRB2I PIC  X(0010).                                     
000279*    -------------------------------                              
000280     05  EOBYNL PIC S9(0004) COMP.                                
000281     05  EOBYNF PIC  X(0001).                                     
000282     05  FILLER REDEFINES EOBYNF.                                 
000283         10  EOBYNA PIC  X(0001).                                 
000284     05  EOBYNI PIC  X(0001).                                     
000285*    -------------------------------                              
000286     05  CLMFMYNL PIC S9(0004) COMP.                              
000287     05  CLMFMYNF PIC  X(0001).                                   
000288     05  FILLER REDEFINES CLMFMYNF.                               
000289         10  CLMFMYNA PIC  X(0001).                               
000290     05  CLMFMYNI PIC  X(0001).                                   
000291*    -------------------------------                              
000292     05  SURVYYNL PIC S9(0004) COMP.                              
000293     05  SURVYYNF PIC  X(0001).                                   
000294     05  FILLER REDEFINES SURVYYNF.                               
000295         10  SURVYYNA PIC  X(0001).                               
000296     05  SURVYYNI PIC  X(0001).                                   
000297*    -------------------------------                              
000298     05  SPRELYNL PIC S9(0004) COMP.                              
000299     05  SPRELYNF PIC  X(0001).                                   
000300     05  FILLER REDEFINES SPRELYNF.                               
000301         10  SPRELYNA PIC  X(0001).                               
000302     05  SPRELYNI PIC  X(0001).                                   
000303*    -------------------------------                              
000304     05  PINTHL PIC S9(0004) COMP.                                
000305     05  PINTHF PIC  X(0001).                                     
000306     05  FILLER REDEFINES PINTHF.                                 
000307         10  PINTHA PIC  X(0001).                                 
000308     05  PINTHI PIC  X(0004).                                     
000309*    -------------------------------                              
000310     05  PINTL PIC S9(0004) COMP.                                 
000311     05  PINTF PIC  X(0001).                                      
000312     05  FILLER REDEFINES PINTF.                                  
000313         10  PINTA PIC  X(0001).                                  
000314     05  PINTI PIC  X(0008).                                      
000315*    -------------------------------                              
000316     05  ITRBYNL PIC S9(0004) COMP.                               
000317     05  ITRBYNF PIC  X(0001).                                    
000318     05  FILLER REDEFINES ITRBYNF.                                
000319         10  ITRBYNA PIC  X(0001).                                
000320     05  ITRBYNI PIC  X(0001).                                    
000321*    -------------------------------                              
000322     05  PROOFDTL PIC S9(0004) COMP.                              
000323     05  PROOFDTF PIC  X(0001).                                   
000324     05  FILLER REDEFINES PROOFDTF.                               
000325         10  PROOFDTA PIC  X(0001).                               
000326     05  PROOFDTI PIC  X(0008).                                   
000327*    -------------------------------                              
000328     05  AIGFRMHL PIC S9(0004) COMP.                              
000329     05  AIGFRMHF PIC  X(0001).                                   
000330     05  FILLER REDEFINES AIGFRMHF.                               
000331         10  AIGFRMHA PIC  X(0001).                               
000332     05  AIGFRMHI PIC  X(0012).                                   
000333*    -------------------------------                              
000334     05  AIGFROML PIC S9(0004) COMP.                              
000335     05  AIGFROMF PIC  X(0001).                                   
000336     05  FILLER REDEFINES AIGFROMF.                               
000337         10  AIGFROMA PIC  X(0001).                               
000338     05  AIGFROMI PIC  X(0008).                                   
000339*    -------------------------------                              
000340     05  PMTHDGAL PIC S9(0004) COMP.                              
000341     05  PMTHDGAF PIC  X(0001).                                   
000342     05  FILLER REDEFINES PMTHDGAF.                               
000343         10  PMTHDGAA PIC  X(0001).                               
000344     05  PMTHDGAI PIC  X(0066).                                   
000345*    -------------------------------                              
000346     05  EPYFROML PIC S9(0004) COMP.                              
000347     05  EPYFROMF PIC  X(0001).                                   
000348     05  FILLER REDEFINES EPYFROMF.                               
000349         10  EPYFROMA PIC  X(0001).                               
000350     05  EPYFROMI PIC  X(0008).                                   
000351*    -------------------------------                              
000352     05  EPYTHRUL PIC S9(0004) COMP.                              
000353     05  EPYTHRUF PIC  X(0001).                                   
000354     05  FILLER REDEFINES EPYTHRUF.                               
000355         10  EPYTHRUA PIC  X(0001).                               
000356     05  EPYTHRUI PIC  X(0008).                                   
000357*    -------------------------------                              
000358     05  EDAYSL PIC S9(0004) COMP.                                
000359     05  EDAYSF PIC  X(0001).                                     
000360     05  FILLER REDEFINES EDAYSF.                                 
000361         10  EDAYSA PIC  X(0001).                                 
000362     05  EDAYSI PIC  S9(6).                                       
000363*    -------------------------------                              
000364     05  EPYAMTL PIC S9(0004) COMP.                               
000365     05  EPYAMTF PIC  X(0001).                                    
000366     05  FILLER REDEFINES EPYAMTF.                                
000367         10  EPYAMTA PIC  X(0001).                                
000368     05  EPYAMTI PIC  S9(8)V99.                                   
000369*    -------------------------------                              
000370     05  ERESVL PIC S9(0004) COMP.                                
000371     05  ERESVF PIC  X(0001).                                     
000372     05  FILLER REDEFINES ERESVF.                                 
000373         10  ERESVA PIC  X(0001).                                 
000374     05  ERESVI PIC  S9(7)V99.                                    
000375*    -------------------------------                              
000376     05  ETYPEL PIC S9(0004) COMP.                                
000377     05  ETYPEF PIC  X(0001).                                     
000378     05  FILLER REDEFINES ETYPEF.                                 
000379         10  ETYPEA PIC  X(0001).                                 
000380     05  ETYPEI PIC  X(0001).                                     
000381*    -------------------------------                              
000382     05  EEXPENSL PIC S9(0004) COMP.                              
000383     05  EEXPENSF PIC  X(0001).                                   
000384     05  FILLER REDEFINES EEXPENSF.                               
000385         10  EEXPENSA PIC  X(0001).                               
000386     05  EEXPENSI PIC  9(6)V99.                                   
000387*    -------------------------------                              
000388     05  CPYFROML PIC S9(0004) COMP.                              
000389     05  CPYFROMF PIC  X(0001).                                   
000390     05  FILLER REDEFINES CPYFROMF.                               
000391         10  CPYFROMA PIC  X(0001).                               
000392     05  CPYFROMI PIC  X(0008).                                   
000393*    -------------------------------                              
000394     05  CPYTHRUL PIC S9(0004) COMP.                              
000395     05  CPYTHRUF PIC  X(0001).                                   
000396     05  FILLER REDEFINES CPYTHRUF.                               
000397         10  CPYTHRUA PIC  X(0001).                               
000398     05  CPYTHRUI PIC  X(0008).                                   
000399*    -------------------------------                              
000400     05  CDAYSL PIC S9(0004) COMP.                                
000401     05  CDAYSF PIC  X(0001).                                     
000402     05  FILLER REDEFINES CDAYSF.                                 
000403         10  CDAYSA PIC  X(0001).                                 
000404     05  CDAYSI PIC  9(6).                                        
000405*    -------------------------------                              
000406     05  CPYAMTL PIC S9(0004) COMP.                               
000407     05  CPYAMTF PIC  X(0001).                                    
000408     05  FILLER REDEFINES CPYAMTF.                                
000409         10  CPYAMTA PIC  X(0001).                                
000410     05  CPYAMTI PIC  S9(8)V99.                                   
000411*    -------------------------------                              
000412     05  CRESVL PIC S9(0004) COMP.                                
000413     05  CRESVF PIC  X(0001).                                     
000414     05  FILLER REDEFINES CRESVF.                                 
000415         10  CRESVA PIC  X(0001).                                 
000416     05  CRESVI PIC  9(6)V99.                                     
000417*    -------------------------------                              
000418     05  CEXPENSL PIC S9(0004) COMP.                              
000419     05  CEXPENSF PIC  X(0001).                                   
000420     05  FILLER REDEFINES CEXPENSF.                               
000421         10  CEXPENSA PIC  X(0001).                               
000422     05  CEXPENSI PIC  9(6)V99.                                   
000423*    -------------------------------                              
000424     05  ERRMSG0L PIC S9(0004) COMP.                              
000425     05  ERRMSG0F PIC  X(0001).                                   
000426     05  FILLER REDEFINES ERRMSG0F.                               
000427         10  ERRMSG0A PIC  X(0001).                               
000428     05  ERRMSG0I PIC  X(0072).                                   
000429*    -------------------------------                              
000430     05  ERRMSG1L PIC S9(0004) COMP.                              
000431     05  ERRMSG1F PIC  X(0001).                                   
000432     05  FILLER REDEFINES ERRMSG1F.                               
000433         10  ERRMSG1A PIC  X(0001).                               
000434     05  ERRMSG1I PIC  X(0072).                                   
000435*    -------------------------------                              
000436     05  ERRMSG2L PIC S9(0004) COMP.                              
000437     05  ERRMSG2F PIC  X(0001).                                   
000438     05  FILLER REDEFINES ERRMSG2F.                               
000439         10  ERRMSG2A PIC  X(0001).                               
000440     05  ERRMSG2I PIC  X(0072).                                   
000441*    -------------------------------                              
000442     05  ENTERPFL PIC S9(0004) COMP.                              
000443     05  ENTERPFF PIC  X(0001).                                   
000444     05  FILLER REDEFINES ENTERPFF.                               
000445         10  ENTERPFA PIC  X(0001).                               
000446     05  ENTERPFI PIC  99.                                        
000447*    -------------------------------                              
000448     05  PF6TITL PIC S9(0004) COMP.                               
000449     05  PF6TITF PIC  X(0001).                                    
000450     05  FILLER REDEFINES PF6TITF.                                
000451         10  PF6TITA PIC  X(0001).                                
000452     05  PF6TITI PIC  X(0016).                                    
000453 01  EL156AO REDEFINES EL156AI.                                   
000454     05  FILLER            PIC  X(0012).                          
000455*    -------------------------------                              
000456     05  FILLER            PIC  X(0003).                          
000457     05  RUNDTEAO PIC  X(0008).                                   
000458*    -------------------------------                              
000459     05  FILLER            PIC  X(0003).                          
000460     05  RUNTIMAO PIC  99.99.                                     
000461*    -------------------------------                              
000462     05  FILLER            PIC  X(0003).                          
000463     05  SEQUO PIC  X(0010).                                      
000464*    -------------------------------                              
000465     05  FILLER            PIC  X(0003).                          
000466     05  CLMNOO PIC  X(0007).                                     
000467*    -------------------------------                              
000468     05  FILLER            PIC  X(0003).                          
000469     05  CARRO PIC  X(0001).                                      
000470*    -------------------------------                              
000471     05  FILLER            PIC  X(0003).                          
000472     05  CERTNOO PIC  X(0010).                                    
000473*    -------------------------------                              
000474     05  FILLER            PIC  X(0003).                          
000475     05  SUFXO PIC  X(0001).                                      
000476*    -------------------------------                              
000477     05  FILLER            PIC  X(0003).                          
000478     05  CLMTYPO PIC  X(0006).                                    
000479*    -------------------------------                              
000480     05  FILLER            PIC  X(0003).                          
000481     05  CLMSTATO PIC  X(0006).                                   
000482*    -------------------------------                              
000483     05  FILLER            PIC  X(0003).                          
000484     05  LSTNMEO PIC  X(0015).                                    
000485*    -------------------------------                              
000486     05  FILLER            PIC  X(0003).                          
000487     05  FSTNMEO PIC  X(0012).                                    
000488*    -------------------------------                              
000489     05  FILLER            PIC  X(0003).                          
000490     05  MINITO PIC  X(0001).                                     
000491*    -------------------------------                              
000492     05  FILLER            PIC  X(0003).                          
000493     05  PRIMHDGO PIC  X(0012).                                   
000494*    -------------------------------                              
000495     05  FILLER            PIC  X(0003).                          
000496     05  PCERTNOO PIC  X(0010).                                   
000497*    -------------------------------                              
000498     05  FILLER            PIC  X(0003).                          
000499     05  PSUFXO PIC  X(0001).                                     
000500*    -------------------------------                              
000501     05  FILLER            PIC  X(0003).                          
000502     05  STATUSO PIC  X(0010).                                    
000503*    -------------------------------                              
000504     05  FILLER            PIC  X(0003).                          
000505     05  LOANHO PIC  X(0014).                                     
000506*    -------------------------------                              
000507     05  FILLER            PIC  X(0003).                          
000508     05  LOANNOO PIC  X(0025).                                    
000509*    -------------------------------                              
000510     05  FILLER            PIC  X(0003).                          
000511     05  DUEDAYHO PIC  X(0008).                                   
000512*    -------------------------------                              
000513     05  FILLER            PIC  X(0003).                          
000514     05  DUEDAYO PIC  X(0002).                                    
000515*    -------------------------------                              
000516     05  FILLER            PIC  X(0003).                          
000517     05  ZINTHO PIC  X(0009).                                     
000518*    -------------------------------                              
000519     05  FILLER            PIC  X(0003).                          
000520     05  ZINTO PIC  9.99999.                                      
000521*    -------------------------------                              
000522     05  FILLER            PIC  X(0003).                          
000523     05  PTHRHDGO PIC  X(0014).                                   
000524*    -------------------------------                              
000525     05  FILLER            PIC  X(0003).                          
000526     05  PDTHRUO PIC  X(0008).                                    
000527*    -------------------------------                              
000528     05  FILLER            PIC  X(0003).                          
000529     05  TOTPAIDO PIC  Z(6).99-.                                  
000530*    -------------------------------                              
000531     05  FILLER            PIC  X(0003).                          
000532     05  COVERO PIC  X(0010).                                     
000533*    -------------------------------                              
000534     05  FILLER            PIC  X(0003).                          
000535     05  INCURO PIC  X(0008).                                     
000536*    -------------------------------                              
000537     05  FILLER            PIC  X(0003).                          
000538     05  LSTDTEO PIC  X(0008).                                    
000539*    -------------------------------                              
000540     05  FILLER            PIC  X(0003).                          
000541     05  CRTSTATO PIC  X(0010).                                   
000542*    -------------------------------                              
000543     05  FILLER            PIC  X(0003).                          
000544     05  EFFECTO PIC  X(0008).                                    
000545*    -------------------------------                              
000546     05  FILLER            PIC  X(0003).                          
000547     05  TERMSO PIC  X(0011).                                     
000548*    -------------------------------                              
000549     05  FILLER            PIC  X(0003).                          
000550     05  STACCTO PIC  X(0013).                                    
000551*    -------------------------------                              
000552     05  FILLER            PIC  X(0003).                          
000553     05  EXPDTEHO PIC  X(0014).                                   
000554*    -------------------------------                              
000555     05  FILLER            PIC  X(0003).                          
000556     05  EXPDTEO PIC  X(0008).                                    
000557*    -------------------------------                              
000558     05  FILLER            PIC  X(0003).                          
000559     05  BENECAPO PIC  X(0013).                                   
000560*    -------------------------------                              
000561     05  FILLER            PIC  X(0003).                          
000562     05  BENEO PIC  Z(6).99.                                      
000563*    -------------------------------                              
000564     05  FILLER            PIC  X(0003).                          
000565     05  FORMTYPO PIC  X(0001).                                   
000566*    -------------------------------                              
000567     05  FILLER            PIC  X(0003).                          
000568     05  PMTTYPEO PIC  X(0001).                                   
000569*    -------------------------------                              
000570     05  FILLER            PIC  X(0003).                          
000571     05  PAYEEO PIC  X(0002).                                     
000572*    -------------------------------                              
000573     05  FILLER            PIC  X(0003).                          
000574     05  CHECKNOO PIC  X(0007).                                   
000575*    -------------------------------                              
000576     05  FILLER            PIC  X(0003).                          
000577     05  OFFLINEO PIC  X(0001).                                   
000578*    -------------------------------                              
000579     05  FILLER            PIC  X(0003).                          
000580     05  HOLDTILO PIC  99B99B99.                                  
000581*    -------------------------------                              
000582     05  FILLER            PIC  X(0003).                          
000583     05  NOTE1O PIC  X(0060).                                     
000584*    -------------------------------                              
000585     05  FILLER            PIC  X(0003).                          
000586     05  ITRB1O PIC  X(0008).                                     
000587*    -------------------------------                              
000588     05  FILLER            PIC  X(0003).                          
000589     05  NOTE2O PIC  X(0060).                                     
000590*    -------------------------------                              
000591     05  FILLER            PIC  X(0003).                          
000592     05  ITRB2O PIC  X(0010).                                     
000593*    -------------------------------                              
000594     05  FILLER            PIC  X(0003).                          
000595     05  EOBYNO PIC  X(0001).                                     
000596*    -------------------------------                              
000597     05  FILLER            PIC  X(0003).                          
000598     05  CLMFMYNO PIC  X(0001).                                   
000599*    -------------------------------                              
000600     05  FILLER            PIC  X(0003).                          
000601     05  SURVYYNO PIC  X(0001).                                   
000602*    -------------------------------                              
000603     05  FILLER            PIC  X(0003).                          
000604     05  SPRELYNO PIC  X(0001).                                   
000605*    -------------------------------                              
000606     05  FILLER            PIC  X(0003).                          
000607     05  PINTHO PIC  X(0004).                                     
000608*    -------------------------------                              
000609     05  FILLER            PIC  X(0003).                          
000610     05  PINTO PIC  Z,ZZ9.99.                                     
000611*    -------------------------------                              
000612     05  FILLER            PIC  X(0003).                          
000613     05  ITRBYNO PIC  X(0001).                                    
000614*    -------------------------------                              
000615     05  FILLER            PIC  X(0003).                          
000616     05  PROOFDTO PIC  99B99B99.                                  
000617*    -------------------------------                              
000618     05  FILLER            PIC  X(0003).                          
000619     05  AIGFRMHO PIC  X(0012).                                   
000620*    -------------------------------                              
000621     05  FILLER            PIC  X(0003).                          
000622     05  AIGFROMO PIC  99B99B99.                                  
000623*    -------------------------------                              
000624     05  FILLER            PIC  X(0003).                          
000625     05  PMTHDGAO PIC  X(0066).                                   
000626*    -------------------------------                              
000627     05  FILLER            PIC  X(0003).                          
000628     05  EPYFROMO PIC  99B99B99.                                  
000629*    -------------------------------                              
000630     05  FILLER            PIC  X(0003).                          
000631     05  EPYTHRUO PIC  99B99B99.                                  
000632*    -------------------------------                              
000633     05  FILLER            PIC  X(0003).                          
000634     05  EDAYSO PIC  Z(4)9-.                                      
000635*    -------------------------------                              
000636     05  FILLER            PIC  X(0003).                          
000637     05  EPYAMTO PIC  Z(6).99-.                                   
000638*    -------------------------------                              
000639     05  FILLER            PIC  X(0003).                          
000640     05  ERESVO PIC  Z(5).99-.                                    
000641*    -------------------------------                              
000642     05  FILLER            PIC  X(0003).                          
000643     05  ETYPEO PIC  X(0001).                                     
000644*    -------------------------------                              
000645     05  FILLER            PIC  X(0003).                          
000646     05  EEXPENSO PIC  Z(5).99.                                   
000647*    -------------------------------                              
000648     05  FILLER            PIC  X(0003).                          
000649     05  CPYFROMO PIC  99B99B99.                                  
000650*    -------------------------------                              
000651     05  FILLER            PIC  X(0003).                          
000652     05  CPYTHRUO PIC  99B99B99.                                  
000653*    -------------------------------                              
000654     05  FILLER            PIC  X(0003).                          
000655     05  CDAYSO PIC  Z(4)9-.                                      
000656*    -------------------------------                              
000657     05  FILLER            PIC  X(0003).                          
000658     05  CPYAMTO PIC  Z(6).99-.                                   
000659*    -------------------------------                              
000660     05  FILLER            PIC  X(0003).                          
000661     05  CRESVO PIC  Z(5).99.                                     
000662*    -------------------------------                              
000663     05  FILLER            PIC  X(0003).                          
000664     05  CEXPENSO PIC  Z(5).99.                                   
000665*    -------------------------------                              
000666     05  FILLER            PIC  X(0003).                          
000667     05  ERRMSG0O PIC  X(0072).                                   
000668*    -------------------------------                              
000669     05  FILLER            PIC  X(0003).                          
000670     05  ERRMSG1O PIC  X(0072).                                   
000671*    -------------------------------                              
000672     05  FILLER            PIC  X(0003).                          
000673     05  ERRMSG2O PIC  X(0072).                                   
000674*    -------------------------------                              
000675     05  FILLER            PIC  X(0003).                          
000676     05  ENTERPFO PIC  X(0002).                                   
000677*    -------------------------------                              
000678     05  FILLER            PIC  X(0003).                          
000679     05  PF6TITO PIC  X(0016).                                    
000680*    -------------------------------                              
000681 01  EL156BI REDEFINES EL156AI.                                   
000682     05  FILLER            PIC  X(0012).                          
000683*    -------------------------------                              
000684     05  RUNDTEBL PIC S9(0004) COMP.                              
000685     05  RUNDTEBF PIC  X(0001).                                   
000686     05  FILLER REDEFINES RUNDTEBF.                               
000687         10  RUNDTEBA PIC  X(0001).                               
000688     05  RUNDTEBI PIC  X(0008).                                   
000689*    -------------------------------                              
000690     05  RUNTIMBL PIC S9(0004) COMP.                              
000691     05  RUNTIMBF PIC  X(0001).                                   
000692     05  FILLER REDEFINES RUNTIMBF.                               
000693         10  RUNTIMBA PIC  X(0001).                               
000694     05  RUNTIMBI PIC  X(0005).                                   
000695*    -------------------------------                              
000696     05  PAYDTBL PIC S9(0004) COMP.                               
000697     05  PAYDTBF PIC  X(0001).                                    
000698     05  FILLER REDEFINES PAYDTBF.                                
000699         10  PAYDTBA PIC  X(0001).                                
000700     05  PAYDTBI PIC  X(0008).                                    
000701*    -------------------------------                              
000702     05  PAYTYPBL PIC S9(0004) COMP.                              
000703     05  PAYTYPBF PIC  X(0001).                                   
000704     05  FILLER REDEFINES PAYTYPBF.                               
000705         10  PAYTYPBA PIC  X(0001).                               
000706     05  PAYTYPBI PIC  X(0015).                                   
000707*    -------------------------------                              
000708     05  PAYAMTBL PIC S9(0004) COMP.                              
000709     05  PAYAMTBF PIC  X(0001).                                   
000710     05  FILLER REDEFINES PAYAMTBF.                               
000711         10  PAYAMTBA PIC  X(0001).                               
000712     05  PAYAMTBI PIC  X(0011).                                   
000713*    -------------------------------                              
000714     05  LOANHBL PIC S9(0004) COMP.                               
000715     05  LOANHBF PIC  X(0001).                                    
000716     05  FILLER REDEFINES LOANHBF.                                
000717         10  LOANHBA PIC  X(0001).                                
000718     05  LOANHBI PIC  X(0012).                                    
000719*    -------------------------------                              
000720     05  LOANNBL PIC S9(0004) COMP.                               
000721     05  LOANNBF PIC  X(0001).                                    
000722     05  FILLER REDEFINES LOANNBF.                                
000723         10  LOANNBA PIC  X(0001).                                
000724     05  LOANNBI PIC  X(0025).                                    
000725*    -------------------------------                              
000726     05  CKNUMHDL PIC S9(0004) COMP.                              
000727     05  CKNUMHDF PIC  X(0001).                                   
000728     05  FILLER REDEFINES CKNUMHDF.                               
000729         10  CKNUMHDA PIC  X(0001).                               
000730     05  CKNUMHDI PIC  X(0012).                                   
000731*    -------------------------------                              
000732     05  CKNUMBL PIC S9(0004) COMP.                               
000733     05  CKNUMBF PIC  X(0001).                                    
000734     05  FILLER REDEFINES CKNUMBF.                                
000735         10  CKNUMBA PIC  X(0001).                                
000736     05  CKNUMBI PIC  X(0007).                                    
000737*    -------------------------------                              
000738     05  AGTHDGL PIC S9(0004) COMP.                               
000739     05  AGTHDGF PIC  X(0001).                                    
000740     05  FILLER REDEFINES AGTHDGF.                                
000741         10  AGTHDGA PIC  X(0001).                                
000742     05  AGTHDGI PIC  X(0016).                                    
000743*    -------------------------------                              
000744     05  NAMEBL PIC S9(0004) COMP.                                
000745     05  NAMEBF PIC  X(0001).                                     
000746     05  FILLER REDEFINES NAMEBF.                                 
000747         10  NAMEBA PIC  X(0001).                                 
000748     05  NAMEBI PIC  X(0030).                                     
000749*    -------------------------------                              
000750     05  NAMEB2L PIC S9(0004) COMP.                               
000751     05  NAMEB2F PIC  X(0001).                                    
000752     05  FILLER REDEFINES NAMEB2F.                                
000753         10  NAMEB2A PIC  X(0001).                                
000754     05  NAMEB2I PIC  X(0030).                                    
000755*    -------------------------------                              
000756     05  ADDR1BL PIC S9(0004) COMP.                               
000757     05  ADDR1BF PIC  X(0001).                                    
000758     05  FILLER REDEFINES ADDR1BF.                                
000759         10  ADDR1BA PIC  X(0001).                                
000760     05  ADDR1BI PIC  X(0030).                                    
000761*    -------------------------------                              
000762     05  ADDR1B2L PIC S9(0004) COMP.                              
000763     05  ADDR1B2F PIC  X(0001).                                   
000764     05  FILLER REDEFINES ADDR1B2F.                               
000765         10  ADDR1B2A PIC  X(0001).                               
000766     05  ADDR1B2I PIC  X(0030).                                   
000767*    -------------------------------                              
000768     05  ADDR2BL PIC S9(0004) COMP.                               
000769     05  ADDR2BF PIC  X(0001).                                    
000770     05  FILLER REDEFINES ADDR2BF.                                
000771         10  ADDR2BA PIC  X(0001).                                
000772     05  ADDR2BI PIC  X(0030).                                    
000773*    -------------------------------                              
000774     05  ADDR2B2L PIC S9(0004) COMP.                              
000775     05  ADDR2B2F PIC  X(0001).                                   
000776     05  FILLER REDEFINES ADDR2B2F.                               
000777         10  ADDR2B2A PIC  X(0001).                               
000778     05  ADDR2B2I PIC  X(0030).                                   
000779*    -------------------------------                              
000780     05  CITYSTBL PIC S9(0004) COMP.                              
000781     05  CITYSTBF PIC  X(0001).                                   
000782     05  FILLER REDEFINES CITYSTBF.                               
000783         10  CITYSTBA PIC  X(0001).                               
000784     05  CITYSTBI PIC  X(0030).                                   
000785*    -------------------------------                              
000786     05  CITYST2L PIC S9(0004) COMP.                              
000787     05  CITYST2F PIC  X(0001).                                   
000788     05  FILLER REDEFINES CITYST2F.                               
000789         10  CITYST2A PIC  X(0001).                               
000790     05  CITYST2I PIC  X(0030).                                   
000791*    -------------------------------                              
000792     05  ZIPBL PIC S9(0004) COMP.                                 
000793     05  ZIPBF PIC  X(0001).                                      
000794     05  FILLER REDEFINES ZIPBF.                                  
000795         10  ZIPBA PIC  X(0001).                                  
000796     05  ZIPBI PIC  X(0009).                                      
000797*    -------------------------------                              
000798     05  ZIPB2L PIC S9(0004) COMP.                                
000799     05  ZIPB2F PIC  X(0001).                                     
000800     05  FILLER REDEFINES ZIPB2F.                                 
000801         10  ZIPB2A PIC  X(0001).                                 
000802     05  ZIPB2I PIC  X(0009).                                     
000803*    -------------------------------                              
000804     05  INTHDBL PIC S9(0004) COMP.                               
000805     05  INTHDBF PIC  X(0001).                                    
000806     05  FILLER REDEFINES INTHDBF.                                
000807         10  INTHDBA PIC  X(0001).                                
000808     05  INTHDBI PIC  X(0012).                                    
000809*    -------------------------------                              
000810     05  INTAMTBL PIC S9(0004) COMP.                              
000811     05  INTAMTBF PIC  X(0001).                                   
000812     05  FILLER REDEFINES INTAMTBF.                               
000813         10  INTAMTBA PIC  X(0001).                               
000814     05  INTAMTBI PIC  X(0011).                                   
000815*    -------------------------------                              
000816     05  PMTHDGBL PIC S9(0004) COMP.                              
000817     05  PMTHDGBF PIC  X(0001).                                   
000818     05  FILLER REDEFINES PMTHDGBF.                               
000819         10  PMTHDGBA PIC  X(0001).                               
000820     05  PMTHDGBI PIC  X(0034).                                   
000821*    -------------------------------                              
000822     05  CLMNOBL PIC S9(0004) COMP.                               
000823     05  CLMNOBF PIC  X(0001).                                    
000824     05  FILLER REDEFINES CLMNOBF.                                
000825         10  CLMNOBA PIC  X(0001).                                
000826     05  CLMNOBI PIC  X(0007).                                    
000827*    -------------------------------                              
000828     05  CARRBL PIC S9(0004) COMP.                                
000829     05  CARRBF PIC  X(0001).                                     
000830     05  FILLER REDEFINES CARRBF.                                 
000831         10  CARRBA PIC  X(0001).                                 
000832     05  CARRBI PIC  X(0001).                                     
000833*    -------------------------------                              
000834     05  CERTNOBL PIC S9(0004) COMP.                              
000835     05  CERTNOBF PIC  X(0001).                                   
000836     05  FILLER REDEFINES CERTNOBF.                               
000837         10  CERTNOBA PIC  X(0001).                               
000838     05  CERTNOBI PIC  X(0010).                                   
000839*    -------------------------------                              
000840     05  SUFXBL PIC S9(0004) COMP.                                
000841     05  SUFXBF PIC  X(0001).                                     
000842     05  FILLER REDEFINES SUFXBF.                                 
000843         10  SUFXBA PIC  X(0001).                                 
000844     05  SUFXBI PIC  X(0001).                                     
000845*    -------------------------------                              
000846     05  CLMTYPBL PIC S9(0004) COMP.                              
000847     05  CLMTYPBF PIC  X(0001).                                   
000848     05  FILLER REDEFINES CLMTYPBF.                               
000849         10  CLMTYPBA PIC  X(0001).                               
000850     05  CLMTYPBI PIC  X(0006).                                   
000851*    -------------------------------                              
000852     05  INCURBL PIC S9(0004) COMP.                               
000853     05  INCURBF PIC  X(0001).                                    
000854     05  FILLER REDEFINES INCURBF.                                
000855         10  INCURBA PIC  X(0001).                                
000856     05  INCURBI PIC  X(0008).                                    
000857*    -------------------------------                              
000858     05  PYFROMBL PIC S9(0004) COMP.                              
000859     05  PYFROMBF PIC  X(0001).                                   
000860     05  FILLER REDEFINES PYFROMBF.                               
000861         10  PYFROMBA PIC  X(0001).                               
000862     05  PYFROMBI PIC  X(0008).                                   
000863*    -------------------------------                              
000864     05  PYTHRUBL PIC S9(0004) COMP.                              
000865     05  PYTHRUBF PIC  X(0001).                                   
000866     05  FILLER REDEFINES PYTHRUBF.                               
000867         10  PYTHRUBA PIC  X(0001).                               
000868     05  PYTHRUBI PIC  X(0008).                                   
000869*    -------------------------------                              
000870     05  DAYSBL PIC S9(0004) COMP.                                
000871     05  DAYSBF PIC  X(0001).                                     
000872     05  FILLER REDEFINES DAYSBF.                                 
000873         10  DAYSBA PIC  X(0001).                                 
000874     05  DAYSBI PIC  X(0005).                                     
000875*    -------------------------------                              
000876     05  BYBL PIC S9(0004) COMP.                                  
000877     05  BYBF PIC  X(0001).                                       
000878     05  FILLER REDEFINES BYBF.                                   
000879         10  BYBA PIC  X(0001).                                   
000880     05  BYBI PIC  X(0004).                                       
000881*    -------------------------------                              
000882     05  PROOFDBL PIC S9(0004) COMP.                              
000883     05  PROOFDBF PIC  X(0001).                                   
000884     05  FILLER REDEFINES PROOFDBF.                               
000885         10  PROOFDBA PIC  X(0001).                               
000886     05  PROOFDBI PIC  X(0008).                                   
000887*    -------------------------------                              
000888     05  ACCTBL PIC S9(0004) COMP.                                
000889     05  ACCTBF PIC  X(0001).                                     
000890     05  FILLER REDEFINES ACCTBF.                                 
000891         10  ACCTBA PIC  X(0001).                                 
000892     05  ACCTBI PIC  X(0010).                                     
000893*    -------------------------------                              
000894     05  STATEBL PIC S9(0004) COMP.                               
000895     05  STATEBF PIC  X(0001).                                    
000896     05  FILLER REDEFINES STATEBF.                                
000897         10  STATEBA PIC  X(0001).                                
000898     05  STATEBI PIC  X(0002).                                    
000899*    -------------------------------                              
000900     05  GROUPBL PIC S9(0004) COMP.                               
000901     05  GROUPBF PIC  X(0001).                                    
000902     05  FILLER REDEFINES GROUPBF.                                
000903         10  GROUPBA PIC  X(0001).                                
000904     05  GROUPBI PIC  X(0006).                                    
000905*    -------------------------------                              
000906     05  ACARRBL PIC S9(0004) COMP.                               
000907     05  ACARRBF PIC  X(0001).                                    
000908     05  FILLER REDEFINES ACARRBF.                                
000909         10  ACARRBA PIC  X(0001).                                
000910     05  ACARRBI PIC  X(0001).                                    
000911*    -------------------------------                              
000912     05  ACCTNMBL PIC S9(0004) COMP.                              
000913     05  ACCTNMBF PIC  X(0001).                                   
000914     05  FILLER REDEFINES ACCTNMBF.                               
000915         10  ACCTNMBA PIC  X(0001).                               
000916     05  ACCTNMBI PIC  X(0030).                                   
000917*    -------------------------------                              
000918     05  UNDISBL PIC S9(0004) COMP.                               
000919     05  UNDISBF PIC  X(0001).                                    
000920     05  FILLER REDEFINES UNDISBF.                                
000921         10  UNDISBA PIC  X(0001).                                
000922     05  UNDISBI PIC  X(0010).                                    
000923*    -------------------------------                              
000924     05  RATEBL PIC S9(0004) COMP.                                
000925     05  RATEBF PIC  X(0001).                                     
000926     05  FILLER REDEFINES RATEBF.                                 
000927         10  RATEBA PIC  X(0001).                                 
000928     05  RATEBI PIC  X(0006).                                     
000929*    -------------------------------                              
000930     05  ERMSG1BL PIC S9(0004) COMP.                              
000931     05  ERMSG1BF PIC  X(0001).                                   
000932     05  FILLER REDEFINES ERMSG1BF.                               
000933         10  ERMSG1BA PIC  X(0001).                               
000934     05  ERMSG1BI PIC  X(0072).                                   
000935*    -------------------------------                              
000936     05  ENTPFBL PIC S9(0004) COMP.                               
000937     05  ENTPFBF PIC  X(0001).                                    
000938     05  FILLER REDEFINES ENTPFBF.                                
000939         10  ENTPFBA PIC  X(0001).                                
000940     05  ENTPFBI PIC  99.                                         
000941 01  EL156BO REDEFINES EL156AI.                                   
000942     05  FILLER            PIC  X(0012).                          
000943*    -------------------------------                              
000944     05  FILLER            PIC  X(0003).                          
000945     05  RUNDTEBO PIC  X(0008).                                   
000946*    -------------------------------                              
000947     05  FILLER            PIC  X(0003).                          
000948     05  RUNTIMBO PIC  99.99.                                     
000949*    -------------------------------                              
000950     05  FILLER            PIC  X(0003).                          
000951     05  PAYDTBO PIC  99B99B99.                                   
000952*    -------------------------------                              
000953     05  FILLER            PIC  X(0003).                          
000954     05  PAYTYPBO PIC  X(0015).                                   
000955*    -------------------------------                              
000956     05  FILLER            PIC  X(0003).                          
000957     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.                               
000958*    -------------------------------                              
000959     05  FILLER            PIC  X(0003).                          
000960     05  LOANHBO PIC  X(0012).                                    
000961*    -------------------------------                              
000962     05  FILLER            PIC  X(0003).                          
000963     05  LOANNBO PIC  X(0025).                                    
000964*    -------------------------------                              
000965     05  FILLER            PIC  X(0003).                          
000966     05  CKNUMHDO PIC  X(0012).                                   
000967*    -------------------------------                              
000968     05  FILLER            PIC  X(0003).                          
000969     05  CKNUMBO PIC  X(0007).                                    
000970*    -------------------------------                              
000971     05  FILLER            PIC  X(0003).                          
000972     05  AGTHDGO PIC  X(0016).                                    
000973*    -------------------------------                              
000974     05  FILLER            PIC  X(0003).                          
000975     05  NAMEBO PIC  X(0030).                                     
000976*    -------------------------------                              
000977     05  FILLER            PIC  X(0003).                          
000978     05  NAMEB2O PIC  X(0030).                                    
000979*    -------------------------------                              
000980     05  FILLER            PIC  X(0003).                          
000981     05  ADDR1BO PIC  X(0030).                                    
000982*    -------------------------------                              
000983     05  FILLER            PIC  X(0003).                          
000984     05  ADDR1B2O PIC  X(0030).                                   
000985*    -------------------------------                              
000986     05  FILLER            PIC  X(0003).                          
000987     05  ADDR2BO PIC  X(0030).                                    
000988*    -------------------------------                              
000989     05  FILLER            PIC  X(0003).                          
000990     05  ADDR2B2O PIC  X(0030).                                   
000991*    -------------------------------                              
000992     05  FILLER            PIC  X(0003).                          
000993     05  CITYSTBO PIC  X(0030).                                   
000994*    -------------------------------                              
000995     05  FILLER            PIC  X(0003).                          
000996     05  CITYST2O PIC  X(0030).                                   
000997*    -------------------------------                              
000998     05  FILLER            PIC  X(0003).                          
000999     05  ZIPBO PIC  ZZZZ99999.                                    
001000*    -------------------------------                              
001001     05  FILLER            PIC  X(0003).                          
001002     05  ZIPB2O PIC  ZZZZZZZZZ.                                   
001003*    -------------------------------                              
001004     05  FILLER            PIC  X(0003).                          
001005     05  INTHDBO PIC  X(0012).                                    
001006*    -------------------------------                              
001007     05  FILLER            PIC  X(0003).                          
001008     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.                               
001009*    -------------------------------                              
001010     05  FILLER            PIC  X(0003).                          
001011     05  PMTHDGBO PIC  X(0034).                                   
001012*    -------------------------------                              
001013     05  FILLER            PIC  X(0003).                          
001014     05  CLMNOBO PIC  X(0007).                                    
001015*    -------------------------------                              
001016     05  FILLER            PIC  X(0003).                          
001017     05  CARRBO PIC  X(0001).                                     
001018*    -------------------------------                              
001019     05  FILLER            PIC  X(0003).                          
001020     05  CERTNOBO PIC  X(0010).                                   
001021*    -------------------------------                              
001022     05  FILLER            PIC  X(0003).                          
001023     05  SUFXBO PIC  X(0001).                                     
001024*    -------------------------------                              
001025     05  FILLER            PIC  X(0003).                          
001026     05  CLMTYPBO PIC  X(0006).                                   
001027*    -------------------------------                              
001028     05  FILLER            PIC  X(0003).                          
001029     05  INCURBO PIC  X(0008).                                    
001030*    -------------------------------                              
001031     05  FILLER            PIC  X(0003).                          
001032     05  PYFROMBO PIC  99B99B99.                                  
001033*    -------------------------------                              
001034     05  FILLER            PIC  X(0003).                          
001035     05  PYTHRUBO PIC  99B99B99.                                  
001036*    -------------------------------                              
001037     05  FILLER            PIC  X(0003).                          
001038     05  DAYSBO PIC  X(0005).                                     
001039*    -------------------------------                              
001040     05  FILLER            PIC  X(0003).                          
001041     05  BYBO PIC  X(0004).                                       
001042*    -------------------------------                              
001043     05  FILLER            PIC  X(0003).                          
001044     05  PROOFDBO PIC  99B99B99.                                  
001045*    -------------------------------                              
001046     05  FILLER            PIC  X(0003).                          
001047     05  ACCTBO PIC  X(0010).                                     
001048*    -------------------------------                              
001049     05  FILLER            PIC  X(0003).                          
001050     05  STATEBO PIC  X(0002).                                    
001051*    -------------------------------                              
001052     05  FILLER            PIC  X(0003).                          
001053     05  GROUPBO PIC  X(0006).                                    
001054*    -------------------------------                              
001055     05  FILLER            PIC  X(0003).                          
001056     05  ACARRBO PIC  X(0001).                                    
001057*    -------------------------------                              
001058     05  FILLER            PIC  X(0003).                          
001059     05  ACCTNMBO PIC  X(0030).                                   
001060*    -------------------------------                              
001061     05  FILLER            PIC  X(0003).                          
001062     05  UNDISBO PIC  ZZZ,Z99.99.                                 
001063*    -------------------------------                              
001064     05  FILLER            PIC  X(0003).                          
001065     05  RATEBO PIC  ZZZ.99.                                      
001066*    -------------------------------                              
001067     05  FILLER            PIC  X(0003).                          
001068     05  ERMSG1BO PIC  X(0072).                                   
001069*    -------------------------------                              
001070     05  FILLER            PIC  X(0003).                          
001071     05  ENTPFBO PIC  X(0002).                                    
001072*    -------------------------------                              
      *<<((file: EL156S))
001100                                                                  
001101 LINKAGE SECTION.                                                 
001102 01  DFHCOMMAREA             PIC X(1024).                         
001103                                                                  
001104*    COPY ELCMSTR.                                                
      *>>((file: ELCMSTR))
000001******************************************************************
000002*                                                                *
000003*                            ELCMSTR.                            *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000005*                            VMOD=2.012                          *
000006*                                                                *
000007*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
000008*                                                                *
000009*   FILE TYPE = VSAM,KSDS                                        *
000010*   RECORD SIZE = 350  RECFORM = FIXED                           *
000011*                                                                *
000012*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
000013*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
000014*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
000015*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
000016*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
000017*                                                 RKP=75,LEN=21  *
000018*                                                                *
000019*   **** NOTE ****                                               *
000020*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
000021*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
000022*                                                                *
000023*   LOG = YES                                                    *
000024*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000025******************************************************************
000026*                   C H A N G E   L O G                           
000027*                                                                 
000028* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.                
000029*-----------------------------------------------------------------
000030*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE            
000031* EFFECTIVE    NUMBER                                             
000032*-----------------------------------------------------------------
000033* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES       
000034* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD    
000035* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR           
000036* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES          
000037* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE      
000038* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS            
000039* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE             
000040******************************************************************
000041 01  CLAIM-MASTER.                                                
000042     12  CL-RECORD-ID                PIC XX.                      
000043         88  VALID-CL-ID         VALUE 'CL'.                      
000044                                                                  
000045     12  CL-CONTROL-PRIMARY.                                      
000046         16  CL-COMPANY-CD           PIC X.                       
000047         16  CL-CARRIER              PIC X.                       
000048         16  CL-CLAIM-NO             PIC X(7).                    
000049         16  CL-CERT-NO.                                          
000050             20  CL-CERT-PRIME       PIC X(10).                   
000051             20  CL-CERT-SFX         PIC X.                       
000052                                                                  
000053     12  CL-CONTROL-BY-NAME.                                      
000054         16  CL-COMPANY-CD-A1        PIC X.                       
000055         16  CL-INSURED-LAST-NAME    PIC X(15).                   
000056         16  CL-INSURED-NAME.                                     
000057             20  CL-INSURED-1ST-NAME PIC X(12).                   
000058             20  CL-INSURED-MID-INIT PIC X.                       
000059                                                                  
000060     12  CL-CONTROL-BY-SSN.                                       
000061         16  CL-COMPANY-CD-A2        PIC X.                       
000062         16  CL-SOC-SEC-NO.                                       
000063             20  CL-SSN-STATE        PIC XX.                      
000064             20  CL-SSN-ACCOUNT      PIC X(6).                    
000065             20  CL-SSN-LN3          PIC X(3).                    
000066                                                                  
000067     12  CL-CONTROL-BY-CERT-NO.                                   
000068         16  CL-COMPANY-CD-A4        PIC X.                       
000069         16  CL-CERT-NO-A4.                                       
000070             20  CL-CERT-A4-PRIME    PIC X(10).                   
000071             20  CL-CERT-A4-SFX      PIC X.                       
000072                                                                  
000073     12  CL-CONTROL-BY-CCN.                                       
000074         16  CL-COMPANY-CD-A5        PIC X.                       
000075         16  CL-CCN-A5.                                           
000076             20  CL-CCN.                                          
000077                 24  CL-CCN-PREFIX-A5 PIC X(4).                   
000078                 24  CL-CCN-PRIME-A5 PIC X(12).                   
000079             20  CL-CCN-FILLER-A5    PIC X(4).                    
000080                                                                  
000081     12  CL-INSURED-PROFILE-DATA.                                 
000082         16  CL-INSURED-BIRTH-DT     PIC XX.                      
000083         16  CL-INSURED-SEX-CD       PIC X.                       
000084             88  INSURED-IS-MALE        VALUE 'M'.                
000085             88  INSURED-IS-FEMALE      VALUE 'F'.                
000086             88  INSURED-SEX-UNKNOWN    VALUE ' '.                
000087         16  CL-INSURED-OCC-CD       PIC X(6).                    
000088         16  FILLER                  PIC X(5).                    
000089                                                                  
000090     12  CL-PROCESSING-INFO.                                      
000091         16  CL-PROCESSOR-ID         PIC X(4).                    
000092         16  CL-CLAIM-STATUS         PIC X.                       
000093             88  CLAIM-IS-OPEN          VALUE 'O'.                
000094             88  CLAIM-IS-CLOSED        VALUE 'C'.                
000095         16  CL-CLAIM-TYPE           PIC X.                       
000096*            88  AH-CLAIM               VALUE 'A'.                
000097*            88  LIFE-CLAIM             VALUE 'L'.                
000098*            88  PROPERTY-CLAIM         VALUE 'P'.                
000099*            88  IUI-CLAIM              VALUE 'I'.                
000100*            88  GAP-CLAIM              VALUE 'G'.                
000101*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.                
000102*            88  OTHER-CLAIM            VALUE 'O'.                
000103         16  CL-CLAIM-PREM-TYPE      PIC X.                       
000104             88  SINGLE-PREMIUM         VALUE '1'.                
000105             88  O-B-COVERAGE           VALUE '2'.                
000106             88  OPEN-END-COVERAGE      VALUE '3'.                
000107         16  CL-INCURRED-DT          PIC XX.                      
000108         16  CL-REPORTED-DT          PIC XX.                      
000109         16  CL-FILE-ESTABLISH-DT    PIC XX.                      
000110         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      
000111         16  CL-LAST-PMT-DT          PIC XX.                      
000112         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        
000113         16  CL-PAID-THRU-DT         PIC XX.                      
000114         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        
000115         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        
000116         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          
000117         16  CL-PMT-CALC-METHOD      PIC X.                       
000118             88  CL-360-DAY-YR          VALUE '1'.                
000119             88  CL-365-DAY-YR          VALUE '2'.                
000120             88  CL-FULL-MONTHS         VALUE '3'.                
000121         16  CL-CAUSE-CD             PIC X(6).                    
000122                                                                  
000123         16  CL-PRIME-CERT-NO.                                    
000124             20  CL-PRIME-CERT-PRIME PIC X(10).                   
000125             20  CL-PRIME-CERT-SFX   PIC X.                       
000126                                                                  
000127         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      
000128             88  CL-CREDIT-CLAIM        VALUE 'CR'.               
000129             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               
000130                                                                  
000131         16  CL-MICROFILM-NO         PIC X(10).                   
000132         16  FILLER REDEFINES CL-MICROFILM-NO.                    
000133             20  CL-BENEFIT-PERIOD   PIC 99.                      
000134             20  FILLER              PIC X(8).                    
000135         16  CL-PROG-FORM-TYPE       PIC X.                       
000136         16  CL-LAST-ADD-ON-DT       PIC XX.                      
000137                                                                  
000138         16  CL-LAST-REOPEN-DT       PIC XX.                      
000139         16  CL-LAST-CLOSE-DT        PIC XX.                      
000140         16  CL-LAST-CLOSE-REASON    PIC X(01).                   
000141             88  FINAL-PAID             VALUE '1'.                
000142             88  CLAIM-DENIED           VALUE '2'.                
000143             88  AUTO-CLOSE             VALUE '3'.                
000144             88  MANUAL-CLOSE           VALUE '4'.                
000145             88  BENEFITS-CHANGED       VALUE 'C'.                
000146             88  SETUP-ERRORS           VALUE 'E'.                
000147         16  CL-ASSOC-CERT-SEQU      PIC S99.                     
000148         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     
000149         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       
000150             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           
000151         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.         
000152         16  FILLER                  PIC X.                       
000153                                                                  
000154     12  CL-CERTIFICATE-DATA.                                     
000155         16  CL-CERT-ORIGIN          PIC X.                       
000156             88  CERT-WAS-ONLINE        VALUE '1'.                
000157             88  CERT-WAS-CREATED       VALUE '2'.                
000158             88  COVERAGE-WAS-ADDED     VALUE '3'.                
000159         16  CL-CERT-KEY-DATA.                                    
000160             20  CL-CERT-CARRIER     PIC X.                       
000161             20  CL-CERT-GROUPING    PIC X(6).                    
000162             20  CL-CERT-STATE       PIC XX.                      
000163             20  CL-CERT-ACCOUNT.                                 
000164                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             
000165                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             
000166             20  CL-CERT-EFF-DT      PIC XX.                      
000167                                                                  
000168     12  CL-STATUS-CONTROLS.                                      
000169         16  CL-PRIORITY-CD          PIC X.                       
000170             88  CONFIDENTIAL-DATA      VALUE '8'.                
000171             88  HIGHEST-PRIORITY       VALUE '9'.                
000172         16  CL-SUPV-ATTN-CD         PIC X.                       
000173             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            
000174             88  SUPV-IS-REQUIRED       VALUE 'Y'.                
000175         16  CL-PURGED-DT            PIC XX.                      
000176         16  CL-RESTORED-DT          PIC XX.                      
000177         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      
000178         16  CL-NEXT-RESEND-DT       PIC XX.                      
000179         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      
000180         16  CL-CRITICAL-PERIOD      PIC 99.                      
000181*        16  FILLER                  PIC XX.                      
000182         16  CL-LAST-MAINT-DT        PIC XX.                      
000183         16  CL-LAST-MAINT-USER      PIC X(4).                    
000184         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        
000185         16  CL-LAST-MAINT-TYPE      PIC X.                       
000186             88  CLAIM-SET-UP           VALUE ' '.                
000187             88  PAYMENT-MADE           VALUE '1'.                
000188             88  LETTER-SENT            VALUE '2'.                
000189             88  MASTER-WAS-ALTERED     VALUE '3'.                
000190             88  MASTER-WAS-RESTORED    VALUE '4'.                
000191             88  INCURRED-DATE-CHANGED  VALUE '5'.                
000192             88  FILE-CONVERTED         VALUE '6'.                
000193             88  CHANGE-OF-BENEFITS     VALUE 'C'.                
000194             88  ERROR-CORRECTION       VALUE 'E'.                
000195         16  CL-RELATED-CLAIM-NO     PIC X(7).                    
000196         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      
000197         16  CL-BENEFICIARY          PIC X(10).                   
000198         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    
000199         16  CL-DENIAL-TYPE          PIC X.                       
000200             88  CL-TYPE-DENIAL          VALUE '1'.               
000201             88  CL-TYPE-RESCISSION      VALUE '2'.               
000202             88  CL-TYPE-REFORMATION     VALUE '3'.               
000203             88  CL-TYPE-REF-TO-RES      VALUE '4'.               
000204             88  CL-TYPE-RECONSIDERED    VALUE '5'.               
000205         16  CL-NO-OF-EXTENSIONS     PIC 99.                      
000206                                                                  
000207         16  filler                  pic x(3).                    
000208*        16  CL-CRIT-PER-RECURRENT   PIC X.                       
000209*        16  CL-CRIT-PER-RTW-MOS     PIC 99.                      
000210*        16  CL-RTW-DT               PIC XX.                      
000211                                                                  
000212     12  CL-TRAILER-CONTROLS.                                     
000213         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          
000214             88  CL-1ST-TRL-AVAIL       VALUE +4095.              
000215             88  CL-LAST-TRL-AVAIL      VALUE +100.               
000216             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 
000217         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          
000218         16  FILLER                  PIC XX.                      
000219         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          
000220         16  CL-ADDRESS-TRAILER-CNT.                              
000221             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  
000222                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          
000223             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  
000224                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          
000225             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  
000226                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          
000227             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  
000228                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          
000229             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  
000230                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          
000231             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  
000232                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          
000233             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  
000234                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          
000235                                                                  
000236     12  CL-CV-REFERENCE-NO.                                      
000237         16  CL-CV-REFNO-PRIME       PIC X(18).                   
000238         16  CL-CV-REFNO-SFX         PIC XX.                      
000239                                                                  
000240     12  CL-FILE-LOCATION            PIC X(4).                    
000241                                                                  
000242     12  CL-PROCESS-ERRORS.                                       
000243         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          
000244             88  NO-FATAL-ERRORS        VALUE ZERO.               
000245         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          
000246             88  NO-FORCABLE-ERRORS     VALUE ZERO.               
000247                                                                  
000248     12  CL-PRODUCT-CD               PIC X.                       
000249                                                                  
000250     12  CL-CURRENT-KEY-DATA.                                     
000251         16  CL-CURRENT-CARRIER      PIC X.                       
000252         16  CL-CURRENT-GROUPING     PIC X(6).                    
000253         16  CL-CURRENT-STATE        PIC XX.                      
000254         16  CL-CURRENT-ACCOUNT      PIC X(10).                   
000255                                                                  
000256     12  CL-ASSOCIATES               PIC X.                       
000257         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                
000258         88  CL-ASSOC-INTERFACE         VALUE 'I'.                
000259         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                
000260         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                
000261                                                                  
000262     12  CL-ACTIVITY-CODE            PIC 99.                      
000263     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      
000264     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    
000265                                                                  
000266     12  CL-LAPSE-REPORT-CODE        PIC 9.                       
000267     12  CL-LAG-REPORT-CODE          PIC 9.                       
000268     12  CL-LOAN-TYPE                PIC XX.                      
000269     12  CL-LEGAL-STATE              PIC XX.                      
000270                                                                  
000271     12  CL-YESNOSW                  PIC X.                       
000272     12  CL-ACCIDENT-CLAIM-SW        PIC X.                       
000273         88  CL-ACCIDENT-NOT-SET           VALUE ' '.             
000274         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.             
000275         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.             
000276     12  cl-insured-type             pic x.                       
000277         88  cl-claim-on-primary         value 'P'.               
000278         88  cl-claim-on-co-borrower     value 'C'.               
000279     12  cl-benefit-expiration-dt    PIC XX.                      
      *<<((file: ELCMSTR))
001105     EJECT                                                        
001106*    COPY ELCCNTL.                                                
      *>>((file: ELCCNTL))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCCNTL.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000006*                            VMOD=2.059                          *
000007*                                                                *
000008*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
000009*                                                                *
000010*   FILE TYPE = VSAM,KSDS                                        *
000011*   RECORD SIZE = 750  RECFORM = FIXED                           *
000012*                                                                *
000013*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
000014*       ALTERNATE INDEX = NONE                                   *
000015*                                                                *
000016*   LOG = YES                                                    *
000017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000018******************************************************************
000019*                   C H A N G E   L O G                           
000020*                                                                 
000021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.                
000022*-----------------------------------------------------------------
000023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE            
000024* EFFECTIVE    NUMBER                                             
000025*-----------------------------------------------------------------
000026* 082503                   PEMA  ADD BENEFIT GROUP                
000027* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING          
000028* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION    
000029* 092705    2005050300006  PEMA  ADD SPP LEASES                   
000030* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4             
000031* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
000032* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
000033* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
000034* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
000035* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY     
000036* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND             
000037* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS         
000038* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5             
000039* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES          
000040* 102717  CR2017062000003  PEMA  COMM CAP CHANGES                 
000041******************************************************************
000042*                                                                 
000043 01  CONTROL-FILE.                                                
000044     12  CF-RECORD-ID                       PIC XX.               
000045         88  VALID-CF-ID                        VALUE 'CF'.       
000046                                                                  
000047     12  CF-CONTROL-PRIMARY.                                      
000048         16  CF-COMPANY-ID                  PIC XXX.              
000049         16  CF-RECORD-TYPE                 PIC X.                
000050             88  CF-COMPANY-MASTER              VALUE '1'.        
000051             88  CF-PROCESSOR-MASTER            VALUE '2'.        
000052             88  CF-STATE-MASTER                VALUE '3'.        
000053             88  CF-LF-BENEFIT-MASTER           VALUE '4'.        
000054             88  CF-AH-BENEFIT-MASTER           VALUE '5'.        
000055             88  CF-CARRIER-MASTER              VALUE '6'.        
000056             88  CF-MORTALITY-MASTER            VALUE '7'.        
000057             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.        
000058             88  CF-TERMINAL-MASTER             VALUE '9'.        
000059             88  CF-AH-EDIT-MASTER              VALUE 'A'.        
000060             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.        
000061             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.        
000062             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.        
000063             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.        
000064             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.        
000065             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.        
000066             88  CF-REMINDERS-MASTER            VALUE 'R'.        
000067             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.        
000068         16  CF-ACCESS-CD-GENL              PIC X(4).             
000069         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL. 
000070             20  CF-PROCESSOR               PIC X(4).             
000071         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.    
000072             20  CF-STATE-CODE              PIC XX.               
000073             20  FILLER                     PIC XX.               
000074         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.  
000075             20  FILLER                     PIC XX.               
000076             20  CF-HI-BEN-IN-REC           PIC XX.               
000077         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.  
000078             20  FILLER                     PIC XXX.              
000079             20  CF-CARRIER-CNTL            PIC X.                
000080         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.  
000081             20  FILLER                     PIC XX.               
000082             20  CF-HI-TYPE-IN-REC          PIC 99.               
000083         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.  
000084             20  CF-CRDB-TABLE-INDICATOR    PIC X.                
000085                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.        
000086             20  CF-CRDB-BENEFIT-TYPE       PIC X.                
000087             20  CF-CRDB-WAITING-PERIOD     PIC XX.               
000088         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.  
000089             20  FILLER                     PIC X.                
000090             20  CF-CUSTOM-REPORT-NO        PIC 999.              
000091         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.    
000092             20  FILLER                     PIC XX.               
000093             20  CF-MORTGAGE-PLAN           PIC XX.               
000094         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.     
000095                                                                  
000096     12  CF-LAST-MAINT-DT                   PIC XX.               
000097     12  CF-LAST-MAINT-BY                   PIC X(4).             
000098     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.   
000099                                                                  
000100     12  CF-RECORD-BODY                     PIC X(728).           
000101                                                                  
000102                                                                  
000103****************************************************************  
000104*             COMPANY MASTER RECORD                            *  
000105****************************************************************  
000106                                                                  
000107     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.        
000108         16  CF-COMPANY-ADDRESS.                                  
000109             20  CF-CL-MAIL-TO-NAME         PIC X(30).            
000110             20  CF-CL-IN-CARE-OF           PIC X(30).            
000111             20  CF-CL-ADDR-LINE-1          PIC X(30).            
000112             20  CF-CL-ADDR-LINE-2          PIC X(30).            
000113             20  CF-CL-CITY-STATE           PIC X(30).            
000114             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.   
000115             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.   
000116         16  CF-COMPANY-CD                  PIC X.                
000117         16  CF-COMPANY-PASSWORD            PIC X(8).             
000118         16  CF-SECURITY-OPTION             PIC X.                
000119             88  ALL-SECURITY                   VALUE '1'.        
000120             88  COMPANY-VERIFY                 VALUE '2'.        
000121             88  PROCESSOR-VERIFY               VALUE '3'.        
000122             88  NO-SECURITY                    VALUE '4'.        
000123             88  ALL-BUT-TERM                   VALUE '5'.        
000124         16  CF-CARRIER-CONTROL-LEVEL       PIC X.                
000125             88  USE-ACTUAL-CARRIER             VALUE SPACE.      
000126         16  CF-LGX-INTERFACE-CNTL          PIC X.                
000127             88  LGX-TIME-SHR-COMPANY           VALUE '1'.        
000128         16  CF-INFORCE-LOCATION            PIC X.                
000129             88  CERTS-ARE-ONLINE               VALUE '1'.        
000130             88  CERTS-ARE-OFFLINE              VALUE '2'.        
000131             88  NO-CERTS-AVAILABLE             VALUE '3'.        
000132         16  CF-LOWER-CASE-LETTERS          PIC X.                
000133         16  CF-CERT-ACCESS-CONTROL         PIC X.                
000134             88  CF-ST-ACCNT-CNTL               VALUE ' '.        
000135             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.        
000136             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.        
000137             88  CF-ACCNT-CNTL                  VALUE '3'.        
000138             88  CF-CARR-ACCNT-CNTL             VALUE '4'.        
000139                                                                  
000140         16  CF-FORMS-PRINTER-ID            PIC X(4).             
000141         16  CF-CHECK-PRINTER-ID            PIC X(4).             
000142                                                                  
000143         16  CF-LGX-CREDIT-USER             PIC X.                
000144             88  CO-IS-NOT-USER                 VALUE 'N'.        
000145             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.        
000146                                                                  
000147         16 CF-CREDIT-CALC-CODES.                                 
000148             20  CF-CR-REM-TERM-CALC PIC X.                       
000149               88  CR-EARN-AFTER-15TH           VALUE '1'.        
000150               88  CR-EARN-ON-HALF-MO           VALUE '2'.        
000151               88  CR-EARN-ON-1ST-DAY           VALUE '3'.        
000152               88  CR-EARN-ON-FULL-MO           VALUE '4'.        
000153               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.        
000154               88  CR-EARN-AFTER-14TH           VALUE '6'.        
000155               88  CR-EARN-AFTER-16TH           VALUE '7'.        
000156             20  CF-CR-R78-METHOD           PIC X.                
000157               88  USE-TERM-PLUS-ONE            VALUE SPACE.      
000158               88  DONT-USE-PLUS-ONE            VALUE '1'.        
000159                                                                  
000160         16  CF-CLAIM-CONTROL-COUNTS.                             
000161             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.     
000162                 88  CO-CLM-COUNT-RESET         VALUE +99999.     
000163                                                                  
000164             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.     
000165                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.    
000166                                                                  
000167             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.     
000168                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.   
000169                                                                  
000170             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.     
000171                 88  CO-QUE-COUNT-RESET         VALUE +9999999.   
000172                                                                  
000173         16  CF-CURRENT-MONTH-END           PIC XX.               
000174                                                                  
000175         16  CF-CO-CALC-QUOTE-TOLERANCE.                          
000176             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3. 
000177             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3. 
000178             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3. 
000179             20  CF-CO-CLAIM-REJECT-SW      PIC X.                
000180                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.      
000181                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.        
000182             20  CF-CO-PREM-REJECT-SW       PIC X.                
000183                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.      
000184                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.        
000185             20  CF-CO-REF-REJECT-SW        PIC X.                
000186                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.      
000187                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.        
000188                                                                  
000189         16  CF-CO-REPORTING-DT             PIC XX.               
000190         16  CF-CO-REPORTING-MONTH-DT       PIC XX.               
000191         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.                
000192           88  CF-CO-NOT-MONTH-END              VALUE SPACES.     
000193           88  CF-CO-MONTH-END                  VALUE '1'.        
000194                                                                  
000195         16  CF-LGX-CLAIM-USER              PIC X.                
000196             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.        
000197             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.        
000198                                                                  
000199         16  CF-CREDIT-EDIT-CONTROLS.                             
000200             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3. 
000201             20  CF-MIN-AGE                 PIC 99.               
000202             20  CF-DEFAULT-AGE             PIC 99.               
000203             20  CF-MIN-TERM                PIC S999      COMP-3. 
000204             20  CF-MAX-TERM                PIC S999      COMP-3. 
000205             20  CF-DEFAULT-SEX             PIC X.                
000206             20  CF-JOINT-AGE-INPUT         PIC X.                
000207                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.        
000208             20  CF-BIRTH-DATE-INPUT        PIC X.                
000209                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.        
000210             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.                
000211                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.        
000212                 88  CF-ZERO-CARRIER            VALUE '1'.        
000213                 88  CF-ZERO-GROUPING           VALUE '2'.        
000214                 88  CF-ZERO-CAR-GROUP          VALUE '3'.        
000215             20  CF-EDIT-SW                 PIC X.                
000216                 88  CF-START-EDIT-TONIGHT      VALUE '1'.        
000217             20  CF-EDIT-RESTART-BATCH      PIC X(6).             
000218             20  CF-CR-PR-METHOD            PIC X.                
000219               88  USE-NORMAL-PR-METHOD         VALUE SPACE.      
000220               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.        
000221             20  FILLER                     PIC X.                
000222                                                                  
000223         16  CF-CREDIT-MISC-CONTROLS.                             
000224             20  CF-REIN-TABLE-SW           PIC X.                
000225                 88 REIN-TABLES-ARE-USED        VALUE '1'.        
000226             20  CF-COMP-TABLE-SW           PIC X.                
000227                 88 COMP-TABLES-ARE-USED        VALUE '1'.        
000228             20  CF-EXPERIENCE-RETENTION-AGE                      
000229                                            PIC S9        COMP-3. 
000230             20  CF-CONVERSION-DT           PIC XX.               
000231             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3. 
000232             20  CF-RUN-FREQUENCY-SW        PIC X.                
000233                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.      
000234                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.        
000235                                                                  
000236             20  CF-CR-CHECK-NO-CONTROL.                          
000237                 24  CF-CR-CHECK-NO-METHOD    PIC X.              
000238                     88  CR-CHECK-NO-MANUAL       VALUE '1'.      
000239                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.      
000240                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.      
000241                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.   
000242                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.  
000243                                                                  
000244                 24  CF-CR-CHECK-COUNT       REDEFINES            
000245                     CF-CR-CHECK-COUNTER      PIC X(4).           
000246                                                                  
000247                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.    
000248                     88  CR-QUE-COUNT-RESET      VALUE +9999999.  
000249                                                                  
000250                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES            
000251                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).           
000252                 24  CF-MAIL-PROCESSING       PIC X.              
000253                     88  MAIL-PROCESSING          VALUE 'Y'.      
000254                                                                  
000255         16  CF-MISC-SYSTEM-CONTROL.                              
000256             20  CF-SYSTEM-C                 PIC X.               
000257                 88  CONFIRMATION-SYS-USED       VALUE '1'.       
000258             20  CF-SYSTEM-D                 PIC X.               
000259                 88  DAILY-BILL-SYS-USED         VALUE '1'.       
000260             20  CF-SOC-SEC-NO-SW            PIC X.               
000261                 88  SOC-SEC-NO-USED             VALUE '1'.       
000262             20  CF-MEMBER-NO-SW             PIC X.               
000263                 88  MEMBER-NO-USED              VALUE '1'.       
000264             20  CF-TAX-ID-NUMBER            PIC X(11).           
000265             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.      
000266             20  CF-PAYMENT-APPROVAL-SW      PIC X.               
000267                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.   
000268                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.   
000269                 88  CF-ALL-APPROVED             VALUE 'Y'.       
000270                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.       
000271             20  CF-SYSTEM-E                 PIC X.               
000272                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.       
000273                                                                  
000274         16  CF-LGX-LIFE-USER               PIC X.                
000275             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.        
000276             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.        
000277                                                                  
000278         16  CF-CR-MONTH-END-DT             PIC XX.               
000279                                                                  
000280         16  CF-FILE-MAINT-DATES.                                 
000281             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.     
000282                 88  CF-LAST-BATCH-RESET        VALUE +999999.    
000283             20  CF-LAST-BATCH       REDEFINES                    
000284                 CF-LAST-BATCH-NO               PIC X(4).         
000285             20  CF-RATES-FILE-MAINT-DT         PIC XX.           
000286             20  CF-RATES-FILE-CREATE-DT        PIC XX.           
000287             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.           
000288             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.           
000289             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.           
000290             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.           
000291             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.           
000292             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.           
000293             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.           
000294             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.           
000295                                                                  
000296         16  CF-NEXT-COMPANY-ID             PIC XXX.              
000297         16  FILLER                         PIC X.                
000298                                                                  
000299         16  CF-ALT-MORT-CODE               PIC X(4).             
000300         16  CF-MEMBER-CAPTION              PIC X(10).            
000301                                                                  
000302         16  CF-LIFE-ACCESS-CONTROL         PIC X.                
000303             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.        
000304             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.        
000305             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.        
000306             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.        
000307             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.        
000308                                                                  
000309         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.       
000310                                                                  
000311         16  CF-LIFE-OVERRIDE-L1            PIC X.                
000312         16  CF-LIFE-OVERRIDE-L2            PIC XX.               
000313         16  CF-LIFE-OVERRIDE-L6            PIC X(6).             
000314         16  CF-LIFE-OVERRIDE-L12           PIC X(12).            
000315                                                                  
000316         16  CF-AH-OVERRIDE-L1              PIC X.                
000317         16  CF-AH-OVERRIDE-L2              PIC XX.               
000318         16  CF-AH-OVERRIDE-L6              PIC X(6).             
000319         16  CF-AH-OVERRIDE-L12             PIC X(12).            
000320                                                                  
000321         16  CF-REPORT-CD1-CAPTION          PIC X(10).            
000322         16  CF-REPORT-CD2-CAPTION          PIC X(10).            
000323                                                                  
000324         16  CF-CLAIM-CUTOFF-DATE           PIC XX.               
000325         16  CF-AR-LAST-EL860-DT            PIC XX.               
000326         16  CF-MP-MONTH-END-DT             PIC XX.               
000327                                                                  
000328         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.               
000329         16  CF-CLAIM-PAID-THRU-TO          PIC X.                
000330             88  CF-CLAIM-PAID-TO               VALUE '1'.        
000331                                                                  
000332         16  CF-AR-MONTH-END-DT             PIC XX.               
000333                                                                  
000334         16  CF-CRDTCRD-USER                PIC X.                
000335             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.        
000336             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.        
000337                                                                  
000338         16  CF-CC-MONTH-END-DT             PIC XX.               
000339                                                                  
000340         16  CF-PRINT-ADDRESS-LABELS        PIC X.                
000341                                                                  
000342         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.                
000343             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.    
000344             88  CF-USE-ALL-AGE-LAST            VALUE '2'.        
000345             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.        
000346         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3. 
000347         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3. 
000348         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3. 
000349         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.               
000350             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.       
000351             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.   
000352         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3. 
000353         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3. 
000354         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.               
000355             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.       
000356         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.               
000357                                                                  
000358         16  CF-CL-ZIP-CODE.                                      
000359             20  CF-CL-ZIP-PRIME.                                 
000360                 24  CF-CL-ZIP-1ST          PIC X.                
000361                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'. 
000362                 24  FILLER                 PIC X(4).             
000363             20  CF-CL-ZIP-PLUS4            PIC X(4).             
000364         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE. 
000365             20  CF-CL-CAN-POSTAL-1         PIC XXX.              
000366             20  CF-CL-CAN-POSTAL-2         PIC XXX.              
000367             20  FILLER                     PIC XXX.              
000368                                                                  
000369         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.  
000370         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.  
000371         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.  
000372         16  CF-CO-OPTION-START-DATE        PIC XX.               
000373         16  CF-REM-TRM-CALC-OPTION         PIC X.                
000374           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'     
000375                                                      '3' '4'.    
000376           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.    
000377           88  CF-30-DAY-MONTH                  VALUE '1' '3'.    
000378           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.        
000379           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.        
000380           88  CF-EXT-30-DAY-MONTH              VALUE '3'.        
000381           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.        
000382                                                                  
000383         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3. 
000384                                                                  
000385         16  CF-PAYMENT-APPROVAL-LEVELS.                          
000386             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.   
000387             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.   
000388             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.   
000389             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.   
000390             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.   
000391             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.   
000392                                                                  
000393         16  CF-END-USER-REPORTING-USER     PIC X.                
000394             88  CO-NO-END-USER-REPORTING       VALUE 'N'.        
000395             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.        
000396                                                                  
000397         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.                
000398             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.        
000399             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.        
000400                                                                  
000401         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.               
000402                                                                  
000403         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.    
000404         16  FILLER                         PIC X.                
000405                                                                  
000406         16  CF-CREDIT-ARCHIVE-CNTL.                              
000407             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.    
000408             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.    
000409             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.    
000410                                                                  
000411         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.                
000412                                                                  
000413         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.                
000414             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.        
000415             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.        
000416                                                                  
000417         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.                
000418             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.        
000419             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.        
000420                                                                  
000421         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.               
000422                                                                  
000423         16  CF-CO-ACH-ID-CODE              PIC  X.               
000424             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.        
000425             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.        
000426             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.        
000427         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).            
000428         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).            
000429         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).            
000430         16  CF-CO-ACH-ADMIN-NO             PIC X(09).            
000431         16  CF-CO-ACH-RECV-NAME            PIC X(23).            
000432         16  CF-CO-ACH-RECV-NO              PIC X(08).            
000433         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).            
000434         16  CF-CO-ACH-COMPANY-ID           PIC X(09).            
000435         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.       
000436                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.    
000437         16  CF-CO-ACH-TRACE-SPACE REDEFINES                      
000438                 CF-CO-ACH-TRACE-NO         PIC X(4).             
000439                                                                  
000440         16  CF-CO-OVER-SHORT.                                    
000441             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3. 
000442             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3. 
000443                                                                  
000444*         16  FILLER                         PIC X(102).          
000445         16  CF-PAYMENT-APPROVAL-LEVELS-2.                        
000446             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.   
000447             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.   
000448                                                                  
000449         16  CF-AH-APPROVAL-DAYS.                                 
000450             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.    
000451             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.    
000452             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.    
000453             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.    
000454                                                                  
000455         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.    
000456                                                                  
000457         16  CF-APPROV-LEV-5.                                     
000458             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.   
000459             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.   
000460             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.   
000461                                                                  
000462         16  FILLER                         PIC X(68).            
000463****************************************************************  
000464*             PROCESSOR/USER RECORD                            *  
000465****************************************************************  
000466                                                                  
000467     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.      
000468         16  CF-PROCESSOR-NAME              PIC X(30).            
000469         16  CF-PROCESSOR-PASSWORD          PIC X(11).            
000470         16  CF-PROCESSOR-TITLE             PIC X(26).            
000471         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.                
000472                 88  MESSAGE-YES                VALUE 'Y'.        
000473                 88  MESSAGE-NO                 VALUE ' ' 'N'.    
000474                                                                  
000475*****************************************************             
000476****  OCCURRENCE (1) CREDIT APPLICATIONS         ****             
000477****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****             
000478****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****             
000479****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****             
000480*****************************************************             
000481                                                                  
000482         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.                 
000483             20  CF-ADMINISTRATION-CONTROLS PIC XX.               
000484             20  CF-APPLICATION-FORCE       PIC X.                
000485             20  CF-INDIVIDUAL-APP.                               
000486                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.           
000487                     28  CF-BROWSE-APP      PIC X.                
000488                     28  CF-UPDATE-APP      PIC X.                
000489                                                                  
000490         16  CF-CURRENT-TERM-ON             PIC X(4).             
000491         16  CF-PROCESSOR-LIMITS-CLAIMS.                          
000492             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3. 
000493             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3. 
000494             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3. 
000495             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3. 
000496             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3. 
000497             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3. 
000498             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3. 
000499         16  CF-PROCESSOR-CARRIER           PIC X.                
000500             88  NO-CARRIER-SECURITY            VALUE ' '.        
000501         16  CF-PROCESSOR-ACCOUNT           PIC X(10).            
000502             88  NO-ACCOUNT-SECURITY            VALUE SPACES.     
000503         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.                
000504             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.        
000505         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.                
000506             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.        
000507                                                                  
000508         16  CF-PROC-SYS-ACCESS-SW.                               
000509             20  CF-PROC-CREDIT-CLAIMS-SW.                        
000510                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.            
000511                     88  ACCESS-TO-CREDIT           VALUE 'Y'.    
000512                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.            
000513                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.    
000514             20  CF-PROC-CREDIT-CLAIMS   REDEFINES                
000515                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.           
000516                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.   
000517             20  CF-PROC-LIFE-GNRLDGR-SW.                         
000518                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.            
000519                     88  ACCESS-TO-LIFE             VALUE 'Y'.    
000520                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.            
000521                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.    
000522             20  CF-PROC-LIFE-GNRLDGR    REDEFINES                
000523                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.           
000524                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.   
000525         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES                
000526             CF-PROC-SYS-ACCESS-SW              PIC X(4).         
000527             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'. 
000528         16  CF-PROCESSOR-PRINTER               PIC X(4).         
000529                                                                  
000530         16  CF-APPROVAL-LEVEL                  PIC X.            
000531             88  APPROVAL-LEVEL-1                   VALUE '1'.    
000532             88  APPROVAL-LEVEL-2                   VALUE '2'.    
000533             88  APPROVAL-LEVEL-3                   VALUE '3'.    
000534             88  APPROVAL-LEVEL-4                   VALUE '4'.    
000535             88  APPROVAL-LEVEL-5                   VALUE '5'.    
000536                                                                  
000537         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3. 
000538                                                                  
000539         16  CF-LANGUAGE-TYPE                   PIC X.            
000540             88  CF-LANG-IS-ENG                     VALUE 'E'.    
000541             88  CF-LANG-IS-FR                      VALUE 'F'.    
000542                                                                  
000543         16  CF-CSR-IND                         PIC X.            
000544         16  FILLER                             PIC X(239).       
000545                                                                  
000546****************************************************************  
000547*             PROCESSOR/REMINDERS RECORD                       *  
000548****************************************************************  
000549                                                                  
000550     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.    
000551         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.              
000552             20  CF-START-REMIND-DT         PIC XX.               
000553             20  CF-END-REMIND-DT           PIC XX.               
000554             20  CF-REMINDER-TEXT           PIC X(50).            
000555         16  FILLER                         PIC X(296).           
000556                                                                  
000557                                                                  
000558****************************************************************  
000559*             STATE MASTER RECORD                              *  
000560****************************************************************  
000561                                                                  
000562     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.          
000563         16  CF-STATE-ABBREVIATION          PIC XX.               
000564         16  CF-STATE-NAME                  PIC X(25).            
000565         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3. 
000566         16  CF-ST-CALC-QUOTE-TOLERANCE.                          
000567             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3. 
000568             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3. 
000569             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3. 
000570             20  CF-ST-CLAIM-REJECT-SW      PIC X.                
000571                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.      
000572                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.        
000573             20  CF-ST-PREM-REJECT-SW       PIC X.                
000574                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.      
000575                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.        
000576             20  CF-ST-REF-REJECT-SW        PIC X.                
000577                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.      
000578                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.        
000579         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3. 
000580         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3. 
000581         16  CF-ST-REFUND-RULES.                                  
000582             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
000583             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.               
000584             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.               
000585         16  CF-ST-FST-PMT-EXTENSION.                             
000586             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.              
000587             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.                
000588                 88  CF-ST-EXT-NO-CHG           VALUE ' '.        
000589                 88  CF-ST-EXT-CHG-LF           VALUE '1'.        
000590                 88  CF-ST-EXT-CHG-AH           VALUE '2'.        
000591                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.        
000592         16  CF-ST-STATE-CALL.                                    
000593             20  CF-ST-CALL-UNEARNED        PIC X.                
000594             20  CF-ST-CALL-RPT-CNTL        PIC X.                
000595             20  CF-ST-CALL-RATE-DEV        PIC XXX.              
000596         16  CF-REPLACEMENT-LAW-SW          PIC X.                
000597             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.        
000598             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.        
000599         16  CF-REPLACEMENT-LETTER          PIC X(4).             
000600         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.   
000601         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.   
000602         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.   
000603         16  CF-ST-SPLIT-PAYMENT            PIC X.                
000604         16  FILLER                         PIC X.                
000605         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.              
000606             20  CF-ST-BENEFIT-CD           PIC XX.               
000607             20  CF-ST-BENEFIT-KIND         PIC X.                
000608                 88  CF-ST-LIFE-KIND            VALUE 'L'.        
000609                 88  CF-ST-AH-KIND              VALUE 'A'.        
000610             20  CF-ST-REM-TERM-CALC        PIC X.                
000611                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.      
000612                 88  ST-EARN-AFTER-15TH         VALUE '1'.        
000613                 88  ST-EARN-ON-HALF-MO         VALUE '2'.        
000614                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.        
000615                 88  ST-EARN-ON-FULL-MO         VALUE '4'.        
000616                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.        
000617                 88  ST-EARN-AFTER-14TH         VALUE '6'.        
000618                 88  ST-EARN-AFTER-16TH         VALUE '7'.        
000619                                                                  
000620             20  CF-ST-REFUND-CALC          PIC X.                
000621                 88  ST-REFUND-NOT-USED         VALUE SPACE.      
000622                 88  ST-REFD-BY-R78             VALUE '1'.        
000623                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.        
000624                 88  ST-REFD-AS-CALIF           VALUE '3'.        
000625                 88  ST-REFD-AS-TEXAS           VALUE '4'.        
000626                 88  ST-REFD-IS-NET-PAY         VALUE '5'.        
000627                 88  ST-REFD-ANTICIPATION       VALUE '6'.        
000628                 88  ST-REFD-UTAH               VALUE '7'.        
000629                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.        
000630                 88  ST-REFD-REG-BALLOON        VALUE 'B'.        
000631                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.        
000632                                                                  
000633             20  CF-ST-EARNING-CALC         PIC X.                
000634                 88  ST-EARNING-NOT-USED        VALUE SPACE.      
000635                 88  ST-EARN-BY-R78             VALUE '1'.        
000636                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.        
000637                 88  ST-EARN-AS-CALIF           VALUE '3'.        
000638                 88  ST-EARN-AS-TEXAS           VALUE '4'.        
000639                 88  ST-EARN-IS-NET-PAY         VALUE '5'.        
000640                 88  ST-EARN-ANTICIPATION       VALUE '6'.        
000641                 88  ST-EARN-MEAN               VALUE '8'.        
000642                 88  ST-EARN-REG-BALLOON        VALUE 'B'.        
000643                                                                  
000644             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.                
000645                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.      
000646                 88  ST-OVRD-BY-R78             VALUE '1'.        
000647                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.        
000648                 88  ST-OVRD-AS-CALIF           VALUE '3'.        
000649                 88  ST-OVRD-AS-TEXAS           VALUE '4'.        
000650                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.        
000651                 88  ST-OVRD-ANTICIPATION       VALUE '6'.        
000652                 88  ST-OVRD-MEAN               VALUE '8'.        
000653                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.        
000654             20  cf-st-extra-periods        pic 9.                
000655*            20  FILLER                     PIC X.                
000656                                                                  
000657         16  CF-ST-COMMISSION-CAPS.                               
000658             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.   
000659             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.   
000660             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.   
000661             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.   
000662         16  CF-COMM-CAP-LIMIT-TO           PIC X.                
000663                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.        
000664                 88  ST-LIMIT-TO-GA             VALUE 'G'.        
000665                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.        
000666                                                                  
000667         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.   
000668                                                                  
000669         16  CF-ST-STATUTORY-INTEREST.                            
000670             20  CF-ST-STAT-DATE-FROM       PIC X.                
000671                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.        
000672                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.        
000673             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.               
000674             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.   
000675             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.   
000676             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.   
000677             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.   
000678                                                                  
000679         16  CF-ST-OVER-SHORT.                                    
000680             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.   
000681             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.   
000682                                                                  
000683         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.   
000684                                                                  
000685         16  CF-ST-RT-CALC                  PIC X.                
000686                                                                  
000687         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.   
000688         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.   
000689         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.   
000690         16  CF-ST-RF-LR-CALC               PIC X.                
000691         16  CF-ST-RF-LL-CALC               PIC X.                
000692         16  CF-ST-RF-LN-CALC               PIC X.                
000693         16  CF-ST-RF-AH-CALC               PIC X.                
000694         16  CF-ST-RF-CP-CALC               PIC X.                
000695*        16  FILLER                         PIC X(206).           
000696*CIDMOD         16  FILLER                         PIC X(192).    
000697         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.     
000698             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.       
000699         16  CF-ST-REF-AH-DEATH-IND         PIC X.                
000700         16  CF-ST-VFY-2ND-BENE             PIC X.                
000701         16  CF-ST-CAUSAL-STATE             PIC X.                
000702         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.                
000703         16  CF-ST-EXTRA-PAYMENTS           PIC 9.                
000704         16  CF-ST-AGENT-SIG-EDIT           PIC X.                
000705             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.          
000706         16  CF-ST-NET-ONLY-STATE           PIC X.                
000707             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.          
000708         16  cf-commission-cap-required     pic x.                
000709         16  CF-ST-GA-COMMISSION-CAPS.                            
000710             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.   
000711             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.   
000712             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.   
000713             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.   
000714         16  CF-ST-TOT-COMMISSION-CAPS.                           
000715             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.   
000716             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.   
000717             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.   
000718             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.   
000719         16  FILLER                         PIC X(156).           
000720                                                                  
000721****************************************************************  
000722*             BENEFIT MASTER RECORD                            *  
000723****************************************************************  
000724                                                                  
000725     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.        
000726         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.                 
000727             20  CF-BENEFIT-CODE            PIC XX.               
000728             20  CF-BENEFIT-NUMERIC  REDEFINES                    
000729                 CF-BENEFIT-CODE            PIC XX.               
000730             20  CF-BENEFIT-ALPHA           PIC XXX.              
000731             20  CF-BENEFIT-DESCRIP         PIC X(10).            
000732             20  CF-BENEFIT-COMMENT         PIC X(10).            
000733                                                                  
000734             20  CF-LF-COVERAGE-TYPE        PIC X.                
000735                 88  CF-REDUCING                VALUE 'R'.        
000736                 88  CF-LEVEL                   VALUE 'L' 'P'.    
000737                                                                  
000738             20  CF-SPECIAL-CALC-CD         PIC X.                
000739                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.        
000740                 88  CF-NP-0-MO-INT             VALUE 'A'.        
000741                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.        
000742                 88  CF-CRITICAL-PERIOD         VALUE 'C'.        
000743                 88  CF-TERM-IN-DAYS            VALUE 'D'.        
000744                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.        
000745                 88  CF-FARM-PLAN               VALUE 'F'.        
000746                 88  CF-RATE-AS-STANDARD        VALUE 'G'.        
000747                 88  CF-2-MTH-INTEREST          VALUE 'I'.        
000748                 88  CF-3-MTH-INTEREST          VALUE 'J'.        
000749                 88  CF-4-MTH-INTEREST          VALUE 'K'.        
000750                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.        
000751                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.        
000752                 88  CF-PRUDENTIAL              VALUE 'P'.        
000753                 88  CF-OUTSTANDING-BAL         VALUE 'O'.        
000754                 88  CF-TRUNCATED-LIFE          VALUE 'T'.        
000755                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.        
000756                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.        
000757                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.        
000758                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.        
000759                                                                  
000760             20  CF-JOINT-INDICATOR         PIC X.                
000761                 88  CF-JOINT-COVERAGE          VALUE 'J'.        
000762                                                                  
000763*            20  FILLER                     PIC X(12).            
000764             20  cf-maximum-benefits        pic s999 comp-3.      
000765             20  FILLER                     PIC X(09).            
000766             20  CF-BENEFIT-CATEGORY        PIC X.                
000767             20  CF-LOAN-TYPE               PIC X(8).             
000768                                                                  
000769             20  CF-CO-REM-TERM-CALC        PIC X.                
000770                 88  CO-EARN-AFTER-15TH         VALUE '1'.        
000771                 88  CO-EARN-ON-HALF-MO         VALUE '2'.        
000772                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.        
000773                 88  CO-EARN-ON-FULL-MO         VALUE '4'.        
000774                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.        
000775                                                                  
000776             20  CF-CO-EARNINGS-CALC        PIC X.                
000777                 88  CO-EARN-BY-R78             VALUE '1'.        
000778                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.        
000779                 88  CO-EARN-AS-CALIF           VALUE '3'.        
000780                 88  CO-EARN-AS-TEXAS           VALUE '4'.        
000781                 88  CO-EARN-IS-NET-PAY         VALUE '5'.        
000782                 88  CO-EARN-ANTICIPATION       VALUE '6'.        
000783                 88  CO-EARN-AS-MEAN            VALUE '8'.        
000784                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.        
000785                                                                  
000786             20  CF-CO-REFUND-CALC          PIC X.                
000787                 88  CO-REFUND-NOT-USED         VALUE SPACE.      
000788                 88  CO-REFD-BY-R78             VALUE '1'.        
000789                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.        
000790                 88  CO-REFD-AS-CALIF           VALUE '3'.        
000791                 88  CO-REFD-AS-TEXAS           VALUE '4'.        
000792                 88  CO-REFD-IS-NET-PAY         VALUE '5'.        
000793                 88  CO-REFD-ANTICIPATION       VALUE '6'.        
000794                 88  CO-REFD-MEAN               VALUE '8'.        
000795                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.        
000796                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.        
000797                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.        
000798                                                                  
000799             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.                
000800                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.      
000801                 88  CO-OVRD-BY-R78             VALUE '1'.        
000802                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.        
000803                 88  CO-OVRD-AS-CALIF           VALUE '3'.        
000804                 88  CO-OVRD-AS-TEXAS           VALUE '4'.        
000805                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.        
000806                 88  CO-OVRD-ANTICIPATION       VALUE '6'.        
000807                 88  CO-OVRD-MEAN               VALUE '8'.        
000808                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.        
000809                                                                  
000810             20  CF-CO-BEN-I-G-CD           PIC X.                
000811                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.      
000812                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.        
000813                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.        
000814                                                                  
000815         16  FILLER                         PIC X(304).           
000816                                                                  
000817                                                                  
000818****************************************************************  
000819*             CARRIER MASTER RECORD                            *  
000820****************************************************************  
000821                                                                  
000822     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.        
000823         16  CF-ADDRESS-DATA.                                     
000824             20  CF-MAIL-TO-NAME            PIC X(30).            
000825             20  CF-IN-CARE-OF              PIC X(30).            
000826             20  CF-ADDRESS-LINE-1          PIC X(30).            
000827             20  CF-ADDRESS-LINE-2          PIC X(30).            
000828             20  CF-CITY-STATE              PIC X(30).            
000829             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3. 
000830             20  CF-PHONE-NO                PIC 9(11)     COMP-3. 
000831                                                                  
000832         16  CF-CLAIM-NO-CONTROL.                                 
000833             20  CF-CLAIM-NO-METHOD         PIC X.                
000834                 88  CLAIM-NO-MANUAL            VALUE '1'.        
000835                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.        
000836                 88  CLAIM-NO-SEQ               VALUE '3'.        
000837                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.        
000838             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.     
000839                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.   
000840                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.     
000841                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.      
000842                                                                  
000843         16  CF-CHECK-NO-CONTROL.                                 
000844             20  CF-CHECK-NO-METHOD         PIC X.                
000845                 88  CHECK-NO-MANUAL            VALUE '1'.        
000846                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.        
000847                 88  CHECK-NO-CARR-SEQ          VALUE '3'.        
000848                 88  CHECK-NO-AT-PRINT          VALUE '4'.        
000849             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.     
000850                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.    
000851                                                                  
000852         16  CF-DOMICILE-STATE              PIC XX.               
000853                                                                  
000854         16  CF-EXPENSE-CONTROLS.                                 
000855             20  CF-EXPENSE-METHOD          PIC X.                
000856                 88  EXPENSE-CALC-MANUAL        VALUE '1'.        
000857                 88  DOLLARS-PER-PMT            VALUE '2'.        
000858                 88  PERCENT-OF-PAYMENT         VALUE '3'.        
000859                 88  DOLLARS-PER-MONTH          VALUE '4'.        
000860             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3. 
000861             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3. 
000862                                                                  
000863         16  CF-CORRESPONDENCE-CONTROL.                           
000864             20  CF-LETTER-RESEND-OPT       PIC X.                
000865                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.      
000866                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.        
000867             20  FILLER                     PIC X(4).             
000868                                                                  
000869         16  CF-RESERVE-CONTROLS.                                 
000870             20  CF-MANUAL-SW               PIC X.                
000871                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.        
000872             20  CF-FUTURE-SW               PIC X.                
000873                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.        
000874             20  CF-PTC-SW                  PIC X.                
000875                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.        
000876             20  CF-IBNR-SW                 PIC X.                
000877                 88  CF-IBNR-RESERVES-USED      VALUE '1'.        
000878             20  CF-PTC-LF-SW               PIC X.                
000879                 88  CF-LF-PTC-USED             VALUE '1'.        
000880             20  CF-CDT-ACCESS-METHOD       PIC X.                
000881                 88  CF-CDT-ROUND-NEAR          VALUE '1'.        
000882                 88  CF-CDT-ROUND-HIGH          VALUE '2'.        
000883                 88  CF-CDT-INTERPOLATED        VALUE '3'.        
000884             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3. 
000885                                                                  
000886         16  CF-CLAIM-CALC-METHOD           PIC X.                
000887             88  360-PLUS-MONTHS                VALUE '1'.        
000888             88  365-PLUS-MONTHS                VALUE '2'.        
000889             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.        
000890             88  360-DAILY                      VALUE '4'.        
000891             88  365-DAILY                      VALUE '5'.        
000892                                                                  
000893         16  CF-LAST-ALPHA-CHARACTER        PIC X.                
000894         16  FILLER                         PIC X(11).            
000895                                                                  
000896         16  CF-LIMIT-AMOUNTS.                                    
000897             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3. 
000898             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3. 
000899             20  CF-MAX-REG-DAYS            PIC S999      COMP-3. 
000900             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3. 
000901             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3. 
000902             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3. 
000903             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3. 
000904             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3. 
000905             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3. 
000906             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3. 
000907                                                                  
000908         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3. 
000909         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3. 
000910         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3. 
000911                                                                  
000912         16  CF-ZIP-CODE.                                         
000913             20  CF-ZIP-PRIME.                                    
000914                 24  CF-ZIP-1ST             PIC X.                
000915                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
000916                 24  FILLER                 PIC X(4).             
000917             20  CF-ZIP-PLUS4               PIC X(4).             
000918         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.       
000919             20  CF-CAN-POSTAL-1            PIC XXX.              
000920             20  CF-CAN-POSTAL-2            PIC XXX.              
000921             20  FILLER                     PIC XXX.              
000922                                                                  
000923         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.   
000924         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.   
000925         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.   
000926                                                                  
000927         16  CF-RATING-SWITCH               PIC X.                
000928             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.    
000929             88  CF-NO-RATING                   VALUE 'N'.        
000930                                                                  
000931         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.               
000932                                                                  
000933         16  CF-CARRIER-OVER-SHORT.                               
000934             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3. 
000935             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3. 
000936                                                                  
000937         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3. 
000938         16  CF-SECPAY-SWITCH               PIC X.                
000939             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.        
000940             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.    
000941         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3. 
000942         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.   
000943         16  FILLER                         PIC X(444).           
000944*        16  FILLER                         PIC X(452).           
000945                                                                  
000946                                                                  
000947****************************************************************  
000948*             MORTALITY MASTER RECORD                          *  
000949****************************************************************  
000950                                                                  
000951     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.       
000952         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES                  
000953                                INDEXED BY CF-MORT-NDX.           
000954             20  CF-MORT-TABLE              PIC X(5).             
000955             20  CF-MORT-TABLE-TYPE         PIC X.                
000956                 88  CF-MORT-JOINT              VALUE 'J'.        
000957                 88  CF-MORT-SINGLE             VALUE 'S'.        
000958                 88  CF-MORT-COMBINED           VALUE 'C'.        
000959                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.    
000960                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
000961             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.   
000962             20  CF-MORT-AGE-METHOD         PIC XX.               
000963                 88  CF-AGE-LAST                VALUE 'AL'.       
000964                 88  CF-AGE-NEAR                VALUE 'AN'.       
000965             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.   
000966             20  CF-MORT-ADJUSTMENT-DIRECTION                     
000967                                            PIC X.                
000968                 88  CF-MINUS                   VALUE '-'.        
000969                 88  CF-PLUS                    VALUE '+'.        
000970             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.   
000971             20  CF-MORT-JOINT-CODE         PIC X.                
000972                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.    
000973             20  CF-MORT-PC-Q               PIC X.                
000974                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
000975             20  CF-MORT-TABLE-CODE         PIC X(4).             
000976             20  CF-MORT-COMMENTS           PIC X(15).            
000977             20  FILLER                     PIC X(14).            
000978                                                                  
000979         16  FILLER                         PIC X(251).           
000980                                                                  
000981                                                                  
000982****************************************************************  
000983*             BUSSINESS TYPE MASTER RECORD                     *  
000984****************************************************************  
000985                                                                  
000986     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.   
000987* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20                        
000988* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80       
000989* AND RECORD 05 IS TYPES 81-99                                    
000990         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.            
000991             20  CF-BUSINESS-TITLE          PIC  X(19).           
000992             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO                    
000993                                            PIC S9V9(4) COMP-3.   
000994             20  CF-BUS-EXCL-ST-CALL        PIC  X.               
000995             20  FILLER                     PIC  X.               
000996         16  FILLER                         PIC  X(248).          
000997                                                                  
000998                                                                  
000999****************************************************************  
001000*             TERMINAL MASTER RECORD                           *  
001001****************************************************************  
001002                                                                  
001003     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.       
001004                                                                  
001005         16  CF-COMPANY-TERMINALS.                                
001006             20  CF-TERMINAL-ID  OCCURS 120 TIMES                 
001007                                  PIC X(4).                       
001008         16  FILLER               PIC X(248).                     
001009                                                                  
001010                                                                  
001011****************************************************************  
001012*             LIFE EDIT MASTER RECORD                          *  
001013****************************************************************  
001014                                                                  
001015     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.       
001016         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.            
001017             20  CF-LIFE-CODE-IN            PIC XX.               
001018             20  CF-LIFE-CODE-OUT           PIC XX.               
001019         16  FILLER                         PIC X(248).           
001020                                                                  
001021                                                                  
001022****************************************************************  
001023*             AH EDIT MASTER RECORD                            *  
001024****************************************************************  
001025                                                                  
001026     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.         
001027         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.              
001028             20  CF-AH-CODE-IN              PIC XXX.              
001029             20  CF-AH-CODE-OUT             PIC XX.               
001030         16  FILLER                         PIC X(248).           
001031                                                                  
001032                                                                  
001033****************************************************************  
001034*             CREDIBILITY TABLES                               *  
001035****************************************************************  
001036                                                                  
001037     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.     
001038         16  CF-CRDB-ENTRY   OCCURS 36 TIMES                      
001039                             INDEXED BY CF-CRDB-NDX.              
001040             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.   
001041             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.   
001042             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.   
001043         16  FILLER                         PIC  X(332).          
001044                                                                  
001045                                                                  
001046****************************************************************  
001047*             REPORT CUSTOMIZATION RECORD                      *  
001048****************************************************************  
001049                                                                  
001050     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.         
001051         16  CF-ACCOUNT-MASTER-STATUS       PIC X.                
001052             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.        
001053             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.        
001054             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.        
001055**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****   
001056****       A T-TRANSFER.                                   ****   
001057             88  CF-ALL-ACCOUNTS                VALUE 'B'.        
001058                                                                  
001059         16  FILLER                         PIC XX.               
001060                                                                  
001061         16  CF-CARRIER-CNTL-OPT.                                 
001062             20  CF-CARRIER-OPT-SEQ         PIC 9.                
001063                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.   
001064                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.          
001065             20  CF-CARRIER-SELECT OCCURS 3 TIMES                 
001066                                            PIC X.                
001067         16  CF-GROUP-CNTL-OPT.                                   
001068             20  CF-GROUP-OPT-SEQ           PIC 9.                
001069                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.   
001070                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.          
001071             20  CF-GROUP-SELECT OCCURS 3 TIMES                   
001072                                            PIC X(6).             
001073         16  CF-STATE-CNTL-OPT.                                   
001074             20  CF-STATE-OPT-SEQ           PIC 9.                
001075                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.   
001076                 88  CF-STATE-OPT-NOT-USED      VALUE 0.          
001077             20  CF-STATE-SELECT OCCURS 3 TIMES                   
001078                                            PIC XX.               
001079         16  CF-ACCOUNT-CNTL-OPT.                                 
001080             20  CF-ACCOUNT-OPT-SEQ         PIC 9.                
001081                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.   
001082                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.          
001083             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES                 
001084                                            PIC X(10).            
001085         16  CF-BUS-TYP-CNTL-OPT.                                 
001086             20  CF-BUS-TYP-OPT-SEQ         PIC 9.                
001087                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.   
001088                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.          
001089             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES                 
001090                                            PIC XX.               
001091         16  CF-LF-TYP-CNTL-OPT.                                  
001092             20  CF-LF-TYP-OPT-SEQ          PIC 9.                
001093                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.   
001094                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.          
001095             20  CF-BUS-LF-SELECT OCCURS 3 TIMES                  
001096                                            PIC XX.               
001097         16  CF-AH-TYP-CNTL-OPT.                                  
001098             20  CF-AH-TYP-OPT-SEQ          PIC 9.                
001099                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.   
001100                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.          
001101             20  CF-BUS-AH-SELECT OCCURS 3 TIMES                  
001102                                            PIC XX.               
001103         16  CF-REPTCD1-CNTL-OPT.                                 
001104             20  CF-REPTCD1-OPT-SEQ         PIC 9.                
001105                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.   
001106                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.          
001107             20  CF-REPTCD1-SELECT OCCURS 3 TIMES                 
001108                                            PIC X(10).            
001109         16  CF-REPTCD2-CNTL-OPT.                                 
001110             20  CF-REPTCD2-OPT-SEQ         PIC 9.                
001111                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.   
001112                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.          
001113             20  CF-REPTCD2-SELECT OCCURS 3 TIMES                 
001114                                            PIC X(10).            
001115         16  CF-USER1-CNTL-OPT.                                   
001116             20  CF-USER1-OPT-SEQ           PIC 9.                
001117                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.   
001118                 88  CF-USER1-OPT-NOT-USED      VALUE 0.          
001119             20  CF-USER1-SELECT OCCURS 3 TIMES                   
001120                                            PIC X(10).            
001121         16  CF-USER2-CNTL-OPT.                                   
001122             20  CF-USER2-OPT-SEQ           PIC 9.                
001123                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.   
001124                 88  CF-USER2-OPT-NOT-USED      VALUE 0.          
001125             20  CF-USER2-SELECT OCCURS 3 TIMES                   
001126                                            PIC X(10).            
001127         16  CF-USER3-CNTL-OPT.                                   
001128             20  CF-USER3-OPT-SEQ           PIC 9.                
001129                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.   
001130                 88  CF-USER3-OPT-NOT-USED      VALUE 0.          
001131             20  CF-USER3-SELECT OCCURS 3 TIMES                   
001132                                            PIC X(10).            
001133         16  CF-USER4-CNTL-OPT.                                   
001134             20  CF-USER4-OPT-SEQ           PIC 9.                
001135                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.   
001136                 88  CF-USER4-OPT-NOT-USED      VALUE 0.          
001137             20  CF-USER4-SELECT OCCURS 3 TIMES                   
001138                                            PIC X(10).            
001139         16  CF-USER5-CNTL-OPT.                                   
001140             20  CF-USER5-OPT-SEQ           PIC 9.                
001141                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.   
001142                 88  CF-USER5-OPT-NOT-USED      VALUE 0.          
001143             20  CF-USER5-SELECT OCCURS 3 TIMES                   
001144                                            PIC X(10).            
001145         16  CF-REINS-CNTL-OPT.                                   
001146             20  CF-REINS-OPT-SEQ           PIC 9.                
001147                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.   
001148                 88  CF-REINS-OPT-NOT-USED      VALUE 0.          
001149             20  CF-REINS-SELECT OCCURS 3 TIMES.                  
001150                 24  CF-REINS-PRIME         PIC XXX.              
001151                 24  CF-REINS-SUB           PIC XXX.              
001152                                                                  
001153         16  CF-AGENT-CNTL-OPT.                                   
001154             20  CF-AGENT-OPT-SEQ           PIC 9.                
001155                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.   
001156                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.          
001157             20  CF-AGENT-SELECT OCCURS 3 TIMES                   
001158                                            PIC X(10).            
001159                                                                  
001160         16  FILLER                         PIC X(43).            
001161                                                                  
001162         16  CF-LOSS-RATIO-SELECT.                                
001163             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.  
001164             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.  
001165         16  CF-ENTRY-DATE-SELECT.                                
001166             20  CF-SEL-LO-ENTRY-DATE       PIC XX.               
001167             20  CF-SEL-HI-ENTRY-DATE       PIC XX.               
001168         16  CF-EFFECTIVE-DATE-SELECT.                            
001169             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.               
001170             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.               
001171                                                                  
001172         16  CF-EXCEPTION-LIST-IND          PIC X.                
001173             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.           
001174                                                                  
001175         16  FILLER                         PIC X(318).           
001176                                                                  
001177****************************************************************  
001178*                  EXCEPTION REPORTING RECORD                  *  
001179****************************************************************  
001180                                                                  
001181     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.      
001182         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.                
001183             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.        
001184                                                                  
001185         16  CF-COMBINED-LIFE-AH-OPT.                             
001186             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
001187             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).           
001188             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).           
001189             20  CF-CANCELLATION-RATIO      PIC S9(02).           
001190                                                                  
001191         16  CF-LIFE-OPT.                                         
001192             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
001193             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
001194             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
001195             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
001196             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
001197             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
001198             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
001199             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
001200             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
001201             20  CF-LF-AVG-AGE-MAX          PIC S9(02).           
001202                                                                  
001203         16  CF-AH-OPT.                                           
001204             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
001205             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
001206             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
001207             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
001208             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
001209             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
001210             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
001211             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
001212             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
001213             20  CF-AH-AVG-AGE-MAX          PIC S9(02).           
001214                                                                  
001215         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.                 
001216             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.        
001217             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.        
001218             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.        
001219                                                                  
001220         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
001221                                                                  
001222         16  FILLER                         PIC X(673).           
001223                                                                  
001224                                                                  
001225****************************************************************  
001226*             MORTGAGE SYSTEM PLAN RECORD                      *  
001227****************************************************************  
001228                                                                  
001229     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.      
001230         16  CF-PLAN-TYPE                   PIC X.                
001231             88  CF-LIFE-MORT-PLAN             VALUE 'L'.         
001232             88  CF-DISAB-MORT-PLAN            VALUE 'D'.         
001233             88  CF-AD-D-MORT-PLAN             VALUE 'A'.         
001234         16  CF-PLAN-ABBREV                 PIC XXX.              
001235         16  CF-PLAN-DESCRIPT               PIC X(10).            
001236         16  CF-PLAN-NOTES                  PIC X(20).            
001237         16  CF-PLAN-ESTABLISH-DATE         PIC XX.               
001238         16  CF-PLAN-UNDERWRITING.                                
001239             20  CF-PLAN-TERM-DATA.                               
001240                 24  CF-MINIMUM-TERM        PIC S999      COMP-3. 
001241                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3. 
001242             20  CF-PLAN-AGE-DATA.                                
001243                 24  CF-MINIMUM-AGE         PIC S999      COMP-3. 
001244                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3. 
001245                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3. 
001246             20  CF-PLAN-BENEFIT-DATA.                            
001247                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3. 
001248                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3. 
001249                 24  CF-MAXIMUM-MONTHLY-BENEFIT                   
001250                                            PIC S9(7)V99  COMP-3. 
001251         16  CF-PLAN-POLICY-FORMS.                                
001252             20  CF-POLICY-FORM             PIC X(12).            
001253             20  CF-MASTER-APPLICATION      PIC X(12).            
001254             20  CF-MASTER-POLICY           PIC X(12).            
001255         16  CF-PLAN-RATING.                                      
001256             20  CF-RATE-CODE               PIC X(5).             
001257             20  CF-SEX-RATING              PIC X.                
001258                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.         
001259                 88  CF-PLAN-SEX-RATED         VALUE '2'.         
001260             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3. 
001261             20  CF-SUB-STD-TYPE            PIC X.                
001262                 88  CF-PCT-OF-PREM            VALUE '1'.         
001263                 88  CF-PCT-OF-BENE            VALUE '2'.         
001264         16  CF-PLAN-PREM-TOLERANCES.                             
001265             20  CF-PREM-TOLERANCE          PIC S999      COMP-3. 
001266             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3. 
001267         16  CF-PLAN-PYMT-TOLERANCES.                             
001268             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3. 
001269             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3. 
001270         16  CF-PLAN-MISC-DATA.                                   
001271             20  FILLER                     PIC X.                
001272             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3. 
001273             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3. 
001274         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3. 
001275         16  CF-PLAN-IND-GRP                PIC X.                
001276             88  CF-MORT-INDIV-PLAN            VALUE 'I'          
001277                                                     '1'.         
001278             88  CF-MORT-GROUP-PLAN            VALUE 'G'          
001279                                                     '2'.         
001280         16  CF-MIB-SEARCH-SW               PIC X.                
001281             88  CF-MIB-SEARCH-ALL             VALUE '1'.         
001282             88  CF-MIB-SEARCH-NONE            VALUE '2'.         
001283             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.         
001284             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'. 
001285         16  CF-ALPHA-SEARCH-SW             PIC X.                
001286             88  CF-MIB-ALPHA-ALL              VALUE '1'.         
001287             88  CF-MIB-ALPHA-NONE             VALUE '2'.         
001288             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.         
001289             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.         
001290             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.         
001291             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.         
001292             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.         
001293             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.         
001294             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.         
001295             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'  
001296                                                     'A' 'B' 'C'  
001297                                                     'X' 'Y' 'Z'. 
001298         16  CF-EFF-DT-RULE-SW              PIC X.                
001299             88  CF-EFF-DT-ENTER               VALUE 'E'.         
001300             88  CF-EFF-DT-MONTH               VALUE 'M'.         
001301             88  CF-EFF-DT-QTR                 VALUE 'Q'.         
001302             88  CF-EFF-DT-SEMI                VALUE 'S'.         
001303             88  CF-EFF-DT-ANN                 VALUE 'A'.         
001304         16  FILLER                         PIC X(4).             
001305         16  CF-HEALTH-QUESTIONS            PIC X.                
001306             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.  
001307         16  CF-GRACE-PERIOD                PIC S999      COMP-3. 
001308         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3. 
001309         16  CF-PLAN-SNGL-JNT               PIC X.                
001310             88  CF-COMBINED-PLAN              VALUE 'C'.         
001311             88  CF-JNT-PLAN                   VALUE 'J'.         
001312             88  CF-SNGL-PLAN                  VALUE 'S'.         
001313         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.              
001314         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.              
001315         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.              
001316         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.              
001317         16  CF-RERATE-CNTL                 PIC  X.               
001318             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.        
001319             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.        
001320             88  CF-DO-NOT-RERATE               VALUE '3' ' '.    
001321             88  CF-AUTO-RECALC                 VALUE '4'.        
001322         16  CF-BENEFIT-TYPE                PIC  X.               
001323             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.        
001324             88  CF-BENEFIT-REDUCES             VALUE '2'.        
001325         16  CF-POLICY-FEE                  PIC S999V99           
001326                                                    COMP-3.       
001327         16  CF-1ST-NOTICE-FORM             PIC  X(04).           
001328         16  CF-2ND-NOTICE-FORM             PIC  X(04).           
001329         16  CF-3RD-NOTICE-FORM             PIC  X(04).           
001330         16  CF-4TH-NOTICE-FORM             PIC  X(04).           
001331         16  FILLER                         PIC  X(32).           
001332         16  CF-TERMINATION-FORM            PIC  X(04).           
001333         16  FILLER                         PIC  X(08).           
001334         16  CF-CLAIM-CAP                   PIC S9(7)V99          
001335                                                       COMP-3.    
001336         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.    
001337         16  CF-ISSUE-LETTER                PIC  X(4).            
001338         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.              
001339         16  CF-DEPENDENT-COVERAGE          PIC  X.               
001340             88  CF-YES-DEP-COV                 VALUE 'Y'.        
001341             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.    
001342         16  CF-MP-REFUND-CALC              PIC X.                
001343             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.      
001344             88  CF-MP-REFD-BY-R78              VALUE '1'.        
001345             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.        
001346             88  CF-MP-REFD-AS-CALIF            VALUE '3'.        
001347             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.        
001348             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.        
001349             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.        
001350             88  CF-MP-REFD-MEAN                VALUE '8'.        
001351         16  CF-ALT-RATE-CODE               PIC  X(5).            
001352                                                                  
001353                                                                  
001354         16  FILLER                         PIC X(498).           
001355****************************************************************  
001356*             MORTGAGE COMPANY MASTER RECORD                   *  
001357****************************************************************  
001358                                                                  
001359     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.  
001360         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).             
001361         16  CF-MORTG-ACCESS-CONTROL        PIC X.                
001362             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.   
001363             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.   
001364             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.   
001365             88  CF-MORT-PROD-CNTL                   VALUE '3'.   
001366             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.   
001367                                                                  
001368         16  CF-MORTG-CONVERSION-DATE       PIC XX.               
001369         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.               
001370         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.               
001371         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.               
001372         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.               
001373                                                                  
001374         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).             
001375             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.           
001376         16  CF-MP-RECON-USE-IND            PIC X(1).             
001377             88  CF-MP-USE-RECON             VALUE 'Y'.           
001378         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).             
001379             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.        
001380         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).             
001381             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.           
001382             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.           
001383         16  FILLER                         PIC X(1).             
001384         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).             
001385             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.        
001386         16  CF-MORTG-MIB-VERSION           PIC X.                
001387             88  CF-MORTG-MIB-BATCH         VALUE '1'.            
001388             88  CF-MORTG-MIB-ONLINE        VALUE '2'.            
001389             88  CF-MORTG-MIB-BOTH          VALUE '3'.            
001390         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.                        
001391             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.                
001392                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.       
001393             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.                
001394                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.       
001395             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.                
001396                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.       
001397             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.                
001398                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.       
001399             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.                
001400                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.       
001401             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.                
001402                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.       
001403         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.              
001404         16  FILLER                         PIC X(7).             
001405         16  CF-MORTG-DESTINATION-SYMBOL.                         
001406             20  CF-MORTG-MIB-COMM          PIC X(5).             
001407             20  CF-MORTG-MIB-TERM          PIC X(5).             
001408         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).            
001409             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.       
001410         16  FILLER                         PIC X(03).            
001411         16  CF-MP-CHECK-NO-CONTROL.                              
001412             20  CF-MP-CHECK-NO-METHOD      PIC X(01).            
001413                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.         
001414                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'          
001415                                                ' ' LOW-VALUES.   
001416                 88  CF-MP-CHECK-NO-PRE-PRINTED                   
001417                                               VALUE '3'.         
001418         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).            
001419         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.    
001420         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.                      
001421             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.                
001422                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.    
001423             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.                
001424                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.    
001425             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.                
001426                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.    
001427             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.                
001428                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.    
001429             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.                
001430                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.    
001431             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.                
001432                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.    
001433         16  CF-MORTG-BILLING-AREA.                               
001434             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES           
001435                                            PIC X.                
001436         16  CF-MORTG-MONTH-END-DT          PIC XX.               
001437         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.      
001438         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.      
001439         16  CF-MORTG-MIB-DEST-SW           PIC X.                
001440             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.    
001441             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.    
001442         16  FILLER                         PIC X.                
001443         16  CF-MORTG-LABEL-CONTROL         PIC X.                
001444             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.    
001445             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.    
001446         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).             
001447         16  FILLER                         PIC X(8).             
001448         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).            
001449         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).             
001450         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).            
001451         16  CF-ACH-COMPANY-ID.                                   
001452             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.                
001453                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.    
001454                 88  CF-ACH-ICD-DUNS                VALUE '3'.    
001455                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.    
001456             20  CF-ACH-COMPANY-ID-NO       PIC X(9).             
001457         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.                
001458             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.    
001459         16  CF-RATE-DEV-AUTHORIZATION      PIC X.                
001460             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.    
001461             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.    
001462         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).             
001463         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).             
001464         16  FILLER                         PIC X(536).           
001465                                                                  
001466****************************************************************  
001467*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *  
001468****************************************************************  
001469                                                                  
001470     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.           
001471         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.                
001472             20  CF-FEMALE-HEIGHT.                                
001473                 24  CF-FEMALE-FT           PIC 99.               
001474                 24  CF-FEMALE-IN           PIC 99.               
001475             20  CF-FEMALE-MIN-WT           PIC 999.              
001476             20  CF-FEMALE-MAX-WT           PIC 999.              
001477         16  FILLER                         PIC X(428).           
001478                                                                  
001479     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.           
001480         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.                
001481             20  CF-MALE-HEIGHT.                                  
001482                 24  CF-MALE-FT             PIC 99.               
001483                 24  CF-MALE-IN             PIC 99.               
001484             20  CF-MALE-MIN-WT             PIC 999.              
001485             20  CF-MALE-MAX-WT             PIC 999.              
001486         16  FILLER                         PIC X(428).           
001487******************************************************************
001488*             AUTOMATIC ACTIVITY RECORD                          *
001489******************************************************************
001490     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.           
001491         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.          
001492             20  CF-SYS-ACTIVE-SW           PIC X(01).            
001493             20  CF-SYS-LETTER-ID           PIC X(04).            
001494             20  CF-SYS-RESEND-DAYS         PIC 9(03).            
001495             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).            
001496             20  CF-SYS-RESET-SW            PIC X(01).            
001497             20  CF-SYS-REPORT-DAYS         PIC 9(03).            
001498             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).            
001499                                                                  
001500         16  FILLER                         PIC X(50).            
001501                                                                  
001502         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.           
001503             20  CF-USER-ACTIVE-SW          PIC X(01).            
001504             20  CF-USER-LETTER-ID          PIC X(04).            
001505             20  CF-USER-RESEND-DAYS        PIC 9(03).            
001506             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).            
001507             20  CF-USER-RESET-SW           PIC X(01).            
001508             20  CF-USER-REPORT-DAYS        PIC 9(03).            
001509             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).            
001510             20  CF-USER-ACTIVITY-DESC      PIC X(20).            
001511                                                                  
001512         16  FILLER                         PIC X(246).           
      *<<((file: ELCCNTL))
001107     EJECT                                                        
001108*    COPY ELCCERT.                                                
      *>>((file: ELCCERT))
000001******************************************************************
000002*                                                                *
000003*                            ELCCERT.                            *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000005*                            VMOD=2.013                          *
000006*                                                                *
000007*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
000008*                                                                *
000009*   FILE TYPE = VSAM,KSDS                                        *
000010*   RECORD SIZE = 450  RECFORM = FIXED                           *
000011*                                                                *
000012*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
000013*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
000014*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
000015*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
000016*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
000017*                                                                *
000018*   LOG = YES                                                    *
000019*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000020******************************************************************
000021*                   C H A N G E   L O G                           
000022*                                                                 
000023* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.                
000024*-----------------------------------------------------------------
000025*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE            
000026* EFFECTIVE    NUMBER                                             
000027*-----------------------------------------------------------------
000028* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING   
000029* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING  
000030* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC    
000031* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER    
000032* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
000033* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND          
000034* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT            
000035* 032612  CR2011110200001  PEMA  AHL CHANGES                      
000036* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO      
000037* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE      
000038* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD             
000039******************************************************************
000040                                                                  
000041 01  CERTIFICATE-MASTER.                                          
000042     12  CM-RECORD-ID                      PIC XX.                
000043         88  VALID-CM-ID                      VALUE 'CM'.         
000044                                                                  
000045     12  CM-CONTROL-PRIMARY.                                      
000046         16  CM-COMPANY-CD                 PIC X.                 
000047         16  CM-CARRIER                    PIC X.                 
000048         16  CM-GROUPING.                                         
000049             20  CM-GROUPING-PREFIX        PIC X(3).              
000050             20  CM-GROUPING-PRIME         PIC X(3).              
000051         16  CM-STATE                      PIC XX.                
000052         16  CM-ACCOUNT.                                          
000053             20  CM-ACCOUNT-PREFIX         PIC X(4).              
000054             20  CM-ACCOUNT-PRIME          PIC X(6).              
000055         16  CM-CERT-EFF-DT                PIC XX.                
000056         16  CM-CERT-NO.                                          
000057             20  CM-CERT-PRIME             PIC X(10).             
000058             20  CM-CERT-SFX               PIC X.                 
000059                                                                  
000060     12  CM-CONTROL-BY-NAME.                                      
000061         16  CM-COMPANY-CD-A1              PIC X.                 
000062         16  CM-INSURED-LAST-NAME          PIC X(15).             
000063         16  CM-INSURED-INITIALS.                                 
000064             20  CM-INSURED-INITIAL1       PIC X.                 
000065             20  CM-INSURED-INITIAL2       PIC X.                 
000066                                                                  
000067     12  CM-CONTROL-BY-SSN.                                       
000068         16  CM-COMPANY-CD-A2              PIC X.                 
000069         16  CM-SOC-SEC-NO.                                       
000070             20  CM-SSN-STATE              PIC XX.                
000071             20  CM-SSN-ACCOUNT            PIC X(6).              
000072             20  CM-SSN-LN3.                                      
000073                 25  CM-INSURED-INITIALS-A2.                      
000074                     30 CM-INSURED-INITIAL1-A2   PIC X.           
000075                     30 CM-INSURED-INITIAL2-A2   PIC X.           
000076                 25 CM-PART-LAST-NAME-A2         PIC X.           
000077                                                                  
000078     12  CM-CONTROL-BY-CERT-NO.                                   
000079         16  CM-COMPANY-CD-A4              PIC X.                 
000080         16  CM-CERT-NO-A4                 PIC X(11).             
000081                                                                  
000082     12  CM-CONTROL-BY-MEMB.                                      
000083         16  CM-COMPANY-CD-A5              PIC X.                 
000084         16  CM-MEMBER-NO.                                        
000085             20  CM-MEMB-STATE             PIC XX.                
000086             20  CM-MEMB-ACCOUNT           PIC X(6).              
000087             20  CM-MEMB-LN4.                                     
000088                 25  CM-INSURED-INITIALS-A5.                      
000089                     30 CM-INSURED-INITIAL1-A5   PIC X.           
000090                     30 CM-INSURED-INITIAL2-A5   PIC X.           
000091                 25 CM-PART-LAST-NAME-A5         PIC XX.          
000092                                                                  
000093     12  CM-INSURED-PROFILE-DATA.                                 
000094         16  CM-INSURED-FIRST-NAME.                               
000095             20  CM-INSURED-1ST-INIT       PIC X.                 
000096             20  FILLER                    PIC X(9).              
000097         16  CM-INSURED-ISSUE-AGE          PIC 99.                
000098         16  CM-INSURED-SEX                PIC X.                 
000099             88  CM-SEX-MALE                  VALUE 'M'.          
000100             88  CM-SEX-FEMAL                 VALUE 'F'.          
000101         16  CM-INSURED-JOINT-AGE          PIC 99.                
000102         16  CM-JOINT-INSURED-NAME.                               
000103             20  CM-JT-LAST-NAME           PIC X(15).             
000104             20  CM-JT-FIRST-NAME.                                
000105                 24  CM-JT-1ST-INIT        PIC X.                 
000106                 24  FILLER                PIC X(9).              
000107             20  CM-JT-INITIAL             PIC X.                 
000108                                                                  
000109     12  CM-LIFE-DATA.                                            
000110         16  CM-LF-BENEFIT-CD              PIC XX.                
000111         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  
000112         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  
000113         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  
000114         16  CM-LF-DEV-CODE                PIC XXX.               
000115         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  
000116         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  
000117         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  
000118         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  
000119         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  
000120         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  
000121         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  
000122         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  
000123         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  
000124         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  
000125         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  
000126         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  
000127         16  cm-temp-epiq                  pic xx.                
000128             88  EPIQ-CLASS                  value 'EQ'.          
000129*        16  FILLER                        PIC XX.                
000130                                                                  
000131     12  CM-AH-DATA.                                              
000132         16  CM-AH-BENEFIT-CD              PIC XX.                
000133         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  
000134         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  
000135         16  CM-AH-DEV-CODE                PIC XXX.               
000136         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  
000137         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  
000138         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  
000139         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  
000140         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  
000141         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  
000142         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  
000143         16  CM-AH-PAID-THRU-DT            PIC XX.                
000144             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    
000145         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  
000146         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.  
000147         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  
000148         16  FILLER                        PIC X.                 
000149                                                                  
000150     12  CM-LOAN-INFORMATION.                                     
000151         16  CM-LIVES                      PIC S9(7)     COMP-3.  
000152         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES                 
000153                                           PIC S9(5)V99  COMP-3.  
000154         16  CM-BILLED                     PIC S9(7)     COMP-3.  
000155         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  
000156         16  CM-PAY-FREQUENCY              PIC S99.               
000157         16  CM-LOAN-TERM                  PIC S999      COMP-3.  
000158         16  CM-RATE-CLASS                 PIC XX.                
000159         16  CM-BENEFICIARY                PIC X(25).             
000160         16  CM-POLICY-FORM-NO             PIC X(12).             
000161         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  
000162         16  CM-LAST-ADD-ON-DT             PIC XX.                
000163         16  CM-DEDUCTIBLE-AMOUNTS.                               
000164             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  
000165             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  
000166         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    
000167             20  CM-RESIDENT-STATE         PIC XX.                
000168             20  CM-RATE-CODE              PIC X(4).              
000169             20  FILLER                    PIC XX.                
000170         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              
000171             20  CM-LOAN-OFFICER           PIC X(5).              
000172             20  FILLER                    PIC XXX.               
000173         16  CM-CSR-CODE                   PIC XXX.               
000174         16  CM-UNDERWRITING-CODE          PIC X.                 
000175             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          
000176         16  CM-POST-CARD-IND              PIC X.                 
000177         16  CM-REF-INTERFACE-SW           PIC X.                 
000178         16  CM-PREMIUM-TYPE               PIC X.                 
000179             88  CM-SING-PRM                  VALUE '1'.          
000180             88  CM-O-B-COVERAGE              VALUE '2'.          
000181             88  CM-OPEN-END                  VALUE '3'.          
000182         16  CM-IND-GRP-TYPE               PIC X.                 
000183             88  CM-INDIVIDUAL                VALUE 'I'.          
000184             88  CM-GROUP                     VALUE 'G'.          
000185         16  CM-SKIP-CODE                  PIC X.                 
000186             88  NO-MONTHS-SKIPPED            VALUE SPACE.        
000187             88  SKIP-JULY                    VALUE '1'.          
000188             88  SKIP-AUGUST                  VALUE '2'.          
000189             88  SKIP-SEPTEMBER               VALUE '3'.          
000190             88  SKIP-JULY-AUG                VALUE '4'.          
000191             88  SKIP-AUG-SEPT                VALUE '5'.          
000192             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          
000193             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          
000194             88  SKIP-JUNE                    VALUE '8'.          
000195             88  SKIP-JUNE-JULY               VALUE '9'.          
000196             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          
000197             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          
000198         16  CM-PAYMENT-MODE               PIC X.                 
000199             88  PAY-MONTHLY                  VALUE SPACE.        
000200             88  PAY-WEEKLY                   VALUE '1'.          
000201             88  PAY-SEMI-MONTHLY             VALUE '2'.          
000202             88  PAY-BI-WEEKLY                VALUE '3'.          
000203             88  PAY-SEMI-ANUALLY             VALUE '4'.          
000204         16  CM-LOAN-NUMBER                PIC X(8).              
000205         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  
000206         16  CM-OLD-LOF                    PIC XXX.               
000207*        16  CM-LOAN-OFFICER               PIC XXX.               
000208         16  CM-REIN-TABLE                 PIC XXX.               
000209         16  CM-SPECIAL-REIN-CODE          PIC X.                 
000210         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                
000211         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                
000212         16  CM-LOAN-1ST-PMT-DT            PIC XX.                
000213                                                                  
000214     12  CM-STATUS-DATA.                                          
000215         16  CM-ENTRY-STATUS               PIC X.                 
000216         16  CM-ENTRY-DT                   PIC XX.                
000217                                                                  
000218         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 
000219         16  CM-LF-CANCEL-DT               PIC XX.                
000220         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                
000221                                                                  
000222         16  CM-LF-STATUS-AT-DEATH         PIC X.                 
000223         16  CM-LF-DEATH-DT                PIC XX.                
000224         16  CM-LF-DEATH-EXIT-DT           PIC XX.                
000225                                                                  
000226         16  CM-LF-CURRENT-STATUS          PIC X.                 
000227             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   
000228                                                'M' '4' '5' '9'.  
000229             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          
000230             88  CM-LF-POLICY-PENDING         VALUE '2'.          
000231             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          
000232             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          
000233             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          
000234             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.          
000235             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          
000236             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          
000237             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          
000238             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          
000239             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          
000240             88  CM-LF-DECLINED               VALUE 'D'.          
000241             88  CM-LF-VOIDED                 VALUE 'V'.          
000242                                                                  
000243         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 
000244         16  CM-AH-CANCEL-DT               PIC XX.                
000245         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                
000246                                                                  
000247         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 
000248         16  CM-AH-SETTLEMENT-DT           PIC XX.                
000249         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                
000250                                                                  
000251         16  CM-AH-CURRENT-STATUS          PIC X.                 
000252             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   
000253                                                'M' '4' '5' '9'.  
000254             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          
000255             88  CM-AH-POLICY-PENDING         VALUE '2'.          
000256             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          
000257             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          
000258             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          
000259             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.          
000260             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          
000261             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          
000262             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          
000263             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          
000264             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          
000265             88  CM-AH-DECLINED               VALUE 'D'.          
000266             88  CM-AH-VOIDED                 VALUE 'V'.          
000267                                                                  
000268         16  CM-CLAIM-INTERFACE-SW         PIC X.                 
000269             88  NO-CLAIM-ATTACHED            VALUE SPACE.        
000270             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          
000271             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          
000272         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    
000273                                                                  
000274         16  CM-ENTRY-BATCH                PIC X(6).              
000275         16  CM-LF-EXIT-BATCH              PIC X(6).              
000276         16  CM-AH-EXIT-BATCH              PIC X(6).              
000277         16  CM-LAST-MONTH-END             PIC XX.                
000278                                                                  
000279     12  CM-NOTE-SW                        PIC X.                 
000280         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          
000281         88  CERT-NOTES-PRESENT               VALUE '1'.          
000282         88  BILLING-NOTES-PRESENT            VALUE '2'.          
000283         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          
000284         88  CLAIM-NOTES-PRESENT              VALUE '4'.          
000285         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.          
000286         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.          
000287         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.          
000288     12  CM-COMP-EXCP-SW                   PIC X.                 
000289         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          
000290         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          
000291     12  CM-INSURED-ADDRESS-SW             PIC X.                 
000292         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          
000293         88  INSURED-ADDR-PRESENT             VALUE '1'.          
000294                                                                  
000295*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. 
000296     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3. 
000297     12  FILLER                            PIC X.                 
000298                                                                  
000299*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. 
000300     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3. 
000301     12  FILLER                            PIC X.                 
000302*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. 
000303     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3. 
000304                                                                  
000305     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 
000306         88  CERT-ADDED-BATCH                 VALUE ' '.          
000307         88  CERT-ADDED-ONLINE                VALUE '1'.          
000308         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          
000309         88  CERT-PURGED-OFFLINE              VALUE '3'.          
000310         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          
000311     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 
000312         88  CERT-AS-LOADED                   VALUE ' '.          
000313         88  CERT-CANCELLED-ONLINE            VALUE '1'.          
000314         88  CERT-CLAIM-ONLINE                VALUE '2'.          
000315         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          
000316         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          
000317         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          
000318         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          
000319         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          
000320                                                                  
000321     12  CM-ACCOUNT-COMM-PCTS.                                    
000322         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  
000323         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  
000324                                                                  
000325     12  CM-USER-FIELD                     PIC X.                 
000326     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.  
000327     12  CM-CLP-STATE                      PIC XX.                
000328     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.            
000329     12  CM-USER-RESERVED                  PIC XXX.               
000330     12  FILLER REDEFINES CM-USER-RESERVED.                       
000331         16  CM-AH-CLASS-CD                PIC XX.                
000332         16  F                             PIC X.                 
000333******************************************************************
      *<<((file: ELCCERT))
001109     EJECT                                                        
001110*    COPY ELCTRLR.                                                
      *>>((file: ELCTRLR))
000001******************************************************************
000002*                                                                *
000003*                            ELCTRLR.                            *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000005*                            VMOD=2.014                          *
000006*                                                                *
000007*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
000008*                                                                *
000009*   FILE TYPE = VSAM,KSDS                                        *
000010*   RECORD SIZE = 200    RECFORM = FIXED                         *
000011*                                                                *
000012*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
000013*       ALTERNATE INDEX = NONE                                   *
000014*                                                                *
000015*   LOG = YES                                                    *
000016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000017******************************************************************
000018*                   C H A N G E   L O G                           
000019*                                                                 
000020* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.                
000021*-----------------------------------------------------------------
000022*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE            
000023* EFFECTIVE    NUMBER                                             
000024*-----------------------------------------------------------------
000025* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES       
000026* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST          
000027* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE            
000028* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE           
000029* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES           
000030* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT       
000031* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR         
000032* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS  
000033* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER          
000034* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER   
000035* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES                 
000036* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER          
000037* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
000038* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
000039* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO         
000040* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES        
000041* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND          
000042* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T 
000043* 040814    2014030500002  AJRA  ADD ICD CODES                    
000044* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE      
000045* 013017  CR2016053100001  PEMA  ACH PROCESSING                   
000046* 062217  CR2017050300002  TANA  ADD AUTH RCVD                    
000047* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE             
000048* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE            
000049******************************************************************
000050 01  ACTIVITY-TRAILERS.                                           
000051     12  AT-RECORD-ID                    PIC XX.                  
000052         88  VALID-AT-ID                       VALUE 'AT'.        
000053                                                                  
000054     12  AT-CONTROL-PRIMARY.                                      
000055         16  AT-COMPANY-CD               PIC X.                   
000056         16  AT-CARRIER                  PIC X.                   
000057         16  AT-CLAIM-NO                 PIC X(7).                
000058         16  AT-CERT-NO.                                          
000059             20  AT-CERT-PRIME           PIC X(10).               
000060             20  AT-CERT-SFX             PIC X.                   
000061         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.      
000062             88  AT-1ST-TRL-AVAIL             VALUE +4095.        
000063             88  AT-LAST-TRL-AVAIL            VALUE +100.         
000064             88  AT-RESV-EXP-HIST-TRL         VALUE +0.           
000065             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.   
000066             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19. 
000067             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29. 
000068             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39. 
000069             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49. 
000070             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59. 
000071             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69. 
000072             88  AT-DIAGNOSIS-TRL             VALUE +90.          
000073             88  AT-BENEFICIARY-TRL           VALUE +91.          
000074             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.          
000075             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.          
000076             88  AT-VFY-CAUSAL-STATE          VALUE +94.          
000077             88  AT-ERROR-MSGS-TRL            VALUE +95.          
000078                                                                  
000079     12  AT-TRAILER-TYPE                 PIC X.                   
000080         88  RESERVE-EXPENSE-TR               VALUE '1'.          
000081         88  PAYMENT-TR                       VALUE '2'.          
000082         88  AUTO-PAY-TR                      VALUE '3'.          
000083         88  CORRESPONDENCE-TR                VALUE '4'.          
000084         88  ADDRESS-TR                       VALUE '5'.          
000085         88  GENERAL-INFO-TR                  VALUE '6'.          
000086         88  AUTO-PROMPT-TR                   VALUE '7'.          
000087         88  DENIAL-TR                        VALUE '8'.          
000088         88  INCURRED-CHG-TR                  VALUE '9'.          
000089         88  FORM-CONTROL-TR                  VALUE 'A'.          
000090                                                                  
000091     12  AT-RECORDED-DT                  PIC XX.                  
000092     12  AT-RECORDED-BY                  PIC X(4).                
000093     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.    
000094                                                                  
000095     12  AT-TRAILER-BODY                 PIC X(165).              
000096                                                                  
000097     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.       
000098         16  AT-RESERVE-CONTROLS.                                 
000099             20  AT-MANUAL-SW            PIC X.                   
000100                 88  AT-MANUAL-RESERVES-USED VALUE '1'.           
000101             20  AT-FUTURE-SW            PIC X.                   
000102                 88  AT-FUTURE-RESERVES-USED VALUE '1'.           
000103             20  AT-PTC-SW               PIC X.                   
000104                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.           
000105             20  AT-IBNR-SW              PIC X.                   
000106                 88  AT-IBNR-RESERVES-USED   VALUE '1'.           
000107             20  AT-PTC-LF-SW            PIC X.                   
000108                 88  AT-LF-PTC-USED          VALUE '1'.           
000109             20  AT-CDT-ACCESS-METHOD    PIC X.                   
000110                 88  AT-CDT-ROUND-NEAR       VALUE '1'.           
000111                 88  AT-CDT-ROUND-HIGH       VALUE '2'.           
000112                 88  AT-CDT-INTERPOLATED     VALUE '3'.           
000113             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.  
000114         16  AT-LAST-COMPUTED-DT         PIC XX.                  
000115         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.  
000116         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.  
000117         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.  
000118         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.  
000119         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.  
000120         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.  
000121         16  AT-EXPENSE-CONTROLS.                                 
000122             20  AT-EXPENSE-METHOD       PIC X.                   
000123                 88  NO-EXPENSE-CALCULATED    VALUE '1'.          
000124                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.          
000125                 88  PERCENT-OF-PMT           VALUE '3'.          
000126                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.          
000127             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.  
000128             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.  
000129         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.  
000130         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.  
000131                                                                  
000132         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.  
000133         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.  
000134                                                                  
000135*        16  FILLER                      PIC X(53).               
000136         16  FILLER                      PIC X(47).               
000137                                                                  
000138         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.                  
000139         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).                
000140                                                                  
000141         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.                
000142             20  AT-OPEN-CLOSE-DATE      PIC XX.                  
000143             20  AT-OPEN-CLOSE-TYPE      PIC X.                   
000144*                    C = CLOSED                                   
000145*                    O = OPEN                                     
000146             20  AT-OPEN-CLOSE-REASON    PIC X(5).                
000147*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE      
000148                                                                  
000149     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.               
000150         16  AT-PAYMENT-TYPE             PIC X.                   
000151             88  PARTIAL-PAYMENT                VALUE '1'.        
000152             88  FINAL-PAYMENT                  VALUE '2'.        
000153             88  LUMP-SUM-PAYMENT               VALUE '3'.        
000154             88  ADDITIONAL-PAYMENT             VALUE '4'.        
000155             88  CHARGEABLE-EXPENSE             VALUE '5'.        
000156             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.        
000157             88  VOIDED-PAYMENT                 VALUE '9'.        
000158             88  TRANSFER                       VALUE 'T'.        
000159             88  LIFE-INTEREST                  VALUE 'I'.        
000160                                                                  
000161         16  AT-CLAIM-TYPE               PIC X.                   
000162             88  PAID-FOR-AH                    VALUE 'A'.        
000163             88  PAID-FOR-LIFE                  VALUE 'L'.        
000164             88  PAID-FOR-IUI                   VALUE 'I'.        
000165             88  PAID-FOR-GAP                   VALUE 'G'.        
000166             88  PAID-FOR-FAM                   VALUE 'F'.        
000167             88  PAID-FOR-OTH                   VALUE 'O'.        
000168         16  AT-CLAIM-PREM-TYPE          PIC X.                   
000169             88  AT-SINGLE-PREMIUM              VALUE '1'.        
000170             88  AT-O-B-COVERAGE                VALUE '2'.        
000171             88  AT-OPEN-END-COVERAGE           VALUE '3'.        
000172         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.    
000173         16  AT-CHECK-NO                 PIC X(7).                
000174         16  AT-PAID-FROM-DT             PIC XX.                  
000175         16  AT-PAID-THRU-DT             PIC XX.                  
000176         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.      
000177         16  AT-ACH-PAYMENT              PIC X.                   
000178*        16  FILLER                      PIC X.                   
000179         16  AT-PAYEES-NAME              PIC X(30).               
000180         16  AT-PAYMENT-ORIGIN           PIC X.                   
000181             88  ONLINE-MANUAL-PMT              VALUE '1'.        
000182             88  ONLINE-AUTO-PMT                VALUE '2'.        
000183             88  OFFLINE-PMT                    VALUE '3'.        
000184         16  AT-CHECK-WRITTEN-DT         PIC XX.                  
000185         16  AT-TO-BE-WRITTEN-DT         PIC XX.                  
000186         16  AT-VOID-DATA.                                        
000187             20  AT-VOID-DT              PIC XX.                  
000188*00144       20  AT-VOID-REASON          PIC X(30).               
000189             20  AT-VOID-REASON          PIC X(26).               
000190         16  AT-PMT-APPROVED-BY          PIC X(04).               
000191         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.    
000192         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.    
000193         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT             
000194                                         PIC S99V9(5)  COMP-3.    
000195         16  AT-CREDIT-INTERFACE.                                 
000196             20  AT-PMT-SELECT-DT        PIC XX.                  
000197                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.       
000198             20  AT-PMT-ACCEPT-DT        PIC XX.                  
000199                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.       
000200             20  AT-VOID-SELECT-DT       PIC XX.                  
000201                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.       
000202             20  AT-VOID-ACCEPT-DT       PIC XX.                  
000203                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.       
000204                                                                  
000205         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.      
000206                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.     
000207                 88  CONVERSION-PAYMENT           VALUE +99999999.
000208         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.      
000209                                                                  
000210         16  AT-FORCE-CONTROL            PIC X.                   
000211             88  PAYMENT-WAS-FORCED           VALUE '1'.          
000212         16  AT-PREV-LAST-PMT-DT         PIC XX.                  
000213         16  AT-PREV-PAID-THRU-DT        PIC XX.                  
000214         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.    
000215         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.    
000216         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.    
000217         16  AT-BENEFIT-TYPE             PIC X.                   
000218                                                                  
000219         16  AT-EXPENSE-TYPE             PIC X.                   
000220         16  AT-PAYMENT-APPROVAL-SW      PIC X.                   
000221                                                                  
000222         16  AT-PAYEE-TYPE-CD.                                    
000223             20  AT-PAYEE-TYPE           PIC X.                   
000224                 88  INSURED-PAID           VALUE 'I'.            
000225                 88  BENEFICIARY-PAID       VALUE 'B'.            
000226                 88  ACCOUNT-PAID           VALUE 'A'.            
000227                 88  OTHER-1-PAID           VALUE 'O'.            
000228                 88  OTHER-2-PAID           VALUE 'Q'.            
000229                 88  DOCTOR-PAID            VALUE 'P'.            
000230                 88  EMPLOYER-PAID          VALUE 'E'.            
000231             20  AT-PAYEE-SEQ            PIC X.                   
000232                                                                  
000233         16  AT-CASH-PAYMENT             PIC X.                   
000234         16  AT-GROUPED-PAYMENT          PIC X.                   
000235         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.    
000236         16  AT-APPROVAL-LEVEL-REQD      PIC X.                   
000237         16  AT-APPROVED-LEVEL           PIC X.                   
000238         16  AT-VOID-TYPE                PIC X.                   
000239             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.            
000240             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.            
000241         16  AT-AIG-UNEMP-IND            PIC X.                   
000242             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.            
000243         16  AT-ASSOCIATES               PIC X.                   
000244             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.        
000245             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.        
000246                                                                  
000247         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.    
000248         16  AT-CV-PMT-CODE              PIC X.                   
000249             88  FULL-DEATH-PAYMENT         VALUE '1'.            
000250             88  HALF-DEATH-PAYMENT         VALUE '2'.            
000251             88  FULL-ADD-PAYMENT           VALUE '3'.            
000252             88  HALF-ADD-PAYMENT           VALUE '4'.            
000253             88  FULL-RIDER-PAYMENT         VALUE '5'.            
000254             88  HALF-RIDER-PAYMENT         VALUE '6'.            
000255             88  NON-CHG-EXP-PAYMENT        VALUE '7'.            
000256             88  ADDL-PAYMENT               VALUE '8'.            
000257                                                                  
000258         16  AT-EOB-CODE1                PIC XXX.                 
000259         16  AT-EOB-CODE2                PIC XXX.                 
000260         16  AT-EOB-CODE3                PIC XXX.                 
000261         16  FILLER REDEFINES AT-EOB-CODE3.                       
000262             20  AT-PRINT-CLM-FORM       PIC X.                   
000263             20  AT-PRINT-SURVEY         PIC X.                   
000264             20  AT-SPECIAL-RELEASE      PIC X.                   
000265         16  AT-EOB-CODE4                PIC XXX.                 
000266         16  FILLER REDEFINES AT-EOB-CODE4.                       
000267             20  AT-INT-PMT-SELECT-DT    PIC XX.                  
000268             20  FILLER                  PIC X.                   
000269         16  AT-EOB-CODE5                PIC XXX.                 
000270         16  FILLER REDEFINES AT-EOB-CODE5.                       
000271             20  AT-PMT-PROOF-DT         PIC XX.                  
000272             20  FILLER                  PIC X.                   
000273                                                                  
000274         16  AT-PRINT-EOB-WITH-CHECK     PIC X.                   
000275             88  AT-PRINT-EOB            VALUE 'Y'.               
000276                                                                  
000277         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.                  
000278         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).                
000279                                                                  
000280     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.              
000281         16  AT-SCHEDULE-START-DT        PIC XX.                  
000282         16  AT-SCHEDULE-END-DT          PIC XX.                  
000283         16  AT-TERMINATED-DT            PIC XX.                  
000284         16  AT-LAST-PMT-TYPE            PIC X.                   
000285             88  LAST-PMT-IS-FINAL              VALUE 'F'.        
000286             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.        
000287         16  AT-FIRST-PMT-DATA.                                   
000288             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.    
000289             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.      
000290             20  AT-1ST-PAY-THRU-DT      PIC XX.                  
000291         16  AT-REGULAR-PMT-DATA.                                 
000292             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.    
000293             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.      
000294             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.      
000295         16  AT-AUTO-PAYEE-CD.                                    
000296             20  AT-AUTO-PAYEE-TYPE      PIC X.                   
000297                 88  INSURED-PAID-AUTO      VALUE 'I'.            
000298                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.            
000299                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.            
000300                 88  OTHER-1-PAID-AUTO      VALUE 'O'.            
000301                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.            
000302             20  AT-AUTO-PAYEE-SEQ       PIC X.                   
000303         16  AT-AUTO-PAY-DAY             PIC 99.                  
000304         16  AT-AUTO-CASH                PIC X.                   
000305             88  AT-CASH                      VALUE 'Y'.          
000306             88  AT-NON-CASH                  VALUE 'N'.          
000307*        16  FILLER                      PIC X(129).              
000308         16  AT-AUTO-END-LETTER          PIC X(4).                
000309         16  FILLER                      PIC X(125).              
000310                                                                  
000311         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.                  
000312         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).                
000313                                                                  
000314     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.        
000315         16  AT-LETTER-SENT-DT           PIC XX.                  
000316         16  AT-RECEIPT-FOLLOW-UP        PIC XX.                  
000317         16  AT-AUTO-RE-SEND-DT          PIC XX.                  
000318         16  AT-LETTER-ANSWERED-DT       PIC XX.                  
000319         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.      
000320         16  AT-LETTER-ORIGIN            PIC X.                   
000321             88  ONLINE-CREATION              VALUE '1' '3'.      
000322             88  OFFLINE-CREATION             VALUE '2' '4'.      
000323             88  NAPER-ONLINE-CREATION        VALUE '3'.          
000324             88  NAPER-OFFLINE-CREATION       VALUE '4'.          
000325         16  AT-STD-LETTER-FORM          PIC X(4).                
000326         16  AT-REASON-TEXT              PIC X(70).               
000327         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.      
000328         16  AT-ADDRESEE-TYPE            PIC X.                   
000329              88  INSURED-ADDRESEE            VALUE 'I'.          
000330              88  BENEFICIARY-ADDRESEE        VALUE 'B'.          
000331              88  ACCOUNT-ADDRESEE            VALUE 'A'.          
000332              88  PHYSICIAN-ADDRESEE          VALUE 'P'.          
000333              88  EMPLOYER-ADDRESEE           VALUE 'E'.          
000334              88  OTHER-ADDRESEE-1            VALUE 'O'.          
000335              88  OTHER-ADDRESEE-2            VALUE 'Q'.          
000336         16  AT-ADDRESSEE-NAME           PIC X(30).               
000337         16  AT-INITIAL-PRINT-DATE       PIC XX.                  
000338         16  AT-RESEND-PRINT-DATE        PIC XX.                  
000339         16  AT-CORR-SOL-UNSOL           PIC X.                   
000340         16  AT-LETTER-PURGED-DT         PIC XX.                  
000341*                                                                 
000342*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.          
000343*                                                                 
000344         16  AT-CSO-REDEFINITION.                                 
000345             20  AT-RESEND-LETTER-FORM   PIC X(4).                
000346             20  AT-AUTO-CLOSE-IND       PIC X(1).                
000347             20  AT-LETTER-TO-BENE       PIC X(1).                
000348             20  AT-STOP-LETTER-DT       PIC X(2).                
000349             20  AT-AUTH-RCVD            PIC X(1).                
000350             20  FILLER                  PIC X(18).               
000351*             20  FILLER                  PIC X(27).              
000352             20  AT-CSO-LETTER-STATUS    PIC X.                   
000353                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.           
000354                 88  AT-CSO-LETTER-PURGED    VALUE '2'.           
000355                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.           
000356             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.               
000357             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.               
000358*                                                                 
000359*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED 
000360*                                                                 
000361*        16  FILLER                      PIC X(26).               
000362*                                                                 
000363*        16  AT-DMD-BSR-CODE             PIC X.                   
000364*            88  AT-AUTOMATED-BSR              VALUE 'A'.         
000365*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.     
000366*                                                                 
000367*        16  AT-DMD-LETTER-STATUS        PIC X.                   
000368*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.         
000369*            88  AT-DMD-LETTER-PURGED          VALUE '2'.         
000370*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.         
000371*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.                  
000372*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.                  
000373                                                                  
000374         16  AT-CORR-LAST-MAINT-DT       PIC XX.                  
000375         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).                
000376                                                                  
000377     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.               
000378         16  AT-ADDRESS-TYPE             PIC X.                   
000379             88  INSURED-ADDRESS               VALUE 'I'.         
000380             88  BENEFICIARY-ADDRESS           VALUE 'B'.         
000381             88  ACCOUNT-ADDRESS               VALUE 'A'.         
000382             88  PHYSICIAN-ADDRESS             VALUE 'P'.         
000383             88  EMPLOYER-ADDRESS              VALUE 'E'.         
000384             88  OTHER-ADDRESS-1               VALUE 'O'.         
000385             88  OTHER-ADDRESS-2               VALUE 'Q'.         
000386         16  AT-MAIL-TO-NAME             PIC X(30).               
000387         16  AT-ADDRESS-LINE-1           PIC X(30).               
000388         16  AT-ADDRESS-LINE-2           PIC X(30).               
000389         16  AT-CITY-STATE.                                       
000390             20  AT-CITY                 PIC X(28).               
000391             20  AT-STATE                PIC XX.                  
000392         16  AT-ZIP.                                              
000393             20  AT-ZIP-CODE.                                     
000394                 24  AT-ZIP-1ST          PIC X.                   
000395                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
000396                 24  FILLER              PIC X(4).                
000397             20  AT-ZIP-PLUS4            PIC X(4).                
000398         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.          
000399             20  AT-CAN-POSTAL-1         PIC XXX.                 
000400             20  AT-CAN-POSTAL-2         PIC XXX.                 
000401             20  FILLER                  PIC XXX.                 
000402         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.    
000403*         16  FILLER                      PIC X(23).              
000404         16  AT-VFY-2ND-BENE-SSN         PIC X(9).                
000405         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.                   
000406         16  FILLER                      PIC X(13).               
000407         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.                  
000408         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).                
000409                                                                  
000410     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.          
000411         16  AT-INFO-LINE-1              PIC X(60).               
000412         16  FILLER REDEFINES AT-INFO-LINE-1.                     
000413             20  AT-NOTE-ERROR-NO OCCURS 15                       
000414                                         PIC X(4).                
000415         16  AT-INFO-LINE-2              PIC X(60).               
000416         16  FILLER REDEFINES AT-INFO-LINE-2.                     
000417             20  AT-ICD-CODE-1           PIC X(8).                
000418             20  AT-ICD-CODE-2           PIC X(8).                
000419             20  FILLER                  PIC X(44).               
000420         16  AT-INFO-TRAILER-TYPE        PIC X.                   
000421             88  AT-ERRORS-NOTE          VALUE 'E'.               
000422             88  AT-PAYMENT-NOTE         VALUE 'P'.               
000423             88  AT-CALL-NOTE            VALUE 'C'.               
000424             88  AT-MAINT-NOTE           VALUE 'M'.               
000425             88  AT-CERT-CHANGE          VALUE 'X'.               
000426             88  AT-APPROVAL-NOTE        VALUE 'R'.               
000427             88  AT-NOTE-FILE-NOTE       VALUE 'N'.               
000428             88  AT-CERT-CANCELLED       VALUE 'T'.               
000429         16  AT-CALL-TYPE                PIC X.                   
000430             88  AT-PHONE-CALL-IN        VALUE 'I'.               
000431             88  AT-PHONE-CALL-NEW       VALUE 'N'.               
000432             88  AT-PHONE-CALL-OUT       VALUE 'O'.               
000433         16  AT-NOTE-CONTINUATION        PIC X.                   
000434             88  AT-CONTINUED-NOTE       VALUE 'X'.               
000435         16  AT-EOB-CODES-EXIST          PIC X.                   
000436             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.               
000437         16  FILLER                      PIC X(35).               
000438         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.                  
000439         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).                
000440                                                                  
000441     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.           
000442         16  AT-PROMPT-LINE-1            PIC X(60).               
000443         16  AT-PROMPT-LINE-2            PIC X(60).               
000444         16  AT-PROMPT-START-DT          PIC XX.                  
000445         16  AT-PROMPT-END-DT            PIC XX.                  
000446         16  FILLER                      PIC X(35).               
000447         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.                  
000448         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).                
000449                                                                  
000450     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.           
000451         16  AT-DENIAL-INFO-1            PIC X(60).               
000452         16  AT-DENIAL-INFO-2            PIC X(60).               
000453         16  AT-DENIAL-DT                PIC XX.                  
000454         16  AT-RETRACTION-DT            PIC XX.                  
000455         16  AT-DENIAL-REASON-CODE       PIC X(4).                
000456*         16  FILLER                      PIC X(31).              
000457         16  AT-DENIAL-PROOF-DT          PIC XX.                  
000458         16  FILLER                      PIC X(29).               
000459         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.                  
000460         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).                
000461                                                                  
000462     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.          
000463         16  AT-OLD-INCURRED-DT          PIC XX.                  
000464         16  AT-OLD-REPORTED-DT          PIC XX.                  
000465         16  AT-OLD-ESTABLISHED-DT       PIC XX.                  
000466         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3. 
000467         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.   
000468         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3. 
000469         16  AT-OLD-PAID-THRU-DT         PIC XX.                  
000470         16  AT-LAST-PMT-MADE-DT         PIC XX.                  
000471         16  FILLER                      PIC X(26).               
000472         16  AT-OLD-DIAG-CODE            PIC X(6).                
000473         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.   
000474         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3. 
000475         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3. 
000476         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3. 
000477         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3. 
000478         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3. 
000479         16  AT-OLD-DIAG-DESCRIP         PIC X(60).               
000480         16  AT-OLD-ICD-CODE-1           PIC X(8).                
000481         16  AT-OLD-ICD-CODE-2           PIC X(8).                
000482         16  FILLER                      PIC X(9).                
000483         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).                
000484                                                                  
000485     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.          
000486         16  AT-FORM-SEND-ON-DT          PIC XX.                  
000487         16  AT-FORM-FOLLOW-UP-DT        PIC XX.                  
000488         16  AT-FORM-RE-SEND-DT          PIC XX.                  
000489         16  AT-FORM-ANSWERED-DT         PIC XX.                  
000490         16  AT-FORM-PRINTED-DT          PIC XX.                  
000491         16  AT-FORM-REPRINT-DT          PIC XX.                  
000492         16  AT-FORM-TYPE                PIC X.                   
000493             88  INITIAL-FORM                  VALUE '1'.         
000494             88  PROGRESS-FORM                 VALUE '2'.         
000495         16  AT-INSTRUCT-LN-1            PIC X(28).               
000496         16  AT-INSTRUCT-LN-2            PIC X(28).               
000497         16  AT-INSTRUCT-LN-3            PIC X(28).               
000498         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.     
000499         16  AT-FORM-ADDRESS             PIC X.                   
000500             88  FORM-TO-INSURED              VALUE 'I'.          
000501             88  FORM-TO-ACCOUNT              VALUE 'A'.          
000502             88  FORM-TO-OTHER-1              VALUE 'O'.          
000503             88  FORM-TO-OTHER-2              VALUE 'Q'.          
000504         16  AT-RELATED-1.                                        
000505             20 AT-REL-CARR-1            PIC X.                   
000506             20 AT-REL-CLAIM-1           PIC X(7).                
000507             20 AT-REL-CERT-1            PIC X(11).               
000508         16  AT-RELATED-2.                                        
000509             20 AT-REL-CARR-2            PIC X.                   
000510             20 AT-REL-CLAIM-2           PIC X(7).                
000511             20 AT-REL-CERT-2            PIC X(11).               
000512         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.                  
000513         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.                  
000514         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.                  
000515         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.                  
000516         16  AT-FORM-REM-PRINT-DT        PIC XX.                  
000517         16  AT-STOP-FORM-DT             PIC X(2).                
000518                                                                  
000519         16  FILLER                      PIC X(09).               
000520         16  AT-FORM-LAST-MAINT-DT       PIC XX.                  
000521         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).                
000522******************************************************************
      *<<((file: ELCTRLR))
001111     EJECT                                                        
001112*    COPY ELCACTQ.                                                
      *>>((file: ELCACTQ))
000001******************************************************************
000002*                                                                *
000003*                            ELCACTQ.                            *
000004*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE             
000005*                            VMOD=2.004                          *
000006*                                                                *
000007*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
000008*                                                                *
000009*   FILE TYPE = VSAM,KSDS                                        *
000010*   RECORD SIZE = 60     RECFORM = FIXED                         *
000011*                                                                *
000012*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
000013*       ALTERNATE INDEX = NONE                                   *
000014*                                                                *
000015*   LOG = YES                                                    *
000016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000017*                                                                *
000018*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
000019******************************************************************
000020                                                                  
000021 01  ACTIVITY-QUE.                                                
000022     12  AQ-RECORD-ID                PIC XX.                      
000023         88  VALID-AQ-ID                VALUE 'AQ'.               
000024                                                                  
000025     12  AQ-CONTROL-PRIMARY.                                      
000026         16  AQ-COMPANY-CD           PIC X.                       
000027         16  AQ-CARRIER              PIC X.                       
000028         16  AQ-CLAIM-NO             PIC X(7).                    
000029         16  AQ-CERT-NO.                                          
000030             20  AQ-CERT-PRIME       PIC X(10).                   
000031             20  AQ-CERT-SFX         PIC X.                       
000032                                                                  
000033     12  AQ-PENDING-ACTIVITY-FLAGS.                               
000034         88  NO-PENDING-ACTIVITY        VALUE SPACES.             
000035         16  AQ-PENDING-PAYMENT-FLAG PIC X.                       
000036             88  PENDING-PAYMENTS       VALUE '1'.                
000037         16  AQ-PENDING-STATUS-FLAG  PIC X.                       
000038             88  PENDING-FULL-PRINT     VALUE '1'.                
000039             88  PENDING-PART-PRINT     VALUE '2'.                
000040         16  AQ-PENDING-LETTER-FLAG  PIC X.                       
000041             88  PENDING-LETTERS        VALUE '1'.                
000042         16  AQ-PENDING-CLAIM-RESTORE PIC X.                      
000043             88  PENDING-RESTORE        VALUE 'C'.                
000044             88  PENDING-RESTORE-LETTER VALUE 'L'.                
000045                                                                  
000046     12  FILLER                      PIC X(20).                   
000047                                                                  
000048     12  AQ-RESEND-DATE              PIC XX.                      
000049     12  AQ-FOLLOWUP-DATE            PIC XX.                      
000050     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.        
000051     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.        
000052     12  AQ-AUTO-LETTER              PIC X(4).                    
000053     12  FILLER                      PIC XX.                      
000054     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.          
000055***************************************************************** 
      *<<((file: ELCACTQ))
001113     EJECT                                                        
001114*    COPY ERCACCT.                                                
      *>>((file: ERCACCT))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCACCT                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000006*                            VMOD=2.031                          *
000007*                                                                *
000008*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
000009*                                                                *
000010*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
000011*   VSAM ACCOUNT MASTER FILES.                                   *
000012*                                                                *
000013*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
000014*                                                                *
000015*   FILE TYPE = VSAM,KSDS                                        *
000016*   RECORD SIZE = 2000  RECFORM = FIX                            *
000017*                                                                *
000018*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
000019*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
000020*                                                                *
000021*   LOG = NO                                                     *
000022*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000023*                                                                *
000024*                                                                *
000025******************************************************************
000026*                   C H A N G E   L O G                           
000027*                                                                 
000028* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.                
000029*-----------------------------------------------------------------
000030*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE            
000031* EFFECTIVE    NUMBER                                             
000032*-----------------------------------------------------------------
000033* 102004    2003031400002  PEMA  ADD NEW STATUS CODE              
000034* 092705    2005050300006  PEMA  ADD SPP LEASES                   
000035* 022808    2007083100002  PEMA  ADD FREEZE STATUS                
000036* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT            
000037* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS              
000038* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED    
000039* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
000040* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES       
000041******************************************************************
000042                                                                  
000043 01  ACCOUNT-MASTER.                                              
000044     12  AM-RECORD-ID                      PIC XX.                
000045         88  VALID-AM-ID                      VALUE 'AM'.         
000046                                                                  
000047     12  AM-CONTROL-PRIMARY.                                      
000048         16  AM-COMPANY-CD                 PIC X.                 
000049         16  AM-MSTR-CNTRL.                                       
000050             20  AM-CONTROL-A.                                    
000051                 24  AM-CARRIER            PIC X.                 
000052                 24  AM-GROUPING.                                 
000053                     28 AM-GROUPING-PREFIX PIC XXX.               
000054                     28 AM-GROUPING-PRIME  PIC XXX.               
000055                 24  AM-STATE              PIC XX.                
000056                 24  AM-ACCOUNT.                                  
000057                     28  AM-ACCOUNT-PREFIX PIC X(4).              
000058                     28  AM-ACCOUNT-PRIME  PIC X(6).              
000059             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            
000060                                           PIC X(19).             
000061             20  AM-CNTRL-B.                                      
000062                 24  AM-EXPIRATION-DT      PIC XX.                
000063                 24  FILLER                PIC X(4).              
000064             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 
000065                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     
000066                                                                  
000067     12  AM-CONTROL-BY-VAR-GRP.                                   
000068         16  AM-COMPANY-CD-A1              PIC X.                 
000069         16  AM-VG-CARRIER                 PIC X.                 
000070         16  AM-VG-GROUPING                PIC X(6).              
000071         16  AM-VG-STATE                   PIC XX.                
000072         16  AM-VG-ACCOUNT                 PIC X(10).             
000073         16  AM-VG-DATE.                                          
000074             20  AM-VG-EXPIRATION-DT       PIC XX.                
000075             20  FILLER                    PIC X(4).              
000076         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  
000077                                           PIC 9(11)      COMP-3. 
000078     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.                  
000079         16  FILLER                        PIC X(10).             
000080         16  AM-VG-KEY3.                                          
000081             20  AM-VG3-ACCOUNT            PIC X(10).             
000082             20  AM-VG3-EXP-DT             PIC XX.                
000083         16  FILLER                        PIC X(4).              
000084     12  AM-MAINT-INFORMATION.                                    
000085         16  AM-LAST-MAINT-DT              PIC XX.                
000086         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. 
000087         16  AM-LAST-MAINT-USER            PIC X(4).              
000088         16  FILLER                        PIC XX.                
000089                                                                  
000090     12  AM-EFFECTIVE-DT                   PIC XX.                
000091     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. 
000092                                                                  
000093     12  AM-PREV-DATES  COMP-3.                                   
000094         16  AM-PREV-EXP-DT                PIC 9(11).             
000095         16  AM-PREV-EFF-DT                PIC 9(11).             
000096                                                                  
000097     12  AM-REPORT-CODE-1                  PIC X(10).             
000098     12  AM-REPORT-CODE-2                  PIC X(10).             
000099                                                                  
000100     12  AM-CITY-CODE                      PIC X(4).              
000101     12  AM-COUNTY-PARISH                  PIC X(6).              
000102                                                                  
000103     12  AM-NAME                           PIC X(30).             
000104     12  AM-PERSON                         PIC X(30).             
000105     12  AM-ADDRS                          PIC X(30).             
000106     12  AM-CITY.                                                 
000107         16  AM-ADDR-CITY                  PIC X(28).             
000108         16  AM-ADDR-STATE                 PIC XX.                
000109     12  AM-ZIP.                                                  
000110         16  AM-ZIP-PRIME.                                        
000111             20  AM-ZIP-PRI-1ST            PIC X.                 
000112                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. 
000113             20  FILLER                    PIC X(4).              
000114         16  AM-ZIP-PLUS4                  PIC X(4).              
000115     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              
000116         16  AM-CAN-POSTAL-1               PIC XXX.               
000117         16  AM-CAN-POSTAL-2               PIC XXX.               
000118         16  FILLER                        PIC XXX.               
000119     12  AM-TEL-NO.                                               
000120         16  AM-AREA-CODE                  PIC 999.               
000121         16  AM-TEL-PRE                    PIC 999.               
000122         16  AM-TEL-NBR                    PIC 9(4).              
000123     12  AM-TEL-LOC                        PIC X.                 
000124         88  AM-TEL-AT-HOME                   VALUE 'H'.          
000125         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          
000126                                                                  
000127     12  AM-COMM-STRUCTURE.                                       
000128         16  AM-DEFN-1.                                           
000129             20  AM-AGT-COMMS       OCCURS 10 TIMES.              
000130                 24  AM-AGT.                                      
000131                     28  AM-AGT-PREFIX     PIC X(4).              
000132                     28  AM-AGT-PRIME      PIC X(6).              
000133                 24  AM-COM-TYP            PIC X.                 
000134                 24  AM-L-COM              PIC SV9(5)     COMP-3. 
000135                 24  AM-J-COM              PIC SV9(5)     COMP-3. 
000136                 24  AM-A-COM              PIC SV9(5)     COMP-3. 
000137                 24  AM-RECALC-LV-INDIC    PIC X.                 
000138                 24  AM-RETRO-LV-INDIC     PIC X.                 
000139                 24  AM-GL-CODES           PIC X.                 
000140                 24  AM-COMM-CHARGEBACK    PIC 9(02).             
000141                 24  FILLER                PIC X(01).             
000142         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   
000143             20  AM-COM-TBLS        OCCURS 10 TIMES.              
000144                 24  FILLER                PIC X(11).             
000145                 24  AM-L-COMA             PIC XXX.               
000146                 24  AM-J-COMA             PIC XXX.               
000147                 24  AM-A-COMA             PIC XXX.               
000148                 24  FILLER                PIC X(6).              
000149                                                                  
000150     12  AM-COMM-CHANGE-STATUS             PIC X.                 
000151         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          
000152                                                                  
000153     12  AM-CSR-CODE                       PIC X(4).              
000154                                                                  
000155     12  AM-BILLING-STATUS                 PIC X.                 
000156         88  AM-ACCOUNT-BILLED                VALUE 'B'.          
000157         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          
000158     12  AM-AUTO-REFUND-SW                 PIC X.                 
000159         88  AUTO-REFUNDS-USED                VALUE 'Y'.          
000160         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      
000161     12  AM-GPCD                           PIC 99.                
000162     12  AM-IG                             PIC X.                 
000163         88  AM-HAS-INDIVIDUAL                VALUE '1'.          
000164         88  AM-HAS-GROUP                     VALUE '2'.          
000165     12  AM-STATUS                         PIC X.                 
000166         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          
000167         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          
000168         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          
000169         88  AM-ACCOUNT-CANCELLED             VALUE '3'.          
000170         88  AM-ACCOUNT-FROZEN                VALUE '4'.          
000171         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.          
000172         88  AM-ACCOUNT-DROPPED               VALUE '6'.          
000173         88  AM-ACCOUNT-LAPSED                VALUE '7'.          
000174         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.          
000175         88  AM-ACCOUNT-PENDING               VALUE '9'.          
000176     12  AM-REMIT-TO                       PIC 99.                
000177     12  AM-ID-NO                          PIC X(11).             
000178                                                                  
000179     12  AM-CAL-TABLE                      PIC XX.                
000180     12  AM-LF-DEVIATION                   PIC XXX.               
000181     12  AM-AH-DEVIATION                   PIC XXX.               
000182     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. 
000183     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. 
000184     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. 
000185     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. 
000186     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. 
000187     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. 
000188                                                                  
000189     12  AM-USER-FIELDS.                                          
000190         16  AM-FLD-1                      PIC XX.                
000191         16  AM-FLD-2                      PIC XX.                
000192         16  AM-FLD-3                      PIC XX.                
000193         16  AM-FLD-4                      PIC XX.                
000194         16  AM-FLD-5                      PIC XX.                
000195                                                                  
000196     12  AM-1ST-PROD-DATE.                                        
000197         16  AM-1ST-PROD-YR                PIC XX.                
000198         16  AM-1ST-PROD-MO                PIC XX.                
000199         16  AM-1ST-PROD-DA                PIC XX.                
000200     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     
000201     12  AM-CERTS-PURGED-DATE.                                    
000202         16  AM-PUR-YR                     PIC XX.                
000203         16  AM-PUR-MO                     PIC XX.                
000204         16  AM-PUR-DA                     PIC XX.                
000205     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     
000206     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     
000207     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     
000208     12  AM-INACTIVE-DATE.                                        
000209         16  AM-INA-MO                     PIC 99.                
000210         16  AM-INA-DA                     PIC 99.                
000211         16  AM-INA-YR                     PIC 99.                
000212     12  AM-AR-HI-CERT-DATE                PIC XX.                
000213                                                                  
000214     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. 
000215     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. 
000216                                                                  
000217     12  AM-OB-PAYMENT-MODE                PIC X.                 
000218         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      
000219         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          
000220         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          
000221         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          
000222                                                                  
000223     12  AM-AH-ONLY-INDICATOR              PIC X.                 
000224         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      
000225         88  AM-NO-AH-ONLY                    VALUE 'N'.          
000226                                                                  
000227     12  AM-EDIT-LOAN-OFC                  PIC X(01).             
000228                                                                  
000229     12  AM-OVER-SHORT.                                           
000230         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. 
000231         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. 
000232                                                                  
000233     12  AM-DCC-PRODUCT-CODE               PIC XXX.               
000234     12  AM-DCC-CLP-STATE                  PIC XX.                
000235                                                                  
000236     12  AM-RECALC-COMM                    PIC X.                 
000237     12  AM-RECALC-REIN                    PIC X.                 
000238                                                                  
000239     12  AM-REI-TABLE                      PIC XXX.               
000240     12  AM-REI-ET-LF                      PIC X.                 
000241     12  AM-REI-ET-AH                      PIC X.                 
000242     12  AM-REI-PE-LF                      PIC X.                 
000243     12  AM-REI-PE-AH                      PIC X.                 
000244     12  AM-REI-PRT-ST                     PIC X.                 
000245     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. 
000246     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. 
000247     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. 
000248     12  AM-REI-GROUP-A                    PIC X(6).              
000249     12  AM-REI-MORT                       PIC X(4).              
000250     12  AM-REI-PRT-OW                     PIC X.                 
000251     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. 
000252     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. 
000253     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. 
000254     12  AM-REI-GROUP-B                    PIC X(6).              
000255                                                                  
000256     12  AM-TRUST-TYPE                     PIC X(2).              
000257                                                                  
000258     12  AM-EMPLOYER-STMT-USED             PIC X.                 
000259     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 
000260                                                                  
000261     12  AM-STD-AH-TYPE                    PIC XX.                
000262     12  AM-EARN-METHODS.                                         
000263         16  AM-EARN-METHOD-R              PIC X.                 
000264             88 AM-REF-RL-R78                 VALUE 'R'.          
000265             88 AM-REF-RL-PR                  VALUE 'P'.          
000266             88 AM-REF-RL-MEAN                VALUE 'M'.          
000267             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          
000268         16  AM-EARN-METHOD-L              PIC X.                 
000269             88 AM-REF-LL-R78                 VALUE 'R'.          
000270             88 AM-REF-LL-PR                  VALUE 'P'.          
000271             88 AM-REF-LL-MEAN                VALUE 'M'.          
000272             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          
000273         16  AM-EARN-METHOD-A              PIC X.                 
000274             88 AM-REF-AH-R78                 VALUE 'R'.          
000275             88 AM-REF-AH-PR                  VALUE 'P'.          
000276             88 AM-REF-AH-MEAN                VALUE 'M'.          
000277             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          
000278             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          
000279             88 AM-REF-AH-NET                 VALUE 'N'.          
000280                                                                  
000281     12  AM-TOL-PREM                       PIC S999V99    COMP-3. 
000282     12  AM-TOL-REF                        PIC S999V99    COMP-3. 
000283     12  AM-TOL-CLM                        PIC S999V99    COMP-3. 
000284                                                                  
000285     12  AM-RET-Y-N                        PIC X.                 
000286     12  AM-RET-P-E                        PIC X.                 
000287     12  AM-LF-RET                         PIC S9V9999    COMP-3. 
000288     12  AM-AH-RET                         PIC S9V9999    COMP-3. 
000289     12  AM-RET-GRP                        PIC X(6).              
000290     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    
000291         16  AM-POOL-PRIME                 PIC XXX.               
000292         16  AM-POOL-SUB                   PIC XXX.               
000293     12  AM-RETRO-EARNINGS.                                       
000294         16  AM-RET-EARN-R                 PIC X.                 
000295         16  AM-RET-EARN-L                 PIC X.                 
000296         16  AM-RET-EARN-A                 PIC X.                 
000297     12  AM-RET-ST-TAX-USE                 PIC X.                 
000298         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  
000299         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      
000300     12  AM-RETRO-BEG-EARNINGS.                                   
000301         16  AM-RET-BEG-EARN-R             PIC X.                 
000302         16  AM-RET-BEG-EARN-L             PIC X.                 
000303         16  AM-RET-BEG-EARN-A             PIC X.                 
000304     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. 
000305     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. 
000306                                                                  
000307     12  AM-USER-SELECT-OPTIONS.                                  
000308         16  AM-USER-SELECT-1              PIC X(10).             
000309         16  AM-USER-SELECT-2              PIC X(10).             
000310         16  AM-USER-SELECT-3              PIC X(10).             
000311         16  AM-USER-SELECT-4              PIC X(10).             
000312         16  AM-USER-SELECT-5              PIC X(10).             
000313                                                                  
000314     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. 
000315                                                                  
000316     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. 
000317                                                                  
000318     12  AM-RPT045A-SWITCH                 PIC X.                 
000319         88  RPT045A-OFF                   VALUE 'N'.             
000320                                                                  
000321     12  AM-INSURANCE-LIMITS.                                     
000322         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. 
000323         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. 
000324                                                                  
000325     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 
000326         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          
000327                                                                  
000328     12  AM-DISMBR-COVERAGE-SW             PIC X.                 
000329         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          
000330         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          
000331                                                                  
000332     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. 
000333                                                                  
000334     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. 
000335     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3. 
000336     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3. 
000337     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3. 
000338     12  AM-DCC-UEF-STATE                  PIC XX.                
000339     12  FILLER                            PIC XXX.               
000340     12  AM-REPORT-CODE-3                  PIC X(10).             
000341*    12  FILLER                            PIC X(22).             
000342                                                                  
000343     12  AM-RESERVE-DATE.                                         
000344         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    
000345         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    
000346         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    
000347                                                                  
000348     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                
000349     12  AM-NOTIFICATION-TYPES.                                   
000350         16  AM-NOTIF-OF-LETTERS           PIC X.                 
000351         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 
000352         16  AM-NOTIF-OF-REPORTS           PIC X.                 
000353         16  AM-NOTIF-OF-STATUS            PIC X.                 
000354                                                                  
000355     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 
000356         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          
000357         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          
000358         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          
000359         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     
000360                                                                  
000361     12  AM-BENEFIT-CONTROLS.                                     
000362         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            
000363             20  AM-BENEFIT-CODE           PIC XX.                
000364             20  AM-BENEFIT-TYPE           PIC X.                 
000365             20  AM-BENEFIT-REVISION       PIC XXX.               
000366             20  AM-BENEFIT-REM-TERM       PIC X.                 
000367             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 
000368             20  FILLER                    PIC XX.                
000369         16  FILLER                        PIC X(80).             
000370                                                                  
000371     12  AM-TRANSFER-DATA.                                        
000372         16  AM-TRANSFERRED-FROM.                                 
000373             20  AM-TRNFROM-CARRIER        PIC X.                 
000374             20  AM-TRNFROM-GROUPING.                             
000375                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               
000376                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               
000377             20  AM-TRNFROM-STATE          PIC XX.                
000378             20  AM-TRNFROM-ACCOUNT.                              
000379                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             
000380                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              
000381             20  AM-TRNFROM-DTE            PIC XX.                
000382         16  AM-TRANSFERRED-TO.                                   
000383             20  AM-TRNTO-CARRIER          PIC X.                 
000384             20  AM-TRNTO-GROUPING.                               
000385                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               
000386                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               
000387             20  AM-TRNTO-STATE            PIC XX.                
000388             20  AM-TRNTO-ACCOUNT.                                
000389                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              
000390                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              
000391             20  AM-TRNTO-DTE              PIC XX.                
000392         16  FILLER                        PIC X(10).             
000393                                                                  
000394     12  AM-SAVED-REMIT-TO                 PIC 99.                
000395                                                                  
000396     12  AM-COMM-STRUCTURE-SAVED.                                 
000397         16  AM-DEFN-1-SAVED.                                     
000398             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           
000399                 24  AM-AGT-SV             PIC X(10).             
000400                 24  AM-COM-TYP-SV         PIC X.                 
000401                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. 
000402                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. 
000403                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. 
000404                 24  AM-RECALC-LV-INDIC-SV PIC X.                 
000405                 24  FILLER                PIC X.                 
000406                 24  AM-GL-CODES-SV        PIC X.                 
000407                 24  AM-COM-CHARGEBACK-SV  PIC 99.                
000408                 24  FILLER                PIC X.                 
000409         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       
000410             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            
000411                 24  FILLER                PIC X(11).             
000412                 24  AM-L-COMA-SV          PIC XXX.               
000413                 24  AM-J-COMA-SV          PIC XXX.               
000414                 24  AM-A-COMA-SV          PIC XXX.               
000415                 24  FILLER                PIC X(6).              
000416                                                                  
000417     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            
000418         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 
000419            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. 
000420            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. 
000421            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. 
000422                                                                  
000423     12  AM-ORIG-DEALER-NO                 PIC X(10).             
000424     12  FILLER                            PIC X(120).            
000425                                                                  
000426     12  AM-ACCOUNT-EXECUTIVE-DATA.                               
000427         16  AM-CONTROL-NAME               PIC X(30).             
000428         16  AM-EXECUTIVE-ONE.                                    
000429             20  AM-EXEC1-NAME             PIC X(15).             
000430             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       
000431                                                          COMP-3. 
000432             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       
000433                                                          COMP-3. 
000434         16  AM-EXECUTIVE-TWO.                                    
000435             20  AM-EXEC2-NAME             PIC X(15).             
000436             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       
000437                                                          COMP-3. 
000438             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       
000439                                                          COMP-3. 
000440                                                                  
000441     12  AM-RETRO-ADDITIONAL-DATA.                                
000442         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. 
000443         16  AM-RETRO-PREM-P-E             PIC X.                 
000444         16  AM-RETRO-CLMS-P-I             PIC X.                 
000445         16  AM-RETRO-RET-BRACKET-LF.                             
000446             20  AM-RETRO-RET-METHOD-LF    PIC X.                 
000447                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      
000448                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          
000449             20  AM-RETRO-RET-BASIS-LF     PIC X.                 
000450                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      
000451                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          
000452             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           
000453                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. 
000454                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. 
000455         16  AM-RETRO-RET-BRACKET-AH.                             
000456             20  AM-RETRO-RET-METHOD-AH    PIC X.                 
000457                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      
000458                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          
000459                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          
000460             20  AM-RETRO-RET-BASIS-AH     PIC X.                 
000461                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      
000462                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          
000463             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           
000464                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. 
000465                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. 
000466                                                                  
000467     12  AM-COMMENTS.                                             
000468         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
000469                                                                  
000470     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         
000471         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 
000472         16  AM-FLI-BILLING-CODE           PIC X.                 
000473         16  AM-FLI-ALT-STATE-CODE         PIC XX.                
000474         16  AM-FLI-UNITED-IDENT           PIC X.                 
000475         16  AM-FLI-INTEREST-LOST-DATA.                           
000476             20  AM-FLI-BANK-NO            PIC X(5).              
000477             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. 
000478             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. 
000479             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. 
000480         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            
000481             20  AM-FLI-AGT                PIC X(9).              
000482             20  AM-FLI-AGT-COMM-ACC       PIC X.                 
000483             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. 
000484         16  FILLER                        PIC X(102).            
000485                                                                  
000486     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         
000487         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          
000488             20  AM-BENEFIT-DMD-CODE         PIC XX.              
000489             20  AM-BENEFIT-DMD-TYPE         PIC X.               
000490             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             
000491             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               
000492             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               
000493         16  FILLER                          PIC X(10).           
000494******************************************************************
      *<<((file: ERCACCT))
001115     EJECT                                                        
001116*    COPY ELCCHKQ.                                                
      *>>((file: ELCCHKQ))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ELCCHKQ.                            *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000006*                            VMOD=2.007                          *
000007*                                                                *
000008*   FILE DESCRIPTION = CHECK QUE FILE                            *
000009*                                                                *
000010*   FILE TYPE = VSAM,KSDS                                        *
000011*   RECORD SIZE = 100  RECFORM = FIXED                           *
000012*                                                                *
000013*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
000014*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
000015*                                                                *
000016*   LOG = YES                                                    *
000017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000018******************************************************************
000019 01  CHECK-QUE.                                                   
000020     12  CQ-RECORD-ID                PIC XX.                      
000021         88  VALID-CQ-ID         VALUE 'CQ'.                      
000022                                                                  
000023     12  CQ-CONTROL-PRIMARY.                                      
000024         16  CQ-COMPANY-CD           PIC X.                       
000025         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.        
000026         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.        
000027                                                                  
000028     12  CQ-CONTROL-BY-PAYEE.                                     
000029         16  CQ-CONTROL-BY-NUMBER.                                
000030             20  CQ-COMPANY-CD-A1     PIC X.                      
000031             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.        
000032         16  CQ-PAYEE-CARRIER        PIC X.                       
000033         16  CQ-PAYEE-GROUPING       PIC X(6).                    
000034         16  CQ-PAYEE-STATE          PIC XX.                      
000035         16  CQ-PAYEE-BENE-ACCT      PIC X(10).                   
000036         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.        
000037                                                                  
000038     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.          
000039         16  CQ-DMD-COMPANY-CD-A2    PIC X.                       
000040         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.                       
000041         16  CQ-DMD-BENE-CODE-A2     PIC X(10).                   
000042         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).                    
000043         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.        
000044         16  FILLER                  PIC X(3).                    
000045                                                                  
000046     12  CQ-ENTRY-TYPE               PIC X.                       
000047             88  CHECK-ON-QUE           VALUE 'Q'.                
000048             88  ALIGNMENT-CHECK        VALUE 'A'.                
000049             88  SPOILED-CHECK          VALUE 'S'.                
000050             88  PAYMENT-ABORTED        VALUE 'X'.                
000051                                                                  
000052     12  CQ-CLAIM-MAST-CNTL.                                      
000053         16  CQ-CARRIER              PIC X.                       
000054         16  CQ-CLAIM-NO             PIC X(7).                    
000055         16  CQ-CERT-NO.                                          
000056             20  CQ-CERT-PRIME       PIC X(10).                   
000057             20  CQ-CERT-SFX         PIC X.                       
000058         16  CQ-CLAIM-TYPE           PIC X.                       
000059             88  CQ-LIFE-CLAIM          VALUE 'L'.                
000060             88  CQ-AH-CLAIM            VALUE 'A'.                
000061         16  CQ-CLAIM-SUB-TYPE       PIC X.                       
000062             88  CQ-FIXED-COVERAGE      VALUE '1'.                
000063             88  CQ-O-B-COVERAGE        VALUE '2'.                
000064             88  CQ-OPEN-END-COVERAGE   VALUE '3'.                
000065                                                                  
000066     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.        
000067     12  CQ-CHECK-NUMBER             PIC X(7).                    
000068     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.      
000069     12  CQ-PAYMENT-TYPE             PIC X.                       
000070             88  CQ-PARTIAL-PAYMENT        VALUE '1'.             
000071             88  CQ-FINAL-PAYMENT          VALUE '2'.             
000072             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.             
000073             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.             
000074             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.             
000075             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.             
000076             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.             
000077             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.             
000078     12  CQ-VOID-INDICATOR           PIC X.                       
000079             88  CHECK-IS-STOPPED          VALUE 'S'.             
000080             88  CHECK-IS-VOID             VALUE 'V'.             
000081     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.        
000082     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.        
000083     12  CQ-CHECK-BY-USER            PIC X(4).                    
000084     12  CQ-PRE-NUMBERING-SW         PIC X.                       
000085       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.           
000086       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.             
000087                                                                  
000088     12  CQ-CHECK-WRITTEN-DT         PIC XX.                      
000089     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.        
000090     12  CQ-LEDGER-FLAG              PIC X(01).                   
000091     12  CQ-VOID-AFTER-LEDGER        PIC X(01).                   
000092     12  CQ-LAST-UPDATED-DT          PIC XX.                      
000093     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.      
000094     12  CQ-APPLIED-TO-RCON-DT       PIC XX.                      
000095                                                                  
000096     12  FILLER                      PIC X(04).                   
000097                                                                  
000098******************************************************************
      *<<((file: ELCCHKQ))
001117     EJECT                                                        
001118*    COPY ELCBENE.                                                
      *>>((file: ELCBENE))
000001******************************************************************
000002*                                                                *
000003*                            ELCBENE.                            *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000005*                            VMOD=2.006                          *
000006*                                                                *
000007*   FILE DESCRIPTION = BENEFICIARY FILE                          *
000008*                                                                *
000009*   FILE TYPE = VSAM,KSDS                                        *
000010*   RECORD SIZE = 500   RECFORM = FIX                            *
000011*                                                                *
000012*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
000013*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
000014*                                                                *
000015*   LOG = YES                                                    *
000016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000017*                                                                *
000018*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
000019******************************************************************
000020*                   C H A N G E   L O G                           
000021*                                                                 
000022* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.                
000023*-----------------------------------------------------------------
000024*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE            
000025* EFFECTIVE    NUMBER                                             
000026*-----------------------------------------------------------------
000027* 013017  CR2016053100001  PEMA  ACH PROCESSING                   
000028* 082317  CR2017082100003  PEMA  Add sub type                     
000029* 032019  CR2019011400002  PEMA  Add email address for ach report 
000030******************************************************************
000031                                                                  
000032 01  BENEFICIARY-MASTER.                                          
000033     12  BE-RECORD-ID                PIC XX.                      
000034         88  VALID-BE-ID                VALUE 'BE'.               
000035                                                                  
000036     12  BE-CONTROL-PRIMARY.                                      
000037         16  BE-COMPANY-CD           PIC X.                       
000038         16  BE-RECORD-TYPE          PIC X.                       
000039             88  BENEFICIARY-RECORD  VALUE 'B'.                   
000040             88  ADJUSTOR-RECORD     VALUE 'A'.                   
000041         16  BE-BENEFICIARY          PIC X(10).                   
000042     12  BE-CONTROL-BY-NAME.                                      
000043         16  BE-COMPANY-CD-A1        PIC X.                       
000044         16  BE-RECORD-TYPE-A1       PIC X.                       
000045         16  BE-MAIL-TO-NAME-A1      PIC X(30).                   
000046         16  BE-ALTERNATE-PRIME-A1   PIC X(10).                   
000047                                                                  
000048     12  BE-LAST-MAINT-DT            PIC XX.                      
000049     12  BE-LAST-MAINT-BY            PIC X(4).                    
000050     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.        
000051                                                                  
000052     12  BE-ADDRESS-DATA.                                         
000053         16  BE-MAIL-TO-NAME         PIC X(30).                   
000054         16  BE-ADDRESS-LINE-1       PIC X(30).                   
000055         16  BE-ADDRESS-LINE-2       PIC X(30).                   
000056         16  BE-ADDRESS-LINE-3       PIC X(30).                   
000057         16  BE-CITY-STATE.                                       
000058             20  BE-CITY             PIC X(28).                   
000059             20  BE-STATE            PIC XX.                      
000060         16  BE-ZIP-CODE.                                         
000061             20  BE-ZIP-PRIME.                                    
000062                 24  BE-ZIP-1ST      PIC X.                       
000063                     88  BE-CANADIAN-POST-CODE                    
000064                                         VALUE 'A' THRU 'Z'.      
000065                 24  FILLER          PIC X(4).                    
000066             20  BE-ZIP-PLUS4        PIC X(4).                    
000067         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.     
000068             20  BE-CAN-POSTAL-1     PIC XXX.                     
000069             20  BE-CAN-POSTAL-2     PIC XXX.                     
000070             20  FILLER              PIC XXX.                     
000071         16  BE-PHONE-NO             PIC 9(11)     COMP-3.        
000072         16  BE-GROUP-CHECKS-Y-N     PIC X.                       
000073                                                                  
000074******************************************************************
000075*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
000076*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
000077******************************************************************
000078     12  BE-CARRIER                  PIC X.                       
000079                                                                  
000080     12  BE-ADDRESS-DATA2.                                        
000081         16  BE-MAIL-TO-NAME2        PIC X(30).                   
000082         16  BE-ADDRESS-LINE-12      PIC X(30).                   
000083         16  BE-ADDRESS-LINE-22      PIC X(30).                   
000084         16  BE-ADDRESS-LINE-32      PIC X(30).                   
000085         16  BE-CITY-STATE2.                                      
000086             20  BE-CITY2            PIC X(28).                   
000087             20  BE-STATE2           PIC XX.                      
000088         16  BE-ZIP-CODE2.                                        
000089             20  BE-ZIP-PRIME2.                                   
000090                 24  BE-ZIP-1ST2     PIC X.                       
000091                     88  BE-CANADIAN-POST-CODE2                   
000092                                         VALUE 'A' THRU 'Z'.      
000093                 24  FILLER          PIC X(4).                    
000094             20  BE-ZIP-PLUS42       PIC X(4).                    
000095         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.    
000096             20  BE-CAN-POSTAL-12    PIC XXX.                     
000097             20  BE-CAN-POSTAL-22    PIC XXX.                     
000098             20  FILLER              PIC XXX.                     
000099         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.        
000100         16  BE-ACH-DATA.                                         
000101             20  BE-ACH-YES-OR-NO    PIC X.                       
000102                 88  BE-ON-ACH       VALUE 'Y'.                   
000103                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.               
000104             20  BE-ACH-ABA-ROUTING-NUMBER                        
000105                                     PIC X(15).                   
000106             20  BE-ACH-BANK-ACCOUNT-NUMBER                       
000107                                     PIC X(20).                   
000108             20  BE-ACH-SUB-TYPE     PIC XX.                      
000109             20  BE-ACH-EMAIL-YN     PIC X.                       
000110                 88  BE-EMAIL-ACH-RPT  VALUE 'Y'.                 
000111             20  be-ach-email-addr   PIC X(40).                   
000112         16  BE-BILLING-STMT-DATA.                                
000113*            20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.        
000114             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.        
000115             20  BE-OUTPUT-TYPE      PIC X.                       
000116                 88  BE-FAX-OUTPUT         VALUE 'F'.             
000117                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.         
000118                                                                  
000119     12  filler                      PIC X(16).                   
000120******************************************************************
      *<<((file: ELCBENE))
001119     EJECT                                                        
001120*    COPY ELCARCH.                                                
      *>>((file: ELCARCH))
000001******************************************************************
000002*                                                                *
000003*                            ELCARCH.                            *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000005*                            VMOD=2.007                          *
000006*                                                                *
000007*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
000008*                                                                *
000009*   FILE TYPE = VSAM,KSDS                                        *
000010*   RECORD SIZE = 090  RECFORM = FIXED                           *
000011*                                                                *
000012*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
000013*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
000014*                                                                *
000015*   LOG = NO                                                     *
000016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000017*                                                                *
000018*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
000019******************************************************************
000020 01  LETTER-ARCHIVE.                                              
000021     12  LA-RECORD-ID                PIC XX.                      
000022         88  VALID-LA-ID                VALUE 'LA'.               
000023                                                                  
000024     12  LA-CONTROL-PRIMARY.                                      
000025         16  LA-COMPANY-CD           PIC X.                       
000026         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.          
000027         16  LA-RECORD-TYPE          PIC X.                       
000028             88  LA-HEADER-DATA         VALUE '1'.                
000029             88  LA-ADDRESS-DATA        VALUE '2'.                
000030             88  LA-TEXT-DATA           VALUE '3'.                
000031             88  LA-FORM-CONTROL-HDR    VALUE '4'.                
000032         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.          
000033                                                                  
000034     12  LA-CONTROL-BY-TYPE.                                      
000035         16  LA-COMPANY-CD-A1        PIC X.                       
000036         16  LA-RECORD-TYPE-A1       PIC X.                       
000037         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.          
000038         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.          
000039                                                                  
000040     12  LA-TEXT-RECORD.                                          
000041         16  LA-SKIP-CONTROL         PIC XX.                      
000042             88  NO-LINES-SKIPPED       VALUE SPACES.             
000043             88  SKIP-TO-NEXT-PAGE      VALUE '99'.               
000044         16  LA-TEXT-LINE            PIC X(70).                   
000045                                                                  
000046     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.            
000047         16  FILLER                  PIC XX.                      
000048         16  LA-ADDRESS-LINE         PIC X(30).                   
000049         16  FILLER                  PIC X(40).                   
000050                                                                  
000051     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.             
000052         16  FILLER                  PIC XX.                      
000053         16  LA-CARRIER              PIC X.                       
000054         16  LA-CLAIM-NO             PIC X(7).                    
000055         16  LA-CERT-NO.                                          
000056             20  LA-CERT-PRIME       PIC X(10).                   
000057             20  LA-CERT-SFX         PIC X.                       
000058         16  LA-NO-OF-COPIES         PIC S9.                      
000059         16  LA-RESEND-DATE          PIC XX.                      
000060         16  LA-PROCESSOR-CD         PIC X(4).                    
000061         16  LA-CREATION-DT          PIC XX.                      
000062         16  LA-INITIAL-PRINT-DATE   PIC XX.                      
000063         16  LA-RESEND-PRINT-DATE    PIC XX.                      
000064         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.           
000065         16  LA-1ST-RESEND-PRINT-DT  PIC XX.                      
000066*                                                                 
000067* -----  16  LA-DMD-ADDITIONAL-FIELDS.                            
000068*   I        20  LA-DMD-LETTER-FORM      PIC X(4).                
000069*   I        20  LA-DMD-PROD-CODE        PIC XX.                  
000070*   I        20  LA-DMD-RES-ST           PIC XX.                  
000071*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.       
000072*   I        20  LA-DMD-LETTER-STATUS    PIC X.                   
000073*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.            
000074*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.            
000075*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.            
000076*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.                  
000077*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.                  
000078*   I        20  LA-DMD-UND-CODE         PIC XX.                  
000079*   I        20  LA-DMD-BEN-CODE         PIC XX.                  
000080*   V    16  FILLER                  PIC X(15).                   
000081* -----                                                           
000082*                                                                 
000083* REINSERTED  CSO  MODS                                           
000084*                                                                 
000085         16  FILLER.                                              
000086             20  FILLER                  PIC X(29).               
000087             20  LA-CSO-LETTER-STATUS    PIC X.                   
000088                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.            
000089                 88  LA-CSO-LETTER-PURGED   VALUE '2'.            
000090                 88  LA-CSO-LETTER-RELOADED VALUE '3'.            
000091             20  LA-CSO-LETTER-PURGE-DT  PIC XX.                  
000092             20  LA-CSO-LETTER-RELOAD-DT PIC XX.                  
000093*                                                                 
000094                                                                  
000095     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.        
000096         16  FILLER                  PIC XX.                      
000097         16  LA4-CARRIER             PIC X.                       
000098         16  LA4-CLAIM-NO            PIC X(7).                    
000099         16  LA4-CERT-NO.                                         
000100             20  LA4-CERT-PRIME      PIC X(10).                   
000101             20  LA4-CERT-SFX        PIC X.                       
000102         16  LA4-NO-OF-COPIES        PIC S9.                      
000103         16  LA4-RESEND-DATE         PIC XX.                      
000104         16  LA4-PROCESSOR-CD        PIC X(4).                    
000105         16  LA4-CREATION-DT         PIC XX.                      
000106         16  LA4-INITIAL-PRINT-DATE  PIC XX.                      
000107         16  LA4-RESEND-PRINT-DATE   PIC XX.                      
000108         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.           
000109         16  LA4-FORM-TYPE           PIC X.                       
000110             88  LA4-INITIAL-FORM    VALUE '1'.                   
000111             88  LA4-PROGRESS-FORM   VALUE '2'.                   
000112         16  LA4-FORM-REM-PRINT-DT   PIC X(02).                   
000113         16  LA4-STATE               PIC X(02).                   
000114         16  FILLER                  PIC X(31).                   
000115******************************************************************
      *<<((file: ELCARCH))
001121     EJECT                                                        
001122*    COPY ELCDAR.                                                 
      *>>((file: ELCDAR))
000001******************************************************************
000002*                                                                *
000003*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
000004*   FILE TYPE = VSAM,KSDS                                        *
000005*   RECORD SIZE = 25   RECFORM = FIXED                           *
000006*   BASE CLUSTER = DLYACTV                                       *
000007*   LOG = YES                                                    *
000008*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
000009*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
000010*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
000011*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
000012*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
000013*               BY PROGRAM "LGINFCE".                            *
000014*                                                                *
000015******************************************************************
000016 01  DAILY-ACTIVITY-RECORD.                                       
000017     05  DA-KEY.                                                  
000018         10  DA-COMP-CD          PIC X.                           
000019         10  DA-CARRIER          PIC X.                           
000020         10  DA-CLAIM-NO         PIC X(7).                        
000021         10  DA-CERT-NO.                                          
000022             15  DA-CERT-PRIME   PIC X(10).                       
000023             15  DA-CERT-SFX     PIC X.                           
000024     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.                 
000025     05  DA-RECORD-TYPE          PIC X.                           
000026     05  FILLER                  PIC X(2).                        
000027******************************************************************
      *<<((file: ELCDAR))
001123     EJECT                                                        
001124*    COPY ERCCOMP.                                                
      *>>((file: ERCCOMP))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCCOMP                             *
000005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000006*                            VMOD=2.019                          *
000007*                                                                *
000008*   ONLINE CREDIT SYSTEM                                         *
000009*                                                                *
000010*   FILE DESCRIPTION = COMPENSATION MASTER                       *
000011*                                                                *
000012*   FILE TYPE = VSAM,KSDS                                        *
000013*   RECORD SIZE = 700   RECFORM = FIXED                          *
000014*                                                                *
000015*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
000016*       ALTERNATE PATH = NONE                                    *
000017*                                                                *
000018*   LOG = NO                                                     *
000019*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000020*                                                                *
000021******************************************************************
000022*                   C H A N G E   L O G                           
000023*                                                                 
000024* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.                
000025*-----------------------------------------------------------------
000026*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE            
000027* EFFECTIVE    NUMBER                                             
000028*-----------------------------------------------------------------
000029* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING          
000030* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS          
000031* 092205    2005050300006  PEMA  ADD LEASE FEE                    
000032* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE           
000033* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS       
000034* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT           
000035* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT            
000036* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING      
000037* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY        
000038******************************************************************
000039                                                                  
000040 01  COMPENSATION-MASTER.                                         
000041     12  CO-RECORD-ID                          PIC XX.            
000042         88  VALID-CO-ID                          VALUE 'CO'.     
000043                                                                  
000044     12  CO-CONTROL-PRIMARY.                                      
000045         16  CO-COMPANY-CD                     PIC X.             
000046         16  CO-CONTROL.                                          
000047             20  CO-CTL-1.                                        
000048                 24  CO-CARR-GROUP.                               
000049                     28  CO-CARRIER            PIC X.             
000050                     28  CO-GROUPING.                             
000051                         32  CO-GROUP-PREFIX   PIC XXX.           
000052                         32  CO-GROUP-PRIME    PIC XXX.           
000053                 24  CO-RESP-NO.                                  
000054                     28  CO-RESP-PREFIX        PIC X(4).          
000055                     28  CO-RESP-PRIME         PIC X(6).          
000056             20  CO-CTL-2.                                        
000057                 24  CO-ACCOUNT.                                  
000058                     28  CO-ACCT-PREFIX        PIC X(4).          
000059                     28  CO-ACCT-PRIME         PIC X(6).          
000060         16  CO-TYPE                           PIC X.             
000061             88  CO-COMPANY-TYPE                  VALUE 'C'.      
000062             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.             
000063             88  CO-ACCOUNT-TYPE                  VALUE 'A'.      
000064                                                                  
000065     12  CO-MAINT-INFORMATION.                                    
000066         16  CO-LAST-MAINT-DT                  PIC XX.            
000067         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3. 
000068         16  CO-LAST-MAINT-USER                PIC X(4).          
000069     12  FILLER                                PIC XX.            
000070     12  CO-STMT-TYPE                          PIC XXX.           
000071     12  CO-COMP-TYPE                          PIC X.             
000072         88  CO-COMP-IS-SPPDD                    VALUE '1'.       
000073     12  CO-STMT-OWNER                         PIC X(4).          
000074     12  CO-BALANCE-CONTROL                    PIC X.             
000075         88  CO-CARRY-BALANCE                     VALUE 'Y'.      
000076         88  CO-NO-BALANCE                        VALUE 'N'.      
000077                                                                  
000078     12  CO-INTERNAL-CONTROL-1                 PIC X.             
000079         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.      
000080         88  CO-AUTO-GENERATED                    VALUE 'Y'.      
000081         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.      
000082                                                                  
000083     12  CO-INTERNAL-CONTROL-2                 PIC X.             
000084         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.      
000085         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.      
000086                                                                  
000087     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
000088     12  CO-GA-DIRECT-DEP                      PIC X.             
000089     12  CO-FUTURE-SPACE                       PIC X.             
000090         88  CO-FUTURE-NOT-USED                   VALUE ' '.      
000091                                                                  
000092     12  CO-ACCT-NAME                          PIC X(30).         
000093     12  CO-MAIL-NAME                          PIC X(30).         
000094     12  CO-ADDR-1                             PIC X(30).         
000095     12  CO-ADDR-2                             PIC X(30).         
000096     12  CO-ADDR-3.                                               
000097         16  CO-ADDR-CITY                      PIC X(27).         
000098         16  CO-ADDR-STATE                     PIC XX.            
000099     12  CO-CSO-1099                           PIC X.             
000100     12  CO-ZIP.                                                  
000101         16  CO-ZIP-PRIME.                                        
000102             20  CO-ZIP-PRI-1ST                PIC X.             
000103                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.   
000104             20  FILLER                        PIC X(4).          
000105         16  CO-ZIP-PLUS4                      PIC X(4).          
000106     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.              
000107         16  CO-CAN-POSTAL-1                   PIC XXX.           
000108         16  CO-CAN-POSTAL-2                   PIC XXX.           
000109         16  FILLER                            PIC XXX.           
000110     12  CO-SOC-SEC                            PIC X(13).         
000111     12  CO-TELEPHONE.                                            
000112         16  CO-AREA-CODE                      PIC XXX.           
000113         16  CO-PREFIX                         PIC XXX.           
000114         16  CO-PHONE                          PIC X(4).          
000115                                                                  
000116     12  CO-ROLADEX-PRINT-DT                   PIC XX.            
000117                                                                  
000118     12  CO-AR-BAL-LEVEL                       PIC X.             
000119         88  CO-AR-REF-LVL                        VALUE '1'.      
000120         88  CO-AR-BILL-REF-LVL                   VALUE '1'.      
000121         88  CO-AR-BILL-LVL                       VALUE '2'.      
000122         88  CO-AR-AGT-LVL                        VALUE '3'.      
000123         88  CO-AR-FR-LVL                         VALUE '4'.      
000124                                                                  
000125     12  CO-AR-NORMAL-PRINT                    PIC X.             
000126         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.      
000127         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.      
000128                                                                  
000129     12  CO-AR-SUMMARY-CODE                    PIC X(6).          
000130                                                                  
000131     12  CO-AR-REPORTING                       PIC X.             
000132         88  CO-AR-NET-REPORT                     VALUE 'N'.      
000133         88  CO-AR-GROSS-REPORT                   VALUE 'G'.      
000134                                                                  
000135     12  CO-AR-PULL-CHECK                      PIC X.             
000136         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.      
000137         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.      
000138                                                                  
000139     12  CO-AR-BALANCE-PRINT                   PIC X.             
000140         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.      
000141                                                                  
000142     12  CO-AR-LAST-RUN-CODE                   PIC X.             
000143         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.      
000144         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.      
000145         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.      
000146                                                                  
000147     12  CO-LAST-EOM-STMT-DT                   PIC XX.            
000148                                                                  
000149     12  CO-USER-CODE                          PIC X.             
000150     12  CO-REPORT-GROUP-ID                    PIC X(12).         
000151                                                                  
000152******************************************************************
000153*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF  
000154*    THE LAST MONTH END RUN.                                      
000155******************************************************************
000156                                                                  
000157     12  CO-LAST-ACTIVITY-DATE.                                   
000158         16  CO-ACT-YEAR                       PIC 99.            
000159         16  CO-ACT-MONTH                      PIC 99.            
000160         16  CO-ACT-DAY                        PIC 99.            
000161                                                                  
000162     12  CO-LAST-STMT-DT.                                         
000163         16  CO-LAST-STMT-YEAR                 PIC 99.            
000164         16  CO-LAST-STMT-MONTH                PIC 99.            
000165         16  CO-LAST-STMT-DAY                  PIC 99.            
000166                                                                  
000167     12  CO-MO-END-TOTALS.                                        
000168         16  CO-MONTHLY-TOTALS.                                   
000169             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3. 
000170             20  CO-CUR-COM                PIC S9(7)V99   COMP-3. 
000171             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3. 
000172             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3. 
000173             20  CO-END-BAL                PIC S9(7)V99   COMP-3. 
000174                                                                  
000175         16  CO-AGING-TOTALS.                                     
000176             20  CO-CUR                    PIC S9(7)V99   COMP-3. 
000177             20  CO-OV30                   PIC S9(7)V99   COMP-3. 
000178             20  CO-OV60                   PIC S9(7)V99   COMP-3. 
000179             20  CO-OV90                   PIC S9(7)V99   COMP-3. 
000180                                                                  
000181         16  CO-YTD-TOTALS.                                       
000182             20  CO-YTD-COM                PIC S9(7)V99   COMP-3. 
000183             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3. 
000184                                                                  
000185         16  CO-OVER-UNDER-TOTALS.                                
000186             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3. 
000187             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3. 
000188                                                                  
000189     12  CO-MISCELLANEOUS-TOTALS.                                 
000190         16  CO-FICA-TOTALS.                                      
000191             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3. 
000192             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3. 
000193                                                                  
000194         16  CO-CLAIM-TOTALS.                                     
000195             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3. 
000196             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3. 
000197                                                                  
000198******************************************************************
000199*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT       
000200*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).                  
000201******************************************************************
000202                                                                  
000203     12  CO-CURRENT-TOTALS.                                       
000204         16  CO-CURRENT-LAST-STMT-DT.                             
000205             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.            
000206             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.            
000207             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.            
000208                                                                  
000209         16  CO-CURRENT-MONTHLY-TOTALS.                           
000210             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3. 
000211             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3. 
000212             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3. 
000213             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3. 
000214             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3. 
000215                                                                  
000216         16  CO-CURRENT-AGING-TOTALS.                             
000217             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3. 
000218             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3. 
000219             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3. 
000220             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3. 
000221                                                                  
000222         16  CO-CURRENT-YTD-TOTALS.                               
000223             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3. 
000224             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3. 
000225                                                                  
000226     12  CO-PAID-COMM-TOTALS.                                     
000227         16  CO-YTD-PAID-COMMS.                                   
000228             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3. 
000229             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3. 
000230                                                                  
000231     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.                 
000232         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.          
000233         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.          
000234                                                                  
000235     12  CO-DELINQUENT-LETTER-CODE         PIC X.                 
000236         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.          
000237         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.          
000238         88  CO-AGENT-1ST-LETTER              VALUE 'B'.          
000239         88  CO-AGENT-2ND-LETTER              VALUE 'G'.          
000240         88  CO-OVERWRITE-LETTER              VALUE 'O'.          
000241         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.          
000242         88  CO-FINAL-LETTER                  VALUE 'F'.          
000243         88  CO-RECONCILING                   VALUE 'R'.          
000244         88  CO-PHONE-CALL                    VALUE 'P'.          
000245         88  CO-LEGAL                         VALUE 'L'.          
000246         88  CO-COLLECTION-AGENCY             VALUE 'C'.          
000247         88  CO-WRITE-OFF                     VALUE 'W'.          
000248         88  CO-NO-ACTION                     VALUE 'N' ' '.      
000249                                                                  
000250     12  CO-CSR-CODE                       PIC X(4).              
000251                                                                  
000252     12  CO-GA-STATUS-INFO.                                       
000253         16  CO-GA-EFFECTIVE-DT            PIC XX.                
000254         16  CO-GA-TERMINATION-DT          PIC XX.                
000255         16  CO-GA-STATUS-CODE             PIC X.                 
000256             88  CO-GA-ACTIVE                 VALUE 'A'.          
000257             88  CO-GA-INACTIVE               VALUE 'I'.          
000258             88  CO-GA-PENDING                VALUE 'P'.          
000259         16  CO-GA-COMMENTS.                                      
000260             20  CO-GA-COMMENT-1           PIC X(40).             
000261             20  CO-GA-COMMENT-2           PIC X(40).             
000262             20  CO-GA-COMMENT-3           PIC X(40).             
000263             20  CO-GA-COMMENT-4           PIC X(40).             
000264                                                                  
000265     12  CO-RPTCD2                         PIC X(10).             
000266     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.                 
000267         16  CO-OV120                      PIC S9(7)V99   COMP-3. 
000268         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3. 
000269                                                                  
000270     12  CO-TYPE-AGENT                     PIC X(01).             
000271         88  CO-CORPORATION                   VALUE 'C'.          
000272         88  CO-PARTNERSHIP                   VALUE 'P'.          
000273         88  CO-SOLE-PROPRIETOR               VALUE 'S'.          
000274         88  CO-TRUST                         VALUE 'T'.          
000275         88  CO-UNKNOWN                       VALUE ' ' 'X'.      
000276                                                                  
000277     12  CO-FAXNO.                                                
000278         16  CO-FAX-AREA-CODE                  PIC XXX.           
000279         16  CO-FAX-PREFIX                     PIC XXX.           
000280         16  CO-FAX-PHONE                      PIC X(4).          
000281                                                                  
000282     12  CO-BANK-INFORMATION.                                     
000283         16  CO-BANK-TRANSIT-NO                PIC X(8).          
000284         16  CO-BANK-TRANSIT-NON REDEFINES                        
000285             CO-BANK-TRANSIT-NO                PIC 9(8).          
000286                                                                  
000287         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).         
000288     12  CO-MISC-DEDUCT-INFO REDEFINES                            
000289                  CO-BANK-INFORMATION.                            
000290         16  CO-MD-GL-ACCT                     PIC X(10).         
000291         16  CO-MD-DIV                         PIC XX.            
000292         16  CO-MD-CENTER                      PIC X(4).          
000293         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
000294         16  CO-CREATE-AP-CHECK                PIC X.             
000295         16  CO-DELIVER-CK-TO-MEL              PIC X.             
000296         16  FILLER                            PIC XXX.           
000297     12  CO-ACH-STATUS                         PIC X.             
000298         88  CO-ACH-ACTIVE                         VALUE 'A'.     
000299         88  CO-ACH-PENDING                        VALUE 'P'.     
000300                                                                  
000301     12  CO-BILL-SW                            PIC X.             
000302     12  CO-CONTROL-NAME                       PIC X(30).         
000303     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
000304     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
000305     12  CO-CLP-STATE                          PIC XX.            
000306     12  CO-FIRST-WRITTEN-DT                   PIC XX.            
000307     12  CO-SPP-REFUND-EDIT                    PIC X.             
000308                                                                  
000309******************************************************************
      *<<((file: ERCCOMP))
001125     EJECT                                                        
001126*    COPY ERCDMDNT.                                               
      *>>((file: ERCDMDNT))
000001******************************************************************
000002*                                                                *
000003*                            ERCDMDNT                            *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000005*                            VMOD=2.005                          *
000006*                                                                *
000007*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
000008*                                                                *
000009*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
000010*                                                                *
000011*        FILE TYPE= VSAM,KSDS                                    *
000012*        RECORD SIZE = 825    RECFORM = FIXED                    *
000013*                                                                *
000014*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
000015*                                                                *
000016*        LOG = YES                                               *
000017*        SERVREQ = DELETE,UPDATE,NEWREC                          *
000018*                                                                *
000019******************************************************************
000020                                                                  
000021 01  CERTIFICATE-NOTE.                                            
000022     12  CN-RECORD-ID                     PIC  XX.                
000023         88  VALID-CN-ID                      VALUE 'CN'.         
000024                                                                  
000025     12  CN-CONTROL-PRIMARY.                                      
000026         16  CN-COMPANY-CD                PIC X.                  
000027         16  CN-CERT-KEY.                                         
000028             20  CN-CARRIER               PIC X.                  
000029             20  CN-GROUPING.                                     
000030                 24  CN-GROUPING-PREFIX   PIC XXX.                
000031                 24  CN-GROUPING-PRIME    PIC XXX.                
000032             20  CN-STATE                 PIC XX.                 
000033             20  CN-ACCOUNT.                                      
000034                 24  CN-ACCOUNT-PREFIX    PIC X(4).               
000035                 24  CN-ACCOUNT-PRIME     PIC X(6).               
000036             20  CN-CERT-EFF-DT           PIC XX.                 
000037             20  CN-CERT-NO.                                      
000038                 24  CN-CERT-PRIME        PIC X(10).              
000039                 24  CN-CERT-SFX          PIC X.                  
000040                                                                  
000041     12  CN-BILLING-START-LINE-NO         PIC 99.                 
000042     12  CN-BILLING-END-LINE-NO           PIC 99.                 
000043                                                                  
000044     12  CN-LINES.                                                
000045         16  CN-LINE                      PIC X(77)  OCCURS 10.   
000046                                                                  
000047     12  CN-CSI-NOTES REDEFINES CN-LINES.                         
000048         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.    
000049         16  CN-CSI-GENERAL-DATA-AREA.                            
000050             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.    
000051                                                                  
000052         16  CN-CSI-GENERAL-DATA-R REDEFINES                      
000053             CN-CSI-GENERAL-DATA-AREA.                            
000054             20  CN-CSI-GEN-NOC-KEY           PIC X(11).          
000055             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).          
000056             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).          
000057             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).          
000058             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).          
000059             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).          
000060             20  CN-CSI-GEN-INFRM-MI          PIC X.              
000061             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).          
000062             20  CN-CSI-GEN-INFRM-REL         PIC X(15).          
000063             20  FILLER                       PIC XX.             
000064             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.             
000065             20  FILLER                       PIC X(38).          
000066                                                                  
000067         16  CN-CSI-PRODUCT-DATA-AREA.                            
000068             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.    
000069                                                                  
000070         16  CN-CSI-CREDIT-CARD-DATA REDEFINES                    
000071             CN-CSI-PRODUCT-DATA-AREA.                            
000072             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).               
000073             20  CN-CSI-CC-CANCEL-CD      PIC XX.                 
000074             20  CN-CSI-CC-CANCEL-DT      PIC X(8).               
000075             20  CN-CSI-CC-CARD-TYPE      PIC XX.                 
000076             20  CN-CSI-CC-CHANGE-AGE     PIC 999.                
000077             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).               
000078             20  FILLER                   PIC XX.                 
000079             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.   
000080             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.   
000081             20  CN-CSI-CC-INTEREST-PAID  PIC X.                  
000082             20  CN-CSI-CC-ISSUE-ST       PIC XX.                 
000083             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.   
000084             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.   
000085             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.   
000086             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.   
000087             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).              
000088             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.                
000089             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.   
000090             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.   
000091             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).               
000092             20  CN-CSI-CC-SIGNED-DT      PIC X(8).               
000093             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.   
000094             20  CN-CSI-CC-STMNT-DT       PIC X(8).               
000095             20  CN-CSI-CC-TERM-AGE       PIC 999.                
000096             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.   
000097             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.                  
000098             20  CN-CSI-CC-ISSUE-DT       PIC X(8).               
000099             20  CN-CSI-CC-BEN-CALC-SW    PIC X.                  
000100             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.                  
000101             20  FILLER                   PIC X(25).              
000102                                                                  
000103         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES                   
000104             CN-CSI-CREDIT-CARD-DATA.                             
000105             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).               
000106             20  CN-CSI-FL-CANCEL-CD      PIC XX.                 
000107             20  CN-CSI-FL-CANCEL-DT      PIC X(8).               
000108             20  CN-CSI-FL-CARD-TYPE      PIC XX.                 
000109             20  CN-CSI-FL-CHANGE-AGE     PIC 999.                
000110             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).               
000111             20  FILLER                   PIC XX.                 
000112             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.   
000113             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.   
000114             20  CN-CSI-FL-INTEREST-PAID  PIC X.                  
000115             20  CN-CSI-FL-ISSUE-ST       PIC XX.                 
000116             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.   
000117             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.   
000118             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.   
000119             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.   
000120             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).              
000121             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.                
000122             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.   
000123             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.   
000124             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).               
000125             20  CN-CSI-FL-SIGNED-DT      PIC X(8).               
000126             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.   
000127             20  CN-CSI-FL-STMNT-DT       PIC X(8).               
000128             20  CN-CSI-FL-TERM-AGE       PIC 999.                
000129             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.   
000130             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.                  
000131             20  CN-CSI-FL-ISSUE-DT       PIC X(8).               
000132             20  CN-CSI-FL-BEN-CALC-SW    PIC X.                  
000133             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.                  
000134             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).               
000135             20  FILLER                   PIC X(17).              
000136                                                                  
000137         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES                    
000138             CN-CSI-FAMILY-LEAVE-DATA.                            
000139             20  CN-CSI-SL-BENE-DOB       PIC X(8).               
000140             20  CN-CSI-SL-BENE-NAME      PIC X(27).              
000141             20  CN-CSI-SL-BENE-REL       PIC X(8).               
000142             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.   
000143             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).               
000144             20  CN-CSI-SL-CANCEL-DT      PIC X(8).               
000145             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).               
000146             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).               
000147             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.   
000148             20  CN-CSI-SL-INT-ON-PROCEEDS                        
000149                                          PIC S9(5)V99  COMP-3.   
000150             20  CN-CSI-SL-ISSUE-DT       PIC X(8).               
000151             20  CN-CSI-SL-ISSUE-ST       PIC XX.                 
000152             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.   
000153             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.   
000154             20  CN-CSI-SL-POLICY-BENEFITS                        
000155                                          PIC S9(5)V99  COMP-3.   
000156             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.                
000157             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.   
000158             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).               
000159             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.   
000160             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.   
000161             20  CN-CSI-SL-PREM-MODE      PIC 99.                 
000162             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.   
000163             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).               
000164             20  CN-CSI-SL-SIGNED-DT      PIC X(8).               
000165             20  CN-CSI-SL-STATE-NOT      PIC X.                  
000166             20  FILLER                   PIC XX.                 
000167                                                                  
000168         16  CN-CSI-PURCH-PROP-DATA REDEFINES                     
000169             CN-CSI-SENIOR-LIFE-DATA.                             
000170             20  CN-CSI-PP-CARD-TYPE      PIC XX.                 
000171             20  CN-CSI-PP-CHANGE-AGE     PIC 999.                
000172             20  CN-CSI-PP-BEN-PAID-TO-DATE                       
000173                                          PIC S9(5)V99  COMP-3.   
000174             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).               
000175             20  CN-CSI-PP-CANCEL-CD      PIC XX.                 
000176             20  CN-CSI-PP-CANCEL-DT      PIC X(8).               
000177             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).               
000178             20  CN-CSI-PP-ISSUE-DT       PIC X(8).               
000179             20  CN-CSI-PP-ISSUE-ST       PIC XX.                 
000180             20  CN-CSI-PP-MANUFACTURER   PIC X(17).              
000181             20  CN-CSI-PP-MODEL-NO       PIC X(8).               
000182             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).              
000183             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.                
000184             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.   
000185             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).               
000186             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).               
000187             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.   
000188             20  CN-CSI-PP-REPAIR         PIC X.                  
000189             20  CN-CSI-PP-REPLACE        PIC X.                  
000190             20  CN-CSI-PP-SERIAL-NO      PIC X(16).              
000191             20  CN-CSI-PP-SIGNED-DT      PIC X(8).               
000192             20  CN-CSI-PP-STMNT-DT       PIC X(8).               
000193             20  CN-CSI-PP-TERM-AGE       PIC 999.                
000194             20  FILLER                   PIC X(5).               
000195                                                                  
000196         16  CN-CSI-EXT-WARR-DATA REDEFINES                       
000197             CN-CSI-PURCH-PROP-DATA.                              
000198             20  CN-CSI-EW-CARD-TYPE      PIC XX.                 
000199             20  CN-CSI-EW-CHANGE-AGE     PIC 999.                
000200             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).               
000201             20  CN-CSI-EW-CANCEL-CD      PIC XX.                 
000202             20  CN-CSI-EW-CANCEL-DT      PIC X(8).               
000203             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).               
000204             20  CN-CSI-EW-ISSUE-DT       PIC X(8).               
000205             20  CN-CSI-EW-ISSUE-ST       PIC XX.                 
000206             20  CN-CSI-EW-MANUFACTURER   PIC X(17).              
000207             20  CN-CSI-EW-MODEL-NO       PIC X(8).               
000208             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).              
000209             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.                
000210             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.   
000211             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).               
000212             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).               
000213             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.   
000214             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.   
000215             20  CN-CSI-EW-REPLACE        PIC X.                  
000216             20  CN-CSI-EW-SERIAL-NO      PIC X(16).              
000217             20  CN-CSI-EW-SIGNED-DT      PIC X(8).               
000218             20  CN-CSI-EW-STMNT-DT       PIC X(8).               
000219             20  CN-CSI-EW-TERM-AGE       PIC 999.                
000220             20  CN-CSI-EW-WARRANTY-NO    PIC 99.                 
000221             20  FILLER                   PIC X(4).               
000222                                                                  
000223     12  CN-LAST-MAINT-DT                 PIC XX.                 
000224     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.   
000225     12  CN-LAST-MAINT-USER               PIC X(4).               
000226     12  FILLER                           PIC X(6).               
000227                                                                  
000228******************************************************************
      *<<((file: ERCDMDNT))
001127     EJECT                                                        
001128*    COPY ERCCNOT.                                                
      *>>((file: ERCCNOT))
000001******************************************************************
000002*                                                                *
000003*                            ERCCNOT                             *
000004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE            
000005*                            VMOD=2.003                          *
000006*                                                                *
000007*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
000008*                                                                *
000009*        FILE TYPE= VSAM,KSDS                                    *
000010*        RECORD SIZE = 150    RECFORM = FIXED                    *
000011*                                                                *
000012*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
000013*                                                                *
000014*        LOG = YES                                               *
000015*        SERVREQ = DELETE,UPDATE,NEWREC                          *
000016*                                                                *
000017******************************************************************
000018*                   C H A N G E   L O G                           
000019*                                                                 
000020* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.                
000021*-----------------------------------------------------------------
000022*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE            
000023* EFFECTIVE    NUMBER                                             
000024*-----------------------------------------------------------------
000025* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.         
000026******************************************************************
000027                                                                  
000028 01  CERT-NOTE-FILE.                                              
000029     12  CZ-RECORD-ID                PIC  XX.                     
000030         88  VALID-CZ-ID                  VALUE 'CZ'.             
000031                                                                  
000032     12  CZ-CONTROL-PRIMARY.                                      
000033         16  CZ-COMPANY-CD           PIC X.                       
000034         16  CZ-CARRIER              PIC X.                       
000035         16  CZ-GROUPING.                                         
000036             20 CZ-GROUPING-PREFIX   PIC XXX.                     
000037             20 CZ-GROUPING-PRIME    PIC XXX.                     
000038         16  CZ-STATE                PIC XX.                      
000039         16  CZ-ACCOUNT.                                          
000040             20 CZ-ACCOUNT-PREFIX    PIC X(4).                    
000041             20 CZ-ACCOUNT-PRIME     PIC X(6).                    
000042         16  CZ-CERT-EFF-DT          PIC XX.                      
000043         16  CZ-CERT-NO.                                          
000044             20  CZ-CERT-PRIME       PIC X(10).                   
000045             20  CZ-CERT-SFX         PIC X.                       
000046         16  CZ-RECORD-TYPE          PIC X.                       
000047             88  CERT-NOTE           VALUE '1'.                   
000048             88  CLAIM-CERT-NOTE     VALUE '2'.                   
000049         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.          
000050                                                                  
000051     12  CZ-LAST-MAINT-DT            PIC XX.                      
000052     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.          
000053     12  CZ-LAST-MAINT-USER          PIC X(4).                    
000054                                                                  
000055     12  CZ-NOTE-INFORMATION.                                     
000056         16  CZ-NOTE                 PIC X(63).                   
000057         16  FILLER                  PIC X(39).                   
000058******************************************************************
      *<<((file: ERCCNOT))
001129*                            COPY ERCPDEF.                        
      *>>((file: ERCPDEF))
000001******************************************************************
000002*                                                                *
000003*                                                                *
000004*                            ERCPDEF.                            *
000005*                                                                *
000006*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
000007*                                                                *
000008*    FILE TYPE = VSAM,KSDS                                       *
000009*    RECORD SIZE = 1319 RECFORM = FIXED                          *
000010*                                                                *
000011*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
000012*                                                                *
000013*    LOG = YES                                                   *
000014*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000015******************************************************************
000016*                   C H A N G E   L O G                           
000017*                                                                 
000018* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.                
000019*-----------------------------------------------------------------
000020*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE            
000021* EFFECTIVE    NUMBER                                             
000022*-----------------------------------------------------------------
000023* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES          
000024* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE      
000025* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT               
000026* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE             
000027******************************************************************
000028 01  PRODUCT-MASTER.                                              
000029    12  PD-RECORD-ID                 PIC X(02).                   
000030        88  VALID-PD-ID                  VALUE 'PD'.              
000031                                                                  
000032    12  PD-CONTROL-PRIMARY.                                       
000033        16  PD-COMPANY-CD            PIC X.                       
000034        16  PD-STATE                 PIC XX.                      
000035        16  PD-PRODUCT-CD            PIC XXX.                     
000036        16  PD-FILLER                PIC X(7).                    
000037        16  PD-BEN-TYPE              PIC X.                       
000038        16  PD-BEN-CODE              PIC XX.                      
000039        16  PD-PROD-EXP-DT           PIC XX.                      
000040                                                                  
000041    12  FILLER                       PIC X(50).                   
000042                                                                  
000043    12  PD-PRODUCT-DATA OCCURS 8.                                 
000044        16  PD-PROD-CODE             PIC X.                       
000045            88  PD-PROD-LIFE           VALUE 'L'.                 
000046            88  PD-PROD-PROP           VALUE 'P'.                 
000047            88  PD-PROD-AH             VALUE 'A'.                 
000048            88  PD-PROD-IU             VALUE 'I'.                 
000049            88  PD-PROD-GAP            VALUE 'G'.                 
000050            88  PD-PROD-FAML           VALUE 'F'.                 
000051            88  PD-PROD-OTH            VALUE 'O'.                 
000052        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.      
000053        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.      
000054        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.      
000055        16  PD-MAX-TERM              PIC S999        COMP-3.      
000056        16  PD-MAX-AMT               PIC S9(07)      COMP-3.      
000057        16  FILLER                   PIC X.                       
000058        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.                      
000059        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.      
000060        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.      
000061        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.      
000062        16  PD-CRIT-PERIOD           PIC S999        COMP-3.      
000063        16  PD-REC-CRIT-PERIOD       PIC 99.                      
000064        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.        
000065            20  PD-RECURRING-YN      PIC X.                       
000066            20  FILLER               PIC X.                       
000067        16  PD-RTW-MOS               PIC 99.                      
000068        16  PD-MAX-EXTENSION         PIC 99.                      
000069        16  pd-ben-pct               pic sv999 comp-3.            
000070*       16  FILLER                   PIC XX.                      
000071                                                                  
000072    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.      
000073                                                                  
000074    12  PD-TERM-LIMITS OCCURS 15.                                 
000075        16  PD-LOW-TERM              PIC S999        COMP-3.      
000076        16  PD-HI-TERM               PIC S999        COMP-3.      
000077                                                                  
000078*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE        
000079    12  PD-LOAN-AMT-LIMITS OCCURS 15.                             
000080        16  PD-LOW-AMT               PIC S9(5)       COMP-3.      
000081        16  PD-HI-AMT                PIC S9(7)       COMP-3.      
000082                                                                  
000083    12  PD-EARN-FACTORS.                                          
000084        16  FILLER OCCURS 15.                                     
000085            20  FILLER OCCURS 15.                                 
000086                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.      
000087                                                                  
000088    12  PD-PRODUCT-DESC              PIC X(80).                   
000089    12  PD-TRUNCATED                 PIC X.                       
000090    12  FILLER                       PIC X(59).                   
000091                                                                  
000092    12  PD-MAINT-INFORMATION.                                     
000093        16  PD-LAST-MAINT-DT         PIC X(02).                   
000094        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.      
000095        16  PD-LAST-MAINT-BY         PIC X(04).                   
      *<<((file: ERCPDEF))
001130*                            COPY ELCCRTT.                        
      *>>((file: ELCCRTT))
000001******************************************************************
000002*                                                                *
000003*                            ELCCRTT.                            *
000004*                                                                *
000005*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
000006*                                                                *
000007*   FILE TYPE = VSAM,KSDS                                        *
000008*   RECORD SIZE = 552  RECFORM = FIXED                           *
000009*                                                                *
000010*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
000011*                                                                *
000012*   LOG = YES                                                    *
000013*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
000014******************************************************************
000015*                   C H A N G E   L O G                           
000016*                                                                 
000017* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.                
000018*-----------------------------------------------------------------
000019*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE            
000020* EFFECTIVE    NUMBER                                             
000021*-----------------------------------------------------------------
000022* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM      
000023* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
000024* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
000025* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG             
000026* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES        
000027* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES          
000028* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE      
000029* 022715  CR2015010800003  PEMA  AGENT SIGNATURE                  
000030* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY              
000031* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS         
000032* 091318  CR2018073000001  PEMA  ADD Refund methods               
000033* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE             
000034******************************************************************
000035                                                                  
000036 01  CERTIFICATE-TRAILERS.                                        
000037     12  CS-RECORD-ID                      PIC XX.                
000038         88  VALID-CS-ID                      VALUE 'CS'.         
000039                                                                  
000040     12  CS-CONTROL-PRIMARY.                                      
000041         16  CS-COMPANY-CD                 PIC X.                 
000042         16  CS-CARRIER                    PIC X.                 
000043         16  CS-GROUPING                   PIC X(6).              
000044         16  CS-STATE                      PIC XX.                
000045         16  CS-ACCOUNT                    PIC X(10).             
000046         16  CS-CERT-EFF-DT                PIC XX.                
000047         16  CS-CERT-NO.                                          
000048             20  CS-CERT-PRIME             PIC X(10).             
000049             20  CS-CERT-SFX               PIC X.                 
000050         16  CS-TRAILER-TYPE               PIC X.                 
000051             88  COMM-TRLR           VALUE 'A'.                   
000052             88  CLAIM-HISTORY-TRLR  VALUE 'B'.                   
000053             88  CERT-DATA-TRLR      VALUE 'C'.                   
000054                                                                  
000055     12  CS-DATA-AREA                      PIC X(516).            
000056                                                                  
000057     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.              
000058         16  CS-BANK-COMMISSION-AREA.                             
000059             20  CS-BANK-COMMS       OCCURS 10.                   
000060                 24  CS-AGT                PIC X(10).             
000061                 24  CS-COM-TYP            PIC X.                 
000062                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3. 
000063                 24  CS-RECALC-LV-INDIC    PIC X.                 
000064                 24  FILLER                PIC X(10).             
000065                                                                  
000066         16  FILLER                        PIC X(256).            
000067                                                                  
000068     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.         
000069****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)           
000070                                                                  
000071         16  CS-MB-CLAIM-DATA OCCURS 24.                          
000072             20  CS-CLAIM-NO               PIC X(7).              
000073             20  CS-CLAIM-TYPE             PIC X.                 
000074                 88  CS-AH-CLM               VALUE 'A'.           
000075                 88  CS-IU-CLM               VALUE 'I'.           
000076                 88  CS-GP-CLM               VALUE 'G'.           
000077                 88  CS-LF-CLM               VALUE 'L'.           
000078                 88  CS-PR-CLM               VALUE 'P'.           
000079                 88  CS-FL-CLM               VALUE 'F'.           
000080                 88  CS-OT-CLM               VALUE 'O'.           
000081             20  CS-INSURED-TYPE           PIC X.                 
000082                 88  CS-PRIM-INSURED          VALUE 'P'.          
000083                 88  CS-CO-BORROWER           VALUE 'C'.          
000084             20  CS-BENEFIT-PERIOD         PIC 99.                
000085             20  CS-DAYS-PAID              PIC S9(5) COMP-3.      
000086             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.   
000087             20  CS-REMAINING-BENS         PIC S999 COMP-3.       
000088         16  FILLER                        PIC X(12).             
000089                                                                  
000090     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.                     
000091         16  CS-VIN-NUMBER                 PIC X(17).             
000092         16  CS-REFUND-CLAIM-FLAG          PIC X(01).             
000093         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).             
000094         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).             
000095         16  cs-agent-name.                                       
000096             20  cs-agent-fname            pic x(20).             
000097             20  cs-agent-mi               pic x.                 
000098             20  cs-agent-lname            pic x(25).             
000099         16  cs-license-no                 pic x(15).             
000100         16  cs-npn-number                 pic x(10).             
000101         16  cs-agent-edit-status          pic x.                 
000102             88  cs-ae-refer-to-manager      value 'M'.           
000103             88  cs-ae-cover-sheet           value 'C'.           
000104             88  cs-ae-sig-form              value 'S'.           
000105             88  cs-ae-verified              value 'V'.           
000106             88  cs-unidentified-signature   value 'U'.           
000107             88  cs-cert-returned            value 'R'.           
000108             88  cs-accept-no-commission     value 'N'.           
000109         16  cs-year                       pic 9999.              
000110         16  cs-make                       pic x(20).             
000111         16  cs-model                      pic x(20).             
000112         16  cs-future                     pic x(20).             
000113         16  cs-vehicle-odometer           pic s9(7) comp-3.      
000114         16  cs-claim-verification-status  pic x.                 
000115             88  cs-clm-ver-eligible         value 'A'.           
000116             88  cs-clm-ver-partial-elig     value 'B'.           
000117             88  cs-clm-ver-not-eligible     value 'C'.           
000118             88  cs-clm-ver-not-elig-opn-clm value 'D'.           
000119             88  cs-clm-ver-not-part-elig-rw value 'E'.           
000120             88  cs-clm-ver-ND-CERT          value 'F'.           
000121             88  cs-clm-ver-spec-other       value 'G'.           
000122             88  cs-clam-ver-pratial-corrected                    
000123                                             value 'H'.           
000124             88  cs-clm-ver-no-matches       value 'I'.           
000125             88  cs-clm-ver-not-elig-corrected                    
000126                                             value 'J'.           
000127             88  cs-clm-ver-needs-review     value 'R'.           
000128             88  cs-clm-ver-sent-to-claims   value 'W'.           
000129         16  CS-LF-REFUND-METHOD           PIC X.                 
000130         16  CS-AH-REFUND-METHOD           PIC X.                 
000131         16  FILLER                        PIC X(353). *> was 420 
000132*        16  FILLER                        PIC X(496).            
      *<<((file: ELCCRTT))
001131                                                                  
001132 PROCEDURE DIVISION.                                              
001132 VCOBOL-DUMMY-PROCEDURE.
001133                                                                  
001134     IF EIBCALEN = 0                                              
001135         GO TO 8800-UNAUTHORIZED-ACCESS.                          
001136                                                                  
001137     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.      
001138     MOVE EIBTRMID               TO QID-TERM.                     
001139     MOVE 2                      TO EMI-NUMBER-OF-LINES.          
001140     MOVE '2'                    TO EMI-SWITCH2.                  
001141     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.         
001142     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.           
001143                                                                  
001144     MOVE EIBDATE                TO DC-JULIAN-YYDDD.              
001145     MOVE '5'                    TO DC-OPTION-CODE.               
001146     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
001147     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE                 
001148                                    SAVE-BIN-DATE.                
001149     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.                    
001150     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.                
001151                                                                  
001152     IF SAVE-DATE-YY > 70                                         
001153         MOVE 19                 TO SAVE-DATE-CC                  
001154     ELSE                                                         
001155         MOVE 20                 TO SAVE-DATE-CC.                 
001156                                                                  
001157     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES                      
001158         MOVE PI-PROOF-DATE TO WS-PROOF-DATE                      
001159     END-IF.                                                      
001160                                                                  
001161     IF PI-PRINT-EOB-YN = 'Y' OR 'S'                              
001162        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN               
001163     ELSE                                                         
001164        MOVE 'N'                 TO WS-PRINT-EOB-YN               
001165     END-IF                                                       
001166                                                                  
001167     IF PI-PRINT-CLM-FRM-YN = 'N'                                 
001168         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN          
001169     ELSE                                                         
001170         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN           
001171     END-IF                                                       
001172                                                                  
001173     IF PI-PRINT-SURVEY-YN = 'N'                                  
001174         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN            
001175     ELSE                                                         
001176         MOVE 'Y'                TO WS-PRINT-SURVEY-YN            
001177     END-IF                                                       
001178                                                                  
001179     IF PI-SPECIAL-RELEASE-YN = 'Y'                               
001180         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN      
001181     ELSE                                                         
001182         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN         
001183     END-IF                                                       
001184                                                                  
001185     EXEC CICS HANDLE CONDITION                                   
001186         NOTOPEN   (9990-ABEND)                                   
001187         PGMIDERR  (8600-PGRM-NOT-FOUND)                          
001188         MAPFAIL   (0400-FIRST-TIME)                              
001189         DUPREC    (6180-DUPREC)                                  
001190         ERROR     (9990-ABEND)                                   
001191     END-EXEC.                                                    
001192                                                                  
001193     IF PI-RETURN-TO-PROGRAM = THIS-PGM                           
001194         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.                
001195                                                                  
001196     IF PI-CALLING-PROGRAM NOT = THIS-PGM                         
001197         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM                   
001198             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6      
001199             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5      
001200             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4      
001201             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3      
001202             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2      
001203             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1      
001204             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM    
001205             MOVE THIS-PGM             TO PI-CALLING-PROGRAM      
001206             MOVE LOW-VALUES           TO EL156AI                 
001207             MOVE 'Y'                  TO FIRST-ENTRY             
001208         ELSE                                                     
001209             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM      
001210             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM    
001211             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1      
001212             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2      
001213             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3      
001214             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4      
001215             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5      
001216             MOVE SPACES               TO PI-SAVED-PROGRAM-6.     
001217                                                                  
001218     IF RETURNED-FROM NOT = SPACES                                
001219        IF (RETURNED-FROM = 'EL614')                              
001220           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES 
001221           IF WS-SAVED-EOB-CODES NOT = SPACES                     
001222              MOVE 'Y'                TO WS-SET-NOTE2-MDT         
001223           ELSE                                                   
001224              MOVE 'N'                TO WS-SET-NOTE2-MDT         
001225           END-IF                                                 
001226        END-IF                                                    
001227         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT         
001228            MOVE 'Y'             TO FIRST-ENTRY                   
001229            IF RETURNED-FROM = 'EL614'                            
001230               AND (PI-PASS-SW NOT = 'C')                         
001231               IF WS-SAVED-EOB-CODES NOT = SPACES                 
001232                  MOVE WS-SAVED-EOB-CODES                         
001233                                 TO PI-PMTNOTE2                   
001234                                    WS-PMTNOTE2                   
001235                  MOVE 'Y'       TO PI-EOB-CODES-EXIST            
001236               ELSE                                               
001237                  MOVE SPACES    TO PI-PMTNOTE2                   
001238                                    WS-PMTNOTE2                   
001239                                    PI-EOB-CODES-EXIST            
001240               END-IF                                             
001241            END-IF                                                
001242            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT           
001243                                                                  
001244            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
001245                                                                  
001246            IF RETURNED-FROM = 'EL614'                            
001247               GO TO 1000-EDIT-DATA                               
001248            END-IF                                                
001249            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND              
001250               (PAYEEI   = LOW-VALUES OR SPACES)                  
001251               GO TO 8100-SEND-INITIAL-MAP                        
001252            ELSE                                                  
001253               GO TO 1000-EDIT-DATA.                              
001254                                                                  
001255     IF EIBTRNID NOT = TRANS-ID                                   
001256         GO TO 0400-FIRST-TIME.                                   
001257                                                                  
001258     IF EIBAID = DFHCLEAR                                         
001259        IF PI-PASS-SW = 'C'                                       
001260           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT       
001261           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT       
001262           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT        
001263           MOVE 'Y'            TO RETURNED-FROM-B                 
001264           GO TO 1000-EDIT-DATA                                   
001265        ELSE                                                      
001266           GO TO 9400-CLEAR.                                      
001267                                                                  
001268     IF PI-PASS-SW = 'C'                                          
001269         MOVE MAP-NAMEB          TO MAP-NAME                      
001270         IF EIBAID = DFHPF1 OR DFHPF13                            
001271             GO TO 5000-UPDATE                                    
001272           ELSE                                                   
001273             IF EIBAID NOT = DFHENTER                             
001274                 MOVE LOW-VALUES TO EL156BI                       
001275                 MOVE MAP-NAMEB  TO MAP-NAME                      
001276                 MOVE ER-0029    TO EMI-ERROR                     
001277                 MOVE -1         TO  ENTPFBL                      
001278                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         
001279                 GO TO 8200-SEND-DATAONLY.                        
001280                                                                  
001281     EJECT                                                        
001282 0200-RECEIVE.                                                    
001283     MOVE LOW-VALUES             TO EL156AI.                      
001284     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3                       
001285         MOVE ER-0008            TO EMI-ERROR                     
001286         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
001287         IF PI-PASS-SW = 'C'                                      
001288             MOVE -1             TO ENTPFBL                       
001289             GO TO 8200-SEND-DATAONLY                             
001290         ELSE                                                     
001291             MOVE -1             TO PMTTYPEL                      
001292             GO TO 8200-SEND-DATAONLY.                            
001293                                                                  
001294     IF PI-COMPANY-ID = 'DMD'                                     
001295         PERFORM 7700-GET-DCT THRU 7700-EXIT.                     
001296                                                                  
001297     IF PI-PASS-SW = 'C'                                          
001298         MOVE MAP-NAMEB          TO MAP-NAME.                     
001299                                                                  
001300     EXEC CICS RECEIVE                                            
001301         MAP   (MAP-NAME)                                         
001302         MAPSET(MAPSET-NAME)                                      
001303         ASIS                                                     
001304         INTO  (EL156AI)                                          
001305     END-EXEC.                                                    
001306                                                                  
001307     IF PI-PASS-SW NOT = 'C'                                      
001308         GO TO 0250-MAPA.                                         
001309                                                                  
001310     IF ENTPFBL NOT > ZERO                                        
001311         MOVE MAP-NAMEB          TO MAP-NAME                      
001312         MOVE ER-0029            TO EMI-ERROR                     
001313         MOVE -1                 TO  ENTPFBL                      
001314         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
001315         GO TO 8200-SEND-DATAONLY.                                
001316                                                                  
001317     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)              
001318         MOVE PF-VALUES (ENTPFBI) TO EIBAID                       
001319       ELSE                                                       
001320         MOVE MAP-NAMEB           TO MAP-NAME                     
001321         MOVE ER-0029             TO EMI-ERROR                    
001322         MOVE -1                  TO ENTPFBL                      
001323         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
001324         GO TO 8200-SEND-DATAONLY.                                
001325                                                                  
001326     IF EIBAID = DFHPF1 OR DFHPF13                                
001327         IF MODIFY-CAP                                            
001328            GO TO 5000-UPDATE                                     
001329          ELSE                                                    
001330            MOVE 'UPDATE'           TO SM-READ                    
001331            PERFORM 9995-SECURITY-VIOLATION                       
001332            MOVE MAP-NAMEB          TO MAP-NAME                   
001333            MOVE ER-0070            TO EMI-ERROR                  
001334            MOVE -1                 TO  ENTPFBL                   
001335            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              
001336            GO TO 8200-SEND-DATAONLY.                             
001337                                                                  
001338 0250-MAPA.                                                       
001339     IF ENTERPFL = 0                                              
001340         GO TO 0300-CHECK-PFKEYS.                                 
001341                                                                  
001342     IF EIBAID NOT = DFHENTER                                     
001343         MOVE ER-0004            TO EMI-ERROR                     
001344         GO TO 0320-INPUT-ERROR.                                  
001345                                                                  
001346     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)            
001347         MOVE PF-VALUES (ENTERPFI) TO EIBAID                      
001348     ELSE                                                         
001349         MOVE ER-0029            TO EMI-ERROR                     
001350         GO TO 0320-INPUT-ERROR.                                  
001351                                                                  
001352 0300-CHECK-PFKEYS.                                               
001353     IF EIBAID = DFHPF7 OR DFHPF8                                 
001354         GO TO 8820-PF7-8.                                        
001355                                                                  
001356     IF EIBAID = DFHPF23                                          
001357         GO TO 8810-PF23.                                         
001358                                                                  
001359     IF EIBAID = DFHPF24                                          
001360         GO TO 9200-RETURN-MAIN-MENU.                             
001361                                                                  
001362     IF EIBAID = DFHPF12                                          
001363         GO TO 9500-PF12.                                         
001364                                                                  
001365     IF EIBAID = DFHPF1                                           
001366        IF PI-PASS-SW = 'A' OR 'B'                                
001367          GO TO 0330-BROWSE-FORWARD.                              
001368                                                                  
001369     IF EIBAID = DFHPF2                                           
001370        IF PI-PASS-SW = 'A' OR 'B'                                
001371          GO TO 0350-BROWSE-BACKWARD.                             
001372                                                                  
001373     IF EIBAID = DFHPF6                                           
001374        IF PI-EOB-CODES-EXIST = 'Y'                               
001375           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2                
001376        ELSE                                                      
001377           MOVE SPACES              TO WS-PMTNOTE2                
001378        END-IF                                                    
001379         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT      
001380         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT                     
001381            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT                 
001382         END-IF                                                   
001383         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT          
001384         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'      
001385               OR 'FNL'                                           
001386             MOVE 'EL614'        TO PGM-NAME                      
001387             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA          
001388             GO TO 9300-XCTL                                      
001389         ELSE                                                     
001390             MOVE XCTL-157       TO PGM-NAME                      
001391             GO TO 9300-XCTL.                                     
001392                                                                  
001393     IF EIBAID = DFHPF9                                           
001394        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT          
001395        MOVE XCTL-141            TO PGM-NAME                      
001396        GO TO 9300-XCTL.                                          
001397                                                                  
001398     IF EIBAID = DFHPF10                                          
001399        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT          
001400        MOVE XCTL-155            TO PGM-NAME                      
001401        GO TO 9300-XCTL.                                          
001402                                                                  
001403     MOVE SPACES                 TO ERRMSG0O                      
001404                                    ERRMSG1O                      
001405                                    ERRMSG2O.                     
001406                                                                  
001407     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5                       
001408         IF PI-PASS-SW NOT = 'B'                                  
001409             MOVE ER-0422        TO EMI-ERROR                     
001410             GO TO 0320-INPUT-ERROR                               
001411           ELSE                                                   
001412             GO TO 0700-TEST-FOR-CHANGES.                         
001413                                                                  
001414     IF EIBAID = DFHPF11                                          
001415        IF PI-PASS-SW = 'C'                                       
001416           MOVE ER-0029          TO EMI-ERROR                     
001417           GO TO 0320-INPUT-ERROR.                                
001418                                                                  
001419     IF EIBAID = DFHENTER OR DFHPF11                              
001420        NEXT SENTENCE                                             
001421     ELSE                                                         
001422        MOVE ER-0029             TO EMI-ERROR                     
001423        GO TO 0320-INPUT-ERROR.                                   
001424                                                                  
001425                                                                  
001426     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.         
001427                                                                  
001428     if pi-epyfrom not = zeros                                    
001429        if pi-epyfrom not = ws-epyfrom                            
001430           move zeros        to ws-edays                          
001431        end-if                                                    
001432     end-if                                                       
001433                                                                  
001434     if pi-epythru not = zeros                                    
001435        if pi-epythru not = ws-epythru                            
001436           move zeros        to ws-edays                          
001437        end-if                                                    
001438     end-if                                                       
001439                                                                  
001440     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT                         
001441         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT                 
001442         GO TO 1000-EDIT-DATA                                     
001443     ELSE                                                         
001444         IF PI-FATAL-COUNT NOT = 0 OR                             
001445            PI-FORCE-COUNT NOT = 0                                
001446             GO TO 1000-EDIT-DATA                                 
001447         ELSE                                                     
001448             GO TO 2000-EDIT-DONE.                                
001449                                                                  
001450 0320-INPUT-ERROR.                                                
001451     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
001452                                                                  
001453     IF ENTERPFL = 0                                              
001454         MOVE -1                 TO PMTTYPEL                      
001455     ELSE                                                         
001456         MOVE AL-UNBON           TO ENTERPFA                      
001457         MOVE -1                 TO ENTERPFL.                     
001458                                                                  
001459     GO TO 8200-SEND-DATAONLY.                                    
001460                                                                  
001461     EJECT                                                        
001462 0330-BROWSE-FORWARD.                                             
001463                                                                  
001464     MOVE CLMNOI            TO PI-CLAIM-NO.                       
001465     MOVE CARRI             TO PI-CARRIER.                        
001466     MOVE CERTNOI           TO PI-CERT-PRIME.                     
001467     MOVE SUFXI             TO PI-CERT-SFX.                       
001468                                                                  
001469     MOVE PI-CARRIER        TO MSTR-CARRIER.                      
001470     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.                      
001471     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.                     
001472     MOVE PI-CERT-NO        TO MSTR-CERT-NO.                      
001473                                                                  
001474     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.                
001475                                                                  
001476     EXEC CICS HANDLE CONDITION                                   
001477          NOTFND   (0380-CLAIM-END-FILE)                          
001478          ENDFILE  (0380-CLAIM-END-FILE)                          
001479     END-EXEC.                                                    
001480                                                                  
001481     EXEC CICS STARTBR                                            
001482          DATASET    ('ELMSTR')                                   
001483          RIDFLD     (ELMSTR-KEY)                                 
001484          GTEQ                                                    
001485     END-EXEC.                                                    
001486                                                                  
001487     MOVE 'Y' TO WS-BROWSE-START-SW.                              
001488                                                                  
001489 0335-READNEXT.                                                   
001490                                                                  
001491     EXEC CICS READNEXT                                           
001492          DATASET    ('ELMSTR')                                   
001493          RIDFLD     (ELMSTR-KEY)                                 
001494          SET        (ADDRESS OF CLAIM-MASTER)                    
001495     END-EXEC.                                                    
001496                                                                  
001497     IF PI-COMPANY-CD NOT = MSTR-COMP-CD                          
001498        GO TO 0380-CLAIM-END-FILE.                                
001499                                                                  
001500     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY                           
001501        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO                
001502        GO TO 0335-READNEXT.                                      
001503                                                                  
001504     IF PI-COMPANY-ID = 'CRI'                                     
001505         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO                     
001506            GO TO 0380-CLAIM-END-FILE.                            
001507                                                                  
001508     IF CL-SYSTEM-IDENTIFIER = 'CV'                               
001509         GO TO 0335-READNEXT.                                     
001510                                                                  
001511     IF PI-CARRIER-SECURITY > SPACES                              
001512         IF CL-CARRIER = PI-CARRIER-SECURITY                      
001513             NEXT SENTENCE                                        
001514         ELSE                                                     
001515             GO TO 0335-READNEXT.                                 
001516                                                                  
001517     IF PI-ACCOUNT-SECURITY > SPACES                              
001518         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY                 
001519             NEXT SENTENCE                                        
001520         ELSE                                                     
001521             GO TO 0335-READNEXT.                                 
001522                                                                  
001523     MOVE MSTR-CARRIER      TO PI-CARRIER.                        
001524     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.                       
001525     MOVE MSTR-CERT-NO      TO PI-CERT-NO.                        
001526                                                                  
001527     GO TO 0400-FIRST-TIME.                                       
001528                                                                  
001529 0350-BROWSE-BACKWARD.                                            
001530                                                                  
001531     MOVE CLMNOI            TO PI-CLAIM-NO                        
001532                               PI-PREV-CLMNO.                     
001533     MOVE CARRI             TO PI-CARRIER.                        
001534     MOVE CERTNOI           TO PI-CERT-PRIME.                     
001535     MOVE SUFXI             TO PI-CERT-SFX.                       
001536                                                                  
001537     MOVE PI-CARRIER        TO MSTR-CARRIER.                      
001538                                                                  
001539     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.                      
001540     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.                     
001541     MOVE PI-CERT-NO        TO MSTR-CERT-NO.                      
001542                                                                  
001543     EXEC CICS HANDLE CONDITION                                   
001544          NOTFND   (0380-CLAIM-END-FILE)                          
001545          ENDFILE  (0380-CLAIM-END-FILE)                          
001546     END-EXEC.                                                    
001547                                                                  
001548     EXEC CICS STARTBR                                            
001549          DATASET    ('ELMSTR')                                   
001550          RIDFLD     (ELMSTR-KEY)                                 
001551          GTEQ                                                    
001552     END-EXEC.                                                    
001553                                                                  
001554     MOVE 'Y' TO WS-BROWSE-START-SW.                              
001555                                                                  
001556     EXEC CICS READNEXT                                           
001557          DATASET    ('ELMSTR')                                   
001558          RIDFLD     (ELMSTR-KEY)                                 
001559          SET        (ADDRESS OF CLAIM-MASTER)                    
001560     END-EXEC.                                                    
001561                                                                  
001562     EXEC CICS READPREV                                           
001563          DATASET    ('ELMSTR')                                   
001564          RIDFLD     (ELMSTR-KEY)                                 
001565          SET        (ADDRESS OF CLAIM-MASTER)                    
001566     END-EXEC.                                                    
001567                                                                  
001568 0360-BROWSE-BACKWARD.                                            
001569                                                                  
001570     EXEC CICS READPREV                                           
001571          DATASET    ('ELMSTR')                                   
001572          RIDFLD     (ELMSTR-KEY)                                 
001573          SET        (ADDRESS OF CLAIM-MASTER)                    
001574     END-EXEC.                                                    
001575                                                                  
001576     IF PI-COMPANY-CD NOT = MSTR-COMP-CD                          
001577        GO TO 0380-CLAIM-END-FILE.                                
001578                                                                  
001579     IF PI-COMPANY-ID = 'CRI'                                     
001580         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO                     
001581            GO TO 0380-CLAIM-END-FILE.                            
001582                                                                  
001583     IF CL-SYSTEM-IDENTIFIER = 'CV'                               
001584         GO TO 0360-BROWSE-BACKWARD.                              
001585                                                                  
001586     IF PI-CARRIER-SECURITY > SPACES                              
001587         IF CL-CARRIER = PI-CARRIER-SECURITY                      
001588             NEXT SENTENCE                                        
001589         ELSE                                                     
001590             GO TO 0360-BROWSE-BACKWARD.                          
001591                                                                  
001592     IF PI-ACCOUNT-SECURITY > SPACES                              
001593         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY                 
001594             NEXT SENTENCE                                        
001595         ELSE                                                     
001596             GO TO 0360-BROWSE-BACKWARD.                          
001597                                                                  
001598     MOVE MSTR-CARRIER      TO PI-CARRIER.                        
001599     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.                       
001600     MOVE MSTR-CERT-NO      TO PI-CERT-NO.                        
001601                                                                  
001602     GO TO 0400-FIRST-TIME.                                       
001603                                                                  
001604 0380-CLAIM-END-FILE.                                             
001605                                                                  
001606     MOVE ER-0130     TO EMI-ERROR.                               
001607     MOVE -1          TO CLMNOL.                                  
001608     MOVE AL-UABON    TO CARRA                                    
001609                         CLMNOA                                   
001610                         CERTNOA                                  
001611                         SUFXA.                                   
001612                                                                  
001613     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
001614                                                                  
001615     GO TO 8200-SEND-DATAONLY.                                    
001616                                                                  
001617 0400-FIRST-TIME.                                                 
001618                                                                  
001619     IF WS-BROWSE-START-SW = 'Y'                                  
001620        MOVE 'N'         TO WS-BROWSE-START-SW                    
001621        EXEC CICS ENDBR                                           
001622             DATASET    ('ELMSTR')                                
001623        END-EXEC.                                                 
001624                                                                  
001625     IF PI-PROCESSOR-ID = 'LGXX'                                  
001626         NEXT SENTENCE                                            
001627     ELSE                                                         
001628         EXEC CICS READQ TS                                       
001629             QUEUE   (PI-SECURITY-TEMP-STORE-ID)                  
001630             INTO    (SECURITY-CONTROL)                           
001631             LENGTH  (SC-COMM-LENGTH)                             
001632             ITEM    (SC-ITEM)                                    
001633         END-EXEC                                                 
001634         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP          
001635         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.          
001636                                                                  
001637     MOVE LOW-VALUES             TO EL156AI.                      
001638     PERFORM 0800-DELETE-TS THRU 0800-EXIT.                       
001639     MOVE 'Y'                    TO FIRST-ENTRY.                  
001640     GO TO 7000-SHOW-CLAIM.                                       
001641                                                                  
001642 0500-CREATE-TEMP-STORAGE.                                        
001643     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.               
001644                                                                  
001645     EXEC CICS WRITEQ TS                                          
001646         QUEUE (QID)                                              
001647         FROM  (PROGRAM-INTERFACE-BLOCK)                          
001648         LENGTH(PI-COMM-LENGTH)                                   
001649     END-EXEC.                                                    
001650                                                                  
001651     EXEC CICS WRITEQ TS                                          
001652         QUEUE (QID)                                              
001653         FROM  (EL156AI)                                          
001654         LENGTH(MAP-LENGTH)                                       
001655     END-EXEC.                                                    
001656                                                                  
001657 0599-EXIT.                                                       
001658      EXIT.                                                       
001659                                                                  
001660     EJECT                                                        
001661 0600-RECOVER-TEMP-STORAGE.                                       
001662     EXEC CICS READQ TS                                           
001663         QUEUE (QID)                                              
001664         INTO  (PROGRAM-INTERFACE-BLOCK)                          
001665         LENGTH(PI-COMM-LENGTH)                                   
001666     END-EXEC.                                                    
001667                                                                  
001668     EXEC CICS READQ TS                                           
001669         QUEUE (QID)                                              
001670         INTO  (EL156AI)                                          
001671         LENGTH(MAP-LENGTH)                                       
001672     END-EXEC.                                                    
001673                                                                  
001674     PERFORM 0800-DELETE-TS THRU 0800-EXIT.                       
001675                                                                  
001676     IF PMTTYPEI NOT = LOW-VALUES                                 
001677         MOVE AL-UANON           TO PMTTYPEA.                     
001678                                                                  
001679     IF PAYEEI NOT = LOW-VALUES                                   
001680         MOVE AL-UANON           TO PAYEEA.                       
001681                                                                  
001682     IF NOTE1I NOT = LOW-VALUES                                   
001683         MOVE AL-UANON           TO NOTE1A.                       
001684                                                                  
001685                                                                  
001686     IF (RETURNED-FROM = 'EL614')                                 
001687        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT              
001688     END-IF                                                       
001689                                                                  
001690*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)                      
001691*       AND (PI-EOB-CODES-EXIST = 'Y')                            
001692*       AND (PI-SET-NOTE2-MDT = 'Y')                              
001693*       MOVE ' '                 TO PI-SET-NOTE2-MDT              
001694     IF PI-SET-NOTE2-MDT = 'Y'                                    
001695         MOVE AL-SANON           TO NOTE2A                        
001696     END-IF                                                       
001697                                                                  
001698     IF OFFLINEI NOT = LOW-VALUES                                 
001699         MOVE AL-UANON           TO OFFLINEA.                     
001700                                                                  
001701*    IF GROUPEDI NOT = LOW-VALUES                                 
001702*        MOVE AL-UANON           TO GROUPEDA.                     
001703                                                                  
001704*    IF CASHI NOT = LOW-VALUES                                    
001705*        MOVE AL-UANON           TO CASHA.                        
001706                                                                  
001707     IF CHECKNOI NOT = LOW-VALUES                                 
001708         MOVE AL-UANON           TO CHECKNOA.                     
001709                                                                  
001710     IF HOLDTILI NOT = LOW-VALUES                                 
001711         MOVE AL-UANON           TO HOLDTILA.                     
001712                                                                  
001713     IF EPYFROMI NOT = LOW-VALUES                                 
001714         MOVE AL-UANON           TO EPYFROMA.                     
001715                                                                  
001716     IF AIGFROMI NOT = LOW-VALUES                                 
001717         MOVE AL-UANON           TO AIGFROMA.                     
001718                                                                  
001719     IF EPYTHRUI NOT = LOW-VALUES                                 
001720         MOVE AL-UANON           TO EPYTHRUA.                     
001721                                                                  
001722     IF EDAYSI NOT = LOW-VALUES                                   
001723         MOVE AL-UNNON           TO EDAYSA.                       
001724                                                                  
001725     IF EPYAMTL NOT = +0                                          
001726         MOVE AL-UNNON           TO EPYAMTA.                      
001727                                                                  
001728     IF ERESVL NOT = +0                                           
001729         MOVE AL-UNNON           TO ERESVA.                       
001730                                                                  
001731     IF EEXPENSL NOT = +0                                         
001732         MOVE AL-UNNON           TO EEXPENSA.                     
001733                                                                  
001734     IF ETYPEI NOT = LOW-VALUES                                   
001735         MOVE AL-UNNON           TO ETYPEA.                       
001736                                                                  
001737     IF PROOFDTI NOT = 0                                          
001738         MOVE AL-UNNON           TO PROOFDTA.                     
001739                                                                  
001740     IF EOBYNI = 'Y' OR 'N' OR 'S'                                
001741        MOVE AL-UANON            TO EOBYNA                        
001742     END-IF                                                       
001743                                                                  
001744     IF CLMFMYNI = 'Y' OR 'N'                                     
001745        MOVE AL-UANON            TO CLMFMYNA                      
001746     END-IF                                                       
001747                                                                  
001748     IF SURVYYNI = 'Y' OR 'N'                                     
001749        IF PI-APPROVAL-LEVEL = '4' OR '5'                         
001750           MOVE AL-UANON         TO SURVYYNA                      
001751        END-IF                                                    
001752     END-IF                                                       
001753                                                                  
001754     IF SPRELYNI = 'Y' OR 'N'                                     
001755        MOVE AL-UANON            TO SPRELYNA                      
001756     END-IF                                                       
001757                                                                  
001758     .                                                            
001759 0699-EXIT.                                                       
001760      EXIT.                                                       
001761                                                                  
001762     EJECT                                                        
001763 0700-TEST-FOR-CHANGES.                                           
001764     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)                     
001765         MOVE ER-0433            TO EMI-ERROR                     
001766         GO TO 0750-FUNCTION-ERROR.                               
001767                                                                  
001768     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.         
001769                                                                  
001770     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT                         
001771         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT                 
001772         MOVE 'A'                TO PI-PASS-SW                    
001773         GO TO 1000-EDIT-DATA.                                    
001774                                                                  
001775     IF PI-FATAL-COUNT NOT = 0                                    
001776         MOVE ER-0499            TO EMI-ERROR                     
001777         GO TO 0750-FUNCTION-ERROR.                               
001778                                                                  
001779     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)        
001780         MOVE ER-0500            TO EMI-ERROR                     
001781         GO TO 0750-FUNCTION-ERROR.                               
001782                                                                  
001783     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR               
001784        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)       
001785           MOVE ER-0542          TO EMI-ERROR                     
001786           MOVE -1               TO EPYAMTL                       
001787           GO TO 0750-FUNCTION-ERROR.                             
001788                                                                  
001789     IF PI-OFFLINE = 'Y'  OR                                      
001790        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)                 
001791        MOVE EIBAID              TO PI-PFKEY-USED                 
001792        GO TO 5000-UPDATE.                                        
001793                                                                  
001794     GO TO 6000-BUILD-SCREEN-B.                                   
001795                                                                  
001796 0750-FUNCTION-ERROR.                                             
001797     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
001798                                                                  
001799     IF ENTERPFL > 0                                              
001800         MOVE -1                 TO ENTERPFL                      
001801         MOVE AL-UNBON           TO ENTERPFA                      
001802         GO TO 8200-SEND-DATAONLY                                 
001803     ELSE                                                         
001804         MOVE -1                 TO ENTERPFL                      
001805         MOVE AL-UNNOF           TO ENTERPFA                      
001806         GO TO 8200-SEND-DATAONLY.                                
001807                                                                  
001808     EJECT                                                        
001809 0800-DELETE-TS.                                                  
001810     EXEC CICS HANDLE CONDITION                                   
001811         QIDERR(0800-EXIT)                                        
001812     END-EXEC.                                                    
001813                                                                  
001814     EXEC CICS DELETEQ TS                                         
001815         QUEUE(QID)                                               
001816     END-EXEC.                                                    
001817                                                                  
001818 0800-EXIT.                                                       
001819      EXIT.                                                       
001820                                                                  
001821 0900-GET-DDF-LIMITS.                                             
001822                                                                  
001823     if cm-clp-state = zeros or spaces or low-values              
001824        move cm-state            to cm-clp-state                  
001825     end-if                                                       
001826     MOVE ' '                    TO WS-PDEF-RECORD-SW             
001827     MOVE PI-COMPANY-CD          TO ERPDEF-KEY                    
001828     MOVE cm-clp-state           TO ERPDEF-STATE                  
001829     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD                
001830                                                                  
001831     evaluate true                                                
001832        when (cl-claim-type = 'L' or 'P')                         
001833           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'     
001834             and 'CU')                                            
001835           move 'L'              to erpdef-ben-type               
001836           move pi-lf-benefit-cd to erpdef-ben-code               
001837        when (cl-claim-type not = 'L' and 'P')                    
001838           and (pi-ah-benefit-cd not = '00' and '  ')             
001839           move 'A'              to erpdef-ben-type               
001840           move pi-ah-benefit-cd to erpdef-ben-code               
001841        when (cl-claim-type not = 'L' and 'P')                    
001842           and (pi-ah-benefit-cd = '00' or '  ')                  
001843           move 'L'              to erpdef-ben-type               
001844           move pi-lf-benefit-cd to erpdef-ben-code               
001845        when (cl-claim-type = 'L' or 'P')                         
001846           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')  
001847           move 'A'              to erpdef-ben-type               
001848           move pi-ah-benefit-cd to erpdef-ben-code               
001849        when other                                                
001850           move 'A'              to erpdef-ben-type               
001851           move pi-ah-benefit-cd to erpdef-ben-code               
001852     end-evaluate                                                 
001853                                                                  
001854*    if (cl-claim-type = 'L' or 'P')                              
001855*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'        
001856*          and 'CU')                                              
001857*       move 'L'                 to erpdef-ben-type               
001858*       move pi-lf-benefit-cd    to erpdef-ben-code               
001859*    else                                                         
001860*       MOVE 'A'                 TO ERPDEF-BEN-TYPE               
001861*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE               
001862*    end-if                                                       
001863                                                                  
001864     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT                 
001865                                                                  
001866     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE               
001867                                                                  
001868     EXEC CICS STARTBR                                            
001869         DATASET  ('ERPDEF')                                      
001870         RIDFLD   (ERPDEF-KEY)                                    
001871         GTEQ                                                     
001872         RESP     (WS-RESPONSE)                                   
001873     END-EXEC                                                     
001874                                                                  
001875     IF NOT WS-RESP-NORMAL                                        
001876        GO TO 0900-EXIT                                           
001877     END-IF                                                       
001878                                                                  
001879     .                                                            
001880 0900-READNEXT.                                                   
001881                                                                  
001882     EXEC CICS READNEXT                                           
001883        DATASET  ('ERPDEF')                                       
001884        SET      (ADDRESS OF PRODUCT-MASTER)                      
001885        RIDFLD   (ERPDEF-KEY)                                     
001886        RESP     (WS-RESPONSE)                                    
001887     END-EXEC                                                     
001888                                                                  
001889     IF NOT WS-RESP-NORMAL                                        
001890        GO TO 0900-ENDBR                                          
001891     END-IF                                                       
001892                                                                  
001893     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))      
001894        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)                      
001895           MOVE 'Y'              TO WS-PDEF-RECORD-SW             
001896        ELSE                                                      
001897           GO TO 0900-READNEXT                                    
001898        END-IF                                                    
001899     ELSE                                                         
001900        GO TO 0900-ENDBR                                          
001901     END-IF                                                       
001902                                                                  
001903     IF CM-LOAN-TERM = ZEROS                                      
001904        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM                  
001905     END-IF                                                       
001906                                                                  
001907     .                                                            
001908 0900-ENDBR.                                                      
001909                                                                  
001910     EXEC CICS ENDBR                                              
001911        DATASET  ('ERPDEF')                                       
001912     END-EXEC                                                     
001913                                                                  
001914     .                                                            
001915 0900-EXIT.                                                       
001916     EXIT.                                                        
001917                                                                  
001918 1000-EDIT-DATA.                                                  
001919                                                                  
001920     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS        
001921         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW   
001922         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED                  
001923                                                                  
001924     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.                   
001925                                                                  
001926     IF NOT MODIFY-CAP                                            
001927         MOVE ER-0070            TO EMI-ERROR                     
001928         MOVE -1                 TO PMTTYPEL                      
001929         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
001930         GO TO 2000-EDIT-DONE.                                    
001931                                                                  
001932     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND          
001933                         '5' AND '6'                              
001934         MOVE ER-0420            TO EMI-ERROR                     
001935         MOVE -1                 TO PMTTYPEL                      
001936         MOVE AL-UABON           TO PMTTYPEA                      
001937         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
001938     ELSE                                                         
001939         MOVE AL-UANON           TO PMTTYPEA.                     
001940                                                                  
001941*    IF PI-OFFLINE = 'Y'                                          
001942*       IF PI-GROUPED = 'Y'                                       
001943*          MOVE ER-1880         TO EMI-ERROR                      
001944*          MOVE -1              TO GROUPEDL                       
001945*          MOVE AL-UABON        TO GROUPEDA                       
001946*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              
001947*                                                                 
001948*    IF GROUPEDL > +0                                             
001949*       IF PI-GROUPED = 'Y' OR 'N'                                
001950*          MOVE AL-UANON TO GROUPEDA                              
001951*       ELSE                                                      
001952*          MOVE ER-3140            TO EMI-ERROR                   
001953*          MOVE -1                 TO GROUPEDL                    
001954*          MOVE AL-UABON           TO GROUPEDA                    
001955*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              
001956*                                                                 
001957*    IF CASHL > +0                                                
001958*       IF PI-CASH = 'Y' OR 'N'                                   
001959*          MOVE AL-UANON           TO CASHA                       
001960*       ELSE                                                      
001961*          MOVE ER-3141            TO EMI-ERROR                   
001962*          MOVE -1                 TO CASHL                       
001963*          MOVE AL-UABON           TO CASHA                       
001964*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              
001965                                                                  
001966     IF LOANNOL > +0                                              
001967         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.           
001968                                                                  
001969 1000-EDIT-PAYEE.                                                 
001970                                                                  
001971     IF PI-PAYEE-SEQ NOT NUMERIC                                  
001972         MOVE ER-0294            TO  EMI-ERROR                    
001973         MOVE -1                 TO  PAYEEL                       
001974         MOVE AL-UABON           TO  PAYEEA                       
001975         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
001976         GO TO 1000-CONT-EDIT.                                    
001977                                                                  
001978     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR              
001979                         'E' OR 'O' OR 'Q'                        
001980         NEXT SENTENCE                                            
001981     ELSE                                                         
001982         MOVE ER-0294            TO  EMI-ERROR                    
001983         MOVE -1                 TO  PAYEEL                       
001984         MOVE AL-UABON           TO  PAYEEA                       
001985         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
001986         GO TO 1000-CONT-EDIT.                                    
001987                                                                  
001988     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND   
001989        (PI-PAYEE-SEQ NOT < '1' AND                               
001990         PI-PAYEE-SEQ NOT > '9'))                                 
001991      OR                                                          
001992        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND                        
001993         (PI-PAYEE-SEQ NOT > '9'))                                
001994         MOVE AL-UANON            TO PAYEEA                       
001995     ELSE                                                         
001996         MOVE ER-0294            TO EMI-ERROR                     
001997         MOVE -1                 TO PAYEEL                        
001998         MOVE AL-UABON           TO PAYEEA                        
001999         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                
002000                                                                  
002001     IF PI-COMPANY-ID = 'DMD'                                     
002002         IF PI-PAYEE-TYPE = 'B' AND                               
002003            PI-PAYEE-SEQ NOT = '0'                                
002004               MOVE ER-7841            TO EMI-ERROR               
002005               MOVE -1                 TO PAYEEL                  
002006               MOVE AL-UABON           TO PAYEEA                  
002007               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          
002008                                                                  
002009     IF PI-COMPANY-ID = 'JHL'                                     
002010         IF PI-PAYEE = 'B0'                                       
002011             NEXT SENTENCE                                        
002012           ELSE                                                   
002013         EXEC CICS HANDLE CONDITION                               
002014             ENDFILE(1950-NOT-FOUND)                              
002015             NOTFND (1950-NOT-FOUND)                              
002016         END-EXEC                                                 
002017         MOVE 'N'                    TO FOUND-TOL-SW              
002018         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID              
002019         MOVE '2'                    TO CNTL-REC-TYPE             
002020         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS               
002021         MOVE +0                     TO CNTL-SEQ-NO               
002022         MOVE 'PROC'                 TO FILE-SWITCH               
002023         PERFORM 7930-READ-CONTROL THRU 7930-EXIT                 
002024         IF PI-PAYEE = 'I1' AND                                   
002025            APPROVAL-LEVEL-2                                      
002026             NEXT SENTENCE                                        
002027           ELSE                                                   
002028         IF NOT PI-USER-ALMIGHTY-YES                              
002029             MOVE ER-3546        TO EMI-ERROR                     
002030             MOVE -1             TO PAYEEL                        
002031             MOVE AL-UABON       TO PAYEEA                        
002032             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            
002033                                                                  
002034     IF PI-PAYEE-TYPE = 'E'                                       
002035        IF PI-PMTTYPE = '5' OR '6'                                
002036            NEXT SENTENCE                                         
002037        ELSE                                                      
002038            MOVE ER-3539            TO EMI-ERROR                  
002039            MOVE -1                 TO PAYEEL                     
002040            MOVE AL-UABON           TO PAYEEA                     
002041            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             
002042                                                                  
002043 1000-CONT-EDIT.                                                  
002044                                                                  
002045     IF PI-OFFLINE NOT = 'Y' AND 'N'                              
002046        IF PI-EPYAMT NOT NEGATIVE                                 
002047            MOVE ER-0421         TO EMI-ERROR                     
002048            MOVE -1              TO OFFLINEL                      
002049            MOVE AL-UABON        TO OFFLINEA                      
002050            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              
002051        ELSE                                                      
002052            MOVE AL-UANON        TO OFFLINEA.                     
002053                                                                  
002054     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'          
002055           OR 'FNL'                                               
002056        IF PI-PRINT-EOB-YN = 'Y' OR 'N'                           
002057           CONTINUE                                               
002058        ELSE                                                      
002059           IF PI-PRINT-EOB-YN = 'S' AND                           
002060              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'            
002061                CONTINUE                                          
002062           ELSE                                                   
002063              MOVE ER-1561       TO EMI-ERROR                     
002064              MOVE -1            TO EOBYNL                        
002065              MOVE AL-UABON      TO EOBYNA                        
002066              PERFORM 9900-ERROR-FORMAT                           
002067                                 THRU 9900-EXIT                   
002068           END-IF                                                 
002069        END-IF                                                    
002070                                                                  
002071        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'                  
002072            MOVE ER-1566        TO EMI-ERROR                      
002073            MOVE -1             TO CLMFMYNL                       
002074            MOVE AL-UABON       TO CLMFMYNA                       
002075            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              
002076        END-IF                                                    
002077                                                                  
002078        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'                   
002079            MOVE ER-1567        TO EMI-ERROR                      
002080            MOVE -1             TO SURVYYNL                       
002081            MOVE AL-UABON       TO SURVYYNA                       
002082            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              
002083        END-IF                                                    
002084                                                                  
002085        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'                
002086            MOVE ER-1569        TO EMI-ERROR                      
002087            MOVE -1             TO SPRELYNL                       
002088            MOVE AL-UABON       TO SPRELYNA                       
002089            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              
002090        END-IF                                                    
002091                                                                  
002092     END-IF                                                       
002093                                                                  
002094     IF PI-EPYAMT IS NEGATIVE                                     
002095         IF PI-OFFLINE NOT = 'Y'                                  
002096             MOVE ER-0836        TO  EMI-ERROR                    
002097             MOVE -1             TO  OFFLINEL                     
002098             MOVE AL-UABON       TO  OFFLINEA                     
002099             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            
002100                                                                  
002101     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES             
002102        MOVE ER-0872             TO EMI-ERROR                     
002103        MOVE -1                  TO PROOFDTL                      
002104        MOVE AL-UABON            TO PROOFDTA                      
002105        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  
002106     ELSE                                                         
002107        MOVE '4'                TO DC-OPTION-CODE                 
002108        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY             
002109        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT             
002110        IF DATE-CONVERSION-ERROR                                  
002111            MOVE ER-0873        TO EMI-ERROR                      
002112            MOVE -1                  TO PROOFDTL                  
002113            MOVE AL-UABON            TO PROOFDTA                  
002114            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              
002115        ELSE                                                      
002116            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT               
002117            IF DC-BIN-DATE-1 > WS-TODAY-DATE                      
002118                MOVE ER-0873    TO EMI-ERROR                      
002119                MOVE -1                  TO PROOFDTL              
002120                MOVE AL-UABON            TO PROOFDTA              
002121                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          
002122            END-IF                                                
002123        END-IF                                                    
002124     END-IF.                                                      
002125                                                                  
002126     IF PI-COMPANY-ID = 'DMD'                                     
002127        IF NOTE1L NOT = ZEROS                                     
002128            MOVE ER-7844        TO  EMI-ERROR                     
002129            MOVE -1             TO  NOTE1L                        
002130            MOVE AL-UABON       TO  NOTE1A                        
002131            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             
002132                                                                  
002133     IF PI-COMPANY-ID = 'DMD'                                     
002134        IF NOTE2L NOT = ZEROS                                     
002135          GO TO 1004-DMD-EOB-CHECKS.                              
002136                                                                  
002137     IF NOTE1L NOT > +0                                           
002138         GO TO 1005-CHECK-ERRORS.                                 
002139                                                                  
002140     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'   
002141         GO TO 1005-CHECK-ERRORS.                                 
002142                                                                  
002143     IF PI-COMPANY-ID = 'HAN' OR 'JHL'                            
002144         GO TO 1003-HAN-PMT-NOTES.                                
002145                                                                  
002146     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.               
002147                                                                  
002148     IF WS-PMTOPTION NUMERIC                                      
002149        IF WS-PMTOPTION > '00' AND < '17'                         
002150           NEXT SENTENCE                                          
002151        ELSE                                                      
002152           MOVE ER-0618          TO EMI-ERROR                     
002153           MOVE -1               TO NOTE1L                        
002154           MOVE AL-UABON         TO NOTE1A                        
002155           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               
002156     ELSE                                                         
002157        GO TO 1005-CHECK-ERRORS.                                  
002158                                                                  
002159     IF WS-PMTOPTION = '05' AND                                   
002160        WS-DOCNAME = SPACES                                       
002161          MOVE ER-0616             TO EMI-ERROR                   
002162          MOVE -1                  TO NOTE1L                      
002163          MOVE AL-UABON            TO NOTE1A                      
002164          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               
002165                                                                  
002166     IF WS-PMTOPTION = '15' OR '16'                               
002167         EXEC CICS BIF DEEDIT                                     
002168             FIELD (WS-AMOUNT)                                    
002169             LENGTH(08)                                           
002170         END-EXEC                                                 
002171        IF (WS-NUM-AMT = ZEROS) OR                                
002172           (WS-AMOUNT NOT NUMERIC)                                
002173           MOVE ER-0617          TO EMI-ERROR                     
002174           MOVE -1               TO NOTE1L                        
002175           MOVE AL-UABON         TO NOTE1A                        
002176           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              
002177                                                                  
002178     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.       
002179                                                                  
002180     GO TO 1005-CHECK-ERRORS.                                     
002181                                                                  
002182 1003-HAN-PMT-NOTES.                                              
002183                                                                  
002184     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.               
002185                                                                  
002186     IF WS-HAN-PMT-CODE = SPACE                                   
002187         MOVE SPACES             TO WS-HAN-PMT-NOTE               
002188     ELSE                                                         
002189     IF WS-HAN-PMT-CODE = 'A'                                     
002190         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'             
002191                                 TO WS-HAN-PMT-NOTE               
002192     ELSE                                                         
002193     IF WS-HAN-PMT-CODE = 'B'                                     
002194         MOVE ':FINAL PAYMENT / DECEASED'                         
002195                                 TO WS-HAN-PMT-NOTE               
002196     ELSE                                                         
002197     IF WS-HAN-PMT-CODE = 'C'                                     
002198         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'               
002199                                 TO WS-HAN-PMT-NOTE               
002200     ELSE                                                         
002201     IF WS-HAN-PMT-CODE = 'D'                                     
002202         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'           
002203                                 TO WS-HAN-PMT-NOTE               
002204     ELSE                                                         
002205     IF WS-HAN-PMT-CODE = 'E'                                     
002206         MOVE ':FINAL PAYMENT / RETURNED TO WORK'                 
002207                                 TO WS-HAN-PMT-NOTE               
002208     ELSE                                                         
002209     IF WS-HAN-PMT-CODE = 'F'                                     
002210         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'            
002211                                 TO WS-HAN-PMT-NOTE               
002212     ELSE                                                         
002213     IF WS-HAN-PMT-CODE = 'P'                                     
002214         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.              
002215                                                                  
002216     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.       
002217     GO TO 1005-CHECK-ERRORS.                                     
002218                                                                  
002219 1004-DMD-EOB-CHECKS.                                             
002220                                                                  
002221     INITIALIZE PI-AT-EOB-CODES.                                  
002222                                                                  
002223     IF NOTE2I (20:21) > SPACES                                   
002224         MOVE ER-7845          TO EMI-ERROR                       
002225         MOVE -1               TO NOTE2L                          
002226         MOVE AL-UABON         TO NOTE2A                          
002227         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
002228         GO TO 1005-CHECK-ERRORS                                  
002229      ELSE                                                        
002230         MOVE NOTE2I             TO W-EOB-CODES.                  
002231                                                                  
002232     MOVE +1                     TO W-EOB-NDX.                    
002233                                                                  
002234 1004-CHECK-EACH-EOB.                                             
002235                                                                  
002236     IF W-EOB-NDX > +5                                            
002237             OR                                                   
002238        W-EOB-CODE (W-EOB-NDX) = SPACES                           
002239         GO TO 1004-CHECK-DUP-EOB.                                
002240                                                                  
002241     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES                     
002242         MOVE ER-0956            TO EMI-ERROR                     
002243         MOVE -1                 TO NOTE2L                        
002244         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
002245         GO TO 1005-CHECK-ERRORS.                                 
002246                                                                  
002247     MOVE 'CL'                   TO CD-SYSTEM-ID.                 
002248     MOVE 'EO'                   TO CD-RECORD-TYPE.               
002249     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.                
002250     MOVE 'DLO023'               TO PGM-NAME.                     
002251                                                                  
002252     EXEC CICS LINK                                               
002253         PROGRAM    (PGM-NAME)                                    
002254         COMMAREA   (CD-COMMUNICATION-AREA)                       
002255         LENGTH     (CD-RCRD-LENGTH)                              
002256     END-EXEC.                                                    
002257                                                                  
002258     IF CD-RETURN-CODE = 'OK'                                     
002259         GO TO 1004-CONT.                                         
002260                                                                  
002261     MOVE -1                     TO NOTE2L.                       
002262                                                                  
002263     IF CD-RETURN-CODE = '01'                                     
002264         MOVE ER-8310            TO EMI-ERROR                     
002265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
002266         GO TO 1005-CHECK-ERRORS.                                 
002267                                                                  
002268     IF CD-RETURN-CODE = '02'                                     
002269         MOVE ER-8311            TO EMI-ERROR                     
002270         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
002271         GO TO 1005-CHECK-ERRORS.                                 
002272                                                                  
002273     IF CD-RETURN-CODE = '03'                                     
002274         MOVE ER-8312            TO EMI-ERROR                     
002275         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
002276         GO TO 1005-CHECK-ERRORS.                                 
002277                                                                  
002278     IF CD-RETURN-CODE = '04'                                     
002279         MOVE ER-8313            TO EMI-ERROR                     
002280         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
002281         GO TO 1005-CHECK-ERRORS.                                 
002282                                                                  
002283     IF CD-RETURN-CODE = '05'                                     
002284         MOVE ER-8314            TO EMI-ERROR                     
002285         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
002286         GO TO 1005-CHECK-ERRORS.                                 
002287                                                                  
002288     IF CD-RETURN-CODE = '06'                                     
002289         MOVE ER-8315            TO EMI-ERROR                     
002290         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
002291         GO TO 1005-CHECK-ERRORS.                                 
002292                                                                  
002293     IF CD-RETURN-CODE = 'E1'                                     
002294         MOVE ER-8316            TO EMI-ERROR                     
002295         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
002296         GO TO 1005-CHECK-ERRORS.                                 
002297                                                                  
002298     IF CD-RETURN-CODE = 'N1'                                     
002299         MOVE ER-8317            TO EMI-ERROR                     
002300         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
002301         GO TO 1005-CHECK-ERRORS.                                 
002302                                                                  
002303 1004-CONT.                                                       
002304     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).   
002305                                                                  
002306     ADD +1 TO W-EOB-NDX.                                         
002307     GO TO 1004-CHECK-EACH-EOB.                                   
002308                                                                  
002309 1004-CHECK-DUP-EOB.                                              
002310     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND                     
002311         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR              
002312                               PI-AT-EOB-CODE (3) OR              
002313                               PI-AT-EOB-CODE (4) OR              
002314                               PI-AT-EOB-CODE (5)))               
002315                  OR                                              
002316        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND                     
002317         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR              
002318                               PI-AT-EOB-CODE (4) OR              
002319                               PI-AT-EOB-CODE (5)))               
002320                  OR                                              
002321        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND                     
002322         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR              
002323                               PI-AT-EOB-CODE (5)))               
002324                  OR                                              
002325        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND                     
002326         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))               
002327            MOVE ER-8000            TO EMI-ERROR                  
002328            MOVE AL-UABON           TO NOTE2A                     
002329            MOVE -1                 TO NOTE2L                     
002330            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              
002331            GO TO 1005-CHECK-ERRORS.                              
002332                                                                  
002333 1005-CHECK-ERRORS.                                               
002334*    IF PI-COMPANY-ID NOT = 'DMD'                                 
002335        GO TO 1006-CHECK-ERRORS.                                  
002336                                                                  
002337*********  DMD CODE START ******************                      
002338*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'     
002339*       GO TO 1006-CHECK-ERRORS.                                  
002340*                                                                 
002341*    PERFORM 7700-GET-DCT THRU 7700-EXIT.                         
002342*                                                                 
002343*    COMPUTE W-PAYMENT-TOTAL                                      
002344*         = CL-TOTAL-PAID-AMT + PI-EPYAMT                         
002345*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)                   
002346*               AND                                               
002347*       (PI-MAX-BENEFIT-PYMT > ZEROS)                             
002348*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC                  
002349*          MOVE ER-0967    TO EMI-ERROR                           
002350*          MOVE -1         TO PMTTYPEL                            
002351*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              
002352*                                                                 
002353*    GO TO 1006-CHECK-ERRORS.                                     
002354*********  DMD CODE END ******************                        
002355                                                                  
002356 1006-CHECK-ERRORS.                                               
002357                                                                  
002358     if emi-forcable-ctr = zeros                                  
002359        and emi-fatal-ctr = zeros                                 
002360        continue                                                  
002361     else                                                         
002362        IF NOT EMI-NO-ERRORS                                      
002363           GO TO 2000-EDIT-DONE                                   
002364        end-if                                                    
002365     end-if                                                       
002366                                                                  
002367     EXEC CICS HANDLE CONDITION                                   
002368         NOTFND(1950-NOT-FOUND)                                   
002369     END-EXEC.                                                    
002370                                                                  
002371     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.                 
002372     MOVE PI-CARRIER             TO MSTR-CARRIER.                 
002373     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.                
002374     MOVE PI-CERT-NO             TO MSTR-CERT-NO.                 
002375     MOVE 'MSTR'                 TO FILE-SWITCH.                  
002376                                                                  
002377     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.                      
002378                                                                  
002379     IF PI-COMPANY-ID = 'DMD'                                     
002380         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.            
002381                                                                  
002382     IF WS-BIN-PROOF-DT NOT = LOW-VALUES                          
002383        IF WS-BIN-PROOF-DT < CL-INCURRED-DT                       
002384           MOVE ER-0873    TO EMI-ERROR                           
002385           MOVE -1                  TO PROOFDTL                   
002386           MOVE AL-UABON            TO PROOFDTA                   
002387           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               
002388        END-IF                                                    
002389     END-IF                                                       
002390                                                                  
002391     if cl-benefit-period = zeros                                 
002392        move er-1667             to emi-error                     
002393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  
002394     end-if                                                       
002395                                                                  
002396     MOVE ELMSTR-KEY             TO ELTRLR-KEY                    
002397     MOVE +95                    TO TRLR-SEQ-NO                   
002398     EXEC CICS READ                                               
002399        DATASET  ('ELTRLR')                                       
002400        SET      (ADDRESS OF ACTIVITY-TRAILERS)                   
002401        RIDFLD   (ELTRLR-KEY)                                     
002402        RESP     (WS-RESPONSE)                                    
002403     END-EXEC                                                     
002404                                                                  
002405     if ws-resp-normal                                            
002406        perform varying s1 from +1 by +1 until                    
002407           at-note-error-no (s1) = spaces                         
002408           if at-note-error-no (s1) = '1662'                      
002409              continue                                            
002410           else                                                   
002411              move at-note-error-no (s1)                          
002412                                 to emi-error                     
002413              if at-note-error-no (s1) = '1653'                   
002414                 evaluate true                                    
002415                    when cl-claim-type = 'L'                      
002416                       move '  LF  '                              
002417                                 to emi-claim-type                
002418                    when cl-claim-type = 'I'                      
002419                       move '  IU  '                              
002420                                 to emi-claim-type                
002421                    when cl-claim-type = 'F'                      
002422                       move ' FMLA '                              
002423                                 to emi-claim-type                
002424                    when cl-claim-type = 'B'                      
002425                       move ' BRV  '                              
002426                                 to emi-claim-type                
002427                    when cl-claim-type = 'H'                      
002428                       move ' HOSP '                              
002429                                 to emi-claim-type                
002430                    when cl-claim-type = 'O'                      
002431                       move '  OT  '                              
002432                                 to emi-claim-type                
002433                    when other                                    
002434                       move '  AH  '                              
002435                                 to emi-claim-type                
002436                 end-evaluate                                     
002437              end-if                                              
002438              PERFORM 9900-ERROR-FORMAT                           
002439                                 THRU 9900-EXIT                   
002440           end-if                                                 
002441        end-perform                                               
002442     end-if                                                       
002443                                                                  
002444     IF CL-AUTO-PAY-SEQ NOT = ZEROS                               
002445         IF PI-PMTTYPE = '5' OR '6'                               
002446             NEXT SENTENCE                                        
002447         ELSE                                                     
002448             MOVE ER-0555             TO EMI-ERROR                
002449             MOVE -1                  TO PMTTYPEL                 
002450             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            
002451                                                                  
002452     IF CL-LAST-CLOSE-REASON = '2'                                
002453         IF CL-CLAIM-STATUS = 'C'                                 
002454             MOVE ER-0760        TO  EMI-ERROR                    
002455             MOVE -1             TO  PMTTYPEL                     
002456             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            
002457                                                                  
002458     IF PI-ACTIVITY-CODE = 9                                      
002459         MOVE ER-3538            TO  EMI-ERROR                    
002460         MOVE -1                 TO  PMTTYPEL                     
002461         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                
002462                                                                  
002463     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'                       
002464         GO TO 1008-READ-CERT.                                    
002465**********************AIG LOGIC STARTS *********************      
002466     IF CL-CERT-PRIME = 'INCOMPLETE'                              
002467         MOVE ER-3540            TO  EMI-ERROR                    
002468         MOVE -1                 TO  PMTTYPEL                     
002469         MOVE AL-UABON           TO  PMTTYPEA                     
002470         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
002471         GO TO 2000-EDIT-DONE.                                    
002472                                                                  
002473     IF PI-PMTTYPE = '4'                                          
002474         IF PI-EPYAMT IS NEGATIVE                                 
002475             IF PI-ECHECKNO-CR = 'CR'                             
002476                 NEXT SENTENCE                                    
002477             ELSE                                                 
002478                 MOVE 'CR'       TO  PI-ECHECKNO-CR.              
002479                                                                  
002480     IF PI-PMTTYPE = '4'                                          
002481         IF PI-ECHECKNO-CR = 'CR'                                 
002482             IF PI-EPYAMT IS NEGATIVE                             
002483                 NEXT SENTENCE                                    
002484             ELSE                                                 
002485                 MOVE ER-0834    TO  EMI-ERROR                    
002486                 MOVE -1         TO  EPYAMTL                      
002487                 MOVE AL-UNBON   TO  EPYAMTA                      
002488                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        
002489                                                                  
002490     IF PI-PMTTYPE = '4'                                          
002491         IF PI-EPYAMT IS NEGATIVE                                 
002492             IF PI-OFFLINE = 'Y'                                  
002493                 NEXT SENTENCE                                    
002494             ELSE                                                 
002495                 MOVE 'Y'        TO  PI-OFFLINE                   
002496                                     WS-OFFLINE                   
002497                                     OFFLINEO                     
002498                 MOVE AL-UANON   TO  OFFLINEA.                    
002499                                                                  
002500*    IF PI-PMTTYPE = '4'                                          
002501*        IF PI-EPYAMT IS NEGATIVE                                 
002502*            IF PI-CASH = 'Y'                                     
002503*                NEXT SENTENCE                                    
002504*            ELSE                                                 
002505*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH        
002506*                MOVE AL-UANON   TO  CASHA                        
002507*                GO TO 1007-DEFAULT-AIG-CHECKNO.                  
002508*                                                                 
002509*    IF PI-CASH NOT = 'Y' AND 'N'                                 
002510*         IF PI-OFFLINE = 'Y'  AND                                
002511*            PI-ECHECKNO-CR = 'CR'                                
002512*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH        
002513*              MOVE AL-UANON     TO  CASHA                        
002514*              GO TO 1007-DEFAULT-AIG-CHECKNO.                    
002515*                                                                 
002516*    IF PI-CASH NOT = 'Y' AND 'N'                                 
002517*        IF PI-PMTTYPE = '5' OR '6'                               
002518*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH        
002519*            MOVE AL-UANON       TO  CASHA                        
002520*            GO TO 1007-DEFAULT-AIG-CHECKNO.                      
002521*                                                                 
002522*    IF PI-CASH NOT = 'Y' AND 'N'                                 
002523*       IF CL-ASSOCIATES = 'N' OR 'A'                             
002524*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH        
002525*           MOVE AL-UANON        TO  CASHA                        
002526*       ELSE                                                      
002527*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH        
002528*           MOVE AL-UANON        TO  CASHA.                       
002529*                                                                 
002530*    IF PI-PMTTYPE = '5' OR '6'                                   
002531*        IF PI-CASH = 'N'                                         
002532*            MOVE ER-0819        TO  EMI-ERROR                    
002533*            MOVE AL-UANON       TO  CASHA                        
002534*            MOVE -1             TO  CASHL                        
002535*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            
002536*                                                                 
002537*    IF CL-ASSOCIATES = 'N' OR 'A'                                
002538*       IF CASHI = 'N'                                            
002539*        MOVE ER-3537            TO  EMI-ERROR                    
002540*        MOVE AL-UANON           TO  CASHA                        
002541*        MOVE -1                 TO  CASHL                        
002542*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                
002543                                                                  
002544 1007-DEFAULT-AIG-CHECKNO.                                        
002545                                                                  
002546     IF CL-CAUSE-CD = SPACES OR LOW-VALUES                        
002547         MOVE ER-3532            TO  EMI-ERROR                    
002548         MOVE -1                 TO  PMTTYPEL                     
002549         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                
002550**********************AIG LOGIC ENDS ***********************      
002551                                                                  
002552 1008-READ-CERT.                                                  
002553                                                                  
002554     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.                 
002555     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.                 
002556     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.                
002557     MOVE CL-CERT-STATE          TO CERT-STATE.                   
002558     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.                 
002559     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.                  
002560     MOVE CL-CERT-NO             TO CERT-CERT-NO.                 
002561     MOVE 'CERT'                 TO FILE-SWITCH.                  
002562                                                                  
002563     PERFORM 7970-READ-CERT THRU 7970-EXIT.                       
002564                                                                  
002565     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'                
002566        MOVE CM-LF-LOAN-EXPIRE-DT                                 
002567                                 TO WS-EXP-DT PI-EXP-DT           
002568                                    ws-extended-exp-dt            
002569     ELSE                                                         
002570        MOVE CM-AH-LOAN-EXPIRE-DT                                 
002571                                 TO WS-EXP-DT PI-EXP-DT           
002572                                    ws-extended-exp-dt            
002573     end-if                                                       
002574                                                                  
002575     move cl-insured-birth-dt    to dc-bin-date-1                 
002576     move cl-incurred-dt         to dc-bin-date-2                 
002577     move '1'                    to dc-option-code                
002578     PERFORM 9700-LINK-DATE-CONVERT                               
002579                                 THRU 9700-EXIT                   
002580     compute ws-att-age =                                         
002581        dc-elapsed-months / 12                                    
002582                                                                  
002583     MOVE '6'                    TO DC-OPTION-CODE                
002584     move zeros                  to dc-elapsed-months             
002585                                    dc-elapsed-days               
002586     move low-values to dc-bin-date-1 dc-bin-date-2               
002587                                                                  
002588     if pi-dcc-product-code not = spaces                          
002589        move cm-ah-benefit-cd    to pi-ah-benefit-cd              
002590        move cm-lf-benefit-cd    to pi-lf-benefit-cd              
002591        PERFORM 0900-GET-DDF-limits                               
002592                                 THRU 0900-EXIT                   
002593        IF PDEF-FOUND                                             
002594         AND CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1 AND 'O'      
002595           PERFORM VARYING P1 FROM +1 BY +1 UNTIL                 
002596              (P1 > +11)                                          
002597              OR ((PD-PROD-CODE (P1) = CL-CLAIM-TYPE)             
002598                   AND (PD-MAX-ATT-AGE (P1) >= WS-ATT-AGE))       
002599           END-PERFORM                                            
002600           IF P1 < +12                                            
002601              MOVE '6'           TO DC-OPTION-CODE                
002602              MOVE WS-EXP-DT     TO DC-BIN-DATE-1                 
002603              IF CL-NO-OF-EXTENSIONS NUMERIC                      
002604                 MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS    
002605                                             PI-MAX-EXT           
002606              ELSE                                                
002607                 MOVE PD-MAX-EXTENSION (P1)                       
002608                                 TO DC-ELAPSED-MONTHS             
002609              END-IF                                              
002610              PERFORM 9700-LINK-DATE-CONVERT                      
002611                                 THRU 9700-EXIT                   
002612              if no-conversion-error                              
002613                 move dc-bin-date-2 to ws-extended-exp-dt         
002614              end-if                                              
002615              if pd-wait-days(p1) not numeric                     
002616                 move zeros      to pd-wait-days(p1)              
002617              end-if                                              
002618           else                                                   
002619              move er-1674       to emi-error                     
002620              PERFORM 9900-ERROR-FORMAT                           
002621                                 THRU 9900-EXIT                   
002622           end-if                                                 
002623        ELSE                                                      
002624           IF CL-NO-OF-EXTENSIONS NUMERIC                         
002625              MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS       
002626                                          PI-MAX-EXT              
002627           ELSE                                                   
002628              MOVE ZERO  TO DC-ELAPSED-MONTHS                     
002629           END-IF                                                 
002630           MOVE WS-EXP-DT     TO DC-BIN-DATE-1                    
002631           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT          
002632           if no-conversion-error                                 
002633              move dc-bin-date-2 to ws-extended-exp-dt            
002634           end-if                                                 
002635        end-if                                                    
002636        if pdef-found                                             
002637           AND CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 or 'O'         
002638           PERFORM VARYING P1 FROM +1 BY +1 UNTIL                 
002639              (P1 > +11)                                          
002640              OR ((PD-PROD-CODE (P1) = CL-CLAIM-TYPE)             
002641                AND (PD-MAX-ATT-AGE (P1) >= WS-ATT-AGE))          
002642           END-PERFORM                                            
002643           IF P1 < +12                                            
002644              if pd-ben-pct(p1) not numeric                       
002645                 move zeros to pd-ben-pct(p1)                     
002646              end-if                                              
002647           end-if                                                 
002648        end-if                                                    
002649     ELSE                                                         
002650        IF CL-NO-OF-EXTENSIONS NUMERIC                            
002651           MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS          
002652                                       PI-MAX-EXT                 
002653        ELSE                                                      
002654           MOVE ZERO  TO DC-ELAPSED-MONTHS                        
002655        END-IF                                                    
002656        MOVE WS-EXP-DT     TO DC-BIN-DATE-1                       
002657        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT             
002658        if no-conversion-error                                    
002659           move dc-bin-date-2 to ws-extended-exp-dt               
002660        end-if                                                    
002661     end-if                                                       
002662                                                                  
002663*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
002664*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.              
002665                                                                  
002666     IF CL-INCURRED-DT < CM-CERT-EFF-DT                           
002667         move er-1681            to emi-error                     
002668*        MOVE ER-0458            TO EMI-ERROR                     
002669         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.               
002670                                                                  
002671     IF (CL-INCURRED-DT > WS-EXP-DT)                              
002672        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)                 
002673        MOVE ER-1677             TO EMI-ERROR                     
002674        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT                 
002675     END-IF                                                       
002676                                                                  
002677     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt           
002678     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT                   
002679         MOVE ER-0459            TO EMI-ERROR                     
002680         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.               
002681                                                                  
002682                                                                  
002683     if cl-claim-type = PI-LIFE-OVERRIDE-L1 OR 'O'                
002684        move cm-lf-benefit-cd    to ws-ben-cd                     
002685        move '4'                 to cntl-rec-type                 
002686     else                                                         
002687        move cm-ah-benefit-cd    to ws-ben-cd                     
002688        move '5'                 to cntl-rec-type                 
002689     end-if                                                       
002690     move ws-access              to cntl-access                   
002691     move pi-company-id          to cntl-comp-id                  
002692     move zeros                  to cntl-seq-no                   
002693     move 'BENE'                 to file-switch                   
002694     perform 7200-find-benefit   thru 7200-exit                   
002695     if not no-benefit-found                                      
002696        move cf-special-calc-cd(sub-1)                            
002697                                 to ws-special-calc-cd            
002698     end-if                                                       
002699                                                                  
002700     perform 7990-get-lo-hi-acct-dates                            
002701                                 thru 7990-exit                   
002702     if (cl-incurred-dt >= ws-hi-acct-dt)                         
002703        and (acct-cancelled)                                      
002704        and ((ws-special-calc-cd = 'O')                           
002705                 or                                               
002706            (pi-company-id = 'DCC' AND cl-carrier = '7'))         
002707        MOVE er-1681             TO EMI-ERROR                     
002708        PERFORM 1010-GENERAL-ERROR                                
002709                                 THRU 1010-EXIT                   
002710     end-if                                                       
002711                                                                  
002712*    if (cl-incurred-dt < ws-lo-acct-dt)                          
002713*       MOVE er-1681             TO EMI-ERROR                     
002714*       PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT                 
002715*    end-if                                                       
002716                                                                  
002717     IF CL-REPORTED-DT = LOW-VALUES                               
002718        MOVE ER-0530             TO EMI-ERROR                     
002719        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.                
002720                                                                  
002721     IF PI-COMPANY-ID = 'NCL'                                     
002722        IF CM-CREDIT-INTERFACE-SW-1 = '2'                         
002723            MOVE ER-0770            TO EMI-ERROR                  
002724            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.            
002725                                                                  
002726     IF PI-COMPANY-ID = 'NCL'                                     
002727        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)           
002728            MOVE ER-0737            TO EMI-ERROR                  
002729            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.            
002730                                                                  
002731     IF CM-ENTRY-STATUS = 'D' OR 'V'                              
002732         MOVE ER-0768            TO  EMI-ERROR                    
002733         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.               
002734                                                                  
002735     IF CM-CREDIT-INTERFACE-SW-1 = '4'                            
002736         MOVE ER-0769            TO  EMI-ERROR                    
002737         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.               
002738                                                                  
002739     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'                
002740         GO TO 1020-DO-LIFE-EDITS                                 
002741     ELSE                                                         
002742         GO TO 1030-DO-AH-EDITS.                                  
002743                                                                  
002744 1010-GENERAL-ERROR.                                              
002745     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
002746                                                                  
002747     IF EMI-MESSAGE-FORMATTED                                     
002748         MOVE -1                 TO PMTTYPEL.                     
002749                                                                  
002750 1010-EXIT.                                                       
002751     EXIT.                                                        
002752                                                                  
002753     EJECT                                                        
002754 1020-DO-LIFE-EDITS.                                              
002755     IF CM-LF-BENEFIT-CD = '00'                                   
002756         IF PI-PMTTYPE = '5' OR '6'                               
002757             MOVE ER-0658        TO EMI-ERROR                     
002758             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT            
002759         ELSE                                                     
002760            if (pi-company-id = 'DCC' or 'VPP')                   
002761               and (pi-dcc-product-code not = spaces)             
002762               continue                                           
002763            else                                                  
002764               MOVE ER-1775      TO EMI-ERROR                     
002765               PERFORM 1040-PMTTYPE-ERROR                         
002766                                 THRU 1040-EXIT                   
002767            end-if                                                
002768         end-if                                                   
002769     end-if                                                       
002770                                                                  
002771     move cm-ah-benefit-cd to pi-ah-benefit-cd                    
002772     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES                      
002773         MOVE ER-0460            TO EMI-ERROR                     
002774         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.               
002775                                                                  
002776     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.              
002777     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.                   
002778     MOVE WS-ACCESS              TO  CNTL-ACCESS.                 
002779     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.                
002780     MOVE '4'                    TO  CNTL-REC-TYPE.               
002781     MOVE ZEROS                  TO  CNTL-SEQ-NO.                 
002782     MOVE 'BENE'                 TO  FILE-SWITCH.                 
002783     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    
002784     IF NO-BENEFIT-FOUND                                          
002785         GO TO 1950-NOT-FOUND.                                    
002786                                                                  
002787     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.  
002788                                                                  
002789     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES                          
002790       AND NOT CM-LF-LUMP-SUM-DISAB                               
002791         IF PI-PMTTYPE = '4'                                      
002792             IF (PI-LIFE-OVERRIDE-L1 = 'P' OR                     
002793                PI-LF-COVERAGE-TYPE = 'P')                        
002794               AND NOT CM-LF-LUMP-SUM-DISAB                       
002795                 NEXT SENTENCE                                    
002796             ELSE                                                 
002797                 MOVE ER-0461        TO EMI-ERROR                 
002798                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT        
002799         ELSE                                                     
002800            NEXT SENTENCE                                         
002801     ELSE                                                         
002802         IF PI-PMTTYPE = '2'                                      
002803            IF NOT CM-O-B-COVERAGE                                
002804              AND CM-LF-CURRENT-STATUS = '7'                      
002805                MOVE ER-0462     TO EMI-ERROR                     
002806                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.        
002807                                                                  
002808     IF PI-PMTTYPE = '2'                                          
002809         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR 
002810            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)    
002811             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT         
002812             MOVE ER-0730            TO  EMI-ERROR                
002813             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT            
002814             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).   
002815                                                                  
002816     IF PI-PMTTYPE = '2'                                          
002817         IF PI-LIFE-OVERRIDE-L1 = 'P' OR                          
002818            PI-LF-COVERAGE-TYPE = 'P'                             
002819             IF CL-PAID-THRU-DT = CL-INCURRED-DT                  
002820                 MOVE ER-0462    TO  EMI-ERROR                    
002821                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.       
002822                                                                  
002823     IF CM-LF-CANCEL-DT NOT = LOW-VALUES                          
002824       AND CL-INCURRED-DT > CM-LF-CANCEL-DT                       
002825         MOVE ER-0466            TO EMI-ERROR                     
002826         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.               
002827                                                                  
002828     IF PI-COMPANY-ID = 'FLI' OR 'FLU'                            
002829         IF PI-PMTTYPE = '3'                                      
002830             MOVE 0436           TO EMI-ERROR                     
002831             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT            
002832             GO TO 1045-EDIT-PAYEE-ADDR                           
002833         ELSE                                                     
002834             GO TO 1045-EDIT-PAYEE-ADDR.                          
002835                                                                  
002836     IF CL-CLAIM-TYPE = 'O'                                       
002837         IF PI-PMTTYPE = '1' OR '2'                               
002838             MOVE ER-1930          TO EMI-ERROR                   
002839             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT            
002840         END-IF                                                   
002841     ELSE                                                         
002842     IF PI-LIFE-OVERRIDE-L1 = 'P' OR                              
002843        PI-LF-COVERAGE-TYPE = 'P'                                 
002844         IF PI-PMTTYPE = '3'                                      
002845             MOVE ER-0436          TO  EMI-ERROR                  
002846             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT            
002847         ELSE                                                     
002848             NEXT SENTENCE                                        
002849     ELSE                                                         
002850         IF PI-PMTTYPE = '1' OR '3'                               
002851             MOVE ER-0436            TO EMI-ERROR                 
002852             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.           
002853*                                                                 
002854     IF PI-COMPANY-ID = 'CID' AND                                 
002855        CL-CERT-STATE = 'SC'  AND                                 
002856        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')         
002857           MOVE ER-0879    TO  EMI-ERROR                          
002858           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT              
002859           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)    
002860     END-IF.                                                      
002861                                                                  
002862     IF PI-COMPANY-ID = 'AHL'                                     
002863        evaluate true                                             
002864           when CM-LF-BENEFIT-CD = '5I' OR '6J'                   
002865              MOVE ER-0879       TO  EMI-ERROR                    
002866              PERFORM 1040-PMTTYPE-ERROR                          
002867                                 THRU 1040-EXIT                   
002868              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)    
002869           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR        
002870                 '6D' OR '6H' OR '6R'                             
002871              MOVE ER-0879       TO  EMI-ERROR                    
002872              PERFORM 1040-PMTTYPE-ERROR                          
002873                                 THRU 1040-EXIT                   
002874              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)    
002875           when CM-LF-BENEFIT-CD = '5M' OR '6M'                   
002876              MOVE ER-0879       TO  EMI-ERROR                    
002877              PERFORM 1040-PMTTYPE-ERROR                          
002878                                 THRU 1040-EXIT                   
002879              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)    
002880        end-evaluate                                              
002881     END-IF                                                       
002882                                                                  
002883     GO TO 1045-EDIT-PAYEE-ADDR.                                  
002884                                                                  
002885     EJECT                                                        
002886 1030-DO-AH-EDITS.                                                
002887     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD              
002888     IF CM-AH-BENEFIT-CD = '00'                                   
002889         IF PI-PMTTYPE = '5' OR '6'                               
002890             MOVE ER-0658        TO EMI-ERROR                     
002891             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT            
002892         ELSE                                                     
002893             MOVE ER-1775        TO EMI-ERROR                     
002894             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.           
002895                                                                  
002896     IF CL-TOTAL-PAID-AMT = ZEROS                                 
002897         IF PI-PMTTYPE = '4'                                      
002898             MOVE ER-0438        TO EMI-ERROR                     
002899             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.           
002900                                                                  
002901     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES                      
002902         IF PI-PMTTYPE = '3'                                      
002903             MOVE ER-0463        TO EMI-ERROR                     
002904             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT            
002905         ELSE                                                     
002906             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)        
002907              AND CM-LF-CURRENT-STATUS = '7'                      
002908                 MOVE ER-0465    TO EMI-ERROR                     
002909                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.       
002910                                                                  
002911     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES                      
002912         IF PI-PMTTYPE = '3'                                      
002913             MOVE ER-0464        TO EMI-ERROR                     
002914             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT            
002915         ELSE                                                     
002916             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT              
002917                 MOVE ER-0469    TO EMI-ERROR                     
002918                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.       
002919                                                                  
002920     IF CM-AH-CANCEL-DT NOT = LOW-VALUES                          
002921         IF PI-PMTTYPE = '3'                                      
002922             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT              
002923                 MOVE ER-0467    TO EMI-ERROR                     
002924                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT        
002925             ELSE                                                 
002926                 NEXT SENTENCE                                    
002927         ELSE                                                     
002928             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT              
002929                 MOVE ER-0468    TO EMI-ERROR                     
002930                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.       
002931                                                                  
002932     IF PI-PMTTYPE = '2'                                          
002933        PERFORM WITH TEST AFTER                                   
002934         VARYING SUB FROM +1 BY +5                                
002935          UNTIL SUB > +60                                         
002936            OR PI-PMTNOTE2(SUB:1) = 'F'                           
002937            OR PI-PMTNOTE2(SUB:1) NOT > SPACES                    
002938        END-PERFORM                                               
002939        IF PI-PMTNOTE2(SUB:1) NOT = 'F'                           
002940           MOVE ER-3551    TO EMI-ERROR                           
002941           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT              
002942        END-IF                                                    
002943     END-IF.                                                      
002944                                                                  
002945     GO TO 1045-EDIT-PAYEE-ADDR.                                  
002946                                                                  
002947 1040-PMTTYPE-ERROR.                                              
002948     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
002949                                                                  
002950     IF EMI-MESSAGE-FORMATTED                                     
002951         MOVE -1                 TO PMTTYPEL                      
002952         MOVE AL-UABON           TO PMTTYPEA.                     
002953                                                                  
002954 1040-EXIT.                                                       
002955     EXIT.                                                        
002956                                                                  
002957     EJECT                                                        
002958 1045-EDIT-PAYEE-ADDR.                                            
002959                                                                  
002960     IF PI-OFFLINE = 'N' AND                                      
002961        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT             
002962           < PI-PAYEE-SEQ-NUM)                                    
002963        OR                                                        
002964         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND                
002965         (PI-PAYEE-TYPE = 'B')                 AND                
002966         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)                   
002967        OR                                                        
002968         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT             
002969           < PI-PAYEE-SEQ-NUM)                                    
002970        OR                                                        
002971         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT             
002972           < PI-PAYEE-SEQ-NUM)                                    
002973        OR                                                        
002974         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT             
002975           < PI-PAYEE-SEQ-NUM)                                    
002976        OR                                                        
002977         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT              
002978           < PI-PAYEE-SEQ-NUM)                                    
002979        OR                                                        
002980         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT            
002981           < PI-PAYEE-SEQ-NUM))                                   
002982             MOVE ER-0437        TO EMI-ERROR                     
002983             MOVE -1             TO PAYEEL                        
002984             MOVE AL-UABON       TO PAYEEA                        
002985             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            
002986                                                                  
002987     IF PI-OFFLINE    = 'N' AND                                   
002988        PI-PAYEE-TYPE = 'B' AND                                   
002989        PI-PAYEE-SEQ  = '0'                                       
002990         PERFORM 7920-READ-BENE THRU 7920-EXIT                    
002991         IF BENE-FOUND-SW = 'N'                                   
002992             MOVE ER-0437        TO EMI-ERROR                     
002993             MOVE -1             TO PAYEEL                        
002994             MOVE AL-UABON       TO PAYEEA                        
002995             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            
002996                                                                  
002997     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
002998        IF PI-OFFLINE    = 'N'  AND                               
002999           PI-PAYEE-TYPE = 'B'  AND                               
003000           PI-PAYEE-SEQ  = '9'                                    
003001             PERFORM 7920-READ-BENE THRU 7920-EXIT                
003002             IF BENE-FOUND-SW = 'N'                               
003003                MOVE ER-0437        TO EMI-ERROR                  
003004                MOVE -1             TO PAYEEL                     
003005                MOVE AL-UABON       TO PAYEEA                     
003006                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         
003007                                                                  
003008*    IF PI-COMPANY-ID = 'CRI'                                     
003009*        IF CL-CLAIM-TYPE = 'L'                                   
003010*            MOVE 'N'                TO  WS-GROUPED               
003011*                                        PI-GROUPED               
003012*                                        GROUPEDI                 
003013*            MOVE AL-UANON           TO  GROUPEDA                 
003014*            GO TO 1050-EDIT-CHECK-NO                             
003015*        ELSE                                                     
003016*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING              
003017*            IF WS-GROUP-1 = 'C'                                  
003018*                NEXT SENTENCE                                    
003019*            ELSE                                                 
003020*                MOVE 'N'            TO  WS-GROUPED               
003021*                                        PI-GROUPED               
003022*                                        GROUPEDI                 
003023*                MOVE AL-UANON       TO  GROUPEDA                 
003024*                GO TO 1050-EDIT-CHECK-NO.                        
003025                                                                  
003026*     IF PI-GROUPED = 'Y'                                         
003027*        IF PI-PAYEE-TYPE = 'B' OR 'A'                            
003028*           NEXT SENTENCE                                         
003029*        ELSE                                                     
003030*           MOVE ER-0437        TO EMI-ERROR                      
003031*           MOVE -1             TO PAYEEL                         
003032**02180            MOVE AL-UABON       TO PAYEEA                  
003033*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             
003034*                                                                 
003035*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND                         
003036*        (PI-GROUPED    = ' ')                                    
003037*        NEXT SENTENCE                                            
003038*     ELSE                                                        
003039*                                                                 
003040     GO TO 1050-EDIT-CHECK-NO.                                    
003041                                                                  
003042*     IF PI-COMPANY-ID = 'CRI'                                    
003043*        MOVE 'N'           TO GROUPEDI                           
003044*                              PI-GROUPED                         
003045*                              WS-GROUPED                         
003046*        MOVE AL-UANON      TO GROUPEDA.                          
003047*                                                                 
003048*     IF PI-COMPANY-ID = 'CRI'                                    
003049*        IF PI-PAYEE-TYPE = 'B'                                   
003050*           IF BENE-FOUND-SW = 'Y'                                
003051*              IF BE-GROUP-CHECKS-Y-N = 'Y'                       
003052*                 MOVE 'Y'           TO GROUPEDI                  
003053*                                       PI-GROUPED                
003054*                                       WS-GROUPED                
003055*                 MOVE AL-UANON      TO GROUPEDA                  
003056*              ELSE                                               
003057*                 NEXT SENTENCE                                   
003058*           ELSE                                                  
003059*              PERFORM 7920-READ-BENE THRU 7920-EXIT              
003060*              IF BENE-FOUND-SW = 'Y'                             
003061*                 IF BE-GROUP-CHECKS-Y-N = 'Y'                    
003062*                    MOVE 'Y'      TO GROUPEDI                    
003063*                                     PI-GROUPED                  
003064*                                     WS-GROUPED                  
003065*                    MOVE AL-UANON TO GROUPEDA.                   
003066*                                                                 
003067                                                                  
003068     IF PI-COMPANY-ID NOT = 'CRI'                                 
003069        GO TO 1050-EDIT-CHECK-NO.                                 
003070                                                                  
003071*************** CRI CODE START ******************                 
003072     IF PI-PAYEE-TYPE NOT = 'A'                                   
003073        GO TO 1050-EDIT-CHECK-NO.                                 
003074                                                                  
003075     MOVE LOW-VALUES             TO ERACCT-KEY.                   
003076     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.                 
003077     MOVE PI-CARRIER             TO ACCT-CARRIER.                 
003078     MOVE PI-GROUPING            TO ACCT-GROUPING.                
003079     MOVE PI-STATE               TO ACCT-STATE.                   
003080     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.                 
003081     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.                  
003082     MOVE 'ACCT'                 TO FILE-SWITCH.                  
003083                                                                  
003084     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.           
003085     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.        
003086                                                                  
003087     EXEC CICS HANDLE CONDITION                                   
003088          NOTFND   (1950-NOT-FOUND)                               
003089          ENDFILE  (1950-NOT-FOUND)                               
003090     END-EXEC.                                                    
003091                                                                  
003092     EXEC CICS STARTBR                                            
003093          DATASET   ('ERACCT')                                    
003094          RIDFLD    (ERACCT-KEY)                                  
003095          GTEQ                                                    
003096     END-EXEC.                                                    
003097                                                                  
003098 1046-READNEXT-ERACCT.                                            
003099                                                                  
003100     set eracct-browse-started to true                            
003101                                                                  
003102     EXEC CICS READNEXT                                           
003103          DATASET   ('ERACCT')                                    
003104          RIDFLD    (ERACCT-KEY)                                  
003105          SET       (ADDRESS OF ACCOUNT-MASTER)                   
003106     END-EXEC.                                                    
003107                                                                  
003108     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY               
003109        IF WS-ERACCT-HOLD-RECORD = SPACES                         
003110           GO TO 1950-NOT-FOUND                                   
003111        ELSE                                                      
003112           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER           
003113           GO TO 1048-CONTINUE.                                   
003114                                                                  
003115     IF ACCT-EXP-DT = HIGH-VALUES                                 
003116        NEXT SENTENCE                                             
003117     ELSE                                                         
003118        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD              
003119        GO TO 1046-READNEXT-ERACCT.                               
003120                                                                  
003121 1048-CONTINUE.                                                   
003122                                                                  
003123*    IF AM-GROUPED-CHECKS-Y-N = 'Y'                               
003124*       MOVE 'Y'                 TO GROUPEDI                      
003125*                                   PI-GROUPED                    
003126*                                   WS-GROUPED                    
003127*       MOVE AL-UANON            TO GROUPEDA.                     
003128*************** CRI CODE END ******************                   
003129                                                                  
003130     EJECT                                                        
003131 1050-EDIT-CHECK-NO.                                              
003132                                                                  
003133     if eracct-browse-started                                     
003134        exec cics endbr                                           
003135           dataset('ERACCT')                                      
003136        end-exec                                                  
003137        move spaces              to ws-eracct-startbr-ind         
003138     end-if                                                       
003139                                                                  
003140     IF PI-OFFLINE = 'Y'                                          
003141         IF PI-ECHECKNO = SPACES                                  
003142              MOVE ER-0439        TO EMI-ERROR                    
003143              GO TO 1090-CHECK-NO-ERROR                           
003144           ELSE                                                   
003145*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'                        
003146*           IF PI-ECHECKNO-N = 'N' AND                            
003147*              PI-CASH       = 'Y'                                
003148*                MOVE ER-3535        TO EMI-ERROR                 
003149*                GO TO 1090-CHECK-NO-ERROR                        
003150*             ELSE                                                
003151*                MOVE AL-UANON    TO CHECKNOA                     
003152*                GO TO 1100-EDIT-HOLDTIL                          
003153*         ELSE                                                    
003154            MOVE AL-UANON    TO CHECKNOA                          
003155            GO TO 1100-EDIT-HOLDTIL.                              
003156                                                                  
003157     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
003158     MOVE '6'                    TO CNTL-REC-TYPE.                
003159                                                                  
003160     IF CONTROL-IS-ACTUAL-CARRIER                                 
003161         MOVE PI-CARRIER         TO WS-CARR                       
003162     ELSE                                                         
003163         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.                
003164                                                                  
003165     IF PI-COMPANY-ID = 'FIA'                                     
003166         MOVE PI-CARRIER         TO WS-CARR.                      
003167                                                                  
003168     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  
003169     MOVE 0                      TO CNTL-SEQ-NO.                  
003170     MOVE 'CARR'                 TO FILE-SWITCH.                  
003171                                                                  
003172     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.                    
003173                                                                  
003174     EJECT                                                        
003175     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'                       
003176         GO TO 1051-EDIT-CHECKNO-CONT.                            
003177                                                                  
003178**********************AIG LOGIC STARTS**********************      
003179     IF PI-ECHECKNO = SPACES                                      
003180         IF CHECK-NO-MANUAL                                       
003181             MOVE ER-0441        TO EMI-ERROR                     
003182             GO TO 1090-CHECK-NO-ERROR                            
003183         ELSE                                                     
003184             MOVE AL-UANOF       TO CHECKNOA                      
003185             GO TO 1100-EDIT-HOLDTIL.                             
003186                                                                  
003187     IF PI-ECHECKNO NOT = SPACES                                  
003188         IF CHECK-NO-MANUAL                                       
003189             MOVE AL-UANON       TO CHECKNOA                      
003190             GO TO 1100-EDIT-HOLDTIL.                             
003191                                                                  
003192     IF PI-ECHECKNO-CR = 'CR'                                     
003193        IF PI-OFFLINE = 'Y'                                       
003194            MOVE AL-UANON       TO CHECKNOA                       
003195            GO TO 1100-EDIT-HOLDTIL                               
003196        ELSE                                                      
003197            MOVE ER-3534        TO EMI-ERROR                      
003198            GO TO 1090-CHECK-NO-ERROR.                            
003199                                                                  
003200     IF PI-ECHECKNO-N = 'N'                                       
003201        IF PI-CASH = 'N'                                          
003202            MOVE AL-UANON       TO CHECKNOA                       
003203            GO TO 1100-EDIT-HOLDTIL                               
003204        ELSE                                                      
003205            MOVE ER-3535          TO EMI-ERROR                    
003206            GO TO 1090-CHECK-NO-ERROR.                            
003207                                                                  
003208     MOVE ER-0442        TO EMI-ERROR                             
003209     GO TO 1090-CHECK-NO-ERROR.                                   
003210**********************AIG LOGIC ENDS************************      
003211                                                                  
003212 1051-EDIT-CHECKNO-CONT.                                          
003213                                                                  
003214     IF PI-COMPANY-ID = 'DMD'                                     
003215        IF PI-ECHECKNO NOT = SPACES                               
003216           IF PI-ECHECKNO (6:2) NOT = 'TP'                        
003217              MOVE ER-0442        TO EMI-ERROR                    
003218              GO TO 1090-CHECK-NO-ERROR                           
003219            ELSE                                                  
003220              GO TO 1100-EDIT-HOLDTIL                             
003221          ELSE                                                    
003222           GO TO 1100-EDIT-HOLDTIL.                               
003223                                                                  
003224     IF PI-ECHECKNO = SPACES                                      
003225         IF CHECK-NO-MANUAL                                       
003226             MOVE ER-0441        TO EMI-ERROR                     
003227             GO TO 1090-CHECK-NO-ERROR                            
003228         ELSE                                                     
003229             MOVE AL-UANOF       TO CHECKNOA                      
003230             GO TO 1100-EDIT-HOLDTIL                              
003231     ELSE                                                         
003232         IF CHECK-NO-MANUAL                                       
003233             MOVE AL-UANON       TO CHECKNOA                      
003234             GO TO 1100-EDIT-HOLDTIL                              
003235         ELSE                                                     
003236             MOVE ER-0442        TO EMI-ERROR                     
003237             GO TO 1090-CHECK-NO-ERROR.                           
003238                                                                  
003239 1090-CHECK-NO-ERROR.                                             
003240     MOVE -1                     TO CHECKNOL.                     
003241     MOVE AL-UABON               TO CHECKNOA.                     
003242     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
003243                                                                  
003244     GO TO 2000-EDIT-DONE.                                        
003245                                                                  
003246     EJECT                                                        
003247 1100-EDIT-HOLDTIL.                                               
003248     MOVE ZERO TO WS-TOT-AMOUNT-PAID                              
003249                  WS-UNPD-HOLD-UNTIL-DT                           
003250     SET HOLD-UNTIL-CHK TO TRUE                                   
003251     MOVE CL-PAID-THRU-DT TO WS-HOLD-UNTIL-DT                     
003252     PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.            
003253     IF CL-TOTAL-PAID-AMT NOT = WS-TOT-AMOUNT-PAID                
003254         MOVE ER-3277            TO EMI-ERROR                     
003255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
003256     END-IF                                                       
003257                                                                  
003258     MOVE SPACE TO WS-HOLD-UNTIL-SW                               
003259                                                                  
003260     MOVE AL-UANON               TO HOLDTILA.                     
003261                                                                  
003262     IF PI-HOLDTIL = ZEROS                                        
003263        IF PI-OFFLINE = 'Y'                                       
003264           MOVE ER-0572          TO EMI-ERROR                     
003265           GO TO 1105-HOLDTIL-ERROR                               
003266        ELSE                                                      
003267           GO TO 1110-EDIT-PAID-FROM.                             
003268                                                                  
003269     MOVE '4'                    TO DC-OPTION-CODE.               
003270     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.           
003271     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
003272                                                                  
003273     IF DATE-CONVERSION-ERROR                                     
003274         MOVE ER-0446            TO EMI-ERROR                     
003275         GO TO 1105-HOLDTIL-ERROR                                 
003276     END-IF                                                       
003277                                                                  
003278     IF PI-OFFLINE = 'Y'                                          
003279        IF DC-BIN-DATE-1 < SAVE-BIN-DATE                          
003280           MOVE ER-0446            TO EMI-ERROR                   
003281           GO TO 1105-HOLDTIL-ERROR                               
003282        END-IF                                                    
003283     END-IF                                                       
003284                                                                  
003285     IF DC-BIN-DATE-1 < WS-UNPD-HOLD-UNTIL-DT                     
003286        MOVE ER-3278          TO EMI-ERROR                        
003287        GO TO 1105-HOLDTIL-ERROR                                  
003288     END-IF                                                       
003289                                                                  
003290     IF PI-OFFLINE = 'Y'                                          
003291        GO TO 1110-EDIT-PAID-FROM.                                
003292                                                                  
003293     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.                
003294     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.                
003295     MOVE '1'                    TO DC-OPTION-CODE.               
003296     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
003297                                                                  
003298*    IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR             
003299     IF DC-ELAPSED-DAYS > 60 OR DATE-CONVERSION-ERROR             
003300         MOVE ER-0447            TO EMI-ERROR                     
003301         GO TO 1105-HOLDTIL-ERROR.                                
003302                                                                  
003303     GO TO 1110-EDIT-PAID-FROM.                                   
003304                                                                  
003305 1105-HOLDTIL-ERROR.                                              
003306     MOVE -1                     TO HOLDTILL.                     
003307     MOVE AL-UNBON               TO HOLDTILA.                     
003308     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
003309                                                                  
003310     EJECT                                                        
003311 1110-EDIT-PAID-FROM.                                             
003312     MOVE AL-UANON               TO EPYFROMA.                     
003313                                                                  
003314     IF PI-EPYFROM = ZEROS                                        
003315         GO TO 1120-CALCULATE-PAID-FROM.                          
003316                                                                  
003317     IF PI-PMTTYPE = '5' OR '6'                                   
003318         MOVE ER-0448            TO EMI-ERROR                     
003319         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
003320         MOVE AL-UNBON           TO EPYFROMA                      
003321         MOVE -1                 TO EPYFROML                      
003322         GO TO 1150-EDIT-PAID-THRU.                               
003323                                                                  
003324     MOVE '4'                    TO DC-OPTION-CODE.               
003325     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.           
003326     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
003327                                                                  
003328     IF DATE-CONVERSION-ERROR                                     
003329         MOVE ER-0449            TO EMI-ERROR                     
003330         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
003331         MOVE AL-UNBON           TO EPYFROMA                      
003332         MOVE -1                 TO EPYFROML                      
003333     ELSE                                                         
003334         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.                
003335                                                                  
003336     EJECT                                                        
003337 1120-CALCULATE-PAID-FROM.                                        
003338     IF PI-PMTTYPE = '5' OR '6'                                   
003339         GO TO 1150-EDIT-PAID-THRU.                               
003340                                                                  
003341*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
003342*       IF PI-PMTTYPE = '4'                                       
003343*         GO TO 1150-EDIT-PAID-THRU.                              
003344                                                                  
003345     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'                
003346         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1                 
003347         MOVE ' '                TO DC-OPTION-CODE                
003348         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT            
003349         MOVE DC-BIN-DATE-1      TO PI-CPYFROM                    
003350         GO TO 1145-TEST-PAID-FROM.                               
003351                                                                  
003352     IF PI-PMTTYPE = '4'                                          
003353        GO TO 1150-EDIT-PAID-THRU.                                
003354                                                                  
003355     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.                    
003356     MOVE WS-ACCESS              TO CNTL-ACCESS.                  
003357     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
003358     MOVE '5'                    TO CNTL-REC-TYPE.                
003359     MOVE ZEROS                  TO CNTL-SEQ-NO.                  
003360     MOVE 'BENE'                 TO FILE-SWITCH.                  
003361                                                                  
003362     IF WS-BEN-CD = ZEROS                                         
003363         GO TO 1950-NOT-FOUND.                                    
003364                                                                  
003365     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    
003366                                                                  
003367     IF NO-BENEFIT-FOUND                                          
003368         GO TO 1950-NOT-FOUND.                                    
003369                                                                  
003370     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.          
003371     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.       
003372                                                                  
003373     if pdef-found                                                
003374        if pd-ret-elim(p1) = 'R' or 'E'                           
003375           move pd-ret-elim(p1)  to pi-ben-type                   
003376           move pd-wait-days(p1) to pi-ben-days                   
003377        end-if                                                    
003378     end-if                                                       
003379                                                                  
003380     IF PI-BEN-DAYS NOT NUMERIC                                   
003381        MOVE ZEROS               TO PI-BEN-DAYS.                  
003382                                                                  
003383     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.                  
003384                                                                  
003385     IF WS-HOLD-UNTIL-DT > CL-PAID-THRU-DT                        
003386         MOVE WS-HOLD-UNTIL-DT     TO DC-BIN-DATE-1               
003387         MOVE '6'                 TO DC-OPTION-CODE               
003388         MOVE +0                  TO DC-ELAPSED-MONTHS            
003389         MOVE +1                  TO DC-ELAPSED-DAYS              
003390         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT            
003391         MOVE DC-BIN-DATE-2       TO PI-CPYFROM                   
003392         GO TO 1145-TEST-PAID-FROM.                               
003393                                                                  
003394     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND        
003395        (CL-TOTAL-PAID-AMT > ZEROS)                               
003396         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1                
003397         MOVE '6'                 TO DC-OPTION-CODE               
003398         MOVE +0                  TO DC-ELAPSED-MONTHS            
003399         MOVE +1                  TO DC-ELAPSED-DAYS              
003400         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT            
003401         MOVE DC-BIN-DATE-2       TO PI-CPYFROM                   
003402         GO TO 1145-TEST-PAID-FROM.                               
003403                                                                  
003404******************************************************************
003405****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE 
003406****** SPECIAL ENTERED DATE.                                      
003407******************************************************************
003408                                                                  
003409     IF PI-AIGFROM = ZEROS                                        
003410         GO TO 1130-CONTINUE-PAID-FROM.                           
003411                                                                  
003412     MOVE AL-UANON TO AIGFROMA.                                   
003413                                                                  
003414     MOVE '4'                    TO DC-OPTION-CODE.               
003415     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.           
003416     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
003417                                                                  
003418     IF DATE-CONVERSION-ERROR                                     
003419         MOVE ER-0449            TO EMI-ERROR                     
003420         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
003421         MOVE AL-UNBON           TO AIGFROMA                      
003422         MOVE -1                 TO AIGFROML                      
003423         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1                     
003424     ELSE                                                         
003425         MOVE 'Y'                TO WS-AIG-PAYFROM-SW             
003426         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.                
003427                                                                  
003428     GO TO 1140-CONTINUE-PAID-FROM.                               
003429                                                                  
003430 1130-CONTINUE-PAID-FROM.                                         
003431                                                                  
003432     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR             
003433        (CL-TOTAL-PAID-AMT = ZEROS)                               
003434           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.                  
003435                                                                  
003436 1140-CONTINUE-PAID-FROM.                                         
003437                                                                  
003438     IF PI-BEN-TYPE = 'R'                                         
003439         IF PI-BEN-DAYS = ZEROS                                   
003440             NEXT SENTENCE                                        
003441         ELSE                                                     
003442         IF PI-COMPANY-ID NOT = 'DMD'                             
003443             SUBTRACT 1 FROM PI-BEN-DAYS.                         
003444                                                                  
003445     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.           
003446                                                                  
003447     IF PI-COMPANY-ID = 'DMD'                                     
003448         MOVE -1                 TO DC-ELAPSED-DAYS               
003449         MOVE +0                 TO DC-ELAPSED-MONTHS             
003450         MOVE '6'                TO DC-OPTION-CODE                
003451         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT            
003452         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1                 
003453         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS        
003454                               REMAINDER DC-ELAPSED-DAYS          
003455      ELSE                                                        
003456         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS               
003457         MOVE +0                 TO DC-ELAPSED-MONTHS.            
003458                                                                  
003459     MOVE '6'                    TO DC-OPTION-CODE.               
003460     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
003461     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.           
003462                                                                  
003463     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.                
003464                                                                  
003465     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE                        
003466         MOVE ER-0541            TO EMI-ERROR                     
003467         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
003468         MOVE -1                 TO EPYFROML                      
003469         MOVE AL-UNBON           TO EPYFROMA.                     
003470                                                                  
003471     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND                     
003472        (PI-BENEFIT-SAVE = '60E')                                 
003473        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR          
003474           (CL-TOTAL-PAID-AMT = ZEROS)                            
003475             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1            
003476             MOVE 30                  TO DC-ELAPSED-DAYS          
003477             MOVE +0                  TO DC-ELAPSED-MONTHS        
003478             MOVE '6'                 TO DC-OPTION-CODE           
003479             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.       
003480                                                                  
003481     IF PI-BEN-TYPE = 'R'                                         
003482         MOVE DC-BIN-DATE-1      TO PI-CPYFROM                    
003483     ELSE                                                         
003484         MOVE DC-BIN-DATE-2      TO PI-CPYFROM                    
003485         IF WS-SV-EPYFROM = LOW-VALUES                            
003486            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.                
003487                                                                  
003488     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES                    
003489         IF WS-USE-AIG-PAYFROM   OR                               
003490            WS-AIG-RECALC-PAYFROM                                 
003491              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM               
003492                                      DC-BIN-DATE-1               
003493              MOVE ' '            TO  DC-OPTION-CODE              
003494              MOVE +0             TO  DC-ELAPSED-MONTHS           
003495                                      DC-ELAPSED-DAYS             
003496              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT       
003497              IF NO-CONVERSION-ERROR                              
003498                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.          
003499                                                                  
003500     IF PI-CPYFROM < CL-INCURRED-DT                               
003501        MOVE -1                  TO EPYFROML                      
003502        MOVE ER-3542             TO EMI-ERROR                     
003503        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 
003504                                                                  
003505     IF CM-ENTRY-DT < CL-INCURRED-DT                              
003506        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1              
003507        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2              
003508        MOVE +0                     TO DC-ELAPSED-DAYS            
003509        MOVE +0                     TO DC-ELAPSED-MONTHS          
003510        MOVE '1'                    TO DC-OPTION-CODE             
003511        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT             
003512        ELSE                                                      
003513        MOVE ZEROS TO DC-ELAPSED-MONTHS.                          
003514                                                                  
003515     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'                   
003516         NEXT SENTENCE                                            
003517     ELSE                                                         
003518         IF DC-ELAPSED-MONTHS < 2                                 
003519             MOVE ER-3255        TO EMI-ERROR                     
003520             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            
003521                                                                  
003522 1145-TEST-PAID-FROM.                                             
003523     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM                  
003524         GO TO 1150-EDIT-PAID-THRU.                               
003525                                                                  
003526     IF WS-SV-EPYFROM NOT = PI-CPYFROM                            
003527         MOVE PI-CPYFROM         TO DC-BIN-DATE-1                 
003528         MOVE ' '                TO DC-OPTION-CODE                
003529         MOVE +0                 TO DC-ELAPSED-MONTHS             
003530                                    DC-ELAPSED-DAYS               
003531         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT            
003532         IF NO-CONVERSION-ERROR                                   
003533             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD            
003534         ELSE                                                     
003535             MOVE SPACES             TO EMI-DATE-FIELD.           
003536                                                                  
003537     IF PI-HOLDTIL NOT = ZEROS                                    
003538        CONTINUE                                                  
003539     ELSE                                                         
003540     IF WS-SV-EPYFROM NOT = PI-CPYFROM                            
003541         IF CL-TOTAL-PAID-AMT = ZEROS                             
003542             MOVE ER-3543            TO EMI-ERROR                 
003543             MOVE WS-SV-EPYFROM      TO PI-CPYFROM                
003544             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             
003545             IF EMI-MESSAGE-FORMATTED                             
003546                MOVE -1             TO EPYFROML                   
003547                MOVE AL-UNBON       TO EPYFROMA                   
003548             ELSE                                                 
003549                NEXT SENTENCE                                     
003550         ELSE                                                     
003551             MOVE ER-0452            TO EMI-ERROR                 
003552             MOVE WS-SV-EPYFROM      TO PI-CPYFROM                
003553             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             
003554             IF EMI-MESSAGE-FORMATTED                             
003555                MOVE -1             TO EPYFROML                   
003556                MOVE AL-UNBON       TO EPYFROMA.                  
003557                                                                  
003558     EJECT                                                        
003559 1150-EDIT-PAID-THRU.                                             
003560                                                                  
003561     MOVE AL-UANON               TO EPYTHRUA.                     
003562                                                                  
003563     IF PI-EPYTHRU = ZEROS                                        
003564*        IF PI-PMTTYPE = '4' OR '5' OR '6'                        
003565         IF PI-PMTTYPE = '5' OR '6'                               
003566           OR (CL-CLAIM-TYPE NOT = 'L' AND 'O'                    
003567             AND PI-PMTTYPE = '4')                                
003568             GO TO 1200-EDIT-FIND-TOLERANCES                      
003569         ELSE                                                     
003570            IF (PI-PMTTYPE = '3') OR (PI-PMTTYPE = '4') OR        
003571               (PI-PMTTYPE = '2' AND                              
003572                 CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')      
003573               GO TO 1152-CHECK-TYPE                              
003574            ELSE                                                  
003575               MOVE ER-0473      TO EMI-ERROR                     
003576               GO TO 1170-PAID-THRU-FATAL-ERROR                   
003577     ELSE                                                         
003578         IF PI-PMTTYPE = '5' OR '6'                               
003579             MOVE ER-0474        TO EMI-ERROR                     
003580             GO TO 1170-PAID-THRU-FATAL-ERROR.                    
003581                                                                  
003582     MOVE '4'                    TO DC-OPTION-CODE.               
003583     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.           
003584     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
003585                                                                  
003586     IF DATE-CONVERSION-ERROR                                     
003587         MOVE ER-0475            TO EMI-ERROR                     
003588         GO TO 1170-PAID-THRU-FATAL-ERROR.                        
003589                                                                  
003590     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.                   
003591                                                                  
003592     IF PI-COMPANY-ID = 'DMD'                                     
003593         IF PI-PMTTYPE NOT = '2'                                  
003594                 AND                                              
003595            WS-EXP-DT > WS-SV-EPYTHRU                             
003596             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1               
003597             MOVE WS-EXP-DT        TO DC-BIN-DATE-2               
003598             MOVE '1'              TO DC-OPTION-CODE              
003599             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT        
003600             IF DATE-CONVERSION-ERROR                             
003601                 MOVE ER-0944      TO EMI-ERROR                   
003602                 GO TO 1170-PAID-THRU-FATAL-ERROR                 
003603             ELSE                                                 
003604                 IF DC-ELAPSED-MONTHS = ZEROS AND                 
003605                    DC-ELAPSED-DAYS   = 1                         
003606                     MOVE ER-0945  TO EMI-ERROR                   
003607                     MOVE -1       TO EPYTHRUL                    
003608                     MOVE AL-UABON TO EPYTHRUA                    
003609                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.    
003610                                                                  
003611     IF PI-PMTTYPE = '4'                                          
003612         NEXT SENTENCE                                            
003613     ELSE                                                         
003614         IF WS-SV-EPYTHRU = WS-EXP-DT                             
003615             IF PI-PMTTYPE NOT = '2' AND '3'                      
003616                 MOVE ER-3541    TO EMI-ERROR                     
003617                 MOVE -1         TO PMTTYPEL                      
003618                 MOVE AL-UABON   TO PMTTYPEA                      
003619                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        
003620                                                                  
003621     IF WS-SV-EPYTHRU < WS-SV-EPYFROM                             
003622         MOVE ER-0501            TO EMI-ERROR                     
003623         GO TO 1170-PAID-THRU-FATAL-ERROR.                        
003624                                                                  
003625     IF WS-SV-EPYTHRU > WS-TODAY-DATE                             
003626        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F' 
003627                                             OR 'B' or 'H'        
003628*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'                      
003629*              MOVE ER-0540         TO EMI-ERROR                  
003630*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           
003631*              MOVE -1              TO EPYTHRUL                   
003632*              MOVE AL-UNBON        TO EPYTHRUA                   
003633*          ELSE                                                   
003634*          IF PI-COMPANY-ID = 'DMD'                               
003635*              MOVE ER-7540         TO EMI-ERROR                  
003636*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           
003637*              MOVE -1              TO EPYTHRUL                   
003638*              MOVE AL-UNBON        TO EPYTHRUA                   
003639*          ELSE                                                   
003640               IF PI-PMTTYPE NOT = '2' AND '3'                    
003641                  IF PI-COMPANY-ID = '???'                        
003642                      MOVE ER-7540  TO EMI-ERROR                  
003643                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    
003644                      MOVE -1       TO EPYTHRUL                   
003645                      MOVE AL-UNBON TO EPYTHRUA                   
003646                  ELSE                                            
003647                      MOVE ER-0540  TO EMI-ERROR                  
003648                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    
003649                      MOVE -1       TO EPYTHRUL                   
003650                      MOVE AL-UNBON TO EPYTHRUA.                  
003651                                                                  
003652     MOVE 'N' TO PI-DUPE-APPROVAL-NEEDED                          
003653     IF ((WS-SV-EPYTHRU < CL-PAID-THRU-DT)                        
003654            OR                                                    
003655        (WS-SV-EPYTHRU NOT = LOW-VALUES AND                       
003656         WS-SV-EPYTHRU < CL-PAID-THRU-DT)                         
003657            OR                                                    
003658        (PI-CPYFROM NOT = LOW-VALUES AND                          
003659         PI-CPYFROM < CL-PAID-THRU-DT))                           
003660       AND NOT PI-PMTTYPE = '4'                                   
003661        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT          
003662     ELSE                                                         
003663     IF WS-SV-EPYTHRU NOT = LOW-VALUES                            
003664       AND WS-SV-EPYFROM NOT = LOW-VALUES                         
003665        SET CHECK-ALL-PMTS TO TRUE                                
003666        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.         
003667                                                                  
003668     IF PI-HOLDTIL = ZEROS                                        
003669       AND UNPAID-HOLD-UNTIL-EXISTS                               
003670       AND NOT DUPE-VOID-PMT-EXISTS                               
003671        MOVE ER-3276    TO EMI-ERROR                              
003672        MOVE -1         TO HOLDTILL                               
003673        MOVE AL-UABON   TO HOLDTILA                               
003674        GO TO 1170-PAID-THRU-FATAL-ERROR                          
003675     END-IF.                                                      
003676                                                                  
003677 1152-CHECK-TYPE.                                                 
003678     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'   
003679                                           OR 'B' or 'H')         
003680        OR (PI-PMTTYPE = '5' OR '6')                              
003681         GO TO 1160-EDIT-PAID-THRU-AH.                            
003682                                                                  
003683 1155-EDIT-PAID-THRU-LIFE.                                        
003684     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.                    
003685     MOVE WS-ACCESS              TO CNTL-ACCESS.                  
003686     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
003687     MOVE '4'                    TO CNTL-REC-TYPE.                
003688     MOVE ZEROS                  TO CNTL-SEQ-NO.                  
003689     MOVE 'BENE'                 TO FILE-SWITCH.                  
003690                                                                  
003691     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    
003692                                                                  
003693     IF NO-BENEFIT-FOUND                                          
003694         GO TO 1950-NOT-FOUND.                                    
003695                                                                  
003696     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.       
003697                                                                  
003698     MOVE WS-EXP-DT              TO PI-CPYTHRU.                   
003699                                                                  
003700     IF PI-LIFE-OVERRIDE-L1 = 'P' OR                              
003701        PI-LF-COVERAGE-TYPE = 'P'                                 
003702         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU                   
003703         GO TO 1200-EDIT-FIND-TOLERANCES.                         
003704                                                                  
003705     IF PI-EPYTHRU = ZEROS                                        
003706        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.                
003707                                                                  
003708     IF WS-SV-EPYTHRU NOT = WS-EXP-DT                             
003709         MOVE ER-0476            TO EMI-ERROR                     
003710         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.             
003711                                                                  
003712     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.                 
003713*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.             
003714     move cl-critical-period    to dc-elapsed-months              
003715     MOVE +0                    TO DC-ELAPSED-DAYS.               
003716     MOVE '6'                   TO DC-OPTION-CODE.                
003717     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
003718                                                                  
003719     IF (NO-CONVERSION-ERROR AND                                  
003720         WS-SPECIAL-CALC-CD = 'C')                                
003721        IF CL-INCURRED-DT > DC-BIN-DATE-2                         
003722            MOVE ER-0657 TO EMI-ERROR                             
003723            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.          
003724                                                                  
003725     IF PI-COMPANY-ID = 'NCL'                                     
003726         IF WS-SPECIAL-CALC-CD = 'C' AND                          
003727            cl-critical-period = zeros                            
003728*           CM-LF-CRITICAL-PERIOD = +0                            
003729             MOVE ER-0844       TO EMI-ERROR                      
003730             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.         
003731                                                                  
003732     GO TO 1200-EDIT-FIND-TOLERANCES.                             
003733                                                                  
003734 1160-EDIT-PAID-THRU-AH.                                          
003735     IF PI-EPYTHRU = ZEROS                                        
003736        MOVE WS-EXP-DT           TO PI-CPYTHRU                    
003737                                    WS-SV-EPYTHRU                 
003738     ELSE                                                         
003739        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.                   
003740                                                                  
003741     IF WS-SV-EPYTHRU < PI-CPYFROM                                
003742         MOVE ER-0508            TO EMI-ERROR                     
003743         GO TO 1170-PAID-THRU-FATAL-ERROR.                        
003744                                                                  
003745     perform 7975-read-acct      thru 7975-exit                   
003746                                                                  
003747     move zeros                  to pi-max-ext                    
003748     if PI-DCC-PRODUCT-CODE NOT = SPACES                          
003749        PERFORM 0900-GET-DDF-LIMITS                               
003750                                 THRU 0900-EXIT                   
003751        IF PDEF-FOUND                                             
003752           PERFORM VARYING P1 FROM +1 BY +1 UNTIL                 
003753              (P1 > +11)                                          
003754              OR ((PD-PROD-CODE (P1) = CL-CLAIM-TYPE)             
003755              AND (PD-MAX-ATT-AGE (P1) >= WS-ATT-AGE))            
003756           END-PERFORM                                            
003757           IF P1 < +12                                            
003758              MOVE PD-MAX-extension (P1)                          
003759                                 TO pi-max-ext                    
003760           else                                                   
003761              move er-1674       to emi-error                     
003762              PERFORM 9900-ERROR-FORMAT                           
003763                                 THRU 9900-EXIT                   
003764           END-IF                                                 
003765        else                                                      
003766           move er-1672          to emi-error                     
003767           PERFORM 9900-ERROR-FORMAT                              
003768                                 THRU 9900-EXIT                   
003769        END-IF                                                    
003770     end-if                                                       
003771                                                                  
003772     move spaces                 to pi-max-ext-used               
003773     IF PI-PMTTYPE = '3'                                          
003774        MOVE WS-EXP-DT           TO PI-CPYTHRU                    
003775        IF WS-SV-EPYTHRU NOT = WS-EXP-DT                          
003776           MOVE ER-0477          TO EMI-ERROR                     
003777           PERFORM 1165-PAID-THRU-ERROR                           
003778                                 THRU 1165-EXIT                   
003779        ELSE                                                      
003780           continue                                               
003781        end-if                                                    
003782     ELSE                                                         
003783        IF WS-SV-EPYTHRU > WS-EXP-DT                              
003784         IF PI-DCC-PRODUCT-CODE NOT > SPACES                      
003785           move ws-exp-dt        to dc-bin-date-1                 
003786           move ws-sv-epythru    to dc-bin-date-2                 
003787           MOVE '1'              TO DC-OPTION-CODE                
003788           MOVE +0               TO DC-ELAPSED-DAYS               
003789                                    DC-ELAPSED-MONTHS             
003790           PERFORM 9700-LINK-DATE-CONVERT                         
003791                                 THRU 9700-EXIT                   
003792           if no-conversion-error                                 
003793              if dc-elapsed-days > zeros                          
003794                 add +1 to dc-elapsed-months                      
003795              end-if                                              
003796              if dc-elapsed-months > pi-max-ext                   
003797                 MOVE ER-0557    TO EMI-ERROR                     
003798                 PERFORM 1165-PAID-THRU-ERROR                     
003799                                 THRU 1165-EXIT                   
003800              else                                                
003801                 move 'Y'        to pi-max-ext-used               
003802                 move er-1670    to emi-error                     
003803                 perform 9900-error-format                        
003804                                 thru 9900-exit                   
003805              end-if                                              
003806           end-if                                                 
003807         ELSE                                                     
003808            MOVE ER-0557    TO EMI-ERROR                          
003809            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT           
003810         END-IF                                                   
003811        end-if                                                    
003812     end-if                                                       
003813                                                                  
003814     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND                  
003815         PI-PMTTYPE NOT = '3'                                     
003816         MOVE ER-0541        TO EMI-ERROR                         
003817         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.             
003818                                                                  
003819     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND                    
003820        (PI-PMTTYPE NOT = '3')                                    
003821         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT                       
003822             MOVE ER-0478        TO EMI-ERROR                     
003823             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.         
003824                                                                  
003825     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND                
003826        (PI-PMTTYPE NOT = '4')                                    
003827         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT                   
003828             MOVE ER-0479        TO EMI-ERROR                     
003829             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.         
003830                                                                  
003831     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND             
003832         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT                   
003833             MOVE ER-0545        TO EMI-ERROR                     
003834             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.         
003835                                                                  
003836     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES                      
003837         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT                   
003838             MOVE ER-0481        TO EMI-ERROR                     
003839             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.         
003840                                                                  
003841*    IF PI-COMPANY-ID = 'NCL'                                     
003842*        IF WS-SPECIAL-CALC-CD = 'C' AND                          
003843*           CM-AH-CRITICAL-PERIOD = +0                            
003844*            MOVE ER-0844        TO  EMI-ERROR                    
003845*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.         
003846                                                                  
003847*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR                        
003848     if (cl-critical-period = zeros)                              
003849        or (WS-SPECIAL-CALC-CD NOT = 'C')                         
003850          GO TO 1200-EDIT-FIND-TOLERANCES.                        
003851                                                                  
003852     MOVE PI-CPYFROM TO DC-BIN-DATE-1.                            
003853     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.                            
003854     MOVE '1'        TO DC-OPTION-CODE.                           
003855     MOVE +0         TO DC-ELAPSED-DAYS                           
003856                        DC-ELAPSED-MONTHS.                        
003857     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
003858                                                                  
003859*    IF NO-CONVERSION-ERROR                                       
003860*       COMPUTE ws-benefits-paid =                                
003861*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5         
003862*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD               
003863*           MOVE ER-0657 TO EMI-ERROR                             
003864*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.          
003865                                                                  
003866     GO TO 1200-EDIT-FIND-TOLERANCES.                             
003867                                                                  
003868 1165-PAID-THRU-ERROR.                                            
003869     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
003870                                                                  
003871     IF EMI-MESSAGE-FORMATTED                                     
003872         MOVE -1                 TO EPYTHRUL                      
003873         MOVE AL-UNBON           TO EPYTHRUA.                     
003874                                                                  
003875 1165-EXIT.                                                       
003876     EXIT.                                                        
003877                                                                  
003878 1166-CHECK-ALL-TRLRS.                                            
003879                                                                  
003880     IF PI-PMTTYPE = '4'                                          
003881       AND NOT HOLD-UNTIL-CHK                                     
003882       AND NOT CHECK-ALL-PMTS                                     
003883        GO TO 1166-TRLR-EXIT.                                     
003884                                                                  
003885     MOVE ' ' TO WS-BROWSE-TRLR-SW.                               
003886                                                                  
003887     IF HOLD-UNTIL-CHK                                            
003888        CONTINUE                                                  
003889     ELSE                                                         
003890     IF WS-SV-EPYTHRU = LOW-VALUES  AND                           
003891        WS-SV-EPYFROM = LOW-VALUES                                
003892          GO TO 1166-END-CHECK.                                   
003893                                                                  
003894     EXEC CICS HANDLE CONDITION                                   
003895         ENDFILE   (1166-END-CHECK)                               
003896         NOTFND    (1166-END-CHECK)                               
003897     END-EXEC.                                                    
003898                                                                  
003899     MOVE ELMSTR-KEY             TO ELTRLR-KEY.                   
003900     MOVE +100                   TO TRLR-SEQ-NO.                  
003901                                                                  
003902     EXEC CICS STARTBR                                            
003903          DATASET    ('ELTRLR')                                   
003904          RIDFLD     (ELTRLR-KEY)                                 
003905          GTEQ                                                    
003906     END-EXEC.                                                    
003907                                                                  
003908     MOVE 'Y' TO WS-BROWSE-TRLR-SW.                               
003909                                                                  
003910 1166-READ-TRLR-NEXT.                                             
003911                                                                  
003912     EXEC CICS READNEXT                                           
003913          DATASET    ('ELTRLR')                                   
003914          RIDFLD     (ELTRLR-KEY)                                 
003915          SET        (ADDRESS OF ACTIVITY-TRAILERS)               
003916     END-EXEC.                                                    
003917                                                                  
003918     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND                         
003919        TRLR-CARRIER  = MSTR-CARRIER  AND                         
003920        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND                         
003921        TRLR-CERT-NO  = MSTR-CERT-NO                              
003922          NEXT SENTENCE                                           
003923      ELSE                                                        
003924          GO TO 1166-END-CHECK.                                   
003925                                                                  
003926* **  BYPASS ALL NON-PAYMENT TRAILERS                             
003927                                                                  
003928     IF AT-TRAILER-TYPE = '2'                                     
003929        NEXT SENTENCE                                             
003930     ELSE                                                         
003931        GO TO 1166-READ-TRLR-NEXT.                                
003932                                                                  
003933* **  BYPASS ALL NON-PARTIAL PAYMENTS                             
003934                                                                  
003935     IF (HOLD-UNTIL-CHK                                           
003936       OR CHECK-ALL-PMTS)                                         
003937       AND AT-PAYMENT-TYPE <= '4'                                 
003938        NEXT SENTENCE                                             
003939     ELSE                                                         
003940     IF AT-PAYMENT-TYPE = '1' OR '2'                              
003941        NEXT SENTENCE                                             
003942     ELSE                                                         
003943        GO TO 1166-READ-TRLR-NEXT.                                
003944                                                                  
003945     IF ((AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR              
003946        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES))                 
003947        AND NOT HOLD-UNTIL-CHK                                    
003948          GO TO 1166-READ-TRLR-NEXT.                              
003949                                                                  
003950* **  BYPASS ALL VOID PAYMENTS                                    
003951                                                                  
003952     IF AT-VOID-DT NOT = LOW-VALUES                               
003953        IF WS-SV-EPYTHRU = AT-PAID-THRU-DT                        
003954          AND WS-SV-EPYFROM = AT-PAID-FROM-DT                     
003955            SET DUPE-VOID-PMT-EXISTS TO TRUE                      
003956        END-IF                                                    
003957        GO TO 1166-READ-TRLR-NEXT.                                
003958                                                                  
003959     IF HOLD-UNTIL-CHK                                            
003960        IF AT-PAID-THRU-DT > WS-HOLD-UNTIL-DT                     
003961          AND AT-TO-BE-WRITTEN-DT > ZERO                          
003962           MOVE AT-PAID-THRU-DT TO WS-HOLD-UNTIL-DT               
003963        END-IF                                                    
003964        IF AT-TO-BE-WRITTEN-DT > ZERO                             
003965          AND AT-CHECK-WRITTEN-DT = LOW-VALUES                    
003966           SET UNPAID-HOLD-UNTIL-EXISTS TO TRUE                   
003967           IF AT-TO-BE-WRITTEN-DT > WS-UNPD-HOLD-UNTIL-DT         
003968              MOVE AT-TO-BE-WRITTEN-DT TO WS-UNPD-HOLD-UNTIL-DT   
003969           END-IF                                                 
003970        END-IF                                                    
003971        IF AT-AMOUNT-PAID NUMERIC                                 
003972          AND (AT-CHECK-WRITTEN-DT > LOW-VALUES                   
003973             OR AT-TO-BE-WRITTEN-DT < ZERO)                       
003974          AND AT-PAYMENT-TYPE  <= '4'                             
003975           ADD AT-AMOUNT-PAID TO WS-TOT-AMOUNT-PAID               
003976        END-IF                                                    
003977     END-IF                                                       
003978                                                                  
003979     IF HOLD-UNTIL-CHK                                            
003980        CONTINUE                                                  
003981     ELSE                                                         
003982     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND                    
003983         (WS-SV-EPYFROM < AT-PAID-FROM-DT))                       
003984            OR                                                    
003985        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND                    
003986         (WS-SV-EPYFROM > AT-PAID-THRU-DT))                       
003987        NEXT SENTENCE                                             
003988     ELSE                                                         
003989         IF WS-SV-EPYTHRU = AT-PAID-THRU-DT                       
003990          AND WS-SV-EPYFROM = AT-PAID-FROM-DT                     
003991          AND (PI-OFFLINE NOT EQUAL 'Y')                          
003992          AND (CL-CLAIM-TYPE NOT = 'L' AND 'O')                   
003993            IF PI-PMTTYPE = '4'                                   
003994               MOVE 'Y' TO PI-DUPE-APPROVAL-NEEDED                
003995               MOVE ER-3280            TO EMI-ERROR               
003996               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           
003997               MOVE -1                 TO EPYTHRUL                
003998               MOVE AL-UNBON           TO EPYTHRUA                
003999            ELSE                                                  
004000               MOVE ER-3279            TO EMI-ERROR               
004001               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           
004002               MOVE -1                 TO EPYTHRUL                
004003               MOVE AL-UNBON           TO EPYTHRUA                
004004         ELSE                                                     
004005         IF CL-TOTAL-PAID-AMT > ZEROS                             
004006           AND NOT CHECK-ALL-PMTS                                 
004007             MOVE ER-0502            TO EMI-ERROR                 
004008             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             
004009             MOVE -1                 TO EPYTHRUL                  
004010             MOVE AL-UNBON           TO EPYTHRUA.                 
004011                                                                  
004012     GO TO 1166-READ-TRLR-NEXT.                                   
004013                                                                  
004014 1166-END-CHECK.                                                  
004015                                                                  
004016     IF WS-BROWSE-TRLR-SW = 'Y'                                   
004017        EXEC CICS ENDBR                                           
004018             DATASET   ('ELTRLR')                                 
004019        END-EXEC.                                                 
004020                                                                  
004021     MOVE 'Y' TO WS-BROWSE-TRLR-SW.                               
004022                                                                  
004023 1166-TRLR-EXIT.                                                  
004024     EXIT.                                                        
004025                                                                  
004026     EJECT                                                        
004027 1170-PAID-THRU-FATAL-ERROR.                                      
004028     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
004029                                                                  
004030     MOVE -1                     TO EPYTHRUL.                     
004031     MOVE AL-UNBON               TO EPYTHRUA.                     
004032                                                                  
004033 1200-EDIT-FIND-TOLERANCES.                                       
004034     EXEC CICS HANDLE CONDITION                                   
004035         ENDFILE(1950-NOT-FOUND)                                  
004036         NOTFND (1950-NOT-FOUND)                                  
004037     END-EXEC.                                                    
004038                                                                  
004039     IF PI-PROCESSOR-ID = 'LGXX'                                  
004040        GO TO 1240-FIND-ACCT-TOLERANCES.                          
004041                                                                  
004042     MOVE 'N'                    TO FOUND-TOL-SW.                 
004043     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
004044     MOVE '2'                    TO CNTL-REC-TYPE.                
004045     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.                  
004046     MOVE +0                     TO CNTL-SEQ-NO.                  
004047     MOVE 'PROC'                 TO FILE-SWITCH.                  
004048                                                                  
004049     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.                    
004050                                                                  
004051     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.                   
004052     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL                
004053                                    PI-MAX-PMT-TOL.               
004054     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.              
004055                                                                  
004056     IF PI-COMPANY-ID = 'HER' OR 'KSM'                            
004057         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.        
004058                                                                  
004059     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.                  
004060     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL             
004061                                    PI-MAX-LF-PMT-TOL.            
004062                                                                  
004063     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC                           
004064         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.          
004065                                                                  
004066     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT                
004067                                    PI-MAX-EXP-PMT.               
004068                                                                  
004069 1240-FIND-ACCT-TOLERANCES.                                       
004070                                                                  
004071     IF WS-PMT-TOL NOT = +0                                       
004072         MOVE 'Y'                TO FOUND-TOL-SW.                 
004073                                                                  
004074     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
004075         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD              
004076         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER              
004077         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING             
004078         MOVE CL-CURRENT-STATE       TO ACCT-STATE                
004079         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT              
004080         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT               
004081     ELSE                                                         
004082         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD              
004083         MOVE PI-CARRIER             TO ACCT-CARRIER              
004084         MOVE PI-GROUPING            TO ACCT-GROUPING             
004085         MOVE PI-STATE               TO ACCT-STATE                
004086         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT              
004087         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.              
004088                                                                  
004089     MOVE 'ACCT'                 TO FILE-SWITCH.                  
004090                                                                  
004091     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.           
004092     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.        
004093                                                                  
004094     EXEC CICS HANDLE CONDITION                                   
004095          NOTFND   (1950-NOT-FOUND)                               
004096          ENDFILE  (1950-NOT-FOUND)                               
004097     END-EXEC.                                                    
004098                                                                  
004099     move spaces to ws-eracct-startbr-ind                         
004100     EXEC CICS STARTBR                                            
004101         DATASET('ERACCT')                                        
004102         RIDFLD (ERACCT-KEY)                                      
004103         GTEQ                                                     
004104     END-EXEC.                                                    
004105                                                                  
004106     set eracct-browse-started to true                            
004107                                                                  
004108     .                                                            
004109 1245-FIND-ACCT-TOLERANCES-LOOP.                                  
004110                                                                  
004111     EXEC CICS READNEXT                                           
004112         DATASET('ERACCT')                                        
004113         SET    (ADDRESS OF ACCOUNT-MASTER)                       
004114         RIDFLD (ERACCT-KEY)                                      
004115     END-EXEC.                                                    
004116                                                                  
004117     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY               
004118        IF WS-ERACCT-HOLD-RECORD = SPACES                         
004119           GO TO 1950-NOT-FOUND                                   
004120        ELSE                                                      
004121           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER           
004122           GO TO 1250-CONTINUE.                                   
004123                                                                  
004124     IF ACCT-EXP-DT = HIGH-VALUES                                 
004125        NEXT SENTENCE                                             
004126     ELSE                                                         
004127        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD              
004128        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.                     
004129                                                                  
004130 1250-CONTINUE.                                                   
004131                                                                  
004132     if eracct-browse-started                                     
004133        exec cics endbr                                           
004134           dataset('ERACCT')                                      
004135        end-exec                                                  
004136        move spaces to ws-eracct-startbr-ind                      
004137     end-if                                                       
004138                                                                  
004139     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.                  
004140                                                                  
004141     IF FOUND-TOL-SW = 'N'                                        
004142         MOVE AM-TOL-CLM         TO WS-PMT-TOL.                   
004143                                                                  
004144********* 1260-FIND-STATE-TOLERANCES.                             
004145                                                                  
004146     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
004147     MOVE PI-STATE               TO WS-ST-ACCESS.                 
004148     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.                  
004149     MOVE '3'                    TO CNTL-REC-TYPE.                
004150     MOVE +0                     TO CNTL-SEQ-NO.                  
004151     MOVE 'STAT'                 TO FILE-SWITCH.                  
004152                                                                  
004153     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.                    
004154                                                                  
004155     IF WS-PMT-TOL = +0                                           
004156         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.                   
004157                                                                  
004158     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.              
004159     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.              
004160     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.              
004161     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.                 
004162     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.              
004163                                                                  
004164****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND 
004165****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED  
004166     IF PI-PAYEE-TYPE <> 'B'                                      
004167           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT         
004168     END-IF.                                                      
004169                                                                  
004170     IF PI-PMTTYPE      = '2'  AND                                
004171        PI-SPLIT-PMT-SW = 'Y'  AND                                
004172        (CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1 OR 'O')            
004173          MOVE ER-3530                TO EMI-ERROR                
004174          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               
004175                                                                  
004176********* 1280-FIND-BENEFIT-TOLERANCES.                           
004177                                                                  
004178     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'   
004179         OR 'B' OR 'H')                                           
004180        OR (PI-PMTTYPE = '5' OR '6')                              
004181         GO TO 1300-FIND-CARR-TOLERANCES.                         
004182                                                                  
004183     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
004184     MOVE '4'                    TO CNTL-REC-TYPE.                
004185     MOVE +0                     TO CNTL-SEQ-NO.                  
004186     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.                    
004187     MOVE WS-ACCESS              TO CNTL-ACCESS.                  
004188     MOVE 'BENE'                 TO FILE-SWITCH.                  
004189                                                                  
004190     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    
004191                                                                  
004192     IF NO-BENEFIT-FOUND                                          
004193         GO TO 1950-NOT-FOUND.                                    
004194                                                                  
004195     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.   
004196     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.  
004197     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE. 
004198                                                                  
004199     EXEC CICS HANDLE CONDITION                                   
004200         NOTFND(1950-NOT-FOUND)                                   
004201     END-EXEC.                                                    
004202                                                                  
004203 1300-FIND-CARR-TOLERANCES.                                       
004204     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
004205     MOVE '6'                    TO CNTL-REC-TYPE.                
004206                                                                  
004207     IF CONTROL-IS-ACTUAL-CARRIER                                 
004208         MOVE PI-CARRIER               TO WS-CARR                 
004209     ELSE                                                         
004210         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.                
004211                                                                  
004212     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  
004213     MOVE +0                     TO CNTL-SEQ-NO.                  
004214     MOVE 'CARR'                 TO FILE-SWITCH.                  
004215                                                                  
004216     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.                  
004217                                                                  
004218     IF WS-DAYS-TOL = +0                                          
004219         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.                  
004220                                                                  
004221     IF WS-PMT-TOL = +0                                           
004222         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.                   
004223                                                                  
004224     IF WS-MAX-DAYS-TOL = +0                                      
004225         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.              
004226                                                                  
004227     IF WS-MAX-PMT-TOL = +0                                       
004228         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL                
004229                                    PI-MAX-PMT-TOL.               
004230                                                                  
004231     IF WS-MAX-LF-PMT-TOL = +0                                    
004232        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL             
004233                                    PI-MAX-LF-PMT-TOL.            
004234                                                                  
004235     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.               
004236                                                                  
004237********* 1320-FIND-COMP-TOLERANCES.                              
004238                                                                  
004239     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
004240     MOVE '1'                    TO CNTL-REC-TYPE.                
004241     MOVE SPACES                 TO CNTL-ACCESS.                  
004242     MOVE +0                     TO CNTL-SEQ-NO.                  
004243     MOVE 'COMP'                 TO FILE-SWITCH.                  
004244                                                                  
004245     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.                    
004246                                                                  
004247     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.            
004248     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.               
004249                                                                  
004250     IF WS-PMT-TOL NOT = +0                                       
004251        IF WS-TOL-SEVERITY NOT = ' '                              
004252         GO TO 1360-EDIT-DAYS.                                    
004253                                                                  
004254     IF WS-PMT-TOL = +0                                           
004255         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.                   
004256                                                                  
004257     IF WS-TOL-SEVERITY = ' '                                     
004258         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.           
004259                                                                  
004260 1360-EDIT-DAYS.                                                  
004261     IF PI-PMTTYPE NOT = '4'                                      
004262        IF PI-EDAYS NEGATIVE OR                                   
004263           PI-EPYAMT NEGATIVE                                     
004264          MOVE ER-0513             TO EMI-ERROR                   
004265          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                
004266          MOVE -1                  TO PMTTYPEL.                   
004267                                                                  
004268     IF PI-PMTTYPE = '5' OR '6'                                   
004269        GO TO 1380-EDIT-EXPENSE-PMT-AMT.                          
004270                                                                  
004271     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
004272        IF PI-PMTTYPE = '4'                                       
004273          MOVE PI-EDAYS          TO PI-CDAYS.                     
004274                                                                  
004275     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'                
004276         GO TO 1440-COMPUTE-LIFE-REMAINING.                       
004277                                                                  
004278     IF PI-PMTTYPE = '4'                                          
004279        MOVE PI-EDAYS            TO PI-CDAYS                      
004280        GO TO 1400-EDIT-PAYMENT.                                  
004281                                                                  
004282     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU                     
004283        GO TO 1500-EDIT-EXPENSES.                                 
004284                                                                  
004285*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
004286*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND               
004287*          CM-AH-BENEFIT-CD = '23'              AND               
004288*          CL-CERT-STATE    = '04'              AND               
004289*         (PI-PMTTYPE = '1' OR '2' OR '3')                        
004290*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT            
004291*            GO TO 1362-CHECK-MAX-DAYS.                           
004292                                                                  
004293     IF PI-EDAYS = ZEROS                                          
004294*        IF PI-COMPANY-ID = 'DMD'                                 
004295*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1                 
004296*            MOVE -1             TO DC-ELAPSED-DAYS               
004297*            MOVE ZEROS          TO DC-ELAPSED-MONTHS             
004298*            MOVE '6'            TO DC-OPTION-CODE                
004299*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT        
004300*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1                 
004301*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2                 
004302*            MOVE '1'            TO DC-OPTION-CODE                
004303*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT        
004304*            IF NO-CONVERSION-ERROR                               
004305*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30        
004306*                                 + DC-ODD-DAYS-OVER              
004307*               MOVE 6           TO EDAYSL                        
004308*               MOVE AL-UNNON    TO EDAYSA                        
004309*            ELSE                                                 
004310*                NEXT SENTENCE                                    
004311*       ELSE                                                      
004312            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1                 
004313            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2                 
004314            MOVE '1'             TO DC-OPTION-CODE                
004315            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT         
004316            IF NO-CONVERSION-ERROR                                
004317                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS                 
004318                ADD 1                 TO PI-EDAYS                 
004319                MOVE AL-UNNON         TO EDAYSA.                  
004320                                                                  
004321*    IF PI-COMPANY-ID = 'DMD'                                     
004322*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1                 
004323*        MOVE -1                 TO DC-ELAPSED-DAYS               
004324*        MOVE ZEROS              TO DC-ELAPSED-MONTHS             
004325*        MOVE '6'                TO DC-OPTION-CODE                
004326*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT            
004327*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1                 
004328*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2                 
004329*        MOVE '1'                TO DC-OPTION-CODE                
004330*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT            
004331*    ELSE                                                         
004332         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.                
004333         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.                
004334         MOVE '1'                TO DC-OPTION-CODE.               
004335         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.           
004336                                                                  
004337     IF NO-CONVERSION-ERROR                                       
004338        IF PI-COMPANY-ID = 'DMD'                                  
004339            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30             
004340                             + DC-ODD-DAYS-OVER                   
004341        ELSE                                                      
004342            MOVE DC-ELAPSED-DAYS TO PI-CDAYS                      
004343            ADD 1                TO PI-CDAYS.                     
004344                                                                  
004345     IF DC-ODD-DAYS-OVER NOT = ZEROS                              
004346        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE            
004347        ADD 1                    TO EXPENSE-MONTH-SAVE.           
004348                                                                  
004349     IF PI-EDAYS NOT NUMERIC                                      
004350         MOVE ER-0491            TO EMI-ERROR                     
004351         GO TO 1370-DAYS-ERROR.                                   
004352                                                                  
004353     IF CL-NO-OF-PMTS-MADE = 0                                    
004354        AND (PI-COMPANY-ID = 'CID' OR 'AHL')                      
004355        AND CL-CERT-STATE = 'MI'                                  
004356        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')     
004357            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT        
004358     END-IF.                                                      
004359                                                                  
004360 1362-CHECK-MAX-DAYS.                                             
004361                                                                  
004362     IF WS-MAX-DAYS-TOL = +999                                    
004363         GO TO 1365-SKIP-MAX-DAYS-EDIT.                           
004364                                                                  
004365     IF PI-COMPANY-ID = 'HER' OR 'KSM'                            
004366         IF PI-EDAYS = ZEROS                                      
004367             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005 
004368         ELSE                                                     
004369             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
004370                                                                  
004371     IF WS-MAX-DAYS-TOL NOT = ZERO                                
004372        IF PI-EDAYS > WS-MAX-DAYS-TOL OR                          
004373           PI-CDAYS > WS-MAX-DAYS-TOL                             
004374             MOVE ER-0492          TO EMI-ERROR                   
004375             GO TO 1370-DAYS-ERROR.                               
004376                                                                  
004377 1365-SKIP-MAX-DAYS-EDIT.                                         
004378     IF PI-EDAYS = ZEROS                                          
004379        GO TO 1400-EDIT-PAYMENT.                                  
004380                                                                  
004381     IF WS-DAYS-TOL NOT = ZERO                                    
004382        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR               
004383           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)                  
004384                MOVE ER-0493     TO EMI-ERROR                     
004385                GO TO 1370-DAYS-ERROR.                            
004386                                                                  
004387     GO TO 1400-EDIT-PAYMENT.                                     
004388                                                                  
004389 1370-DAYS-ERROR.                                                 
004390     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
004391                                                                  
004392     IF EMI-MESSAGE-FORMATTED                                     
004393         MOVE -1                 TO EDAYSL                        
004394         MOVE AL-UABON           TO EDAYSA.                       
004395                                                                  
004396     GO TO 1400-EDIT-PAYMENT.                                     
004397                                                                  
004398 1380-EDIT-EXPENSE-PMT-AMT.                                       
004399     IF PI-PMTTYPE = '5' OR '6'                                   
004400         NEXT SENTENCE                                            
004401     ELSE                                                         
004402         GO TO 1400-EDIT-PAYMENT.                                 
004403                                                                  
004404     IF WS-MAX-EXP-PMT NOT = ZEROS                                
004405        IF PI-EPYAMT > WS-MAX-EXP-PMT                             
004406            MOVE ER-3529            TO EMI-ERROR                  
004407            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.            
004408                                                                  
004409     GO TO 1500-EDIT-EXPENSES.                                    
004410                                                                  
004411     EJECT                                                        
004412                                                                  
004413 1390-CHECK-PAYMENT-DAYS.                                         
004414                                                                  
004415     IF PI-EDAYS = 0                                              
004416         MOVE PI-CDAYS TO WS-PD-DAYS                              
004417     ELSE                                                         
004418         MOVE PI-EDAYS TO WS-PD-DAYS                              
004419     END-IF.                                                      
004420                                                                  
004421     IF CM-AH-BENEFIT-CD = '20' OR '21'                           
004422         IF WS-PD-DAYS = 14                                       
004423            GO TO 1390-EXIT                                       
004424         END-IF                                                   
004425     END-IF.                                                      
004426                                                                  
004427     IF PI-COMPANY-ID = 'AHL'  AND                                
004428        CM-AH-BENEFIT-CD = '1K'                                   
004429         IF WS-PD-DAYS = 14                                       
004430            GO TO 1390-EXIT                                       
004431         END-IF                                                   
004432     END-IF.                                                      
004433                                                                  
004434     IF WS-PD-DAYS < 30                                           
004435         MOVE ER-3549              TO EMI-ERROR                   
004436         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT                
004437     END-IF.                                                      
004438                                                                  
004439 1390-EXIT.                                                       
004440      EXIT.                                                       
004441                                                                  
004442 1400-EDIT-PAYMENT.                                               
004443*    IF PI-COMPANY-ID = 'DMD'                                     
004444*       IF CL-CERT-NO (5:2) = '69' OR '70'                        
004445*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.              
004446                                                                  
004447     IF PI-COMPANY-ID = 'DCC' or 'VPP'                            
004448        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD                  
004449        MOVE PI-CARRIER          TO ACCT-CARRIER                  
004450        MOVE PI-GROUPING         TO ACCT-GROUPING                 
004451        MOVE PI-STATE            TO ACCT-STATE                    
004452        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT                  
004453        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT                   
004454        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY            
004455        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD         
004456                                                                  
004457        EXEC CICS READ                                            
004458           DATASET ('ERACCT')                                     
004459           RIDFLD  (ERACCT-KEY)                                   
004460           SET     (ADDRESS OF ACCOUNT-MASTER)                    
004461           GTEQ                                                   
004462           resp    (WS-RESPONSE)                                  
004463        END-EXEC                                                  
004464        IF WS-RESP-NORMAL                                         
004465           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)     
004466           and pi-cert-eff-dt < am-expiration-dt                  
004467           and pi-cert-eff-dt >= am-effective-dt                  
004468           move am-dcc-product-code to pi-dcc-product-code        
004469        else                                                      
004470           move spaces           to pi-dcc-product-code           
004471        end-if                                                    
004472        if PI-DCC-PRODUCT-CODE NOT = SPACES                       
004473           PERFORM 0900-GET-DDF-LIMITS                            
004474                                 THRU 0900-EXIT                   
004475           IF PDEF-FOUND                                          
004476              PERFORM VARYING P1 FROM +1 BY +1 UNTIL              
004477                 (P1 > 11)                                        
004478                 OR ((PD-PROD-CODE (P1) = CL-CLAIM-TYPE)          
004479                   AND (PD-MAX-ATT-AGE (P1) >= WS-ATT-AGE))       
004480              END-PERFORM                                         
004481              IF P1 < +12                                         
004482                 if pd-ben-pct (p1) not numeric                   
004483                    move zeros   to pd-ben-pct (p1)               
004484                 end-if                                           
004485                 if pd-ben-pct (p1) = zeros                       
004486                    move +1      to ws-work-ben-pct               
004487                 else                                             
004488                    move pd-ben-pct (p1)                          
004489                                 to ws-work-ben-pct               
004490                 end-if                                           
004491                 compute cm-ah-benefit-amt =                      
004492                    cm-ah-benefit-amt * ws-work-ben-pct           
004493                 if cm-ah-benefit-amt > pd-max-amt (p1)           
004494                    move pd-max-amt (p1) to cm-ah-benefit-amt     
004495                 end-if                                           
004496              else                                                
004497                 move er-1674    to emi-error                     
004498                 PERFORM 9900-ERROR-FORMAT                        
004499                                 THRU 9900-EXIT                   
004500              END-IF                                              
004501           else                                                   
004502              move er-1672       to emi-error                     
004503              PERFORM 9900-ERROR-FORMAT                           
004504                                 THRU 9900-EXIT                   
004505           END-IF                                                 
004506        end-if                                                    
004507     END-IF                                                       
004508                                                                  
004509     IF PI-PMTTYPE NOT = '4'                                      
004510        GO TO 1405-CALC-PAYMENT.                                  
004511                                                                  
004512     IF PI-EDAYS NOT NUMERIC                                      
004513         MOVE PI-EPYAMT           TO PI-CPYAMT                    
004514         MOVE SPACES              TO PI-SPECIAL-BEN-SW            
004515         GO TO 1430-CHECK-AH-TOLERANCE.                           
004516                                                                  
004517*    IF PI-COMPANY-ID = 'FIA'                                     
004518*       IF CERT-ACCOUNT = '0000011043'                            
004519*        COMPUTE PI-DAILY-RATE ROUNDED =                          
004520*                      (CM-AH-BENEFIT-AMT * 13) / 365             
004521*        COMPUTE PI-CPYAMT ROUNDED =                              
004522*                          PI-DAILY-RATE * PI-EDAYS               
004523*        MOVE SPACES TO PI-SPECIAL-BEN-SW                         
004524*        GO TO 1430-CHECK-AH-TOLERANCE.                           
004525                                                                  
004526     IF WS-CALC-METHOD = '1' OR '4' OR '6'                        
004527         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30   
004528         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS 
004529         GO TO 1420-CHECK-AIG-BENEFIT.                            
004530                                                                  
004531     IF WS-CALC-METHOD = '2' OR  '5'                              
004532         COMPUTE PI-DAILY-RATE ROUNDED =                          
004533                        (CM-AH-BENEFIT-AMT * 12) / 365            
004534         COMPUTE PI-CPYAMT ROUNDED =                              
004535                           PI-DAILY-RATE * PI-EDAYS               
004536        GO TO 1420-CHECK-AIG-BENEFIT.                             
004537                                                                  
004538     IF WS-CALC-METHOD = '3'                                      
004539         COMPUTE PI-DAILY-RATE =                                  
004540                         (CM-AH-BENEFIT-AMT * 12) / 365           
004541         COMPUTE PI-CPYAMT ROUNDED =                              
004542                           PI-DAILY-RATE * PI-EDAYS               
004543        GO TO 1420-CHECK-AIG-BENEFIT.                             
004544     EJECT                                                        
004545*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6          
004546                                                                  
004547****************************************************************  
004548****************************************************************  
004549*                  CALCULATED FROM      PAYMENT      PAYMENT      
004550*   DATES           DATE ROUTINE        OPT  1       OPT  6       
004551* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID     
004552*1-01-83  1-15-83    0    15     15        15           15        
004553*1-01-83  1-30-83    0    30     30        30           30        
004554*1-01-83  1-31-83    1     0     31        30           30        
004555*1-01-83  2-01-83    1     1     32        31           31        
004556*1-01-83  2-15-83    1    15     46        45           45        
004557*1-01-83  2-28-83    2     0     59        60           60        
004558*1-01-83  3-01-83    2     1     60        61           61        
004559*1-01-83  3-31-83    3     0     90        90           90        
004560*1-15-83  1-31-83    0    17     17        17           16        
004561*1-15-83  2-01-83    0    18     18        18           17        
004562*1-15-83  2-28-83    1    14     45        44           46        
004563*1-21-83  3-09-83    1    20     48        50           49        
004564*2-05-83  3-06-83    1     2     30        32           32        
004565*2-05-83  3-23-83    1    19     47        49           49        
004566*2-15-83  2-28-83    0    14     14        14           16        
004567*2-15-83  3-01-83    0    15     15        15           17        
004568*2-21-83  3-19-83    0    27     27        27           29        
004569*2-21-83  3-20-83    1     0     28        30           30        
004570*2-21-83  4-10-83    1    18     49        30           50        
004571*2-21-83  5-19-83    2    27     88        87           89        
004572*2-21-83  5-22-83    3     2     91        92           92        
004573*3-21-83  5-19-83    1    30     60        60           59        
004574****************************************************************  
004575     EJECT                                                        
004576 1405-CALC-PAYMENT.                                               
004577     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.                
004578     MOVE ' '                    TO DC-OPTION-CODE.               
004579     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
004580     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.           
004581     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.               
004582                                                                  
004583     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.                
004584     MOVE ' '                    TO DC-OPTION-CODE.               
004585     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
004586     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.               
004587     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.           
004588                                                                  
004589     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.                
004590     MOVE -1                     TO DC-ELAPSED-DAYS.              
004591     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.            
004592     MOVE '6'                    TO DC-OPTION-CODE.               
004593     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
004594     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.     
004595                                                                  
004596     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.                
004597     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.                
004598     MOVE '1'                    TO DC-OPTION-CODE.               
004599     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
004600                                                                  
004601     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.          
004602     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.           
004603     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.            
004604                                                                  
004605******************************************************************
004606*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
004607*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
004608*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
004609******************************************************************
004610                                                                  
004611     IF WS-CALC-METHOD = '1'           AND                        
004612        DC-ELAPSED-MONTHS > ZERO AND                              
004613        DC-ODD-DAYS-OVER NOT = ZEROS   AND                        
004614        WDF-DAY > WDT-DAY                                         
004615          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1               
004616          MOVE ZEROS               TO DC-ELAPSED-DAYS             
004617          MOVE -1                  TO DC-ELAPSED-MONTHS           
004618          MOVE '6'                 TO DC-OPTION-CODE              
004619          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT           
004620          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH    
004621          COMPUTE WS-SAVE-ODD-DAYS =                              
004622          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)   
004623          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.         
004624                                                                  
004625     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.            
004626     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER              
004627     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.              
004628                                                                  
004629     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.          
004630     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.           
004631                                                                  
004632*    IF PI-COMPANY-ID = 'FIA'                                     
004633*       IF CERT-ACCOUNT = '0000011043'                            
004634*        COMPUTE PI-DAILY-RATE ROUNDED =                          
004635*                          (CM-AH-BENEFIT-AMT * 13) / 365         
004636*        COMPUTE PI-CPYAMT ROUNDED =                              
004637*                          PI-DAILY-RATE * DC-ELAPSED-DAYS        
004638*        GO TO 1420-CHECK-AIG-BENEFIT.                            
004639                                                                  
004640*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
004641*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND              
004642*          CM-AH-BENEFIT-CD = '23'               AND              
004643*          CL-CERT-STATE    = '04'               AND              
004644*         (PI-PMTTYPE = '1' OR '2' OR '3')                        
004645*            COMPUTE WS-DAILY-RATE ROUNDED =                      
004646*                               CM-AH-BENEFIT-AMT / 30            
004647*            COMPUTE PI-CPYAMT ROUNDED =                          
004648*                               (WS-DAILY-RATE * PI-CDAYS)        
004649*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE                  
004650*            GO TO 1420-CHECK-AIG-BENEFIT.                        
004651                                                                  
004652     IF WS-CALC-METHOD = '1'                                      
004653         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30   
004654         COMPUTE PI-CPYAMT ROUNDED =                              
004655             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +            
004656             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)               
004657         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE                   
004658         GO TO 1420-CHECK-AIG-BENEFIT.                            
004659                                                                  
004660     IF WS-CALC-METHOD = '2'                                      
004661         COMPUTE PI-DAILY-RATE ROUNDED =                          
004662                          (CM-AH-BENEFIT-AMT * 12) / 365          
004663         COMPUTE PI-CPYAMT ROUNDED =                              
004664             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +            
004665             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)               
004666         GO TO 1420-CHECK-AIG-BENEFIT.                            
004667                                                                  
004668     IF WS-CALC-METHOD = '4'                                      
004669         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT               
004670         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)     
004671         MOVE WS-DAILY-RATE TO PI-DAILY-RATE                      
004672         COMPUTE PI-CPYAMT ROUNDED =                              
004673                           WS-DAILY-RATE * DC-ELAPSED-DAYS        
004674         GO TO 1420-CHECK-AIG-BENEFIT.                            
004675                                                                  
004676     IF WS-CALC-METHOD = '5'                                      
004677         COMPUTE PI-DAILY-RATE ROUNDED =                          
004678                            (CM-AH-BENEFIT-AMT * 12) / 365        
004679         COMPUTE PI-CPYAMT ROUNDED =                              
004680                           PI-DAILY-RATE * DC-ELAPSED-DAYS        
004681         GO TO 1420-CHECK-AIG-BENEFIT.                            
004682                                                                  
004683     IF WS-CALC-METHOD NOT = '3'                                  
004684        GO TO 1410-CHECK-PAYMENT.                                 
004685                                                                  
004686******   CALCULATION METHOD  3  ROUTINE                           
004687     COMPUTE PI-DAILY-RATE =                                      
004688                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.          
004689                                                                  
004690******CHECK TO SEE IF WITHIN SAME MONTH                           
004691     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)         
004692        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *        
004693                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)     
004694         GO TO 1420-CHECK-AIG-BENEFIT.                            
004695                                                                  
004696******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS                 
004697     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND                     
004698             SAVE-ODD-DAYS-OVER = ZEROS                           
004699      COMPUTE PI-CPYAMT  ROUNDED =                                
004700                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS         
004701      GO TO 1420-CHECK-AIG-BENEFIT.                               
004702                                                                  
004703******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS                
004704******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.             
004705     IF SAVE-ELAPSED-MONTHS NOT = ZERO                            
004706        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH                     
004707        IF WDF-MONTH > 12                                         
004708           ADD 1                 TO WDF-YEAR                      
004709           SUBTRACT 12         FROM WDF-MONTH.                    
004710                                                                  
004711******CONVERT THE NEW FROM MONTH TO BINARY                        
004712     IF SAVE-ELAPSED-MONTHS NOT = ZERO                            
004713        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY               
004714        MOVE '4'              TO DC-OPTION-CODE                   
004715        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT             
004716        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.              
004717                                                                  
004718     IF WDF-MONTH = WDT-MONTH AND                                 
004719        WDF-YEAR  = WDT-YEAR                                      
004720          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *   
004721                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +   
004722                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)     
004723        ELSE                                                      
004724          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY    
004725          MOVE WDT-DAY              TO THRU-PMT-DAYS              
004726          COMPUTE PI-CPYAMT ROUNDED =                             
004727       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) 
004728       +                                                          
004729       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH)) 
004730       +                                                          
004731       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).                 
004732                                                                  
004733     GO TO 1420-CHECK-AIG-BENEFIT.                                
004734     EJECT                                                        
004735 1410-CHECK-PAYMENT.                                              
004736******PAYMENT OPTION 6                                            
004737******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH     
004738     IF SAVE-ELAPSED-MONTHS > ZERO                                
004739        IF SAVE-ODD-DAYS-OVER = ZEROS                             
004740           GO TO 1412-CHECK-TO-DAY                                
004741        ELSE                                                      
004742           IF WDF-DAY > WDT-DAY                                   
004743              IF WDF-MONTH = 02                                   
004744                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT     
004745                  ADD 2  TO  SAVE-ODD-DAYS-OVER                   
004746                  GO TO 1412-CHECK-TO-DAY                         
004747              ELSE                                                
004748                  IF FROM-DAYS-IN-MONTH = 31                      
004749                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER           
004750                     GO TO 1412-CHECK-TO-DAY                      
004751                  ELSE                                            
004752                     GO TO 1412-CHECK-TO-DAY                      
004753           ELSE                                                   
004754               GO TO 1412-CHECK-TO-DAY.                           
004755                                                                  
004756     IF WDF-MONTH NOT = WDT-MONTH                                 
004757        IF WDF-MONTH = 02                                         
004758           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT            
004759           IF WDF-DAY = 29                                        
004760              ADD 1              TO SAVE-ODD-DAYS-OVER            
004761           ELSE                                                   
004762              ADD 2              TO SAVE-ODD-DAYS-OVER            
004763        ELSE                                                      
004764           IF FROM-DAYS-IN-MONTH = 31                             
004765              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.         
004766                                                                  
004767 1412-CHECK-TO-DAY.                                               
004768        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0          
004769           IF WDT-DAY = 28                                        
004770              ADD 2              TO SAVE-ODD-DAYS-OVER            
004771           ELSE                                                   
004772              IF WDT-DAY = 29                                     
004773                 ADD 1           TO SAVE-ODD-DAYS-OVER            
004774              ELSE                                                
004775                 NEXT SENTENCE                                    
004776        ELSE                                                      
004777           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0         
004778              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.         
004779                                                                  
004780     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.      
004781     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.                
004782     COMPUTE PI-CPYAMT ROUNDED =                                  
004783         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +              
004784         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).                
004785                                                                  
004786     GO TO 1420-CHECK-AIG-BENEFIT.                                
004787                                                                  
004788 1415-CHECK-LEAP-YEAR.                                            
004789     IF FROM-DAYS-IN-MONTH = 29                                   
004790        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.                       
004791                                                                  
004792 1415-EXIT.                                                       
004793     EXIT.                                                        
004794                                                                  
004795     EJECT                                                        
004796 1420-CHECK-AIG-BENEFIT.                                          
004797                                                                  
004798     IF WS-SPECIAL-CALC-CD = 'Q'                                  
004799         GO TO 1425-CHECK-WHOLE-MONTH.                            
004800                                                                  
004801*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND                    
004802*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND                    
004803*       (CL-NO-OF-PMTS-MADE < +6)          AND                    
004804*       (PI-PMTTYPE = '1' OR '2')                                 
004805*        NEXT SENTENCE                                            
004806*    ELSE                                                         
004807         MOVE SPACES TO PI-SPECIAL-BEN-SW.                        
004808         GO TO 1430-CHECK-AH-TOLERANCE.                           
004809                                                                  
004810******************AIG LOGIC STARTS**********************          
004811*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.                      
004812*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.                         
004813*    MOVE ER-3533      TO EMI-ERROR.                              
004814*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.                   
004815*    GO TO 1430-CHECK-AH-TOLERANCE.                               
004816******************AIG LOGIC ENDS************************          
004817                                                                  
004818 1425-CHECK-WHOLE-MONTH.                                          
004819******************************************************************
004820****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
004821****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
004822****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
004823****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
004824****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
004825****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
004826****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
004827****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
004828****          PAID * MONTHLY BENEFIT.                         ****
004829******************************************************************
004830                                                                  
004831     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.       
004832                                                                  
004833     IF CL-NO-OF-PMTS-MADE > +0                                   
004834         GO TO 1425-CONT-WHOLE-MONTH-PMTS.                        
004835                                                                  
004836     IF PI-CDAYS < WS-BEN-DAYS                                    
004837         GO TO 1430-CHECK-AH-TOLERANCE.                           
004838                                                                  
004839     IF PI-CDAYS = WS-BEN-DAYS                                    
004840         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT                
004841         GO TO 1430-CHECK-AH-TOLERANCE.                           
004842                                                                  
004843*    IF PI-COMPANY-ID = 'ACM'                                     
004844*       NEXT SENTENCE                                             
004845*    ELSE                                                         
004846        GO TO 1425-NOT-ACM-W15C.                                  
004847                                                                  
004848*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.               
004849*    MOVE -1                     TO  DC-ELAPSED-DAYS.             
004850*    MOVE +0                     TO  DC-ELAPSED-MONTHS.           
004851*    MOVE '6'                    TO  DC-OPTION-CODE.              
004852*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
004853*    IF NO-CONVERSION-ERROR                                       
004854*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1                
004855*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2                
004856*       MOVE '1'                 TO  DC-OPTION-CODE               
004857*       MOVE +0                  TO  DC-ELAPSED-DAYS              
004858*       MOVE +0                  TO  DC-ELAPSED-MONTHS            
004859*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT             
004860*       IF NO-CONVERSION-ERROR                                    
004861*          IF (DC-ELAPSED-MONTHS > +0) OR                         
004862*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)                 
004863*             NEXT SENTENCE                                       
004864*          ELSE                                                   
004865*             MOVE +0            TO  PI-CPYAMT                    
004866*             MOVE ER-0846       TO  EMI-ERROR                    
004867*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT           
004868*             GO TO 1430-CHECK-AH-TOLERANCE                       
004869*       ELSE                                                      
004870*           MOVE ER-0846         TO  EMI-ERROR                    
004871*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT             
004872*           GO TO 1430-CHECK-AH-TOLERANCE.                        
004873*                                                                 
004874*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS                        
004875*       ADD +1 TO DC-ELAPSED-MONTHS.                              
004876*                                                                 
004877*    COMPUTE PI-CPYAMT ROUNDED =                                  
004878*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.           
004879*                                                                 
004880*    GO TO 1430-CHECK-AH-TOLERANCE.                               
004881                                                                  
004882 1425-NOT-ACM-W15C.                                               
004883                                                                  
004884     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.           
004885     MOVE '6'                        TO  DC-OPTION-CODE.          
004886     MOVE +0                         TO  DC-ELAPSED-MONTHS.       
004887     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.                   
004888                                                                  
004889     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
004890     IF NO-CONVERSION-ERROR                                       
004891         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1            
004892     ELSE                                                         
004893         MOVE ER-0846                TO  EMI-ERROR                
004894         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT                
004895         GO TO 1430-CHECK-AH-TOLERANCE.                           
004896                                                                  
004897     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.           
004898     MOVE '1'                        TO  DC-OPTION-CODE.          
004899     MOVE +0                         TO  DC-ELAPSED-MONTHS.       
004900     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
004901     IF NO-CONVERSION-ERROR                                       
004902         IF DC-ODD-DAYS-OVER = +0                                 
004903             NEXT SENTENCE                                        
004904         ELSE                                                     
004905             MOVE ER-0846            TO  EMI-ERROR                
004906             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT            
004907             GO TO 1430-CHECK-AH-TOLERANCE                        
004908     ELSE                                                         
004909         MOVE ER-0846                TO  EMI-ERROR                
004910         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT                
004911         GO TO 1430-CHECK-AH-TOLERANCE.                           
004912                                                                  
004913     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +              
004914         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).                 
004915                                                                  
004916     GO TO 1430-CHECK-AH-TOLERANCE.                               
004917                                                                  
004918 1425-CONT-WHOLE-MONTH-PMTS.                                      
004919******************************************************************
004920****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
004921****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
004922****    BE IN CALENDAR MONTH INCREMENTS.                      ****
004923******************************************************************
004924                                                                  
004925     IF PI-COMPANY-ID = 'ACM'                                     
004926        NEXT SENTENCE                                             
004927     ELSE                                                         
004928        IF DC-ODD-DAYS-OVER = +0                                  
004929            NEXT SENTENCE                                         
004930        ELSE                                                      
004931            MOVE ER-0845            TO  EMI-ERROR                 
004932            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT             
004933            GO TO 1430-CHECK-AH-TOLERANCE.                        
004934                                                                  
004935     COMPUTE PI-CPYAMT ROUNDED =                                  
004936                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.            
004937                                                                  
004938 1430-CHECK-AH-TOLERANCE.                                         
004939     IF PI-PMT-APPR-SW = 'G'                                      
004940         GO TO 1430-CONT-CHECK-AH-TOLERANCE.                      
004941                                                                  
004942*    IF PI-COMPANY-ID = 'HER' OR 'KSM'                            
004943*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS     
004944*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.          
004945*                                                                 
004946*    IF PI-COMPANY-ID = 'HER' OR 'KSM'                            
004947*      IF WDF-MONTH = 02                                          
004948*        IF SAVE-ELAPSED-MONTHS = 0                               
004949*          NEXT SENTENCE                                          
004950*        ELSE                                                     
004951*          IF SAVE-ODD-DAYS-OVER > 0                              
004952*            MOVE +0                     TO  WS-MAX-PMT-TOL       
004953*            COMPUTE WS-PMT-MOS ROUNDED =                         
004954*                (SAVE-ODD-DAYS-OVER / +30) + .005                
004955*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *         
004956*                                     WS-PMT-MOS                  
004957*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +            
004958*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)        
004959*          ELSE                                                   
004960*            MOVE +0                     TO  WS-MAX-PMT-TOL       
004961*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS           
004962*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *         
004963*                                     WS-PMT-MOS.                 
004964                                                                  
004965     IF WS-MAX-PMT-TOL NOT = ZERO                                 
004966        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR                        
004967           (PI-CPYAMT > WS-MAX-PMT-TOL)                           
004968            MOVE ER-0494         TO  EMI-ERROR                    
004969            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT             
004970            GO TO 1500-EDIT-EXPENSES.                             
004971                                                                  
004972 1430-CONT-CHECK-AH-TOLERANCE.                                    
004973                                                                  
004974     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE                 
004975        GO TO 1500-EDIT-EXPENSES.                                 
004976                                                                  
004977     IF CM-O-B-COVERAGE                                           
004978        GO TO 1500-EDIT-EXPENSES.                                 
004979                                                                  
004980     IF PI-COMPANY-ID = 'NCL'                                     
004981       IF FOUND-TOL-SW = 'Y'                                      
004982         IF WS-PMT-TOL NOT = ZERO                                 
004983           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR           
004984              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)              
004985                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION           
004986                  IF WS-NCL-PMT-OPTION = SPACES                   
004987                      MOVE ER-0699 TO EMI-ERROR                   
004988                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT   
004989                  ELSE                                            
004990                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER           
004991                      NEXT SENTENCE                               
004992                  ELSE                                            
004993                  IF NOT WS-VALID-NCL-OPTION                      
004994                      MOVE ER-0699 TO EMI-ERROR                   
004995                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.  
004996                                                                  
004997     IF WS-PMT-TOL NOT = ZERO                                     
004998        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)                 
004999           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)              
005000           MOVE ER-0495          TO EMI-ERROR                     
005001           PERFORM 1490-PAYMENT-ERROR                             
005002                                 THRU 1490-EXIT                   
005003        end-if                                                    
005004     end-if                                                       
005005                                                                  
005006     GO TO 1500-EDIT-EXPENSES.                                    
005007                                                                  
005008     EJECT                                                        
005009 1440-COMPUTE-LIFE-REMAINING.                                     
005010                                                                  
005011     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
005012        IF PI-PMTTYPE = '4'                                       
005013          MOVE PI-EPYAMT TO PI-CPYAMT                             
005014          GO TO 1460-TEST-TYPE.                                   
005015                                                                  
005016     IF WS-LF-COVERAGE-TYPE = 'L'                                 
005017        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT                     
005018                          - CL-TOTAL-PAID-AMT                     
005019        GO TO 1450-CHECK-MAX.                                     
005020                                                                  
005021     IF PI-LIFE-OVERRIDE-L1 = 'P' OR                              
005022        PI-LF-COVERAGE-TYPE = 'P'                                 
005023          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -                 
005024                              CM-LF-ITD-DEATH-AMT                 
005025          GO TO 1450-CHECK-MAX.                                   
005026                                                                  
005027     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.               
005028     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.            
005029     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.              
005030     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.             
005031     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.                
005032     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.       
005033     MOVE '4'                    TO CP-REM-TERM-METHOD.           
005034     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.            
005035     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.           
005036                                                                  
005037     PERFORM 9800-LINK-REM-TERM.                                  
005038                                                                  
005039     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              
005040     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.                
005041     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.             
005042     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.          
005043     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.         
005044     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.            
005045     MOVE CM-LOAN-APR            TO CP-LOAN-APR.                  
005046     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.                 
005047     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.             
005048     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.           
005049     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.            
005050     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.           
005051     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE                 
005052     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.                
005053     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.          
005054     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.          
005055                                                                  
005056     move zeros                  to ws-max-tot-ben                
005057                                    ws-work-ben-pct               
005058     IF PI-COMPANY-ID = 'DCC' or 'VPP'                            
005059        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD                  
005060        MOVE PI-CARRIER          TO ACCT-CARRIER                  
005061        MOVE PI-GROUPING         TO ACCT-GROUPING                 
005062        MOVE PI-STATE            TO ACCT-STATE                    
005063        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT                  
005064        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT                   
005065        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY            
005066        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD         
005067                                                                  
005068        EXEC CICS READ                                            
005069           DATASET ('ERACCT')                                     
005070           RIDFLD  (ERACCT-KEY)                                   
005071           SET     (ADDRESS OF ACCOUNT-MASTER)                    
005072           GTEQ                                                   
005073           resp    (WS-RESPONSE)                                  
005074        END-EXEC                                                  
005075        IF WS-RESP-NORMAL                                         
005076           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))   
005077           and (pi-cert-eff-dt < am-expiration-dt)                
005078           and (pi-cert-eff-dt >= am-effective-dt)                
005079           move am-dcc-product-code to pi-dcc-product-code        
005080        else                                                      
005081           move spaces           to pi-dcc-product-code           
005082        end-if                                                    
005083        if pi-dcc-product-code not = spaces                       
005084           move cm-ah-benefit-cd to pi-ah-benefit-cd              
005085           move cm-lf-benefit-cd to pi-lf-benefit-cd              
005086           PERFORM 0900-GET-DDF-limits                            
005087                                 THRU 0900-EXIT                   
005088           move cl-insured-birth-dt to dc-bin-date-1              
005089           move cl-incurred-dt to dc-bin-date-2                   
005090           move '1' to dc-option-code                             
005091           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT          
005092           compute ws-att-age =                                   
005093              dc-elapsed-months / 12                              
005094                                                                  
005095           move zeros to dc-elapsed-months dc-elapsed-days        
005096                                                                  
005097           IF PDEF-FOUND                                          
005098              PERFORM VARYING P1 FROM +1 BY +1 UNTIL              
005099                 (P1 > +11)                                       
005100                 OR (PD-PROD-CODE (P1) = cl-claim-type            
005101                   AND PD-MAX-ATT-AGE (P1) >= WS-ATT-AGE )        
005102              END-PERFORM                                         
005103              IF P1 < +12                                         
005104                 MOVE PD-MAX-AMT (P1)                             
005105                                 TO ws-MAX-TOT-BEN                
005106                 if pd-ben-pct (p1) not numeric                   
005107                    move zeros   to pd-ben-pct (p1)               
005108                 end-if                                           
005109                 if pd-ben-pct (p1) = zeros                       
005110                    move +1      to ws-work-ben-pct               
005111                 else                                             
005112                    move pd-ben-pct (p1)                          
005113                                 to ws-work-ben-pct               
005114                 end-if                                           
005115              else                                                
005116                 move er-1674    to emi-error                     
005117                 PERFORM 9900-ERROR-FORMAT                        
005118                                 THRU 9900-EXIT                   
005119              END-IF                                              
005120           else                                                   
005121              move er-1672       to emi-error                     
005122              PERFORM 9900-ERROR-FORMAT                           
005123                                 THRU 9900-EXIT                   
005124           END-IF                                                 
005125        end-if                                                    
005126     END-IF                                                       
005127                                                                  
005128     EXEC CICS LINK                                               
005129        PROGRAM  (LINK-REMAMT)                                    
005130        COMMAREA (CALCULATION-PASS-AREA)                          
005131        LENGTH   (CP-COMM-LENGTH)                                 
005132     END-EXEC.                                                    
005133                                                                  
005134     if ws-work-ben-pct <> 0                                      
005135        compute cp-remaining-amt =                                
005136           cp-remaining-amt * ws-work-ben-pct                     
005137     end-if                                                       
005138     if ws-max-tot-ben <> 0                                       
005139        if cp-remaining-amt > ws-max-tot-ben                      
005140           move ws-max-tot-ben to cp-remaining-amt                
005141        end-if                                                    
005142     end-if                                                       
005143                                                                  
005144     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.    
005145                                                                  
005146     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.          
005147     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.                
005148                                                                  
005149     IF PI-COMPANY-ID = 'BOA' AND                                 
005150        PI-PMTTYPE    = '2'   AND                                 
005151        PI-OFFLINE    = 'N'                                       
005152           GO TO 1441-COMPUTE-BOA-INTEREST.                       
005153                                                                  
005154     IF PI-COMPANY-ID = 'NCL' AND                                 
005155        PI-PMTTYPE    = '2'   AND                                 
005156        PI-OFFLINE    = 'N'                                       
005157          GO TO 1442-COMPUTE-NCL-INTEREST                         
005158       ELSE                                                       
005159          GO TO 1445-CONTINUE.                                    
005160                                                                  
005161 1441-COMPUTE-BOA-INTEREST.                                       
005162     MOVE +0             TO WS-CALC-INT.                          
005163                                                                  
005164     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.                        
005165     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.                        
005166     MOVE +0             TO DC-ELAPSED-MONTHS                     
005167                            DC-ELAPSED-DAYS.                      
005168     MOVE '1'            TO DC-OPTION-CODE.                       
005169     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
005170     IF NO-CONVERSION-ERROR                                       
005171         NEXT SENTENCE                                            
005172     ELSE                                                         
005173         GO TO 1445-CONTINUE.                                     
005174                                                                  
005175     IF (PI-INT-RATE NOT > ZEROS)  AND                            
005176        (DC-ELAPSED-DAYS > +30)                                   
005177         MOVE ER-3531            TO EMI-ERROR                     
005178         MOVE -1                 TO PINTL                         
005179         MOVE AL-UNBON           TO PINTA                         
005180         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                
005181                                                                  
005182     IF PI-EPYAMT NOT > ZEROS                                     
005183         GO TO 1445-CONTINUE.                                     
005184                                                                  
005185     IF (PI-INT-RATE NOT > ZEROS)  OR                             
005186        (DC-ELAPSED-DAYS NOT > +30)                               
005187         MOVE PI-EPYAMT TO PI-CPYAMT                              
005188         GO TO 1441-FORMAT-NOTE.                                  
005189                                                                  
005190     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT                     
005191                                 *  PI-INT-RATE                   
005192                                 *  DC-ELAPSED-DAYS               
005193                                 /  365                           
005194                                 /  100.                          
005195                                                                  
005196     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.                 
005197                                                                  
005198 1441-FORMAT-NOTE.                                                
005199                                                                  
005200     MOVE SPACES        TO WS-BOANOTE1.                           
005201     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.                      
005202     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.                    
005203     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.        
005204     MOVE AL-UANON      TO NOTE1A.                                
005205                                                                  
005206     IF WS-CALC-INT > ZEROS                                       
005207         MOVE SPACES        TO WS-BOANOTE2                        
005208         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC                   
005209         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT                    
005210         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I     
005211         MOVE AL-UANON      TO NOTE2A.                            
005212                                                                  
005213     GO TO 1445-CONTINUE.                                         
005214                                                                  
005215 1442-COMPUTE-NCL-INTEREST.                                       
005216     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
005217     MOVE PI-STATE               TO WS-ST-ACCESS.                 
005218     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.                  
005219     MOVE '3'                    TO CNTL-REC-TYPE.                
005220     MOVE +0                     TO CNTL-SEQ-NO.                  
005221     MOVE 'STAT'                 TO FILE-SWITCH.                  
005222                                                                  
005223     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.                    
005224                                                                  
005225     MOVE +0                 TO WS-CALC-INT.                      
005226                                                                  
005227     IF ST-STAT-FROM-INCURRED                                     
005228         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT                
005229       ELSE                                                       
005230     IF ST-STAT-FROM-REPORTED                                     
005231         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT                
005232       ELSE                                                       
005233         GO TO 1445-CONTINUE.                                     
005234                                                                  
005235     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.                    
005236     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.                    
005237     MOVE +0                 TO DC-ELAPSED-MONTHS                 
005238                                DC-ELAPSED-DAYS.                  
005239     MOVE '1'                TO DC-OPTION-CODE.                   
005240     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
005241     IF NO-CONVERSION-ERROR                                       
005242         NEXT SENTENCE                                            
005243     ELSE                                                         
005244         GO TO 1445-CONTINUE.                                     
005245                                                                  
005246     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR                      
005247        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)             
005248         GO TO 1445-CONTINUE.                                     
005249                                                                  
005250     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT                     
005251                                 *  CF-ST-STAT-INTEREST.          
005252                                                                  
005253     MOVE SPACES              TO WS-NCLNOTE1.                     
005254     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.                
005255     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.              
005256     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1                      
005257                                 PI-PMTNOTE1                      
005258                                 NOTE1I.                          
005259     MOVE AL-UANON            TO NOTE1A.                          
005260                                                                  
005261     IF WS-CALC-INT > ZEROS                                       
005262         MOVE SPACES          TO WS-NCLNOTE2                      
005263         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC                 
005264         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT                  
005265         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2                      
005266                                 PI-PMTNOTE2                      
005267                                 NOTE2I                           
005268         MOVE AL-UANON        TO NOTE2A.                          
005269                                                                  
005270     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.                 
005271                                                                  
005272 1445-CONTINUE.                                                   
005273                                                                  
005274     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'                     
005275        GO TO 1460-TEST-TYPE.                                     
005276                                                                  
005277     IF CM-O-B-COVERAGE                                           
005278        GO TO 1460-TEST-TYPE.                                     
005279                                                                  
005280     IF PI-COMPANY-ID = 'BOA' OR 'NCL'                            
005281         GO TO 1450-CHECK-MAX.                                    
005282                                                                  
005283     if (pi-company-id = 'DCC' or 'VPP')                          
005284        and (pdef-found)                                          
005285        if pi-epyamt > pd-max-amt (p1)                            
005286           move er-1657          to emi-error                     
005287           perform 1490-payment-error                             
005288                                 thru 1490-exit                   
005289           go to 1460-test-type                                   
005290        end-if                                                    
005291     else                                                         
005292        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT) 
005293           > PI-EPYAMT)                                           
005294                         OR                                       
005295           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT) 
005296           < PI-EPYAMT)                                           
005297           MOVE ER-0594          TO EMI-ERROR                     
005298           PERFORM 1490-PAYMENT-ERROR                             
005299                                 THRU 1490-EXIT                   
005300           GO TO 1460-TEST-TYPE                                   
005301        end-if                                                    
005302     end-if                                                       
005303                                                                  
005304     .                                                            
005305 1450-CHECK-MAX.                                                  
005306                                                                  
005307     IF PI-LIFE-OVERRIDE-L1 = 'P' OR                              
005308        PI-LF-COVERAGE-TYPE = 'P'                                 
005309         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -            
005310                                   CM-LF-ITD-DEATH-AMT            
005311     ELSE                                                         
005312         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -            
005313                                   CL-TOTAL-PAID-AMT.             
005314                                                                  
005315     IF PI-EPYAMT > WS-BEN-AMT-LEFT                               
005316          MOVE ER-0543           TO EMI-ERROR                     
005317          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.              
005318                                                                  
005319 1460-TEST-TYPE.                                                  
005320                                                                  
005321     IF PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL'                   
005322        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'             
005323           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +            
005324                                   CM-LF-ALT-BENEFIT-AMT -        
005325                                   CL-TOTAL-PAID-AMT              
005326           IF PI-EPYAMT > WS-LF-BEN-AMT                           
005327               MOVE ER-0543      TO EMI-ERROR                     
005328               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT          
005329           END-IF                                                 
005330        END-IF                                                    
005331     END-IF                                                       
005332                                                                  
005333     IF PI-PMT-APPR-SW = 'G'                                      
005334       NEXT SENTENCE                                              
005335     ELSE                                                         
005336       IF WS-MAX-LF-PMT-TOL NOT = ZERO                            
005337         IF PI-EPYAMT = ZERO                                      
005338             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL                     
005339                 MOVE ER-0494    TO  EMI-ERROR                    
005340                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT        
005341                 GO TO 1500-EDIT-EXPENSES                         
005342             ELSE                                                 
005343                 NEXT SENTENCE                                    
005344         ELSE                                                     
005345             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL                     
005346                 MOVE ER-0494    TO  EMI-ERROR                    
005347                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT        
005348                 GO TO 1500-EDIT-EXPENSES.                        
005349                                                                  
005350     IF PI-PMTTYPE NOT = '2' OR                                   
005351        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')                        
005352         GO TO 1500-EDIT-EXPENSES.                                
005353                                                                  
005354     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.              
005355     MOVE ER-0526                TO EMI-ERROR.                    
005356     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
005357                                                                  
005358     IF EMI-ERROR-NUMBER (1) = '0526'                             
005359        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).        
005360                                                                  
005361     IF EMI-ERROR-NUMBER (2) = '0526'                             
005362        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).        
005363                                                                  
005364     GO TO 1500-EDIT-EXPENSES.                                    
005365                                                                  
005366 1490-PAYMENT-ERROR.                                              
005367     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
005368                                                                  
005369     IF EMI-MESSAGE-FORMATTED                                     
005370         MOVE -1                 TO EPYAMTL                       
005371         MOVE AL-UNBON           TO EPYAMTA.                      
005372                                                                  
005373 1490-EXIT.                                                       
005374      EXIT.                                                       
005375     EJECT                                                        
005376 1500-EDIT-EXPENSES.                                              
005377     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'          
005378         GO TO 1500-SKIP-ERROR-0556.                              
005379                                                                  
005380 1500-CONTINUE-ON.                                                
005381                                                                  
005382     IF CM-O-B-COVERAGE                                           
005383        MOVE ER-0556             TO EMI-ERROR                     
005384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 
005385                                                                  
005386 1500-SKIP-ERROR-0556.                                            
005387     IF PI-PMTTYPE = '4' OR '5' OR '6'                            
005388        IF PI-EEXPENS NOT = ZEROS                                 
005389           MOVE ER-0524          TO EMI-ERROR                     
005390           GO TO 1590-EXPENSE-ERROR                               
005391        ELSE                                                      
005392           GO TO 1600-EDIT-RESERVES.                              
005393                                                                  
005394     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
005395     MOVE '6'                    TO CNTL-REC-TYPE.                
005396                                                                  
005397     IF CONTROL-IS-ACTUAL-CARRIER                                 
005398         MOVE PI-CARRIER         TO WS-CARR                       
005399     ELSE                                                         
005400         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.                
005401                                                                  
005402     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  
005403     MOVE +0                     TO CNTL-SEQ-NO.                  
005404     MOVE 'CARR'                 TO FILE-SWITCH.                  
005405                                                                  
005406     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.                    
005407                                                                  
005408     IF EXPENSE-CALC-MANUAL                                       
005409        GO TO 1600-EDIT-RESERVES.                                 
005410                                                                  
005411     IF DOLLARS-PER-PMT                                           
005412        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS                    
005413        GO TO 1600-EDIT-RESERVES.                                 
005414                                                                  
005415     IF DOLLARS-PER-MONTH AND                                     
005416        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'   
005417                                           OR 'B' or 'H')         
005418       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
005419       GO TO 1600-EDIT-RESERVES.                                  
005420                                                                  
005421     IF PERCENT-OF-PAYMENT                                        
005422        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.      
005423                                                                  
005424     GO TO 1600-EDIT-RESERVES.                                    
005425                                                                  
005426 1590-EXPENSE-ERROR.                                              
005427     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
005428                                                                  
005429     IF EMI-MESSAGE-FORMATTED                                     
005430        MOVE -1                  TO EEXPENSL                      
005431        MOVE AL-UNBON            TO EEXPENSA.                     
005432                                                                  
005433     EJECT                                                        
005434 1600-EDIT-RESERVES.                                              
005435     IF PI-PMTTYPE = '4' OR '5' OR '6'                            
005436        IF PI-ERESV = ZEROS                                       
005437           GO TO 1700-EDIT-EXPENSE-TYPE                           
005438        ELSE                                                      
005439           MOVE ER-0525          TO EMI-ERROR                     
005440           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT              
005441           GO TO 1700-EDIT-EXPENSE-TYPE.                          
005442                                                                  
005443     MOVE ELMSTR-KEY             TO ELTRLR-KEY.                   
005444     MOVE ZEROS                  TO TRLR-SEQ-NO.                  
005445     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.                    
005446                                                                  
005447     IF NOT AT-MANUAL-RESERVES-USED                               
005448        IF PI-ERESV NOT = ZEROS                                   
005449           MOVE ER-0518          TO EMI-ERROR                     
005450           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.             
005451                                                                  
005452     IF AT-MANUAL-RESERVES-USED                                   
005453        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV               
005454        GO TO 1700-EDIT-EXPENSE-TYPE.                             
005455                                                                  
005456     IF AT-FUTURE-RESERVES-USED                                   
005457        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.       
005458                                                                  
005459     IF AT-FUTURE-RESERVES-USED                                   
005460        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.              
005461                                                                  
005462     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED                  
005463        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.            
005464                                                                  
005465     IF AT-IBNR-RESERVES-USED                                     
005466        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.              
005467                                                                  
005468     MOVE WS-RESERVE-WORK        TO PI-CRESV.                     
005469     GO TO 1700-EDIT-EXPENSE-TYPE.                                
005470                                                                  
005471 1690-RESERVE-ERROR.                                              
005472     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
005473                                                                  
005474     IF EMI-MESSAGE-FORMATTED                                     
005475        MOVE AL-UNBON            TO ERESVA                        
005476        MOVE -1                  TO ERESVL.                       
005477                                                                  
005478 1690-EXIT.                                                       
005479      EXIT.                                                       
005480                                                                  
005481    EJECT                                                         
005482 1700-EDIT-EXPENSE-TYPE.                                          
005483     IF PI-PMTTYPE NOT = '5' AND '6'                              
005484        GO TO 2000-EDIT-DONE.                                     
005485                                                                  
005486     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR      
005487                   '6' OR '7' OR '8' OR '9'                       
005488        GO TO 2000-EDIT-DONE.                                     
005489                                                                  
005490 1705-EXPENSE-ERROR.                                              
005491     MOVE ER-0573                TO EMI-ERROR.                    
005492     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
005493                                                                  
005494     IF EMI-MESSAGE-FORMATTED                                     
005495        MOVE AL-UABON            TO ETYPEA                        
005496        MOVE -1                  TO ETYPEL.                       
005497                                                                  
005498     GO TO 2000-EDIT-DONE.                                        
005499     EJECT                                                        
005500 1950-NOT-FOUND.                                                  
005501     IF FILE-SWITCH = 'MSTR'                                      
005502        MOVE ER-0204             TO EMI-ERROR.                    
005503                                                                  
005504     IF FILE-SWITCH = 'CARR'                                      
005505        MOVE ER-0252             TO EMI-ERROR.                    
005506                                                                  
005507     IF FILE-SWITCH = 'COMP'                                      
005508        MOVE ER-0254             TO EMI-ERROR.                    
005509                                                                  
005510     IF FILE-SWITCH = 'STAT'                                      
005511        MOVE ER-0149             TO EMI-ERROR.                    
005512                                                                  
005513     IF FILE-SWITCH = 'PROC'                                      
005514        MOVE ER-0019             TO EMI-ERROR.                    
005515                                                                  
005516     IF FILE-SWITCH = 'ACCT'                                      
005517        MOVE ER-0198             TO EMI-ERROR.                    
005518                                                                  
005519     if eracct-browse-started                                     
005520        exec cics endbr                                           
005521           dataset('ERACCT')                                      
005522        end-exec                                                  
005523        move spaces              to ws-eracct-startbr-ind         
005524     end-if                                                       
005525                                                                  
005526     IF FILE-SWITCH = 'BENE'                                      
005527        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'             
005528           MOVE ER-0282          TO EMI-ERROR                     
005529        ELSE                                                      
005530           MOVE ER-0283          TO EMI-ERROR.                    
005531                                                                  
005532     MOVE -1                     TO PMTTYPEL.                     
005533     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
005534                                                                  
005535     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT               
005536                                     WS-FORCE-CTR.                
005537                                                                  
005538     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT               
005539                                     WS-FATAL-CTR.                
005540                                                                  
005541     GO TO 8200-SEND-DATAONLY.                                    
005542                                                                  
005543     EJECT                                                        
005544 2000-EDIT-DONE.                                                  
005545                                                                  
005546     perform 2210-dcc-max-benes thru 2210-exit                    
005547                                                                  
005548     if pi-company-id not = 'DCC' and 'VPP'                       
005549        IF (WS-SPECIAL-CALC-CD = 'C')                             
005550           and (cl-critical-period > 0)                           
005551           IF CM-AH-BENEFIT-AMT NOT = ZERO                        
005552              IF PI-EPYAMT > ZEROS                                
005553                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +  
005554                    PI-EPYAMT) / CM-AH-BENEFIT-AMT                
005555              ELSE                                                
005556                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +  
005557                    PI-CPYAMT) / CM-AH-BENEFIT-AMT                
005558              END-IF                                              
005559              if ws-benefits-paid > cl-critical-period            
005560                 MOVE ER-0657          TO EMI-ERROR               
005561                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         
005562              END-IF                                              
005563           END-IF                                                 
005564        END-IF                                                    
005565     end-if                                                       
005566                                                                  
005567     IF PI-HOLDTIL NOT = ZEROS                                    
005568        MOVE PI-HOLDTIL          TO HOLDTILO                      
005569        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'              
005570        MOVE ER-3272          TO EMI-ERROR                        
005571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  
005572     END-IF                                                       
005573                                                                  
005574     IF PI-EPYFROM NOT = ZEROS                                    
005575        MOVE PI-EPYFROM          TO EPYFROMO                      
005576        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.             
005577                                                                  
005578     IF PI-EPYTHRU NOT = ZEROS                                    
005579        MOVE PI-EPYTHRU            TO EPYTHRUO                    
005580        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'              
005581        IF PI-USES-PAID-TO                                        
005582           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY          
005583           MOVE '4'                TO DC-OPTION-CODE              
005584           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT          
005585           IF NO-CONVERSION-ERROR                                 
005586              MOVE +1              TO DC-ELAPSED-DAYS             
005587              MOVE +0              TO DC-ELAPSED-MONTHS           
005588              MOVE '6'             TO DC-OPTION-CODE              
005589              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT       
005590              IF NO-CONVERSION-ERROR                              
005591                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.            
005592                                                                  
005593     MOVE PI-EDAYS               TO EDAYSO.                       
005594                                                                  
005595     IF PI-AIGFROM NOT = ZEROS                                    
005596        MOVE PI-AIGFROM          TO AIGFROMO                      
005597        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.             
005598                                                                  
005599     MOVE PI-EPYAMT              TO EPYAMTO.                      
005600     MOVE PI-ERESV               TO ERESVO.                       
005601     MOVE PI-EEXPENS             TO EEXPENSO.                     
005602                                                                  
005603     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.                
005604     MOVE SPACES                 TO DC-OPTION-CODE.               
005605     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
005606                                                                  
005607     IF DATE-CONVERSION-ERROR                                     
005608        MOVE SPACES              TO CPYFROMI                      
005609     ELSE                                                         
005610        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI                      
005611        IF PI-EPYFROM = ZEROS                                     
005612           MOVE AL-UANON             TO EPYFROMA                  
005613           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM                
005614           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.                 
005615                                                                  
005616     IF PI-USES-PAID-TO                                           
005617        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1       
005618        MOVE +1                            TO DC-ELAPSED-DAYS     
005619        MOVE +0                            TO DC-ELAPSED-MONTHS   
005620        MOVE '6'                           TO DC-OPTION-CODE      
005621        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT             
005622        IF NO-CONVERSION-ERROR                                    
005623           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI            
005624           IF PI-EPYTHRU = ZEROS                                  
005625              MOVE AL-UANON                TO EPYTHRUA            
005626              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI            
005627              MOVE ' '                     TO DC-OPTION-CODE      
005628              MOVE +0                      TO DC-ELAPSED-DAYS     
005629                                              DC-ELAPSED-MONTHS   
005630              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT       
005631              IF NO-CONVERSION-ERROR                              
005632                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU         
005633                  GO TO 2001-CONTINUE                             
005634              ELSE                                                
005635                  GO TO 2001-CONTINUE                             
005636           ELSE                                                   
005637              GO TO 2001-CONTINUE.                                
005638                                                                  
005639     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.                
005640     MOVE SPACES                 TO DC-OPTION-CODE.               
005641     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
005642                                                                  
005643     IF DATE-CONVERSION-ERROR                                     
005644        MOVE SPACES              TO CPYTHRUI                      
005645     ELSE                                                         
005646        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI                      
005647        IF PI-EPYTHRU = ZEROS                                     
005648           MOVE AL-UANON TO EPYTHRUA                              
005649           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU                
005650           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.                 
005651                                                                  
005652 2001-CONTINUE.                                                   
005653                                                                  
005654     MOVE PI-CDAYS               TO CDAYSO.                       
005655                                                                  
005656     IF PI-EDAYS = ZEROS                                          
005657        MOVE AL-UNNON TO EDAYSA                                   
005658        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.              
005659                                                                  
005660     MOVE PI-CPYAMT              TO CPYAMTO.                      
005661                                                                  
005662     IF PI-EPYAMT = ZEROS                                         
005663        MOVE AL-UNNON            TO EPYAMTA                       
005664        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.           
005665                                                                  
005666     MOVE PI-CRESV               TO CRESVO.                       
005667     MOVE PI-CEXPENS             TO CEXPENSO.                     
005668                                                                  
005669     IF PI-EEXPENS = ZEROS                                        
005670        MOVE AL-UNNON TO EEXPENSA                                 
005671        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.         
005672                                                                  
005673     IF (PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL')                 
005674        AND (CL-CLAIM-TYPE = 'L')                                 
005675        AND (PI-OFFLINE NOT EQUAL 'Y')                            
005676        IF PI-PMTTYPE = '2' OR '4'                                
005677           PERFORM 2200-CALC-INTEREST                             
005678                                 THRU 2200-EXIT                   
005679        END-IF                                                    
005680     END-IF                                                       
005681                                                                  
005682     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.  
005683     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.  
005684     MOVE LAST-ERROR-LINE        TO ERRMSG0O.                     
005685                                                                  
005686     IF EMI-FATAL-CTR = ZEROS                                     
005687        MOVE 'B'                 TO PI-PASS-SW.                   
005688                                                                  
005689     IF NOT EMI-MESSAGE-FORMATTED                                 
005690         MOVE -1                 TO EPYFROML                      
005691     ELSE                                                         
005692         IF EMI-ERROR-NUMBER (1) = '0526' AND                     
005693            EMI-ERROR-NUMBER (2) = SPACES                         
005694             MOVE -1             TO EPYFROML.                     
005695                                                                  
005696                                                                  
005697     GO TO 8200-SEND-DATAONLY.                                    
005698                                                                  
005699     EJECT                                                        
005700 2200-CALC-INTEREST.                                              
005701                                                                  
005702     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES                  
005703        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY            
005704        MOVE '4'                 TO DC-OPTION-CODE                
005705        PERFORM 9700-LINK-DATE-CONVERT                            
005706        IF DATE-CONVERSION-ERROR                                  
005707            MOVE LOW-VALUES      TO CP-PRF-DT                     
005708        ELSE                                                      
005709           MOVE DC-BIN-DATE-1    TO CP-PRF-DT                     
005710        END-IF                                                    
005711     END-IF                                                       
005712                                                                  
005713     if (pi-int-to-rem-borr <> 'Y' and 'N')                       
005714        if pi-rb-joint-coverage                                   
005715           move 'Y'              to pi-int-to-rem-borr            
005716        end-if                                                    
005717     end-if                                                       
005718     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD                 
005719        IN CLAIM-INT-PASS-AREA                                    
005720     MOVE CL-CERT-STATE          TO CP-STATE                      
005721        IN CLAIM-INT-PASS-AREA                                    
005722     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT                    
005723     MOVE 'LF'                   TO CP-COVERAGE                   
005724     MOVE CL-INCURRED-DT         TO CP-INC-DT                     
005725     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT                     
005726     MOVE LOW-VALUES             TO CP-LSTPD-DT                   
005727     MOVE CL-REPORTED-DT         TO CP-RPT-DT                     
005728     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT                     
005729     MOVE PI-EPYAMT              TO CP-CLAIM-AMT                  
005730                                                                  
005731     EXEC CICS LINK                                               
005732        PROGRAM   ('ELCLMI')                                      
005733        COMMAREA  (CLAIM-INT-PASS-AREA)                           
005734        LENGTH    (CP-CLAIM-LENGTH)                               
005735     END-EXEC                                                     
005736                                                                  
005737     MOVE AL-PANOF               TO PINTHA                        
005738                                    PINTA                         
005739     if cp-clm-int-amt = zeros                                    
005740        move ' ' to pi-int-to-rem-borr                            
005741     end-if                                                       
005742                                                                  
005743     IF NO-CI-ERROR                                               
005744        MOVE CP-CLM-INT-AMT      TO PINTO                         
005745                                    PI-INT-AMT                    
005746        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS                   
005747        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED              
005748        MOVE AL-PANOF            TO PINTHA                        
005749                                    PINTA                         
005750        if pi-rb-joint-coverage                                   
005751           and pi-int-amt > zeros                                 
005752           move '  INT TO'       to itrb1o                        
005753           move ' REM BORR?'     to itrb2o                        
005754           move pi-int-to-rem-borr                                
005755                                 to itrbyno                       
005756           move al-uanon         to itrbyna                       
005757           move +1               to itrbynl                       
005758        else                                                      
005759           move ' '              to pi-int-to-rem-borr            
005760        end-if                                                    
005761     ELSE                                                         
005762        IF CI-RETURN-CODE = '8'                                   
005763           MOVE ER-3818          TO EMI-ERROR                     
005764           MOVE -1               TO ZINTL                         
005765           PERFORM 9900-ERROR-FORMAT                              
005766                                 THRU 9900-EXIT                   
005767           GO TO 2200-EXIT                                        
005768        ELSE                                                      
005769           MOVE ZEROS            TO PINTO                         
005770                                    PI-INT-AMT                    
005771                                    PI-INT-DAYS                   
005772                                    PI-INT-RATE-USED              
005773        END-IF                                                    
005774     END-IF                                                       
005775                                                                  
005776     IF PI-INT-AMT NOT = ZEROS                                    
005777        IF (CL-SOC-SEC-NO (1:9) NUMERIC)                          
005778           AND (CL-SOC-SEC-NO NOT = ZEROS)                        
005779           CONTINUE                                               
005780        ELSE                                                      
005781           MOVE CL-SOC-SEC-NO (1:3)                               
005782                                 TO WS-SSN (1:3)                  
005783           MOVE CL-SOC-SEC-NO (5:2)                               
005784                                 TO WS-SSN (4:2)                  
005785           MOVE CL-SOC-SEC-NO (8:4)                               
005786                                 TO WS-SSN (6:4)                  
005787           IF (WS-SSN NUMERIC)                                    
005788              AND (WS-SSN NOT = ZEROS)                            
005789              CONTINUE                                            
005790           ELSE                                                   
005791              MOVE ER-2044       TO EMI-ERROR                     
005792              PERFORM 9900-ERROR-FORMAT                           
005793                                 THRU 9900-EXIT                   
005794           END-IF                                                 
005795        END-IF                                                    
005796        MOVE ELMSTR-KEY          TO ELTRLR-KEY                    
005797        if pi-int-to-rem-borr = 'Y'                               
005798           move +61              to trlr-seq-no                   
005799        else                                                      
005800           MOVE +51              TO TRLR-SEQ-NO                   
005801        end-if                                                    
005802        EXEC CICS READ                                            
005803           DATASET  ('ELTRLR')                                    
005804           SET      (ADDRESS OF ACTIVITY-TRAILERS)                
005805           RIDFLD   (ELTRLR-KEY)                                  
005806           RESP     (WS-RESPONSE)                                 
005807        END-EXEC                                                  
005808        IF (NOT WS-RESP-NORMAL)                                   
005809                    OR                                            
005810           ((WS-RESP-NORMAL)                                      
005811           AND ((AT-ADDRESS-LINE-1 = SPACES)                      
005812           OR (AT-CITY-STATE = SPACES)))                          
005813           MOVE ER-0874          TO EMI-ERROR                     
005814           if pi-rb-joint-coverage                                
005815              move -1            to itrbynl                       
005816           end-if                                                 
005817           PERFORM 9900-ERROR-FORMAT                              
005818                                 THRU 9900-EXIT                   
005819        else                                                      
005820           move at-mail-to-name  to pi-int-payees-name            
005821        END-IF                                                    
005822     END-IF                                                       
005823                                                                  
005824     .                                                            
005825 2200-EXIT.                                                       
005826     EXIT.                                                        
005827                                                                  
005828 2210-dcc-max-benes.                                              
005829                                                                  
005830     move pi-ah-term             to ws-max-bens                   
005831     if cl-critical-period not = zeros and spaces                 
005832        move cl-critical-period  to ws-max-bens                   
005833     end-if                                                       
005834     move cm-ah-benefit-amt      to ws-monthly-benefit            
005835     if pdef-found                                                
005836        and (pd-max-amt (p1) not = zeros)                         
005837        if pd-ben-pct (p1) not numeric                            
005838           move zeros            to pd-ben-pct (p1)               
005839        end-if                                                    
005840        if pd-ben-pct (p1) = zeros                                
005841           move +1               to ws-work-ben-pct               
005842        else                                                      
005843           move pd-ben-pct (p1)  to ws-work-ben-pct               
005844        end-if                                                    
005845*       compute ws-monthly-benefit =                              
005846*          ws-monthly-benefit * ws-work-ben-pct                   
005847*       if ws-monthly-benefit > pd-max-amt (p1)                   
005848*          move pd-max-amt (p1) to ws-monthly-benefit             
005849*       end-if                                                    
005850     end-if                                                       
005851                                                                  
005852     move cl-cert-key-data       to elcrtt-key (2:21)             
005853     move cl-company-cd          to ctrlr-comp-cd                 
005854     move cl-cert-no             to ctrlr-cert-no                 
005855     move 'B'                    to ctrlr-rec-type                
005856                                                                  
005857     EXEC CICS READ                                               
005858        DATASET  ('ELCRTT')                                       
005859        set      (address of CERTIFICATE-TRAILERS)                
005860        RIDFLD   (ELCRTT-KEY)                                     
005861        RESP     (WS-RESPONSE)                                    
005862     END-EXEC                                                     
005863     IF not WS-RESP-NORMAL                                        
005864        go to 2210-exit                                           
005865     end-if                                                       
005866                                                                  
005867*    if instypei = 'P'                                            
005868*       move +1 to s1                                             
005869*    else                                                         
005870*       MOVE +2 to s1                                             
005871*    end-if                                                       
005872                                                                  
005873*    move +1 to s1                                                
005874*    evaluate cl-claim-type                                       
005875*       when 'A'                                                  
005876*          move +1 to s2                                          
005877*       when 'I'                                                  
005878*          move +2 to s2                                          
005879*       when 'G'                                                  
005880*          move +3 to s2                                          
005881*       when 'L'                                                  
005882*          move +4 to s2                                          
005883*       when 'P'                                                  
005884*          move +5 to s2                                          
005885*    end-evaluate                                                 
005886                                                                  
005887                                                                  
005888     move zeros                  to ws-prev-days-paid             
005889                                    ws-benefits-paid              
005890                                    ws-prev-amt-paid              
005891     perform varying s1 from +1 by +1 until                       
005892        (s1 > +24)                                                
005893        or (cs-claim-type (s1) = spaces)                          
005894        if pi-company-id not = 'DCC' and 'VPP'                    
005895           if cs-claim-type (s1) = cl-claim-type                  
005896              compute ws-prev-days-paid =                         
005897                 ws-prev-days-paid + cs-days-paid (s1)            
005898              compute ws-prev-amt-paid =                          
005899                 ws-prev-amt-paid + cs-total-paid (s1)            
005900           end-if                                                 
005901        else                                                      
005902           if (cs-claim-type (s1) = cl-claim-type)                
005903              and (cs-benefit-period (s1) = cl-benefit-period)    
005904              and (cs-insured-type (s1) = cl-insured-type)        
005905              compute ws-prev-days-paid =                         
005906                 ws-prev-days-paid + cs-days-paid (s1)            
005907              compute ws-prev-amt-paid =                          
005908                 ws-prev-amt-paid + cs-total-paid (s1)            
005909           end-if                                                 
005910        end-if                                                    
005911     end-perform                                                  
005912                                                                  
005913     if pi-epyamt > zeros                                         
005914        compute ws-benefits-paid =                                
005915           (ws-prev-amt-paid + pi-epyamt)                         
005916           / ws-monthly-benefit                                   
005917     else                                                         
005918        compute ws-benefits-paid =                                
005919           (ws-prev-amt-paid + pi-cpyamt)                         
005920           / ws-monthly-benefit                                   
005921     end-if                                                       
005922                                                                  
005923*    if pi-company-id = 'DCC'                                     
005924     if cl-claim-type not = 'L' and 'O' and 'P'                   
005925        if ws-benefits-paid > ws-max-bens                         
005926           move er-1658          to emi-error                     
005927           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               
005928        end-if                                                    
005929     end-if                                                       
005930*    end-if                                                       
005931                                                                  
005932*     if s1 < +25                                                 
005933*        if pi-epyamt > zeros                                     
005934*           compute ws-benefits-paid =                            
005935*              (cs-total-paid (s1) + PI-EPYAMT)                   
005936*              / ws-monthly-benefit                               
005937*        else                                                     
005938*           compute ws-benefits-paid =                            
005939*              (cs-total-paid (s1) + PI-CPYAMT)                   
005940*              / ws-monthly-benefit                               
005941*        end-if                                                   
005942                                                                  
005943*       if ws-benefits-paid > pd-crit-period (p1)                 
005944*        if ws-benefits-paid > ws-max-bens                        
005945*           move er-1658          to emi-error                    
005946*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              
005947*        end-if                                                   
005948*     end-if                                                      
005949                                                                  
005950     .                                                            
005951 2210-exit.                                                       
005952     exit.                                                        
005953                                                                  
005954 2220-update-elcrtt.                                              
005955                                                                  
005956     EXEC CICS GETMAIN                                            
005957        SET      (ADDRESS OF CERTIFICATE-TRAILERS)                
005958        LENGTH   (ELCRTT-LENGTH)                                  
005959        INITIMG  (GETMAIN-SPACE)                                  
005960     END-EXEC                                                     
005961                                                                  
005962     move cl-cert-key-data       to elcrtt-key (2:21)             
005963     move cl-company-cd          to ctrlr-comp-cd                 
005964     move cl-cert-no             to ctrlr-cert-no                 
005965     move 'B'                    to ctrlr-rec-type                
005966                                                                  
005967     EXEC CICS READ                                               
005968        UPDATE                                                    
005969        DATASET  (ELCRTT-DSID)                                    
005970        into     (CERTIFICATE-TRAILERS)                           
005971        RIDFLD   (ELCRTT-KEY)                                     
005972        RESP     (WS-RESPONSE)                                    
005973     END-EXEC                                                     
005974                                                                  
005975     IF WS-RESP-NORMAL                                            
005976        perform 2225-upd-crt-trlr thru 2225-exit                  
005977        EXEC CICS REWRITE                                         
005978           DATASET  (ELCRTT-DSID)                                 
005979           from     (CERTIFICATE-TRAILERS)                        
005980           RESP     (WS-RESPONSE)                                 
005981        END-EXEC                                                  
005982     else                                                         
005983        if ws-resp-notfnd                                         
005984           move 'CS'             to certificate-trailers          
005985           move cl-company-cd    to cs-company-cd                 
005986           move cl-cert-key-data to cs-control-primary (2:21)     
005987           move cl-cert-no       to cs-cert-no                    
005988           move 'B'              to cs-trailer-type               
005989           perform varying s1 from +1 by +1 until s1 > +24        
005990              move zeros         to cs-benefit-period (s1)        
005991                                    cs-days-paid (s1)             
005992                                    cs-total-paid (s1)            
005993                                    cs-remaining-bens (s1)        
005994           end-perform                                            
005995           perform 2225-upd-crt-trlr                              
005996                                 thru 2225-exit                   
005997           EXEC CICS WRITE                                        
005998              DATASET  (ELCRTT-DSID)                              
005999              from     (CERTIFICATE-TRAILERS)                     
006000              RIDFLD   (cs-control-primary)                       
006001              RESP     (WS-RESPONSE)                              
006002           END-EXEC                                               
006003        end-if                                                    
006004     END-IF                                                       
006005                                                                  
006006     .                                                            
006007 2220-exit.                                                       
006008     exit.                                                        
006009                                                                  
006010 2225-upd-crt-trlr.                                               
006011                                                                  
006012*    if instypei = 'P'                                            
006013*       move +1 to s1                                             
006014*    else                                                         
006015*       MOVE +2 to s1                                             
006016*    end-if                                                       
006017                                                                  
006018*    move +1 to s1                                                
006019*    evaluate cl-claim-type                                       
006020*       when 'A'                                                  
006021*          move +1 to s2                                          
006022*       when 'I'                                                  
006023*          move +2 to s2                                          
006024*       when 'G'                                                  
006025*          move +3 to s2                                          
006026*       when 'L'                                                  
006027*          move +4 to s2                                          
006028*       when 'P'                                                  
006029*          move +5 to s2                                          
006030*    end-evaluate                                                 
006031                                                                  
006032     perform varying s1 from +1 by +1 until                       
006033        (s1 > +24)                                                
006034        or (cl-claim-no = cs-claim-no (s1))                       
006035     end-perform                                                  
006036                                                                  
006037     if s1 < +25                                                  
006038        compute cs-total-paid (s1) =                              
006039           cs-total-paid (s1) + at-amount-paid                    
006040        compute cs-days-paid (s1) =                               
006041           cs-days-paid (s1) +  at-days-in-period                 
006042*       compute cs-remaining-bens (s1) =                          
006043*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)      
006044        perform 2230-accum-bens-paid thru 2230-exit               
006045     end-if                                                       
006046                                                                  
006047     .                                                            
006048 2225-exit.                                                       
006049     exit.                                                        
006050                                                                  
006051 2230-accum-bens-paid.                                            
006052                                                                  
006053     if cl-claim-type not = 'L' and 'O' and 'P'                   
006054        move pi-ah-term          to ws-max-bens                   
006055        if cl-critical-period not = zeros and spaces              
006056           move cl-critical-period                                
006057                                 to ws-max-bens                   
006058        end-if                                                    
006059     else                                                         
006060        move 01                  to ws-max-bens                   
006061     end-if                                                       
006062                                                                  
006063     move zeros to ws-tot-days-paid ws-tot-amt-paid               
006064     perform varying s2 from +1 by +1 until                       
006065        (s2 > +24)                                                
006066        or (cs-claim-no (s2) = spaces)                            
006067        if pi-company-id not = 'DCC' and 'VPP'                    
006068           if cs-claim-type (s2) = cl-claim-type                  
006069              compute ws-tot-days-paid =                          
006070                 ws-tot-days-paid + cs-days-paid (s2)             
006071              compute ws-tot-amt-paid =                           
006072                 ws-tot-amt-paid + cs-total-paid (s2)             
006073           end-if                                                 
006074        else                                                      
006075           if (cs-benefit-period (s2) = cl-benefit-period)        
006076              and (cs-claim-type (s2) = cl-claim-type)            
006077              and (cs-insured-type (s2) = cl-insured-type)        
006078              compute ws-tot-days-paid =                          
006079                 ws-tot-days-paid + cs-days-paid (s2)             
006080              compute ws-tot-amt-paid =                           
006081                 ws-tot-amt-paid + cs-total-paid (s2)             
006082           end-if                                                 
006083        end-if                                                    
006084     end-perform                                                  
006085     if cl-claim-type = 'L' or 'P' or 'O'                         
006086        if ws-tot-amt-paid > zeros                                
006087           move zeros            to cs-remaining-bens (s1)        
006088        else                                                      
006089           move 01               to cs-remaining-bens (s1)        
006090        end-if                                                    
006091     else                                                         
006092        compute ws-pd-bens rounded =                              
006093           ws-tot-amt-paid / pi-ah-benefit-amt                    
006094        compute cs-remaining-bens (s1) =                          
006095           ws-max-bens - ws-pd-bens                               
006096        if cs-remaining-bens (s1) < zeros                         
006097           move zeros            to cs-remaining-bens (s1)        
006098        end-if                                                    
006099     end-if                                                       
006100                                                                  
006101     .                                                            
006102 2230-exit.                                                       
006103     exit.                                                        
006104                                                                  
006105 3000-MOVE-INPUT-TO-SAVE-AREA.                                    
006106     IF PMTTYPEL > 0                                              
006107         MOVE PMTTYPEI           TO WS-PMTTYPE.                   
006108                                                                  
006109     if ws-pmttype = '4'                                          
006110        if pi-rb-joint-coverage                                   
006111           if payeel = +0                                         
006112              move +2            to payeel                        
006113              move al-uanon      to payeea                        
006114              move 'Q1'          to payeeo                        
006115           else                                                   
006116              if payeei not = 'Q1' and 'q1'                       
006117                 move er-1582    to emi-error                     
006118                 PERFORM 9900-ERROR-FORMAT thru 9900-exit         
006119              end-if                                              
006120           end-if                                                 
006121        end-if                                                    
006122     end-if                                                       
006123                                                                  
006124     MOVE SPACES                 TO PI-PROVISIONAL-IND.           
006125                                                                  
006126     IF WS-PMTTYPE = '9'                                          
006127         MOVE 'P'                TO PI-PROVISIONAL-IND            
006128         MOVE '1'                TO WS-PMTTYPE.                   
006129                                                                  
006130     IF PAYEEL > 0                                                
006131         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI               
006132         MOVE PAYEEI             TO WS-PAYEE.                     
006133                                                                  
006134     IF NOTE1L > +0                                               
006135         MOVE NOTE1I             TO WS-PMTNOTE1                   
006136                                    WS-FLI-PMTNOTE                
006137                                    WS-HAN-PMTNOTE.               
006138                                                                  
006139     IF NOTE2L > +0                                               
006140         MOVE NOTE2I             TO WS-PMTNOTE2.                  
006141                                                                  
006142     IF OFFLINEL > 0                                              
006143         MOVE OFFLINEI           TO WS-OFFLINE.                   
006144                                                                  
006145     IF PROOFDTL > 0                                              
006146         MOVE PROOFDTI            TO DATE-WORK                    
006147         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT                  
006148         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY           
006149         MOVE '4'                 TO DC-OPTION-CODE               
006150         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT           
006151         IF NO-CONVERSION-ERROR                                   
006152            MOVE NUM-WORK         TO PROOFDTO                     
006153            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'             
006154            MOVE NUM-WORK         TO WS-PROOF-DATE                
006155         ELSE                                                     
006156            MOVE ZEROS            TO WS-PROOF-DATE                
006157         END-IF                                                   
006158     END-IF.                                                      
006159                                                                  
006160     IF EOBYNL > +0                                               
006161         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI               
006162         MOVE EOBYNI              TO WS-PRINT-EOB-YN              
006163     END-IF                                                       
006164                                                                  
006165     IF CLMFMYNL > +0                                             
006166         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI           
006167         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN          
006168     END-IF                                                       
006169                                                                  
006170     IF SURVYYNL > +0                                             
006171         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI           
006172         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN           
006173     END-IF                                                       
006174                                                                  
006175     IF SPRELYNL > +0                                             
006176         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI           
006177         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN        
006178     END-IF                                                       
006179                                                                  
006180     if itrbynl <> +0                                             
006181        move function upper-case(itrbyni) to itrbyni              
006182        move itrbyni             to ws-int-to-rem-borr            
006183     end-if                                                       
006184                                                                  
006185*    IF GROUPEDL > +0                                             
006186*        MOVE GROUPEDI           TO WS-GROUPED.                   
006187*                                                                 
006188*    IF CASHL > +0                                                
006189*       MOVE CASHI               TO WS-CASH.                      
006190     IF LOANNOL > +0                                              
006191         MOVE LOANNOI            TO WS-LOAN-NO.                   
006192                                                                  
006193     IF CHECKNOL > 0                                              
006194         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.   
006195                                                                  
006196     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
006197         IF WS-AIG-CREDIT-ENTERED                                 
006198             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2            
006199             MOVE ZEROS            TO WS-A-CHECKNO-3-7            
006200             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO         
006201             MOVE AL-UANON         TO CHECKNOA.                   
006202                                                                  
006203     IF HOLDTILL > 0                                              
006204         MOVE HOLDTILI           TO DATE-WORK                     
006205         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT                  
006206         MOVE NUM-WORK           TO WS-HOLDTIL.                   
006207                                                                  
006208     IF ZINTL > +0                                                
006209        EXEC CICS BIF DEEDIT                                      
006210            FIELD   (ZINTI)                                       
006211            LENGTH  (07)                                          
006212        END-EXEC                                                  
006213        IF ZINTI NOT NUMERIC                                      
006214           MOVE ER-0419          TO EMI-ERROR                     
006215           PERFORM 9900-ERROR-FORMAT                              
006216           MOVE AL-UABON         TO ZINTA                         
006217           MOVE -1               TO ZINTL                         
006218        ELSE                                                      
006219           MOVE ZINTI            TO CP-INT-RATE                   
006220                                    WS-INT-RATE                   
006221           MOVE CP-INT-RATE      TO ZINTO                         
006222           MOVE AL-UNNON         TO ZINTA                         
006223        END-IF                                                    
006224     ELSE                                                         
006225        MOVE ZEROS               TO CP-INT-RATE                   
006226     END-IF                                                       
006227                                                                  
006228     IF EPYFROML > 0                                              
006229         MOVE EPYFROMI           TO DATE-WORK                     
006230         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT                  
006231         MOVE NUM-WORK           TO WS-EPYFROM.                   
006232                                                                  
006233     IF AIGFROML > 0                                              
006234         MOVE AIGFROMI           TO DATE-WORK                     
006235         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT                  
006236         MOVE NUM-WORK           TO WS-AIGFROM                    
006237     ELSE                                                         
006238         IF (AIGFROMI = LOW-VALUES) AND                           
006239            (PI-AIGFROM NOT = ZEROS)                              
006240              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.                   
006241                                                                  
006242     IF EPYTHRUL > +0                                             
006243        MOVE EPYTHRUI           TO DATE-WORK                      
006244        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT                   
006245        MOVE NUM-WORK           TO WS-EPYTHRU                     
006246        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY             
006247        MOVE '4'                TO DC-OPTION-CODE                 
006248        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT             
006249        IF NO-CONVERSION-ERROR                                    
006250           IF PI-USES-PAID-TO                                     
006251              MOVE '6'                TO DC-OPTION-CODE           
006252              MOVE -1                 TO DC-ELAPSED-DAYS          
006253              MOVE +0                 TO DC-ELAPSED-MONTHS        
006254              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT       
006255              IF NO-CONVERSION-ERROR                              
006256                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1            
006257                 MOVE ' '             TO DC-OPTION-CODE           
006258                 MOVE +0              TO DC-ELAPSED-DAYS          
006259                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT    
006260              IF NO-CONVERSION-ERROR                              
006261                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.           
006262                                                                  
006263*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN          
006264*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.                  
006265     IF EDAYSL > 0                                                
006266         EXEC CICS BIF DEEDIT                                     
006267             FIELD(EDAYSI)                                        
006268             LENGTH(6)                                            
006269         END-EXEC                                                 
006270         MOVE EDAYSI             TO WS-DY-WORK                    
006271         IF WS-DY-SIGN = SPACES                                   
006272            MOVE WS-DY-NUM       TO WS-EDAYS                      
006273            ADD 0                TO WS-EDAYS                      
006274         ELSE                                                     
006275            MOVE EDAYSI          TO WS-EDAYS                      
006276            ADD 0                TO WS-EDAYS.                     
006277                                                                  
006278*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN       
006279*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.                  
006280     IF EPYAMTL > 0                                               
006281         EXEC CICS BIF DEEDIT                                     
006282             FIELD(EPYAMTI)                                       
006283             LENGTH(10)                                           
006284         END-EXEC                                                 
006285         MOVE EPYAMTI            TO WS-PY-WORK                    
006286         IF WS-PY-SIGN = SPACES                                   
006287            MOVE WS-PY-NUM       TO WS-EPYAMT                     
006288            ADD 0                TO WS-EPYAMT                     
006289         ELSE                                                     
006290            MOVE EPYAMTI         TO WS-EPYAMT                     
006291            ADD 0                TO WS-EPYAMT.                    
006292                                                                  
006293     IF ERESVL > 0                                                
006294         EXEC CICS BIF DEEDIT                                     
006295             FIELD(ERESVI)                                        
006296             LENGTH(9)                                            
006297         END-EXEC                                                 
006298         MOVE ERESVI TO WS-ERESV.                                 
006299                                                                  
006300     IF EEXPENSL > 0                                              
006301         EXEC CICS BIF DEEDIT                                     
006302             FIELD(EEXPENSI)                                      
006303             LENGTH(8)                                            
006304         END-EXEC                                                 
006305         MOVE EEXPENSI           TO WS-EEXPENS.                   
006306                                                                  
006307     IF ETYPEL > ZEROS                                            
006308         MOVE ETYPEI             TO WS-ETYPE.                     
006309                                                                  
006310     IF PI-COMPANY-ID = 'BOA'                                     
006311        IF PINTL > ZEROS                                          
006312           EXEC CICS BIF DEEDIT                                   
006313             FIELD (PINTI)                                        
006314             LENGTH(05)                                           
006315           END-EXEC                                               
006316           IF PINTI NUMERIC                                       
006317               MOVE AL-UNNON     TO PINTA                         
006318               MOVE PINTI        TO WS-INT-RATE                   
006319               MOVE WS-INT-RATE  TO PINTO.                        
006320                                                                  
006321 3000-EXIT.                                                       
006322     EXIT.                                                        
006323                                                                  
006324     EJECT                                                        
006325 3050-REBUILD-ENTERED.                                            
006326                                                                  
006327     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.                         
006328                                                                  
006329     IF PI-PROV-PMT                                               
006330         MOVE '9'           TO PMTTYPEO                           
006331     ELSE                                                         
006332         MOVE PI-PMTTYPE    TO PMTTYPEO.                          
006333                                                                  
006334     MOVE PI-PAYEE          TO PAYEEO.                            
006335     MOVE PI-PMTNOTE1       TO NOTE1O.                            
006336     MOVE PI-PMTNOTE2       TO NOTE2O.                            
006337     MOVE PI-OFFLINE        TO OFFLINEO.                          
006338     IF PI-PROOF-DATE NOT = ZEROS                                 
006339         MOVE PI-PROOF-DATE TO PROOFDTO                           
006340         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'             
006341     END-IF.                                                      
006342*    MOVE PI-GROUPED        TO GROUPEDO.                          
006343                                                                  
006344*    MOVE PI-CASH           TO CASHO.                             
006345                                                                  
006346     IF PI-INT-RATE > ZEROS                                       
006347        MOVE PI-INT-RATE         TO PINTO                         
006348     end-if                                                       
006349                                                                  
006350     IF PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL'                   
006351        IF PI-INT-AMT > ZEROS                                     
006352           MOVE PI-INT-AMT       TO PINTO                         
006353           MOVE AL-PANOF         TO PINTA                         
006354                                    PINTHA                        
006355           if pi-rb-joint-coverage                                
006356              move '  INT TO'    to itrb1o                        
006357              move ' REM BORR?'  to itrb2o                        
006358              move 'Y'           to itrbyno                       
006359              move al-uanon      to itrbyna                       
006360              move +1            to itrbynl                       
006361           end-if                                                 
006362        END-IF                                                    
006363     END-IF                                                       
006364                                                                  
006365     MOVE PI-PRINT-EOB-YN        TO EOBYNI                        
006366     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI                      
006367     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI                      
006368     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI                      
006369                                                                  
006370     IF PI-HOLDTIL NOT = ZEROS                                    
006371        MOVE PI-HOLDTIL          TO HOLDTILO                      
006372        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.             
006373                                                                  
006374     IF PI-EPYFROM NOT = ZEROS                                    
006375        MOVE PI-EPYFROM          TO EPYFROMO                      
006376        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.             
006377                                                                  
006378     IF PI-AIGFROM NOT = ZEROS                                    
006379        MOVE PI-AIGFROM          TO AIGFROMO                      
006380        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.             
006381                                                                  
006382     IF PI-EPYTHRU NOT = ZEROS                                    
006383        MOVE PI-EPYTHRU          TO EPYTHRUO                      
006384        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'              
006385        IF PI-USES-PAID-TO                                        
006386           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY          
006387           MOVE '4'                TO DC-OPTION-CODE              
006388           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT          
006389           IF NO-CONVERSION-ERROR                                 
006390              MOVE +1 TO DC-ELAPSED-DAYS                          
006391              MOVE +0 TO DC-ELAPSED-MONTHS                        
006392              MOVE '6' TO DC-OPTION-CODE                          
006393              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT       
006394              IF NO-CONVERSION-ERROR                              
006395                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.            
006396                                                                  
006397     IF PI-EDAYS NOT = ZEROS                                      
006398        MOVE PI-EDAYS TO EDAYSO.                                  
006399                                                                  
006400     IF PI-EPYAMT NOT = ZEROS                                     
006401        MOVE PI-EPYAMT TO EPYAMTO.                                
006402                                                                  
006403     IF PI-ERESV NOT = ZEROS                                      
006404        MOVE PI-ERESV TO ERESVO.                                  
006405                                                                  
006406     IF PI-EEXPENS NOT = ZEROS                                    
006407        MOVE PI-EEXPENS TO EEXPENSO.                              
006408                                                                  
006409     MOVE PI-ETYPE TO ETYPEO.                                     
006410                                                                  
006411     IF PI-ECHECKNO NOT = SPACES                                  
006412        MOVE PI-ECHECKNO         TO CHECKNOO                      
006413     ELSE                                                         
006414        MOVE PI-CCHECKNO         TO CHECKNOO.                     
006415                                                                  
006416     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.                
006417     MOVE SPACES                 TO DC-OPTION-CODE.               
006418     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
006419                                                                  
006420     IF DATE-CONVERSION-ERROR                                     
006421        MOVE SPACES              TO CPYFROMI                      
006422     ELSE                                                         
006423        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.                     
006424                                                                  
006425     IF PI-USES-PAID-TO                                           
006426        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1                 
006427        MOVE +1                  TO DC-ELAPSED-DAYS               
006428        MOVE +0                  TO DC-ELAPSED-MONTHS             
006429        MOVE '6'                 TO DC-OPTION-CODE                
006430        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT             
006431        IF NO-CONVERSION-ERROR                                    
006432           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI                   
006433           GO TO 3051-CONTINUE.                                   
006434                                                                  
006435     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.                
006436     MOVE SPACES                 TO DC-OPTION-CODE.               
006437     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
006438                                                                  
006439     IF DATE-CONVERSION-ERROR                                     
006440        MOVE SPACES              TO CPYTHRUI                      
006441     ELSE                                                         
006442        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.                     
006443                                                                  
006444 3051-CONTINUE.                                                   
006445                                                                  
006446     IF PI-CDAYS NOT = ZEROS                                      
006447        MOVE PI-CDAYS TO CDAYSO.                                  
006448                                                                  
006449     IF PI-CPYAMT NOT = ZEROS                                     
006450        MOVE PI-CPYAMT TO CPYAMTO.                                
006451                                                                  
006452     IF PI-CRESV NOT = ZEROS                                      
006453        MOVE PI-CRESV TO CRESVO.                                  
006454                                                                  
006455     IF PI-CEXPENS NOT = ZEROS                                    
006456        MOVE PI-CEXPENS TO CEXPENSO.                              
006457                                                                  
006458 3059-EXIT.                                                       
006459     EXIT.                                                        
006460                                                                  
006461 3100-DEEDIT-DATE.                                                
006462     EXEC CICS BIF DEEDIT                                         
006463         FIELD(DATE-WORK)                                         
006464         LENGTH(8)                                                
006465     END-EXEC.                                                    
006466                                                                  
006467 3100-EXIT.                                                       
006468     EXIT.                                                        
006469                                                                  
006470 3200-CALC-AIG-DAYS.                                              
006471                                                                  
006472     MOVE 'N'                    TO WS-DUE-DAY-SW.                
006473                                                                  
006474     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.                
006475     MOVE ' '                    TO DC-OPTION-CODE.               
006476     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
006477     IF NO-CONVERSION-ERROR                                       
006478         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY           
006479     ELSE                                                         
006480         GO TO 3290-ERROR.                                        
006481                                                                  
006482     IF WS-SV-AIGFROM NOT = LOW-VALUES                            
006483         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1                     
006484                                WS-BIN-FROM-DT                    
006485     ELSE                                                         
006486         IF CL-TOTAL-PAID-AMT > ZEROS                             
006487             IF WS-SV-EPYFROM = LOW-VALUES                        
006488                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1             
006489                                        WS-BIN-FROM-DT            
006490             ELSE                                                 
006491                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1             
006492                                        WS-BIN-FROM-DT            
006493         ELSE                                                     
006494             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1             
006495                                        WS-BIN-FROM-DT.           
006496                                                                  
006497 3210-CONTINUE.                                                   
006498                                                                  
006499     MOVE ' '                    TO DC-OPTION-CODE.               
006500     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
006501     IF DATE-CONVERSION-ERROR                                     
006502         GO TO 3290-ERROR.                                        
006503                                                                  
006504     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.                   
006505                                                                  
006506     IF PI-LOAN-DUE-DAY = 31                                      
006507         MOVE 30              TO WS-PMT-DUE-DA                    
006508                                 WS-SAVE-DUE-DA                   
006509     ELSE                                                         
006510         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA                    
006511                                 WS-SAVE-DUE-DA.                  
006512                                                                  
006513     IF (PI-LOAN-DUE-DAY > 28) AND                                
006514        (WS-PMT-DUE-MO = 2)                                       
006515         MOVE 'Y'                TO WS-DUE-DAY-SW                 
006516         MOVE 28                 TO WS-PMT-DUE-DA.                
006517                                                                  
006518     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.           
006519     MOVE '4'                    TO DC-OPTION-CODE.               
006520     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
006521     IF NO-CONVERSION-ERROR                                       
006522         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT                 
006523     ELSE                                                         
006524         GO TO 3290-ERROR.                                        
006525                                                                  
006526*--------------------------------------------------------------*  
006527*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *  
006528*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *  
006529*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *  
006530*                                                              *  
006531*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *  
006532*             INCURRED DATE      - 04/15/91                    *  
006533*             PMT DUE DATE       - 04/03/91                    *  
006534*             PMT DUE DATE       - 05/03/91                    *  
006535*--------------------------------------------------------------*  
006536                                                                  
006537     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND                      
006538        (WS-SV-AIGFROM = LOW-VALUES)                              
006539         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND                  
006540            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)                      
006541             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1             
006542             PERFORM 3300-BUMP-DATE THRU 3399-EXIT                
006543             IF NO-CONVERSION-ERROR                               
006544                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT         
006545                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY        
006546             ELSE                                                 
006547                 GO TO 3290-ERROR.                                
006548                                                                  
006549     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND                      
006550        (WS-SV-AIGFROM = LOW-VALUES)                              
006551         GO TO 3205-CONT-CALC-PMT.                                
006552                                                                  
006553     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.                
006554     MOVE ' '                    TO DC-OPTION-CODE.               
006555     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
006556     IF NO-CONVERSION-ERROR                                       
006557         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY          
006558     ELSE                                                         
006559         GO TO 3290-ERROR.                                        
006560                                                                  
006561     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND                          
006562        (WS-PMT-DUE-DA < WS-FROM-DA)                              
006563          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1                
006564          PERFORM 3300-BUMP-DATE THRU 3399-EXIT                   
006565          IF NO-CONVERSION-ERROR                                  
006566              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT            
006567              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY           
006568          ELSE                                                    
006569              GO TO 3290-ERROR.                                   
006570                                                                  
006571 3205-CONT-CALC-PMT.                                              
006572                                                                  
006573*--------------------------------------------------------------*  
006574*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *  
006575*    BETWEEN THE PAY FROM / THRU DATES.                        *  
006576*--------------------------------------------------------------*  
006577                                                                  
006578     IF CL-TOTAL-PAID-AMT = ZEROS AND                             
006579        PI-PMTTYPE = '2'                                          
006580          NEXT SENTENCE                                           
006581     ELSE                                                         
006582        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR                    
006583           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)                        
006584             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD            
006585             MOVE ER-3527            TO EMI-ERROR                 
006586             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             
006587             MOVE -1                 TO EPYTHRUL                  
006588             MOVE AL-UNBON           TO EPYTHRUA                  
006589                                        EPYFROMA                  
006590             GO TO 3299-EXIT.                                     
006591                                                                  
006592*--------------------------------------------------------------*  
006593*    CALCULATE RETRO ELIMINATION DATE                          *  
006594*--------------------------------------------------------------*  
006595                                                                  
006596     IF WS-SV-AIGFROM NOT = LOW-VALUES                            
006597         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1                     
006598     ELSE                                                         
006599         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.                    
006600                                                                  
006601     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.                      
006602     MOVE +0             TO DC-ELAPSED-MONTHS.                    
006603     MOVE '6'            TO DC-OPTION-CODE.                       
006604     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
006605     IF NO-CONVERSION-ERROR                                       
006606         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT                   
006607     ELSE                                                         
006608         GO TO 3290-ERROR.                                        
006609                                                                  
006610 3210-CHECK-PMT-DATE.                                             
006611                                                                  
006612*--------------------------------------------------------------*  
006613*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *  
006614*    THE ENTERED PAY FROM DATE                                 *  
006615*--------------------------------------------------------------*  
006616                                                                  
006617     IF WS-PMT-DUE-DT < WS-SV-EPYFROM                             
006618         NEXT SENTENCE                                            
006619     ELSE                                                         
006620         GO TO 3220-COMPUTE-DAYS.                                 
006621                                                                  
006622     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.                    
006623     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.                       
006624     IF NO-CONVERSION-ERROR                                       
006625         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT                 
006626         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY                
006627         GO TO 3210-CHECK-PMT-DATE                                
006628     ELSE                                                         
006629         GO TO 3290-ERROR.                                        
006630                                                                  
006631 3220-COMPUTE-DAYS.                                               
006632                                                                  
006633     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.                    
006634     MOVE ZEROS         TO WS-CDAYS.                              
006635     MOVE 'N'           TO WS-ELIMINATION-SW.                     
006636                                                                  
006637*--------------------------------------------------------------*  
006638*    COMPUTE CALIFORNIA DUE DAYS                               *  
006639*--------------------------------------------------------------*  
006640                                                                  
006641     IF CL-TOTAL-PAID-AMT > ZEROS                                 
006642         MOVE 'Y' TO WS-ELIMINATION-SW                            
006643         GO TO 3240-FIRST-PMT-DUE                                 
006644     ELSE                                                         
006645        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT                       
006646            NEXT SENTENCE                                         
006647        ELSE                                                      
006648            GO TO 3240-FIRST-PMT-DUE.                             
006649                                                                  
006650 3230-NEXT-PMT-DUE.                                               
006651                                                                  
006652     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.                    
006653     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.                       
006654     IF NO-CONVERSION-ERROR                                       
006655         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT                 
006656         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY                
006657     ELSE                                                         
006658         GO TO 3290-ERROR.                                        
006659                                                                  
006660 3240-FIRST-PMT-DUE.                                              
006661                                                                  
006662     IF CL-TOTAL-PAID-AMT > ZEROS                                 
006663         NEXT SENTENCE                                            
006664     ELSE                                                         
006665        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT                  
006666            GO TO 3230-NEXT-PMT-DUE.                              
006667                                                                  
006668     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU                        
006669         GO TO 3250-VERIFY-ELIMINATION.                           
006670                                                                  
006671     ADD +30 TO WS-CDAYS.                                         
006672     MOVE 'Y' TO WS-ELIMINATION-SW.                               
006673     GO TO 3230-NEXT-PMT-DUE.                                     
006674                                                                  
006675 3250-VERIFY-ELIMINATION.                                         
006676                                                                  
006677     IF ELIM-SATISFIED                                            
006678         GO TO 3260-END-CALC.                                     
006679                                                                  
006680     IF PI-PMTTYPE = '1'                                          
006681         MOVE ZEROS TO WS-CDAYS                                   
006682         GO TO 3260-END-CALC.                                     
006683                                                                  
006684     IF WS-SV-AIGFROM NOT = LOW-VALUES                            
006685         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1                     
006686     ELSE                                                         
006687         IF CL-TOTAL-PAID-AMT > ZEROS                             
006688             IF WS-SV-EPYFROM = LOW-VALUES                        
006689                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1             
006690             ELSE                                                 
006691                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1             
006692         ELSE                                                     
006693             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.            
006694                                                                  
006695     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.                
006696     MOVE '1'                    TO DC-OPTION-CODE.               
006697     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
006698     IF NO-CONVERSION-ERROR                                       
006699         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1               
006700     ELSE                                                         
006701         GO TO 3290-ERROR.                                        
006702                                                                  
006703     IF CL-TOTAL-PAID-AMT > ZEROS                                 
006704         MOVE WS-DAYS-OFF TO WS-CDAYS                             
006705     ELSE                                                         
006706         IF PI-BEN-DAYS > WS-DAYS-OFF                             
006707             MOVE ZEROS TO WS-CDAYS                               
006708         ELSE                                                     
006709             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.        
006710                                                                  
006711 3260-END-CALC.                                                   
006712                                                                  
006713     MOVE WS-CDAYS TO PI-CDAYS.                                   
006714                                                                  
006715     IF PI-EDAYS = ZEROS                                          
006716         MOVE PI-CDAYS TO PI-EDAYS                                
006717         MOVE AL-UNNON TO EDAYSA.                                 
006718                                                                  
006719     GO TO 3299-EXIT.                                             
006720                                                                  
006721 3290-ERROR.                                                      
006722                                                                  
006723     MOVE ER-3528            TO EMI-ERROR.                        
006724     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
006725     MOVE -1                 TO CDAYSL.                           
006726     MOVE AL-UNBON           TO CDAYSA.                           
006727                                                                  
006728 3299-EXIT.                                                       
006729     EXIT.                                                        
006730                                                                  
006731 3300-BUMP-DATE.                                                  
006732                                                                  
006733     IF WS-RESTORE-DUE-DAY                                        
006734         MOVE 'N'              TO WS-DUE-DAY-SW                   
006735         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA                   
006736         ADD 1                 TO WS-PMT-DUE-MO                   
006737         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY              
006738         MOVE '4'              TO DC-OPTION-CODE                  
006739         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT            
006740         IF NO-CONVERSION-ERROR                                   
006741             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY            
006742             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2             
006743             GO TO 3399-EXIT                                      
006744         ELSE                                                     
006745             MOVE '9'          TO DC-ERROR-CODE                   
006746             GO TO 3399-EXIT.                                     
006747                                                                  
006748     IF (WS-PMT-DUE-MO = 1) AND                                   
006749        (WS-SAVE-DUE-DA > 28)                                     
006750           MOVE 'Y' TO WS-DUE-DAY-SW.                             
006751                                                                  
006752     MOVE +0                 TO DC-ELAPSED-DAYS.                  
006753     MOVE +1                 TO DC-ELAPSED-MONTHS.                
006754     MOVE '6'                TO DC-OPTION-CODE.                   
006755     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
006756                                                                  
006757 3399-EXIT.                                                       
006758     EXIT.                                                        
006759                                                                  
006760     EJECT                                                        
006761 3400-COMPUTE-EXPIRY.                                             
006762                                                                  
006763     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.                 
006764     MOVE +0                    TO DC-ELAPSED-DAYS                
006765                                   DC-ODD-DAYS-OVER.              
006766     MOVE '1'                   TO DC-END-OF-MONTH.               
006767     MOVE '6'                   TO DC-OPTION-CODE.                
006768                                                                  
006769     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'                
006770         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1         
006771     ELSE                                                         
006772         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.        
006773                                                                  
006774     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
006775     IF NO-CONVERSION-ERROR                                       
006776         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT               
006777     ELSE                                                         
006778         GO TO 3390-CONTINUE.                                     
006779                                                                  
006780     IF CL-CLAIM-TYPE NOT = (PI-LIFE-OVERRIDE-L1 OR 'O')          
006781         GO TO 3390-CONTINUE.                                     
006782                                                                  
006783     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
006784     MOVE '4'                    TO CNTL-REC-TYPE.                
006785     MOVE +0                     TO CNTL-SEQ-NO.                  
006786     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.                    
006787     MOVE WS-ACCESS              TO CNTL-ACCESS.                  
006788     MOVE 'BENE'                 TO FILE-SWITCH.                  
006789                                                                  
006790     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    
006791                                                                  
006792     IF NO-BENEFIT-FOUND                                          
006793         GO TO 3390-CONTINUE.                                     
006794                                                                  
006795     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'          
006796           OR 'FNL'                                               
006797        IF (PI-OFFLINE = 'Y') OR                                  
006798           (PI-PMTTYPE = '7')                                     
006799           PERFORM 9870-OUTPUT-ACTIVITY-RECORD                    
006800                                     THRU 9870-EXIT               
006801           IF ERROR-ON-OUTPUT                                     
006802             MOVE -1                 TO ENTERPFL                  
006803             MOVE AL-UANON           TO ENTERPFA                  
006804             MOVE MAP-NAMEA          TO MAP-NAME                  
006805             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             
006806             GO TO 8200-SEND-DATAONLY.                            
006807                                                                  
006808     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')  AND         
006809        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND     
006810        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')                       
006811          MOVE WS-EXP-DT TO DC-BIN-DATE-1                         
006812          MOVE +0        TO DC-ELAPSED-DAYS                       
006813          MOVE +1        TO DC-ELAPSED-MONTHS                     
006814          MOVE 6         TO DC-OPTION-CODE                        
006815          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.          
006816          IF NO-CONVERSION-ERROR                                  
006817              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.         
006818                                                                  
006819 3390-CONTINUE.                                                   
006820                                                                  
006821      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'   
006822                                           OR 'B' or 'H'          
006823         MOVE CM-AH-LOAN-EXPIRE-DT                                
006824                                 TO DC-BIN-DATE-1                 
006825      ELSE                                                        
006826         MOVE CM-LF-LOAN-EXPIRE-DT                                
006827                                 TO DC-BIN-DATE-1                 
006828      END-IF                                                      
006829                                                                  
006830      MOVE ' '                    TO DC-OPTION-CODE.              
006831      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.              
006832      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.            
006833      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.             
006834                                                                  
006835 3499-EXIT.                                                       
006836     EXIT.                                                        
006837                                                                  
006838     EJECT                                                        
006839                                                                  
006840 3600-CHECK-VERIFICATION.                                         
006841                                                                  
006842     MOVE ELMSTR-KEY             TO ELTRLR-KEY.                   
006843                                                                  
006844     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.                  
006845                                                                  
006846     IF PI-PAYEE-TYPE = 'I'                                       
006847        GO TO 3600-READ-TRAILER.                                  
006848                                                                  
006849     IF PI-PAYEE-TYPE = 'B'                                       
006850        ADD +10                  TO TRLR-SEQ-NO                   
006851        GO TO 3600-READ-TRAILER.                                  
006852                                                                  
006853     IF PI-PAYEE-TYPE = 'A'                                       
006854        ADD +20                  TO TRLR-SEQ-NO                   
006855        GO TO 3600-READ-TRAILER.                                  
006856                                                                  
006857     IF PI-PAYEE-TYPE = 'O'                                       
006858        ADD +50                  TO TRLR-SEQ-NO                   
006859        GO TO 3600-READ-TRAILER.                                  
006860                                                                  
006861     IF PI-PAYEE-TYPE = 'Q'                                       
006862        ADD +60                  TO TRLR-SEQ-NO                   
006863        GO TO 3600-READ-TRAILER.                                  
006864                                                                  
006865     IF PI-PAYEE-TYPE = 'P'                                       
006866        ADD +30                  TO TRLR-SEQ-NO                   
006867        GO TO 3600-READ-TRAILER.                                  
006868                                                                  
006869     IF PI-PAYEE-TYPE = 'E'                                       
006870        ADD +40                  TO TRLR-SEQ-NO.                  
006871                                                                  
006872 3600-READ-TRAILER.                                               
006873                                                                  
006874     EXEC CICS HANDLE CONDITION                                   
006875          NOTFND(3600-CONTINUE)                                   
006876     END-EXEC.                                                    
006877                                                                  
006878     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.                    
006879                                                                  
006880 3600-CONTINUE.                                                   
006881                                                                  
006882     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1 AND 'O'           
006883         GO TO 3600-AH-VERIFY                                     
006884     END-IF.                                                      
006885                                                                  
006886     IF PI-VFY-2ND-BENE = 'L' OR 'B'                              
006887       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'                    
006888         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'                       
006889           MOVE ER-7576            TO EMI-ERROR                   
006890           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               
006891           MOVE -1                 TO PAYEEL                      
006892           MOVE AL-UABON           TO PAYEEA                      
006893           GO TO 3600-EXIT                                        
006894         END-IF                                                   
006895       END-IF                                                     
006896     END-IF.                                                      
006897                                                                  
006898     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.                        
006899     MOVE 1 TO WS-SUB2                                            
006900     MOVE SPACES TO WS-PAYEE-NAME                                 
006901     PERFORM VARYING WS-SUB FROM 1 BY 1                           
006902             UNTIL WS-SUB > 30                                    
006903         IF WS-WORK-NAME-X (WS-SUB) > SPACES                      
006904            MOVE WS-WORK-NAME-X (WS-SUB) TO                       
006905                 WS-PAYEE-NAME-X (WS-SUB2)                        
006906            ADD +1 TO WS-SUB2                                     
006907         END-IF                                                   
006908     END-PERFORM.                                                 
006909                                                                  
006910     STRING CL-INSURED-1ST-NAME                                   
006911            CL-INSURED-MID-INIT                                   
006912            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.               
006913     MOVE 1 TO WS-SUB2                                            
006914     MOVE SPACES TO WS-INSURED-NAME                               
006915     PERFORM VARYING WS-SUB FROM 1 BY 1                           
006916             UNTIL WS-SUB > 30                                    
006917         IF WS-WORK-NAME-X (WS-SUB) > SPACES                      
006918            MOVE WS-WORK-NAME-X (WS-SUB) TO                       
006919                 WS-INSURED-NAME-X (WS-SUB2)                      
006920            ADD +1 TO WS-SUB2                                     
006921         END-IF                                                   
006922     END-PERFORM.                                                 
006923                                                                  
006924     IF CL-CLAIM-TYPE = 'O'                                       
006925        IF WS-PAYEE-NAME (1:6) = 'ESTATE'                         
006926           MOVE ER-7585            TO EMI-ERROR                   
006927           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               
006928           MOVE -1                 TO PAYEEL                      
006929           MOVE AL-UABON           TO PAYEEA                      
006930        ELSE                                                      
006931           GO TO 3600-EXIT                                        
006932        END-IF                                                    
006933     END-IF.                                                      
006934                                                                  
006935     IF WS-PAYEE-NAME = WS-INSURED-NAME                           
006936        MOVE ER-7579            TO EMI-ERROR                      
006937        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  
006938        MOVE -1                 TO PAYEEL                         
006939        MOVE AL-UABON           TO PAYEEA                         
006940     END-IF.                                                      
006941                                                                  
006942     IF PI-PMTTYPE = '4'  AND                                     
006943        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND                     
006944        PI-PAYEE-TYPE <> 'I'                                      
006945          MOVE ER-7580          TO EMI-ERROR                      
006946          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                
006947          MOVE -1               TO PAYEEL                         
006948          MOVE AL-UABON         TO PAYEEA                         
006949     END-IF.                                                      
006950                                                                  
006951     GO TO 3600-EXIT.                                             
006952                                                                  
006953 3600-AH-VERIFY.                                                  
006954                                                                  
006955     IF PI-VFY-2ND-BENE = 'A' OR 'B'                              
006956        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'                        
006957           MOVE ER-7583            TO EMI-ERROR                   
006958           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               
006959           MOVE -1                 TO PAYEEL                      
006960           MOVE AL-UABON           TO PAYEEA                      
006961        END-IF                                                    
006962     END-IF.                                                      
006963                                                                  
006964                                                                  
006965 3600-EXIT.                                                       
006966     EXIT.                                                        
006967                                                                  
006968 5000-UPDATE.                                                     
006969                                                                  
006970     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.             
006971                                                                  
006972     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.               
006973                                                                  
006974     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR               
006975        PI-OFFLINE = 'Y'                                          
006976        NEXT SENTENCE                                             
006977     ELSE                                                         
006978        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.                  
006979                                                                  
006980*    IF PI-COMPANY-ID = 'CRI'                                     
006981*       IF PI-PMTTYPE = '1' OR  '2'                               
006982*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'     
006983*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT    
006984*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.   
006985                                                                  
006986*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'                            
006987*       IF PI-PMTTYPE = '1'                                       
006988*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'     
006989*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.     
006990                                                                  
006991     IF PI-PMTTYPE      = '2' AND                                 
006992        PI-SPLIT-PMT-SW = 'Y' AND                                 
006993        (CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1 OR 'O')            
006994          MOVE ER-3530                TO EMI-ERROR                
006995          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               
006996                                                                  
006997     IF (PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL')                 
006998        AND (CL-CLAIM-TYPE = 'L' OR 'O')                          
006999        IF PI-PMTTYPE = '2' OR '4'                                
007000           IF PI-INT-AMT NOT = ZEROS                              
007001              PERFORM 7110-BUILD-PMT-TRLR                         
007002                                 THRU 7130-EXIT                   
007003           ELSE                                                   
007004              IF PI-PMTTYPE = '2'                                 
007005                 PERFORM 7140-BUILD-NOTE-TRLR                     
007006                                 THRU 7170-EXIT                   
007007              END-IF                                              
007008           END-IF                                                 
007009        END-IF                                                    
007010     END-IF                                                       
007011                                                                  
007012*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
007013*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1                   
007014*            MOVE 'N'                 TO  WS-LETTER-SW.           
007015                                                                  
007016*    IF PI-COMPANY-ID = 'DMD'                                     
007017*        IF CL-NO-OF-PMTS-MADE = +1                               
007018*                OR                                               
007019*           PI-PMTTYPE = '2'                                      
007020*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.              
007021                                                                  
007022     PERFORM 0800-DELETE-TS THRU 0800-EXIT.                       
007023                                                                  
007024*    IF PI-COMPANY-ID = 'DMD'                                     
007025*       IF CL-CERT-NO (5:2) = '69' OR '70'                        
007026*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.            
007027                                                                  
007028     EXEC CICS REWRITE                                            
007029          DATASET('ELMSTR')                                       
007030          FROM(CLAIM-MASTER)                                      
007031      END-EXEC.                                                   
007032                                                                  
007033     IF WS-LETTER-SW = 'N'                                        
007034         GO TO 5000-END-UPDATE.                                   
007035                                                                  
007036 5000-GENERATE-AUTO-LETTER.                                       
007037                                                                  
007038     EXEC CICS LINK                                               
007039         PROGRAM    (LINK-1523)                                   
007040         COMMAREA   (W-1523-LINKDATA)                             
007041         LENGTH     (W-1523-COMM-LENGTH)                          
007042     END-EXEC.                                                    
007043                                                                  
007044     IF W-1523-FATAL-ERROR                                        
007045         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR                
007046         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
007047         MOVE ER-0802                TO  EMI-ERROR                
007048         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                
007049                                                                  
007050     IF W-1523-ERROR-CODE = 0191                                  
007051         MOVE ER-0803                TO  EMI-ERROR                
007052         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                
007053                                                                  
007054     IF PI-COMPANY-ID      = 'HAN' AND                            
007055        PI-PMTTYPE         = '1'   AND                            
007056        PI-3RD-PARTY-SW    = 'Y'   AND                            
007057        W-1523-FORM-NUMBER = 'EOB1'                               
007058           MOVE LOW-VALUES              TO W-1523-LINKDATA        
007059           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA  
007060           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER     
007061           GO TO 5000-GENERATE-AUTO-LETTER.                       
007062                                                                  
007063 5000-END-UPDATE.                                                 
007064                                                                  
007065     MOVE ER-0000                TO EMI-ERROR.                    
007066     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
007067     GO TO 7000-SHOW-CLAIM.                                       
007068                                                                  
007069     EJECT                                                        
007070 5000-MOVE-NAME.                                                  
007071     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.                      
007072     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.                      
007073     MOVE CL-INSURED-MID-INIT    TO MINITO.                       
007074                                                                  
007075 5000-EXIT.                                                       
007076     EXIT.                                                        
007077                                 EJECT                            
007078 5300-CREATE-DMO.                                                 
007079                                                                  
007080     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.              
007081     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.               
007082     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.               
007083                                                                  
007084     EXEC CICS HANDLE CONDITION                                   
007085          NOTFND   (5300-NOTE-NOT-FOUND)                          
007086     END-EXEC.                                                    
007087                                                                  
007088     EXEC CICS READ                                               
007089          DATASET('ERNOTE')                                       
007090          SET    (ADDRESS OF CERTIFICATE-NOTE)                    
007091          RIDFLD (W-NOTE-KEY)                                     
007092     END-EXEC.                                                    
007093                                                                  
007094     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.       
007095     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.     
007096     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.       
007097                                                                  
007098     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES                  
007099         MOVE 'CC'                   TO DCT-PRODUCT-CODE          
007100     ELSE                                                         
007101         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.         
007102                                                                  
007103     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.          
007104     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.      
007105     MOVE 'DLO006'               TO PGM-NAME.                     
007106                                                                  
007107     EXEC CICS LINK                                               
007108         PROGRAM    (PGM-NAME)                                    
007109         COMMAREA   (DCT-COMMUNICATION-AREA)                      
007110         LENGTH     (DCT-RCRD-LENGTH)                             
007111     END-EXEC.                                                    
007112                                                                  
007113     IF DCT-RETURN-CODE = 'OK'                                    
007114         GO TO 5300-CONT.                                         
007115                                                                  
007116     IF DCT-RETURN-CODE = '01' OR '02'                            
007117         GO TO 5300-EXIT.                                         
007118                                                                  
007119     IF DCT-RETURN-CODE = '03'                                    
007120         MOVE ER-0951            TO EMI-ERROR                     
007121         GO TO 5300-BAD-EXIT.                                     
007122                                                                  
007123     IF DCT-RETURN-CODE = '04'                                    
007124         MOVE ER-0946            TO EMI-ERROR                     
007125         GO TO 5300-BAD-EXIT.                                     
007126                                                                  
007127     IF DCT-RETURN-CODE = '05'                                    
007128         MOVE ER-0947            TO EMI-ERROR                     
007129         GO TO 5300-BAD-EXIT.                                     
007130                                                                  
007131     IF DCT-RETURN-CODE = '06'                                    
007132         MOVE ER-0921            TO EMI-ERROR                     
007133         GO TO 5300-BAD-EXIT.                                     
007134                                                                  
007135     IF DCT-RETURN-CODE = '07'                                    
007136         MOVE ER-0849            TO EMI-ERROR                     
007137         GO TO 5300-BAD-EXIT.                                     
007138                                                                  
007139     IF DCT-RETURN-CODE = '08'                                    
007140         MOVE ER-0948            TO EMI-ERROR                     
007141         GO TO 5300-BAD-EXIT.                                     
007142                                                                  
007143     IF DCT-RETURN-CODE = 'N1'                                    
007144         MOVE ER-0950            TO EMI-ERROR                     
007145         GO TO 5300-BAD-EXIT.                                     
007146                                                                  
007147     IF DCT-RETURN-CODE = 'E1'                                    
007148         MOVE ER-0974            TO EMI-ERROR                     
007149         GO TO 5300-BAD-EXIT.                                     
007150                                                                  
007151     IF DCT-RETURN-CODE = 'E2'                                    
007152         MOVE ER-0975            TO EMI-ERROR                     
007153         GO TO 5300-BAD-EXIT.                                     
007154                                                                  
007155     IF DCT-RETURN-CODE NOT = 'OK'                                
007156         MOVE ER-0949            TO EMI-ERROR                     
007157         GO TO 5300-BAD-EXIT.                                     
007158                                                                  
007159 5300-CONT.                                                       
007160                                                                  
007161     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.       
007162     MOVE 'CS'                   TO DM-RECORD-TYPE.               
007163     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.                 
007164     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.                 
007165     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.                  
007166     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.                
007167     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.        
007168     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.               
007169                                                                  
007170     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.                  
007171     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.                 
007172     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.                
007173     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.            
007174     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.              
007175                                                                  
007176     MOVE CL-CARRIER             TO DM-STAT-CARRIER.              
007177                                                                  
007178     IF PI-PMTTYPE = '2'                                          
007179         MOVE 'F'                TO DM-STAT-CHANGE-TYPE           
007180         MOVE '4'                TO DM-CLAIM-STATUS               
007181     ELSE                                                         
007182         MOVE 'I'                TO DM-STAT-CHANGE-TYPE           
007183         MOVE '2'                TO DM-CLAIM-STATUS.              
007184                                                                  
007185     MOVE 'DLO025'               TO PGM-NAME.                     
007186                                                                  
007187     EXEC CICS LINK                                               
007188         PROGRAM    (PGM-NAME)                                    
007189         COMMAREA   (DMO-COMMUNICATION-AREA)                      
007190         LENGTH     (DM-DMO-LENGTH)                               
007191     END-EXEC.                                                    
007192                                                                  
007193     IF DM-RETURN-CODE = 'OK'                                     
007194         GO TO 5300-EXIT.                                         
007195                                                                  
007196     IF DM-RETURN-CODE = '01'                                     
007197         MOVE ER-8051            TO EMI-ERROR                     
007198         GO TO 5300-BAD-EXIT.                                     
007199                                                                  
007200     IF DM-RETURN-CODE = '02'                                     
007201         MOVE ER-8052            TO EMI-ERROR                     
007202         GO TO 5300-BAD-EXIT.                                     
007203                                                                  
007204     IF DM-RETURN-CODE = '03'                                     
007205         MOVE ER-8053            TO EMI-ERROR                     
007206         GO TO 5300-BAD-EXIT.                                     
007207                                                                  
007208     IF DM-RETURN-CODE = '04'                                     
007209         MOVE ER-8054            TO EMI-ERROR                     
007210         GO TO 5300-BAD-EXIT.                                     
007211                                                                  
007212     IF DM-RETURN-CODE = '05'                                     
007213         MOVE ER-8055            TO EMI-ERROR                     
007214         GO TO 5300-BAD-EXIT.                                     
007215                                                                  
007216     IF DM-RETURN-CODE = '06'                                     
007217         MOVE ER-8056            TO EMI-ERROR                     
007218         GO TO 5300-BAD-EXIT.                                     
007219                                                                  
007220     IF DM-RETURN-CODE = '07'                                     
007221         MOVE ER-8057            TO EMI-ERROR                     
007222         GO TO 5300-BAD-EXIT.                                     
007223                                                                  
007224     IF DM-RETURN-CODE = '08'                                     
007225         MOVE ER-8058            TO EMI-ERROR                     
007226         GO TO 5300-BAD-EXIT.                                     
007227                                                                  
007228     IF DM-RETURN-CODE = '09'                                     
007229         MOVE ER-8059            TO EMI-ERROR                     
007230         GO TO 5300-BAD-EXIT.                                     
007231                                                                  
007232     IF DM-RETURN-CODE = '10'                                     
007233         MOVE ER-8060            TO EMI-ERROR                     
007234         GO TO 5300-BAD-EXIT.                                     
007235                                                                  
007236     IF DM-RETURN-CODE = '11'                                     
007237         MOVE ER-8061            TO EMI-ERROR                     
007238         GO TO 5300-BAD-EXIT.                                     
007239                                                                  
007240     IF DM-RETURN-CODE = '12'                                     
007241         MOVE ER-8062            TO EMI-ERROR                     
007242         GO TO 5300-BAD-EXIT.                                     
007243                                                                  
007244     IF DM-RETURN-CODE = '13'                                     
007245         MOVE ER-8063            TO EMI-ERROR                     
007246         GO TO 5300-BAD-EXIT.                                     
007247                                                                  
007248     IF DM-RETURN-CODE = '14'                                     
007249         MOVE ER-8064            TO EMI-ERROR                     
007250         GO TO 5300-BAD-EXIT.                                     
007251                                                                  
007252     IF DM-RETURN-CODE = '15'                                     
007253         MOVE ER-8065            TO EMI-ERROR                     
007254         GO TO 5300-BAD-EXIT.                                     
007255                                                                  
007256     IF DM-RETURN-CODE = '16'                                     
007257         MOVE ER-8154            TO EMI-ERROR                     
007258         GO TO 5300-BAD-EXIT.                                     
007259                                                                  
007260     IF DM-RETURN-CODE = '17'                                     
007261         MOVE ER-8155            TO EMI-ERROR                     
007262         GO TO 5300-BAD-EXIT.                                     
007263                                                                  
007264     IF DM-RETURN-CODE = 'N1'                                     
007265         MOVE ER-8152            TO EMI-ERROR                     
007266         GO TO 5300-BAD-EXIT.                                     
007267                                                                  
007268     IF DM-RETURN-CODE = 'E1'                                     
007269         MOVE ER-8153            TO EMI-ERROR                     
007270         GO TO 5300-BAD-EXIT.                                     
007271                                                                  
007272     MOVE ER-8066            TO EMI-ERROR.                        
007273     GO TO 5300-BAD-EXIT.                                         
007274                                                                  
007275 5300-NOTE-NOT-FOUND.                                             
007276                                                                  
007277     MOVE ER-0954                TO EMI-ERROR.                    
007278     GO TO 5300-BAD-EXIT.                                         
007279                                                                  
007280 5300-BAD-EXIT.                                                   
007281     EXEC CICS SYNCPOINT ROLLBACK END-EXEC.                       
007282     IF MAP-NAME = 'EL156A'                                       
007283         MOVE -1             TO ENTERPFL                          
007284       ELSE                                                       
007285         MOVE LOW-VALUES     TO EL156BI                           
007286         MOVE -1             TO ENTPFBL.                          
007287                                                                  
007288     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
007289     GO TO 8200-SEND-DATAONLY.                                    
007290                                                                  
007291 5300-EXIT.                                                       
007292     EXIT.                                                        
007293                                 EJECT                            
007294 5350-FORMAT-LAST-NAME-1ST.                                       
007295***************************************************************** 
007296*             M O V E   N A M E   R O U T I N E                 * 
007297*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          * 
007298*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            * 
007299*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           * 
007300*                  FIELD                   VALUE                * 
007301*           W-NAME-LAST    (CL15)      SMITH                    * 
007302*           W-NAME-FIRST   (CL15)      JOHN                     * 
007303*           W-NAME-MIDDLE  (CL15)      ALLEN                    * 
007304*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        * 
007305*     CONTAIN                                                   * 
007306*                SMITH, JOHN ALLEN                              * 
007307*     OR                                                        * 
007308*                SMITH, JOHN A.                                 * 
007309*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          * 
007310*     COPYBOOK, ELCNWA.                                         * 
007311*****************************************************************.
007312                                                                  
007313     MOVE SPACES                 TO  WS-NAME-WORK-AREA.           
007314     MOVE ZERO                   TO  WS-NAME-SW.                  
007315     SET NWA-INDEX               TO +1.                           
007316                                                                  
007317     IF W-NAME-LAST   = SPACES AND                                
007318        W-NAME-MIDDLE = SPACES                                    
007319         MOVE +1                 TO WS-NAME-SW.                   
007320                                                                  
007321     MOVE W-NAME-LAST            TO WS-NAME-WORK2.                
007322     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.                       
007323                                                                  
007324     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.                
007325     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.                       
007326                                                                  
007327     SET NWA-INDEX UP BY +1.                                      
007328                                                                  
007329     IF W-NAME-MIDDLE NOT = SPACES                                
007330         IF W-NAME-MIDDLE-2 = SPACES                              
007331             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)             
007332             SET NWA-INDEX UP BY +1                               
007333             MOVE '.'            TO WS-NW (NWA-INDEX)             
007334             SET NWA-INDEX UP BY +2                               
007335         ELSE                                                     
007336             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2                 
007337             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.               
007338                                                                  
007339 5350-EXIT.                                                       
007340     EXIT.                                                        
007341                                 EJECT                            
007342 5360-MOVE-NAME.                                                  
007343                                                                  
007344     IF WS-NAME-SW > +1                                           
007345         GO TO 5360-EXIT.                                         
007346                                                                  
007347     IF WS-NAME-WORK2 = SPACES                                    
007348         GO TO 5360-EXIT.                                         
007349                                                                  
007350     SET NWA-INDEX2            TO +1.                             
007351     SET NWA-INDEX3            TO +2.                             
007352                                                                  
007353 5360-MOVE-NAME-CYCLE.                                            
007354                                                                  
007355     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).             
007356                                                                  
007357     IF NWA-INDEX < +30                                           
007358         SET NWA-INDEX UP BY +1                                   
007359     ELSE                                                         
007360         ADD +2                TO  WS-NAME-SW                     
007361         GO TO 5360-EXIT.                                         
007362                                                                  
007363     IF NWA-INDEX2 < +20                                          
007364         SET NWA-INDEX3 UP BY +1                                  
007365         SET NWA-INDEX2 UP BY +1.                                 
007366                                                                  
007367     IF WS-NW2 (NWA-INDEX2) = SPACES AND                          
007368        WS-NW2 (NWA-INDEX3) = SPACES                              
007369         IF WS-NAME-SW = ZERO                                     
007370             MOVE ','            TO  WS-NW (NWA-INDEX)            
007371             SET NWA-INDEX UP BY +2                               
007372             MOVE +1             TO  WS-NAME-SW                   
007373             GO TO 5360-EXIT                                      
007374         ELSE                                                     
007375             GO TO 5360-EXIT.                                     
007376                                                                  
007377     GO TO 5360-MOVE-NAME-CYCLE.                                  
007378                                                                  
007379 5360-EXIT.                                                       
007380     EXIT.                                                        
007381                                 EJECT                            
007382 6000-BUILD-SCREEN-B.                                             
007383     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.                 
007384     MOVE PI-CARRIER             TO MSTR-CARRIER.                 
007385     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.                
007386     MOVE PI-CERT-NO             TO MSTR-CERT-NO.                 
007387                                                                  
007388     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.                      
007389                                                                  
007390 6050-BUILD-SCREEN.                                               
007391     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.             
007392     MOVE LOW-VALUES             TO EL156BI.                      
007393     MOVE ELMSTR-KEY             TO ELTRLR-KEY.                   
007394                                                                  
007395     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.                  
007396                                                                  
007397     IF PI-PAYEE-TYPE = 'I'                                       
007398        GO TO 6060-READ-TRAILER.                                  
007399                                                                  
007400     IF PI-PAYEE-TYPE = 'B'                                       
007401        ADD +10                  TO TRLR-SEQ-NO                   
007402        GO TO 6060-READ-TRAILER.                                  
007403                                                                  
007404     IF PI-PAYEE-TYPE = 'A'                                       
007405        ADD +20                  TO TRLR-SEQ-NO                   
007406        GO TO 6060-READ-TRAILER.                                  
007407                                                                  
007408     IF PI-PAYEE-TYPE = 'O'                                       
007409        ADD +50                  TO TRLR-SEQ-NO                   
007410        GO TO 6060-READ-TRAILER.                                  
007411                                                                  
007412     IF PI-PAYEE-TYPE = 'Q'                                       
007413        ADD +60                  TO TRLR-SEQ-NO                   
007414        GO TO 6060-READ-TRAILER.                                  
007415                                                                  
007416     IF PI-PAYEE-TYPE = 'P'                                       
007417        ADD +30                  TO TRLR-SEQ-NO                   
007418        GO TO 6060-READ-TRAILER.                                  
007419                                                                  
007420     IF PI-PAYEE-TYPE = 'E'                                       
007421        ADD +40                  TO TRLR-SEQ-NO.                  
007422                                                                  
007423 6060-READ-TRAILER.                                               
007424                                                                  
007425     IF PI-PAYEE-TYPE    = 'A' AND                                
007426        PI-PAYEE-SEQ-NUM = 0                                      
007427          GO TO 6061-READ-ACCOUNT.                                
007428                                                                  
007429     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND                  
007430        (PI-PAYEE-TYPE    = 'B')             AND                  
007431        (PI-PAYEE-SEQ-NUM = 9)                                    
007432          PERFORM 7920-READ-BENE THRU 7920-EXIT                   
007433          IF BENE-FOUND-SW = 'N'                                  
007434            GO TO 6065-NOT-FOUND                                  
007435          ELSE                                                    
007436            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO       
007437            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO                     
007438            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO                     
007439*           MOVE BE-CITY-STATE     TO CITYSTBO                    
007440            STRING BE-CITY ' ' BE-STATE                           
007441               DELIMITED BY '  ' INTO CITYSTBO                    
007442            END-STRING                                            
007443            MOVE BE-ZIP-CODE       TO ZIPBO                       
007444            GO TO 6061-READ-ACCOUNT.                              
007445                                                                  
007446     IF PI-PAYEE-TYPE    = 'B' AND                                
007447        PI-PAYEE-SEQ-NUM = 0                                      
007448          PERFORM 7920-READ-BENE THRU 7920-EXIT                   
007449          IF BENE-FOUND-SW = 'N'                                  
007450            GO TO 6065-NOT-FOUND                                  
007451          ELSE                                                    
007452            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO       
007453            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO                     
007454            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO                     
007455*           MOVE BE-CITY-STATE     TO CITYSTBO                    
007456            STRING BE-CITY ' ' BE-STATE                           
007457               DELIMITED BY '  ' INTO CITYSTBO                    
007458            END-STRING                                            
007459            MOVE BE-ZIP-CODE       TO ZIPBO                       
007460            if be-ach-yes-or-no = 'Y'                             
007461               move 'Y'          to pi-ach-payment                
007462            else                                                  
007463               move 'N'          to pi-ach-payment                
007464            end-if                                                
007465            GO TO 6061-READ-ACCOUNT.                              
007466                                                                  
007467     EXEC CICS HANDLE CONDITION                                   
007468          NOTFND(6065-NOT-FOUND)                                  
007469      END-EXEC.                                                   
007470                                                                  
007471     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.                    
007472                                                                  
007473     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.                
007474     MOVE AT-MAIL-TO-NAME        TO NAMEBO.                       
007475     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.                      
007476     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.                      
007477*    MOVE AT-CITY-STATE          TO CITYSTBO.                     
007478     STRING AT-CITY ' ' AT-STATE                                  
007479        DELIMITED BY '  ' INTO CITYSTBO                           
007480     END-STRING                                                   
007481     MOVE AT-ZIP-CODE            TO ZIPBO.                        
007482                                                                  
007483 6061-READ-ACCOUNT.                                               
007484     EXEC CICS HANDLE CONDITION                                   
007485          NOTFND(6068-ACCT-NOT-FND)                               
007486      END-EXEC.                                                   
007487                                                                  
007488     EXEC CICS READ                                               
007489          DATASET('ERACCT')                                       
007490          SET    (ADDRESS OF ACCOUNT-MASTER)                      
007491          RIDFLD (PI-ACCT-KEY)                                    
007492      END-EXEC.                                                   
007493                                                                  
007494     MOVE AM-CARRIER             TO ACARRBO.                      
007495     MOVE AM-GROUPING            TO GROUPBO.                      
007496     MOVE AM-STATE               TO STATEBO.                      
007497     MOVE AM-ACCOUNT             TO ACCTBO.                       
007498     MOVE AM-NAME                TO ACCTNMBO.                     
007499                                                                  
007500     IF PI-PAYEE-TYPE = 'A' AND                                   
007501        PI-PAYEE-SEQ-NUM = 0                                      
007502          MOVE AM-NAME             TO NAMEBO                      
007503                                      PI-PAYEE-NAME               
007504          MOVE AM-ADDRS            TO ADDR1BO                     
007505          MOVE SPACES              TO ADDR2BO                     
007506*         MOVE AM-CITY             TO CITYSTBO                    
007507          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE                   
007508             DELIMITED BY '  ' INTO CITYSTBO                      
007509          END-STRING                                              
007510          MOVE AM-ZIP-PRIME        TO WS-ZIP                      
007511          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT                  
007512          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'         
007513          MOVE WS-NUMERIC-ZIP      TO ZIPBO.                      
007514                                                                  
007515                                                                  
007516***  We don't really need the code below because we don't do the  
007517***  AK thing anymore.  However, we may have a state special      
007518***  of some sort in the future so why not just leave it??        
007519                                                                  
007520     IF CITYSTBO EQUAL SPACES                                     
007521         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK                       
007522         GO TO 6070-FORMAT-DATA                                   
007523     END-IF.                                                      
007524                                                                  
007525     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.                        
007526     MOVE 'N' TO WS-PAYEE-STATE-FOUND.                            
007527     MOVE 0 TO WS-BEG-SUB WS-END-SUB.                             
007528     PERFORM VARYING WS-SUB FROM 30 BY -1                         
007529          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND                   
007530        IF WS-END-SUB = 0  AND                                    
007531           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES                
007532              OR LOW-VALUES  OR '.')                              
007533            CONTINUE                                              
007534        ELSE                                                      
007535            IF WS-END-SUB = 0                                     
007536                MOVE WS-SUB TO WS-END-SUB                         
007537            ELSE                                                  
007538                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES             
007539                    COMPUTE WS-BEG-SUB = WS-SUB + 1               
007540                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND              
007541                END-IF                                            
007542            END-IF                                                
007543        END-IF                                                    
007544        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','                    
007545            COMPUTE WS-BEG-SUB = WS-SUB + 1                       
007546            MOVE 'Y' TO WS-PAYEE-STATE-FOUND                      
007547        END-IF                                                    
007548     END-PERFORM.                                                 
007549                                                                  
007550     IF WS-BEG-SUB > 0                                            
007551         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1    
007552         IF WS-STATE-LENGTH = 2                                   
007553             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
007554                  TO PI-CHECK-STATE-FOR-AK                        
007555         ELSE                                                     
007556             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
007557                'ALASKA'                                          
007558                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK               
007559             ELSE                                                 
007560                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK               
007561             END-IF                                               
007562         END-IF                                                   
007563     ELSE                                                         
007564         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK                       
007565     END-IF.                                                      
007566                                                                  
007567     GO TO 6070-FORMAT-DATA.                                      
007568                                                                  
007569 6065-NOT-FOUND.                                                  
007570     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.                  
007571     GO TO 6061-READ-ACCOUNT.                                     
007572                                                                  
007573 6068-ACCT-NOT-FND.                                               
007574     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.                 
007575                                                                  
007576 6070-FORMAT-DATA.                                                
007577     IF PI-HOLDTIL = ZEROS                                        
007578        MOVE SAVE-DATE           TO PAYDTBI                       
007579       ELSE                                                       
007580        MOVE PI-HOLDTIL          TO PAYDTBO                       
007581        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.              
007582                                                                  
007583     MOVE PI-PROOF-DATE          TO PROOFDBO.                     
007584     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.                
007585                                                                  
007586     IF EIBAID = DFHPF3 OR DFHPF4                                 
007587        NEXT SENTENCE                                             
007588     ELSE                                                         
007589       GO TO 6071-CONTINUE.                                       
007590                                                                  
007591     MOVE PI-EPYFROM          TO PYFROMBO.                        
007592     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.                
007593                                                                  
007594     IF NOT PI-USES-PAID-TO                                       
007595        MOVE PI-EPYTHRU          TO PYTHRUBO                      
007596        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'              
007597     ELSE                                                         
007598        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY               
007599        MOVE '4'              TO DC-OPTION-CODE                   
007600        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT             
007601        IF NO-CONVERSION-ERROR                                    
007602           MOVE +1            TO DC-ELAPSED-DAYS                  
007603           MOVE +0            TO DC-ELAPSED-MONTHS                
007604           MOVE '6'           TO DC-OPTION-CODE                   
007605           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT          
007606           IF NO-CONVERSION-ERROR                                 
007607              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.               
007608                                                                  
007609     MOVE PI-EDAYS            TO DAYSBO.                          
007610     MOVE PI-EPYAMT           TO PAYAMTBO.                        
007611     IF PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL'                   
007612        IF PI-INT-AMT > ZEROS                                     
007613           MOVE PI-INT-AMT       TO INTAMTBO                      
007614        END-IF                                                    
007615     END-IF                                                       
007616                                                                  
007617     GO TO 6072-SET-TYPE.                                         
007618                                                                  
007619 6071-CONTINUE.                                                   
007620                                                                  
007621     IF PI-CPYFROM NOT = LOW-VALUES                               
007622        MOVE PI-CPYFROM          TO DC-BIN-DATE-1                 
007623        MOVE SPACES              TO DC-OPTION-CODE                
007624        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT             
007625        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.                     
007626                                                                  
007627     IF PI-CPYTHRU NOT = LOW-VALUES                               
007628        IF NOT PI-USES-PAID-TO                                    
007629           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1               
007630           MOVE SPACES             TO DC-OPTION-CODE              
007631           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT          
007632           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI                   
007633        ELSE                                                      
007634           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1               
007635           MOVE '6'                TO DC-OPTION-CODE              
007636           MOVE +1                 TO DC-ELAPSED-DAYS             
007637           MOVE +0                 TO DC-ELAPSED-MONTHS           
007638           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT          
007639           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.                  
007640                                                                  
007641     MOVE PI-CDAYS               TO DAYSBO.                       
007642     MOVE PI-CPYAMT              TO PAYAMTBO.                     
007643     IF PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL'                   
007644        IF PI-INT-AMT > ZEROS                                     
007645           MOVE PI-INT-AMT       TO INTAMTBO                      
007646        END-IF                                                    
007647     END-IF                                                       
007648                                                                  
007649     .                                                            
007650 6072-SET-TYPE.                                                   
007651     IF PI-PMTTYPE = '1'                                          
007652        MOVE 'PARTIAL'           TO PAYTYPBO.                     
007653                                                                  
007654     IF PI-PMTTYPE = '2'                                          
007655        MOVE 'FINAL'             TO PAYTYPBO.                     
007656                                                                  
007657     IF PI-PMTTYPE = '3'                                          
007658        MOVE 'LUMP SUM'          TO PAYTYPBO.                     
007659                                                                  
007660     IF PI-PMTTYPE = '4'                                          
007661        MOVE 'ADDITIONAL'        TO PAYTYPBO.                     
007662                                                                  
007663     IF PI-PMTTYPE = '5'                                          
007664        MOVE 'CHARGEABLE'        TO PAYTYPBO.                     
007665                                                                  
007666     IF PI-PMTTYPE = '6'                                          
007667        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.                     
007668                                                                  
007669     IF PI-PROV-PMT                                               
007670        MOVE 'PROVISIONAL   '    TO PAYTYPBO.                     
007671                                                                  
007672     IF PI-ECHECKNO NOT = SPACES                                  
007673        MOVE PI-ECHECKNO         TO CKNUMBO                       
007674     ELSE                                                         
007675        MOVE PI-CCHECKNO         TO CKNUMBO.                      
007676                                                                  
007677     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'          
007678           OR 'FNL'                                               
007679        MOVE ELMSTR-KEY          TO  ELTRLR-KEY                   
007680        MOVE +91                 TO  TRLR-SEQ-NO                  
007681        EXEC CICS READ                                            
007682            DATASET  ('ELTRLR')                                   
007683            SET      (ADDRESS OF ACTIVITY-TRAILERS)               
007684            RIDFLD   (ELTRLR-KEY)                                 
007685            RESP     (WS-RESPONSE)                                
007686        END-EXEC                                                  
007687                                                                  
007688        IF WS-RESP-NORMAL                                         
007689           MOVE AT-INFO-LINE-1   TO  LOANNBO                      
007690        ELSE                                                      
007691           MOVE SPACES           TO  LOANNBO                      
007692        END-IF                                                    
007693     END-IF                                                       
007694                                                                  
007695*       MOVE PI-LOAN-NO          TO LOANNBO                       
007696                                                                  
007697     IF CKNUMBO = SPACES                                          
007698         MOVE SPACES             TO CKNUMHDO.                     
007699                                                                  
007700     MOVE CL-CLAIM-NO            TO CLMNOBO.                      
007701     MOVE CL-CARRIER             TO CARRBO.                       
007702     MOVE CL-CERT-PRIME          TO CERTNOBO.                     
007703     MOVE CL-CERT-SFX            TO SUFXBO.                       
007704                                                                  
007705     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'    
007706                                          OR 'B' or 'H'           
007707                                                                  
007708        EVALUATE CL-CLAIM-TYPE                                    
007709           WHEN 'I'                                               
007710              MOVE '  IU  '      TO CLMTYPBO                      
007711           WHEN 'G'                                               
007712              MOVE ' GAP  '      TO CLMTYPBO                      
007713           WHEN 'F'                                               
007714              MOVE ' FMLA '      TO CLMTYPBO                      
007715           WHEN 'B'                                               
007716              MOVE ' BRV  '      TO CLMTYPBO                      
007717           WHEN 'H'                                               
007718              MOVE ' HOSP '      TO CLMTYPBO                      
007719           WHEN OTHER                                             
007720              MOVE PI-AH-OVERRIDE-L6                              
007721                                 TO CLMTYPBO                      
007722        END-EVALUATE                                              
007723                                                                  
007724        MOVE ZEROS               TO UNDISBO                       
007725*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO                      
007726        IF PI-PMTTYPE = '5' OR '6'                                
007727           GO TO 6073-GET-NOTIFY-DATA                             
007728        ELSE                                                      
007729           MOVE PI-DAILY-RATE    TO RATEBO                        
007730           GO TO 6073-GET-NOTIFY-DATA.                            
007731                                                                  
007732     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.                     
007733                                                                  
007734     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5              
007735        MOVE ZEROS               TO UNDISBO                       
007736     ELSE                                                         
007737        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.                  
007738                                                                  
007739 6073-GET-NOTIFY-DATA.                                            
007740                                                                  
007741     MOVE 'N'                    TO  PI-3RD-PARTY-SW.             
007742                                                                  
007743     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'                            
007744         MOVE SPACES             TO  NAMEB2O                      
007745                                     ADDR1B2O                     
007746                                     ADDR2B2O                     
007747                                     CITYST2O                     
007748                                     AGTHDGO                      
007749         MOVE ZEROS              TO  ZIPB2O                       
007750         GO TO 6080-SET-INCURRED.                                 
007751                                                                  
007752     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.                  
007753     MOVE +29                    TO  TRLR-SEQ-NO.                 
007754                                                                  
007755     EXEC CICS HANDLE CONDITION                                   
007756         NOTFND   (6074-GET-COMP-DATA)                            
007757     END-EXEC.                                                    
007758                                                                  
007759     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.                    
007760                                                                  
007761     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.                     
007762     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.                    
007763     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.                    
007764*    MOVE AT-CITY-STATE          TO  CITYST2O.                    
007765     STRING AT-CITY ' ' AT-STATE                                  
007766        DELIMITED BY '  ' INTO CITYST2O                           
007767     END-STRING                                                   
007768     MOVE AT-ZIP-CODE            TO  ZIPB2O.                      
007769     GO TO 6080-SET-INCURRED.                                     
007770                                                                  
007771 6074-GET-COMP-DATA.                                              
007772                                                                  
007773     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC                   
007774         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.    
007775                                                                  
007776     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES       
007777         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O                  
007778                                         ADDR1B2O                 
007779                                         ADDR2B2O                 
007780                                         CITYST2O                 
007781         MOVE ZEROS                  TO  ZIPB2O                   
007782         GO TO 6080-SET-INCURRED.                                 
007783                                                                  
007784     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.             
007785     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.                
007786     MOVE AM-CARRIER             TO  COMP-CARRIER.                
007787     MOVE AM-GROUPING            TO  COMP-GROUP.                  
007788     MOVE 'A'                    TO  COMP-TYPE.                   
007789     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)                       
007790                                 TO  COMP-FIN-RESP.               
007791                                                                  
007792     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO                    
007793         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR              
007794                                       'G' OR 'B' or 'S'          
007795             MOVE 'G'            TO  COMP-TYPE                    
007796             MOVE LOW-VALUES     TO  COMP-ACCOUNT                 
007797         ELSE                                                     
007798             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)               
007799                                 TO  COMP-ACCOUNT                 
007800     ELSE                                                         
007801         MOVE 'G'                TO  COMP-TYPE                    
007802         MOVE LOW-VALUES         TO  COMP-ACCOUNT.                
007803                                                                  
007804     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.             
007805                                                                  
007806     IF COMP-REC-FOUND                                            
007807         MOVE CO-ACCT-NAME       TO  NAMEB2O                      
007808         MOVE CO-ADDR-1          TO  ADDR1B2O                     
007809         MOVE CO-ADDR-2          TO  ADDR2B2O                     
007810*        MOVE CO-ADDR-3          TO  CITYST2O                     
007811         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE                    
007812            DELIMITED BY '  ' INTO CITYST2O                       
007813         END-STRING                                               
007814         MOVE CO-ZIP             TO  ZIPB2O                       
007815     ELSE                                                         
007816         MOVE 'NO COMP ADDRESS AVAILABLE'                         
007817                                 TO  NAMEB2O                      
007818                                     ADDR1B2O                     
007819                                     ADDR2B2O                     
007820                                     CITYST2O                     
007821         MOVE ZEROS               TO ZIPB2O.                      
007822                                                                  
007823 6080-SET-INCURRED.                                               
007824     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.                
007825     MOVE SPACES                 TO DC-OPTION-CODE.               
007826     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
007827     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.                      
007828     MOVE PI-PROCESSOR-ID        TO BYBO.                         
007829     MOVE MAP-NAMEB              TO MAP-NAME.                     
007830     MOVE 'C'                    TO PI-PASS-SW.                   
007831     MOVE EIBAID                 TO PI-PFKEY-USED.                
007832     MOVE -1                     TO ENTPFBL.                      
007833     GO TO 8100-SEND-INITIAL-MAP.                                 
007834                                                                  
007835     EJECT                                                        
007836 6100-BUILD-PAYMENT-TRAILER.                                      
007837                                                                  
007838     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
007839     MOVE '6'                    TO CNTL-REC-TYPE.                
007840                                                                  
007841     IF CONTROL-IS-ACTUAL-CARRIER                                 
007842         MOVE PI-CARRIER         TO WS-CARR                       
007843     ELSE                                                         
007844         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.                
007845                                                                  
007846     IF PI-COMPANY-ID = 'FIA'                                     
007847         MOVE PI-CARRIER         TO  WS-CARR.                     
007848                                                                  
007849     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  
007850     MOVE 0                      TO CNTL-SEQ-NO.                  
007851     MOVE 'CARR'                 TO FILE-SWITCH.                  
007852                                                                  
007853     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.                    
007854                                                                  
007855     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
007856         IF PI-OFFLINE     = 'Y' AND                              
007857            PI-ECHECKNO-CR = 'CR'                                 
007858              GO TO 6110-READ-CONTROL                             
007859         ELSE                                                     
007860            IF PI-CASH = 'N'                                      
007861                GO TO 6110-READ-CONTROL.                          
007862                                                                  
007863     IF CHECK-NO-MANUAL    OR                                     
007864        CHECK-NO-AT-PRINT  OR                                     
007865        PI-OFFLINE = 'Y'                                          
007866          GO TO 6130-BUILD-TRAILER.                               
007867                                                                  
007868     IF PI-COMPANY-ID = 'FIA'                                     
007869         NEXT SENTENCE                                            
007870     ELSE                                                         
007871         IF NOT CONTROL-IS-ACTUAL-CARRIER                         
007872             GO TO 6110-READ-CONTROL.                             
007873                                                                  
007874     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.             
007875                                                                  
007876     IF CHECK-CNT-RESET-VALUE                                     
007877        MOVE +1                  TO CF-CHECK-COUNTER              
007878     ELSE                                                         
007879        ADD +1                   TO CF-CHECK-COUNTER.             
007880                                                                  
007881     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.             
007882                                                                  
007883     IF CHECK-NO-CARR-SEQ                                         
007884        MOVE PI-CARRIER          TO WS-CHECK-CARR.                
007885                                                                  
007886     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.                  
007887                                                                  
007888     MOVE 'N' TO PI-REAUDIT-NEEDED.                               
007889     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND     
007890        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO                       
007891         MOVE 'Y' TO PI-REAUDIT-NEEDED                            
007892         COMPUTE WRK-NEXT-AUDIT-CHK-NO =                          
007893            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL                
007894         MOVE WRK-NEXT-AUDIT-CHK-NO TO                            
007895                      CF-CARRIER-NEXT-AUDIT-CHK-NO                
007896     END-IF.                                                      
007897                                                                  
007898     GO TO 6120-REWRITE.                                          
007899                                                                  
007900 6105-STATE-CHECK-NUMBER.                                         
007901     IF CHECK-NO-MANUAL    OR                                     
007902        CHECK-NO-AT-PRINT  OR                                     
007903        PI-OFFLINE = 'Y'                                          
007904           GO TO 6130-BUILD-TRAILER                               
007905     END-IF.                                                      
007906                                                                  
007907     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.                     
007908     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.                  
007909     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.                      
007910     MOVE '3'                TO CNTL-REC-TYPE.                    
007911     MOVE +0                 TO CNTL-SEQ-NO.                      
007912     MOVE 'STAT'             TO FILE-SWITCH.                      
007913     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.             
007914                                                                  
007915     IF CF-ST-CHECK-CNT-RESET                                     
007916         MOVE +1             TO CF-ST-CHECK-COUNTER               
007917     ELSE                                                         
007918         ADD +1              TO CF-ST-CHECK-COUNTER               
007919     END-IF.                                                      
007920                                                                  
007921     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.                
007922     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.                     
007923     GO TO 6120-REWRITE.                                          
007924                                                                  
007925 6110-READ-CONTROL.                                               
007926     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
007927     MOVE '1'                    TO CNTL-REC-TYPE.                
007928     MOVE SPACES                 TO CNTL-ACCESS.                  
007929     MOVE 0                      TO CNTL-SEQ-NO.                  
007930                                                                  
007931     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.             
007932                                                                  
007933     IF CO-CHECK-COUNT-RESET                                      
007934        MOVE +1                  TO CF-CO-CHECK-COUNTER           
007935     ELSE                                                         
007936        ADD +1                   TO CF-CO-CHECK-COUNTER.          
007937                                                                  
007938     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.             
007939                                                                  
007940     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
007941         IF PI-OFFLINE     = 'Y'  AND                             
007942            PI-ECHECKNO-CR = 'CR'                                 
007943              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5            
007944              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO     
007945              MOVE AL-UANON           TO CHECKNOA                 
007946              GO TO 6120-REWRITE                                  
007947         ELSE                                                     
007948         IF PI-CASH = 'N'                                         
007949             MOVE 'N'                TO PI-ECHECKNO-N             
007950             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6             
007951             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO      
007952             MOVE AL-UANON           TO CHECKNOA                  
007953             GO TO 6120-REWRITE.                                  
007954                                                                  
007955     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.                  
007956                                                                  
007957 6120-REWRITE.                                                    
007958     EXEC CICS REWRITE                                            
007959          DATASET('ELCNTL')                                       
007960          FROM(CONTROL-FILE)                                      
007961      END-EXEC.                                                   
007962                                                                  
007963     MOVE 'Y'                    TO PI-CK-ASSIGN.                 
007964                                                                  
007965     EJECT                                                        
007966 6130-BUILD-TRAILER.                                              
007967                                                                  
007968     EXEC CICS GETMAIN                                            
007969          SET       (ADDRESS OF ACTIVITY-TRAILERS)                
007970          LENGTH    (200)                                         
007971          INITIMG   (GETMAIN-SPACE)                               
007972      END-EXEC.                                                   
007973                                                                  
007974     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT           
007975                                    AT-PREV-PAID-THRU-DT.         
007976     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.              
007977     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.         
007978     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.           
007979     MOVE 'AT'                   TO AT-RECORD-ID.                 
007980     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.               
007981                                                                  
007982     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND                  
007983        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)                      
007984           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO        
007985     ELSE                                                         
007986           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO        
007987           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.       
007988                                                                  
007989     IF PI-COMPANY-ID = 'LAP' OR 'RMC'                            
007990         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO                         
007991             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO            
007992             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO            
007993           ELSE                                                   
007994             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO    
007995             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.   
007996                                                                  
007997     MOVE '2'                    TO AT-TRAILER-TYPE.              
007998     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT                
007999                                    AT-PAYMENT-LAST-MAINT-DT.     
008000     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY                
008001                                    AT-PAYMENT-LAST-UPDATED-BY.   
008002     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.         
008003     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.              
008004     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.                
008005     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.           
008006                                                                  
008007     IF PI-PMT-APPROVED                                           
008008        IF PI-OFFLINE  = 'N'                                      
008009           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.       
008010                                                                  
008011     IF PI-PFKEY-USED = DFHPF5                                    
008012        GO TO 6140-PF5-ENTERED.                                   
008013                                                                  
008014     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.           
008015     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.               
008016                                                                  
008017     IF PI-AIG-SPECIAL-BENEFIT                                    
008018         IF WS-1ST-SPECIAL-PMT                                    
008019             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5     
008020             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -               
008021                                        AT-AMOUNT-PAID            
008022         ELSE                                                     
008023             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.             
008024                                                                  
008025     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.              
008026                                                                  
008027     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.           
008028     MOVE '4'                    TO DC-OPTION-CODE.               
008029     PERFORM 9700-LINK-DATE-CONVERT.                              
008030                                                                  
008031     IF DATE-CONVERSION-ERROR                                     
008032        MOVE LOW-VALUES          TO AT-PAID-FROM-DT               
008033     ELSE                                                         
008034        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.              
008035                                                                  
008036     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.           
008037     MOVE '4'                    TO DC-OPTION-CODE.               
008038     PERFORM 9700-LINK-DATE-CONVERT.                              
008039                                                                  
008040     IF DATE-CONVERSION-ERROR                                     
008041        MOVE LOW-VALUES          TO AT-PAID-THRU-DT               
008042     ELSE                                                         
008043        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.              
008044                                                                  
008045     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD             
008046     move pi-ach-payment         to at-ach-payment                
008047     GO TO 6150-FINISH-MOVE.                                      
008048                                                                  
008049 6140-PF5-ENTERED.                                                
008050     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.           
008051     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.               
008052                                                                  
008053     IF PI-AIG-SPECIAL-BENEFIT                                    
008054         IF WS-1ST-SPECIAL-PMT                                    
008055             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5     
008056             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -               
008057                                        AT-AMOUNT-PAID            
008058         ELSE                                                     
008059             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.             
008060                                                                  
008061     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.              
008062     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.              
008063     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.            
008064                                                                  
008065 6150-FINISH-MOVE.                                                
008066                                                                  
008067     IF PI-ECHECKNO = SPACES                                      
008068         MOVE PI-CCHECKNO    TO AT-CHECK-NO                       
008069     ELSE                                                         
008070         MOVE PI-ECHECKNO    TO AT-CHECK-NO.                      
008071                                                                  
008072     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.             
008073     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.               
008074                                                                  
008075*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.           
008076*    MOVE PI-CASH                TO AT-CASH-PAYMENT.              
008077                                                                  
008078     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
008079         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.                
008080                                                                  
008081     IF PI-OFFLINE = 'N'                                          
008082        MOVE '1'                 TO AT-PAYMENT-ORIGIN             
008083        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT              
008084     ELSE                                                         
008085        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT              
008086        MOVE '3'                 TO AT-PAYMENT-ORIGIN.            
008087                                                                  
008088     move pi-ach-payment         to at-ach-payment                
008089     MOVE SPACES                 TO AT-AIG-UNEMP-IND.             
008090                                                                  
008091     IF WS-2ND-SPECIAL-PMT                                        
008092         MOVE 'Y'                TO AT-CASH-PAYMENT               
008093         MOVE SPACES             TO AT-CHECK-NO                   
008094         MOVE '3'                TO AT-PAYMENT-ORIGIN             
008095         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT              
008096         MOVE 'U'                TO AT-AIG-UNEMP-IND              
008097         MOVE 'I'                TO AT-PAYEE-TYPE-CD.             
008098                                                                  
008099     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT           
008100                                    AT-TO-BE-WRITTEN-DT.          
008101                                                                  
008102     IF PI-HOLDTIL NOT = ZEROS                                    
008103        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY            
008104        MOVE '4'                 TO DC-OPTION-CODE                
008105        PERFORM 9700-LINK-DATE-CONVERT                            
008106        IF PI-OFFLINE = 'N'                                       
008107           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT           
008108           MOVE 'P'              TO WS-HOLD-UNTIL-SW              
008109        ELSE                                                      
008110           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.          
008111                                                                  
008112     MOVE PI-ERESV               TO AT-ADDL-RESERVE.              
008113     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL          
008114                                    AT-CHECK-QUE-SEQUENCE.        
008115                                                                  
008116     IF PI-PFKEY-USED = DFHPF4                                    
008117        MOVE '1'                 TO AT-FORCE-CONTROL.             
008118                                                                  
008119     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'                      
008120        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT           
008121        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT          
008122        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.         
008123                                                                  
008124     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT              
008125                                    AT-VOID-SELECT-DT             
008126                                    AT-VOID-ACCEPT-DT             
008127                                    AT-VOID-DT.                   
008128                                                                  
008129     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'   
008130         OR 'B' OR 'H')                                           
008131        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')                
008132        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE                 
008133        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS           
008134        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE               
008135     ELSE                                                         
008136        MOVE ZEROS               TO AT-DAILY-RATE                 
008137                                    AT-ELIMINATION-DAYS           
008138        MOVE SPACES              TO AT-BENEFIT-TYPE               
008139     END-IF                                                       
008140                                                                  
008141     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.           
008142     MOVE '4'                    TO DC-OPTION-CODE.               
008143     PERFORM 9700-LINK-DATE-CONVERT.                              
008144     IF DATE-CONVERSION-ERROR                                     
008145         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT              
008146     ELSE                                                         
008147         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT              
008148     END-IF.                                                      
008149                                                                  
008150     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK       
008151     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM             
008152     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY               
008153     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE            
008154                                                                  
008155     IF (PI-REAUDIT-NEEDED = 'Y')                                 
008156        or (pi-max-ext-used = 'Y')                                
008157        OR (PI-APPROVAL-3550-NEEDED = 'Y')                        
008158        OR PI-DUPE-APPROVAL-NEEDED = 'Y'                          
008159         PERFORM 6155-READ-CONTROL                                
008160         PERFORM 6157-SET-APP-LEVEL                               
008161         IF AT-APPROVAL-LEVEL-REQD < '4'                          
008162            MOVE '4' TO AT-APPROVAL-LEVEL-REQD                    
008163         END-IF                                                   
008164         MOVE 'Y' TO WS-NEED-APPROVAL                             
008165         GO TO 6170-WRITE                                         
008166     END-IF.                                                      
008167*******************************************************           
008168     IF NOT PI-PMT-GRADUATED                                      
008169         GO TO 6170-WRITE.                                        
008170                                                                  
008171     PERFORM 6155-READ-CONTROL.                                   
008172                                                                  
008173     IF PAID-FOR-LIFE                                             
008174         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL                    
008175             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW       
008176                                     WS-PMT-APPROVAL-SW           
008177             GO TO 6170-WRITE.                                    
008178                                                                  
008179*05999      IF PAID-FOR-AH                                        
008180     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)             
008181         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL                       
008182             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW       
008183                                     WS-PMT-APPROVAL-SW           
008184             GO TO 6170-WRITE.                                    
008185                                                                  
008186     MOVE '1'                    TO AT-APPROVED-LEVEL.            
008187                                                                  
008188     PERFORM 6157-SET-APP-LEVEL.                                  
008189                                                                  
008190     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.  
008191                                                                  
008192     IF NOT PI-PMT-GRADUATED                                      
008193         GO TO 6170-WRITE.                                        
008194                                                                  
008195     EXEC CICS HANDLE CONDITION                                   
008196         NOTFND   (6170-WRITE)                                    
008197     END-EXEC.                                                    
008198                                                                  
008199     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
008200     MOVE '2'                    TO CNTL-REC-TYPE.                
008201     MOVE +0                     TO CNTL-SEQ-NO.                  
008202     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.                  
008203                                                                  
008204     EXEC CICS READ                                               
008205          DATASET  ('ELCNTL')                                     
008206          SET      (ADDRESS OF CONTROL-FILE)                      
008207          RIDFLD   (ELCNTL-KEY)                                   
008208     END-EXEC.                                                    
008209                                                                  
008210     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.                 
008211                                                                  
008212     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'                     
008213                         OR '4' OR '5'                            
008214         NEXT SENTENCE                                            
008215     ELSE                                                         
008216         MOVE 'Y' TO WS-NEED-APPROVAL                             
008217         GO TO 6170-WRITE.                                        
008218                                                                  
008219     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD                
008220         MOVE 'Y' TO WS-NEED-APPROVAL                             
008221         IF WS-APPROVAL-LEVEL = '1'                               
008222             MOVE '2'        TO  AT-APPROVED-LEVEL                
008223                            WS-SAVE-APPROVED-LEVEL                
008224             GO TO 6170-WRITE                                     
008225         ELSE                                                     
008226             IF WS-APPROVAL-LEVEL = '2'                           
008227                 MOVE '3'        TO  AT-APPROVED-LEVEL            
008228                                WS-SAVE-APPROVED-LEVEL            
008229                 GO TO 6170-WRITE                                 
008230             ELSE IF WS-APPROVAL-LEVEL = '3'                      
008231                 MOVE '4'        TO  AT-APPROVED-LEVEL            
008232                                WS-SAVE-APPROVED-LEVEL            
008233                 GO TO 6170-WRITE                                 
008234             ELSE IF WS-APPROVAL-LEVEL = '4'                      
008235                 MOVE '5'        TO  AT-APPROVED-LEVEL            
008236                                WS-SAVE-APPROVED-LEVEL            
008237                 GO TO 6170-WRITE.                                
008238                                                                  
008239     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW               
008240                             WS-PMT-APPROVAL-SW.                  
008241     MOVE SPACES         TO  AT-APPROVED-LEVEL                    
008242                             AT-APPROVAL-LEVEL-REQD.              
008243                                                                  
008244*******************************************************           
008245 6155-READ-CONTROL.                                               
008246     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
008247     MOVE '1'                    TO CNTL-REC-TYPE.                
008248     MOVE SPACES                 TO CNTL-ACCESS.                  
008249     MOVE +0                     TO CNTL-SEQ-NO.                  
008250     MOVE 'COMP'                 TO FILE-SWITCH.                  
008251                                                                  
008252     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.                    
008253                                                                  
008254 6157-SET-APP-LEVEL.                                              
008255                                                                  
008256******A&H Limits are set as a monthly payment.  Calculate the mont
008257******equivalent of the amount paid today                         
008258     IF PI-SAVE-ELAPSED-MONTHS > 0 OR                             
008259        PI-SAVE-ODD-DAYS-OVER > 0                                 
008260           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER    
008261                               / 30) + PI-SAVE-ELAPSED-MONTHS     
008262           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /   
008263                                  WS-CALC-PMT-MONTHS              
008264     ELSE                                                         
008265           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT               
008266     END-IF.                                                      
008267*06007      IF ((PAID-FOR-AH) AND                                 
008268     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP             
008269           OR PAID-FOR-FAM                                        
008270           OR PAID-FOR-BRV OR PAID-FOR-HOS) AND                   
008271*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))         
008272        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))             
008273              OR                                                  
008274        ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND                      
008275        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))              
008276            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD            
008277       ELSE                                                       
008278*06014      IF ((PAID-FOR-AH)  AND                                
008279         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP         
008280           OR PAID-FOR-FAM                                        
008281           OR PAID-FOR-BRV OR PAID-FOR-HOS) AND                   
008282*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))         
008283           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))          
008284              OR                                                  
008285        ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND                      
008286        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))              
008287            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD            
008288         ELSE                                                     
008289*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.    
008290           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP       
008291                OR PAID-FOR-FAM                                   
008292                OR PAID-FOR-BRV OR PAID-FOR-HOS) AND              
008293               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))      
008294              OR                                                  
008295          ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND                    
008296          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))            
008297            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD            
008298       ELSE                                                       
008299           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP       
008300                OR PAID-FOR-FAM                                   
008301                OR PAID-FOR-BRV OR PAID-FOR-HOS) AND              
008302               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))      
008303              OR                                                  
008304          ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND                    
008305          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))            
008306            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD            
008307       ELSE                                                       
008308            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.           
008309                                                                  
008310     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP             
008311           OR PAID-FOR-FAM                                        
008312           OR PAID-FOR-BRV OR PAID-FOR-HOS) AND                   
008313        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))             
008314        IF ('1' >= AT-APPROVAL-LEVEL-REQD)                        
008315            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD            
008316        END-IF                                                    
008317     ELSE                                                         
008318     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP             
008319           OR PAID-FOR-FAM                                        
008320           OR PAID-FOR-BRV OR PAID-FOR-HOS) AND                   
008321        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))             
008322        IF ('2' >= AT-APPROVAL-LEVEL-REQD)                        
008323            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD            
008324        END-IF                                                    
008325     ELSE                                                         
008326     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP             
008327           OR PAID-FOR-FAM                                        
008328           OR PAID-FOR-BRV OR PAID-FOR-HOS) AND                   
008329        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))             
008330        IF ('3' >= AT-APPROVAL-LEVEL-REQD)                        
008331            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD            
008332        END-IF                                                    
008333     ELSE                                                         
008334     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP             
008335           OR PAID-FOR-FAM                                        
008336           OR PAID-FOR-BRV OR PAID-FOR-HOS) AND                   
008337        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))             
008338        IF ('4' >= AT-APPROVAL-LEVEL-REQD)                        
008339            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD            
008340        END-IF                                                    
008341     ELSE                                                         
008342     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP              
008343           OR PAID-FOR-FAM                                        
008344           OR PAID-FOR-BRV OR PAID-FOR-HOS)                       
008345            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.           
008346                                                                  
008347                                                                  
008348 6170-WRITE.                                                      
008349                                                                  
008350     if pi-company-id = 'DCC' or 'VPP'                            
008351        PERFORM 0900-GET-DDF-limits                               
008352                                 THRU 0900-EXIT                   
008353     end-if                                                       
008354                                                                  
008355     perform 2220-update-elcrtt  thru 2220-exit                   
008356                                                                  
008357     IF PI-COMPANY-ID = 'DMD'                                     
008358        IF PI-AT-EOB-CODES NOT = SPACES                           
008359           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1                
008360           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2                
008361           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3                
008362           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4                
008363           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.               
008364                                                                  
008365     EXEC CICS HANDLE CONDITION                                   
008366         DUPREC    (6180-DUPREC)                                  
008367     END-EXEC.                                                    
008368                                                                  
008369     EXEC CICS WRITE                                              
008370          DATASET       ('ELTRLR')                                
008371          FROM          (ACTIVITY-TRAILERS)                       
008372          RIDFLD        (AT-CONTROL-PRIMARY)                      
008373      END-EXEC.                                                   
008374                                                                  
008375     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND                  
008376        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)                      
008377*06088           GO TO 6199-EXIT.                                 
008378           GO TO 6176-APPROVAL-NOTE.                              
008379                                                                  
008380     EXEC CICS GETMAIN                                            
008381          SET       (ADDRESS OF ACTIVITY-TRAILERS)                
008382          LENGTH    (200)                                         
008383          INITIMG   (GETMAIN-SPACE)                               
008384      END-EXEC.                                                   
008385                                                                  
008386     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.                         
008387                                                                  
008388     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.           
008389     MOVE 'AT'                   TO AT-RECORD-ID.                 
008390     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.               
008391     MOVE '6'                    TO AT-TRAILER-TYPE.              
008392     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT                
008393                                    AT-GEN-INFO-LAST-MAINT-DT     
008394     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY                
008395                                    AT-GEN-INFO-LAST-UPDATED-BY   
008396     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.         
008397                                                                  
008398     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.               
008399     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2                
008400     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST            
008401                                                                  
008402     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.         
008403                                                                  
008404 6175-WRITE.                                                      
008405                                                                  
008406     EXEC CICS HANDLE CONDITION                                   
008407         DUPREC    (6190-DUPREC)                                  
008408     END-EXEC.                                                    
008409                                                                  
008410     EXEC CICS WRITE                                              
008411          DATASET     ('ELTRLR')                                  
008412          FROM        (ACTIVITY-TRAILERS)                         
008413          RIDFLD      (AT-CONTROL-PRIMARY)                        
008414      END-EXEC.                                                   
008415                                                                  
008416 6176-APPROVAL-NOTE.                                              
008417                                                                  
008418     IF NOT APPROVAL-NEEDED                                       
008419         GO TO 6199-EXIT.                                         
008420                                                                  
008421     EXEC CICS GETMAIN                                            
008422         SET       (ADDRESS OF ACTIVITY-TRAILERS)                 
008423         LENGTH    (200)                                          
008424         INITIMG   (GETMAIN-SPACE)                                
008425     END-EXEC.                                                    
008426                                                                  
008427     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT                          
008428                                                                  
008429     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY                
008430     MOVE 'AT'               TO AT-RECORD-ID                      
008431     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO                    
008432     MOVE '6'                TO AT-TRAILER-TYPE                   
008433     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT                    
008434                                AT-GEN-INFO-LAST-MAINT-DT         
008435     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY                    
008436                                AT-GEN-INFO-LAST-UPDATED-BY       
008437     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS              
008438                                                                  
008439     IF PI-REAUDIT-NEEDED = 'Y'                                   
008440         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1                   
008441     ELSE                                                         
008442         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1                   
008443     END-IF                                                       
008444     IF PI-APPROVAL-3550-NEEDED = 'Y'                             
008445         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1               
008446     END-IF                                                       
008447     IF PI-DUPE-APPROVAL-NEEDED = 'Y'                             
008448         MOVE WS-DUPE-APPROV-NOTE TO AT-INFO-LINE-1               
008449     END-IF                                                       
008450                                                                  
008451     MOVE SPACES             TO AT-INFO-LINE-2                    
008452                                                                  
008453     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.             
008454 6177-WRITE.                                                      
008455                                                                  
008456     EXEC CICS HANDLE CONDITION                                   
008457         DUPREC    (6185-DUPREC)                                  
008458     END-EXEC.                                                    
008459                                                                  
008460     EXEC CICS WRITE                                              
008461          DATASET     ('ELTRLR')                                  
008462          FROM        (ACTIVITY-TRAILERS)                         
008463          RIDFLD      (AT-CONTROL-PRIMARY)                        
008464      END-EXEC.                                                   
008465                                                                  
008466                                                                  
008467     GO TO 6199-EXIT.                                             
008468                                                                  
008469 6180-DUPREC.                                                     
008470                                                                  
008471     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.                         
008472     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.              
008473     GO TO 6170-WRITE.                                            
008474                                                                  
008475 6185-DUPREC.                                                     
008476     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.                         
008477     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.              
008478     GO TO 6177-WRITE.                                            
008479                                                                  
008480 6190-DUPREC.                                                     
008481     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.                         
008482     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.              
008483     GO TO 6175-WRITE.                                            
008484                                                                  
008485 6199-EXIT.                                                       
008486      EXIT.                                                       
008487                                                                  
008488     EJECT                                                        
008489 6200-UPDATE-CLAIM-MSTR.                                          
008490     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.                 
008491     MOVE PI-CARRIER             TO MSTR-CARRIER.                 
008492     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.                
008493     MOVE PI-CERT-NO             TO MSTR-CERT-NO.                 
008494                                                                  
008495     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.               
008496                                                                  
008497     MOVE ZEROS                  TO W-INTEREST.                   
008498                                                                  
008499     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'          
008500           OR 'FNL'                                               
008501        IF (PI-OFFLINE = 'Y') OR                                  
008502           (PI-PMTTYPE = '7')                                     
008503           PERFORM 9870-OUTPUT-ACTIVITY-RECORD                    
008504                                 THRU 9870-EXIT                   
008505        END-IF                                                    
008506     END-IF                                                       
008507     IF NOT ERROR-ON-OUTPUT                                       
008508        CONTINUE                                                  
008509     ELSE                                                         
008510        EXEC CICS REWRITE                                         
008511           DATASET('ELMSTR')                                      
008512           FROM(CLAIM-MASTER)                                     
008513        END-EXEC                                                  
008514                                                                  
008515        MOVE -1                  TO ENTPFBL                       
008516        MOVE AL-UANON            TO ENTPFBA                       
008517        MOVE MAP-NAMEB           TO MAP-NAME                      
008518        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  
008519        GO TO 8200-SEND-DATAONLY                                  
008520     END-IF                                                       
008521                                                                  
008522     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.                          
008523                                                                  
008524     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.                        
008525                                                                  
008526     IF PI-AIG-SPECIAL-BENEFIT                                    
008527         MOVE '1' TO WS-PAYMENT-TRAILER-SW.                       
008528                                                                  
008529     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.           
008530                                                                  
008531     IF PI-SPECIAL-BEN-SW = 'Y'                                   
008532         MOVE '2' TO WS-PAYMENT-TRAILER-SW                        
008533         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.               
008534                                                                  
008535     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
008536         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT          
008537     ELSE                                                         
008538         IF PI-PMTTYPE NOT = '4'                                  
008539            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.      
008540                                                                  
008541     IF PI-PMTTYPE = '5' OR '6'                                   
008542        GO TO  6250-SET-MAINT.                                    
008543                                                                  
008544     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE     
008545                                         CL-LAG-REPORT-CODE.      
008546                                                                  
008547     IF CL-ACTIVITY-CODE = 09                                     
008548         GO TO 6200-CONT-UPDATE.                                  
008549                                                                  
008550     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
008551         IF CL-ACTIVITY-CODE = 11                                 
008552             GO TO 6200-CONT-UPDATE.                              
008553                                                                  
008554     IF WS-ACT-REC-FOUND-SW = 'N'                                 
008555         GO TO 6200-CONT-UPDATE.                                  
008556                                                                  
008557     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT                          
008558         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT     
008559         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE   
008560         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.        
008561                                                                  
008562     IF WS-UPDATE-SW = 'Y'                                        
008563         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT        
008564                                         CL-NEXT-FOLLOWUP-DT.     
008565                                                                  
008566 6200-CONT-UPDATE.                                                
008567                                                                  
008568     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
008569       IF CLAIM-IS-CLOSED                                         
008570         IF PI-PMTTYPE = '2' OR '3' OR '4'                        
008571           IF WS-OPEN-CLOSE-SW = '2'                              
008572             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT         
008573                                        CL-LAST-CLOSE-DT.         
008574                                                                  
008575     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'                      
008576        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT             
008577        MOVE 'O'                 TO CL-CLAIM-STATUS.              
008578                                                                  
008579     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN               
008580        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT              
008581        MOVE '1'                 TO CL-LAST-CLOSE-REASON          
008582        MOVE 'C'                 TO CL-CLAIM-STATUS               
008583        IF PI-PMTTYPE = '2'                                       
008584           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'   
008585              or 'F' OR 'B' OR 'H')                               
008586           CONTINUE                                               
008587        ELSE                                                      
008588           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT                
008589        END-IF                                                    
008590     ELSE                                                         
008591        IF PI-PMTTYPE = '2' OR '3'                                
008592           IF PI-PMTTYPE = '2' AND                                
008593              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'    
008594                 or 'F' OR 'B' OR 'H')                            
008595              CONTINUE                                            
008596           ELSE                                                   
008597              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT             
008598           END-IF                                                 
008599        END-IF                                                    
008600     END-IF                                                       
008601                                                                  
008602     IF PI-PMTTYPE = '4'                                          
008603        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.                  
008604                                                                  
008605     IF PI-COMPANY-ID = 'CVL'                                     
008606         IF PI-LOAN-UPDATE-SW = 'Y'                               
008607             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD             
008608             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER             
008609             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING            
008610             MOVE CL-CERT-STATE      TO  CERT-STATE               
008611             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT             
008612             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT              
008613             MOVE CL-CERT-NO         TO  CERT-CERT-NO             
008614             MOVE 'CERT'             TO  FILE-SWITCH              
008615             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT         
008616             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY           
008617             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.            
008618                                                                  
008619     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '   
008620        GO TO 6220-USE-COMPUTED.                                  
008621                                                                  
008622     IF (PI-PMTTYPE = '4')  AND                                   
008623        (PI-EPYAMT < ZEROS)                                       
008624          COMPUTE CL-NO-OF-DAYS-PAID =                            
008625                       CL-NO-OF-DAYS-PAID - PI-EDAYS              
008626          IF CL-NO-OF-DAYS-PAID < +0                              
008627              MOVE ZEROS TO CL-NO-OF-DAYS-PAID                    
008628          ELSE                                                    
008629              NEXT SENTENCE                                       
008630     ELSE                                                         
008631          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.           
008632                                                                  
008633     IF HOLD-UNTIL-PMT                                            
008634        CONTINUE                                                  
008635     ELSE                                                         
008636     IF PI-PROCESSOR-ID = 'FIX '                                  
008637        IF CL-TOTAL-PAID-AMT NOT = ZEROS                          
008638           NEXT SENTENCE                                          
008639        ELSE                                                      
008640           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT             
008641     ELSE                                                         
008642        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.            
008643                                                                  
008644     IF PI-PMTTYPE = '4'                                          
008645        GO TO 6250-SET-MAINT.                                     
008646                                                                  
008647     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.           
008648     MOVE '4'                    TO DC-OPTION-CODE.               
008649     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
008650     IF HOLD-UNTIL-PMT                                            
008651        CONTINUE                                                  
008652     ELSE                                                         
008653     IF DATE-CONVERSION-ERROR                                     
008654        MOVE LOW-VALUES          TO CL-PAID-THRU-DT               
008655     ELSE                                                         
008656        ADD 1                 TO CL-NO-OF-PMTS-MADE               
008657        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT                        
008658           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT               
008659           IF PI-AIG-SPECIAL-BENEFIT                              
008660               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5          
008661           ELSE                                                   
008662               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.          
008663                                                                  
008664     GO TO 6250-SET-MAINT.                                        
008665                                                                  
008666 6220-USE-COMPUTED.                                               
008667                                                                  
008668     IF (PI-PMTTYPE = '4')  AND                                   
008669        (PI-CPYAMT < ZEROS)                                       
008670          COMPUTE CL-NO-OF-DAYS-PAID =                            
008671                       CL-NO-OF-DAYS-PAID - PI-CDAYS              
008672          IF CL-NO-OF-DAYS-PAID < +0                              
008673              MOVE ZEROS TO CL-NO-OF-DAYS-PAID                    
008674          ELSE                                                    
008675              NEXT SENTENCE                                       
008676     ELSE                                                         
008677          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.           
008678                                                                  
008679     IF NOT HOLD-UNTIL-PMT                                        
008680        ADD 1                    TO CL-NO-OF-PMTS-MADE            
008681        ADD PI-CPYAMT            TO CL-TOTAL-PAID-AMT.            
008682                                                                  
008683     IF PI-PMTTYPE = '4'                                          
008684        GO TO 6250-SET-MAINT.                                     
008685                                                                  
008686     IF PI-AIG-SPECIAL-BENEFIT                                    
008687         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5                
008688     ELSE                                                         
008689         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.                
008690                                                                  
008691     IF PI-CPYTHRU > CL-PAID-THRU-DT                              
008692       AND NOT HOLD-UNTIL-PMT                                     
008693        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.              
008694                                                                  
008695 6250-SET-MAINT.                                                  
008696     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.             
008697                                                                  
008698     IF PI-PROCESSOR-ID = 'FIX '                                  
008699        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT                        
008700           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT                
008701        ELSE                                                      
008702           NEXT SENTENCE                                          
008703     ELSE                                                         
008704        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.               
008705                                                                  
008706     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.           
008707     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.         
008708     MOVE '1'                    TO CL-LAST-MAINT-TYPE.           
008709                                                                  
008710 6299-EXIT.                                                       
008711      EXIT.                                                       
008712     EJECT                                                        
008713 6300-UPDATE-CERT.                                                
008714                                                                  
008715*  ADD CERTNOTE FOR SC NP+6                                       
008716     IF PI-COMPANY-ID = 'CID' AND                                 
008717       (PI-PMTTYPE = '2' OR '3') AND                              
008718        CL-CERT-STATE = 'SC'  AND                                 
008719        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')         
008720           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT              
008721     END-IF.                                                      
008722                                                                  
008723     IF PI-COMPANY-ID = 'AHL' AND                                 
008724       (PI-PMTTYPE = '2' OR '3') AND                              
008725        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR       
008726           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')          
008727           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT              
008728     END-IF.                                                      
008729                                                                  
008730     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.                       
008731     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.                       
008732     MOVE CL-CERT-GROUPING TO CERT-GROUPING.                      
008733     MOVE CL-CERT-STATE    TO CERT-STATE.                         
008734     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.                       
008735     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.                        
008736     MOVE CL-CERT-NO       TO CERT-CERT-NO.                       
008737     MOVE 'CERT'           TO FILE-SWITCH.                        
008738                                                                  
008739     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.                
008740                                                                  
008741     IF CERT-NOTE-ADDED                                           
008742        IF CM-NOTE-SW = ' '                                       
008743           MOVE '4'             TO CM-NOTE-SW                     
008744        ELSE                                                      
008745           IF CM-NOTE-SW = '1'                                    
008746               MOVE '5'           TO CM-NOTE-SW                   
008747           ELSE                                                   
008748              IF CM-NOTE-SW = '2'                                 
008749                 MOVE '6'         TO CM-NOTE-SW                   
008750              ELSE                                                
008751                 IF CM-NOTE-SW = '3'                              
008752                    MOVE '7'      TO CM-NOTE-SW                   
008753                 END-IF                                           
008754              END-IF                                              
008755           END-IF                                                 
008756        END-IF                                                    
008757     END-IF.                                                      
008758                                                                  
008759     IF PI-COMPANY-ID = 'CVL'                                     
008760         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY                     
008761         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.                 
008762                                                                  
008763     IF PI-PMTTYPE NOT = '4'                                      
008764        GO TO 6340-UPDATE-CERT.                                   
008765                                                                  
008766     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'                
008767        IF PI-PFKEY-USED = DFHPF5                                 
008768           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT           
008769        ELSE                                                      
008770           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.          
008771                                                                  
008772*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1                       
008773*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'                        
008774*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR                      
008775*               PI-LF-COVERAGE-TYPE = 'P'                         
008776*                GO TO 6350-REWRITE-CERT.                         
008777                                                                  
008778     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'                
008779       IF PI-LIFE-OVERRIDE-L1 = 'P' OR                            
008780          PI-LF-COVERAGE-TYPE = 'P'                               
008781           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT            
008782                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT       
008783                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT  
008784                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
008785                MOVE '7'                  TO CM-LF-CURRENT-STATUS 
008786                GO TO 6350-REWRITE-CERT                           
008787            ELSE                                                  
008788                GO TO 6350-REWRITE-CERT.                          
008789                                                                  
008790     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'                
008791         GO TO 6350-REWRITE-CERT.                                 
008792                                                                  
008793     IF NOT CM-AH-LUMP-SUM-DISAB                                  
008794        GO TO 6380-UNLOCK-CERT.                                   
008795                                                                  
008796     IF PI-PFKEY-USED = DFHPF5                                    
008797        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT            
008798                                    CM-AH-ITD-AH-PMT              
008799        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT            
008800        GO TO 6350-REWRITE-CERT                                   
008801     ELSE                                                         
008802        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT            
008803                                    CM-AH-ITD-AH-PMT              
008804        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT            
008805        GO TO 6350-REWRITE-CERT.                                  
008806                                                                  
008807 6340-UPDATE-CERT.                                                
008808                                                                  
008809     IF CL-CLAIM-TYPE = 'L' OR 'O'                                
008810         IF PI-PFKEY-USED = DFHPF5                                
008811             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT        
008812         ELSE                                                     
008813             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.       
008814                                                                  
008815     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'                
008816         IF PI-COMPANY-ID = 'ACC' OR 'FDL'                        
008817             IF PI-LIFE-OVERRIDE-L1 = 'P' OR                      
008818                PI-LF-COVERAGE-TYPE = 'P'                         
008819                 GO TO 6350-REWRITE-CERT.                         
008820                                                                  
008821     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'                
008822       IF PI-LIFE-OVERRIDE-L1 = 'P' OR                            
008823          PI-LF-COVERAGE-TYPE = 'P'                               
008824           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT            
008825                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT       
008826                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT  
008827                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
008828                MOVE '7'                  TO CM-LF-CURRENT-STATUS 
008829                GO TO 6350-REWRITE-CERT.                          
008830                                                                  
008831     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1                       
008832         IF PI-LIFE-OVERRIDE-L1 = ('L' OR 'O') AND                
008833            PI-LF-COVERAGE-TYPE NOT = 'P'                         
008834             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT        
008835             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT   
008836             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH 
008837             MOVE '7'                    TO CM-LF-CURRENT-STATUS  
008838             GO TO 6350-REWRITE-CERT.                             
008839                                                                  
008840     IF CL-CLAIM-TYPE = 'O'                                       
008841         IF PI-LIFE-OVERRIDE-L1 = ('L' OR 'O') AND                
008842            PI-LF-COVERAGE-TYPE NOT = 'P'                         
008843             MOVE CL-INCURRED-DT         TO CM-LF-CANCEL-DT       
008844             MOVE PI-MONTH-END-SAVE      TO CM-LF-CANCEL-EXIT-DT  
008845             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-CANCEL
008846             MOVE '6'            TO CM-LF-CURRENT-STATUS          
008847             GO TO 6350-REWRITE-CERT.                             
008848                                                                  
008849     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'    
008850                                          OR 'B' or 'H'           
008851         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT       
008852         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT  
008853         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
008854         MOVE '6'                    TO CM-AH-CURRENT-STATUS      
008855         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT        
008856         IF PI-PFKEY-USED = DFHPF5                                
008857             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT        
008858                                        CM-AH-ITD-AH-PMT          
008859             GO TO 6350-REWRITE-CERT                              
008860         ELSE                                                     
008861             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT        
008862                                        CM-AH-ITD-AH-PMT          
008863             GO TO 6350-REWRITE-CERT.                             
008864                                                                  
008865 6350-REWRITE-CERT.                                               
008866                                                                  
008867     EXEC CICS REWRITE                                            
008868          DATASET  ('ELCERT')                                     
008869          FROM(CERTIFICATE-MASTER)                                
008870      END-EXEC.                                                   
008871                                                                  
008872     GO TO 6399-EXIT.                                             
008873                                                                  
008874 6380-UNLOCK-CERT.                                                
008875     EXEC CICS UNLOCK                                             
008876          DATASET  ('ELCERT')                                     
008877      END-EXEC.                                                   
008878                                                                  
008879 6399-EXIT.                                                       
008880      EXIT.                                                       
008881     EJECT                                                        
008882 6400-UPDATE-ZERO-TRAILER.                                        
008883     MOVE ELMSTR-KEY             TO ELTRLR-KEY.                   
008884     MOVE ZEROS                  TO TRLR-SEQ-NO.                  
008885                                                                  
008886     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.             
008887                                                                  
008888     IF PI-EPYAMT NOT = ZEROS                                     
008889         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE     
008890     ELSE                                                         
008891         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.    
008892                                                                  
008893     IF PI-ERESV NOT = ZEROS                                      
008894        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.    
008895                                                                  
008896     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE                        
008897        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.    
008898                                                                  
008899     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4                          
008900        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE     
008901     ELSE                                                         
008902        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.    
008903                                                                  
008904     IF PI-PMTTYPE = '5'                                          
008905        IF PI-EPYAMT = ZEROS                                      
008906           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE     
008907        ELSE                                                      
008908           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.    
008909                                                                  
008910     IF PI-PMTTYPE = '6'                                          
008911        IF PI-EPYAMT = ZEROS                                      
008912           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES          
008913        ELSE                                                      
008914           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.         
008915                                                                  
008916 6420-CHECK-OPEN-CLOSE.                                           
008917     IF PI-PMTTYPE = '5' OR '6'                                   
008918        GO TO 6450-REWRITE.                                       
008919                                                                  
008920     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
008921         IF PI-PMTTYPE = '2' OR '3' OR '4'                        
008922             IF CLAIM-IS-CLOSED                                   
008923                 MOVE '1'        TO  WS-OPEN-CLOSE-SW             
008924                 MOVE 1          TO  SUB-1                        
008925                 GO TO 6440-AIG-LOOP.                             
008926                                                                  
008927     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN               
008928        GO TO 6450-REWRITE.                                       
008929                                                                  
008930     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED             
008931        GO TO 6450-REWRITE.                                       
008932                                                                  
008933     MOVE 1                      TO SUB-1.                        
008934                                                                  
008935 6430-LOOP.                                                       
008936     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES                       
008937        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)    
008938        IF PI-PMTTYPE = '1' OR '4'                                
008939           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)    
008940           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)  
008941           GO TO 6450-REWRITE                                     
008942        ELSE                                                      
008943           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)    
008944           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)  
008945           GO TO 6450-REWRITE.                                    
008946                                                                  
008947     IF SUB-1 = 6                                                 
008948      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1) 
008949      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2) 
008950      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3) 
008951      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4) 
008952      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5) 
008953      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6) 
008954      GO TO 6430-LOOP.                                            
008955                                                                  
008956     ADD 1                       TO SUB-1.                        
008957     GO TO 6430-LOOP.                                             
008958                                                                  
008959                                                                  
008960 6440-AIG-LOOP.                                                   
008961                                                                  
008962     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES                       
008963       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)    
008964       IF WS-OPEN-CLOSE-SW = '1'                                  
008965         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)   
008966         IF PI-PMTTYPE = '2'                                      
008967           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1) 
008968           MOVE '2'              TO  WS-OPEN-CLOSE-SW             
008969         ELSE                                                     
008970           IF PI-PMTTYPE = '3'                                    
008971             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1) 
008972             MOVE '2'            TO  WS-OPEN-CLOSE-SW             
008973           ELSE                                                   
008974             IF PI-PMTTYPE = '4'                                  
008975               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1) 
008976               MOVE '2'          TO  WS-OPEN-CLOSE-SW             
008977             ELSE                                                 
008978               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1) 
008979               MOVE '2'          TO  WS-OPEN-CLOSE-SW             
008980       ELSE                                                       
008981         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)   
008982         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1) 
008983         GO TO 6450-REWRITE.                                      
008984                                                                  
008985     IF SUB-1 = 6                                                 
008986      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1) 
008987      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2) 
008988      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3) 
008989      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4) 
008990      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5) 
008991      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6) 
008992      GO TO 6440-AIG-LOOP.                                        
008993                                                                  
008994     ADD 1                       TO SUB-1.                        
008995     GO TO 6440-AIG-LOOP.                                         
008996                                                                  
008997 6450-REWRITE.                                                    
008998     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.     
008999     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.            
009000     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.       
009001                                                                  
009002     IF PI-COMPANY-ID = 'DMD'                                     
009003         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1                  
009004         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2                  
009005         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3                  
009006         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4                  
009007         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.                 
009008                                                                  
009009     EXEC CICS REWRITE                                            
009010          DATASET  ('ELTRLR')                                     
009011          FROM     (ACTIVITY-TRAILERS)                            
009012      END-EXEC.                                                   
009013                                                                  
009014 6499-EXIT.                                                       
009015      EXIT.                                                       
009016                                                                  
009017 EJECT                                                            
009018 6500-READ-DLO035.                                                
009019     MOVE 'E'                    TO DL35-PROCESS-TYPE.            
009020     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.             
009021     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.                
009022     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.             
009023                                                                  
009024     EXEC CICS LINK                                               
009025         PROGRAM    ('DLO035')                                    
009026         COMMAREA   (DLO035-KEY)                                  
009027         LENGTH     (DL35-LENGTH)                                 
009028     END-EXEC.                                                    
009029                                                                  
009030     IF DL35-RETURN-CODE = 'OK'                                   
009031         GO TO 6500-EXIT.                                         
009032                                                                  
009033     IF DL35-RETURN-CODE = '01'                                   
009034         MOVE ER-7830            TO EMI-ERROR                     
009035         GO TO 6500-BAD-EXIT.                                     
009036                                                                  
009037     IF DL35-RETURN-CODE = '02'                                   
009038         MOVE ER-7831            TO EMI-ERROR                     
009039         GO TO 6500-BAD-EXIT.                                     
009040                                                                  
009041     IF DL35-RETURN-CODE = '03'                                   
009042         MOVE ER-7832            TO EMI-ERROR                     
009043         GO TO 6500-BAD-EXIT.                                     
009044                                                                  
009045     IF DL35-RETURN-CODE = '04'                                   
009046         MOVE ER-7833            TO EMI-ERROR                     
009047         GO TO 6500-BAD-EXIT.                                     
009048                                                                  
009049     IF DL35-RETURN-CODE = '05'                                   
009050         MOVE ER-7834            TO EMI-ERROR                     
009051         GO TO 6500-BAD-EXIT.                                     
009052                                                                  
009053     IF DL35-RETURN-CODE = '06'                                   
009054         MOVE ER-7835            TO EMI-ERROR                     
009055         GO TO 6500-BAD-EXIT.                                     
009056                                                                  
009057     IF DL35-RETURN-CODE = '07'                                   
009058         MOVE ER-7836            TO EMI-ERROR                     
009059         GO TO 6500-BAD-EXIT.                                     
009060                                                                  
009061     IF DL35-RETURN-CODE = 'E1'                                   
009062         MOVE ER-7837            TO EMI-ERROR                     
009063         GO TO 6500-BAD-EXIT.                                     
009064                                                                  
009065     IF DL35-RETURN-CODE NOT = 'OK'                               
009066         MOVE ER-7838            TO EMI-ERROR                     
009067         GO TO 6500-BAD-EXIT.                                     
009068                                                                  
009069 6500-EXIT.                                                       
009070      EXIT.                                                       
009071                                                                  
009072 6500-BAD-EXIT.                                                   
009073     EXEC CICS SYNCPOINT ROLLBACK END-EXEC.                       
009074     MOVE -1                 TO PMTTYPEL.                         
009075     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
009076     GO TO 8200-SEND-DATAONLY.                                    
009077                                                                  
009078 EJECT                                                            
009079 6600-UPDATE-DLO035.                                              
009080     MOVE 'U'                    TO DL35-PROCESS-TYPE.            
009081     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.             
009082     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.                
009083     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.             
009084                                                                  
009085     EXEC CICS LINK                                               
009086         PROGRAM    ('DLO035')                                    
009087         COMMAREA   (DLO035-KEY)                                  
009088         LENGTH     (DL35-LENGTH)                                 
009089     END-EXEC.                                                    
009090                                                                  
009091     IF DL35-RETURN-CODE = 'OK'                                   
009092         GO TO 6600-EXIT.                                         
009093                                                                  
009094     IF DL35-RETURN-CODE = '01'                                   
009095         MOVE ER-7830            TO EMI-ERROR                     
009096         GO TO 6500-BAD-EXIT.                                     
009097                                                                  
009098     IF DL35-RETURN-CODE = '02'                                   
009099         MOVE ER-7831            TO EMI-ERROR                     
009100         GO TO 6500-BAD-EXIT.                                     
009101                                                                  
009102     IF DL35-RETURN-CODE = '03'                                   
009103         MOVE ER-7832            TO EMI-ERROR                     
009104         GO TO 6500-BAD-EXIT.                                     
009105                                                                  
009106     IF DL35-RETURN-CODE = '04'                                   
009107         MOVE ER-7833            TO EMI-ERROR                     
009108         GO TO 6500-BAD-EXIT.                                     
009109                                                                  
009110     IF DL35-RETURN-CODE = '05'                                   
009111         MOVE ER-7834            TO EMI-ERROR                     
009112         GO TO 6500-BAD-EXIT.                                     
009113                                                                  
009114     IF DL35-RETURN-CODE = '06'                                   
009115         MOVE ER-7835            TO EMI-ERROR                     
009116         GO TO 6500-BAD-EXIT.                                     
009117                                                                  
009118     IF DL35-RETURN-CODE = '07'                                   
009119         MOVE ER-7836            TO EMI-ERROR                     
009120         GO TO 6500-BAD-EXIT.                                     
009121                                                                  
009122     IF DL35-RETURN-CODE = 'E1'                                   
009123         MOVE ER-7837            TO EMI-ERROR                     
009124         GO TO 6500-BAD-EXIT.                                     
009125                                                                  
009126     IF DL35-RETURN-CODE NOT = 'OK'                               
009127         MOVE ER-7838            TO EMI-ERROR                     
009128         GO TO 6500-BAD-EXIT.                                     
009129                                                                  
009130 6600-EXIT.                                                       
009131      EXIT.                                                       
009132                                                                  
009133     EJECT                                                        
009134 6700-UPDATE-ACTQ.                                                
009135***************************************************************   
009136*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *   
009137*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *   
009138*    ONE ALREADY THERE.                                       *   
009139***************************************************************   
009140                                                                  
009141     EXEC CICS HANDLE CONDITION                                   
009142          NOTFND(6720-BUILD-NEW-RECORD)                           
009143      END-EXEC.                                                   
009144                                                                  
009145     EXEC CICS READ                                               
009146          DATASET('ELACTQ')                                       
009147          RIDFLD (ELMSTR-KEY)                                     
009148          SET    (ADDRESS OF ACTIVITY-QUE)                        
009149          UPDATE                                                  
009150      END-EXEC.                                                   
009151                                                                  
009152     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.      
009153                                                                  
009154     IF PI-AIG-SPECIAL-BENEFIT AND                                
009155        PI-CASH = 'Y'                                             
009156         ADD 2                   TO AQ-PAYMENT-COUNTER            
009157     ELSE                                                         
009158         ADD 1                   TO AQ-PAYMENT-COUNTER.           
009159                                                                  
009160     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC                    
009161         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.     
009162                                                                  
009163     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.       
009164                                                                  
009165     IF PI-PMT-GRADUATED                                          
009166         IF WS-PMT-APPROVAL-SW = 'A'                              
009167             NEXT SENTENCE                                        
009168         ELSE                                                     
009169            IF PI-AIG-SPECIAL-BENEFIT AND                         
009170               PI-CASH = 'Y'                                      
009171                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT      
009172                                     WS-PMT-UNAPPROVED-CNT        
009173            ELSE                                                  
009174                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT      
009175                                     WS-PMT-UNAPPROVED-CNT        
009176     ELSE                                                         
009177         IF PI-PMT-APPR-SW = 'Y'                                  
009178            IF PI-AIG-SPECIAL-BENEFIT AND                         
009179               PI-CASH = 'Y'                                      
009180                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT      
009181                                     WS-PMT-UNAPPROVED-CNT        
009182            ELSE                                                  
009183                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT      
009184                                     WS-PMT-UNAPPROVED-CNT.       
009185                                                                  
009186     IF WS-PMT-UNAPPROVED-CNT > ZERO                              
009187         MOVE ER-3536 TO EMI-ERROR                                
009188         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                
009189                                                                  
009190     MOVE +156                   TO  AQ-LAST-UPDATED-BY.          
009191                                                                  
009192     EXEC CICS REWRITE                                            
009193          DATASET('ELACTQ')                                       
009194          FROM   (ACTIVITY-QUE)                                   
009195      END-EXEC.                                                   
009196                                                                  
009197     GO TO 6799-EXIT.                                             
009198                                                                  
009199 6720-BUILD-NEW-RECORD.                                           
009200     EXEC CICS GETMAIN                                            
009201          SET    (ADDRESS OF ACTIVITY-QUE)                        
009202          LENGTH (60)                                             
009203          INITIMG(GETMAIN-SPACE)                                  
009204      END-EXEC.                                                   
009205                                                                  
009206     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.      
009207                                                                  
009208     IF PI-AIG-SPECIAL-BENEFIT AND                                
009209        PI-CASH = 'Y'                                             
009210         MOVE 2                  TO AQ-PAYMENT-COUNTER            
009211     ELSE                                                         
009212         MOVE 1                  TO AQ-PAYMENT-COUNTER.           
009213                                                                  
009214     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.           
009215     MOVE 'AQ'                   TO AQ-RECORD-ID.                 
009216     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.    
009217     MOVE LOW-VALUES             TO AQ-RESEND-DATE                
009218                                    AQ-FOLLOWUP-DATE.             
009219     MOVE +156                   TO AQ-LAST-UPDATED-BY.           
009220     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.      
009221                                                                  
009222     IF PI-PMT-GRADUATED                                          
009223         IF WS-PMT-APPROVAL-SW = 'A'                              
009224             NEXT SENTENCE                                        
009225         ELSE                                                     
009226            IF PI-AIG-SPECIAL-BENEFIT AND                         
009227               PI-CASH = 'Y'                                      
009228                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT      
009229            ELSE                                                  
009230                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT      
009231     ELSE                                                         
009232         IF PI-PMT-APPR-SW = 'Y'                                  
009233            IF PI-AIG-SPECIAL-BENEFIT AND                         
009234               PI-CASH = 'Y'                                      
009235                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT      
009236            ELSE                                                  
009237                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.     
009238                                                                  
009239     IF AQ-PMT-UNAPPROVED-COUNT > ZERO                            
009240         MOVE ER-3536 TO EMI-ERROR                                
009241         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                
009242                                                                  
009243     EXEC CICS WRITE                                              
009244          DATASET('ELACTQ')                                       
009245          RIDFLD (ELMSTR-KEY)                                     
009246          FROM   (ACTIVITY-QUE)                                   
009247      END-EXEC.                                                   
009248                                                                  
009249 6799-EXIT.                                                       
009250      EXIT.                                                       
009251                                                                  
009252     EJECT                                                        
009253 6800-BUILD-FORM-TRAILER.                                         
009254                                                                  
009255     EXEC CICS GETMAIN                                            
009256          SET      (ADDRESS OF ACTIVITY-TRAILERS)                 
009257          LENGTH   (200)                                          
009258          INITIMG  (GETMAIN-SPACE)                                
009259     END-EXEC.                                                    
009260                                                                  
009261     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.           
009262                                                                  
009263     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.           
009264     MOVE 'AT'                   TO AT-RECORD-ID.                 
009265     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.               
009266                                                                  
009267     MOVE 'A'                    TO AT-TRAILER-TYPE.              
009268     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT                
009269                                    AT-FORM-LAST-MAINT-DT         
009270                                    AT-FORM-SEND-ON-DT.           
009271     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY                
009272                                    AT-FORM-LAST-UPDATED-BY.      
009273     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.         
009274     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.                
009275     MOVE '6'                    TO DC-OPTION-CODE.               
009276     MOVE +29                    TO DC-ELAPSED-DAYS.              
009277     MOVE +0                     TO DC-ELAPSED-MONTHS.            
009278     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
009279     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.         
009280                                                                  
009281     IF PI-COMPANY-ID = 'RMC' OR 'LAP'                            
009282         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.         
009283                                                                  
009284     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT           
009285                                    AT-FORM-RE-SEND-DT            
009286                                    AT-EMP-FORM-ANSWERED-DT       
009287                                    AT-PHY-FORM-ANSWERED-DT       
009288                                    AT-EMP-FORM-SEND-ON-DT        
009289                                    AT-PHY-FORM-SEND-ON-DT        
009290                                    AT-FORM-PRINTED-DT            
009291                                    AT-FORM-REPRINT-DT.           
009292     MOVE '2'                    TO AT-FORM-TYPE.                 
009293                                                                  
009294     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.          
009295     MOVE 'I'                    TO AT-FORM-ADDRESS.              
009296                                                                  
009297     IF PI-COMPANY-ID = 'RMC' OR 'LAP'                            
009298         NEXT SENTENCE                                            
009299     ELSE                                                         
009300         IF CL-PROG-FORM-TYPE NOT = 'S'                           
009301            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.       
009302                                                                  
009303     EXEC CICS WRITE                                              
009304          DATASET  ('ELTRLR')                                     
009305          FROM     (ACTIVITY-TRAILERS)                            
009306          RIDFLD   (AT-CONTROL-PRIMARY)                           
009307      END-EXEC.                                                   
009308                                                                  
009309 6899-EXIT.                                                       
009310      EXIT.                                                       
009311                                                                  
009312     EJECT                                                        
009313 6900-BUILD-ARCHIVE-HEADER.                                       
009314                                                                  
009315     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
009316     MOVE '1'                    TO CNTL-REC-TYPE.                
009317     MOVE +0                     TO CNTL-SEQ-NO.                  
009318     MOVE SPACES                 TO CNTL-ACCESS.                  
009319                                                                  
009320     EXEC CICS READ                                               
009321          DATASET  ('ELCNTL')                                     
009322          SET      (ADDRESS OF CONTROL-FILE)                      
009323          RIDFLD   (ELCNTL-KEY)                                   
009324          UPDATE                                                  
009325     END-EXEC.                                                    
009326                                                                  
009327     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.        
009328     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.                  
009329                                                                  
009330     EXEC CICS REWRITE                                            
009331          FROM     (CONTROL-FILE)                                 
009332          DATASET  ('ELCNTL')                                     
009333     END-EXEC.                                                    
009334                                                                  
009335     EXEC CICS HANDLE CONDITION                                   
009336          DUPKEY   (6900-BUILD-ARCHIVE-HEADER)                    
009337          DUPREC   (6900-BUILD-ARCHIVE-HEADER)                    
009338     END-EXEC.                                                    
009339                                                                  
009340     EXEC CICS GETMAIN                                            
009341          SET     (ADDRESS OF LETTER-ARCHIVE)                     
009342          LENGTH  (ELARCH-LENGTH)                                 
009343          INITIMG (GETMAIN-SPACE)                                 
009344     END-EXEC.                                                    
009345                                                                  
009346     MOVE 'LA'                   TO LA-RECORD-ID.                 
009347     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO                 
009348                                    LA-ARCHIVE-NO-A1.             
009349     MOVE '4'                    TO LA-RECORD-TYPE                
009350                                    LA-RECORD-TYPE-A1.            
009351     MOVE +0                     TO LA-LINE-SEQ-NO                
009352                                    LA-LINE-SEQ-NO-A1.            
009353     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD                 
009354                                    LA-COMPANY-CD-A1.             
009355     MOVE CL-CARRIER             TO LA4-CARRIER.                  
009356     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.                 
009357     MOVE CL-CERT-NO             TO LA4-CERT-NO.                  
009358     MOVE CL-CERT-STATE          TO LA4-STATE.                    
009359     MOVE +0                     TO LA4-NO-OF-COPIES.             
009360     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.             
009361     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.              
009362     MOVE LOW-VALUES             TO LA4-RESEND-DATE               
009363                                    LA4-INITIAL-PRINT-DATE        
009364                                    LA4-RESEND-PRINT-DATE         
009365                                    LA4-FORM-REM-PRINT-DT.        
009366     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.            
009367     MOVE '2'                    TO LA4-FORM-TYPE.                
009368                                                                  
009369     EXEC CICS WRITE                                              
009370          DATASET  ('ELARCH')                                     
009371          FROM     (LETTER-ARCHIVE)                               
009372          RIDFLD   (LA-CONTROL-PRIMARY)                           
009373     END-EXEC.                                                    
009374                                                                  
009375 6999-EXIT.                                                       
009376      EXIT.                                                       
009377                                                                  
009378     EJECT                                                        
009379 7000-SHOW-CLAIM.                                                 
009380     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.         
009381     MOVE 'A'                    TO PI-PASS-SW.                   
009382     MOVE LOW-VALUES             TO PI-CPYFROM                    
009383                                    PI-MONTH-END-SAVE             
009384                                    PI-CPYTHRU.                   
009385                                                                  
009386     MOVE ZEROS                  TO PI-FATAL-COUNT                
009387                                    PI-DAILY-RATE                 
009388                                    PI-BEN-DAYS                   
009389                                    PI-MANUAL-SW                  
009390                                    PI-SAVE-CURSOR                
009391                                    PI-FORCE-COUNT                
009392                                    PI-HOLDTIL                    
009393                                    PI-EPYFROM                    
009394                                    PI-EPYTHRU                    
009395                                    PI-EDAYS                      
009396                                    PI-EPYAMT                     
009397                                    PI-ERESV                      
009398                                    PI-EEXPENS                    
009399                                    PI-CDAYS                      
009400                                    PI-CPYAMT                     
009401                                    PI-CRESV                      
009402                                    PI-CEXPENS                    
009403                                    PI-INT-RATE                   
009404                                    PI-AIGFROM.                   
009405     MOVE ZEROS                  TO PI-PROOF-DATE.                
009406     MOVE ZEROS                  TO PI-ORIG-BEN-AMT               
009407                                    PI-REM-BEN-AMT                
009408                                    PI-MO-BEN-AMT                 
009409                                    pi-ah-term.                   
009410                                                                  
009411     MOVE LOW-VALUES             TO EL156AI.                      
009412     MOVE MAP-NAMEA              TO MAP-NAME.                     
009413     EXEC CICS HANDLE CONDITION                                   
009414         NOTFND   (7010-BUILD-MAP)                                
009415     END-EXEC.                                                    
009416                                                                  
009417     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
009418     MOVE '2'                    TO CNTL-REC-TYPE.                
009419     MOVE +0                     TO CNTL-SEQ-NO.                  
009420     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.                  
009421                                                                  
009422     EXEC CICS READ                                               
009423          DATASET  ('ELCNTL')                                     
009424          SET      (ADDRESS OF CONTROL-FILE)                      
009425          RIDFLD   (ELCNTL-KEY)                                   
009426     END-EXEC.                                                    
009427                                                                  
009428     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.                 
009429                                                                  
009430     IF PI-APPROVAL-LEVEL = '4' OR '5'                            
009431         MOVE AL-UANON      TO SURVYYNA                           
009432     END-IF.                                                      
009433                                                                  
009434                                                                  
009435     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
009436     MOVE '1'                    TO CNTL-REC-TYPE.                
009437     MOVE SPACES                 TO CNTL-ACCESS.                  
009438     MOVE +0                     TO CNTL-SEQ-NO.                  
009439                                                                  
009440     EXEC CICS READ                                               
009441          DATASET  ('ELCNTL')                                     
009442          SET      (ADDRESS OF CONTROL-FILE)                      
009443          RIDFLD   (ELCNTL-KEY)                                   
009444     END-EXEC.                                                    
009445                                                                  
009446     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.          
009447                                                                  
009448 7010-BUILD-MAP.                                                  
009449                                                                  
009450     EXEC CICS HANDLE CONDITION                                   
009451         NOTFND(7100-SHOW-RECORD-NOT-FOUND)                       
009452     END-EXEC.                                                    
009453                                                                  
009454     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.                 
009455     MOVE PI-CARRIER             TO MSTR-CARRIER.                 
009456     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.                
009457     MOVE PI-CERT-NO             TO MSTR-CERT-NO.                 
009458     MOVE 'MSTR'                 TO FILE-SWITCH.                  
009459                                                                  
009460     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.                      
009461                                                                  
009462     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.               
009463     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.                
009464     MOVE CL-BENEFICIARY         TO PI-SV-BEN.                    
009465     MOVE CL-CCN                 TO PI-SV-CCN.                    
009466                                                                  
009467     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.                 
009468     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.             
009469     MOVE CL-CLAIM-NO            TO CLMNOO.                       
009470     MOVE CL-CARRIER             TO CARRO.                        
009471     MOVE CL-CERT-PRIME          TO CERTNOO.                      
009472     MOVE CL-CERT-SFX            TO SUFXO.                        
009473                                                                  
009474     IF (PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL')                 
009475        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')          
009476        CONTINUE                                                  
009477     ELSE                                                         
009478        MOVE AL-SADOF            TO ZINTHA                        
009479                                    ZINTA                         
009480                                    PINTHA                        
009481                                    PINTA                         
009482     END-IF                                                       
009483                                                                  
009484     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE                   
009485     EVALUATE TRUE                                                
009486     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1                       
009487         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO                      
009488                                                                  
009489     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1                     
009490         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO                      
009491                                                                  
009492     WHEN CL-CLAIM-TYPE = 'I'                                     
009493         MOVE '  IU  '           TO CLMTYPO                       
009494                                                                  
009495     WHEN CL-CLAIM-TYPE = 'G'                                     
009496         MOVE ' GAP  '           TO CLMTYPO                       
009497     WHEN CL-CLAIM-TYPE = 'F'                                     
009498         MOVE ' FMLA '           TO CLMTYPO                       
009499     WHEN CL-CLAIM-TYPE = 'B'                                     
009500        MOVE ' BRV  '            TO CLMTYPO                       
009501     WHEN CL-CLAIM-TYPE = 'H'                                     
009502        MOVE ' HOSP '            TO CLMTYPO                       
009503     WHEN CL-CLAIM-TYPE = 'O'                                     
009504         MOVE ' OTH '           TO CLMTYPO                        
009505                                                                  
009506     END-EVALUATE.                                                
009507                                                                  
009508     IF CL-CLAIM-TYPE = 'O'                                       
009509        MOVE 'S' TO EOBYNO                                        
009510                    PI-PRINT-EOB-YN                               
009511                    WS-PRINT-EOB-YN                               
009512     END-IF                                                       
009513                                                                  
009514     IF CLAIM-IS-OPEN                                             
009515         MOVE ' OPEN'            TO CLMSTATO                      
009516     ELSE                                                         
009517         MOVE 'CLOSED'           TO CLMSTATO.                     
009518                                                                  
009519     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.                      
009520                                                                  
009521     IF CL-ASSOC-CERT-TOTAL = +0 OR +1                            
009522         MOVE SPACES             TO  PCERTNOO                     
009523                                     PSUFXO                       
009524                                     PRIMHDGO                     
009525                                     SEQUO                        
009526         MOVE AL-SADOF           TO  PCERTNOA                     
009527                                     PSUFXA                       
009528                                     PRIMHDGA                     
009529                                     SEQUA                        
009530     ELSE                                                         
009531         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU              
009532         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU               
009533         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO                    
009534         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO                 
009535         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO                   
009536         MOVE 'PRIME CERT :'         TO  PRIMHDGO                 
009537         MOVE AL-SANON               TO  PCERTNOA                 
009538                                         PSUFXA                   
009539                                         PRIMHDGA                 
009540         MOVE AL-SABON               TO  SEQUA.                   
009541                                                                  
009542     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.        
009543                                                                  
009544     IF CL-NO-OF-PMTS-MADE = 0 AND                                
009545        CL-TOTAL-PAID-AMT = 0                                     
009546         NEXT SENTENCE                                            
009547     ELSE                                                         
009548         IF CL-PAID-THRU-DT NOT = LOW-VALUES                      
009549             IF NOT PI-USES-PAID-TO                               
009550                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1        
009551                 MOVE ' '                 TO DC-OPTION-CODE       
009552                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT    
009553                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO              
009554             ELSE                                                 
009555                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1        
009556                 MOVE '6'                 TO DC-OPTION-CODE       
009557                 MOVE +1                  TO DC-ELAPSED-DAYS      
009558                 MOVE +0                  TO DC-ELAPSED-MONTHS    
009559                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT    
009560                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.             
009561                                                                  
009562     IF MAP-NAME = 'EL156A'                                       
009563        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES            
009564           IF CL-TOTAL-PAID-AMT NOT = ZEROS                       
009565             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA                
009566           end-if                                                 
009567        end-if                                                    
009568     end-if                                                       
009569                                                                  
009570     IF CL-LAST-PMT-DT NOT = LOW-VALUES                           
009571         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1                 
009572         MOVE ' '                TO DC-OPTION-CODE                
009573         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT            
009574         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.                     
009575                                                                  
009576     IF CL-INCURRED-DT NOT = LOW-VALUES                           
009577         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1                 
009578         MOVE ' '                TO DC-OPTION-CODE                
009579         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT            
009580         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.                   
009581                                                                  
009582     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.                     
009583                                                                  
009584     IF CL-CERT-EFF-DT NOT = LOW-VALUES                           
009585         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1                 
009586         MOVE ' '                TO DC-OPTION-CODE                
009587         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT            
009588         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.                  
009589                                                                  
009590     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
009591         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT                  
009592         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE                 
009593     ELSE                                                         
009594         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT                  
009595         MOVE CL-CERT-STATE      TO WS-WORK-STATE.                
009596                                                                  
009597     MOVE WS-WORK-STATE-ACCT     TO STACCTO.                      
009598     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.                 
009599     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.                 
009600     MOVE CL-CERT-GROUPING       TO CERT-GROUPING                 
009601                                    PI-GROUPING.                  
009602     MOVE CL-CERT-STATE          TO CERT-STATE                    
009603                                    PI-STATE.                     
009604     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT                  
009605                                    PI-ACCOUNT.                   
009606     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.                  
009607     MOVE CL-CERT-NO             TO CERT-CERT-NO.                 
009608     MOVE 'CERT'                 TO FILE-SWITCH.                  
009609                                                                  
009610     PERFORM 7970-READ-CERT THRU 7970-EXIT.                       
009611                                                                  
009612     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND      
009613        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND      
009614        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT             
009615            MOVE 'N' TO PI-JOINT-INSURED-IND                      
009616     ELSE                                                         
009617            MOVE 'Y' TO PI-JOINT-INSURED-IND                      
009618     END-IF.                                                      
009619                                                                  
009620     perform 7975-read-acct      thru 7975-exit                   
009621                                                                  
009622     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
009623     MOVE PI-STATE               TO WS-ST-ACCESS.                 
009624     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.                  
009625     MOVE '3'                    TO CNTL-REC-TYPE.                
009626     MOVE +0                     TO CNTL-SEQ-NO.                  
009627     MOVE 'STAT'                 TO FILE-SWITCH.                  
009628                                                                  
009629     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.                    
009630                                                                  
009631     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.              
009632     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.                 
009633                                                                  
009634     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'    
009635        GO TO 7020-BYPASS-BENEFIT.                                
009636                                                                  
009637     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
009638     MOVE '4'                    TO CNTL-REC-TYPE.                
009639     MOVE +0                     TO CNTL-SEQ-NO.                  
009640     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.                    
009641     MOVE WS-ACCESS              TO CNTL-ACCESS.                  
009642     MOVE 'BENE'                 TO FILE-SWITCH.                  
009643                                                                  
009644     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    
009645                                                                  
009646     IF NO-BENEFIT-FOUND                                          
009647        GO TO 7020-BYPASS-BENEFIT.                                
009648                                                                  
009649     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.   
009650     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.  
009651     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE. 
009652                                                                  
009653 7020-BYPASS-BENEFIT.                                             
009654                                                                  
009655*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
009656*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT               
009657*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.                         
009658                                                                  
009659     move zeros                  to PI-MAX-BENEFIT-AMT            
009660     move cm-ah-benefit-cd       to pi-ah-benefit-cd              
009661     move cm-ah-orig-term        to pi-ah-term                    
009662     move cm-ah-benefit-amt      to pi-ah-benefit-amt             
009663                                                                  
009664     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND         
009665          'G' and 'F'                                             
009666          AND 'B' AND 'H'                                         
009667         GO TO 7021-GO-TO-LIFE.                                   
009668                                                                  
009669     move cl-insured-birth-dt    to dc-bin-date-1                 
009670     move cl-incurred-dt         to dc-bin-date-2                 
009671     move '1'                    to dc-option-code                
009672     PERFORM 9700-LINK-DATE-CONVERT                               
009673                                 THRU 9700-EXIT                   
009674     compute ws-att-age =                                         
009675        dc-elapsed-months / 12                                    
009676     move zeros to dc-elapsed-months dc-elapsed-days              
009677                                                                  
009678     IF (PI-COMPANY-ID = 'DCC' or 'VPP')                          
009679        and (acct-found)                                          
009680        AND (PI-DCC-PRODUCT-CODE not = '   ')                     
009681        PERFORM 0900-GET-DDF-limits                               
009682                                 THRU 0900-EXIT                   
009683        IF PDEF-FOUND                                             
009684           PERFORM VARYING P1 FROM +1 BY +1 UNTIL                 
009685              (P1 > +11)                                          
009686              OR ((PD-PROD-CODE (P1) = cl-claim-type)             
009687              AND (PD-MAX-ATT-AGE (P1) >= WS-ATT-AGE))            
009688           END-PERFORM                                            
009689           IF P1 < +12                                            
009690              if pd-ben-pct (p1) not numeric                      
009691                 move zeros      to pd-ben-pct (p1)               
009692              end-if                                              
009693              if pd-ben-pct (p1) = zeros                          
009694                 move +1         to ws-work-ben-pct               
009695              else                                                
009696                 move pd-ben-pct (p1)                             
009697                                 to ws-work-ben-pct               
009698              end-if                                              
009699              compute cm-ah-benefit-amt =                         
009700                 cm-ah-benefit-amt * ws-work-ben-pct              
009701              move pd-max-amt (p1) to pi-max-benefit-amt          
009702              if pd-wait-days(p1) not numeric                     
009703                 move zeros      to pd-wait-days(p1)              
009704              end-if                                              
009705           END-IF                                                 
009706        END-IF                                                    
009707     end-if                                                       
009708                                                                  
009709     MOVE 'A'                    TO CP-BENEFIT-TYPE.              
009710     MOVE 'MO. BENEFIT :'        TO BENECAPO.                     
009711     if (pi-max-benefit-amt not = zeros)                          
009712        and (cm-ah-benefit-amt > pi-max-benefit-amt)              
009713        move pi-max-benefit-amt  to beneo                         
009714     else                                                         
009715        MOVE CM-AH-BENEFIT-AMT   TO BENEO                         
009716     end-if                                                       
009717     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.                 
009718     MOVE CM-AH-ORIG-TERM        TO WST-ORIG                      
009719                                    CP-ORIGINAL-TERM.             
009720     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.                    
009721                                                                  
009722*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
009723*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1               
009724*    ELSE                                                         
009725         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.              
009726                                                                  
009727     MOVE ' '                    TO DC-OPTION-CODE.               
009728     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
009729     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.                      
009730                                                                  
009731     IF PI-COMPANY-ID = 'DMD'                                     
009732         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT           
009733         GO TO 7023-BYPASS-REMAINING-TERM.                        
009734                                                                  
009735     MOVE SPACES                 TO WST-REM-DAYS-GRP.             
009736     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.              
009737     GO TO 7022-AROUND-LIFE.                                      
009738                                                                  
009739 7021-GO-TO-LIFE.                                                 
009740                                                                  
009741     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              
009742     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.                 
009743     MOVE CM-LF-ORIG-TERM        TO WST-ORIG                      
009744                                    CP-ORIGINAL-TERM.             
009745     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.            
009746     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.           
009747     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.              
009748     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.                    
009749                                                                  
009750     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
009751         MOVE WS-EXP-DT            TO DC-BIN-DATE-1               
009752     ELSE                                                         
009753         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.              
009754                                                                  
009755     MOVE ' '                    TO DC-OPTION-CODE.               
009756     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
009757     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.                      
009758                                                                  
009759 7022-AROUND-LIFE.                                                
009760                                                                  
009761     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.                
009762     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.               
009763     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.            
009764     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.       
009765     MOVE '4'                    TO CP-REM-TERM-METHOD.           
009766     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.                   
009767     MOVE CP-REMAINING-TERM-3    TO WST-REM.                      
009768                                                                  
009769     MOVE SPACES                 TO WST-REM-DAYS-GRP.             
009770                                                                  
009771     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'    
009772        OR 'B' OR 'H'                                             
009773        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM                  
009774           MOVE CM-AH-ORIG-TERM  TO WST-REM.                      
009775                                                                  
009776     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'                
009777        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM                  
009778           MOVE CM-LF-ORIG-TERM  TO WST-REM.                      
009779                                                                  
009780 7023-BYPASS-REMAINING-TERM.                                      
009781                                                                  
009782     move zeros                  to ws-max-tot-ben                
009783                                    ws-work-ben-pct               
009784                                                                  
009785     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'                
009786       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'                
009787          MOVE ZEROS                  TO BENEO                    
009788       ELSE                                                       
009789          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE          
009790          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID            
009791          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM         
009792          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT      
009793          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT     
009794          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM        
009795          MOVE CM-LOAN-APR            TO CP-LOAN-APR              
009796          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM             
009797          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY         
009798          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD        
009799          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD       
009800          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV       
009801                                                                  
009802          move cl-insured-birth-dt                                
009803                                 to dc-bin-date-1                 
009804          move cl-incurred-dt    to dc-bin-date-2                 
009805          move '1'               to dc-option-code                
009806          PERFORM 9700-LINK-DATE-CONVERT                          
009807                                 THRU 9700-EXIT                   
009808          compute ws-att-age =                                    
009809              dc-elapsed-months / 12                              
009810           move zeros to dc-elapsed-months dc-elapsed-days        
009811                                                                  
009812          IF (PI-COMPANY-ID = 'DCC' or 'VPP')                     
009813             AND (PI-DCC-PRODUCT-CODE not = '   ')                
009814             PERFORM 0900-GET-DDF-limits                          
009815                                 THRU 0900-EXIT                   
009816             IF PDEF-FOUND                                        
009817                PERFORM VARYING P1 FROM +1 BY +1 UNTIL            
009818                   (P1 > +11)                                     
009819                   OR (PD-PROD-CODE (P1) = cl-claim-type          
009820                        and PD-MAX-ATT-AGE (P1) >= WS-ATT-AGE )   
009821                END-PERFORM                                       
009822                IF P1 < +12                                       
009823                   MOVE PD-MAX-AMT (P1)                           
009824                                 TO ws-MAX-TOT-BEN                
009825                   if pd-ben-pct (p1) not numeric                 
009826                      move zeros to pd-ben-pct (p1)               
009827                   end-if                                         
009828                   if pd-ben-pct (p1) = zeros                     
009829                      move +1    to ws-work-ben-pct               
009830                   else                                           
009831                      move pd-ben-pct (p1)                        
009832                                 to ws-work-ben-pct               
009833                   end-if                                         
009834                END-IF                                            
009835             END-IF                                               
009836          END-IF                                                  
009837                                                                  
009838          EXEC CICS LINK                                          
009839             PROGRAM  (LINK-REMAMT)                               
009840             COMMAREA (CALCULATION-PASS-AREA)                     
009841             LENGTH   (CP-COMM-LENGTH)                            
009842          END-EXEC                                                
009843          MOVE CP-REMAINING-AMT       TO BENEO                    
009844       end-if                                                     
009845     end-if                                                       
009846                                                                  
009847     MOVE ELMSTR-KEY             TO ELTRLR-KEY                    
009848     MOVE +95                    TO TRLR-SEQ-NO                   
009849     EXEC CICS READ                                               
009850        DATASET  ('ELTRLR')                                       
009851        SET      (ADDRESS OF ACTIVITY-TRAILERS)                   
009852        RIDFLD   (ELTRLR-KEY)                                     
009853        RESP     (WS-RESPONSE)                                    
009854     END-EXEC                                                     
009855                                                                  
009856     if ws-resp-normal                                            
009857        perform varying s1 from +1 by +1 until                    
009858           at-note-error-no (s1) = spaces                         
009859           move at-note-error-no (s1)                             
009860                                 to emi-error                     
009861           if at-note-error-no (s1) = '1653'                      
009862              evaluate true                                       
009863                 when cl-claim-type = 'L'                         
009864                    move '  LF  '                                 
009865                                 to emi-claim-type                
009866                 when cl-claim-type = 'I'                         
009867                    move '  IU  '                                 
009868                                 to emi-claim-type                
009869                 when cl-claim-type = 'F'                         
009870                    move ' FMLA '                                 
009871                                 to emi-claim-type                
009872                 when cl-claim-type = 'B'                         
009873                    move ' BRV  '                                 
009874                                 to emi-claim-type                
009875                 when cl-claim-type = 'H'                         
009876                    move ' HOSP '                                 
009877                                 to emi-claim-type                
009878                 when cl-claim-type = 'O'                         
009879                    move ' OTH '                                  
009880                                 to emi-claim-type                
009881                 when other                                       
009882                    move '  AH  '                                 
009883                                 to emi-claim-type                
009884              end-evaluate                                        
009885           end-if                                                 
009886           PERFORM 9900-ERROR-FORMAT                              
009887                                 THRU 9900-EXIT                   
009888        end-perform                                               
009889     end-if                                                       
009890                                                                  
009891    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'                 
009892         IF PI-LIFE-OVERRIDE-L1 = 'P' OR                          
009893            WS-LF-COVERAGE-TYPE = 'P'                             
009894             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -       
009895                                        CM-LF-ITD-DEATH-AMT       
009896             MOVE WS-REMAINING-AMT  TO  BENEO.                    
009897                                                                  
009898     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.              
009899     MOVE BENEO                  TO PI-REM-BEN-AMT.               
009900     MOVE WS-TERMS               TO TERMSO.                       
009901                                                                  
009902     IF WS-STATUS = '6' OR '7' OR '8'                             
009903         MOVE AL-SABOF           TO CRTSTATA.                     
009904                                                                  
009905     IF WS-STATUS = '1' OR '4'                                    
009906        IF CP-REMAINING-TERM-3 = ZEROS                            
009907           MOVE 'EXPIRED'        TO CRTSTATO                      
009908        ELSE                                                      
009909           MOVE 'ACTIVE  '       TO CRTSTATO.                     
009910                                                                  
009911     IF WS-STATUS = '2'                                           
009912         MOVE 'PEND    '         TO CRTSTATO.                     
009913                                                                  
009914     IF WS-STATUS = '3'                                           
009915         MOVE 'RESTORE '         TO CRTSTATO.                     
009916                                                                  
009917     IF WS-STATUS = '5'                                           
009918         MOVE 'REISSUE '         TO CRTSTATO.                     
009919                                                                  
009920     IF WS-STATUS = '6'                                           
009921         MOVE 'LMP DIS'          TO CRTSTATO.                     
009922                                                                  
009923     IF WS-STATUS = '7'                                           
009924         MOVE 'DEATH'            TO CRTSTATO.                     
009925                                                                  
009926     IF WS-STATUS = '8'                                           
009927         MOVE 'CANCEL'           TO CRTSTATO.                     
009928                                                                  
009929     IF WS-STATUS = '9'                                           
009930         MOVE 'RE-ONLY '         TO CRTSTATO.                     
009931                                                                  
009932     IF WS-STATUS = 'V'                                           
009933         MOVE 'VOID  '           TO CRTSTATO.                     
009934                                                                  
009935     IF WS-STATUS = 'D'                                           
009936         MOVE 'DECLINE '         TO CRTSTATO.                     
009937                                                                  
009938     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'    
009939         OR 'B' OR 'H'                                            
009940         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD                     
009941         MOVE '5'                TO CNTL-REC-TYPE                 
009942     ELSE                                                         
009943         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD                     
009944         MOVE '4'                TO CNTL-REC-TYPE.                
009945                                                                  
009946     MOVE '** NONE **'           TO COVERO.                       
009947     MOVE AL-SABON               TO COVERA.                       
009948                                                                  
009949     IF PI-COMPANY-ID = 'CVL'                                     
009950         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES            
009951             MOVE CM-BENEFICIARY TO LOANNOO                       
009952             MOVE AL-UANON       TO LOANNOA.                      
009953                                                                  
009954     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'          
009955           OR 'FNL'                                               
009956        MOVE ELMSTR-KEY          TO  ELTRLR-KEY                   
009957        MOVE +91                 TO  TRLR-SEQ-NO                  
009958        EXEC CICS READ                                            
009959            DATASET  ('ELTRLR')                                   
009960            SET      (ADDRESS OF ACTIVITY-TRAILERS)               
009961            RIDFLD   (ELTRLR-KEY)                                 
009962            RESP     (WS-RESPONSE)                                
009963        END-EXEC                                                  
009964                                                                  
009965        IF WS-RESP-NORMAL                                         
009966           MOVE AT-INFO-LINE-1   TO  LOANNOO                      
009967        ELSE                                                      
009968           MOVE SPACES           TO  LOANNOO                      
009969        END-IF                                                    
009970*052506                                                           
009971*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT       
009972*052506                                                           
009973     END-IF                                                       
009974                                                                  
009975     IF CL-PROG-FORM-TYPE = 'S' OR 'L'                            
009976        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.                     
009977                                                                  
009978     IF WS-BEN-CD = ZEROS                                         
009979         GO TO 7050-SHOW-CONTINUE.                                
009980                                                                  
009981     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.                 
009982     MOVE WS-ACCESS              TO CNTL-ACCESS.                  
009983     MOVE +0                     TO CNTL-SEQ-NO.                  
009984     MOVE 'BENE'                 TO FILE-SWITCH.                  
009985                                                                  
009986     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    
009987                                                                  
009988     IF BENEFIT-FOUND                                             
009989        MOVE CF-JOINT-INDICATOR (SUB-1)                           
009990                                 TO PI-JOINT-COV-IND              
009991                                    PI-RB-JOINT-COV-IND           
009992        MOVE CF-BENEFIT-DESCRIP (SUB-1)                           
009993                                 TO COVERO                        
009994        MOVE AL-SANON            TO COVERA                        
009995     END-IF                                                       
009996                                                                  
009997     if (cntl-rec-type = '4')   *> Life claim                     
009998        and (cm-ah-benefit-cd not = zeros) *> AH coverage         
009999        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID                     
010000        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD                        
010001        MOVE '5'              TO CNTL-REC-TYPE                    
010002        MOVE WS-ACCESS        TO CNTL-ACCESS                      
010003        MOVE +0               TO CNTL-SEQ-NO                      
010004        MOVE 'BENE'           TO FILE-SWITCH                      
010005        PERFORM 7200-FIND-BENEFIT                                 
010006                              THRU 7200-EXIT                      
010007        IF (BENEFIT-FOUND)                                        
010008           and (pi-rb-joint-cov-ind) not = 'J'                    
010009           MOVE CF-JOINT-INDICATOR (SUB-1)                        
010010                              TO PI-rb-JOINT-COV-IND              
010011        end-if                                                    
010012     end-if                                                       
010013                                                                  
010014     .                                                            
010015 7050-SHOW-CONTINUE.                                              
010016                                                                  
010017     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE                
010018        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO               
010019            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED                   
010020     END-IF                                                       
010021                                                                  
010022     IF PI-COMPANY-ID = 'DMD'                                     
010023         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.            
010024                                                                  
010025     MOVE -1                     TO PMTTYPEL.                     
010026     GO TO 8100-SEND-INITIAL-MAP.                                 
010027                                                                  
010028 7100-SHOW-RECORD-NOT-FOUND.                                      
010029     IF FILE-SWITCH = 'MSTR'                                      
010030         MOVE ER-0204            TO EMI-ERROR.                    
010031                                                                  
010032     IF FILE-SWITCH = 'CERT'                                      
010033         MOVE ER-0206            TO EMI-ERROR.                    
010034                                                                  
010035     IF FILE-SWITCH = 'STAT'                                      
010036         MOVE ER-0149            TO EMI-ERROR.                    
010037                                                                  
010038     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
010039                                                                  
010040     MOVE -1                     TO PMTTYPEL.                     
010041     GO TO 8100-SEND-INITIAL-MAP                                  
010042                                                                  
010043     .                                                            
010044 7110-BUILD-PMT-TRLR.                                             
010045                                                                  
010046     MOVE ELMSTR-KEY             TO ELTRLR-KEY                    
010047     MOVE +51                    TO TRLR-SEQ-NO                   
010048                                                                  
010049     EXEC CICS READ                                               
010050         DATASET  ('ELTRLR')                                      
010051         SET      (ADDRESS OF ACTIVITY-TRAILERS)                  
010052         RIDFLD   (ELTRLR-KEY)                                    
010053         RESP     (WS-RESPONSE)                                   
010054     END-EXEC                                                     
010055                                                                  
010056     IF WS-RESP-NORMAL                                            
010057        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME                 
010058     END-IF                                                       
010059                                                                  
010060     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT                           
010061                                                                  
010062     EXEC CICS GETMAIN                                            
010063          SET       (ADDRESS OF ACTIVITY-TRAILERS)                
010064          LENGTH    (200)                                         
010065          INITIMG   (GETMAIN-SPACE)                               
010066      END-EXEC                                                    
010067                                                                  
010068     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT           
010069                                    AT-PREV-PAID-THRU-DT          
010070     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT          
010071     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY            
010072     MOVE 'AT'                   TO AT-RECORD-ID                  
010073     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO                
010074                                                                  
010075     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO        
010076                                                                  
010077     MOVE '2'                    TO AT-TRAILER-TYPE               
010078     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT                
010079                                    AT-PAYMENT-LAST-MAINT-DT      
010080     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY                
010081                                    AT-PAYMENT-LAST-UPDATED-BY    
010082     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS          
010083     MOVE 'I'                    TO AT-PAYMENT-TYPE               
010084     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE                 
010085     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE            
010086                                                                  
010087     MOVE +0                     TO AT-EXPENSE-PER-PMT            
010088     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID                
010089                                                                  
010090     MOVE LOW-VALUES             TO AT-PAID-FROM-DT               
010091     MOVE LOW-VALUES             TO AT-PAID-THRU-DT               
010092                                                                  
010093     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD             
010094     MOVE PI-INT-RATE-USED       TO AT-INT-RATE                   
010095                                                                  
010096     if pi-int-to-rem-borr = 'Y'                                  
010097        move 'Q1'                to at-payee-type-cd              
010098     else                                                         
010099        MOVE 'O1'                TO AT-PAYEE-TYPE-CD              
010100     end-if                                                       
010101     MOVE PI-int-payees-name     TO AT-PAYEES-NAME                
010102                                                                  
010103     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT              
010104     MOVE '3'                    TO AT-PAYMENT-ORIGIN             
010105                                                                  
010106     MOVE SPACES                 TO AT-AIG-UNEMP-IND              
010107                                                                  
010108     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT           
010109                                    AT-TO-BE-WRITTEN-DT           
010110                                                                  
010111     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL          
010112                                    AT-CHECK-QUE-SEQUENCE         
010113                                    AT-ADDL-RESERVE               
010114                                                                  
010115     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT              
010116                                    AT-VOID-SELECT-DT             
010117                                    AT-VOID-ACCEPT-DT             
010118                                    AT-VOID-DT                    
010119                                    AT-PMT-PROOF-DT               
010120                                    AT-INT-PMT-SELECT-DT          
010121                                                                  
010122     MOVE ZEROS                  TO AT-DAILY-RATE                 
010123                                    AT-ELIMINATION-DAYS           
010124     MOVE SPACES                 TO AT-BENEFIT-TYPE               
010125                                                                  
010126*    EXEC CICS HANDLE CONDITION                                   
010127*        DUPREC    (7120-DUPREC)                                  
010128*    END-EXEC                                                     
010129                                                                  
010130     .                                                            
010131 7115-WRITE-INT-TRLR.                                             
010132                                                                  
010133     EXEC CICS WRITE                                              
010134          DATASET       ('ELTRLR')                                
010135          FROM          (ACTIVITY-TRAILERS)                       
010136          RIDFLD        (AT-CONTROL-PRIMARY)                      
010137          RESP          (WS-RESPONSE)                             
010138      END-EXEC                                                    
010139                                                                  
010140      IF WS-RESP-DUPREC                                           
010141         GO TO 7120-DUPREC                                        
010142      END-IF                                                      
010143                                                                  
010144     GO TO 7130-EXIT                                              
010145                                                                  
010146     .                                                            
010147 7120-DUPREC.                                                     
010148                                                                  
010149     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT          
010150     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO               
010151     GO TO 7115-WRITE-INT-TRLR                                    
010152                                                                  
010153     .                                                            
010154 7130-EXIT.                                                       
010155      EXIT.                                                       
010156                                                                  
010157 7140-BUILD-NOTE-TRLR.                                            
010158                                                                  
010159     EXEC CICS GETMAIN                                            
010160          SET       (ADDRESS OF ACTIVITY-TRAILERS)                
010161          LENGTH    (200)                                         
010162          INITIMG   (GETMAIN-SPACE)                               
010163      END-EXEC                                                    
010164                                                                  
010165     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT          
010166                                                                  
010167     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY            
010168     MOVE 'AT'                   TO AT-RECORD-ID                  
010169     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO                
010170     MOVE '6'                    TO AT-TRAILER-TYPE               
010171     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT                
010172                                    AT-GEN-INFO-LAST-MAINT-DT     
010173     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY                
010174                                    AT-GEN-INFO-LAST-UPDATED-BY   
010175     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS          
010176                                                                  
010177     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1                
010178                                                                  
010179     .                                                            
010180 7150-WRITE.                                                      
010181                                                                  
010182     EXEC CICS HANDLE CONDITION                                   
010183         DUPREC    (7160-DUPREC)                                  
010184     END-EXEC                                                     
010185                                                                  
010186     EXEC CICS WRITE                                              
010187          DATASET     ('ELTRLR')                                  
010188          FROM        (ACTIVITY-TRAILERS)                         
010189          RIDFLD      (AT-CONTROL-PRIMARY)                        
010190          RESP        (WS-RESPONSE)                               
010191      END-EXEC                                                    
010192                                                                  
010193      IF WS-RESP-DUPREC                                           
010194         GO TO 7160-DUPREC                                        
010195      END-IF                                                      
010196                                                                  
010197     GO TO 7170-EXIT                                              
010198                                                                  
010199     .                                                            
010200 7160-DUPREC.                                                     
010201                                                                  
010202     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT          
010203     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO               
010204     GO TO 7150-WRITE                                             
010205                                                                  
010206     .                                                            
010207 7170-EXIT.                                                       
010208      EXIT.                                                       
010209                                                                  
010210 7180-ADD-CERT-NOTE.                                              
010211*ADD CERT NOTE FOR SC NP+6                                        
010212                                                                  
010213     EXEC CICS GETMAIN                                            
010214          SET       (ADDRESS OF CERT-NOTE-FILE)                   
010215          LENGTH    (150)                                         
010216          INITIMG   (GETMAIN-SPACE)                               
010217      END-EXEC.                                                   
010218                                                                  
010219     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.            
010220     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.            
010221     MOVE +1                     TO WRK-NOTE-SEQ.                 
010222     MOVE LOW-VALUES             TO CERT-NOTE-FILE.               
010223     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.                
010224     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.                   
010225     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.                  
010226     MOVE CL-CERT-STATE          TO CZ-STATE.                     
010227     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.                   
010228     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.               
010229     MOVE CL-CERT-NO             TO CZ-CERT-NO.                   
010230     MOVE '2'                    TO CZ-RECORD-TYPE.               
010231     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.             
010232     MOVE 'CZ'                   TO CZ-RECORD-ID.                 
010233     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.             
010234     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.         
010235     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.           
010236     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.               
010237     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.                  
010238                                                                  
010239     MOVE ' + 6 MO '             TO SC-NP6-COMM                   
010240     IF PI-COMPANY-ID = 'AHL'                                     
010241        IF PI-LF-BENEFIT-CD = '5I' OR '6J'                        
010242           CONTINUE                                               
010243        ELSE                                                      
010244           IF PI-LF-BENEFIT-CD = '5M' OR '6M'                     
010245              MOVE ' + 1 MO '    TO SC-NP6-COMM                   
010246           ELSE                                                   
010247              MOVE ' + 2 MO '    TO SC-NP6-COMM                   
010248           END-IF                                                 
010249        END-IF                                                    
010250     END-IF                                                       
010251                                                                  
010252     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.              
010253     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.                      
010254                                                                  
010255 7181-WRITE.                                                      
010256                                                                  
010257     EXEC CICS WRITE                                              
010258          DATASET     ('ERCNOT')                                  
010259          FROM        (CERT-NOTE-FILE)                            
010260          RIDFLD      (CZ-CONTROL-PRIMARY)                        
010261          RESP        (WS-RESPONSE)                               
010262     END-EXEC.                                                    
010263                                                                  
010264     IF WS-RESP-DUPREC                                            
010265         GO TO 7182-DUPREC                                        
010266     END-IF.                                                      
010267                                                                  
010268     SET CERT-NOTE-ADDED TO TRUE.                                 
010269                                                                  
010270     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT                           
010271         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT                
010272     END-IF.                                                      
010273                                                                  
010274     GO TO 7189-EXIT.                                             
010275                                                                  
010276 7182-DUPREC.                                                     
010277                                                                  
010278     ADD +1                      TO  WRK-NOTE-SEQ.                
010279     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.            
010280     GO TO 7181-WRITE.                                            
010281                                                                  
010282 7189-EXIT.                                                       
010283      EXIT.                                                       
010284                                                                  
010285 7190-ADD-ORIG-NOTE.                                              
010286                                                                  
010287     EXEC CICS GETMAIN                                            
010288          SET       (ADDRESS OF CERT-NOTE-FILE)                   
010289          LENGTH    (150)                                         
010290          INITIMG   (GETMAIN-SPACE)                               
010291      END-EXEC.                                                   
010292                                                                  
010293     ADD +1                      TO WRK-NOTE-SEQ.                 
010294     MOVE LOW-VALUES             TO CERT-NOTE-FILE.               
010295     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.                
010296     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.                   
010297     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.                  
010298     MOVE CL-CERT-STATE          TO CZ-STATE.                     
010299     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.                   
010300     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.               
010301     MOVE CL-CERT-NO             TO CZ-CERT-NO.                   
010302     MOVE '2'                    TO CZ-RECORD-TYPE.               
010303     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.             
010304     MOVE 'CZ'                   TO CZ-RECORD-ID.                 
010305     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.             
010306     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.         
010307     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.           
010308     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.                      
010309                                                                  
010310 7191-WRITE.                                                      
010311                                                                  
010312     EXEC CICS WRITE                                              
010313          DATASET     ('ERCNOT')                                  
010314          FROM        (CERT-NOTE-FILE)                            
010315          RIDFLD      (CZ-CONTROL-PRIMARY)                        
010316          RESP        (WS-RESPONSE)                               
010317     END-EXEC.                                                    
010318                                                                  
010319     IF WS-RESP-DUPREC                                            
010320         GO TO 7192-DUPREC                                        
010321     END-IF.                                                      
010322                                                                  
010323     GO TO 7199-EXIT.                                             
010324                                                                  
010325 7192-DUPREC.                                                     
010326                                                                  
010327     ADD +1                      TO  WRK-NOTE-SEQ.                
010328     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.            
010329     GO TO 7191-WRITE.                                            
010330                                                                  
010331 7199-EXIT.                                                       
010332      EXIT.                                                       
010333                                                                  
010334 7200-FIND-BENEFIT.                                               
010335     MOVE 'N' TO WS-BEN-SEARCH-SW.                                
010336                                                                  
010337     EXEC CICS HANDLE CONDITION                                   
010338         ENDFILE(7200-EXIT)                                       
010339         NOTFND(7200-EXIT)                                        
010340     END-EXEC.                                                    
010341                                                                  
010342     EXEC CICS READ                                               
010343         DATASET('ELCNTL')                                        
010344         SET(ADDRESS OF CONTROL-FILE)                             
010345         RIDFLD(ELCNTL-KEY)                                       
010346         GTEQ                                                     
010347     END-EXEC.                                                    
010348                                                                  
010349     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR                     
010350        CNTL-REC-TYPE NOT = CF-RECORD-TYPE                        
010351           GO TO 7200-EXIT.                                       
010352                                                                  
010353     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT              
010354         VARYING SUB-1 FROM 1 BY 1 UNTIL                          
010355            ((SUB-1 > 8) OR                                       
010356            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).               
010357                                                                  
010358     IF SUB-1 NOT = 9                                             
010359         MOVE 'Y' TO WS-BEN-SEARCH-SW.                            
010360                                                                  
010361     GO TO 7200-EXIT.                                             
010362                                                                  
010363 7200-BENEFIT-DUMMY.                                              
010364                                                                  
010365 7200-DUMMY-EXIT.                                                 
010366     EXIT.                                                        
010367                                                                  
010368 7200-EXIT.                                                       
010369     EXIT.                                                        
010370     EJECT                                                        
010371*052506                                                           
010372*052506 7250-FIND-LETTER-TRLR.                                    
010373*052506     EXEC CICS HANDLE CONDITION                            
010374*052506         ENDFILE  (7250-END)                               
010375*052506         NOTFND   (7250-END)                               
010376*052506     END-EXEC.                                             
010377*052506                                                           
010378*052506     EXEC CICS STARTBR                                     
010379*052506         DATASET   ('ELTRLR')                              
010380*052506         RIDFLD    (ELTRLR-KEY)                            
010381*052506         GTEQ                                              
010382*052506     END-EXEC.                                             
010383*052506                                                           
010384*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.           
010385*052506                                                           
010386*052506 7250-FIND-LOOP.                                           
010387*052506     EXEC CICS READNEXT                                    
010388*052506         DATASET   ('ELTRLR')                              
010389*052506         RIDFLD    (ELTRLR-KEY)                            
010390*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)          
010391*052506     END-EXEC.                                             
010392*052506                                                           
010393*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR               
010394*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR               
010395*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR               
010396*052506        PI-CERT-NO    NOT = TRLR-CERT-NO                   
010397*052506        GO TO 7250-END                                     
010398*052506     END-IF.                                               
010399*052506                                                           
010400*052506     IF AT-TRAILER-TYPE NOT = '4'                          
010401*052506         GO TO 7250-FIND-LOOP                              
010402*052506     END-IF.                                               
010403*052506                                                           
010404*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
010405*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
010406*052506     END-IF.                                               
010407*052506                                                           
010408*052506     GO TO 7250-FIND-LOOP.                                 
010409*052506                                                           
010410*052506 7250-END.                                                 
010411*052506                                                           
010412*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
010413*051506         MOVE SPACES             TO  DC-OPTION-CODE        
010414*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1    
010415*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT     
010416*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE        
010417*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO                  
010418*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'      
010419*052506     END-IF.                                               
010420*052506                                                           
010421*052506     EXEC CICS ENDBR                                       
010422*052506          DATASET    ('ELTRLR')                            
010423*052506     END-EXEC.                                             
010424*052506                                                           
010425*052506 7250-EXIT.                                                
010426*052506     EXIT.                                                 
010427*052506     EJECT                                                 
010428*052506                                                           
010429 7300-CHECK-AUTO-ACTIVITY.                                        
010430                                                                  
010431     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'                     
010432         NEXT SENTENCE                                            
010433     ELSE                                                         
010434         GO TO 7399-EXIT.                                         
010435                                                                  
010436     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.             
010437                                                                  
010438     IF WS-ACT-REC-FOUND-SW = 'N'                                 
010439         GO TO 7399-EXIT.                                         
010440                                                                  
010441     IF PI-ACTIVITY-CODE = 09                                     
010442         GO TO 7300-CONT-AUTO-ACTIVITY.                           
010443                                                                  
010444     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND                      
010445        (PI-ACTIVITY-CODE = 11)                                   
010446         GO TO 7300-CONT-AUTO-ACTIVITY.                           
010447                                                                  
010448     IF PI-PROVISIONAL-IND = 'P'                                  
010449         IF PI-PMTTYPE = '1'                                      
010450             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'                 
010451                 MOVE 'N'    TO  PI-RESET-SW                      
010452                 GO TO 7399-EXIT.                                 
010453                                                                  
010454     IF PI-PMTTYPE = '1'                                          
010455         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'                     
010456             MOVE 'N'        TO  PI-RESET-SW                      
010457             GO TO 7399-EXIT.                                     
010458                                                                  
010459     IF PI-PMTTYPE = '2' OR '3'                                   
010460         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'                     
010461             MOVE 'N'        TO  PI-RESET-SW                      
010462             GO TO 7399-EXIT.                                     
010463                                                                  
010464     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
010465         IF PI-PROVISIONAL-IND = 'P'                              
010466             NEXT SENTENCE                                        
010467         ELSE                                                     
010468             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.     
010469                                                                  
010470 7300-CONT-AUTO-ACTIVITY.                                         
010471                                                                  
010472     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4                          
010473         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY                
010474         MOVE '4'            TO DC-OPTION-CODE                    
010475         MOVE +0             TO DC-ELAPSED-DAYS                   
010476                                DC-ELAPSED-MONTHS                 
010477         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT            
010478         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT                    
010479         IF PI-USES-PAID-TO                                       
010480             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT        
010481             IF NO-CONVERSION-ERROR                               
010482                 MOVE +1     TO DC-ELAPSED-DAYS                   
010483                 MOVE +0     TO DC-ELAPSED-MONTHS                 
010484                 MOVE '6'    TO DC-OPTION-CODE                    
010485                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT    
010486                 IF NO-CONVERSION-ERROR                           
010487                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.      
010488                                                                  
010489     IF PI-PFKEY-USED = DFHPF5                                    
010490         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT                        
010491         IF PI-USES-PAID-TO                                       
010492             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1            
010493             MOVE +1                  TO DC-ELAPSED-DAYS          
010494             MOVE +0                  TO DC-ELAPSED-MONTHS        
010495             MOVE '6'                 TO DC-OPTION-CODE           
010496             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT        
010497             IF NO-CONVERSION-ERROR                               
010498                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.          
010499                                                                  
010500     IF WS-CHK-THRU-DT < PI-EXP-DT                                
010501         NEXT SENTENCE                                            
010502     ELSE                                                         
010503         MOVE 03                     TO  WS-ACTIVITY-CODE         
010504         GO TO 7390-PROCESS-ACTIVITY.                             
010505                                                                  
010506     IF PI-PROV-PMT                                               
010507         MOVE 09                     TO  WS-ACTIVITY-CODE         
010508     ELSE                                                         
010509        IF PI-PMTTYPE = '1'                                       
010510            MOVE 02                  TO  WS-ACTIVITY-CODE         
010511        ELSE                                                      
010512        IF PI-PMTTYPE = '2' OR '3'                                
010513            MOVE 07                  TO  WS-ACTIVITY-CODE         
010514        ELSE                                                      
010515        IF PI-PMTTYPE = '4'                                       
010516            MOVE 00                  TO  WS-ACTIVITY-CODE         
010517        ELSE                                                      
010518            MOVE 'N'                 TO  PI-RESET-SW              
010519            GO TO 7399-EXIT.                                      
010520                                                                  
010521 7390-PROCESS-ACTIVITY.                                           
010522                                                                  
010523     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.              
010524                                                                  
010525 7399-EXIT.                                                       
010526     EXIT.                                                        
010527                                                                  
010528     EJECT                                                        
010529 7400-CHECK-AUTO-ACTIVITY.                                        
010530                                                                  
010531     EXEC CICS HANDLE CONDITION                                   
010532         NOTFND   (7400-NOT-FOUND)                                
010533     END-EXEC.                                                    
010534                                                                  
010535     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.                
010536     MOVE 'T'                    TO  CNTL-REC-TYPE.               
010537     MOVE SPACES                 TO  CNTL-ACCESS.                 
010538     MOVE +0                     TO  CNTL-SEQ-NO.                 
010539                                                                  
010540     EXEC CICS READ                                               
010541         DATASET   ('ELCNTL')                                     
010542         RIDFLD    (ELCNTL-KEY)                                   
010543         SET       (ADDRESS OF CONTROL-FILE)                      
010544     END-EXEC.                                                    
010545                                                                  
010546     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.     
010547     GO TO 7400-EXIT.                                             
010548                                                                  
010549 7400-NOT-FOUND.                                                  
010550     MOVE 'N'                        TO  PI-RESET-SW              
010551                                         WS-LETTER-SW             
010552                                         WS-ACT-REC-FOUND-SW.     
010553                                                                  
010554     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
010555                                                                  
010556 7400-EXIT.                                                       
010557     EXIT.                                                        
010558                                                                  
010559     EJECT                                                        
010560 7450-FORMAT-AUTO-LETTER.                                         
010561                                                                  
010562     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES          
010563         MOVE 'Y'                    TO PI-RESET-SW               
010564         GO TO 7450-CONTINUE-PROCESS.                             
010565                                                                  
010566     MOVE PI-ACTIVITY-CODE           TO  SUB.                     
010567                                                                  
010568     IF SUB > 9                                                   
010569         SUBTRACT 9 FROM SUB                                      
010570         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW              
010571     ELSE                                                         
010572         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.             
010573                                                                  
010574 7450-CONTINUE-PROCESS.                                           
010575                                                                  
010576     IF WS-ACTIVITY-CODE = ZEROS                                  
010577         MOVE 'N'                    TO  WS-LETTER-SW             
010578         GO TO 7450-EXIT.                                         
010579                                                                  
010580     MOVE WS-ACTIVITY-CODE           TO  SUB.                     
010581                                                                  
010582     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'                       
010583         MOVE 'N'                    TO  PI-RESET-SW              
010584                                         WS-LETTER-SW             
010585         GO TO 7450-EXIT.                                         
010586                                                                  
010587     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES             
010588         MOVE 'N'                    TO  WS-LETTER-SW             
010589         GO TO 7450-EXIT.                                         
010590                                                                  
010591     MOVE 'Y'                        TO  WS-LETTER-SW.            
010592     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.         
010593     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.   
010594                                                                  
010595     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.       
010596                                                                  
010597     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS                      
010598         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1            
010599         MOVE '6'                    TO  DC-OPTION-CODE           
010600         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS      
010601         MOVE +0                     TO  DC-ELAPSED-MONTHS        
010602         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT            
010603         IF NO-CONVERSION-ERROR                                   
010604             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE       
010605         ELSE                                                     
010606              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.      
010607                                                                  
010608     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS                   
010609         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1            
010610         MOVE '6'                    TO  DC-OPTION-CODE           
010611         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS      
010612         MOVE +0                     TO  DC-ELAPSED-MONTHS        
010613         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT            
010614         IF NO-CONVERSION-ERROR                                   
010615             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE    
010616         ELSE                                                     
010617             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.   
010618                                                                  
010619 7450-EXIT.                                                       
010620     EXIT.                                                        
010621                                                                  
010622     EJECT                                                        
010623 7500-RESET-AUTO-ACTIVITY.                                        
010624                                                                  
010625     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.                
010626     MOVE PI-CARRIER             TO  TRLR-CARRIER.                
010627     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.               
010628     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.                
010629     MOVE +100                   TO  TRLR-SEQ-NO.                 
010630                                                                  
010631 7500-STARTBR-TRLR.                                               
010632                                                                  
010633     EXEC CICS HANDLE CONDITION                                   
010634         ENDFILE  (7590-END)                                      
010635         NOTFND   (7590-END)                                      
010636     END-EXEC.                                                    
010637                                                                  
010638     EXEC CICS STARTBR                                            
010639         DATASET   ('ELTRLR')                                     
010640         RIDFLD    (ELTRLR-KEY)                                   
010641         GTEQ                                                     
010642     END-EXEC.                                                    
010643                                                                  
010644     MOVE 'Y'                        TO  WS-BROWSE-SW.            
010645                                                                  
010646 7500-READ-NEXT.                                                  
010647                                                                  
010648     EXEC CICS READNEXT                                           
010649         DATASET   ('ELTRLR')                                     
010650         RIDFLD    (ELTRLR-KEY)                                   
010651         SET       (ADDRESS OF ACTIVITY-TRAILERS)                 
010652     END-EXEC.                                                    
010653                                                                  
010654     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR                      
010655        PI-CARRIER    NOT = TRLR-CARRIER  OR                      
010656        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR                      
010657        PI-CERT-NO    NOT = TRLR-CERT-NO                          
010658         GO TO 7590-END.                                          
010659                                                                  
010660     IF ELTRLR-KEY = PI-PREV-TRLR-KEY                             
010661         GO TO 7500-READ-NEXT.                                    
010662                                                                  
010663     IF AT-TRAILER-TYPE NOT = '4'                                 
010664         GO TO 7500-READ-NEXT.                                    
010665                                                                  
010666     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES         
010667         GO TO 7500-READ-NEXT.                                    
010668                                                                  
010669     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND         
010670        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)             
010671         GO TO 7500-READ-NEXT.                                    
010672                                                                  
010673     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND                  
010674        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND                  
010675        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE                      
010676         GO TO 7500-READ-NEXT.                                    
010677                                                                  
010678     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)          
010679                         AND                                      
010680        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)        
010681                         AND                                      
010682        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)                       
010683            GO TO 7500-READ-NEXT.                                 
010684                                                                  
010685     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.        
010686                                                                  
010687     EXEC CICS ENDBR                                              
010688         DATASET   ('ELTRLR')                                     
010689     END-EXEC.                                                    
010690                                                                  
010691     MOVE 'N'                        TO  WS-BROWSE-SW.            
010692                                                                  
010693     EXEC CICS READ                                               
010694         DATASET   ('ELTRLR')                                     
010695         RIDFLD    (ELTRLR-KEY)                                   
010696         SET       (ADDRESS OF ACTIVITY-TRAILERS)                 
010697         UPDATE                                                   
010698     END-EXEC.                                                    
010699                                                                  
010700     MOVE 'Y'                        TO  WS-UPDATE-SW.            
010701                                                                  
010702     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE                    
010703         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT       
010704     ELSE                                                         
010705         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE              
010706             NEXT SENTENCE                                        
010707         ELSE                                                     
010708             GO TO 7500-REWRITE-TRLR.                             
010709                                                                  
010710     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.    
010711                                                                  
010712     MOVE PI-COMPANY-CD              TO  ARCH-CO.                 
010713     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.             
010714     MOVE '1'                        TO  ARCH-REC-TYPE.           
010715     MOVE +0                         TO  ARCH-SEQ.                
010716                                                                  
010717     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.                
010718                                                                  
010719 7500-REWRITE-TRLR.                                               
010720                                                                  
010721     EXEC CICS REWRITE                                            
010722         DATASET   ('ELTRLR')                                     
010723         FROM      (ACTIVITY-TRAILERS)                            
010724     END-EXEC.                                                    
010725                                                                  
010726     GO TO 7500-STARTBR-TRLR.                                     
010727                                                                  
010728 7590-END.                                                        
010729                                                                  
010730     IF WS-BROWSE-SW = 'Y'                                        
010731         MOVE 'N'                    TO  WS-BROWSE-SW             
010732         EXEC CICS ENDBR                                          
010733             DATASET   ('ELTRLR')                                 
010734         END-EXEC.                                                
010735                                                                  
010736 7599-EXIT.                                                       
010737     EXIT.                                                        
010738                                                                  
010739     EJECT                                                        
010740 7600-READ-ARCH-UPDATE.                                           
010741                                                                  
010742     EXEC CICS HANDLE CONDITION                                   
010743         NOTFND   (7699-EXIT)                                     
010744     END-EXEC.                                                    
010745                                                                  
010746     EXEC CICS READ                                               
010747         DATASET   ('ELARCH')                                     
010748         RIDFLD    (ELARCH-KEY)                                   
010749         SET       (ADDRESS OF LETTER-ARCHIVE)                    
010750         UPDATE                                                   
010751     END-EXEC.                                                    
010752                                                                  
010753     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.          
010754                                                                  
010755     EXEC CICS REWRITE                                            
010756         DATASET   ('ELARCH')                                     
010757         FROM      (LETTER-ARCHIVE)                               
010758     END-EXEC.                                                    
010759                                                                  
010760 7699-EXIT.                                                       
010761     EXIT.                                                        
010762                                 EJECT                            
010763 7700-GET-DCT.                                                    
010764                                                                  
010765     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.              
010766     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.               
010767     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.               
010768     MOVE ZEROS                  TO PI-INTEREST-PAID-IND          
010769                                    PI-MAX-BENEFIT-AMT            
010770                                    PI-MAX-BENEFIT-PYMT           
010771                                    PI-MIN-PAYMENT-AMT            
010772                                    PI-TIME-OF-LOSS-BAL.          
010773                                                                  
010774     EXEC CICS HANDLE CONDITION                                   
010775          NOTFND (5300-NOTE-NOT-FOUND)                            
010776      END-EXEC.                                                   
010777                                                                  
010778     EXEC CICS READ                                               
010779          DATASET('ERNOTE')                                       
010780          SET    (ADDRESS OF CERTIFICATE-NOTE)                    
010781          RIDFLD (W-NOTE-KEY)                                     
010782      END-EXEC.                                                   
010783                                                                  
010784     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.        
010785     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.          
010786     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.         
010787     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.          
010788     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.         
010789                                                                  
010790     IF PI-PAYEE-TYPE NOT = 'B'                                   
010791         GO TO 7700-EXIT.                                         
010792                                                                  
010793     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.       
010794     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.     
010795     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.       
010796                                                                  
010797     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES                     
010798         MOVE 'CC'                 TO DCT-PRODUCT-CODE            
010799     ELSE                                                         
010800         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.           
010801                                                                  
010802     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.          
010803     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.      
010804     MOVE 'DLO006'               TO PGM-NAME.                     
010805                                                                  
010806     EXEC CICS LINK                                               
010807         PROGRAM    (PGM-NAME)                                    
010808         COMMAREA   (DCT-COMMUNICATION-AREA)                      
010809         LENGTH     (DCT-RCRD-LENGTH)                             
010810     END-EXEC.                                                    
010811                                                                  
010812     IF DCT-RETURN-CODE = 'OK'                                    
010813         GO TO 7700-CONT.                                         
010814                                                                  
010815     IF DCT-RETURN-CODE = '01' OR '02'                            
010816         GO TO 7700-SET-TO-YES.                                   
010817                                                                  
010818     IF DCT-RETURN-CODE = '03'                                    
010819         EXEC CICS SYNCPOINT ROLLBACK END-EXEC                    
010820         MOVE ER-0951            TO EMI-ERROR                     
010821         MOVE -1                 TO PMTTYPEL                      
010822         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
010823         GO TO 8200-SEND-DATAONLY.                                
010824                                                                  
010825     IF DCT-RETURN-CODE = '04'                                    
010826         EXEC CICS SYNCPOINT ROLLBACK END-EXEC                    
010827         MOVE ER-0946            TO EMI-ERROR                     
010828         MOVE -1                 TO PMTTYPEL                      
010829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
010830         GO TO 8200-SEND-DATAONLY.                                
010831                                                                  
010832     IF DCT-RETURN-CODE = '05'                                    
010833         EXEC CICS SYNCPOINT ROLLBACK END-EXEC                    
010834         MOVE ER-0947            TO EMI-ERROR                     
010835         MOVE -1                 TO PMTTYPEL                      
010836         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
010837         GO TO 8200-SEND-DATAONLY.                                
010838                                                                  
010839     IF DCT-RETURN-CODE = '06'                                    
010840         EXEC CICS SYNCPOINT ROLLBACK END-EXEC                    
010841         MOVE ER-0921            TO EMI-ERROR                     
010842         MOVE -1                 TO PMTTYPEL                      
010843         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
010844         GO TO 8200-SEND-DATAONLY.                                
010845                                                                  
010846     IF DCT-RETURN-CODE = '07'                                    
010847         EXEC CICS SYNCPOINT ROLLBACK END-EXEC                    
010848         MOVE ER-0919            TO EMI-ERROR                     
010849         MOVE -1                 TO PMTTYPEL                      
010850         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
010851         GO TO 8200-SEND-DATAONLY.                                
010852                                                                  
010853     IF DCT-RETURN-CODE = '08'                                    
010854         EXEC CICS SYNCPOINT ROLLBACK END-EXEC                    
010855         MOVE ER-0948            TO EMI-ERROR                     
010856         MOVE -1                 TO PMTTYPEL                      
010857         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
010858         GO TO 8200-SEND-DATAONLY.                                
010859                                                                  
010860     IF DCT-RETURN-CODE = 'N1'                                    
010861         EXEC CICS SYNCPOINT ROLLBACK END-EXEC                    
010862         MOVE ER-0950            TO EMI-ERROR                     
010863         MOVE -1                 TO PMTTYPEL                      
010864         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
010865         GO TO 8200-SEND-DATAONLY.                                
010866                                                                  
010867     IF DCT-RETURN-CODE = 'E1'                                    
010868         EXEC CICS SYNCPOINT ROLLBACK END-EXEC                    
010869         MOVE ER-0974            TO EMI-ERROR                     
010870         MOVE -1                 TO PMTTYPEL                      
010871         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
010872         GO TO 8200-SEND-DATAONLY.                                
010873                                                                  
010874     IF DCT-RETURN-CODE = 'E2'                                    
010875         EXEC CICS SYNCPOINT ROLLBACK END-EXEC                    
010876         MOVE ER-0975            TO EMI-ERROR                     
010877         MOVE -1                 TO PMTTYPEL                      
010878         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
010879         GO TO 8200-SEND-DATAONLY.                                
010880                                                                  
010881     IF DCT-RETURN-CODE NOT = 'OK'                                
010882         EXEC CICS SYNCPOINT ROLLBACK END-EXEC                    
010883         MOVE ER-0949            TO EMI-ERROR                     
010884         MOVE -1                 TO PMTTYPEL                      
010885         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 
010886         GO TO 8200-SEND-DATAONLY.                                
010887                                                                  
010888 7700-CONT.                                                       
010889                                                                  
010890*    MOVE 'N'                    TO CASHO.                        
010891*    MOVE +1                     TO CASHL.                        
010892*    MOVE AL-UANON               TO CASHA.                        
010893                                                                  
010894     IF PI-OFFLINE = 'Y'                                          
010895         GO TO 7700-EXIT.                                         
010896                                                                  
010897     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.             
010898     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.             
010899     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.             
010900     MOVE W-DMD-CHECK-NO         TO CHECKNOO.                     
010901     MOVE +7                     TO CHECKNOL.                     
010902     MOVE AL-UANON               TO CHECKNOA.                     
010903     GO TO 7700-EXIT.                                             
010904                                                                  
010905 7700-SET-TO-YES.                                                 
010906                                                                  
010907*    MOVE 'Y'                    TO CASHO.                        
010908*    MOVE +1                     TO CASHL.                        
010909*    MOVE AL-UANON               TO CASHA.                        
010910                                                                  
010911 7700-EXIT.                                                       
010912     EXIT.                                                        
010913                                 EJECT                            
010914 7800-READ-COMP-MSTR.                                             
010915                                                                  
010916     EXEC CICS HANDLE CONDITION                                   
010917         NOTFND   (7800-COMP-NOTFND)                              
010918     END-EXEC.                                                    
010919                                                                  
010920     EXEC CICS READ                                               
010921         DATASET   ('ERCOMP')                                     
010922         RIDFLD    (ERCOMP-KEY)                                   
010923         SET       (ADDRESS OF COMPENSATION-MASTER)               
010924     END-EXEC.                                                    
010925                                                                  
010926     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.             
010927     GO TO 7800-COMP-EXIT.                                        
010928                                                                  
010929 7800-COMP-NOTFND.                                                
010930     MOVE 'N'                    TO  WS-COMP-MSTR-SW.             
010931                                                                  
010932 7800-COMP-EXIT.                                                  
010933     EXIT.                                                        
010934     EJECT                                                        
010935 7900-READ-CLAIM.                                                 
010936     EXEC CICS READ                                               
010937         DATASET  ('ELMSTR')                                      
010938         SET      (ADDRESS OF CLAIM-MASTER)                       
010939         RIDFLD   (ELMSTR-KEY)                                    
010940     END-EXEC.                                                    
010941                                                                  
010942 7900-EXIT.                                                       
010943      EXIT.                                                       
010944                                                                  
010945 7910-READ-CLAIM-UPDATE.                                          
010946     EXEC CICS READ                                               
010947         DATASET  ('ELMSTR')                                      
010948         SET      (ADDRESS OF CLAIM-MASTER)                       
010949         RIDFLD   (ELMSTR-KEY)                                    
010950         UPDATE                                                   
010951     END-EXEC.                                                    
010952                                                                  
010953 7910-EXIT.                                                       
010954      EXIT.                                                       
010955     EJECT                                                        
010956 7920-READ-BENE.                                                  
010957     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.                     
010958     MOVE 'B'                TO BENE-RECORD-TYPE.                 
010959     MOVE CL-BENEFICIARY     TO BENE-NUMBER.                      
010960                                                                  
010961     IF PI-COMPANY-ID = 'AIG' OR 'AUK'                            
010962        IF PI-PAYEE-TYPE    = 'B' AND                             
010963           PI-PAYEE-SEQ-NUM = 9                                   
010964             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING          
010965             MOVE WS-A-BENE           TO BENE-NUMBER.             
010966                                                                  
010967     EXEC CICS HANDLE CONDITION                                   
010968         NOTFND   (7920-NOT-FOUND)                                
010969     END-EXEC.                                                    
010970                                                                  
010971     EXEC CICS READ                                               
010972         DATASET  ('ELBENE')                                      
010973         SET      (ADDRESS OF BENEFICIARY-MASTER)                 
010974         RIDFLD   (ELBENE-KEY)                                    
010975     END-EXEC.                                                    
010976                                                                  
010977     MOVE 'Y' TO BENE-FOUND-SW.                                   
010978     GO TO 7920-EXIT.                                             
010979                                                                  
010980 7920-NOT-FOUND.                                                  
010981     MOVE 'N'                    TO BENE-FOUND-SW.                
010982                                                                  
010983 7920-EXIT.                                                       
010984      EXIT.                                                       
010985     EJECT                                                        
010986 7930-READ-CONTROL.                                               
010987     EXEC CICS READ                                               
010988         DATASET  ('ELCNTL')                                      
010989         SET      (ADDRESS OF CONTROL-FILE)                       
010990         RIDFLD   (ELCNTL-KEY)                                    
010991     END-EXEC.                                                    
010992                                                                  
010993 7930-EXIT.                                                       
010994      EXIT.                                                       
010995                                                                  
010996 7940-READ-CONTROL-UPDATE.                                        
010997     EXEC CICS READ                                               
010998         DATASET  ('ELCNTL')                                      
010999         SET      (ADDRESS OF CONTROL-FILE)                       
011000         RIDFLD   (ELCNTL-KEY)                                    
011001         UPDATE                                                   
011002     END-EXEC.                                                    
011003                                                                  
011004 7940-EXIT.                                                       
011005      EXIT.                                                       
011006     EJECT                                                        
011007 7950-READ-TRAILER.                                               
011008     EXEC CICS READ                                               
011009         DATASET  ('ELTRLR')                                      
011010         SET      (ADDRESS OF ACTIVITY-TRAILERS)                  
011011         RIDFLD   (ELTRLR-KEY)                                    
011012     END-EXEC.                                                    
011013                                                                  
011014 7950-EXIT.                                                       
011015      EXIT.                                                       
011016                                                                  
011017 7960-READ-TRAILER-UPDATE.                                        
011018     EXEC CICS READ                                               
011019         DATASET  ('ELTRLR')                                      
011020         SET      (ADDRESS OF ACTIVITY-TRAILERS)                  
011021         RIDFLD   (ELTRLR-KEY)                                    
011022         UPDATE                                                   
011023     END-EXEC.                                                    
011024                                                                  
011025 7960-EXIT.                                                       
011026      EXIT.                                                       
011027     EJECT                                                        
011028 7970-READ-CERT.                                                  
011029     EXEC CICS READ                                               
011030         DATASET  ('ELCERT')                                      
011031         SET      (ADDRESS OF CERTIFICATE-MASTER)                 
011032         RIDFLD   (ELCERT-KEY)                                    
011033     END-EXEC.                                                    
011034                                                                  
011035 7970-EXIT.                                                       
011036      EXIT.                                                       
011037                                                                  
011038 7975-read-acct.                                                  
011039                                                                  
011040     move spaces              to WS-ACCT-RECORD-SW                
011041                                 pi-dcc-product-code              
011042                                                                  
011043     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD                     
011044     MOVE PI-CARRIER          TO ACCT-CARRIER                     
011045     MOVE PI-GROUPING         TO ACCT-GROUPING                    
011046     MOVE PI-STATE            TO ACCT-STATE                       
011047     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT                     
011048     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT                      
011049     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY               
011050     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD            
011051                                                                  
011052     EXEC CICS READ                                               
011053        DATASET ('ERACCT')                                        
011054        RIDFLD  (ERACCT-KEY)                                      
011055        SET     (ADDRESS OF ACCOUNT-MASTER)                       
011056        GTEQ                                                      
011057        resp    (WS-RESPONSE)                                     
011058     END-EXEC                                                     
011059     IF WS-RESP-NORMAL                                            
011060        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)        
011061        and pi-cert-eff-dt < am-expiration-dt                     
011062        and pi-cert-eff-dt >= am-effective-dt                     
011063        move am-dcc-product-code to pi-dcc-product-code           
011064        set acct-found to true                                    
011065     end-if                                                       
011066                                                                  
011067     .                                                            
011068 7975-exit.                                                       
011069     exit.                                                        
011070                                                                  
011071 7980-READ-CERT-UPDATE.                                           
011072     EXEC CICS READ                                               
011073         DATASET  ('ELCERT')                                      
011074         SET      (ADDRESS OF CERTIFICATE-MASTER)                 
011075         RIDFLD   (ELCERT-KEY)                                    
011076         UPDATE                                                   
011077     END-EXEC.                                                    
011078                                                                  
011079 7980-EXIT.                                                       
011080      EXIT.                                                       
011081                                                                  
011082 7990-get-lo-hi-acct-dates.                                       
011083                                                                  
011084     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD                     
011085     MOVE PI-CARRIER          TO ACCT-CARRIER                     
011086     MOVE PI-GROUPING         TO ACCT-GROUPING                    
011087     MOVE PI-STATE            TO ACCT-STATE                       
011088     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT                     
011089     MOVE low-values          TO ACCT-EXP-DT                      
011090     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY               
011091     move spaces              to ws-i-say-stop-ind                
011092                                 ws-eracct-startbr-ind            
011093                                 ws-acct-status                   
011094                                                                  
011095     EXEC CICS STARTBR                                            
011096          DATASET    ('ERACCT')                                   
011097          RIDFLD     (ERACCT-KEY)                                 
011098          GTEQ                                                    
011099          resp       (ws-response)                                
011100     END-EXEC                                                     
011101     if ws-resp-normal                                            
011102        set eracct-browse-started to true                         
011103     end-if                                                       
011104                                                                  
011105     perform until i-say-stop                                     
011106        EXEC CICS READNEXT                                        
011107           DATASET ('ERACCT')                                     
011108           RIDFLD  (ERACCT-KEY)                                   
011109           SET     (ADDRESS OF ACCOUNT-MASTER)                    
011110           resp    (WS-RESPONSE)                                  
011111        END-EXEC                                                  
011112                                                                  
011113        IF WS-RESP-NORMAL                                         
011114           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)     
011115           if ws-lo-acct-dt = low-values                          
011116              move am-effective-dt                                
011117                                 to ws-lo-acct-dt                 
011118           end-if                                                 
011119           if am-expiration-dt > ws-hi-acct-dt                    
011120              move am-expiration-dt                               
011121                                 to ws-hi-acct-dt                 
011122           end-if                                                 
011123           move am-status        to ws-acct-status                
011124        else                                                      
011125           set i-say-stop to true                                 
011126        end-if                                                    
011127     end-perform                                                  
011128                                                                  
011129     if eracct-browse-started                                     
011130        exec cics endbr                                           
011131           dataset('ERACCT')                                      
011132        end-exec                                                  
011133        move spaces to ws-eracct-startbr-ind                      
011134     end-if                                                       
011135                                                                  
011136     .                                                            
011137 7990-exit.                                                       
011138     exit.                                                        
011139                                                                  
011140 8000-LOAD-ERROR-MESSAGES.                                        
011141     IF PI-PASS-SW = 'C'                                          
011142        MOVE EMI-LINE1           TO ERMSG1BO                      
011143     ELSE                                                         
011144        MOVE EMI-LINE1           TO ERRMSG1O                      
011145        MOVE EMI-LINE2           TO ERRMSG2O.                     
011146                                                                  
011147 8000-EXIT.                                                       
011148     EXIT.                                                        
011149                                                                  
011150     EJECT                                                        
011151                                                                  
011152 8010-DMD-ERROR-CHECKS.                                           
011153     PERFORM 7700-GET-DCT THRU 7700-EXIT.                         
011154                                                                  
011155     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS        
011156         GO TO 8051-ISSUE-ERROR.                                  
011157                                                                  
011158     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.           
011159     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.           
011160     MOVE '3'                    TO DC-OPTION-CODE.               
011161     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               
011162     IF DC-BIN-DATE-1 > CL-INCURRED-DT                            
011163         GO TO 8051-ISSUE-ERROR.                                  
011164                                                                  
011165     IF CL-CERT-NO (4:1) = 'U' OR 'F'                             
011166       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)         
011167                           OR                                     
011168          (CL-SSN-STATE   = CL-CERT-STATE  AND                    
011169           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)                
011170             MOVE ER-0851         TO EMI-ERROR                    
011171             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             
011172       END-IF                                                     
011173       IF CN-CSI-CC-PREMIUM-AMT = ZERO                            
011174             MOVE ER-8147         TO EMI-ERROR                    
011175             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            
011176                                                                  
011177     GO TO 8090-EXIT.                                             
011178                                                                  
011179 8051-ISSUE-ERROR.                                                
011180     MOVE ER-8146            TO EMI-ERROR.                        
011181     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
011182     GO TO 8090-EXIT.                                             
011183                                                                  
011184 8090-EXIT.                                                       
011185      EXIT.                                                       
011186                                                                  
011187 EJECT                                                            
011188 8100-SEND-INITIAL-MAP.                                           
011189                                                                  
011190     MOVE SAVE-DATE              TO RUNDTEAO.                     
011191     MOVE EIBTIME                TO TIME-IN.                      
011192     MOVE TIME-OUT               TO RUNTIMAO.                     
011193     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.             
011194                                                                  
011195     IF MAP-NAME = 'EL156A'                                       
011196        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'       
011197              OR 'FNL'                                            
011198           MOVE 'PF6=EOB CODES'  TO PF6TITO                       
011199        END-IF                                                    
011200        IF PI-COMPANY-ID = 'DCC' or 'VPP'                         
011201           MOVE 'N'     TO SURVYYNO                               
011202        END-IF                                                    
011203     END-IF                                                       
011204                                                                  
011205*    IF MAP-NAME = 'EL156A'                                       
011206*       IF PI-COMPANY-ID = 'CRI'                                  
011207*          NEXT SENTENCE                                          
011208*       ELSE                                                      
011209*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.                   
011210                                                                  
011211     IF MAP-NAME = 'EL156A'                                       
011212        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL' OR 'FNL'       
011213           NEXT SENTENCE                                          
011214        ELSE                                                      
011215           MOVE AL-SADOF TO  PINTA    PINTHA.                     
011216                                                                  
011217     IF MAP-NAME = 'EL156A'                                       
011218        IF PI-COMPANY-ID = 'AIG' OR 'AUK'                         
011219            NEXT SENTENCE                                         
011220        ELSE                                                      
011221           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.                  
011222                                                                  
011223*    IF MAP-NAME = 'EL156A'                                       
011224*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'                
011225*          NEXT SENTENCE                                          
011226*       ELSE                                                      
011227*          MOVE AL-SADOF TO CASHHA CASHA.                         
011228                                                                  
011229     IF MAP-NAME = 'EL156A'                                       
011230        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'       
011231                        or 'VPP' OR 'FNL'                         
011232           NEXT SENTENCE                                          
011233        ELSE                                                      
011234           MOVE AL-SADOF        TO  LOANHA                        
011235                                    LOANNOA.                      
011236                                                                  
011237     IF MAP-NAME = 'EL156A'                                       
011238        MOVE -1                 TO  ENTERPFL                      
011239        IF PI-USES-PAID-TO                                        
011240           MOVE 'PAID TO DATE :' TO PTHRHDGO                      
011241           MOVE '  PAY TO  '    TO  HDGA-VRBLE                    
011242           MOVE PMT-HEAD-A      TO  PMTHDGAO                      
011243        ELSE                                                      
011244           NEXT SENTENCE                                          
011245     ELSE                                                         
011246        IF MAP-NAME = 'EL156B'                                    
011247           IF PI-USES-PAID-TO                                     
011248              MOVE ' PAYS TO    ' TO HDGB-VRBLE                   
011249              MOVE PMT-HEAD-B     TO PMTHDGBO.                    
011250                                                                  
011251     EXEC CICS SEND                                               
011252         MAP   (MAP-NAME)                                         
011253         MAPSET(MAPSET-NAME)                                      
011254         FROM  (EL156AI)                                          
011255         ERASE                                                    
011256         CURSOR                                                   
011257     END-EXEC.                                                    
011258                                                                  
011259     GO TO 9100-RETURN-TRAN.                                      
011260                                                                  
011261 8200-SEND-DATAONLY.                                              
011262                                                                  
011263     IF FIRST-ENTRY = 'Y'                                         
011264         GO TO 8100-SEND-INITIAL-MAP.                             
011265                                                                  
011266     IF RETURNED-FROM-B = 'Y'                                     
011267         GO TO 8100-SEND-INITIAL-MAP.                             
011268                                                                  
011269     MOVE SAVE-DATE              TO RUNDTEAO.                     
011270     MOVE EIBTIME                TO TIME-IN.                      
011271     MOVE TIME-OUT               TO RUNTIMAO.                     
011272                                                                  
011273     IF EIBAID = DFHPF11                                          
011274        MOVE 'Y'                 TO EMI-ROLL-SWITCH               
011275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  
011276        MOVE 'EL001   '          TO RETURNED-FROM                 
011277        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT               
011278        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT           
011279        GO TO 8100-SEND-INITIAL-MAP.                              
011280                                                                  
011281     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.             
011282                                                                  
011283     IF MAP-NAME =  'EL156A'                                      
011284        MOVE -1                 TO  ENTERPFL                      
011285        IF PI-USES-PAID-TO                                        
011286           MOVE 'PAID TO DATE :' TO PTHRHDGO                      
011287           MOVE '  PAY TO  '    TO  HDGA-VRBLE                    
011288           MOVE PMT-HEAD-A      TO  PMTHDGAO                      
011289        ELSE                                                      
011290           NEXT SENTENCE                                          
011291     ELSE                                                         
011292        IF MAP-NAME = 'EL156B'                                    
011293           IF PI-USES-PAID-TO                                     
011294              MOVE ' PAYS TO    ' TO HDGB-VRBLE                   
011295              MOVE PMT-HEAD-B     TO PMTHDGBO.                    
011296                                                                  
011297     IF MAP-NAME =  'EL156A'                                      
011298        IF PI-COMPANY-ID = 'BOA'                                  
011299            IF PI-INT-RATE NUMERIC                                
011300                MOVE PI-INT-RATE TO PINTO.                        
011301                                                                  
011302     IF MAP-NAME = 'EL156A'                                       
011303        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'       
011304              OR 'FNL'                                            
011305           MOVE 'PF6=EOB CODES'  TO PF6TITO                       
011306*          MOVE 'Y'              TO EOBYNO                        
011307        END-IF                                                    
011308     END-IF                                                       
011309                                                                  
011310                                                                  
011311     EXEC CICS SEND                                               
011312         MAP   (MAP-NAME)                                         
011313         MAPSET(MAPSET-NAME)                                      
011314         FROM  (EL156AI)                                          
011315         DATAONLY                                                 
011316         CURSOR                                                   
011317     END-EXEC.                                                    
011318                                                                  
011319     GO TO 9100-RETURN-TRAN.                                      
011320                                                                  
011321 8300-SEND-TEXT.                                                  
011322     EXEC CICS SEND TEXT                                          
011323         FROM(LOGOFF-TEXT)                                        
011324         LENGTH(LOGOFF-LENGTH)                                    
011325         ERASE                                                    
011326         FREEKB                                                   
011327     END-EXEC.                                                    
011328                                                                  
011329     EXEC CICS RETURN                                             
011330     END-EXEC.                                                    
011331                                                                  
011332 8500-FILE-NOTOPEN.                                               
011333     IF FILE-SWITCH = 'MSTR'                                      
011334         MOVE ER-0154            TO EMI-ERROR.                    
011335     IF FILE-SWITCH = 'TRLR'                                      
011336         MOVE ER-0172            TO EMI-ERROR.                    
011337     IF FILE-SWITCH = 'CERT'                                      
011338         MOVE ER-0169            TO EMI-ERROR.                    
011339     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR               
011340                      'PROC' OR 'STAT'                            
011341         MOVE ER-0042            TO EMI-ERROR.                    
011342     IF FILE-SWITCH = 'ACTQ'                                      
011343         MOVE ER-0338            TO EMI-ERROR.                    
011344     IF FILE-SWITCH = 'ACCT'                                      
011345         MOVE ER-0168            TO EMI-ERROR.                    
011346                                                                  
011347     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
011348     MOVE -1                     TO PMTTYPEL.                     
011349                                                                  
011350     IF FIRST-ENTRY = 'Y'                                         
011351         GO TO 8100-SEND-INITIAL-MAP.                             
011352                                                                  
011353     GO TO 8200-SEND-DATAONLY.                                    
011354                                                                  
011355 8600-PGRM-NOT-FOUND.                                             
011356                                                                  
011357     MOVE ER-0923                TO EMI-ERROR.                    
011358     MOVE -1                     TO ENTPFBL.                      
011359     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    
011360                                                                  
011361     IF FIRST-ENTRY = 'Y'                                         
011362         GO TO 8100-SEND-INITIAL-MAP                              
011363     ELSE                                                         
011364         GO TO 8200-SEND-DATAONLY.                                
011365                                                                  
011366 8800-UNAUTHORIZED-ACCESS.                                        
011367     MOVE UNACCESS-MSG           TO LOGOFF-MSG.                   
011368     GO TO 8300-SEND-TEXT.                                        
011369                                                                  
011370 8810-PF23.                                                       
011371     MOVE EIBAID                 TO PI-ENTRY-CD-1.                
011372     MOVE XCTL-005               TO PGM-NAME.                     
011373     GO TO 9300-XCTL.                                             
011374                                                                  
011375 8820-PF7-8.                                                      
011376     MOVE XCTL-126               TO PI-CALLING-PROGRAM.           
011377     MOVE SPACES                 TO PI-SAVED-PROGRAM-1            
011378                                    PI-SAVED-PROGRAM-2            
011379                                    PI-SAVED-PROGRAM-3            
011380                                    PI-SAVED-PROGRAM-4            
011381                                    PI-SAVED-PROGRAM-5            
011382                                    PI-SAVED-PROGRAM-6            
011383                                    PI-RETURN-TO-PROGRAM.         
011384     IF EIBAID = DFHPF8                                           
011385        MOVE XCTL-132            TO PGM-NAME                      
011386     ELSE                                                         
011387        MOVE XCTL-130            TO PGM-NAME.                     
011388                                                                  
011389     GO TO 9300-XCTL.                                             
011390                                                                  
011391 9100-RETURN-TRAN.                                                
011392     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.             
011393     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.         
011394                                                                  
011395     EXEC CICS RETURN                                             
011396         TRANSID(TRANS-ID)                                        
011397         COMMAREA(PROGRAM-INTERFACE-BLOCK)                        
011398         LENGTH(PI-COMM-LENGTH)                                   
011399     END-EXEC.                                                    
011400                                                                  
011401 9200-RETURN-MAIN-MENU.                                           
011402     MOVE XCTL-126               TO PGM-NAME.                     
011403     GO TO 9300-XCTL.                                             
011404                                                                  
011405 9300-XCTL.                                                       
011406     EXEC CICS XCTL                                               
011407         PROGRAM(PGM-NAME)                                        
011408         COMMAREA(PROGRAM-INTERFACE-BLOCK)                        
011409         LENGTH(PI-COMM-LENGTH)                                   
011410     END-EXEC.                                                    
011411                                                                  
011412 9400-CLEAR.                                                      
011413     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.                     
011414     GO TO 9300-XCTL.                                             
011415                                                                  
011416 9500-PF12.                                                       
011417     MOVE XCTL-010               TO PGM-NAME.                     
011418     GO TO 9300-XCTL.                                             
011419                                                                  
011420 9700-LINK-DATE-CONVERT.                                          
011421     MOVE LINK-ELDATCV           TO PGM-NAME.                     
011422     EXEC CICS LINK                                               
011423         PROGRAM   (PGM-NAME)                                     
011424         COMMAREA  (DATE-CONVERSION-DATA)                         
011425         LENGTH    (DC-COMM-LENGTH)                               
011426     END-EXEC.                                                    
011427                                                                  
011428 9700-EXIT.                                                       
011429     EXIT.                                                        
011430                                                                  
011431 9800-LINK-REM-TERM.                                              
011432     MOVE LINK-REMTERM TO PGM-NAME.                               
011433                                                                  
011434     EXEC CICS LINK                                               
011435         PROGRAM   (PGM-NAME)                                     
011436         COMMAREA  (CALCULATION-PASS-AREA)                        
011437         LENGTH    (CP-COMM-LENGTH)                               
011438     END-EXEC.                                                    
011439                                                                  
011440 9800-EXIT.                                                       
011441     EXIT.                                                        
011442                                 EJECT                            
011443 9830-DMD-REMAINING-TERM.                                         
011444                                                                  
011445     DIVIDE CL-NO-OF-DAYS-PAID BY +30                             
011446         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.              
011447                                                                  
011448     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +              
011449                              CM-PMT-EXTENSION-DAYS.              
011450                                                                  
011451     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -                
011452                                  CL-NO-OF-DAYS-PAID.             
011453                                                                  
011454     DIVIDE W-REM-TERM-IN-DAYS BY +30                             
011455         GIVING W-REM REMAINDER W-REM-DAYS.                       
011456                                                                  
011457     MOVE W-REM                  TO WST-REM.                      
011458                                                                  
011459     IF W-REM-DAYS > ZEROS                                        
011460         MOVE '/'                TO WST-SLASH                     
011461         MOVE W-REM-DAYS         TO WST-REM-DAYS                  
011462     ELSE                                                         
011463         MOVE SPACES             TO WST-REM-DAYS-GRP.             
011464                                                                  
011465 9830-EXIT.                                                       
011466     EXIT.                                                        
011467                                                                  
011468 9870-OUTPUT-ACTIVITY-RECORD.                                     
011469                                                                  
011470     EXEC CICS GETMAIN                                            
011471          SET(ADDRESS OF DAILY-ACTIVITY-RECORD)                   
011472          LENGTH(25)                                              
011473          INITIMG(WS-BLANK)                                       
011474     END-EXEC.                                                    
011475                                                                  
011476     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.        
011477     MOVE ELMSTR-KEY             TO DA-KEY.                       
011478     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.            
011479                                                                  
011480     IF PI-PMTTYPE EQUAL '7'                                      
011481         MOVE 'V'                TO DA-RECORD-TYPE                
011482     ELSE                                                         
011483         MOVE 'P'                TO DA-RECORD-TYPE.               
011484                                                                  
011485     EXEC CICS HANDLE CONDITION                                   
011486          NOTOPEN(9870-NOTOPEN)                                   
011487          DUPREC(9870-EXIT)                                       
011488     END-EXEC.                                                    
011489                                                                  
011490     EXEC CICS WRITE                                              
011491          DATASET('DLYACTV')                                      
011492          RIDFLD(DA-KEY)                                          
011493          FROM(DAILY-ACTIVITY-RECORD)                             
011494          LENGTH(25)                                              
011495     END-EXEC.                                                    
011496     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.           
011497     GO TO 9870-EXIT.                                             
011498                                                                  
011499 9870-NOTOPEN.                                                    
011500                                                                  
011501     MOVE '2955'                 TO EMI-ERROR.                    
011502     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.           
011503                                                                  
011504 9870-EXIT.                                                       
011505     EXIT.                                                        
011506                                                                  
011507 9900-ERROR-FORMAT.                                               
011508                                                                  
011509     IF EMI-ERROR = ER-0923                                       
011510         MOVE PGM-NAME           TO W-CALLED-NAME.                
011511                                                                  
011512     MOVE LINK-001      TO PGM-NAME.                              
011513     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.                         
011514                                                                  
011515     EXEC CICS LINK                                               
011516         PROGRAM (PGM-NAME)                                       
011517         COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)                  
011518         LENGTH  (EMI-COMM-LENGTH)                                
011519     END-EXEC.                                                    
011520                                                                  
011521     IF EMI-ERROR = ER-0923                                       
011522         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).        
011523                                                                  
011524 9900-EXIT.                                                       
011525     EXIT.                                                        
011526                                                                  
011527 9990-ABEND.                                                      
011528     MOVE LINK-004               TO PGM-NAME.                     
011529     MOVE DFHEIBLK               TO EMI-LINE1.                    
011530     EXEC CICS LINK                                               
011531         PROGRAM   (PGM-NAME)                                     
011532         COMMAREA  (EMI-LINE1)                                    
011533         LENGTH    (64)                                           
011534     END-EXEC.                                                    
011535                                                                  
011536     MOVE 'EL156A'               TO  MAP-NAME.                    
011537     MOVE LOW-VALUES             TO  EL156AO.                     
011538     GO TO 8100-SEND-INITIAL-MAP.                                 
011539                                                                  
011540 9995-SECURITY-VIOLATION.                                         
011541*    COPY ELCSCTP.                                                
      *>>((file: ELCSCTP))
000001******************************************************************
000002*                                                                *
000003*                            ELCSCTP                             *
000004*                            VMOD=2.001                          *
000005*                                                                *
000006*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
000007******************************************************************
000008                                                                  
000009                                                                  
000010     MOVE EIBDATE          TO SM-JUL-DATE.                        
000011     MOVE EIBTRMID         TO SM-TERMID.                          
000012     MOVE THIS-PGM         TO SM-PGM.                             
000013     MOVE EIBTIME          TO TIME-IN.                            
000014     MOVE TIME-OUT         TO SM-TIME.                            
000015     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.                    
000016                                                                  
000017     EXEC CICS LINK                                               
000018          PROGRAM  ('EL003')                                      
000019          COMMAREA (SECURITY-MESSAGE)                             
000020          LENGTH   (80)                                           
000021     END-EXEC.                                                    
000022                                                                  
000023******************************************************************
000024                                                                  
      *<<((file: ELCSCTP))
011542                                                                  
