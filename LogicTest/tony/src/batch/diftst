45,46c45
< 092602*                                BENEFIT CODES FROM 300 TO 900
< 071403* 071403    2003031400004  SMVA  ADD PAID THRU DATE TO REPORT 
---
> 092602*                                  BENEFIT CODES FROM 300 TO 900
444c443
< 071403         'CAR  CERT NO   EFFECTIVE  ST  ACCOUNT   GROUP '.        EL317
---
> 00431          '************** CERTIFICATE DATA ************* '.        EL317
452,456c451,462
< 071403     05  FILLER                      PIC X(16)       VALUE SPACES.
< 071403     05  FILLER                      PIC X(15)       VALUE        EL317
< 071403         'PAID THRU DATE '.   
< 071403     05  FILLER                      PIC X(16)       VALUE SPACES.
< 
---
> 00439      05  FILLER                      PIC X(4)        VALUE        EL317
> 00440          'CAR '.                                                  EL317
> 00441      05  FILLER                      PIC X(12)       VALUE        EL317
> 00442          '  CERT NO   '.                                          EL317
> 00443      05  FILLER                      PIC X(11)       VALUE        EL317
> 00444          'EFFECTIVE  '.                                           EL317
> 00445      05  FILLER                      PIC X(3)        VALUE        EL317
> 00446          'ST '.                                                   EL317
> 00447      05  FILLER                      PIC X(10)       VALUE        EL317
> 00448          ' ACCOUNT  '.                                            EL317
> 00449      05  FILLER                      PIC X(7)        VALUE        EL317
> 00450          ' GROUP '.                                               EL317
541,544c547
< 071403     05  FILLER                      PIC X(03).                   EL317
< 071403     05  WS-D2-PAID-THRU-DT          PIC X(08).                   EL317
< 071403     05  FILLER                      PIC X(21).                   EL317
< 
---
> 00535      05  FILLER                      PIC X(32).                   EL317
856,861d858
< 071403     IF EX-BA-PAID-THRU-DT NOT = LOW-VALUES
< 071403         MOVE EX-BA-PAID-THRU-DT  TO DC-BIN-DATE-1    
< 071403         MOVE SPACES              TO DC-OPTION-CODE   
< 071403         PERFORM 8500-DATE-CONVERSION                             EL317
< 071403         MOVE DC-GREG-DATE-1-EDIT TO  WS-D2-PAID-THRU-DT. 
< 00755                                                                   EL317
39d38
< 040103* 040103   2003040100002  PEMA  FIX FEB DATE PROCESS FOR RETROS
867c866
< pemuni*    display 'made ig'.                                           ECS041
---
> pemuni     display 'made ig'.                                           ECS041
1007c1006
< 040103*    MOVE 'H'              TO DC-OPTION-CODE.                     ECS041
---
> 00974      MOVE 'H'              TO DC-OPTION-CODE.                     ECS041
1009,1011d1007
< 040103     MOVE 'L'              TO DC-OPTION-CODE
< 040103     MOVE WS-EP-RUN-DTE-N  TO DC-GREG-DATE-CYMD
< 040103     MOVE 01               TO DC-CYMD-DAY  
1014,1025c1010,1016
< 040103     IF NO-CONVERSION-ERROR
< 040103        MOVE DC-DAYS-IN-MONTH    TO EP-RUN-DA
< 040103     ELSE
< 040103        DISPLAY ' DATE CONVERT ERROR ON EP RUN DATE      '
< 040103     END-IF
< 040103*    IF DATE-CONVERSION-ERROR                                     ECS041
< 040103*       IF ONLY-LEAP-YEAR                                         ECS041
< 040103*          MOVE HOLD-CEN-1-DA TO MONTH-D (2)                      ECS041
< 040103*       ELSE                                                      ECS041
< 040103*          MOVE 'LEAP YEAR ERROR' TO WS-ABEND-MESSAGE             ECS041
< 040103*          MOVE DC-ERROR-CODE     TO WS-ABEND-FILE-STATUS         ECS041
< 040103*          GO TO ABEND-PGM.                                          CL*38
---
> 00975      IF DATE-CONVERSION-ERROR                                     ECS041
> 00976         IF ONLY-LEAP-YEAR                                         ECS041
> 00977            MOVE HOLD-CEN-1-DA TO MONTH-D (2)                      ECS041
> 00978         ELSE                                                      ECS041
> 00979            MOVE 'LEAP YEAR ERROR' TO WS-ABEND-MESSAGE             ECS041
> 00980            MOVE DC-ERROR-CODE     TO WS-ABEND-FILE-STATUS         ECS041
> 00981            GO TO ABEND-PGM.                                          CL*38
1027c1018
< 040103*    MOVE MONTH-D (EP-RUN-MO) TO EP-RUN-DA.                       ECS041
---
> 00983      MOVE MONTH-D (EP-RUN-MO) TO EP-RUN-DA.                       ECS041
182c182
< 00182                       COPY ELCRATPD.                              
---
> 00182                       COPY ELCRATPDT.                              
222c222
< 00222                           COPY ERCNETP.                           
---
> 00222                           COPY ERCNETPT.                           
197,198c197,198
<            OPEN INPUT  ANBPAIDD-IN
<                 OUTPUT ELRCON  
---
>            OPEN INPUT ANBPAIDD-IN
>                 I-O   ELRCON  
25c25
<                                    ACCESS IS RANDOM    
---
>                                    ACCESS IS DYNAMIC   
40c40
<        01  DFTACT-RECORD                          PIC X(108).
---
>        01  DFTACT-RECORD                          PIC X(1194).
68c68
<                                                     VALUE '8888888888'.
---
>                                                     VALUE '1108121040'.
215a216,226
> 
>            MOVE WS-ACCEPT-DATE            TO DC-GREG-DATE-1-YMD   
>            MOVE '3'                       TO DC-OPTION-CODE
>            PERFORM 8500-DATE-CONVERSION   THRU 8500-EXIT 
>            IF NO-CONVERSION-ERROR
>                DISPLAY 'ISSUE DATE WILL BE SET TO ' DC-GREG-DATE-CYMD
>            ELSE
>                DISPLAY 'ERROR ON ACCEPT DATE VALIDATION' WS-ACCEPT-DATE
>                PERFORM ABEND-PGM          THRU APS-EXIT
>            END-IF
>  
237,238d247
<                CONTINUE
<            ELSE
244,246d252
<            MOVE 'RC'                      TO RC-RECORD-ID
<            MOVE DTE-CLASIC-COMPANY-CD     TO RC-COMPANY-CD
< 
248,264c254
<       *        MOVE DAR-LOGIC-DRAFT-NUM   TO RC-CHECK-NO
<       *        MOVE WS-ANB-GL-ACCOUNT     TO RC-GL-ACCOUNT-NO
<       *    ELSE
<       *        IF DTE-CLIENT = 'CID'
<                    MOVE DAR-EXPDFT-CARRIER  TO DAR-LOGIC-DFT-CARRIER
<                    MOVE DAR-LOGIC-DRAFT-NUM TO RC-CHECK-NO
<                    MOVE WS-FNB-GL-ACCOUNT   TO RC-GL-ACCOUNT-NO
<       *        END-IF
<            END-IF
<                
<            MOVE 'C'                       TO RC-CHECK-ORIGIN
< 
<            MOVE DAR-ENTERED-DATE          TO DC-GREG-DATE-CYMD   
<            MOVE 'L'                       TO DC-OPTION-CODE
<            PERFORM 8500-DATE-CONVERSION   THRU 8500-EXIT 
<            IF NO-CONVERSION-ERROR
<                MOVE DAR-ENTERED-DATE      TO RC-ISSUE-DATE
---
>                MOVE WS-ANB-GL-ACCOUNT     TO RC-GL-ACCOUNT-NO
266,267c256,258
<                DISPLAY 'INVALID CHECK ISSUE DATE ' DAR-ENTERED-DATE
<                PERFORM ABEND-PGM          THRU APS-EXIT
---
>                IF DTE-CLIENT = 'CID'
>                    MOVE WS-FNB-GL-ACCOUNT TO RC-GL-ACCOUNT-NO
>                END-IF
269a261,267
>            MOVE 'RC'                      TO RC-RECORD-ID
>            MOVE DTE-CLASIC-COMPANY-CD     TO RC-COMPANY-CD
>            MOVE DAR-EXPDFT-CARRIER        TO DAR-LOGIC-DFT-CARRIER
>            MOVE DAR-LOGIC-DRAFT-NUM       TO RC-CHECK-NO
>            MOVE 'C'                       TO RC-CHECK-ORIGIN
>            MOVE DC-GREG-DATE-CYMD         TO RC-ISSUE-DATE
> 
277,278c275,276
<            MOVE 'O'                       TO RC-STATUS 
<            MOVE DAR-ENTERED-DATE          TO RC-STATUS-DATE
---
>            MOVE 'S'                       TO RC-STATUS 
>            MOVE DC-GREG-DATE-CYMD         TO RC-STATUS-DATE
471a472,474
>                DISPLAY 'input record count is ' WS-RECORD-COUNT
>                DISPLAY 'relse record count is ' WS-RECORDS-RELEASED
> 
27a28,34
> 
>            SELECT ERPYAJ               ASSIGN TO ERPYAJ
>                   ORGANIZATION IS INDEXED
>                   ACCESS IS DYNAMIC
>                   RECORD KEY IS PY-CONTROL-PRIMARY
>                   FILE STATUS IS ERPYAJ-FILE-STATUS.
> 
49c56
<       *         177 BYTES
---
>       *         190 BYTES
55a63,65
>            05  EXT-ENT-DATE            PIC X(10).
>            05  EXT-VAL-DATE            PIC X(10).
>            05  EXT-EARN-TERM           PIC 999.
59,60c69,70
<            05  EXT-LF-TERM             PIC ZZ9.
<            05  EXT-AH-TERM             PIC ZZ9.
---
>            05  EXT-LF-TERM             PIC 999.
>            05  EXT-AH-TERM             PIC 999.
85a96,99
>        FD  ERPYAJ.
> 
>                                            COPY ERCPYAJ.
> 
92,93c106,107
<            88  END-OF-CERT                VALUE 'Y'.
<            88  MORE-CERTS                 VALUE 'N'.
---
>            88  END-OF-FILE                VALUE 'Y'.
>            88  MORE-RECORDS               VALUE 'N'.
168a183,187
>        01  WS-DUE-PREM-ADJ-TABLE.
>            05  WS-DUEP-ADJ OCCURS 500.
>                10  WS-DA-KEY           PIC X(33).
>                10  WS-DA-AMOUNT        PIC S9(7)V99 COMP-3.
> 
185a205
>                10  WS-REC-BASE-COMM    PIC S9(7)V99 COMP-3 VALUE +0.
193a214,220
>            05  WS-PYAJ-MATCH-KEY       PIC X(28) VALUE LOW-VALUES.
>            05  WS-ERPYAJ-KEY.
>                10  WS-PY-COMPANY-CD    PIC X.
>                10  WS-PY-CARRIER       PIC X.
>                10  WS-PY-GROUPING      PIC X(6).
>                10  WS-PY-FIN-RESP      PIC X(10).
>                10  WS-PY-ACCOUNT       PIC X(10).
194a222
>            05  ERPYAJ-FILE-STATUS      PIC XX.
196c224
<            05  WS-DUEP-CONTROL         PIC X(19).
---
>            05  WS-DUEP-CONTROL         PIC X(19)    VALUE LOW-VALUES.
201a230
>            05  WS-WORK-TERM            PIC S999   COMP-3 VALUE +0.
278a308,312
>            05  WS-ENTRY-DATE           PIC 9(11).
>            05  FILLER REDEFINES WS-ENTRY-DATE.
>                10  FILLER              PIC XXX.
>                10  WS-ENTRY-CCYY       PIC 9(4).
>                10  WS-ENTRY-MMDD       PIC 9(4).
300a335
>            12  WS-DP-ADJ               PIC S9(9)V99 COMP-3 VALUE +0.
324c359,361
<            12  WS-ANGLEN               PIC S9(7)V99 COMP-3  VALUE +0.
---
>            12  WS-PYAJ-INDEX           PIC S999     COMP-3  VALUE +0.
>            12  WS-PYAJ-MAX             PIC S999     COMP-3  VALUE +0.
>            12  WS-ANGLEN               PIC S9(5)V9999 COMP-3  VALUE +0.
326,328c363,366
<            12  WS-ANGLEM               PIC S9(7)V99 COMP-3  VALUE +0.
<            12  WS-ANGLEMJ              PIC S9(7)V99 COMP-3  VALUE +0.
<            12  WS-ANGLEN-M             PIC S9(7)V99 COMP-3  VALUE +0.
---
>            12  WS-WORK-AMT             PIC S9(9)V99 COMP-3  VALUE +0.
>            12  WS-ANGLEM               PIC S9(5)V9999 COMP-3  VALUE +0.
>            12  WS-ANGLEMJ              PIC S9(5)V9999 COMP-3  VALUE +0.
>            12  WS-ANGLEN-M             PIC S9(5)V9999 COMP-3  VALUE +0.
383a422
>                                           WS-REC-BASE-COMM
391c430,438
<            
---
>            MOVE LOW-VALUES             TO WS-ERPYAJ-KEY
> 
>            PERFORM VARYING WS-PYAJ-INDEX FROM +1 BY +1 UNTIL
>               (WS-PYAJ-INDEX > +500)
>               MOVE LOW-VALUES          TO WS-DA-KEY (WS-PYAJ-INDEX)
>               MOVE +0                  TO WS-DA-AMOUNT (WS-PYAJ-INDEX)
>            END-PERFORM
> 
>            MOVE +0                     TO WS-PYAJ-INDEX
399a447
>                       ERPYAJ
413d460
<               
414a462,472
>            IF ERPYAJ-FILE-STATUS = '00' OR '97'
>               CONTINUE
>            ELSE
>               DISPLAY ' ERROR ON ERPYAJ OPEN  '
>                  ERPYAJ-FILE-STATUS
>               MOVE ' ERROR ON ERPYAJ OPEN  '
>                                        TO WS-ABEND-MESSAGE
>               MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS      
>               PERFORM ABEND-PGM
>            END-IF
> 
441a500,562
>        0042-START-ERPYAJ.
> 
>            MOVE LOW-VALUES             TO PY-CONTROL-PRIMARY
>            MOVE DTE-CLASIC-COMPANY-CD  TO PY-COMPANY-CD
> 
>            START ERPYAJ KEY IS NOT < PY-CONTROL-PRIMARY
> 
>            IF ERPYAJ-FILE-STATUS = '10' OR '23'
>               SET END-OF-FILE          TO TRUE
>            ELSE
>               IF ERPYAJ-FILE-STATUS NOT = '00'
>                  MOVE ' ERROR ON ERPYAJ START '
>                                        TO WS-ABEND-MESSAGE
>                  MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS      
>                  DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
>                  PERFORM ABEND-PGM
>               ELSE
>                  DISPLAY ' GOOD START ON ERPYAJ '
>               END-IF
>            END-IF
>            
>            .
>        0042-EXIT.
>            EXIT.
>                  
>        0043-READ-ERPYAJ.
> 
>            READ ERPYAJ NEXT RECORD
> 
>            IF (ERPYAJ-FILE-STATUS = '10' OR '23')
>               OR (PY-COMPANY-CD > DTE-CLASIC-COMPANY-CD)
>               SET END-OF-FILE          TO TRUE
>            ELSE
>               IF ERPYAJ-FILE-STATUS NOT = '00'
>                  MOVE ' ERROR ON ERPYAJ READ  '
>                                        TO WS-ABEND-MESSAGE
>                  MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS      
>                  DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
>                  PERFORM ABEND-PGM
>               ELSE
>                  DISPLAY ' GOOD READ ON ERPYAJ ' PY-CONTROL-PRIMARY
>               END-IF
>            END-IF
>            
>            .
>        0043-EXIT.
>            EXIT.
>                  
>        0045-PROCESS-ERPYAJ.
> 
>            IF PY-RECORD-TYPE = 'P'
>               ADD +1                   TO WS-PYAJ-INDEX
>               MOVE PY-CONTROL-PRIMARY  TO WS-DA-KEY (WS-PYAJ-INDEX)
>               MOVE PY-ENTRY-AMT        TO WS-DA-AMOUNT (WS-PYAJ-INDEX)
>               DISPLAY ' FOUND A HIT ' 
>            END-IF
>            
>            PERFORM 0043-READ-ERPYAJ    THRU 0043-EXIT
> 
>            .
>        0045-EXIT.
>            EXIT.
> 
443a565,586
>            PERFORM 0042-START-ERPYAJ   THRU 0042-EXIT
>            IF NOT END-OF-FILE
>               PERFORM 0043-READ-ERPYAJ THRU 0043-EXIT
>            END-IF
> 
>            PERFORM 0045-PROCESS-ERPYAJ THRU 0045-EXIT UNTIL
>               END-OF-FILE
>            MOVE WS-PYAJ-INDEX          TO WS-PYAJ-MAX
> 
>            CLOSE ERPYAJ
> 
>            IF ERPYAJ-FILE-STATUS = '00' OR '97'
>               CONTINUE
>            ELSE
>               MOVE ' ERROR ON ERPYAJ CLOSE '
>                                        TO WS-ABEND-MESSAGE
>               MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS      
>               DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
>               PERFORM ABEND-PGM
>            END-IF
> 
>            SET MORE-RECORDS            TO TRUE
447c590,591
<                  END-OF-CERT
---
>                  END-OF-FILE
>            PERFORM 0150-UPDATE-DUEP    THRU 0150-EXIT
462c606
<                SET END-OF-CERT         TO TRUE
---
>                SET END-OF-FILE         TO TRUE
465c609
<            IF NOT END-OF-CERT
---
>            IF NOT END-OF-FILE
484,485c628,629
<               ((CR-LFTYP (1:1) NOT = 'M' AND 'N')
<               AND (CR-AHTYP (1:1) NOT = 'M' AND 'N'))
---
>               ((CR-LFTYP (1:1) NOT = 'M' AND 'N' AND 'H')
>               AND (CR-AHTYP (1:1) NOT = 'M' AND 'N' AND 'H'))
489a634
>                  PERFORM 0090-FIND-ADJ THRU 0090-EXIT
503a649
>                                           WS-REC-BASE-COMM
511a658,696
>        0090-FIND-ADJ.
>        
>            MOVE CR-COMPANY-CD          TO WS-PYAJ-MATCH-KEY (1:1)
>            MOVE CR-CARRIER             TO WS-PYAJ-MATCH-KEY (2:1)
>            MOVE CR-GROUPING            TO WS-PYAJ-MATCH-KEY (3:6)
>            IF CR-REMIT-TO NOT NUMERIC
>               MOVE ZEROS               TO CR-REMIT-TO
>            END-IF
>            IF CR-REMIT-TO = ZEROS
>               MOVE 01                  TO CR-REMIT-TO
>            END-IF
>            MOVE CR-COM-AGT (CR-REMIT-TO)
>                                        TO WS-PYAJ-MATCH-KEY (9:10)
>            PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
>               (WS-A > +10)
>               OR (CR-AGT-TYPE (WS-A) = 'D' OR 'C')
>            END-PERFORM
> 
>            IF WS-A < +11
>               MOVE CR-COM-AGT (WS-A)   TO WS-PYAJ-MATCH-KEY (19:10)
>            ELSE
>               MOVE CR-ACCOUNT          TO WS-PYAJ-MATCH-KEY (19:10)
>            END-IF
>       *    MOVE +0                     TO WS-DP-ADJ
>            DISPLAY ' CERT KEY TO MATCH ' WS-PYAJ-MATCH-KEY
>            PERFORM VARYING WS-PYAJ-INDEX FROM +1 BY +1 UNTIL
>               (WS-PYAJ-INDEX > WS-PYAJ-MAX)
>               IF WS-DA-KEY (WS-PYAJ-INDEX) (1:28) = WS-PYAJ-MATCH-KEY
>                  COMPUTE WS-DP-ADJ
>                     = WS-DP-ADJ + WS-DA-AMOUNT (WS-PYAJ-INDEX)
>                  MOVE LOW-VALUES       TO WS-DA-KEY (WS-PYAJ-INDEX)
>               END-IF
>            END-PERFORM
>            
>            . 
>        0090-EXIT.
>            EXIT.
> 
> 
521c706
<               + WS-BASE-COMM 
---
>               + WS-REC-BASE-COMM 
535a721,734
>            MOVE CR-ENTRY-DATE          TO WS-ENTRY-DATE
>            MOVE WS-ENTRY-MMDD (1:2)    TO EXT-ENT-DATE (1:2)
>            MOVE '-'                    TO EXT-ENT-DATE (3:1)
>                                           EXT-ENT-DATE (6:1)
>            MOVE WS-ENTRY-MMDD (3:2)    TO EXT-ENT-DATE (4:2)
>            MOVE WS-ENTRY-CCYY          TO EXT-ENT-DATE (7:4)
>            MOVE RUN-DATE               TO WS-ENTRY-DATE
>            MOVE WS-ENTRY-MMDD (1:2)    TO EXT-VAL-DATE (1:2)
>            MOVE '-'                    TO EXT-VAL-DATE (3:1)
>                                           EXT-VAL-DATE (6:1)
>            MOVE WS-ENTRY-MMDD (3:2)    TO EXT-VAL-DATE (4:2)
>            MOVE WS-ENTRY-CCYY          TO EXT-VAL-DATE (7:4)
>            
>            MOVE WS-EARN-TERM           TO EXT-EARN-TERM
556c755,759
<            MOVE WS-BASE-COMM           TO EXT-BASE-COMM
---
>            IF WS-BASE-COMM > ZEROS
>               MOVE WS-BASE-COMM        TO EXT-BASE-COMM
>            ELSE
>               MOVE WS-REC-BASE-COMM    TO EXT-BASE-COMM
>            END-IF
573c776,777
<            IF WS-DUEP-CONTROL NOT = CR-ACCT-CONTROL
---
>            IF (WS-DUEP-CONTROL NOT = LOW-VALUES)
>               AND (WS-DUEP-CONTROL NOT = CR-ACCT-CONTROL)
578a783
>                                           WS-DP-ADJ
586c791
<            COMPUTE WS-DP-BASE-COMM = WS-DP-BASE-COMM + WS-BASE-COMM
---
>            COMPUTE WS-DP-BASE-COMM = WS-DP-BASE-COMM + WS-REC-BASE-COMM
596c801,803
<            MOVE WS-DUEP-CONTROL        TO DP-CONTROL-PRIMARY
---
>            MOVE DTE-CLASIC-COMPANY-CD  TO DP-COMPANY-CD
>            MOVE WS-DUEP-CONTROL        TO DP-ACCOUNT-CONTROL
>            MOVE LOW-VALUES             TO DP-KEY-FILLER
598a806
>       *       COMPUTE WS-DP-REC-PREM = WS-DP-REC-PREM
602a811
>               MOVE WS-DP-ADJ           TO DP-ADJUSTMENTS
615a825,827
>                  MOVE +0               TO DP-BAL-FWD
>                                           DP-ADJUSTMENTS
>                                           DP-END-BAL
619a832
>                  MOVE WS-DP-ADJ        TO DP-ADJUSTMENTS
739,740c952,967
<            IF CR-LFTYP = '00' OR '  '
<               CONTINUE
---
>            IF WS-BIN-LF-END-DATE NOT > BIN-RUN-DATE
>               MOVE ZEROS               TO CR-LFPRM
>                                           CR-LFTYP
>                                           CR-LF-TERM
>                                           CR-LFPRM-RATE
>            END-IF
> 
>            IF WS-BIN-AH-END-DATE NOT > BIN-RUN-DATE
>               MOVE ZEROS               TO CR-AHPRM
>                                           CR-AHTYP
>                                           CR-AH-TERM
>                                           CR-AHPRM-RATE
>            END-IF
> 
>            IF CR-LF-TERM > CR-AH-TERM
>               MOVE CR-LF-TERM          TO WS-WORK-TERM
742c969
<               PERFORM 0210-CALC-LIFE-UEP   THRU 0210-EXIT
---
>               MOVE CR-AH-TERM          TO WS-WORK-TERM
743a971,981
>            
>            IF (CR-LFTYP = '00' OR '  ')
>               AND (CR-AHTYP = '00' OR '  ')
>               CONTINUE
>            ELSE
>               PERFORM 0205-CALC-UEP    THRU 0205-EXIT
>               IF LF-REM-TRM2 > AH-REM-TRM2
>                  MOVE LF-REM-TRM2      TO REM-TRM2
>               ELSE
>                  MOVE AH-REM-TRM2      TO REM-TRM2
>               END-IF
744a983,986
>               PERFORM 0210-CALC-UEP    THRU 0210-CALC-UEP
>            END-IF
>               
>            
750c992,997
<        0210-CALC-LIFE-UEP.
---
>        0205-CALC-UEP.
>        
>            MOVE +0                     TO LF-REM-TRM1
>                                           LF-REM-TRM2
>                                           AH-REM-TRM1
>                                           AH-REM-TRM2
751a999,1027
>            IF CR-LFTYP NOT = '  ' AND ZEROS
>               PERFORM 0207-FIND-LIFE-TYPE
>                                        THRU 0207-EXIT
>               IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
>                  CONTINUE
>               ELSE
>                  PERFORM 0220-CALC-LF-REM-TERM
>                                        THRU 0220-EXIT
>               END-IF
>            END-IF
>                                        
>            IF CR-AHTYP NOT = '  ' AND ZEROS
>               PERFORM 0208-FIND-AH-TYPE
>                                        THRU 0208-EXIT
>               IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
>                  CONTINUE
>               ELSE
>                  PERFORM 0225-CALC-AH-REM-TERM
>                                        THRU 0225-EXIT
>               END-IF
>            END-IF
>                                        
>                      
>            .
>        0205-EXIT.
>           EXIT.
>           
>        0207-FIND-LIFE-TYPE.
>        
756,757c1032,1033
<                   (CLAS-INDEXL = CLAS-MAXL) OR
<                   (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
---
>                (CLAS-INDEXL = CLAS-MAXL) OR
>                (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
769c1045,1051
<            IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
---
>            .
>        0207-EXIT.
>            EXIT.
> 
>        0208-FIND-AH-TYPE.
>        
>            IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
772,782c1054,1078
<               PERFORM 0220-CALC-LF-REM-TERM
<                                        THRU 0220-EXIT
<               MOVE ZEROS               TO WS-REM-AMT
<       *       IF LF-REM-TRM2 > ZERO
<       *          PERFORM 2000-CALC-REM-AMT
<       *                                THRU 2999-CALC-REM-AMT-X
<       *       END-IF
<       *       COMPUTE WS-LF-INFORCE = WS-LF-INFORCE + WS-REM-AMT
<               IF CR-LFTYP = ('MG' OR 'MJ' OR 'NJ' OR 'NL')
<                  IF CR-ENTRY-DATE = WS-TEST-RUN-DATE
<                     PERFORM 0215-CALC-RECEIVE 
---
>               PERFORM VARYING CLAS-INDEXA FROM +1 BY +1 UNTIL
>                   (CLAS-INDEXA = CLAS-MAXA) OR
>                   (CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA))
>               END-PERFORM
>               IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
>                  CONTINUE
>               ELSE
>                  DISPLAY ' AH  BENEFIT ' CR-AHTYP ' NOT IN TABLE'
>                  DISPLAY 'RETURN CODE - 0401'
>                  MOVE 0401 TO WS-RETURN-CODE
>                  PERFORM ABEND-PGM
>               END-IF
>            END-IF
> 
>            .
>        0208-EXIT.
>            EXIT.
> 
>        0210-CALC-UEP.
> 
>            MOVE ZEROS                  TO WS-REM-AMT
>            IF (CR-LFTYP = 'MG' OR 'MJ' OR 'NJ' OR 'NL')
>               OR (CR-AHTYP = 'MG' OR 'MJ' OR 'NJ' OR 'NL')
>               IF CR-ENTRY-DATE = WS-TEST-RUN-DATE
>                  PERFORM 0215-CALC-RECEIVE 
783a1080,1089
>               END-IF
>            ELSE
>               MOVE +0            TO WS-BASE-COMM
>               PERFORM VARYING X1 FROM +1 BY +1 UNTIL
>                  (X1 > +10)
>                  IF CR-AGT-TYPE (X1) = 'C' OR 'D'
>                     COMPUTE WS-BASE-COMM = WS-BASE-COMM
>                     + (CR-LFPRM * CR-LCOM-L (X1))
>                     + (CR-LFPRM-ALT * CR-LCOM-L (X1))
>                     + (CR-AHPRM * CR-LCOM-AH (X1))
784a1091,1104
>               END-PERFORM
>               IF (CR-LFTYP (1:1) = 'M')
>                  OR (CR-AHTYP (1:1) = 'M')
>       *          COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
>                  COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TRM2
>                  COMPUTE WS-EXP-PREM = (CR-LFPRM + CR-AHPRM)
>                  IF RUN-DATE = CR-ENTRY-DATE
>                     COMPUTE WS-EXP-PREM = WS-EXP-PREM
>                        * WS-EARN-TERM
>                     COMPUTE WS-BASE-COMM = WS-BASE-COMM
>                        * WS-EARN-TERM
>                  END-IF
>                  COMPUTE WS-EXP-PREM = 
>                     (WS-EXP-PREM - WS-BASE-COMM) 
786,789c1106
<                  IF CR-LFTYP (1:1) = 'M'
<                     COMPUTE WS-EXP-PREM = CR-LFPRM + CR-AHPRM
<                  ELSE
<                     PERFORM 0230-CALC-LF-UEP
---
>                  PERFORM 0230-CALC-UEP
791d1107
<                  END-IF
799a1116
> 
803c1120
<                                           WS-BASE-COMM
---
>                                           WS-REC-BASE-COMM
808c1125
<                  COMPUTE WS-BASE-COMM = WS-BASE-COMM +
---
>                  COMPUTE WS-REC-BASE-COMM = WS-REC-BASE-COMM +
823c1140
<               - WS-BASE-COMM
---
>               - WS-REC-BASE-COMM
878c1195,1197
< 
---
>            DISPLAY ' LF CERT ' CR-CERT-NO ' TERM ' CR-LF-TERM
>               ' REM2 ' LF-REM-TRM2
>               
884c1203,1238
<        0230-CALC-LF-UEP.
---
>        0225-CALC-AH-REM-TERM.
> 
>            MOVE BIN-RUN-DATE           TO CP-VALUATION-DT
> 
>            MOVE CLAS-I-RL-AH (CLAS-INDEXA)
>                                        TO CP-BENEFIT-TYPE
>            MOVE CLAS-I-BAL (CLAS-INDEXA)
>                                        TO CP-SPECIAL-CALC-CD
>            MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
>                                           CP-LOAN-TERM
> 
>            MOVE DTE-REM-TRM-CALC-OPTION
>                                        TO CP-REM-TRM-CALC-OPTION
> 
>            PERFORM 0510-GET-REMAINING-TERM
>                                        THRU 0510-EXIT
> 
>            IF CP-REMAINING-TERM-1 NEGATIVE
>                MOVE ZEROS              TO CP-REMAINING-TERM-1
>            END-IF
> 
>            IF CP-REMAINING-TERM-2 NEGATIVE
>                MOVE ZEROS              TO CP-REMAINING-TERM-2
>            END-IF
> 
>            MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
>            MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
>            DISPLAY ' AH CERT ' CR-CERT-NO ' TERM ' CR-AH-TERM
>               ' REM2 ' AH-REM-TRM2
>               
>            .
> 
>        0225-EXIT.
>            EXIT.
> 
>        0230-CALC-UEP.
887c1241,1242
<            COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
---
>       *    COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
>            COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TRM2
895a1251,1253
>            IF CR-LOAN-TERM = ZEROS
>               MOVE CR-AH-TERM          TO CR-LOAN-TERM
>            END-IF
907c1265,1266
<            COMPUTE WS-VM = (1 + WS-J) ** (CR-LF-TERM * -1)
---
>       *    COMPUTE WS-VM = (1 + WS-J) ** (CR-LF-TERM * -1)
>            COMPUTE WS-VM = (1 + WS-J) ** (WS-WORK-TERM * -1)
913c1272
<               ** (CR-LF-TERM * -1))) / WS-J
---
>               ** (WS-WORK-TERM * -1))) / WS-J
923c1282
<               ** (CR-LF-TERM * -1))) / WS-I
---
>               ** (WS-WORK-TERM * -1))) / WS-I
928c1287
<               ** ((CR-LOAN-TERM - CR-LF-TERM) * -1))) / WS-I
---
>               ** ((CR-LOAN-TERM - WS-WORK-TERM) * -1))) / WS-I
931a1291,1295
> 
>            IF CR-LFAMT = ZEROS
>               COMPUTE CR-LFAMT = CR-AHAMT * WS-WORK-TERM
>            END-IF
> 
939c1303
<               / WS-ANGLEM           
---
>               / WS-ANGLEMJ           
943a1308
> 
951c1316
<            MOVE 2                      TO WS-EARN-TERM
---
>       *    MOVE 1                      TO WS-EARN-TERM
969a1335
>                  COMPUTE WS-BASE-COMM = WS-BASE-COMM * WS-A
973a1340,1341
>               MOVE WS-AMT              TO WS-DISPLAY-FLD
>               DISPLAY ' WS-AMT B4    ' WS-AMT
976a1345,1346
>               MOVE WS-AMT              TO WS-DISPLAY-FLD
>               DISPLAY ' WS-AMT AFTER ' WS-AMT
994c1364,1369
<            COMPUTE WS-EXP-PREM = WS-LF-PRM + WS-AH-PRM              
---
>            DISPLAY ' WS-LF-PRM        = ' WS-LF-PRM
>            DISPLAY ' WS-AH-PRM        = ' WS-AH-PRM
>            DISPLAY ' WS-BASE-COMM     = ' WS-BASE-COMM
>            DISPLAY ' WS-REC-BASE-COMM = ' WS-REC-BASE-COMM
>            COMPUTE WS-EXP-PREM = (WS-LF-PRM + WS-AH-PRM)
>       *       - WS-BASE-COMM
999a1375
> 
1207,1208d1582
<            
<        0420-CALC-AH-REM-TERM.
1210,1244d1583
<            MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
< 
<            MOVE CLAS-I-RL-AH (CLAS-INDEXA)
<                                        TO CP-BENEFIT-TYPE
<            MOVE CLAS-I-BAL (CLAS-INDEXA)
<                                        TO CP-SPECIAL-CALC-CD
<            MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
<                                           CP-LOAN-TERM
< 
<            MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS
< 
<            MOVE DTE-REM-TRM-CALC-OPTION
<                                        TO CP-REM-TRM-CALC-OPTION
< 
<            PERFORM 0510-GET-REMAINING-TERM
<                                        THRU 0510-EXIT
< 
<            IF CP-REMAINING-TERM-1 NEGATIVE
<                MOVE ZEROS              TO CP-REMAINING-TERM-1
<            END-IF
< 
<            IF CP-REMAINING-TERM-2 NEGATIVE
<                MOVE ZEROS              TO CP-REMAINING-TERM-2
<            END-IF
< 
<            MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
<            MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
< 
<            .
< 
<        0420-EXIT.
<            EXIT.
< 
< 
< 
1254,1279d1592
< 
<            .
<        2900-DISPLAY-AMTS.
< 
<       *    IF (CR-DT > 19921231) AND
<       *       (CR-DT < 19940101) AND
<       *    IF (WS-BIN-VAL-DATES (VYR) = X'95FF')
<       *       MOVE CR-DT TO WS-DISPLAY-DATE
<       *       MOVE CR-LF-TERM TO WS-DISPLAY-TERM
<       *       MOVE LF-REM-TRM2 TO WS-DISPLAY-RTERM
<       *       MOVE CR-LFPRM TO WS-DISPLAY-PRM
<       *       IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L'
<       *          ADD CR-LFAMT CR-LFAMT-ALT GIVING WS-DISPLAY-AMT
<       *       ELSE
<       *          MOVE CR-LFAMT     TO WS-DISPLAY-AMT
<       *       END-IF
<       *       MOVE WS-REM-AMT   TO WS-DISPLAY-RAMT
<       *       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
<       *        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
<       *        WS-DISPLAY-AMT '   ' WS-DISPLAY-RAMT
<       *    END-IF
< 
<            .
<        2999-CALC-REM-AMT-X.
<            EXIT.
<        EJECT
1280a1594
> 
1317,1320c1631,1632
<        8699-EXIT.                                                       ECS064
<            EXIT.                                                        ECS064
<                                                                         ECS064
<        8800-PRT-RTN.                                                    ECS064
---
>        8699-EXIT.
>            EXIT.
1321a1634,1635
>        8800-PRT-RTN.
> 
79a80
> 052303* 052303    2001061800003  SMVA  DO NOT PRINT TAXES SECTION FOR DCC
1058,1060c1059,1062
< 01021      MOVE GR-LFTAX     TO  X-TAX.                                 
< 01022      MOVE GRR-LFTAX    TO  X-T78.                                 
< 01023      MOVE GRP-LFTAX    TO  X-TRATA.                               
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01021          MOVE GR-LFTAX     TO  X-TAX                                  
> 01022          MOVE GRR-LFTAX    TO  X-T78                                  
> 01023          MOVE GRP-LFTAX    TO  X-TRATA.                               
1174,1177c1176,1180
< 01137      ADD X-TAX      TO  R-TAX.                                    
< 01138      ADD X-T78      TO  R-T78.                                    
< 01139      ADD X-TRATA    TO  R-TRATA.                                  
< 01140      ADD X-TDOMI    TO  R-TDOMI.                                  
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01137          ADD X-TAX      TO  R-TAX                                     
> 01138          ADD X-T78      TO  R-T78                                     
> 01139          ADD X-TRATA    TO  R-TRATA                                   
> 01140          ADD X-TDOMI    TO  R-TDOMI.                                  
1317,1319c1320,1323
< 01280      MOVE GR-AHTAX      TO  X-TAX.                                
< 01281      MOVE GRR-AHTAX     TO  X-T78.                                
< 01282      MOVE GRP-AHTAX     TO  X-TRATA.                              
---
> 052303     IF DTE-CLIENT NOT = 'DCC' 
> 01280          MOVE GR-AHTAX      TO  X-TAX                                 
> 01281          MOVE GRR-AHTAX     TO  X-T78                                 
> 01282          MOVE GRP-AHTAX     TO  X-TRATA.                              
1405,1408c1409,1413
< 01368      ADD X-TAX      TO  R-TAX.                                    
< 01369      ADD X-T78      TO  R-T78.                                    
< 01370      ADD X-TRATA    TO  R-TRATA.                                  
< 01371      ADD X-TDOMI    TO  R-TDOMI.                                  
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01368          ADD X-TAX      TO  R-TAX                                     
> 01369          ADD X-T78      TO  R-T78                                     
> 01370          ADD X-TRATA    TO  R-TRATA                                   
> 01371          ADD X-TDOMI    TO  R-TDOMI.                                  
1633,1636c1638,1642
< 01596      ADD W-TAX      TO  R-TAX.                                    
< 01597      ADD W-T78      TO  R-T78.                                    
< 01598      ADD W-TRATA    TO  R-TRATA.                                  
< 01599      ADD W-TDOMI    TO  R-TDOMI.                                  
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01596          ADD W-TAX      TO  R-TAX                                     
> 01597          ADD W-T78      TO  R-T78                                     
> 01598          ADD W-TRATA    TO  R-TRATA                                   
> 01599          ADD W-TDOMI    TO  R-TDOMI.                                  
2383a2390
> 
2624,2627c2631,2635
< 02585      ADD X-TAX      TO  S-TAX.                                    
< 02586      ADD X-T78      TO  S-T78.                                    
< 02587      ADD X-TRATA    TO  S-TRATA.                                  
< 02588      ADD X-TDOMI    TO  S-TDOMI.                                  
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 02585          ADD X-TAX      TO  S-TAX                                     
> 02586          ADD X-T78      TO  S-T78                                     
> 02587          ADD X-TRATA    TO  S-TRATA                                   
> 02588          ADD X-TDOMI    TO  S-TDOMI.                                  
2684,2687c2692,2696
< 02645      ADD X-TAX      TO  S-TAX.                                    
< 02646      ADD X-T78      TO  S-T78.                                    
< 02647      ADD X-TRATA    TO  S-TRATA.                                  
< 02648      ADD X-TDOMI    TO  S-TDOMI.                                  
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 02645          ADD X-TAX      TO  S-TAX                                     
> 02646          ADD X-T78      TO  S-T78                                     
> 02647          ADD X-TRATA    TO  S-TRATA                                   
> 02648          ADD X-TDOMI    TO  S-TDOMI.                                  
2712,2715c2721,2725
< 02673      ADD S-TAX      TO  T-TAX.                                    
< 02674      ADD S-T78      TO  T-T78.                                    
< 02675      ADD S-TRATA    TO  T-TRATA.                                  
< 02676      ADD S-TDOMI    TO  T-TDOMI.                                  
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 02673          ADD S-TAX      TO  T-TAX                                     
> 02674          ADD S-T78      TO  T-T78                                     
> 02675          ADD S-TRATA    TO  T-TRATA                                   
> 02676          ADD S-TDOMI    TO  T-TDOMI.                                  
2886,2889c2896,2900
< 02844      MOVE X-TAX      TO  P-TAX.                                   
< 02845      MOVE X-T78      TO  P-T78.                                   
< 02846      MOVE X-TRATA    TO  P-TRATA.                                 
< 02847      MOVE X-TDOMI    TO  P-TDOMI.                                 
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 02844          MOVE X-TAX      TO  P-TAX                                    
> 02845          MOVE X-T78      TO  P-T78                                    
> 02846          MOVE X-TRATA    TO  P-TRATA                                  
> 02847          MOVE X-TDOMI    TO  P-TDOMI.                                 
3317,3320c3328,3332
< 03272      ADD X-TAX      TO  R-TAX.                                    
< 03273      ADD X-T78      TO  R-T78.                                    
< 03274      ADD X-TRATA    TO  R-TRATA.                                  
< 03275      ADD X-TDOMI    TO  R-TDOMI.                                  
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 03272          ADD X-TAX      TO  R-TAX                                     
> 03273          ADD X-T78      TO  R-T78                                     
> 03274          ADD X-TRATA    TO  R-TRATA                                   
> 03275          ADD X-TDOMI    TO  R-TDOMI.                                  
37a38
> 052303* 052303    2001061800003  SMVA  DO NOT PRINT TAX DATA FOR DCC
619,621c620,623
< 00575      ADD W-TAX      TO X-TAX.                                     ECS084
< 00576      ADD W-T78      TO X-T78.                                     ECS084
< 00577      ADD W-TRATA    TO X-TRATA.                                   ECS084
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 00575          ADD W-TAX      TO X-TAX
> 00576          ADD W-T78      TO X-T78
> 00577          ADD W-TRATA    TO X-TRATA.
684,686c686,689
< 00640      ADD X-TAX      TO S-TAX.                                     ECS084
< 00641      ADD X-T78      TO S-T78.                                     ECS084
< 00642      ADD X-TRATA    TO S-TRATA.                                   ECS084
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 00640          ADD X-TAX      TO S-TAX
> 00641          ADD X-T78      TO S-T78
> 00642          ADD X-TRATA    TO S-TRATA. 
1122,1124c1125,1128
< 01071      ADD X-TAX      TO S-TAX.                                     ECS084
< 01072      ADD X-T78      TO S-T78.                                     ECS084
< 01073      ADD X-TRATA    TO S-TRATA.                                   ECS084
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01071          ADD X-TAX      TO S-TAX
> 01072          ADD X-T78      TO S-T78
> 01073          ADD X-TRATA    TO S-TRATA. 
1188,1190c1192,1195
< 01136      ADD X-TAX      TO S-TAX.                                     ECS084
< 01137      ADD X-T78      TO S-T78.                                     ECS084
< 01138      ADD X-TRATA    TO S-TRATA.                                   ECS084
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01136          ADD X-TAX      TO S-TAX
> 01137          ADD X-T78      TO S-T78
> 01138          ADD X-TRATA    TO S-TRATA. 
1213,1215c1218,1221
< 01161      ADD S-TAX      TO T-TAX.                                     ECS084
< 01162      ADD S-T78      TO T-T78.                                     ECS084
< 01163      ADD S-TRATA    TO T-TRATA.                                   ECS084
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01161          ADD S-TAX      TO T-TAX
> 01162          ADD S-T78      TO T-T78
> 01163          ADD S-TRATA    TO T-TRATA.
1376,1378c1382,1385
< 01323      MOVE X-TAX      TO P-TAX.                                    ECS084
< 01324      MOVE X-T78      TO P-T78.                                    ECS084
< 01325      MOVE X-TRATA    TO P-TRATA.                                  ECS084
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01323          MOVE X-TAX      TO P-TAX
> 01324          MOVE X-T78      TO P-T78
> 01325          MOVE X-TRATA    TO P-TRATA. 
1414,1416c1421,1424
< 01361      ADD X-TAX      TO S-TAX.                                     ECS084
< 01362      ADD X-T78      TO S-T78.                                     ECS084
< 01363      ADD X-TRATA    TO S-TRATA.                                   ECS084
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01361          ADD X-TAX      TO S-TAX
> 01362          ADD X-T78      TO S-T78
> 01363          ADD X-TRATA    TO S-TRATA.  
13c13
<       * DANA  01/01/99  CR#199801150013  FREEDOM SYSTEM INSTALL       * 00130030
---
>       * DANA  01/01/99  CR#199801150013 - FREEDOM SYSTEM INSTALL      * 00130030
15,19c15,19
<       * DANA  09/01/99  CR#1999072000004 NEW FORMAT FOR SYS020        * 00132039
<       * DANA  02/16/01  CR#2001011600002 REMOVE LOGIC ACCT MASTER     * 00133041
< 061501* DANA  06/22/01  CR#1999061000004 REMOVE MSA CONVERSION FILE   * 00134043
< 030702* SMVA  03/07/02  CR#2002021300008 ELIMINATE PLAN CODE TABLE
<       *                                  DEPENDENCIES
---
>       * DANA  09/01/99  CR#1999072000004 - NEW FORMAT FOR SYS020      * 00132039
>       * DANA  02/16/01  CR#2001011600002 - REMOVE LOGIC ACCT MASTER   * 00133041
> 061501* DANA  06/22/01  CR#1999061000004 - REMOVE MSA CONVERSION FILE * 00134043
> 030702* SMVA  03/07/02  CR#2002021300008  ELIMINATE PLAN CODE TABLE
>       *                                 DEPENDENCIES
23c23
< 060503*                                  SKEWED REC LNGTH IN INTFCE FILE 
---
> 060503*                                  SKEWED REC LNGTH IN INTFCE FILE
185,186c185,186
<            MOVE ' '               TO FX-AGENT-01         
<            MOVE ' '               TO FX-DISTR           
---
>            MOVE ' '               TO FX-AGENT-01    
>            MOVE ' '               TO FX-DISTR      
191,195c191,195
< 061501         MOVE PY-GL-ACCOUNT TO FX-SOURCE-ACCT  
< 060503     END-IF  
<            MOVE PY-CARRIER        TO FX-DESCRIPTION(27:1)  
<            MOVE PY-GROUPING(4:3)  TO FX-DESCRIPTION(28:3) 
<            MOVE ' '               TO FX-REFERENCE        
---
> 061501         MOVE PY-GL-ACCOUNT TO FX-SOURCE-ACCT
> 060503     END-IF
>            MOVE PY-CARRIER        TO FX-DESCRIPTION(27:1)     
>            MOVE PY-GROUPING(4:3)  TO FX-DESCRIPTION(28:3)    
>            MOVE ' '               TO FX-REFERENCE           
197,200c197,200
<                                                         
<            MOVE PY-ACCOUNT(3:8)   TO WS-CID-ACCT       
< 012099     IF WS-CID-ACCT = LOW-VALUE                                   01781037
< 012099         MOVE SPACES        TO WS-CID-ACCT     
---
>                                                            
>            MOVE PY-ACCOUNT(3:8)   TO WS-CID-ACCT          
> 012099     IF WS-CID-ACCT = LOW-VALUE                    
> 012099        MOVE SPACES         TO WS-CID-ACCT        
202,203c202,203
<                                                                         01783037
<            MOVE WS-SUSPENSE      TO FX-SUSPENSE                         01790030
---
>                                                        
>            MOVE WS-SUSPENSE       TO FX-SUSPENSE      
28a29,39
> 060903******************************************************************
> 060903*                   C H A N G E   L O G
> 060903*
> 060903* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
> 060903*-----------------------------------------------------------------
> 060903*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
> 060903* EFFECTIVE    NUMBER
> 060903*-----------------------------------------------------------------
> 060903* 060903    2001061800003  PEMA  CHANGE MORT RESERVES TO LFUEP
> 060903*                                FOR DCC ONLY
> 060903******************************************************************
1443a1455,1459
> 060903     IF DTE-CLIENT = 'DCC'
> 060903        MOVE 'LIFE UNEARNED PREMIUM '
> 060903                                 TO DT-ENTRY (20)
> 060903     END-IF
> 060903     .
2310c2326,2328
< 02281      ADD EP-MORT-RESV            TO DA-MORT (SA).                 ECS045
---
> 060903     IF DTE-CLIENT NOT = 'DCC'
> 060903        ADD EP-MORT-RESV         TO DA-MORT (SA)
> 060903     END-IF
2334c2352,2354
< 02305                                 (EP-PRM-PR + EP-PRM-PR-ADJ)).     ECS045
---
> 02305                                 (EP-PRM-PR + EP-PRM-PR-ADJ))      ECS045
> 060903     END-IF
> 060903        .
3356a3377,3379
> 060903     IF DTE-CLIENT = 'DCC'
> 060903        MOVE DA-UP (SA)          TO DA-MORT (SA)
> 060903     END-IF
3364a3388,3390
> 060903     IF DTE-CLIENT = 'DCC'
> 060903        MOVE DA-UP (SA)          TO DA-MORT (SA)
> 060903     END-IF
30a31,40
> 061203******************************************************************
> 061203*                   C H A N G E   L O G
> 061203*
> 061203* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
> 061203*-----------------------------------------------------------------
> 061203*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
> 061203* EFFECTIVE    NUMBER
> 061203*-----------------------------------------------------------------
> 061203* 061203    2001061800003  SMVA  MOD FOR DCC FRIDAY CYCLE
> 061203******************************************************************
457c467,468
< 00438         IF DTE-CLIENT  =  'CID'                                   
---
> 00438         IF DTE-CLIENT  =  'CID'
> 061203                       OR 'DCC'
1232a1233
> 060503         MOVE 'JL'   TO  V-LF-BEN-CODE
1271a1273,1276
> 060503     IF PBI-I-LF-PREM-AMT = ZEROS
> 060503        MOVE ZEROS               TO PBI-I-LF-BENEFIT-AMT
> 060503     END-IF
> 060503
42a43,44
> 061703* 061703                   PEMA  REMOVE O/W COMM FROM COMM
> 061703* 061703                         CALC FOR DCC ONLY
2630a2633,2660
> 061703     IF DTE-CLIENT = 'DCC'
> 061703       IF ((GR-REIN = 'P')
> 061703         AND (CR-AGT-TYPE (SA) = ('C' OR 'D')))
> 061703       OR
> 061703         ((GR-REIN = 'R')
> 061703         AND (CR-AGT-TYPE (SA) = ('R' OR 'D')))
> 061703           COMPUTE GR-LFCOM =
> 061703               GR-LFCOM + (LF-PRM * CR-LCOM-L (SA))
> 061703           COMPUTE GR-LFCOM-ALT =
> 061703               GR-LFCOM-ALT + (LF-PRM-ALT * CR-LCOM-L (SA))
> 061703           COMPUTE GR-AHCOM =
> 061703               GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
> 061703           IF (WS-CHARGEBACK-SW (SA) = 'N') OR
> 061703              ((AM-COMM-CHARGEBACK (SA) NOT = ZEROS) AND
> 061703              (MONTHS-DIFF > AM-COMM-CHARGEBACK (SA)))
> 061703              CONTINUE
> 061703           ELSE
> 061703              COMPUTE WS-GR-LFCOM =
> 061703                  WS-GR-LFCOM + (LF-PRM * CR-LCOM-L (SA))
> 061703              COMPUTE WS-GR-LFCOM-ALT =
> 061703                  WS-GR-LFCOM-ALT + (LF-PRM-ALT * CR-LCOM-L (SA))
> 061703              COMPUTE WS-GR-AHCOM =
> 061703                  WS-GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
> 061703           END-IF
> 061703       END-IF
> 061703     ELSE
> 
> 
2654a2685,2689
> 061703     END-IF
> 
> 
> 
> 
2645,2652c2645
< PEMTMP     IF CR-ENTRY-STATUS = '1' OR '3' OR '4' OR 'P'
< PEMTMP        PERFORM 2100-BUILD-ISSUE-EXTRACT
<                                        THRU 2199-BLD-ISSUE-X
<       *                                THRU 2259-END-CANCEL-BUILD
<               PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X
<               IF (CR-LFRFND > ZEROS)
<                  OR (CR-AHRFND > ZEROS)
<                  PERFORM 2200-BUILD-CANCEL-EXTRACT
---
> PEMTMP     PERFORM 2100-BUILD-ISSUE-EXTRACT
2654c2647,2652
<                  PERFORM 3200-REINSURE-CANCEL
---
>            PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X
>            IF (CR-LFRFND > ZEROS)
>               OR (CR-AHRFND > ZEROS)
>               PERFORM 2200-BUILD-CANCEL-EXTRACT
>                                        THRU 2259-END-CANCEL-BUILD
>               PERFORM 3200-REINSURE-CANCEL
2656d2653
<               END-IF
7279d7275
<            MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
12c12
<            SELECT SAL-LOGICCLMS-IN     ASSIGN TO SYS010.
---
>            SELECT SAL-PREHIST-IN       ASSIGN TO SYS010.
20c20
<        FD  SAL-LOGICCLMS-IN
---
>        FD  SAL-PREHIST-IN
22a23,71
>        01  SAL-PREHIST-IN-REC.
>            05  FILLER                  PIC X(03).
>            05  PREHIST-FULL-CONTROL.
>                10  PREHIST-ACCT-CONTROL.
>                    15  FILLER          PIC X(09).
>                    15  PREHIST-ACCOUNT PIC X(10).
>                10  PREHIST-CERT-EFF-DT PIC 9(11)     COMP-3.
>                10  PREHIST-FULL-CERT-NO.
>                    15  PREHIST-CERT-NO PIC X(10).
>                    15  FILLER          PIC X(01).
>            05  FILLER                  PIC X(88).
>            05  FILLER                  PIC X(111).
>            05  FILLER                  PIC X(75).
>            05  FILLER                  PIC X(99).
>            05  FILLER                  PIC X(69).
>            05  PREHIST-DEATH-CLM-DATA.
>                10  PREHIST-NUM-DTH-CLM PIC S9(03)    COMP-3.
>                10  PREHIST-DTH-DT      PIC 9(11)     COMP-3.
>                10  PREHIST-DTH-RPT-DT  PIC 9(06).
>                10  PREHIST-DTH-PAY-DT  PIC 9(11)     COMP-3.
>                10  PREHIST-DTHAMT      PIC S9(09)V99 COMP-3.
>                10  PREHIST-DTHAMT-YTD  PIC S9(09)V99 COMP-3.
>                10  PREHIST-DTHAMT-LAST PIC S9(09)V99 COMP-3.
>                10  FILLER              PIC X(10).
>                10  PREHIST-DTHAGE      PIC 9(02).
>                10  PREHIST-DTH-PAY-CD  PIC X(01).
>                10  PREHIST-DEATH-CAUSE PIC X(06).
>                10  FILLER              PIC X(16).
>            05  PREHIST-DISAB-CLM-DATA.
>                10  PREHIST-NUM-DIS-CLM PIC S9(03)    COMP-3.
>                10  PREHIST-DIS-DT      PIC 9(11)     COMP-3.
>                10  PREHIST-DIS-RPT-DT  PIC 9(06).
>                10  PREHIST-DIS-PAY-DT  PIC 9(11)     COMP-3.
>                10  PREHIST-DIS-PTO-DT  PIC 9(11)     COMP-3.
>                10  PREHIST-DISAMT      PIC S9(09)V99 COMP-3.
>                10  PREHIST-DISAMT-YTD  PIC S9(09)V99 COMP-3.
>                10  PREHIST-DISAMT-LAST PIC S9(09)V99 COMP-3.
>                10  FILLER              PIC X(10).
>                10  PREHIST-DAYS-DISAB  PIC 9(03)     COMP-3.
>                10  PREHIST-DIS-PAY-CD  PIC X(01).
>                10  FILLER              PIC X(02).
>                10  PREHIST-DISAB-INCURRED-DETAIL.
>                    15  PREHIST-DISAB-DETAIL-DATA OCCURS 5 TIMES.
>                        20  PREHIST-DIS-INCUR-DT PIC 9(11)     COMP-3.
>                        20  PREHIST-INCUR-DISAMT PIC S9(09)V99 COMP-3.
>                        20  FILLER               PIC X(06).
>                10  PREHIST-DISAB-CAUSE PIC X(06).
>                10  FILLER              PIC X(14).
>            05  FILLER                  PIC X(333).
25d73
<                                        COPY ECSEXT01.
47,53c95,104
<        77  WS-EOF-SW1                  PIC X  VALUE SPACES.
<            88  END-OF-CLMS                VALUE 'Y'.
<        77  WS-EOF-SW2                  PIC X  VALUE SPACES.
<            88  END-OF-CERT                VALUE 'Y'.
<        77  WS-MATCH-SW                 PIC X  VALUE SPACES.
<            88  CERT-FOUND                 VALUE 'Y'.
<        77  INCUR-INDEX                 PIC S9(03) COMP-3 VALUE +0.
---
>        77  WS-EOF-SW1                  PIC X  VALUE SPACE.
>            88  END-OF-PREHIST                 VALUE 'Y'.
>        77  WS-EOF-SW2                  PIC X  VALUE SPACE.
>            88  END-OF-CERT                    VALUE 'Y'.
>        77  WS-MATCH-SW                 PIC X  VALUE SPACE.
>            88  CERT-FOUND                     VALUE 'Y'.
>        77  WS-READ-CERT-SW             PIC X  VALUE SPACE.
>            88  OKAY-TO-READ-CERT              VALUE ' '.
>            88  SKIP-8300-READ-CERT            VALUE 'X'.
>        77  SUB                         PIC S9(03) COMP-3 VALUE +0.
57c108,111
<        77  WS-CLM-IN-CNT               PIC 9(9)   VALUE ZEROS.
---
>        77  WS-PREHIST-IN-CNT           PIC 9(9)   VALUE ZEROS.
>        77  WS-001ACCT-CNT              PIC 9(9)   VALUE ZEROS.
>        77  WS-NONE-CERT-CNT            PIC 9(9)   VALUE ZEROS.
>        77  WS-ZERO-CERT-CNT            PIC 9(9)   VALUE ZEROS.
59a114
>        77  WS-MATCH-CNT                PIC 9(9)   VALUE ZEROS.
135c190,191
<            PERFORM 0080-READ-CLMS      THRU 0080-EXIT
---
>            PERFORM 0080-READ-PREHIST   THRU 0080-EXIT
>            PERFORM 0083-READ-CERT      THRU 0083-EXIT
137c193
<                UNTIL END-OF-CLMS
---
>                UNTIL END-OF-PREHIST
151c207
<            OPEN INPUT  SAL-LOGICCLMS-IN 
---
>            OPEN INPUT  SAL-PREHIST-IN 
161c217,220
<            DISPLAY ' CLAIM RECORDS IN  ' WS-CLM-IN-CNT
---
>            DISPLAY ' PREHIST RECORDS IN  ' WS-PREHIST-IN-CNT
>            DISPLAY ' 001 ACCT RECORDS IN  ' WS-001ACCT-CNT
>            DISPLAY ' none cert #  ' WS-NONE-CERT-CNT
>            DISPLAY ' zero cert #  ' WS-ZERO-CERT-CNT
163a223
>            DISPLAY ' MATCH COUNT ' WS-MATCH-CNT
165c225
<            CLOSE SAL-LOGICCLMS-IN
---
>            CLOSE SAL-PREHIST-IN
175c235
<            PERFORM 0070-FIND-CERT      THRU 0070-EXIT 
---
>            PERFORM 0070-FIND-CERT          THRU 0070-EXIT 
177a238,242
>            IF END-OF-CERT 
>                IF NOT END-OF-PREHIST
>                    DISPLAY 'end cert before end prehist'
>                END-IF
>            END-IF
179c244,245
<            PERFORM 0080-READ-CLMS      THRU 0080-EXIT
---
>            PERFORM 0080-READ-PREHIST       THRU 0080-EXIT
>           
181c247
<            MOVE 'N'                    TO WS-MATCH-SW 
---
>            MOVE 'N'                        TO WS-MATCH-SW 
190,191c256,259
<            PERFORM 0083-READ-CERT      THRU 0083-EXIT
<            IF END-OF-CERT
---
>            IF PREHIST-ACCOUNT = '0001000100'
>                DISPLAY '001 account CLM CNTL ' PREHIST-ACCT-CONTROL
>                ADD +1                  TO WS-001ACCT-CNT
>                SET CERT-FOUND TO TRUE
195c263,279
<            IF CR-ACCT-CONTROL <= DE-CNTRL1
---
>            IF PREHIST-CERT-NO (7:10) = 'none'
>                DISPLAY 'cert is "none" ' PREHIST-ACCOUNT (6:8) ' ' 
>                               PREHIST-CERT-NO
>                DISPLAY ' '
>                ADD +1                  TO WS-NONE-CERT-CNT
>                SET CERT-FOUND TO TRUE
>                GO TO 0070-EXIT
>            END-IF
> 
>            IF PREHIST-CERT-NO = '0000000000'
>                DISPLAY ' zero cert# CLM CONTROL ' PREHIST-ACCT-CONTROL
>                ADD +1                  TO WS-ZERO-CERT-CNT
>                SET CERT-FOUND TO TRUE
>                GO TO 0070-EXIT
>            END-IF
> 
>            IF CR-ACCT-CONTROL <= PREHIST-ACCT-CONTROL
198,201c282,288
<                DISPLAY 'CERT ACCT CNTRL should not be GT Claim'
<                DISPLAY ' CERT CNTL ' CR-ACCT-CONTROL
<                DISPLAY ' CLM CNTL ' DE-CNTRL1
<                PERFORM ABEND-PGM
---
>                DISPLAY ' CERT ACCT > CLM ACCT ' CR-ACCOUNT (6:8) ' '
>                                 CR-CERT
>                DISPLAY '   On claim file - ' PREHIST-ACCOUNT (6:8) ' '
>                                 PREHIST-CERT-NO
>                DISPLAY ' '
>                SET CERT-FOUND TO TRUE
>                GO TO 0070-EXIT 
204c291
<            IF CR-ACCT-CONTROL = DE-CNTRL1
---
>            IF CR-ACCT-CONTROL = PREHIST-ACCT-CONTROL
207a295
>                PERFORM 0083-READ-CERT      THRU 0083-EXIT
211c299
<            IF CR-CERT-NO <= DE-CERT
---
>            IF CR-CERT <= PREHIST-CERT-NO
214,217c302,308
<                DISPLAY 'CERT NUM should not be GT Claim cert num'
<                DISPLAY ' CERT NUM ' CR-CERT-NO
<                DISPLAY ' CLM CERT ' DE-CERT
<                PERFORM ABEND-PGM
---
>                DISPLAY ' CERT CERT > CLM CERT ' CR-ACCOUNT (6:8) ' '
>                                CR-CERT
>                DISPLAY '   On claim file - ' PREHIST-ACCOUNT (6:8) ' '
>                                 PREHIST-CERT-NO
>                DISPLAY ' ' 
>                SET CERT-FOUND TO TRUE
>                GO TO 0070-EXIT 
220,221c311,313
<            IF CR-CERT-NO = DE-CERT
<                CONTINUE
---
> 
>            IF CR-CERT = PREHIST-CERT-NO
>                ADD +1 TO WS-MATCH-CNT
223a316
>                PERFORM 0083-READ-CERT      THRU 0083-EXIT
227c320
<            IF CR-DT = DE-EFF
---
>            IF CR-DT = PREHIST-CERT-EFF-DT
230,231c323,327
<                DISPLAY ' NO MATCH on CERT EFF DATE ' CR-FULL-CONTROL
<                DISPLAY ' CLAIM CONTROL ' DE-CONTROL
---
>                DISPLAY 'NO MATCH CERTEFF DT ' CR-ACCOUNT (6:8) ' '
>                             CR-CERT
>                DISPLAY '   On claim file - ' PREHIST-ACCOUNT (6:8) 
>                             ' ' PREHIST-CERT-NO
>                DISPLAY ' ' 
235,243d330
<  
<            IF DE-DEATH
<                MOVE DE-INCUR           TO CR-DTH-DT
<                MOVE DE-REPORTED        TO CR-DTH-RPT-DT
<                MOVE DE-PAY             TO CR-DTH-PAY-DT
<                MOVE DE-CLAIM-AMT       TO CR-DTHAMT
<                MOVE DE-PAY-CODE        TO CR-DTH-PAY-CD
<                MOVE DE-CLM-CAUSE       TO CR-DEATH-CAUSE
<            END-IF
245,253c332,333
<            IF DE-DISABILITY
<                MOVE DE-INCUR           TO CR-DIS-DT
<                MOVE DE-REPORTED        TO CR-DIS-RPT-DT
<                MOVE DE-PAY             TO CR-DIS-PAY-DT
<                MOVE DE-PAID-TO         TO CR-DIS-PTO-DT
<                MOVE DE-CLAIM-AMT       TO CR-DISAMT
<                MOVE DE-DAYS-DISAB      TO CR-DAYS-DISAB
<                MOVE DE-PAY-CODE        TO CR-DIS-PAY-CD
<                MOVE DE-CLM-CAUSE       TO CR-DISAB-CAUSE
---
>            MOVE PREHIST-DEATH-CLM-DATA TO CR-DEATH-CLAIM-DATA 
>            MOVE PREHIST-DISAB-CLM-DATA TO CR-DISAB-CLAIM-DATA 
255,259d334
<                PERFORM 0075-INCUR-DETAIL THRU 0075-EXIT
<                    VARYING INCUR-INDEX FROM +1 BY +1
<                    UNTIL INCUR-INDEX > +5
<            END-IF
< 
260a336
>            PERFORM 0083-READ-CERT      THRU 0083-EXIT
266d341
<        0075-INCUR-DETAIL.
268,278c343
<            IF CR-DIS-INCUR-DT (INCUR-INDEX) = ZEROS
<                MOVE DE-INCUR           TO CR-DIS-INCUR-DT (INCUR-INDEX)
<                MOVE DE-CLAIM-AMT       TO CR-INCUR-DISAMT (INCUR-INDEX)
<                MOVE +6                 TO INCUR-INDEX
<            END-IF
<  
<            .
<        0075-EXIT.
<            EXIT.
<            
<        0080-READ-CLMS.
---
>        0080-READ-PREHIST.
280,281c345,347
<            READ SAL-LOGICCLMS-IN 
<                AT END SET END-OF-CLMS  TO TRUE
---
>            READ SAL-PREHIST-IN 
>                AT END SET END-OF-PREHIST TO TRUE
>                       DISPLAY 'End of Prehist'
285c351
<            ADD +1                      TO WS-CLM-IN-CNT
---
>            ADD +1                      TO WS-PREHIST-IN-CNT
292a359
>            PERFORM 0085-WRITE-CERT     THRU 0085-EXIT
294,296d360
<            IF NOT END-OF-CERT
<                PERFORM 0085-WRITE-CERT THRU 0085-EXIT
<            END-IF
334a399,403
> 
>            DISPLAY ' CLAIM RECORDS IN  ' WS-PREHIST-IN-CNT
>            DISPLAY ' CERT RECORDS IN  ' WS-CERT-IN-CNT
>            DISPLAY ' CERT RECORDS OUT ' WS-CERT-OUT-CNT
>            DISPLAY ' MATCH COUNT ' WS-MATCH-CNT
438,444c438,442
<            IF GR-STATE = 'VA'  
<       *       and (gr-eff > 20001231)
<       *       AND (GR-EFF < 20020101)
<               continue
<            else
<               go to 0110-read-next-gaap-record
<            end-if	    		
---
>            IF GR-ACCOUNT = '0001010100'
>               CONTINUE
>            ELSE
>               GO TO 0110-READ-NEXT-GAAP-RECORD
>            END-IF	    		
1064c1062
< 01026      MOVE GR-CERT     TO L1-CERT.                                 
---
> 01026      MOVE GR-CERT-NO  TO L1-CERT.                                 
417a418
> 062703     COPY ELCEXTM1.
717c718
< 00716      DISPLAY AT-PAYMENT-TYPE.                                     EL334
---
> 00716 *    DISPLAY AT-PAYMENT-TYPE.                                     EL334
794a796
> 062703     COPY ELCEXTM1.
65a66,74
>        77  WS-BLANK-INCUR-DT-CNT       PIC 9(9)   VALUE ZEROS.
>        77  WS-BLANK-REPORT-DT-CNT      PIC 9(9)   VALUE ZEROS.
>        77  WS-BLANK-PAID-DT-CNT        PIC 9(9)   VALUE ZEROS.
>        77  WS-BLANK-TO-DT-LF-CNT       PIC 9(9)   VALUE ZEROS.
>        77  WS-BLANK-TO-DT-DIS-CNT      PIC 9(9)   VALUE ZEROS.
>        77  WS-BLANK-PAY-AMT-CNT        PIC 9(9)   VALUE ZEROS.
>        77  WS-BLANK-PAY-TYPE-CNT       PIC 9(9)   VALUE ZEROS.
>        77  WS-BLANK-PTYPE-AMT-CNT      PIC 9(9)   VALUE ZEROS.
>        77  WS-DROP-REC-CNT             PIC 9(9)   VALUE ZEROS.
108d116
<            DISPLAY 'INITIAL READ'
130,131c138,148
<            DISPLAY ' SALA RECORDS INPUT    ' WS-INPUT-CNT
<            DISPLAY ' CLM RECORDS OUTPUT   ' WS-OUTPUT-CNT
---
>            DISPLAY ' SALA RECORDS INPUT     ' WS-INPUT-CNT
>            DISPLAY ' BLANK INCURRED DATES   ' WS-BLANK-INCUR-DT-CNT
>            DISPLAY ' BLANK REPORTED DATES   ' WS-BLANK-REPORT-DT-CNT
>            DISPLAY ' BLANK PAID DATES       ' WS-BLANK-PAID-DT-CNT
>            DISPLAY ' BLANK PTO DATES LF     ' WS-BLANK-TO-DT-LF-CNT
>            DISPLAY ' BLANK PTO DATES DIS    ' WS-BLANK-TO-DT-DIS-CNT
>            DISPLAY ' BLANK PAY AMT          ' WS-BLANK-PAY-AMT-CNT
>            DISPLAY ' BLANK PAY TYPE         ' WS-BLANK-PAY-TYPE-CNT
>            DISPLAY ' BLANK PAY TYPE & AMT   ' WS-BLANK-PTYPE-AMT-CNT
>            DISPLAY ' DROP RECORDS           ' WS-DROP-REC-CNT
>            DISPLAY ' CLM RECORDS OUTPUT     ' WS-OUTPUT-CNT
143d159
<            DISPLAY 'Into process input ' SAL-CLAIM-RECORD
155a172,181
> 
>            IF SAL-CLM-PAYMENT NOT = ZEROS
>               AND SPACES
>                CONTINUE
>            ELSE
>       *        DISPLAY ' PAY AMT was blank ' SAL-ACCT-NUM ' '
>       *                    SAL-CERT-NUM SAL-CLAIM-RECORD
>                ADD +1 TO WS-BLANK-PAY-AMT-CNT
>            END-IF
> 
157a184,200
>            IF SAL-INCUR-DT NOT = ZEROS
>               AND SPACES
>                CONTINUE
>            ELSE
>                IF SAL-CERT-NUM = ZEROS 
>                   OR  SAL-ACCT-NUM = '0001000100'
>                   OR  SAL-CERT-NUM = '000000none'
>                   OR  SAL-DENY-REASON = '2'
>                   OR  SAL-CLM-PAYMENT = ZEROS
>                    CONTINUE
>                ELSE
>       *        DISPLAY ' INCUR DT was blank ' SAL-ACCT-NUM ' '
>       *                    SAL-CERT-NUM SAL-CLAIM-RECORD
>                    ADD +1 TO WS-BLANK-INCUR-DT-CNT
>                END-IF
>            END-IF
> 
160a204,220
>            IF SAL-REPORT-DT NOT = ZEROS
>               AND SPACES
>                CONTINUE
>            ELSE
>                IF SAL-CERT-NUM = ZEROS 
>                   OR  SAL-ACCT-NUM = '0001000100'
>                   OR  SAL-CERT-NUM = '000000none'
>                   OR  SAL-DENY-REASON = '2'
>                   OR  SAL-CLM-PAYMENT = ZEROS
>                    CONTINUE
>                ELSE
>       *        DISPLAY ' REPORT DT was blank ' SAL-ACCT-NUM ' '
>       *                    SAL-CERT-NUM SAL-CLAIM-RECORD
>                    ADD +1 TO WS-BLANK-REPORT-DT-CNT
>                END-IF
>            END-IF
> 
175d234
<                    DISPLAY 'DAYS in mo ' DC-DAYS-IN-MONTH
181,182c240,242
<                DISPLAY ' PAID DT was blank ' SAL-ACCT-NUM ' '
<                            SAL-CERT-NUM SAL-CLAIM-RECORD
---
>       *        DISPLAY 'PAID DT blank  ' SAL-ACCT-NUM ' '
>       *                    SAL-CERT-NUM SAL-CLAIM-RECORD
>                ADD +1 TO WS-BLANK-PAID-DT-CNT
188,189c248,270
<            MOVE SAL-CLM-PAID-TO-DT     TO WS-DATE-X 
<            MOVE WS-DATE-9              TO DE-PAID-TO
---
>            IF SAL-CLM-PAID-TO-DT NOT = ZEROS
>               AND SPACES
>                MOVE SAL-CLM-PAID-TO-DT TO WS-DATE-X 
>                MOVE WS-DATE-9          TO DE-PAID-TO
>            ELSE
>                MOVE SAL-CLM-PAID-DT    TO WS-DATE-X 
>                IF SAL-CERT-NUM = ZEROS 
>                   OR  SAL-ACCT-NUM = '0001000100'
>                   OR  SAL-CERT-NUM = '000000none'
>                   OR  SAL-DENY-REASON = '2'
>                   OR  SAL-CLM-PAYMENT = ZEROS
>                    CONTINUE
>                ELSE
>                    IF SAL-CLM-TYPE = '2' 
>                        DISPLAY 'TO DT blank for dis ' SAL-ACCT-NUM ' '
>                            SAL-CERT-NUM ' ' WS-DATE-X
>                        ADD +1 TO WS-BLANK-TO-DT-DIS-CNT
>                    ELSE 
>                        ADD +1 TO WS-BLANK-TO-DT-LF-CNT
>                    END-IF
>                END-IF
>                MOVE WS-DATE-9          TO DE-PAID-TO
>            END-IF
194,195c275,289
<            MOVE SAL-PAY-TYPE           TO DE-PAY-CODE
<            MOVE SAL-CLM-CAUSE          TO DE-CLM-CAUSE
---
> 
>            IF SAL-PAY-TYPE NOT = SPACE
>                MOVE SAL-PAY-TYPE       TO DE-PAY-CODE
>                MOVE SAL-CLM-CAUSE      TO DE-CLM-CAUSE
>            ELSE
>                IF SAL-CLM-PAYMENT = ZEROS
>       *            DISPLAY ' PAY TYPE was blank ' SAL-ACCT-NUM ' '
>       *                    SAL-CERT-NUM SAL-CLAIM-RECORD
>                    ADD +1 TO WS-BLANK-PTYPE-AMT-CNT
>                ELSE
>                    DISPLAY ' PAY TYPE was blank ' SAL-ACCT-NUM ' '
>                            SAL-CERT-NUM SAL-CLAIM-RECORD
>                    ADD +1 TO WS-BLANK-PAY-TYPE-CNT
>                END-IF
>            END-IF
201,202c295,298
<                DISPLAY 'NOT WRITING CLAIM REC ' SAL-ACCT-NUM ' '
<                         SAL-CERT-NUM ' ' SAL-DENY-REASON
---
>               OR  SAL-CLM-PAYMENT = ZEROS
>       *        DISPLAY 'NOT WRITING CLAIM REC ' SAL-ACCT-NUM ' '
>       *                 SAL-CERT-NUM ' ' SAL-DENY-REASON
>                ADD +1 TO WS-DROP-REC-CNT
205d300
<                DISPLAY 'WRITE'
232d326
<            DISPLAY 'READ'
30d29
<                                                                         
31a31,33
>            SELECT FREEDOM-EXTRACT      ASSIGN TO SYS012
>               ORGANIZATION IS LINE SEQUENTIAL.
>                                                                         
48c50,57
<        EJECT
---
> 
>        FD  FREEDOM-EXTRACT                                              
>            LABEL RECORDS ARE STANDARD                                   
>            RECORDING MODE IS F                                          
>            BLOCK CONTAINS 0 RECORDS.                                    
>        01  FREEDOM-RECORD      PIC X(250).                              
>                                                                         
>        EJECT 
209a219,221
>        01  WS-EXTRACT-RECORD.
>                                        COPY FNC022.
> 
241a254
>            05  WS-POSTING-DATE         PIC X(8).
249a263,267
>            12  WS-FREEDOM-TABLE.
>                16  FILLER OCCURS       55.
>                    20  WS-FREE-STATE   PIC XX.
>                    20  WS-FREE-PREM    PIC S9(9)V99 COMP-3 VALUE +0.
>                    20  WS-FREE-COMM    PIC S9(9)V99 COMP-3 VALUE +0.
329a348,358
>            PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
>               (WS-A > +55)
>               MOVE LOW-VALUES          TO WS-FREE-STATE (WS-A)
>               MOVE +0                  TO WS-FREE-PREM (WS-A)
>                                           WS-FREE-COMM (WS-A)
>            END-PERFORM
>            
>            MOVE RUN-DATE               TO WS-WORK-DATE
>            MOVE WS-WORK-MMDD           TO WS-POSTING-DATE (1:4)
>            MOVE WS-WORK-CCYY           TO WS-POSTING-DATE (5:4)
> 
338c367
<                OUTPUT PRINTX
---
>                OUTPUT PRINTX FREEDOM-EXTRACT
360c389
<                  ERDUEP
---
>                  ERDUEP FREEDOM-EXTRACT
414a444
>            PERFORM 0350-CREATE-FREEDOM THRU 0350-EXIT
467c497,498
<               / (DP-REC-PREM + DP-BASE-COMM)
---
>       *       / (DP-REC-PREM + DP-BASE-COMM)
>               / (DP-EXP-PREM + DP-BASE-COMM)
469c500,501
<               / (DP-REC-PREM + DP-BASE-COMM)
---
>       *       / (DP-REC-PREM + DP-BASE-COMM)
>               / (DP-EXP-PREM + DP-BASE-COMM)
520,521d551
<            DISPLAY ' MADE IT TO 0300 ACCT BREAK '
< 
577d606
<            DISPLAY ' MADE IT TO 0310  ST  BREAK '
598a628,642
>               PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
>                  (WS-FREE-STATE (WS-A) = LOW-VALUES)
>                  OR (WS-FREE-STATE (WS-A) = WS-HOLD-ST)
>                  OR (WS-A > +55)
>               END-PERFORM
>               IF WS-A NOT > +55
>                  MOVE WS-HOLD-ST       TO WS-FREE-STATE (WS-A)
>                  COMPUTE WS-FREE-PREM (WS-A) = WS-FREE-PREM (WS-A)
>                     + WS-TOT-END-BAL (2)
>                  COMPUTE WS-FREE-COMM (WS-A) = WS-FREE-COMM (WS-A)
>                     + WS-TOT-DUE-COMM (2)
>               ELSE
>                  DISPLAY ' FREEDOM TABLE EXCEEDED '
>                  PERFORM ABEND-PGM
>               END-IF
634d677
<            DISPLAY ' MADE IT TO 0320 GRP  BREAK '
691d733
<            DISPLAY ' MADE IT TO 0330 CAR  BREAK '
748d789
<            DISPLAY ' MADE IT TO 0340 FIN  BREAK '
777a819,825
>        0350-CREATE-FREEDOM.
>        
>            MOVE SPACES                 TO WS-EXTRACT-RECORD
>            MOVE 'LPACDUEPC'            TO FX-SYSTEM
>            MOVE 'LOGIC '               TO FX-SOURCE-CODE
>            MOVE '11'                   TO FX-DIVISION
>            MOVE '15'                   TO FX-SUB-TYPE
778a827,829
>            MOVE 'Y'                    TO FX-LOC-CODE
>            
>            MOVE WS-POSTING-DATE        TO FX-POSTING-DATE                          
779a831,835
>            IF DTE-CLIENT = 'CID'
>               MOVE 'S'                 TO FX-FY-REN
>            ELSE
>               MOVE ' '                 TO FX-FY-REN
>            END-IF
780a837,853
>            MOVE ZEROS                  TO FX-AMOUNT
>                                                                         
>            PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
>               (WS-A > +55)
>               OR (WS-FREE-STATE (WS-A) = LOW-VALUES)
>               MOVE WS-FREE-STATE (WS-A)
>                                        TO FX-STATE
>               MOVE 'DUE PREMIUM '      TO FX-DESCRIPTION
>               MOVE WS-FREE-PREM (WS-A) TO FX-AMOUNT
>               MOVE '30'                TO FX-TRAN-TYPE
>               WRITE FREEDOM-RECORD     FROM WS-EXTRACT-RECORD
>               MOVE 'DUE COMMISSION'    TO FX-DESCRIPTION
>               MOVE WS-FREE-COMM (WS-A) TO FX-AMOUNT
>               MOVE '50'                TO FX-TRAN-TYPE
>               WRITE FREEDOM-RECORD     FROM WS-EXTRACT-RECORD
>            END-PERFORM
>            
781a855,861
>        0350-EXIT.
>            EXIT.
> 
> 
> 
> 
>            .
843,846c923,924
<        8699-EXIT.                                                       ECS064
<            EXIT.                                                        ECS064
<                                                                         ECS064
<        8800-PRT-RTN.                                                    ECS064
---
>        8699-EXIT.
>            EXIT.
847a926,927
>        8800-PRT-RTN.
> 
76,79c76,79
< 062403 01  WS-NO-INPUT-MSG.
< 062403     05  FILLER             PIC X(01)      VALUE '0'.
< 062403     05  FILLER             PIC X(79)      VALUE
< 062403     'THERE WERE NO CLAIM RECORDS TO PROCESS'.
---
>        01  WS-NO-INPUT-MSG.
>            05  FILLER             PIC X(01)      VALUE '0'.
>            05  FILLER             PIC X(79)      VALUE
>            'THERE WERE NO CLAIM RECORDS TO PROCESS'.
82c82
< pemuni     05  filler      pic x       value spaces.
---
> pemuni     05  FILLER      PIC X       VALUE SPACES.
250,252c250,252
<            05  FILLER                       PIC X(33)  VALUE 
<                'MASTER CERTIFICATE EFFECTIVE DATE'.
<            05  FILLER                       PIC X(55)  VALUE SPACES.
---
>            05  FILLER                       PIC X(32)  VALUE 
>                'MASTER  CONTRACT  EFFECTIVE DATE'.
>            05  FILLER                       PIC X(56)  VALUE SPACES.
46a47,48
> 060303* 060303                   SMVA  STOP RECALC ON LITTLE CERTS 
> 070203* 070203                   SMVA  DONT COUNT OWRITES ON LITTLE CERTS
287c289
< 00277                              COPY ECSCOM01T.                      ECS061
---
> 00277                              COPY ECSCOM01.                       ECS061
1191c1193,1203
< 01179          GO TO 6240-COMM-OW.                                      ECS061
---
> 070203         IF NOT CP-MONTHLY-ISSUE
> 070203             DISPLAY '3.92 overwrite ' CP-RECORD
> 070203             DISPLAY 'cp trans ' CP-TRANS
> 070203             DISPLAY 'cp entry ' CP-ENTRY-STATUS
> 070203             DISPLAY 'acct ' CP-ACCOUNT
> 070203             DISPLAY 'remit ' CP-REMIT
> 070203             DISPLAY 'cert ' CP-CERT
> 070203             DISPLAY 'alt cert ' CP-ALT-CERT-NO
> 01179              GO TO 6240-COMM-OW
> 070203         END-IF
> 070203     END-IF.
1193,1196c1205,1211
< 01181      IF CP-BILLED                                                 ECS061
< 01182          ADD +1                  TO  COMP-TRAN-N-B                ECS061
< 01183      ELSE                                                         ECS061
< 01184          ADD +1                  TO  COMP-TRAN-N.                 ECS061
---
> 070203     IF NOT CP-MONTHLY-ISSUE
> 01181          IF CP-BILLED           
> 01182              ADD +1              TO  COMP-TRAN-N-B                ECS061
> 01183          ELSE    
> 01184              ADD +1              TO  COMP-TRAN-N
> 070203         END-IF
> 070203     END-IF.
1218,1223c1233,1240
< 01204         ADD CP-LF-PRM            TO  COMP-RECALC-P                ECS061
< 01205         ADD CP-LF-PRM-ALT        TO  COMP-RECALC-P                ECS061
< 01206         ADD CP-AH-PRM            TO  COMP-RECALC-P                ECS061
< 01207         ADD CP-LF-COM            TO  COMP-RECALC-C                ECS061
< 01208         ADD CP-LF-COM-ALT        TO  COMP-RECALC-C                ECS061
< 01209         ADD CP-AH-COM            TO  COMP-RECALC-C
---
> 060303        IF NOT CP-MONTHLY-ISSUE
> 01204             ADD CP-LF-PRM        TO  COMP-RECALC-P                ECS061
> 01205             ADD CP-LF-PRM-ALT    TO  COMP-RECALC-P                ECS061
> 01206             ADD CP-AH-PRM        TO  COMP-RECALC-P                ECS061
> 01207             ADD CP-LF-COM        TO  COMP-RECALC-C                ECS061
> 01208             ADD CP-LF-COM-ALT    TO  COMP-RECALC-C                ECS061
> 01209             ADD CP-AH-COM        TO  COMP-RECALC-C
>               END-IF
43a44,45
> 070803* 070803                   SMVA  FIX Z TRANS PICKING UP WRONG 
> 070803*                                ENTRY STATUS
77c79
< 00067                              COPY ECSCOM01T.                      ECS017
---
> 00067                              COPY ECSCOM01.                       ECS017
478,480d479
< 122002*    IF DE-ENTRY-STATUS = 'M'
< 122002*       MOVE 'M'                 TO CP-TRANS
< 122002*    END-IF
1341c1340,1344
< 122002     MOVE DE-ENTRY-STATUS        TO CP-ENTRY-STATUS.
---
> 
> 070803     IF CP-TRANS NOT = 'Z'
> 122002         MOVE DE-ENTRY-STATUS    TO CP-ENTRY-STATUS
> 070803     END-IF.
> 
7,16d6
<       *    THIS PROGRAM READS THE MONTH END CERT FILE AND CLMS FILE
<       *    AND BUILDS AN EXTRACT BY ISSUE YEAR.  THE EXTRACT IS
<       *    PRIMARLIY USED BY ACTUARIAL.  THE REFUNDS SELECTED ARE
<       *    PLACED IN THE VALUATION YEAR BASED ON THE CANCEL DATE.
<       *    THE CLAIMS SELECTED ARE PLACED IN THE VALUATION YEAR
<       *    BASED ON INCURRED DATE.  THE LOWEST ISSUE YEAR WILL ALWAYS
<       *    BE 1986.  IF YOU NEED TO CHANGE THAT SIMPLY CHANGE THE
<       *    HARD CODING WHERE YOU FIND MOVE 1986 TO LO-ISSUE AND
<       *    LO-VALUATION.  ANY CHANGES MADE TO THE SPECIAL ECS083
<       *    MUST ALSO BE MADE IN THIS PROGRAM.
41d30
< 
98c87
<                                            COPY ERCPYAJ.
---
>                                        COPY ERCPYAJ.
229a219
>            05  WS-WORK-TERM            PIC S999   COMP-3 VALUE +0.
291c281,282
<            05  WS-TEST-RUN-DATE        PIC 9(11).
---
>            05  WS-THIS-MONTH-DATE      PIC 9(11).
>            05  WS-LAST-MONTH-DATE      PIC 9(11).
321a313
>            05  WS-POSTING-DATE         PIC X(8).
360c352
<            12  WS-ANGLEN               PIC S9(7)V99 COMP-3  VALUE +0.
---
>            12  WS-ANGLEN               PIC S9(5)V9999 COMP-3  VALUE +0.
362,364c354,357
<            12  WS-ANGLEM               PIC S9(7)V99 COMP-3  VALUE +0.
<            12  WS-ANGLEMJ              PIC S9(7)V99 COMP-3  VALUE +0.
<            12  WS-ANGLEN-M             PIC S9(7)V99 COMP-3  VALUE +0.
---
>            12  WS-WORK-AMT             PIC S9(9)V99 COMP-3  VALUE +0.
>            12  WS-ANGLEM               PIC S9(5)V9999 COMP-3  VALUE +0.
>            12  WS-ANGLEMJ              PIC S9(5)V9999 COMP-3  VALUE +0.
>            12  WS-ANGLEN-M             PIC S9(5)V9999 COMP-3  VALUE +0.
371a365,366
>            12  WS-GIANT-SW             PIC X           VALUE SPACES.
>                88  THIS-IS-A-GIANT-CERT                VALUE 'X'.
394d388
<       *    MOVE SPACES                 TO  SAVE-COMPANY-NAME
397c391
<       *    MOVE SPACE-NP               TO  P-REC
---
>            MOVE RUN-DATE               TO WS-THIS-MONTH-DATE
399,400d392
<            MOVE RUN-DATE               TO WS-TEST-RUN-DATE
< 
409d400
< 
415d405
< 
436a427,443
>            MOVE BIN-RUN-DATE           TO DC-BIN-DATE-1
>            MOVE -1                     TO DC-ELAPSED-MONTHS
>            MOVE +0                     TO DC-ELAPSED-DAYS
>            MOVE '6'                    TO DC-OPTION-CODE
>            PERFORM 8510-DATE-CONVERSION
>                                        THRU 8590-EXIT
>            IF NO-CONVERSION-ERROR
>               MOVE DC-GREG-DATE-CYMD   TO WS-LAST-MONTH-DATE
>               DISPLAY ' LAST MONTH IS ' WS-LAST-MONTH-DATE
>            ELSE
>               DISPLAY ' ERROR IN LAST MONTH DATE CONVERSION '
>            END-IF
> 
>            MOVE RUN-DATE               TO WS-WORK-DATE
>            MOVE WS-WORK-MMDD           TO WS-POSTING-DATE (1:4)
>            MOVE WS-WORK-CCYY           TO WS-POSTING-DATE (5:4)
> 
513a521,522
>               ELSE
>                  DISPLAY ' GOOD START ON ERPYAJ '
525c534,535
<            IF ERPYAJ-FILE-STATUS = '10' OR '23'
---
>            IF (ERPYAJ-FILE-STATUS = '10' OR '23')
>               OR (PY-COMPANY-CD > DTE-CLASIC-COMPANY-CD)
533a544,545
>               ELSE
>                  DISPLAY ' GOOD READ ON ERPYAJ ' PY-CONTROL-PRIMARY
546a559
>       *       DISPLAY ' FOUND A HIT ' 
582a596
> 
602a617
>               MOVE ' '                 TO WS-GIANT-SW
610a626,632
>            IF (CR-LFTYP = 'MG' OR 'MJ' OR 'NJ' OR 'NL')
>               OR (CR-AHTYP = 'MG' OR 'MJ' OR 'NJ' OR 'NL')
>               IF CR-ENTRY-DATE = WS-THIS-MONTH-DATE
>                  SET THIS-IS-A-GIANT-CERT TO TRUE
>               END-IF
>            END-IF
>            
673,674c695,696
<            MOVE +0                     TO WS-DP-ADJ
< 
---
>       *    MOVE +0                     TO WS-DP-ADJ
>       *    DISPLAY ' CERT KEY TO MATCH ' WS-PYAJ-MATCH-KEY
698c720
<               + WS-REC-BASE-COMM 
---
>               + WS-BASE-COMM 
747,751c769,776
<            IF WS-BASE-COMM > ZEROS
<               MOVE WS-BASE-COMM        TO EXT-BASE-COMM
<            ELSE
<               MOVE WS-REC-BASE-COMM    TO EXT-BASE-COMM
<            END-IF
---
>            MOVE WS-BASE-COMM           TO EXT-BASE-COMM
> 
>       *    IF WS-BASE-COMM > ZEROS
>       *       MOVE WS-BASE-COMM        TO EXT-BASE-COMM
>       *    ELSE
>       *       MOVE WS-REC-BASE-COMM    TO EXT-BASE-COMM
>       *    END-IF
> 
774a800
>                                           WS-DP-ADJ
782c808
<            COMPUTE WS-DP-BASE-COMM = WS-DP-BASE-COMM + WS-REC-BASE-COMM
---
>            COMPUTE WS-DP-BASE-COMM = WS-DP-BASE-COMM + WS-BASE-COMM
797c823
<               COMPUTE WS-DP-REC-PREM = WS-DP-REC-PREM
---
>       *       COMPUTE WS-DP-REC-PREM = WS-DP-REC-PREM
943,944c969,986
<            IF CR-LFTYP = '00' OR '  '
<               CONTINUE
---
>            IF (WS-BIN-LF-END-DATE NOT > BIN-RUN-DATE)
>               AND (NOT THIS-IS-A-GIANT-CERT)
>               MOVE ZEROS               TO CR-LFPRM
>                                           CR-LFTYP
>                                           CR-LF-TERM
>                                           CR-LFPRM-RATE
>            END-IF
> 
>            IF (WS-BIN-AH-END-DATE NOT > BIN-RUN-DATE)
>               AND (NOT THIS-IS-A-GIANT-CERT)
>               MOVE ZEROS               TO CR-AHPRM
>                                           CR-AHTYP
>                                           CR-AH-TERM
>                                           CR-AHPRM-RATE
>            END-IF
> 
>            IF CR-LF-TERM > CR-AH-TERM
>               MOVE CR-LF-TERM          TO WS-WORK-TERM
946c988
<               PERFORM 0210-CALC-LIFE-UEP   THRU 0210-EXIT
---
>               MOVE CR-AH-TERM          TO WS-WORK-TERM
947a990,1000
>            
>            IF (CR-LFTYP = '00' OR '  ')
>               AND (CR-AHTYP = '00' OR '  ')
>               CONTINUE
>            ELSE
>               PERFORM 0205-CALC-UEP    THRU 0205-EXIT
>               IF LF-REM-TRM2 > AH-REM-TRM2
>                  MOVE LF-REM-TRM2      TO REM-TRM2
>               ELSE
>                  MOVE AH-REM-TRM2      TO REM-TRM2
>               END-IF
948a1002,1005
>               PERFORM 0210-CALC-UEP    THRU 0210-EXIT
>            END-IF
>               
>            
954c1011,1016
<        0210-CALC-LIFE-UEP.
---
>        0205-CALC-UEP.
>        
>            MOVE +0                     TO LF-REM-TRM1
>                                           LF-REM-TRM2
>                                           AH-REM-TRM1
>                                           AH-REM-TRM2
955a1018,1046
>            IF CR-LFTYP NOT = '  ' AND ZEROS
>               PERFORM 0207-FIND-LIFE-TYPE
>                                        THRU 0207-EXIT
>               IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
>                  CONTINUE
>               ELSE
>                  PERFORM 0220-CALC-LF-REM-TERM
>                                        THRU 0220-EXIT
>               END-IF
>            END-IF
>                                        
>            IF CR-AHTYP NOT = '  ' AND ZEROS
>               PERFORM 0208-FIND-AH-TYPE
>                                        THRU 0208-EXIT
>               IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
>                  CONTINUE
>               ELSE
>                  PERFORM 0225-CALC-AH-REM-TERM
>                                        THRU 0225-EXIT
>               END-IF
>            END-IF
>                                        
>                      
>            .
>        0205-EXIT.
>           EXIT.
>           
>        0207-FIND-LIFE-TYPE.
>        
960,961c1051,1052
<                   (CLAS-INDEXL = CLAS-MAXL) OR
<                   (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
---
>                (CLAS-INDEXL = CLAS-MAXL) OR
>                (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
973c1064,1070
<            IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
---
>            .
>        0207-EXIT.
>            EXIT.
> 
>        0208-FIND-AH-TYPE.
>        
>            IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
976,986c1073,1095
<               PERFORM 0220-CALC-LF-REM-TERM
<                                        THRU 0220-EXIT
<               MOVE ZEROS               TO WS-REM-AMT
<       *       IF LF-REM-TRM2 > ZERO
<       *          PERFORM 2000-CALC-REM-AMT
<       *                                THRU 2999-CALC-REM-AMT-X
<       *       END-IF
<       *       COMPUTE WS-LF-INFORCE = WS-LF-INFORCE + WS-REM-AMT
<               IF CR-LFTYP = ('MG' OR 'MJ' OR 'NJ' OR 'NL')
<                  IF CR-ENTRY-DATE = WS-TEST-RUN-DATE
<                     PERFORM 0215-CALC-RECEIVE 
---
>               PERFORM VARYING CLAS-INDEXA FROM +1 BY +1 UNTIL
>                   (CLAS-INDEXA = CLAS-MAXA) OR
>                   (CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA))
>               END-PERFORM
>               IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
>                  CONTINUE
>               ELSE
>                  DISPLAY ' AH  BENEFIT ' CR-AHTYP ' NOT IN TABLE'
>                  DISPLAY 'RETURN CODE - 0401'
>                  MOVE 0401 TO WS-RETURN-CODE
>                  PERFORM ABEND-PGM
>               END-IF
>            END-IF
> 
>            .
>        0208-EXIT.
>            EXIT.
> 
>        0210-CALC-UEP.
> 
>            MOVE ZEROS                  TO WS-REM-AMT
>            IF THIS-IS-A-GIANT-CERT
>               PERFORM 0215-CALC-RECEIVE 
987a1097,1105
>            ELSE
>               MOVE +0            TO WS-BASE-COMM
>               PERFORM VARYING X1 FROM +1 BY +1 UNTIL
>                  (X1 > +10)
>                  IF CR-AGT-TYPE (X1) = 'C' OR 'D'
>                     COMPUTE WS-BASE-COMM = WS-BASE-COMM
>                     + (CR-LFPRM * CR-LCOM-L (X1))
>                     + (CR-LFPRM-ALT * CR-LCOM-L (X1))
>                     + (CR-AHPRM * CR-LCOM-AH (X1))
989,994c1107,1108
<               ELSE
<                  MOVE +0            TO WS-BASE-COMM
<                  PERFORM VARYING X1 FROM +1 BY +1 UNTIL
<                     (X1 > +10)
<                     IF CR-AGT-TYPE (X1) = 'C' OR 'D'
<                        COMPUTE WS-BASE-COMM = WS-BASE-COMM +
---
>                  IF CR-AGT-TYPE (X1) = 'O' OR 'P'
>                     COMPUTE WS-GA-COMM = WS-GA-COMM +
998,1013d1111
<                     END-IF
<                  END-PERFORM
<                  IF CR-LFTYP (1:1) = 'M'
<                     COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
<                     COMPUTE WS-EXP-PREM = (CR-LFPRM + CR-AHPRM)
<                     IF RUN-DATE = CR-ENTRY-DATE
<                        COMPUTE WS-EXP-PREM = WS-EXP-PREM
<                           * WS-EARN-TERM
<                        COMPUTE WS-BASE-COMM = WS-BASE-COMM
<                           * WS-EARN-TERM
<                     END-IF
<                     COMPUTE WS-EXP-PREM = 
<                        (WS-EXP-PREM - WS-BASE-COMM) 
<                  ELSE
<                     PERFORM 0230-CALC-LF-UEP
<                                        THRU 0230-EXIT
1014a1113,1131
>               END-PERFORM
>               IF (CR-LFTYP (1:1) = 'M')
>                  OR (CR-AHTYP (1:1) = 'M')
>       *          COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
>                  COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TRM2
>                  COMPUTE WS-EXP-PREM = (CR-LFPRM + CR-AHPRM)
>                  IF RUN-DATE = CR-ENTRY-DATE
>                     COMPUTE WS-EXP-PREM = WS-EXP-PREM
>                        * WS-EARN-TERM
>                     COMPUTE WS-BASE-COMM = WS-BASE-COMM
>                        * WS-EARN-TERM
>                     COMPUTE WS-GA-COMM   = WS-GA-COMM  
>                        * WS-EARN-TERM
>                  END-IF
>                  COMPUTE WS-EXP-PREM = 
>                     (WS-EXP-PREM - WS-BASE-COMM) 
>               ELSE
>                  PERFORM 0230-CALC-UEP
>                                        THRU 0230-EXIT
1022a1140
> 
1035,1041c1153,1159
<               ELSE
<                  IF CR-AGT-TYPE (X1) = 'O' OR 'P'
<                     COMPUTE WS-GA-COMM = WS-GA-COMM +
<                        (CR-LFPRM * CR-LCOM-L (X1)) +
<                        (CR-LFPRM-ALT * CR-LCOM-L (X1)) +
<                        (CR-AHPRM * CR-LCOM-AH (X1))
<                  END-IF
---
>       *       ELSE
>       *          IF CR-AGT-TYPE (X1) = 'O' OR 'P'
>       *             COMPUTE WS-GA-COMM = WS-GA-COMM +
>       *                (CR-LFPRM * CR-LCOM-L (X1)) +
>       *                (CR-LFPRM-ALT * CR-LCOM-L (X1)) +
>       *                (CR-AHPRM * CR-LCOM-AH (X1))
>       *          END-IF
1101,1102c1219,1220
<            DISPLAY ' CERT ' CR-CERT-NO ' TERM ' CR-LF-TERM
<               ' REM2 ' LF-REM-TRM2
---
>       *    DISPLAY ' LF CERT ' CR-CERT-NO ' TERM ' CR-LF-TERM
>       *       ' REM2 ' LF-REM-TRM2
1109c1227,1262
<        0230-CALC-LF-UEP.
---
>        0225-CALC-AH-REM-TERM.
> 
>            MOVE BIN-RUN-DATE           TO CP-VALUATION-DT
> 
>            MOVE CLAS-I-RL-AH (CLAS-INDEXA)
>                                        TO CP-BENEFIT-TYPE
>            MOVE CLAS-I-BAL (CLAS-INDEXA)
>                                        TO CP-SPECIAL-CALC-CD
>            MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
>                                           CP-LOAN-TERM
> 
>            MOVE DTE-REM-TRM-CALC-OPTION
>                                        TO CP-REM-TRM-CALC-OPTION
> 
>            PERFORM 0510-GET-REMAINING-TERM
>                                        THRU 0510-EXIT
> 
>            IF CP-REMAINING-TERM-1 NEGATIVE
>                MOVE ZEROS              TO CP-REMAINING-TERM-1
>            END-IF
> 
>            IF CP-REMAINING-TERM-2 NEGATIVE
>                MOVE ZEROS              TO CP-REMAINING-TERM-2
>            END-IF
> 
>            MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
>            MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
>       *    DISPLAY ' AH CERT ' CR-CERT-NO ' TERM ' CR-AH-TERM
>       *       ' REM2 ' AH-REM-TRM2
>               
>            .
> 
>        0225-EXIT.
>            EXIT.
> 
>        0230-CALC-UEP.
1111,1112c1264,1266
<            DISPLAY ' MADE IT TO 0230 '
<            COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
---
>       *    DISPLAY ' MADE IT TO 0230 '
>       *    COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
>            COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TRM2
1114c1268
<            DISPLAY ' EARN TERM ' WS-EARN-TERM
---
>       *    DISPLAY ' EARN TERM ' WS-EARN-TERM
1120a1275,1277
>            IF CR-LOAN-TERM = ZEROS
>               MOVE CR-AH-TERM          TO CR-LOAN-TERM
>            END-IF
1124c1281
<            DISPLAY ' WS I ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS I ' WS-DISPLAY-FLD
1130c1287
<            DISPLAY ' WS J ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS J ' WS-DISPLAY-FLD
1132c1289,1290
<            COMPUTE WS-VM = (1 + WS-J) ** (CR-LF-TERM * -1)
---
>       *    COMPUTE WS-VM = (1 + WS-J) ** (CR-LF-TERM * -1)
>            COMPUTE WS-VM = (1 + WS-J) ** (WS-WORK-TERM * -1)
1135c1293
<            DISPLAY ' WS VM ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS VM ' WS-DISPLAY-FLD
1138c1296
<               ** (CR-LF-TERM * -1))) / WS-J
---
>               ** (WS-WORK-TERM * -1))) / WS-J
1141c1299
<            DISPLAY ' WS ANGLEMJ ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS ANGLEMJ ' WS-DISPLAY-FLD
1146c1304
<            DISPLAY ' WS ANGLEN  ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS ANGLEN  ' WS-DISPLAY-FLD
1148c1306
<               ** (CR-LF-TERM * -1))) / WS-I
---
>               ** (WS-WORK-TERM * -1))) / WS-I
1151c1309
<            DISPLAY ' WS ANGLEM  ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS ANGLEM  ' WS-DISPLAY-FLD
1153c1311
<               ** ((CR-LOAN-TERM - CR-LF-TERM) * -1))) / WS-I
---
>               ** ((CR-LOAN-TERM - WS-WORK-TERM) * -1))) / WS-I
1156c1314,1319
<            DISPLAY ' WS ANGLEN - M ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS ANGLEN - M ' WS-DISPLAY-FLD
> 
>            IF CR-LFAMT = ZEROS
>               COMPUTE CR-LFAMT = CR-AHAMT * WS-WORK-TERM
>            END-IF
> 
1159c1322
<            DISPLAY ' WS P       ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS P       ' WS-DISPLAY-FLD
1162c1325
<            DISPLAY ' WS B       ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS B       ' WS-DISPLAY-FLD
1164c1327
<               / WS-ANGLEM           
---
>               / WS-ANGLEMJ           
1166c1329
<            DISPLAY ' WS R       ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS R       ' WS-DISPLAY-FLD
1168a1332
> 
1170c1334
<            DISPLAY ' LF RATE ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' LF RATE ' WS-DISPLAY-FLD
1172c1336
<            DISPLAY ' AH RATE ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' AH RATE ' WS-DISPLAY-FLD
1187,1189c1351,1353
<               DISPLAY ' ' WS-A '  WS-I1  ' WS-DISPLAY-FLD
<               DISPLAY ' RUN DATE ' RUN-DATE
<               DISPLAY ' ENTRY DATE ' CR-ENTRY-DATE
---
>       *       DISPLAY ' ' WS-A '  WS-I1  ' WS-DISPLAY-FLD
>       *       DISPLAY ' RUN DATE ' RUN-DATE
>       *       DISPLAY ' ENTRY DATE ' CR-ENTRY-DATE
1195a1360
>                  COMPUTE WS-GA-COMM   = WS-GA-COMM   * WS-A
1201c1366
<               DISPLAY ' WS-AMT B4    ' WS-AMT
---
>       *       DISPLAY ' WS-AMT B4    ' WS-AMT
1206c1371
<               DISPLAY ' WS-AMT AFTER ' WS-AMT
---
>       *       DISPLAY ' WS-AMT AFTER ' WS-AMT
1224,1227d1388
<            DISPLAY ' WS-LF-PRM        = ' WS-LF-PRM
<            DISPLAY ' WS-AH-PRM        = ' WS-AH-PRM
<            DISPLAY ' WS-BASE-COMM     = ' WS-BASE-COMM
<            DISPLAY ' WS-REC-BASE-COMM = ' WS-REC-BASE-COMM
1228a1390,1394
> 
>       *    DISPLAY ' WS-LF-PRM        = ' WS-LF-PRM
>       *    DISPLAY ' WS-AH-PRM        = ' WS-AH-PRM
>       *    DISPLAY ' WS-BASE-COMM     = ' WS-BASE-COMM
>       *    DISPLAY ' WS-REC-BASE-COMM = ' WS-REC-BASE-COMM
1234a1401
> 
1269c1436
<            DISPLAY ' MADE IT TO 0300 ACCT BREAK '
---
>       *    DISPLAY ' MADE IT TO 0300 ACCT BREAK '
1304c1471
<            DISPLAY ' MADE IT TO 0310  ST  BREAK '
---
>       *    DISPLAY ' MADE IT TO 0310  ST  BREAK '
1340c1507
<            DISPLAY ' MADE IT TO 0320 GRP  BREAK '
---
>       *    DISPLAY ' MADE IT TO 0320 GRP  BREAK '
1376c1543
<            DISPLAY ' MADE IT TO 0330 CAR  BREAK '
---
>       *    DISPLAY ' MADE IT TO 0330 CAR  BREAK '
1412c1579
<            DISPLAY ' MADE IT TO 0340 FIN  BREAK '
---
>       *    DISPLAY ' MADE IT TO 0340 FIN  BREAK '
1442,1443d1608
<            
<        0420-CALC-AH-REM-TERM.
1445d1609
<            MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
1447,1452d1610
<            MOVE CLAS-I-RL-AH (CLAS-INDEXA)
<                                        TO CP-BENEFIT-TYPE
<            MOVE CLAS-I-BAL (CLAS-INDEXA)
<                                        TO CP-SPECIAL-CALC-CD
<            MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
<                                           CP-LOAN-TERM
1454,1479d1611
<            MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS
< 
<            MOVE DTE-REM-TRM-CALC-OPTION
<                                        TO CP-REM-TRM-CALC-OPTION
< 
<            PERFORM 0510-GET-REMAINING-TERM
<                                        THRU 0510-EXIT
< 
<            IF CP-REMAINING-TERM-1 NEGATIVE
<                MOVE ZEROS              TO CP-REMAINING-TERM-1
<            END-IF
< 
<            IF CP-REMAINING-TERM-2 NEGATIVE
<                MOVE ZEROS              TO CP-REMAINING-TERM-2
<            END-IF
< 
<            MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
<            MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
< 
<            .
< 
<        0420-EXIT.
<            EXIT.
< 
< 
< 
1489,1514d1620
< 
<            .
<        2900-DISPLAY-AMTS.
< 
<       *    IF (CR-DT > 19921231) AND
<       *       (CR-DT < 19940101) AND
<       *    IF (WS-BIN-VAL-DATES (VYR) = X'95FF')
<       *       MOVE CR-DT TO WS-DISPLAY-DATE
<       *       MOVE CR-LF-TERM TO WS-DISPLAY-TERM
<       *       MOVE LF-REM-TRM2 TO WS-DISPLAY-RTERM
<       *       MOVE CR-LFPRM TO WS-DISPLAY-PRM
<       *       IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L'
<       *          ADD CR-LFAMT CR-LFAMT-ALT GIVING WS-DISPLAY-AMT
<       *       ELSE
<       *          MOVE CR-LFAMT     TO WS-DISPLAY-AMT
<       *       END-IF
<       *       MOVE WS-REM-AMT   TO WS-DISPLAY-RAMT
<       *       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
<       *        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
<       *        WS-DISPLAY-AMT '   ' WS-DISPLAY-RAMT
<       *    END-IF
< 
<            .
<        2999-CALC-REM-AMT-X.
<            EXIT.
<        EJECT
1515a1622
> 
1552,1555c1659,1660
<        8699-EXIT.                                                       ECS064
<            EXIT.                                                        ECS064
<                                                                         ECS064
<        8800-PRT-RTN.                                                    ECS064
---
>        8699-EXIT.
>            EXIT.
1556a1662,1663
>        8800-PRT-RTN.
> 
45,46c45
< 092602*                                BENEFIT CODES FROM 300 TO 900
< 071403* 071403    2003031400004  SMVA  ADD PAID THRU DATE TO REPORT 
---
> 092602*                                  BENEFIT CODES FROM 300 TO 900
444c443
< 071403         'CAR  CERT NO   EFFECTIVE  ST  ACCOUNT   GROUP '.        EL317
---
> 00431          '************** CERTIFICATE DATA ************* '.        EL317
452,456c451,462
< 071403     05  FILLER                      PIC X(16)       VALUE SPACES.
< 071403     05  FILLER                      PIC X(15)       VALUE        EL317
< 071403         'PAID THRU DATE '.   
< 071403     05  FILLER                      PIC X(16)       VALUE SPACES.
< 
---
> 00439      05  FILLER                      PIC X(4)        VALUE        EL317
> 00440          'CAR '.                                                  EL317
> 00441      05  FILLER                      PIC X(12)       VALUE        EL317
> 00442          '  CERT NO   '.                                          EL317
> 00443      05  FILLER                      PIC X(11)       VALUE        EL317
> 00444          'EFFECTIVE  '.                                           EL317
> 00445      05  FILLER                      PIC X(3)        VALUE        EL317
> 00446          'ST '.                                                   EL317
> 00447      05  FILLER                      PIC X(10)       VALUE        EL317
> 00448          ' ACCOUNT  '.                                            EL317
> 00449      05  FILLER                      PIC X(7)        VALUE        EL317
> 00450          ' GROUP '.                                               EL317
541,544c547
< 071403     05  FILLER                      PIC X(03).                   EL317
< 071403     05  WS-D2-PAID-THRU-DT          PIC X(08).                   EL317
< 071403     05  FILLER                      PIC X(21).                   EL317
< 
---
> 00535      05  FILLER                      PIC X(32).                   EL317
856,861d858
< 071403     IF EX-BA-PAID-THRU-DT NOT = LOW-VALUES
< 071403         MOVE EX-BA-PAID-THRU-DT  TO DC-BIN-DATE-1    
< 071403         MOVE SPACES              TO DC-OPTION-CODE   
< 071403         PERFORM 8500-DATE-CONVERSION                             EL317
< 071403         MOVE DC-GREG-DATE-1-EDIT TO  WS-D2-PAID-THRU-DT. 
< 00755                                                                   EL317
39d38
< 040103* 040103   2003040100002  PEMA  FIX FEB DATE PROCESS FOR RETROS
867c866
< pemuni*    display 'made ig'.                                           ECS041
---
> pemuni     display 'made ig'.                                           ECS041
1007c1006
< 040103*    MOVE 'H'              TO DC-OPTION-CODE.                     ECS041
---
> 00974      MOVE 'H'              TO DC-OPTION-CODE.                     ECS041
1009,1011d1007
< 040103     MOVE 'L'              TO DC-OPTION-CODE
< 040103     MOVE WS-EP-RUN-DTE-N  TO DC-GREG-DATE-CYMD
< 040103     MOVE 01               TO DC-CYMD-DAY  
1014,1025c1010,1016
< 040103     IF NO-CONVERSION-ERROR
< 040103        MOVE DC-DAYS-IN-MONTH    TO EP-RUN-DA
< 040103     ELSE
< 040103        DISPLAY ' DATE CONVERT ERROR ON EP RUN DATE      '
< 040103     END-IF
< 040103*    IF DATE-CONVERSION-ERROR                                     ECS041
< 040103*       IF ONLY-LEAP-YEAR                                         ECS041
< 040103*          MOVE HOLD-CEN-1-DA TO MONTH-D (2)                      ECS041
< 040103*       ELSE                                                      ECS041
< 040103*          MOVE 'LEAP YEAR ERROR' TO WS-ABEND-MESSAGE             ECS041
< 040103*          MOVE DC-ERROR-CODE     TO WS-ABEND-FILE-STATUS         ECS041
< 040103*          GO TO ABEND-PGM.                                          CL*38
---
> 00975      IF DATE-CONVERSION-ERROR                                     ECS041
> 00976         IF ONLY-LEAP-YEAR                                         ECS041
> 00977            MOVE HOLD-CEN-1-DA TO MONTH-D (2)                      ECS041
> 00978         ELSE                                                      ECS041
> 00979            MOVE 'LEAP YEAR ERROR' TO WS-ABEND-MESSAGE             ECS041
> 00980            MOVE DC-ERROR-CODE     TO WS-ABEND-FILE-STATUS         ECS041
> 00981            GO TO ABEND-PGM.                                          CL*38
1027c1018
< 040103*    MOVE MONTH-D (EP-RUN-MO) TO EP-RUN-DA.                       ECS041
---
> 00983      MOVE MONTH-D (EP-RUN-MO) TO EP-RUN-DA.                       ECS041
182c182
< 00182                       COPY ELCRATPD.                              
---
> 00182                       COPY ELCRATPDT.                              
222c222
< 00222                           COPY ERCNETP.                           
---
> 00222                           COPY ERCNETPT.                           
197,198c197,198
<            OPEN INPUT  ANBPAIDD-IN
<                 OUTPUT ELRCON  
---
>            OPEN INPUT ANBPAIDD-IN
>                 I-O   ELRCON  
25c25
<                                    ACCESS IS RANDOM    
---
>                                    ACCESS IS DYNAMIC   
40c40
<        01  DFTACT-RECORD                          PIC X(108).
---
>        01  DFTACT-RECORD                          PIC X(1194).
68c68
<                                                     VALUE '8888888888'.
---
>                                                     VALUE '1108121040'.
215a216,226
> 
>            MOVE WS-ACCEPT-DATE            TO DC-GREG-DATE-1-YMD   
>            MOVE '3'                       TO DC-OPTION-CODE
>            PERFORM 8500-DATE-CONVERSION   THRU 8500-EXIT 
>            IF NO-CONVERSION-ERROR
>                DISPLAY 'ISSUE DATE WILL BE SET TO ' DC-GREG-DATE-CYMD
>            ELSE
>                DISPLAY 'ERROR ON ACCEPT DATE VALIDATION' WS-ACCEPT-DATE
>                PERFORM ABEND-PGM          THRU APS-EXIT
>            END-IF
>  
237,238d247
<                CONTINUE
<            ELSE
244,246d252
<            MOVE 'RC'                      TO RC-RECORD-ID
<            MOVE DTE-CLASIC-COMPANY-CD     TO RC-COMPANY-CD
< 
248,264c254
<       *        MOVE DAR-LOGIC-DRAFT-NUM   TO RC-CHECK-NO
<       *        MOVE WS-ANB-GL-ACCOUNT     TO RC-GL-ACCOUNT-NO
<       *    ELSE
<       *        IF DTE-CLIENT = 'CID'
<                    MOVE DAR-EXPDFT-CARRIER  TO DAR-LOGIC-DFT-CARRIER
<                    MOVE DAR-LOGIC-DRAFT-NUM TO RC-CHECK-NO
<                    MOVE WS-FNB-GL-ACCOUNT   TO RC-GL-ACCOUNT-NO
<       *        END-IF
<            END-IF
<                
<            MOVE 'C'                       TO RC-CHECK-ORIGIN
< 
<            MOVE DAR-ENTERED-DATE          TO DC-GREG-DATE-CYMD   
<            MOVE 'L'                       TO DC-OPTION-CODE
<            PERFORM 8500-DATE-CONVERSION   THRU 8500-EXIT 
<            IF NO-CONVERSION-ERROR
<                MOVE DAR-ENTERED-DATE      TO RC-ISSUE-DATE
---
>                MOVE WS-ANB-GL-ACCOUNT     TO RC-GL-ACCOUNT-NO
266,267c256,258
<                DISPLAY 'INVALID CHECK ISSUE DATE ' DAR-ENTERED-DATE
<                PERFORM ABEND-PGM          THRU APS-EXIT
---
>                IF DTE-CLIENT = 'CID'
>                    MOVE WS-FNB-GL-ACCOUNT TO RC-GL-ACCOUNT-NO
>                END-IF
269a261,267
>            MOVE 'RC'                      TO RC-RECORD-ID
>            MOVE DTE-CLASIC-COMPANY-CD     TO RC-COMPANY-CD
>            MOVE DAR-EXPDFT-CARRIER        TO DAR-LOGIC-DFT-CARRIER
>            MOVE DAR-LOGIC-DRAFT-NUM       TO RC-CHECK-NO
>            MOVE 'C'                       TO RC-CHECK-ORIGIN
>            MOVE DC-GREG-DATE-CYMD         TO RC-ISSUE-DATE
> 
277,278c275,276
<            MOVE 'O'                       TO RC-STATUS 
<            MOVE DAR-ENTERED-DATE          TO RC-STATUS-DATE
---
>            MOVE 'S'                       TO RC-STATUS 
>            MOVE DC-GREG-DATE-CYMD         TO RC-STATUS-DATE
471a472,474
>                DISPLAY 'input record count is ' WS-RECORD-COUNT
>                DISPLAY 'relse record count is ' WS-RECORDS-RELEASED
> 
27a28,34
> 
>            SELECT ERPYAJ               ASSIGN TO ERPYAJ
>                   ORGANIZATION IS INDEXED
>                   ACCESS IS DYNAMIC
>                   RECORD KEY IS PY-CONTROL-PRIMARY
>                   FILE STATUS IS ERPYAJ-FILE-STATUS.
> 
49c56
<       *         177 BYTES
---
>       *         190 BYTES
55a63,65
>            05  EXT-ENT-DATE            PIC X(10).
>            05  EXT-VAL-DATE            PIC X(10).
>            05  EXT-EARN-TERM           PIC 999.
59,60c69,70
<            05  EXT-LF-TERM             PIC ZZ9.
<            05  EXT-AH-TERM             PIC ZZ9.
---
>            05  EXT-LF-TERM             PIC 999.
>            05  EXT-AH-TERM             PIC 999.
85a96,99
>        FD  ERPYAJ.
> 
>                                            COPY ERCPYAJ.
> 
92,93c106,107
<            88  END-OF-CERT                VALUE 'Y'.
<            88  MORE-CERTS                 VALUE 'N'.
---
>            88  END-OF-FILE                VALUE 'Y'.
>            88  MORE-RECORDS               VALUE 'N'.
168a183,187
>        01  WS-DUE-PREM-ADJ-TABLE.
>            05  WS-DUEP-ADJ OCCURS 500.
>                10  WS-DA-KEY           PIC X(33).
>                10  WS-DA-AMOUNT        PIC S9(7)V99 COMP-3.
> 
185a205
>                10  WS-REC-BASE-COMM    PIC S9(7)V99 COMP-3 VALUE +0.
193a214,220
>            05  WS-PYAJ-MATCH-KEY       PIC X(28) VALUE LOW-VALUES.
>            05  WS-ERPYAJ-KEY.
>                10  WS-PY-COMPANY-CD    PIC X.
>                10  WS-PY-CARRIER       PIC X.
>                10  WS-PY-GROUPING      PIC X(6).
>                10  WS-PY-FIN-RESP      PIC X(10).
>                10  WS-PY-ACCOUNT       PIC X(10).
194a222
>            05  ERPYAJ-FILE-STATUS      PIC XX.
196c224
<            05  WS-DUEP-CONTROL         PIC X(19).
---
>            05  WS-DUEP-CONTROL         PIC X(19)    VALUE LOW-VALUES.
201a230
>            05  WS-WORK-TERM            PIC S999   COMP-3 VALUE +0.
278a308,312
>            05  WS-ENTRY-DATE           PIC 9(11).
>            05  FILLER REDEFINES WS-ENTRY-DATE.
>                10  FILLER              PIC XXX.
>                10  WS-ENTRY-CCYY       PIC 9(4).
>                10  WS-ENTRY-MMDD       PIC 9(4).
300a335
>            12  WS-DP-ADJ               PIC S9(9)V99 COMP-3 VALUE +0.
324c359,361
<            12  WS-ANGLEN               PIC S9(7)V99 COMP-3  VALUE +0.
---
>            12  WS-PYAJ-INDEX           PIC S999     COMP-3  VALUE +0.
>            12  WS-PYAJ-MAX             PIC S999     COMP-3  VALUE +0.
>            12  WS-ANGLEN               PIC S9(5)V9999 COMP-3  VALUE +0.
326,328c363,366
<            12  WS-ANGLEM               PIC S9(7)V99 COMP-3  VALUE +0.
<            12  WS-ANGLEMJ              PIC S9(7)V99 COMP-3  VALUE +0.
<            12  WS-ANGLEN-M             PIC S9(7)V99 COMP-3  VALUE +0.
---
>            12  WS-WORK-AMT             PIC S9(9)V99 COMP-3  VALUE +0.
>            12  WS-ANGLEM               PIC S9(5)V9999 COMP-3  VALUE +0.
>            12  WS-ANGLEMJ              PIC S9(5)V9999 COMP-3  VALUE +0.
>            12  WS-ANGLEN-M             PIC S9(5)V9999 COMP-3  VALUE +0.
383a422
>                                           WS-REC-BASE-COMM
391c430,438
<            
---
>            MOVE LOW-VALUES             TO WS-ERPYAJ-KEY
> 
>            PERFORM VARYING WS-PYAJ-INDEX FROM +1 BY +1 UNTIL
>               (WS-PYAJ-INDEX > +500)
>               MOVE LOW-VALUES          TO WS-DA-KEY (WS-PYAJ-INDEX)
>               MOVE +0                  TO WS-DA-AMOUNT (WS-PYAJ-INDEX)
>            END-PERFORM
> 
>            MOVE +0                     TO WS-PYAJ-INDEX
399a447
>                       ERPYAJ
413d460
<               
414a462,472
>            IF ERPYAJ-FILE-STATUS = '00' OR '97'
>               CONTINUE
>            ELSE
>               DISPLAY ' ERROR ON ERPYAJ OPEN  '
>                  ERPYAJ-FILE-STATUS
>               MOVE ' ERROR ON ERPYAJ OPEN  '
>                                        TO WS-ABEND-MESSAGE
>               MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS      
>               PERFORM ABEND-PGM
>            END-IF
> 
441a500,562
>        0042-START-ERPYAJ.
> 
>            MOVE LOW-VALUES             TO PY-CONTROL-PRIMARY
>            MOVE DTE-CLASIC-COMPANY-CD  TO PY-COMPANY-CD
> 
>            START ERPYAJ KEY IS NOT < PY-CONTROL-PRIMARY
> 
>            IF ERPYAJ-FILE-STATUS = '10' OR '23'
>               SET END-OF-FILE          TO TRUE
>            ELSE
>               IF ERPYAJ-FILE-STATUS NOT = '00'
>                  MOVE ' ERROR ON ERPYAJ START '
>                                        TO WS-ABEND-MESSAGE
>                  MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS      
>                  DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
>                  PERFORM ABEND-PGM
>               ELSE
>                  DISPLAY ' GOOD START ON ERPYAJ '
>               END-IF
>            END-IF
>            
>            .
>        0042-EXIT.
>            EXIT.
>                  
>        0043-READ-ERPYAJ.
> 
>            READ ERPYAJ NEXT RECORD
> 
>            IF (ERPYAJ-FILE-STATUS = '10' OR '23')
>               OR (PY-COMPANY-CD > DTE-CLASIC-COMPANY-CD)
>               SET END-OF-FILE          TO TRUE
>            ELSE
>               IF ERPYAJ-FILE-STATUS NOT = '00'
>                  MOVE ' ERROR ON ERPYAJ READ  '
>                                        TO WS-ABEND-MESSAGE
>                  MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS      
>                  DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
>                  PERFORM ABEND-PGM
>               ELSE
>                  DISPLAY ' GOOD READ ON ERPYAJ ' PY-CONTROL-PRIMARY
>               END-IF
>            END-IF
>            
>            .
>        0043-EXIT.
>            EXIT.
>                  
>        0045-PROCESS-ERPYAJ.
> 
>            IF PY-RECORD-TYPE = 'P'
>               ADD +1                   TO WS-PYAJ-INDEX
>               MOVE PY-CONTROL-PRIMARY  TO WS-DA-KEY (WS-PYAJ-INDEX)
>               MOVE PY-ENTRY-AMT        TO WS-DA-AMOUNT (WS-PYAJ-INDEX)
>               DISPLAY ' FOUND A HIT ' 
>            END-IF
>            
>            PERFORM 0043-READ-ERPYAJ    THRU 0043-EXIT
> 
>            .
>        0045-EXIT.
>            EXIT.
> 
443a565,586
>            PERFORM 0042-START-ERPYAJ   THRU 0042-EXIT
>            IF NOT END-OF-FILE
>               PERFORM 0043-READ-ERPYAJ THRU 0043-EXIT
>            END-IF
> 
>            PERFORM 0045-PROCESS-ERPYAJ THRU 0045-EXIT UNTIL
>               END-OF-FILE
>            MOVE WS-PYAJ-INDEX          TO WS-PYAJ-MAX
> 
>            CLOSE ERPYAJ
> 
>            IF ERPYAJ-FILE-STATUS = '00' OR '97'
>               CONTINUE
>            ELSE
>               MOVE ' ERROR ON ERPYAJ CLOSE '
>                                        TO WS-ABEND-MESSAGE
>               MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS      
>               DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
>               PERFORM ABEND-PGM
>            END-IF
> 
>            SET MORE-RECORDS            TO TRUE
447c590,591
<                  END-OF-CERT
---
>                  END-OF-FILE
>            PERFORM 0150-UPDATE-DUEP    THRU 0150-EXIT
462c606
<                SET END-OF-CERT         TO TRUE
---
>                SET END-OF-FILE         TO TRUE
465c609
<            IF NOT END-OF-CERT
---
>            IF NOT END-OF-FILE
484,485c628,629
<               ((CR-LFTYP (1:1) NOT = 'M' AND 'N')
<               AND (CR-AHTYP (1:1) NOT = 'M' AND 'N'))
---
>               ((CR-LFTYP (1:1) NOT = 'M' AND 'N' AND 'H')
>               AND (CR-AHTYP (1:1) NOT = 'M' AND 'N' AND 'H'))
489a634
>                  PERFORM 0090-FIND-ADJ THRU 0090-EXIT
503a649
>                                           WS-REC-BASE-COMM
511a658,696
>        0090-FIND-ADJ.
>        
>            MOVE CR-COMPANY-CD          TO WS-PYAJ-MATCH-KEY (1:1)
>            MOVE CR-CARRIER             TO WS-PYAJ-MATCH-KEY (2:1)
>            MOVE CR-GROUPING            TO WS-PYAJ-MATCH-KEY (3:6)
>            IF CR-REMIT-TO NOT NUMERIC
>               MOVE ZEROS               TO CR-REMIT-TO
>            END-IF
>            IF CR-REMIT-TO = ZEROS
>               MOVE 01                  TO CR-REMIT-TO
>            END-IF
>            MOVE CR-COM-AGT (CR-REMIT-TO)
>                                        TO WS-PYAJ-MATCH-KEY (9:10)
>            PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
>               (WS-A > +10)
>               OR (CR-AGT-TYPE (WS-A) = 'D' OR 'C')
>            END-PERFORM
> 
>            IF WS-A < +11
>               MOVE CR-COM-AGT (WS-A)   TO WS-PYAJ-MATCH-KEY (19:10)
>            ELSE
>               MOVE CR-ACCOUNT          TO WS-PYAJ-MATCH-KEY (19:10)
>            END-IF
>       *    MOVE +0                     TO WS-DP-ADJ
>            DISPLAY ' CERT KEY TO MATCH ' WS-PYAJ-MATCH-KEY
>            PERFORM VARYING WS-PYAJ-INDEX FROM +1 BY +1 UNTIL
>               (WS-PYAJ-INDEX > WS-PYAJ-MAX)
>               IF WS-DA-KEY (WS-PYAJ-INDEX) (1:28) = WS-PYAJ-MATCH-KEY
>                  COMPUTE WS-DP-ADJ
>                     = WS-DP-ADJ + WS-DA-AMOUNT (WS-PYAJ-INDEX)
>                  MOVE LOW-VALUES       TO WS-DA-KEY (WS-PYAJ-INDEX)
>               END-IF
>            END-PERFORM
>            
>            . 
>        0090-EXIT.
>            EXIT.
> 
> 
521c706
<               + WS-BASE-COMM 
---
>               + WS-REC-BASE-COMM 
535a721,734
>            MOVE CR-ENTRY-DATE          TO WS-ENTRY-DATE
>            MOVE WS-ENTRY-MMDD (1:2)    TO EXT-ENT-DATE (1:2)
>            MOVE '-'                    TO EXT-ENT-DATE (3:1)
>                                           EXT-ENT-DATE (6:1)
>            MOVE WS-ENTRY-MMDD (3:2)    TO EXT-ENT-DATE (4:2)
>            MOVE WS-ENTRY-CCYY          TO EXT-ENT-DATE (7:4)
>            MOVE RUN-DATE               TO WS-ENTRY-DATE
>            MOVE WS-ENTRY-MMDD (1:2)    TO EXT-VAL-DATE (1:2)
>            MOVE '-'                    TO EXT-VAL-DATE (3:1)
>                                           EXT-VAL-DATE (6:1)
>            MOVE WS-ENTRY-MMDD (3:2)    TO EXT-VAL-DATE (4:2)
>            MOVE WS-ENTRY-CCYY          TO EXT-VAL-DATE (7:4)
>            
>            MOVE WS-EARN-TERM           TO EXT-EARN-TERM
556c755,759
<            MOVE WS-BASE-COMM           TO EXT-BASE-COMM
---
>            IF WS-BASE-COMM > ZEROS
>               MOVE WS-BASE-COMM        TO EXT-BASE-COMM
>            ELSE
>               MOVE WS-REC-BASE-COMM    TO EXT-BASE-COMM
>            END-IF
573c776,777
<            IF WS-DUEP-CONTROL NOT = CR-ACCT-CONTROL
---
>            IF (WS-DUEP-CONTROL NOT = LOW-VALUES)
>               AND (WS-DUEP-CONTROL NOT = CR-ACCT-CONTROL)
578a783
>                                           WS-DP-ADJ
586c791
<            COMPUTE WS-DP-BASE-COMM = WS-DP-BASE-COMM + WS-BASE-COMM
---
>            COMPUTE WS-DP-BASE-COMM = WS-DP-BASE-COMM + WS-REC-BASE-COMM
596c801,803
<            MOVE WS-DUEP-CONTROL        TO DP-CONTROL-PRIMARY
---
>            MOVE DTE-CLASIC-COMPANY-CD  TO DP-COMPANY-CD
>            MOVE WS-DUEP-CONTROL        TO DP-ACCOUNT-CONTROL
>            MOVE LOW-VALUES             TO DP-KEY-FILLER
598a806
>       *       COMPUTE WS-DP-REC-PREM = WS-DP-REC-PREM
602a811
>               MOVE WS-DP-ADJ           TO DP-ADJUSTMENTS
615a825,827
>                  MOVE +0               TO DP-BAL-FWD
>                                           DP-ADJUSTMENTS
>                                           DP-END-BAL
619a832
>                  MOVE WS-DP-ADJ        TO DP-ADJUSTMENTS
739,740c952,967
<            IF CR-LFTYP = '00' OR '  '
<               CONTINUE
---
>            IF WS-BIN-LF-END-DATE NOT > BIN-RUN-DATE
>               MOVE ZEROS               TO CR-LFPRM
>                                           CR-LFTYP
>                                           CR-LF-TERM
>                                           CR-LFPRM-RATE
>            END-IF
> 
>            IF WS-BIN-AH-END-DATE NOT > BIN-RUN-DATE
>               MOVE ZEROS               TO CR-AHPRM
>                                           CR-AHTYP
>                                           CR-AH-TERM
>                                           CR-AHPRM-RATE
>            END-IF
> 
>            IF CR-LF-TERM > CR-AH-TERM
>               MOVE CR-LF-TERM          TO WS-WORK-TERM
742c969
<               PERFORM 0210-CALC-LIFE-UEP   THRU 0210-EXIT
---
>               MOVE CR-AH-TERM          TO WS-WORK-TERM
743a971,981
>            
>            IF (CR-LFTYP = '00' OR '  ')
>               AND (CR-AHTYP = '00' OR '  ')
>               CONTINUE
>            ELSE
>               PERFORM 0205-CALC-UEP    THRU 0205-EXIT
>               IF LF-REM-TRM2 > AH-REM-TRM2
>                  MOVE LF-REM-TRM2      TO REM-TRM2
>               ELSE
>                  MOVE AH-REM-TRM2      TO REM-TRM2
>               END-IF
744a983,986
>               PERFORM 0210-CALC-UEP    THRU 0210-CALC-UEP
>            END-IF
>               
>            
750c992,997
<        0210-CALC-LIFE-UEP.
---
>        0205-CALC-UEP.
>        
>            MOVE +0                     TO LF-REM-TRM1
>                                           LF-REM-TRM2
>                                           AH-REM-TRM1
>                                           AH-REM-TRM2
751a999,1027
>            IF CR-LFTYP NOT = '  ' AND ZEROS
>               PERFORM 0207-FIND-LIFE-TYPE
>                                        THRU 0207-EXIT
>               IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
>                  CONTINUE
>               ELSE
>                  PERFORM 0220-CALC-LF-REM-TERM
>                                        THRU 0220-EXIT
>               END-IF
>            END-IF
>                                        
>            IF CR-AHTYP NOT = '  ' AND ZEROS
>               PERFORM 0208-FIND-AH-TYPE
>                                        THRU 0208-EXIT
>               IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
>                  CONTINUE
>               ELSE
>                  PERFORM 0225-CALC-AH-REM-TERM
>                                        THRU 0225-EXIT
>               END-IF
>            END-IF
>                                        
>                      
>            .
>        0205-EXIT.
>           EXIT.
>           
>        0207-FIND-LIFE-TYPE.
>        
756,757c1032,1033
<                   (CLAS-INDEXL = CLAS-MAXL) OR
<                   (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
---
>                (CLAS-INDEXL = CLAS-MAXL) OR
>                (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
769c1045,1051
<            IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
---
>            .
>        0207-EXIT.
>            EXIT.
> 
>        0208-FIND-AH-TYPE.
>        
>            IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
772,782c1054,1078
<               PERFORM 0220-CALC-LF-REM-TERM
<                                        THRU 0220-EXIT
<               MOVE ZEROS               TO WS-REM-AMT
<       *       IF LF-REM-TRM2 > ZERO
<       *          PERFORM 2000-CALC-REM-AMT
<       *                                THRU 2999-CALC-REM-AMT-X
<       *       END-IF
<       *       COMPUTE WS-LF-INFORCE = WS-LF-INFORCE + WS-REM-AMT
<               IF CR-LFTYP = ('MG' OR 'MJ' OR 'NJ' OR 'NL')
<                  IF CR-ENTRY-DATE = WS-TEST-RUN-DATE
<                     PERFORM 0215-CALC-RECEIVE 
---
>               PERFORM VARYING CLAS-INDEXA FROM +1 BY +1 UNTIL
>                   (CLAS-INDEXA = CLAS-MAXA) OR
>                   (CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA))
>               END-PERFORM
>               IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
>                  CONTINUE
>               ELSE
>                  DISPLAY ' AH  BENEFIT ' CR-AHTYP ' NOT IN TABLE'
>                  DISPLAY 'RETURN CODE - 0401'
>                  MOVE 0401 TO WS-RETURN-CODE
>                  PERFORM ABEND-PGM
>               END-IF
>            END-IF
> 
>            .
>        0208-EXIT.
>            EXIT.
> 
>        0210-CALC-UEP.
> 
>            MOVE ZEROS                  TO WS-REM-AMT
>            IF (CR-LFTYP = 'MG' OR 'MJ' OR 'NJ' OR 'NL')
>               OR (CR-AHTYP = 'MG' OR 'MJ' OR 'NJ' OR 'NL')
>               IF CR-ENTRY-DATE = WS-TEST-RUN-DATE
>                  PERFORM 0215-CALC-RECEIVE 
783a1080,1089
>               END-IF
>            ELSE
>               MOVE +0            TO WS-BASE-COMM
>               PERFORM VARYING X1 FROM +1 BY +1 UNTIL
>                  (X1 > +10)
>                  IF CR-AGT-TYPE (X1) = 'C' OR 'D'
>                     COMPUTE WS-BASE-COMM = WS-BASE-COMM
>                     + (CR-LFPRM * CR-LCOM-L (X1))
>                     + (CR-LFPRM-ALT * CR-LCOM-L (X1))
>                     + (CR-AHPRM * CR-LCOM-AH (X1))
784a1091,1104
>               END-PERFORM
>               IF (CR-LFTYP (1:1) = 'M')
>                  OR (CR-AHTYP (1:1) = 'M')
>       *          COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
>                  COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TRM2
>                  COMPUTE WS-EXP-PREM = (CR-LFPRM + CR-AHPRM)
>                  IF RUN-DATE = CR-ENTRY-DATE
>                     COMPUTE WS-EXP-PREM = WS-EXP-PREM
>                        * WS-EARN-TERM
>                     COMPUTE WS-BASE-COMM = WS-BASE-COMM
>                        * WS-EARN-TERM
>                  END-IF
>                  COMPUTE WS-EXP-PREM = 
>                     (WS-EXP-PREM - WS-BASE-COMM) 
786,789c1106
<                  IF CR-LFTYP (1:1) = 'M'
<                     COMPUTE WS-EXP-PREM = CR-LFPRM + CR-AHPRM
<                  ELSE
<                     PERFORM 0230-CALC-LF-UEP
---
>                  PERFORM 0230-CALC-UEP
791d1107
<                  END-IF
799a1116
> 
803c1120
<                                           WS-BASE-COMM
---
>                                           WS-REC-BASE-COMM
808c1125
<                  COMPUTE WS-BASE-COMM = WS-BASE-COMM +
---
>                  COMPUTE WS-REC-BASE-COMM = WS-REC-BASE-COMM +
823c1140
<               - WS-BASE-COMM
---
>               - WS-REC-BASE-COMM
878c1195,1197
< 
---
>            DISPLAY ' LF CERT ' CR-CERT-NO ' TERM ' CR-LF-TERM
>               ' REM2 ' LF-REM-TRM2
>               
884c1203,1238
<        0230-CALC-LF-UEP.
---
>        0225-CALC-AH-REM-TERM.
> 
>            MOVE BIN-RUN-DATE           TO CP-VALUATION-DT
> 
>            MOVE CLAS-I-RL-AH (CLAS-INDEXA)
>                                        TO CP-BENEFIT-TYPE
>            MOVE CLAS-I-BAL (CLAS-INDEXA)
>                                        TO CP-SPECIAL-CALC-CD
>            MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
>                                           CP-LOAN-TERM
> 
>            MOVE DTE-REM-TRM-CALC-OPTION
>                                        TO CP-REM-TRM-CALC-OPTION
> 
>            PERFORM 0510-GET-REMAINING-TERM
>                                        THRU 0510-EXIT
> 
>            IF CP-REMAINING-TERM-1 NEGATIVE
>                MOVE ZEROS              TO CP-REMAINING-TERM-1
>            END-IF
> 
>            IF CP-REMAINING-TERM-2 NEGATIVE
>                MOVE ZEROS              TO CP-REMAINING-TERM-2
>            END-IF
> 
>            MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
>            MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
>            DISPLAY ' AH CERT ' CR-CERT-NO ' TERM ' CR-AH-TERM
>               ' REM2 ' AH-REM-TRM2
>               
>            .
> 
>        0225-EXIT.
>            EXIT.
> 
>        0230-CALC-UEP.
887c1241,1242
<            COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
---
>       *    COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
>            COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TRM2
895a1251,1253
>            IF CR-LOAN-TERM = ZEROS
>               MOVE CR-AH-TERM          TO CR-LOAN-TERM
>            END-IF
907c1265,1266
<            COMPUTE WS-VM = (1 + WS-J) ** (CR-LF-TERM * -1)
---
>       *    COMPUTE WS-VM = (1 + WS-J) ** (CR-LF-TERM * -1)
>            COMPUTE WS-VM = (1 + WS-J) ** (WS-WORK-TERM * -1)
913c1272
<               ** (CR-LF-TERM * -1))) / WS-J
---
>               ** (WS-WORK-TERM * -1))) / WS-J
923c1282
<               ** (CR-LF-TERM * -1))) / WS-I
---
>               ** (WS-WORK-TERM * -1))) / WS-I
928c1287
<               ** ((CR-LOAN-TERM - CR-LF-TERM) * -1))) / WS-I
---
>               ** ((CR-LOAN-TERM - WS-WORK-TERM) * -1))) / WS-I
931a1291,1295
> 
>            IF CR-LFAMT = ZEROS
>               COMPUTE CR-LFAMT = CR-AHAMT * WS-WORK-TERM
>            END-IF
> 
939c1303
<               / WS-ANGLEM           
---
>               / WS-ANGLEMJ           
943a1308
> 
951c1316
<            MOVE 2                      TO WS-EARN-TERM
---
>       *    MOVE 1                      TO WS-EARN-TERM
969a1335
>                  COMPUTE WS-BASE-COMM = WS-BASE-COMM * WS-A
973a1340,1341
>               MOVE WS-AMT              TO WS-DISPLAY-FLD
>               DISPLAY ' WS-AMT B4    ' WS-AMT
976a1345,1346
>               MOVE WS-AMT              TO WS-DISPLAY-FLD
>               DISPLAY ' WS-AMT AFTER ' WS-AMT
994c1364,1369
<            COMPUTE WS-EXP-PREM = WS-LF-PRM + WS-AH-PRM              
---
>            DISPLAY ' WS-LF-PRM        = ' WS-LF-PRM
>            DISPLAY ' WS-AH-PRM        = ' WS-AH-PRM
>            DISPLAY ' WS-BASE-COMM     = ' WS-BASE-COMM
>            DISPLAY ' WS-REC-BASE-COMM = ' WS-REC-BASE-COMM
>            COMPUTE WS-EXP-PREM = (WS-LF-PRM + WS-AH-PRM)
>       *       - WS-BASE-COMM
999a1375
> 
1207,1208d1582
<            
<        0420-CALC-AH-REM-TERM.
1210,1244d1583
<            MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
< 
<            MOVE CLAS-I-RL-AH (CLAS-INDEXA)
<                                        TO CP-BENEFIT-TYPE
<            MOVE CLAS-I-BAL (CLAS-INDEXA)
<                                        TO CP-SPECIAL-CALC-CD
<            MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
<                                           CP-LOAN-TERM
< 
<            MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS
< 
<            MOVE DTE-REM-TRM-CALC-OPTION
<                                        TO CP-REM-TRM-CALC-OPTION
< 
<            PERFORM 0510-GET-REMAINING-TERM
<                                        THRU 0510-EXIT
< 
<            IF CP-REMAINING-TERM-1 NEGATIVE
<                MOVE ZEROS              TO CP-REMAINING-TERM-1
<            END-IF
< 
<            IF CP-REMAINING-TERM-2 NEGATIVE
<                MOVE ZEROS              TO CP-REMAINING-TERM-2
<            END-IF
< 
<            MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
<            MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
< 
<            .
< 
<        0420-EXIT.
<            EXIT.
< 
< 
< 
1254,1279d1592
< 
<            .
<        2900-DISPLAY-AMTS.
< 
<       *    IF (CR-DT > 19921231) AND
<       *       (CR-DT < 19940101) AND
<       *    IF (WS-BIN-VAL-DATES (VYR) = X'95FF')
<       *       MOVE CR-DT TO WS-DISPLAY-DATE
<       *       MOVE CR-LF-TERM TO WS-DISPLAY-TERM
<       *       MOVE LF-REM-TRM2 TO WS-DISPLAY-RTERM
<       *       MOVE CR-LFPRM TO WS-DISPLAY-PRM
<       *       IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L'
<       *          ADD CR-LFAMT CR-LFAMT-ALT GIVING WS-DISPLAY-AMT
<       *       ELSE
<       *          MOVE CR-LFAMT     TO WS-DISPLAY-AMT
<       *       END-IF
<       *       MOVE WS-REM-AMT   TO WS-DISPLAY-RAMT
<       *       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
<       *        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
<       *        WS-DISPLAY-AMT '   ' WS-DISPLAY-RAMT
<       *    END-IF
< 
<            .
<        2999-CALC-REM-AMT-X.
<            EXIT.
<        EJECT
1280a1594
> 
1317,1320c1631,1632
<        8699-EXIT.                                                       ECS064
<            EXIT.                                                        ECS064
<                                                                         ECS064
<        8800-PRT-RTN.                                                    ECS064
---
>        8699-EXIT.
>            EXIT.
1321a1634,1635
>        8800-PRT-RTN.
> 
79a80
> 052303* 052303    2001061800003  SMVA  DO NOT PRINT TAXES SECTION FOR DCC
1058,1060c1059,1062
< 01021      MOVE GR-LFTAX     TO  X-TAX.                                 
< 01022      MOVE GRR-LFTAX    TO  X-T78.                                 
< 01023      MOVE GRP-LFTAX    TO  X-TRATA.                               
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01021          MOVE GR-LFTAX     TO  X-TAX                                  
> 01022          MOVE GRR-LFTAX    TO  X-T78                                  
> 01023          MOVE GRP-LFTAX    TO  X-TRATA.                               
1174,1177c1176,1180
< 01137      ADD X-TAX      TO  R-TAX.                                    
< 01138      ADD X-T78      TO  R-T78.                                    
< 01139      ADD X-TRATA    TO  R-TRATA.                                  
< 01140      ADD X-TDOMI    TO  R-TDOMI.                                  
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01137          ADD X-TAX      TO  R-TAX                                     
> 01138          ADD X-T78      TO  R-T78                                     
> 01139          ADD X-TRATA    TO  R-TRATA                                   
> 01140          ADD X-TDOMI    TO  R-TDOMI.                                  
1317,1319c1320,1323
< 01280      MOVE GR-AHTAX      TO  X-TAX.                                
< 01281      MOVE GRR-AHTAX     TO  X-T78.                                
< 01282      MOVE GRP-AHTAX     TO  X-TRATA.                              
---
> 052303     IF DTE-CLIENT NOT = 'DCC' 
> 01280          MOVE GR-AHTAX      TO  X-TAX                                 
> 01281          MOVE GRR-AHTAX     TO  X-T78                                 
> 01282          MOVE GRP-AHTAX     TO  X-TRATA.                              
1405,1408c1409,1413
< 01368      ADD X-TAX      TO  R-TAX.                                    
< 01369      ADD X-T78      TO  R-T78.                                    
< 01370      ADD X-TRATA    TO  R-TRATA.                                  
< 01371      ADD X-TDOMI    TO  R-TDOMI.                                  
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01368          ADD X-TAX      TO  R-TAX                                     
> 01369          ADD X-T78      TO  R-T78                                     
> 01370          ADD X-TRATA    TO  R-TRATA                                   
> 01371          ADD X-TDOMI    TO  R-TDOMI.                                  
1633,1636c1638,1642
< 01596      ADD W-TAX      TO  R-TAX.                                    
< 01597      ADD W-T78      TO  R-T78.                                    
< 01598      ADD W-TRATA    TO  R-TRATA.                                  
< 01599      ADD W-TDOMI    TO  R-TDOMI.                                  
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01596          ADD W-TAX      TO  R-TAX                                     
> 01597          ADD W-T78      TO  R-T78                                     
> 01598          ADD W-TRATA    TO  R-TRATA                                   
> 01599          ADD W-TDOMI    TO  R-TDOMI.                                  
2383a2390
> 
2624,2627c2631,2635
< 02585      ADD X-TAX      TO  S-TAX.                                    
< 02586      ADD X-T78      TO  S-T78.                                    
< 02587      ADD X-TRATA    TO  S-TRATA.                                  
< 02588      ADD X-TDOMI    TO  S-TDOMI.                                  
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 02585          ADD X-TAX      TO  S-TAX                                     
> 02586          ADD X-T78      TO  S-T78                                     
> 02587          ADD X-TRATA    TO  S-TRATA                                   
> 02588          ADD X-TDOMI    TO  S-TDOMI.                                  
2684,2687c2692,2696
< 02645      ADD X-TAX      TO  S-TAX.                                    
< 02646      ADD X-T78      TO  S-T78.                                    
< 02647      ADD X-TRATA    TO  S-TRATA.                                  
< 02648      ADD X-TDOMI    TO  S-TDOMI.                                  
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 02645          ADD X-TAX      TO  S-TAX                                     
> 02646          ADD X-T78      TO  S-T78                                     
> 02647          ADD X-TRATA    TO  S-TRATA                                   
> 02648          ADD X-TDOMI    TO  S-TDOMI.                                  
2712,2715c2721,2725
< 02673      ADD S-TAX      TO  T-TAX.                                    
< 02674      ADD S-T78      TO  T-T78.                                    
< 02675      ADD S-TRATA    TO  T-TRATA.                                  
< 02676      ADD S-TDOMI    TO  T-TDOMI.                                  
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 02673          ADD S-TAX      TO  T-TAX                                     
> 02674          ADD S-T78      TO  T-T78                                     
> 02675          ADD S-TRATA    TO  T-TRATA                                   
> 02676          ADD S-TDOMI    TO  T-TDOMI.                                  
2886,2889c2896,2900
< 02844      MOVE X-TAX      TO  P-TAX.                                   
< 02845      MOVE X-T78      TO  P-T78.                                   
< 02846      MOVE X-TRATA    TO  P-TRATA.                                 
< 02847      MOVE X-TDOMI    TO  P-TDOMI.                                 
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 02844          MOVE X-TAX      TO  P-TAX                                    
> 02845          MOVE X-T78      TO  P-T78                                    
> 02846          MOVE X-TRATA    TO  P-TRATA                                  
> 02847          MOVE X-TDOMI    TO  P-TDOMI.                                 
3317,3320c3328,3332
< 03272      ADD X-TAX      TO  R-TAX.                                    
< 03273      ADD X-T78      TO  R-T78.                                    
< 03274      ADD X-TRATA    TO  R-TRATA.                                  
< 03275      ADD X-TDOMI    TO  R-TDOMI.                                  
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 03272          ADD X-TAX      TO  R-TAX                                     
> 03273          ADD X-T78      TO  R-T78                                     
> 03274          ADD X-TRATA    TO  R-TRATA                                   
> 03275          ADD X-TDOMI    TO  R-TDOMI.                                  
37a38
> 052303* 052303    2001061800003  SMVA  DO NOT PRINT TAX DATA FOR DCC
619,621c620,623
< 00575      ADD W-TAX      TO X-TAX.                                     ECS084
< 00576      ADD W-T78      TO X-T78.                                     ECS084
< 00577      ADD W-TRATA    TO X-TRATA.                                   ECS084
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 00575          ADD W-TAX      TO X-TAX
> 00576          ADD W-T78      TO X-T78
> 00577          ADD W-TRATA    TO X-TRATA.
684,686c686,689
< 00640      ADD X-TAX      TO S-TAX.                                     ECS084
< 00641      ADD X-T78      TO S-T78.                                     ECS084
< 00642      ADD X-TRATA    TO S-TRATA.                                   ECS084
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 00640          ADD X-TAX      TO S-TAX
> 00641          ADD X-T78      TO S-T78
> 00642          ADD X-TRATA    TO S-TRATA. 
1122,1124c1125,1128
< 01071      ADD X-TAX      TO S-TAX.                                     ECS084
< 01072      ADD X-T78      TO S-T78.                                     ECS084
< 01073      ADD X-TRATA    TO S-TRATA.                                   ECS084
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01071          ADD X-TAX      TO S-TAX
> 01072          ADD X-T78      TO S-T78
> 01073          ADD X-TRATA    TO S-TRATA. 
1188,1190c1192,1195
< 01136      ADD X-TAX      TO S-TAX.                                     ECS084
< 01137      ADD X-T78      TO S-T78.                                     ECS084
< 01138      ADD X-TRATA    TO S-TRATA.                                   ECS084
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01136          ADD X-TAX      TO S-TAX
> 01137          ADD X-T78      TO S-T78
> 01138          ADD X-TRATA    TO S-TRATA. 
1213,1215c1218,1221
< 01161      ADD S-TAX      TO T-TAX.                                     ECS084
< 01162      ADD S-T78      TO T-T78.                                     ECS084
< 01163      ADD S-TRATA    TO T-TRATA.                                   ECS084
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01161          ADD S-TAX      TO T-TAX
> 01162          ADD S-T78      TO T-T78
> 01163          ADD S-TRATA    TO T-TRATA.
1376,1378c1382,1385
< 01323      MOVE X-TAX      TO P-TAX.                                    ECS084
< 01324      MOVE X-T78      TO P-T78.                                    ECS084
< 01325      MOVE X-TRATA    TO P-TRATA.                                  ECS084
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01323          MOVE X-TAX      TO P-TAX
> 01324          MOVE X-T78      TO P-T78
> 01325          MOVE X-TRATA    TO P-TRATA. 
1414,1416c1421,1424
< 01361      ADD X-TAX      TO S-TAX.                                     ECS084
< 01362      ADD X-T78      TO S-T78.                                     ECS084
< 01363      ADD X-TRATA    TO S-TRATA.                                   ECS084
---
> 052303     IF DTE-CLIENT NOT = 'DCC'
> 01361          ADD X-TAX      TO S-TAX
> 01362          ADD X-T78      TO S-T78
> 01363          ADD X-TRATA    TO S-TRATA.  
13c13
<       * DANA  01/01/99  CR#199801150013  FREEDOM SYSTEM INSTALL       * 00130030
---
>       * DANA  01/01/99  CR#199801150013 - FREEDOM SYSTEM INSTALL      * 00130030
15,19c15,19
<       * DANA  09/01/99  CR#1999072000004 NEW FORMAT FOR SYS020        * 00132039
<       * DANA  02/16/01  CR#2001011600002 REMOVE LOGIC ACCT MASTER     * 00133041
< 061501* DANA  06/22/01  CR#1999061000004 REMOVE MSA CONVERSION FILE   * 00134043
< 030702* SMVA  03/07/02  CR#2002021300008 ELIMINATE PLAN CODE TABLE
<       *                                  DEPENDENCIES
---
>       * DANA  09/01/99  CR#1999072000004 - NEW FORMAT FOR SYS020      * 00132039
>       * DANA  02/16/01  CR#2001011600002 - REMOVE LOGIC ACCT MASTER   * 00133041
> 061501* DANA  06/22/01  CR#1999061000004 - REMOVE MSA CONVERSION FILE * 00134043
> 030702* SMVA  03/07/02  CR#2002021300008  ELIMINATE PLAN CODE TABLE
>       *                                 DEPENDENCIES
23c23
< 060503*                                  SKEWED REC LNGTH IN INTFCE FILE 
---
> 060503*                                  SKEWED REC LNGTH IN INTFCE FILE
185,186c185,186
<            MOVE ' '               TO FX-AGENT-01         
<            MOVE ' '               TO FX-DISTR           
---
>            MOVE ' '               TO FX-AGENT-01    
>            MOVE ' '               TO FX-DISTR      
191,195c191,195
< 061501         MOVE PY-GL-ACCOUNT TO FX-SOURCE-ACCT  
< 060503     END-IF  
<            MOVE PY-CARRIER        TO FX-DESCRIPTION(27:1)  
<            MOVE PY-GROUPING(4:3)  TO FX-DESCRIPTION(28:3) 
<            MOVE ' '               TO FX-REFERENCE        
---
> 061501         MOVE PY-GL-ACCOUNT TO FX-SOURCE-ACCT
> 060503     END-IF
>            MOVE PY-CARRIER        TO FX-DESCRIPTION(27:1)     
>            MOVE PY-GROUPING(4:3)  TO FX-DESCRIPTION(28:3)    
>            MOVE ' '               TO FX-REFERENCE           
197,200c197,200
<                                                         
<            MOVE PY-ACCOUNT(3:8)   TO WS-CID-ACCT       
< 012099     IF WS-CID-ACCT = LOW-VALUE                                   01781037
< 012099         MOVE SPACES        TO WS-CID-ACCT     
---
>                                                            
>            MOVE PY-ACCOUNT(3:8)   TO WS-CID-ACCT          
> 012099     IF WS-CID-ACCT = LOW-VALUE                    
> 012099        MOVE SPACES         TO WS-CID-ACCT        
202,203c202,203
<                                                                         01783037
<            MOVE WS-SUSPENSE      TO FX-SUSPENSE                         01790030
---
>                                                        
>            MOVE WS-SUSPENSE       TO FX-SUSPENSE      
28a29,39
> 060903******************************************************************
> 060903*                   C H A N G E   L O G
> 060903*
> 060903* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
> 060903*-----------------------------------------------------------------
> 060903*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
> 060903* EFFECTIVE    NUMBER
> 060903*-----------------------------------------------------------------
> 060903* 060903    2001061800003  PEMA  CHANGE MORT RESERVES TO LFUEP
> 060903*                                FOR DCC ONLY
> 060903******************************************************************
1443a1455,1459
> 060903     IF DTE-CLIENT = 'DCC'
> 060903        MOVE 'LIFE UNEARNED PREMIUM '
> 060903                                 TO DT-ENTRY (20)
> 060903     END-IF
> 060903     .
2310c2326,2328
< 02281      ADD EP-MORT-RESV            TO DA-MORT (SA).                 ECS045
---
> 060903     IF DTE-CLIENT NOT = 'DCC'
> 060903        ADD EP-MORT-RESV         TO DA-MORT (SA)
> 060903     END-IF
2334c2352,2354
< 02305                                 (EP-PRM-PR + EP-PRM-PR-ADJ)).     ECS045
---
> 02305                                 (EP-PRM-PR + EP-PRM-PR-ADJ))      ECS045
> 060903     END-IF
> 060903        .
3356a3377,3379
> 060903     IF DTE-CLIENT = 'DCC'
> 060903        MOVE DA-UP (SA)          TO DA-MORT (SA)
> 060903     END-IF
3364a3388,3390
> 060903     IF DTE-CLIENT = 'DCC'
> 060903        MOVE DA-UP (SA)          TO DA-MORT (SA)
> 060903     END-IF
30a31,40
> 061203******************************************************************
> 061203*                   C H A N G E   L O G
> 061203*
> 061203* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
> 061203*-----------------------------------------------------------------
> 061203*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
> 061203* EFFECTIVE    NUMBER
> 061203*-----------------------------------------------------------------
> 061203* 061203    2001061800003  SMVA  MOD FOR DCC FRIDAY CYCLE
> 061203******************************************************************
457c467,468
< 00438         IF DTE-CLIENT  =  'CID'                                   
---
> 00438         IF DTE-CLIENT  =  'CID'
> 061203                       OR 'DCC'
1232a1233
> 060503         MOVE 'JL'   TO  V-LF-BEN-CODE
1271a1273,1276
> 060503     IF PBI-I-LF-PREM-AMT = ZEROS
> 060503        MOVE ZEROS               TO PBI-I-LF-BENEFIT-AMT
> 060503     END-IF
> 060503
42a43,44
> 061703* 061703                   PEMA  REMOVE O/W COMM FROM COMM
> 061703* 061703                         CALC FOR DCC ONLY
2630a2633,2660
> 061703     IF DTE-CLIENT = 'DCC'
> 061703       IF ((GR-REIN = 'P')
> 061703         AND (CR-AGT-TYPE (SA) = ('C' OR 'D')))
> 061703       OR
> 061703         ((GR-REIN = 'R')
> 061703         AND (CR-AGT-TYPE (SA) = ('R' OR 'D')))
> 061703           COMPUTE GR-LFCOM =
> 061703               GR-LFCOM + (LF-PRM * CR-LCOM-L (SA))
> 061703           COMPUTE GR-LFCOM-ALT =
> 061703               GR-LFCOM-ALT + (LF-PRM-ALT * CR-LCOM-L (SA))
> 061703           COMPUTE GR-AHCOM =
> 061703               GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
> 061703           IF (WS-CHARGEBACK-SW (SA) = 'N') OR
> 061703              ((AM-COMM-CHARGEBACK (SA) NOT = ZEROS) AND
> 061703              (MONTHS-DIFF > AM-COMM-CHARGEBACK (SA)))
> 061703              CONTINUE
> 061703           ELSE
> 061703              COMPUTE WS-GR-LFCOM =
> 061703                  WS-GR-LFCOM + (LF-PRM * CR-LCOM-L (SA))
> 061703              COMPUTE WS-GR-LFCOM-ALT =
> 061703                  WS-GR-LFCOM-ALT + (LF-PRM-ALT * CR-LCOM-L (SA))
> 061703              COMPUTE WS-GR-AHCOM =
> 061703                  WS-GR-AHCOM + (GR-AHPRM * CR-LCOM-AH (SA))
> 061703           END-IF
> 061703       END-IF
> 061703     ELSE
> 
> 
2654a2685,2689
> 061703     END-IF
> 
> 
> 
> 
2645,2652c2645
< PEMTMP     IF CR-ENTRY-STATUS = '1' OR '3' OR '4' OR 'P'
< PEMTMP        PERFORM 2100-BUILD-ISSUE-EXTRACT
<                                        THRU 2199-BLD-ISSUE-X
<       *                                THRU 2259-END-CANCEL-BUILD
<               PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X
<               IF (CR-LFRFND > ZEROS)
<                  OR (CR-AHRFND > ZEROS)
<                  PERFORM 2200-BUILD-CANCEL-EXTRACT
---
> PEMTMP     PERFORM 2100-BUILD-ISSUE-EXTRACT
2654c2647,2652
<                  PERFORM 3200-REINSURE-CANCEL
---
>            PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X
>            IF (CR-LFRFND > ZEROS)
>               OR (CR-AHRFND > ZEROS)
>               PERFORM 2200-BUILD-CANCEL-EXTRACT
>                                        THRU 2259-END-CANCEL-BUILD
>               PERFORM 3200-REINSURE-CANCEL
2656d2653
<               END-IF
7279d7275
<            MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
12c12
<            SELECT SAL-LOGICCLMS-IN     ASSIGN TO SYS010.
---
>            SELECT SAL-PREHIST-IN       ASSIGN TO SYS010.
20c20
<        FD  SAL-LOGICCLMS-IN
---
>        FD  SAL-PREHIST-IN
22a23,71
>        01  SAL-PREHIST-IN-REC.
>            05  FILLER                  PIC X(03).
>            05  PREHIST-FULL-CONTROL.
>                10  PREHIST-ACCT-CONTROL.
>                    15  FILLER          PIC X(09).
>                    15  PREHIST-ACCOUNT PIC X(10).
>                10  PREHIST-CERT-EFF-DT PIC 9(11)     COMP-3.
>                10  PREHIST-FULL-CERT-NO.
>                    15  PREHIST-CERT-NO PIC X(10).
>                    15  FILLER          PIC X(01).
>            05  FILLER                  PIC X(88).
>            05  FILLER                  PIC X(111).
>            05  FILLER                  PIC X(75).
>            05  FILLER                  PIC X(99).
>            05  FILLER                  PIC X(69).
>            05  PREHIST-DEATH-CLM-DATA.
>                10  PREHIST-NUM-DTH-CLM PIC S9(03)    COMP-3.
>                10  PREHIST-DTH-DT      PIC 9(11)     COMP-3.
>                10  PREHIST-DTH-RPT-DT  PIC 9(06).
>                10  PREHIST-DTH-PAY-DT  PIC 9(11)     COMP-3.
>                10  PREHIST-DTHAMT      PIC S9(09)V99 COMP-3.
>                10  PREHIST-DTHAMT-YTD  PIC S9(09)V99 COMP-3.
>                10  PREHIST-DTHAMT-LAST PIC S9(09)V99 COMP-3.
>                10  FILLER              PIC X(10).
>                10  PREHIST-DTHAGE      PIC 9(02).
>                10  PREHIST-DTH-PAY-CD  PIC X(01).
>                10  PREHIST-DEATH-CAUSE PIC X(06).
>                10  FILLER              PIC X(16).
>            05  PREHIST-DISAB-CLM-DATA.
>                10  PREHIST-NUM-DIS-CLM PIC S9(03)    COMP-3.
>                10  PREHIST-DIS-DT      PIC 9(11)     COMP-3.
>                10  PREHIST-DIS-RPT-DT  PIC 9(06).
>                10  PREHIST-DIS-PAY-DT  PIC 9(11)     COMP-3.
>                10  PREHIST-DIS-PTO-DT  PIC 9(11)     COMP-3.
>                10  PREHIST-DISAMT      PIC S9(09)V99 COMP-3.
>                10  PREHIST-DISAMT-YTD  PIC S9(09)V99 COMP-3.
>                10  PREHIST-DISAMT-LAST PIC S9(09)V99 COMP-3.
>                10  FILLER              PIC X(10).
>                10  PREHIST-DAYS-DISAB  PIC 9(03)     COMP-3.
>                10  PREHIST-DIS-PAY-CD  PIC X(01).
>                10  FILLER              PIC X(02).
>                10  PREHIST-DISAB-INCURRED-DETAIL.
>                    15  PREHIST-DISAB-DETAIL-DATA OCCURS 5 TIMES.
>                        20  PREHIST-DIS-INCUR-DT PIC 9(11)     COMP-3.
>                        20  PREHIST-INCUR-DISAMT PIC S9(09)V99 COMP-3.
>                        20  FILLER               PIC X(06).
>                10  PREHIST-DISAB-CAUSE PIC X(06).
>                10  FILLER              PIC X(14).
>            05  FILLER                  PIC X(333).
25d73
<                                        COPY ECSEXT01.
47,53c95,104
<        77  WS-EOF-SW1                  PIC X  VALUE SPACES.
<            88  END-OF-CLMS                VALUE 'Y'.
<        77  WS-EOF-SW2                  PIC X  VALUE SPACES.
<            88  END-OF-CERT                VALUE 'Y'.
<        77  WS-MATCH-SW                 PIC X  VALUE SPACES.
<            88  CERT-FOUND                 VALUE 'Y'.
<        77  INCUR-INDEX                 PIC S9(03) COMP-3 VALUE +0.
---
>        77  WS-EOF-SW1                  PIC X  VALUE SPACE.
>            88  END-OF-PREHIST                 VALUE 'Y'.
>        77  WS-EOF-SW2                  PIC X  VALUE SPACE.
>            88  END-OF-CERT                    VALUE 'Y'.
>        77  WS-MATCH-SW                 PIC X  VALUE SPACE.
>            88  CERT-FOUND                     VALUE 'Y'.
>        77  WS-READ-CERT-SW             PIC X  VALUE SPACE.
>            88  OKAY-TO-READ-CERT              VALUE ' '.
>            88  SKIP-8300-READ-CERT            VALUE 'X'.
>        77  SUB                         PIC S9(03) COMP-3 VALUE +0.
57c108,111
<        77  WS-CLM-IN-CNT               PIC 9(9)   VALUE ZEROS.
---
>        77  WS-PREHIST-IN-CNT           PIC 9(9)   VALUE ZEROS.
>        77  WS-001ACCT-CNT              PIC 9(9)   VALUE ZEROS.
>        77  WS-NONE-CERT-CNT            PIC 9(9)   VALUE ZEROS.
>        77  WS-ZERO-CERT-CNT            PIC 9(9)   VALUE ZEROS.
59a114
>        77  WS-MATCH-CNT                PIC 9(9)   VALUE ZEROS.
135c190,191
<            PERFORM 0080-READ-CLMS      THRU 0080-EXIT
---
>            PERFORM 0080-READ-PREHIST   THRU 0080-EXIT
>            PERFORM 0083-READ-CERT      THRU 0083-EXIT
137c193
<                UNTIL END-OF-CLMS
---
>                UNTIL END-OF-PREHIST
151c207
<            OPEN INPUT  SAL-LOGICCLMS-IN 
---
>            OPEN INPUT  SAL-PREHIST-IN 
161c217,220
<            DISPLAY ' CLAIM RECORDS IN  ' WS-CLM-IN-CNT
---
>            DISPLAY ' PREHIST RECORDS IN  ' WS-PREHIST-IN-CNT
>            DISPLAY ' 001 ACCT RECORDS IN  ' WS-001ACCT-CNT
>            DISPLAY ' none cert #  ' WS-NONE-CERT-CNT
>            DISPLAY ' zero cert #  ' WS-ZERO-CERT-CNT
163a223
>            DISPLAY ' MATCH COUNT ' WS-MATCH-CNT
165c225
<            CLOSE SAL-LOGICCLMS-IN
---
>            CLOSE SAL-PREHIST-IN
175c235
<            PERFORM 0070-FIND-CERT      THRU 0070-EXIT 
---
>            PERFORM 0070-FIND-CERT          THRU 0070-EXIT 
177a238,242
>            IF END-OF-CERT 
>                IF NOT END-OF-PREHIST
>                    DISPLAY 'end cert before end prehist'
>                END-IF
>            END-IF
179c244,245
<            PERFORM 0080-READ-CLMS      THRU 0080-EXIT
---
>            PERFORM 0080-READ-PREHIST       THRU 0080-EXIT
>           
181c247
<            MOVE 'N'                    TO WS-MATCH-SW 
---
>            MOVE 'N'                        TO WS-MATCH-SW 
190,191c256,259
<            PERFORM 0083-READ-CERT      THRU 0083-EXIT
<            IF END-OF-CERT
---
>            IF PREHIST-ACCOUNT = '0001000100'
>                DISPLAY '001 account CLM CNTL ' PREHIST-ACCT-CONTROL
>                ADD +1                  TO WS-001ACCT-CNT
>                SET CERT-FOUND TO TRUE
195c263,279
<            IF CR-ACCT-CONTROL <= DE-CNTRL1
---
>            IF PREHIST-CERT-NO (7:10) = 'none'
>                DISPLAY 'cert is "none" ' PREHIST-ACCOUNT (6:8) ' ' 
>                               PREHIST-CERT-NO
>                DISPLAY ' '
>                ADD +1                  TO WS-NONE-CERT-CNT
>                SET CERT-FOUND TO TRUE
>                GO TO 0070-EXIT
>            END-IF
> 
>            IF PREHIST-CERT-NO = '0000000000'
>                DISPLAY ' zero cert# CLM CONTROL ' PREHIST-ACCT-CONTROL
>                ADD +1                  TO WS-ZERO-CERT-CNT
>                SET CERT-FOUND TO TRUE
>                GO TO 0070-EXIT
>            END-IF
> 
>            IF CR-ACCT-CONTROL <= PREHIST-ACCT-CONTROL
198,201c282,288
<                DISPLAY 'CERT ACCT CNTRL should not be GT Claim'
<                DISPLAY ' CERT CNTL ' CR-ACCT-CONTROL
<                DISPLAY ' CLM CNTL ' DE-CNTRL1
<                PERFORM ABEND-PGM
---
>                DISPLAY ' CERT ACCT > CLM ACCT ' CR-ACCOUNT (6:8) ' '
>                                 CR-CERT
>                DISPLAY '   On claim file - ' PREHIST-ACCOUNT (6:8) ' '
>                                 PREHIST-CERT-NO
>                DISPLAY ' '
>                SET CERT-FOUND TO TRUE
>                GO TO 0070-EXIT 
204c291
<            IF CR-ACCT-CONTROL = DE-CNTRL1
---
>            IF CR-ACCT-CONTROL = PREHIST-ACCT-CONTROL
207a295
>                PERFORM 0083-READ-CERT      THRU 0083-EXIT
211c299
<            IF CR-CERT-NO <= DE-CERT
---
>            IF CR-CERT <= PREHIST-CERT-NO
214,217c302,308
<                DISPLAY 'CERT NUM should not be GT Claim cert num'
<                DISPLAY ' CERT NUM ' CR-CERT-NO
<                DISPLAY ' CLM CERT ' DE-CERT
<                PERFORM ABEND-PGM
---
>                DISPLAY ' CERT CERT > CLM CERT ' CR-ACCOUNT (6:8) ' '
>                                CR-CERT
>                DISPLAY '   On claim file - ' PREHIST-ACCOUNT (6:8) ' '
>                                 PREHIST-CERT-NO
>                DISPLAY ' ' 
>                SET CERT-FOUND TO TRUE
>                GO TO 0070-EXIT 
220,221c311,313
<            IF CR-CERT-NO = DE-CERT
<                CONTINUE
---
> 
>            IF CR-CERT = PREHIST-CERT-NO
>                ADD +1 TO WS-MATCH-CNT
223a316
>                PERFORM 0083-READ-CERT      THRU 0083-EXIT
227c320
<            IF CR-DT = DE-EFF
---
>            IF CR-DT = PREHIST-CERT-EFF-DT
230,231c323,327
<                DISPLAY ' NO MATCH on CERT EFF DATE ' CR-FULL-CONTROL
<                DISPLAY ' CLAIM CONTROL ' DE-CONTROL
---
>                DISPLAY 'NO MATCH CERTEFF DT ' CR-ACCOUNT (6:8) ' '
>                             CR-CERT
>                DISPLAY '   On claim file - ' PREHIST-ACCOUNT (6:8) 
>                             ' ' PREHIST-CERT-NO
>                DISPLAY ' ' 
235,243d330
<  
<            IF DE-DEATH
<                MOVE DE-INCUR           TO CR-DTH-DT
<                MOVE DE-REPORTED        TO CR-DTH-RPT-DT
<                MOVE DE-PAY             TO CR-DTH-PAY-DT
<                MOVE DE-CLAIM-AMT       TO CR-DTHAMT
<                MOVE DE-PAY-CODE        TO CR-DTH-PAY-CD
<                MOVE DE-CLM-CAUSE       TO CR-DEATH-CAUSE
<            END-IF
245,253c332,333
<            IF DE-DISABILITY
<                MOVE DE-INCUR           TO CR-DIS-DT
<                MOVE DE-REPORTED        TO CR-DIS-RPT-DT
<                MOVE DE-PAY             TO CR-DIS-PAY-DT
<                MOVE DE-PAID-TO         TO CR-DIS-PTO-DT
<                MOVE DE-CLAIM-AMT       TO CR-DISAMT
<                MOVE DE-DAYS-DISAB      TO CR-DAYS-DISAB
<                MOVE DE-PAY-CODE        TO CR-DIS-PAY-CD
<                MOVE DE-CLM-CAUSE       TO CR-DISAB-CAUSE
---
>            MOVE PREHIST-DEATH-CLM-DATA TO CR-DEATH-CLAIM-DATA 
>            MOVE PREHIST-DISAB-CLM-DATA TO CR-DISAB-CLAIM-DATA 
255,259d334
<                PERFORM 0075-INCUR-DETAIL THRU 0075-EXIT
<                    VARYING INCUR-INDEX FROM +1 BY +1
<                    UNTIL INCUR-INDEX > +5
<            END-IF
< 
260a336
>            PERFORM 0083-READ-CERT      THRU 0083-EXIT
266d341
<        0075-INCUR-DETAIL.
268,278c343
<            IF CR-DIS-INCUR-DT (INCUR-INDEX) = ZEROS
<                MOVE DE-INCUR           TO CR-DIS-INCUR-DT (INCUR-INDEX)
<                MOVE DE-CLAIM-AMT       TO CR-INCUR-DISAMT (INCUR-INDEX)
<                MOVE +6                 TO INCUR-INDEX
<            END-IF
<  
<            .
<        0075-EXIT.
<            EXIT.
<            
<        0080-READ-CLMS.
---
>        0080-READ-PREHIST.
280,281c345,347
<            READ SAL-LOGICCLMS-IN 
<                AT END SET END-OF-CLMS  TO TRUE
---
>            READ SAL-PREHIST-IN 
>                AT END SET END-OF-PREHIST TO TRUE
>                       DISPLAY 'End of Prehist'
285c351
<            ADD +1                      TO WS-CLM-IN-CNT
---
>            ADD +1                      TO WS-PREHIST-IN-CNT
292a359
>            PERFORM 0085-WRITE-CERT     THRU 0085-EXIT
294,296d360
<            IF NOT END-OF-CERT
<                PERFORM 0085-WRITE-CERT THRU 0085-EXIT
<            END-IF
334a399,403
> 
>            DISPLAY ' CLAIM RECORDS IN  ' WS-PREHIST-IN-CNT
>            DISPLAY ' CERT RECORDS IN  ' WS-CERT-IN-CNT
>            DISPLAY ' CERT RECORDS OUT ' WS-CERT-OUT-CNT
>            DISPLAY ' MATCH COUNT ' WS-MATCH-CNT
438,444c438,442
<            IF GR-STATE = 'VA'  
<       *       and (gr-eff > 20001231)
<       *       AND (GR-EFF < 20020101)
<               continue
<            else
<               go to 0110-read-next-gaap-record
<            end-if	    		
---
>            IF GR-ACCOUNT = '0001010100'
>               CONTINUE
>            ELSE
>               GO TO 0110-READ-NEXT-GAAP-RECORD
>            END-IF	    		
1064c1062
< 01026      MOVE GR-CERT     TO L1-CERT.                                 
---
> 01026      MOVE GR-CERT-NO  TO L1-CERT.                                 
417a418
> 062703     COPY ELCEXTM1.
717c718
< 00716      DISPLAY AT-PAYMENT-TYPE.                                     EL334
---
> 00716 *    DISPLAY AT-PAYMENT-TYPE.                                     EL334
794a796
> 062703     COPY ELCEXTM1.
65a66,74
>        77  WS-BLANK-INCUR-DT-CNT       PIC 9(9)   VALUE ZEROS.
>        77  WS-BLANK-REPORT-DT-CNT      PIC 9(9)   VALUE ZEROS.
>        77  WS-BLANK-PAID-DT-CNT        PIC 9(9)   VALUE ZEROS.
>        77  WS-BLANK-TO-DT-LF-CNT       PIC 9(9)   VALUE ZEROS.
>        77  WS-BLANK-TO-DT-DIS-CNT      PIC 9(9)   VALUE ZEROS.
>        77  WS-BLANK-PAY-AMT-CNT        PIC 9(9)   VALUE ZEROS.
>        77  WS-BLANK-PAY-TYPE-CNT       PIC 9(9)   VALUE ZEROS.
>        77  WS-BLANK-PTYPE-AMT-CNT      PIC 9(9)   VALUE ZEROS.
>        77  WS-DROP-REC-CNT             PIC 9(9)   VALUE ZEROS.
108d116
<            DISPLAY 'INITIAL READ'
130,131c138,148
<            DISPLAY ' SALA RECORDS INPUT    ' WS-INPUT-CNT
<            DISPLAY ' CLM RECORDS OUTPUT   ' WS-OUTPUT-CNT
---
>            DISPLAY ' SALA RECORDS INPUT     ' WS-INPUT-CNT
>            DISPLAY ' BLANK INCURRED DATES   ' WS-BLANK-INCUR-DT-CNT
>            DISPLAY ' BLANK REPORTED DATES   ' WS-BLANK-REPORT-DT-CNT
>            DISPLAY ' BLANK PAID DATES       ' WS-BLANK-PAID-DT-CNT
>            DISPLAY ' BLANK PTO DATES LF     ' WS-BLANK-TO-DT-LF-CNT
>            DISPLAY ' BLANK PTO DATES DIS    ' WS-BLANK-TO-DT-DIS-CNT
>            DISPLAY ' BLANK PAY AMT          ' WS-BLANK-PAY-AMT-CNT
>            DISPLAY ' BLANK PAY TYPE         ' WS-BLANK-PAY-TYPE-CNT
>            DISPLAY ' BLANK PAY TYPE & AMT   ' WS-BLANK-PTYPE-AMT-CNT
>            DISPLAY ' DROP RECORDS           ' WS-DROP-REC-CNT
>            DISPLAY ' CLM RECORDS OUTPUT     ' WS-OUTPUT-CNT
143d159
<            DISPLAY 'Into process input ' SAL-CLAIM-RECORD
155a172,181
> 
>            IF SAL-CLM-PAYMENT NOT = ZEROS
>               AND SPACES
>                CONTINUE
>            ELSE
>       *        DISPLAY ' PAY AMT was blank ' SAL-ACCT-NUM ' '
>       *                    SAL-CERT-NUM SAL-CLAIM-RECORD
>                ADD +1 TO WS-BLANK-PAY-AMT-CNT
>            END-IF
> 
157a184,200
>            IF SAL-INCUR-DT NOT = ZEROS
>               AND SPACES
>                CONTINUE
>            ELSE
>                IF SAL-CERT-NUM = ZEROS 
>                   OR  SAL-ACCT-NUM = '0001000100'
>                   OR  SAL-CERT-NUM = '000000none'
>                   OR  SAL-DENY-REASON = '2'
>                   OR  SAL-CLM-PAYMENT = ZEROS
>                    CONTINUE
>                ELSE
>       *        DISPLAY ' INCUR DT was blank ' SAL-ACCT-NUM ' '
>       *                    SAL-CERT-NUM SAL-CLAIM-RECORD
>                    ADD +1 TO WS-BLANK-INCUR-DT-CNT
>                END-IF
>            END-IF
> 
160a204,220
>            IF SAL-REPORT-DT NOT = ZEROS
>               AND SPACES
>                CONTINUE
>            ELSE
>                IF SAL-CERT-NUM = ZEROS 
>                   OR  SAL-ACCT-NUM = '0001000100'
>                   OR  SAL-CERT-NUM = '000000none'
>                   OR  SAL-DENY-REASON = '2'
>                   OR  SAL-CLM-PAYMENT = ZEROS
>                    CONTINUE
>                ELSE
>       *        DISPLAY ' REPORT DT was blank ' SAL-ACCT-NUM ' '
>       *                    SAL-CERT-NUM SAL-CLAIM-RECORD
>                    ADD +1 TO WS-BLANK-REPORT-DT-CNT
>                END-IF
>            END-IF
> 
175d234
<                    DISPLAY 'DAYS in mo ' DC-DAYS-IN-MONTH
181,182c240,242
<                DISPLAY ' PAID DT was blank ' SAL-ACCT-NUM ' '
<                            SAL-CERT-NUM SAL-CLAIM-RECORD
---
>       *        DISPLAY 'PAID DT blank  ' SAL-ACCT-NUM ' '
>       *                    SAL-CERT-NUM SAL-CLAIM-RECORD
>                ADD +1 TO WS-BLANK-PAID-DT-CNT
188,189c248,270
<            MOVE SAL-CLM-PAID-TO-DT     TO WS-DATE-X 
<            MOVE WS-DATE-9              TO DE-PAID-TO
---
>            IF SAL-CLM-PAID-TO-DT NOT = ZEROS
>               AND SPACES
>                MOVE SAL-CLM-PAID-TO-DT TO WS-DATE-X 
>                MOVE WS-DATE-9          TO DE-PAID-TO
>            ELSE
>                MOVE SAL-CLM-PAID-DT    TO WS-DATE-X 
>                IF SAL-CERT-NUM = ZEROS 
>                   OR  SAL-ACCT-NUM = '0001000100'
>                   OR  SAL-CERT-NUM = '000000none'
>                   OR  SAL-DENY-REASON = '2'
>                   OR  SAL-CLM-PAYMENT = ZEROS
>                    CONTINUE
>                ELSE
>                    IF SAL-CLM-TYPE = '2' 
>                        DISPLAY 'TO DT blank for dis ' SAL-ACCT-NUM ' '
>                            SAL-CERT-NUM ' ' WS-DATE-X
>                        ADD +1 TO WS-BLANK-TO-DT-DIS-CNT
>                    ELSE 
>                        ADD +1 TO WS-BLANK-TO-DT-LF-CNT
>                    END-IF
>                END-IF
>                MOVE WS-DATE-9          TO DE-PAID-TO
>            END-IF
194,195c275,289
<            MOVE SAL-PAY-TYPE           TO DE-PAY-CODE
<            MOVE SAL-CLM-CAUSE          TO DE-CLM-CAUSE
---
> 
>            IF SAL-PAY-TYPE NOT = SPACE
>                MOVE SAL-PAY-TYPE       TO DE-PAY-CODE
>                MOVE SAL-CLM-CAUSE      TO DE-CLM-CAUSE
>            ELSE
>                IF SAL-CLM-PAYMENT = ZEROS
>       *            DISPLAY ' PAY TYPE was blank ' SAL-ACCT-NUM ' '
>       *                    SAL-CERT-NUM SAL-CLAIM-RECORD
>                    ADD +1 TO WS-BLANK-PTYPE-AMT-CNT
>                ELSE
>                    DISPLAY ' PAY TYPE was blank ' SAL-ACCT-NUM ' '
>                            SAL-CERT-NUM SAL-CLAIM-RECORD
>                    ADD +1 TO WS-BLANK-PAY-TYPE-CNT
>                END-IF
>            END-IF
201,202c295,298
<                DISPLAY 'NOT WRITING CLAIM REC ' SAL-ACCT-NUM ' '
<                         SAL-CERT-NUM ' ' SAL-DENY-REASON
---
>               OR  SAL-CLM-PAYMENT = ZEROS
>       *        DISPLAY 'NOT WRITING CLAIM REC ' SAL-ACCT-NUM ' '
>       *                 SAL-CERT-NUM ' ' SAL-DENY-REASON
>                ADD +1 TO WS-DROP-REC-CNT
205d300
<                DISPLAY 'WRITE'
232d326
<            DISPLAY 'READ'
30d29
<                                                                         
31a31,33
>            SELECT FREEDOM-EXTRACT      ASSIGN TO SYS012
>               ORGANIZATION IS LINE SEQUENTIAL.
>                                                                         
48c50,57
<        EJECT
---
> 
>        FD  FREEDOM-EXTRACT                                              
>            LABEL RECORDS ARE STANDARD                                   
>            RECORDING MODE IS F                                          
>            BLOCK CONTAINS 0 RECORDS.                                    
>        01  FREEDOM-RECORD      PIC X(250).                              
>                                                                         
>        EJECT 
209a219,221
>        01  WS-EXTRACT-RECORD.
>                                        COPY FNC022.
> 
241a254
>            05  WS-POSTING-DATE         PIC X(8).
249a263,267
>            12  WS-FREEDOM-TABLE.
>                16  FILLER OCCURS       55.
>                    20  WS-FREE-STATE   PIC XX.
>                    20  WS-FREE-PREM    PIC S9(9)V99 COMP-3 VALUE +0.
>                    20  WS-FREE-COMM    PIC S9(9)V99 COMP-3 VALUE +0.
329a348,358
>            PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
>               (WS-A > +55)
>               MOVE LOW-VALUES          TO WS-FREE-STATE (WS-A)
>               MOVE +0                  TO WS-FREE-PREM (WS-A)
>                                           WS-FREE-COMM (WS-A)
>            END-PERFORM
>            
>            MOVE RUN-DATE               TO WS-WORK-DATE
>            MOVE WS-WORK-MMDD           TO WS-POSTING-DATE (1:4)
>            MOVE WS-WORK-CCYY           TO WS-POSTING-DATE (5:4)
> 
338c367
<                OUTPUT PRINTX
---
>                OUTPUT PRINTX FREEDOM-EXTRACT
360c389
<                  ERDUEP
---
>                  ERDUEP FREEDOM-EXTRACT
414a444
>            PERFORM 0350-CREATE-FREEDOM THRU 0350-EXIT
467c497,498
<               / (DP-REC-PREM + DP-BASE-COMM)
---
>       *       / (DP-REC-PREM + DP-BASE-COMM)
>               / (DP-EXP-PREM + DP-BASE-COMM)
469c500,501
<               / (DP-REC-PREM + DP-BASE-COMM)
---
>       *       / (DP-REC-PREM + DP-BASE-COMM)
>               / (DP-EXP-PREM + DP-BASE-COMM)
520,521d551
<            DISPLAY ' MADE IT TO 0300 ACCT BREAK '
< 
577d606
<            DISPLAY ' MADE IT TO 0310  ST  BREAK '
598a628,642
>               PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
>                  (WS-FREE-STATE (WS-A) = LOW-VALUES)
>                  OR (WS-FREE-STATE (WS-A) = WS-HOLD-ST)
>                  OR (WS-A > +55)
>               END-PERFORM
>               IF WS-A NOT > +55
>                  MOVE WS-HOLD-ST       TO WS-FREE-STATE (WS-A)
>                  COMPUTE WS-FREE-PREM (WS-A) = WS-FREE-PREM (WS-A)
>                     + WS-TOT-END-BAL (2)
>                  COMPUTE WS-FREE-COMM (WS-A) = WS-FREE-COMM (WS-A)
>                     + WS-TOT-DUE-COMM (2)
>               ELSE
>                  DISPLAY ' FREEDOM TABLE EXCEEDED '
>                  PERFORM ABEND-PGM
>               END-IF
634d677
<            DISPLAY ' MADE IT TO 0320 GRP  BREAK '
691d733
<            DISPLAY ' MADE IT TO 0330 CAR  BREAK '
748d789
<            DISPLAY ' MADE IT TO 0340 FIN  BREAK '
777a819,825
>        0350-CREATE-FREEDOM.
>        
>            MOVE SPACES                 TO WS-EXTRACT-RECORD
>            MOVE 'LPACDUEPC'            TO FX-SYSTEM
>            MOVE 'LOGIC '               TO FX-SOURCE-CODE
>            MOVE '11'                   TO FX-DIVISION
>            MOVE '15'                   TO FX-SUB-TYPE
778a827,829
>            MOVE 'Y'                    TO FX-LOC-CODE
>            
>            MOVE WS-POSTING-DATE        TO FX-POSTING-DATE                          
779a831,835
>            IF DTE-CLIENT = 'CID'
>               MOVE 'S'                 TO FX-FY-REN
>            ELSE
>               MOVE ' '                 TO FX-FY-REN
>            END-IF
780a837,853
>            MOVE ZEROS                  TO FX-AMOUNT
>                                                                         
>            PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
>               (WS-A > +55)
>               OR (WS-FREE-STATE (WS-A) = LOW-VALUES)
>               MOVE WS-FREE-STATE (WS-A)
>                                        TO FX-STATE
>               MOVE 'DUE PREMIUM '      TO FX-DESCRIPTION
>               MOVE WS-FREE-PREM (WS-A) TO FX-AMOUNT
>               MOVE '30'                TO FX-TRAN-TYPE
>               WRITE FREEDOM-RECORD     FROM WS-EXTRACT-RECORD
>               MOVE 'DUE COMMISSION'    TO FX-DESCRIPTION
>               MOVE WS-FREE-COMM (WS-A) TO FX-AMOUNT
>               MOVE '50'                TO FX-TRAN-TYPE
>               WRITE FREEDOM-RECORD     FROM WS-EXTRACT-RECORD
>            END-PERFORM
>            
781a855,861
>        0350-EXIT.
>            EXIT.
> 
> 
> 
> 
>            .
843,846c923,924
<        8699-EXIT.                                                       ECS064
<            EXIT.                                                        ECS064
<                                                                         ECS064
<        8800-PRT-RTN.                                                    ECS064
---
>        8699-EXIT.
>            EXIT.
847a926,927
>        8800-PRT-RTN.
> 
76,79c76,79
< 062403 01  WS-NO-INPUT-MSG.
< 062403     05  FILLER             PIC X(01)      VALUE '0'.
< 062403     05  FILLER             PIC X(79)      VALUE
< 062403     'THERE WERE NO CLAIM RECORDS TO PROCESS'.
---
>        01  WS-NO-INPUT-MSG.
>            05  FILLER             PIC X(01)      VALUE '0'.
>            05  FILLER             PIC X(79)      VALUE
>            'THERE WERE NO CLAIM RECORDS TO PROCESS'.
82c82
< pemuni     05  filler      pic x       value spaces.
---
> pemuni     05  FILLER      PIC X       VALUE SPACES.
250,252c250,252
<            05  FILLER                       PIC X(33)  VALUE 
<                'MASTER CERTIFICATE EFFECTIVE DATE'.
<            05  FILLER                       PIC X(55)  VALUE SPACES.
---
>            05  FILLER                       PIC X(32)  VALUE 
>                'MASTER  CONTRACT  EFFECTIVE DATE'.
>            05  FILLER                       PIC X(56)  VALUE SPACES.
46a47,48
> 060303* 060303                   SMVA  STOP RECALC ON LITTLE CERTS 
> 070203* 070203                   SMVA  DONT COUNT OWRITES ON LITTLE CERTS
287c289
< 00277                              COPY ECSCOM01T.                      ECS061
---
> 00277                              COPY ECSCOM01.                       ECS061
1191c1193,1203
< 01179          GO TO 6240-COMM-OW.                                      ECS061
---
> 070203         IF NOT CP-MONTHLY-ISSUE
> 070203             DISPLAY '3.92 overwrite ' CP-RECORD
> 070203             DISPLAY 'cp trans ' CP-TRANS
> 070203             DISPLAY 'cp entry ' CP-ENTRY-STATUS
> 070203             DISPLAY 'acct ' CP-ACCOUNT
> 070203             DISPLAY 'remit ' CP-REMIT
> 070203             DISPLAY 'cert ' CP-CERT
> 070203             DISPLAY 'alt cert ' CP-ALT-CERT-NO
> 01179              GO TO 6240-COMM-OW
> 070203         END-IF
> 070203     END-IF.
1193,1196c1205,1211
< 01181      IF CP-BILLED                                                 ECS061
< 01182          ADD +1                  TO  COMP-TRAN-N-B                ECS061
< 01183      ELSE                                                         ECS061
< 01184          ADD +1                  TO  COMP-TRAN-N.                 ECS061
---
> 070203     IF NOT CP-MONTHLY-ISSUE
> 01181          IF CP-BILLED           
> 01182              ADD +1              TO  COMP-TRAN-N-B                ECS061
> 01183          ELSE    
> 01184              ADD +1              TO  COMP-TRAN-N
> 070203         END-IF
> 070203     END-IF.
1218,1223c1233,1240
< 01204         ADD CP-LF-PRM            TO  COMP-RECALC-P                ECS061
< 01205         ADD CP-LF-PRM-ALT        TO  COMP-RECALC-P                ECS061
< 01206         ADD CP-AH-PRM            TO  COMP-RECALC-P                ECS061
< 01207         ADD CP-LF-COM            TO  COMP-RECALC-C                ECS061
< 01208         ADD CP-LF-COM-ALT        TO  COMP-RECALC-C                ECS061
< 01209         ADD CP-AH-COM            TO  COMP-RECALC-C
---
> 060303        IF NOT CP-MONTHLY-ISSUE
> 01204             ADD CP-LF-PRM        TO  COMP-RECALC-P                ECS061
> 01205             ADD CP-LF-PRM-ALT    TO  COMP-RECALC-P                ECS061
> 01206             ADD CP-AH-PRM        TO  COMP-RECALC-P                ECS061
> 01207             ADD CP-LF-COM        TO  COMP-RECALC-C                ECS061
> 01208             ADD CP-LF-COM-ALT    TO  COMP-RECALC-C                ECS061
> 01209             ADD CP-AH-COM        TO  COMP-RECALC-C
>               END-IF
43a44,45
> 070803* 070803                   SMVA  FIX Z TRANS PICKING UP WRONG 
> 070803*                                ENTRY STATUS
77c79
< 00067                              COPY ECSCOM01T.                      ECS017
---
> 00067                              COPY ECSCOM01.                       ECS017
478,480d479
< 122002*    IF DE-ENTRY-STATUS = 'M'
< 122002*       MOVE 'M'                 TO CP-TRANS
< 122002*    END-IF
1341c1340,1344
< 122002     MOVE DE-ENTRY-STATUS        TO CP-ENTRY-STATUS.
---
> 
> 070803     IF CP-TRANS NOT = 'Z'
> 122002         MOVE DE-ENTRY-STATUS    TO CP-ENTRY-STATUS
> 070803     END-IF.
> 
7,16d6
<       *    THIS PROGRAM READS THE MONTH END CERT FILE AND CLMS FILE
<       *    AND BUILDS AN EXTRACT BY ISSUE YEAR.  THE EXTRACT IS
<       *    PRIMARLIY USED BY ACTUARIAL.  THE REFUNDS SELECTED ARE
<       *    PLACED IN THE VALUATION YEAR BASED ON THE CANCEL DATE.
<       *    THE CLAIMS SELECTED ARE PLACED IN THE VALUATION YEAR
<       *    BASED ON INCURRED DATE.  THE LOWEST ISSUE YEAR WILL ALWAYS
<       *    BE 1986.  IF YOU NEED TO CHANGE THAT SIMPLY CHANGE THE
<       *    HARD CODING WHERE YOU FIND MOVE 1986 TO LO-ISSUE AND
<       *    LO-VALUATION.  ANY CHANGES MADE TO THE SPECIAL ECS083
<       *    MUST ALSO BE MADE IN THIS PROGRAM.
41d30
< 
98c87
<                                            COPY ERCPYAJ.
---
>                                        COPY ERCPYAJ.
229a219
>            05  WS-WORK-TERM            PIC S999   COMP-3 VALUE +0.
291c281,282
<            05  WS-TEST-RUN-DATE        PIC 9(11).
---
>            05  WS-THIS-MONTH-DATE      PIC 9(11).
>            05  WS-LAST-MONTH-DATE      PIC 9(11).
321a313
>            05  WS-POSTING-DATE         PIC X(8).
360c352
<            12  WS-ANGLEN               PIC S9(7)V99 COMP-3  VALUE +0.
---
>            12  WS-ANGLEN               PIC S9(5)V9999 COMP-3  VALUE +0.
362,364c354,357
<            12  WS-ANGLEM               PIC S9(7)V99 COMP-3  VALUE +0.
<            12  WS-ANGLEMJ              PIC S9(7)V99 COMP-3  VALUE +0.
<            12  WS-ANGLEN-M             PIC S9(7)V99 COMP-3  VALUE +0.
---
>            12  WS-WORK-AMT             PIC S9(9)V99 COMP-3  VALUE +0.
>            12  WS-ANGLEM               PIC S9(5)V9999 COMP-3  VALUE +0.
>            12  WS-ANGLEMJ              PIC S9(5)V9999 COMP-3  VALUE +0.
>            12  WS-ANGLEN-M             PIC S9(5)V9999 COMP-3  VALUE +0.
371a365,366
>            12  WS-GIANT-SW             PIC X           VALUE SPACES.
>                88  THIS-IS-A-GIANT-CERT                VALUE 'X'.
394d388
<       *    MOVE SPACES                 TO  SAVE-COMPANY-NAME
397c391
<       *    MOVE SPACE-NP               TO  P-REC
---
>            MOVE RUN-DATE               TO WS-THIS-MONTH-DATE
399,400d392
<            MOVE RUN-DATE               TO WS-TEST-RUN-DATE
< 
409d400
< 
415d405
< 
436a427,443
>            MOVE BIN-RUN-DATE           TO DC-BIN-DATE-1
>            MOVE -1                     TO DC-ELAPSED-MONTHS
>            MOVE +0                     TO DC-ELAPSED-DAYS
>            MOVE '6'                    TO DC-OPTION-CODE
>            PERFORM 8510-DATE-CONVERSION
>                                        THRU 8590-EXIT
>            IF NO-CONVERSION-ERROR
>               MOVE DC-GREG-DATE-CYMD   TO WS-LAST-MONTH-DATE
>               DISPLAY ' LAST MONTH IS ' WS-LAST-MONTH-DATE
>            ELSE
>               DISPLAY ' ERROR IN LAST MONTH DATE CONVERSION '
>            END-IF
> 
>            MOVE RUN-DATE               TO WS-WORK-DATE
>            MOVE WS-WORK-MMDD           TO WS-POSTING-DATE (1:4)
>            MOVE WS-WORK-CCYY           TO WS-POSTING-DATE (5:4)
> 
513a521,522
>               ELSE
>                  DISPLAY ' GOOD START ON ERPYAJ '
525c534,535
<            IF ERPYAJ-FILE-STATUS = '10' OR '23'
---
>            IF (ERPYAJ-FILE-STATUS = '10' OR '23')
>               OR (PY-COMPANY-CD > DTE-CLASIC-COMPANY-CD)
533a544,545
>               ELSE
>                  DISPLAY ' GOOD READ ON ERPYAJ ' PY-CONTROL-PRIMARY
546a559
>       *       DISPLAY ' FOUND A HIT ' 
582a596
> 
602a617
>               MOVE ' '                 TO WS-GIANT-SW
610a626,632
>            IF (CR-LFTYP = 'MG' OR 'MJ' OR 'NJ' OR 'NL')
>               OR (CR-AHTYP = 'MG' OR 'MJ' OR 'NJ' OR 'NL')
>               IF CR-ENTRY-DATE = WS-THIS-MONTH-DATE
>                  SET THIS-IS-A-GIANT-CERT TO TRUE
>               END-IF
>            END-IF
>            
673,674c695,696
<            MOVE +0                     TO WS-DP-ADJ
< 
---
>       *    MOVE +0                     TO WS-DP-ADJ
>       *    DISPLAY ' CERT KEY TO MATCH ' WS-PYAJ-MATCH-KEY
698c720
<               + WS-REC-BASE-COMM 
---
>               + WS-BASE-COMM 
747,751c769,776
<            IF WS-BASE-COMM > ZEROS
<               MOVE WS-BASE-COMM        TO EXT-BASE-COMM
<            ELSE
<               MOVE WS-REC-BASE-COMM    TO EXT-BASE-COMM
<            END-IF
---
>            MOVE WS-BASE-COMM           TO EXT-BASE-COMM
> 
>       *    IF WS-BASE-COMM > ZEROS
>       *       MOVE WS-BASE-COMM        TO EXT-BASE-COMM
>       *    ELSE
>       *       MOVE WS-REC-BASE-COMM    TO EXT-BASE-COMM
>       *    END-IF
> 
774a800
>                                           WS-DP-ADJ
782c808
<            COMPUTE WS-DP-BASE-COMM = WS-DP-BASE-COMM + WS-REC-BASE-COMM
---
>            COMPUTE WS-DP-BASE-COMM = WS-DP-BASE-COMM + WS-BASE-COMM
797c823
<               COMPUTE WS-DP-REC-PREM = WS-DP-REC-PREM
---
>       *       COMPUTE WS-DP-REC-PREM = WS-DP-REC-PREM
943,944c969,986
<            IF CR-LFTYP = '00' OR '  '
<               CONTINUE
---
>            IF (WS-BIN-LF-END-DATE NOT > BIN-RUN-DATE)
>               AND (NOT THIS-IS-A-GIANT-CERT)
>               MOVE ZEROS               TO CR-LFPRM
>                                           CR-LFTYP
>                                           CR-LF-TERM
>                                           CR-LFPRM-RATE
>            END-IF
> 
>            IF (WS-BIN-AH-END-DATE NOT > BIN-RUN-DATE)
>               AND (NOT THIS-IS-A-GIANT-CERT)
>               MOVE ZEROS               TO CR-AHPRM
>                                           CR-AHTYP
>                                           CR-AH-TERM
>                                           CR-AHPRM-RATE
>            END-IF
> 
>            IF CR-LF-TERM > CR-AH-TERM
>               MOVE CR-LF-TERM          TO WS-WORK-TERM
946c988
<               PERFORM 0210-CALC-LIFE-UEP   THRU 0210-EXIT
---
>               MOVE CR-AH-TERM          TO WS-WORK-TERM
947a990,1000
>            
>            IF (CR-LFTYP = '00' OR '  ')
>               AND (CR-AHTYP = '00' OR '  ')
>               CONTINUE
>            ELSE
>               PERFORM 0205-CALC-UEP    THRU 0205-EXIT
>               IF LF-REM-TRM2 > AH-REM-TRM2
>                  MOVE LF-REM-TRM2      TO REM-TRM2
>               ELSE
>                  MOVE AH-REM-TRM2      TO REM-TRM2
>               END-IF
948a1002,1005
>               PERFORM 0210-CALC-UEP    THRU 0210-EXIT
>            END-IF
>               
>            
954c1011,1016
<        0210-CALC-LIFE-UEP.
---
>        0205-CALC-UEP.
>        
>            MOVE +0                     TO LF-REM-TRM1
>                                           LF-REM-TRM2
>                                           AH-REM-TRM1
>                                           AH-REM-TRM2
955a1018,1046
>            IF CR-LFTYP NOT = '  ' AND ZEROS
>               PERFORM 0207-FIND-LIFE-TYPE
>                                        THRU 0207-EXIT
>               IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
>                  CONTINUE
>               ELSE
>                  PERFORM 0220-CALC-LF-REM-TERM
>                                        THRU 0220-EXIT
>               END-IF
>            END-IF
>                                        
>            IF CR-AHTYP NOT = '  ' AND ZEROS
>               PERFORM 0208-FIND-AH-TYPE
>                                        THRU 0208-EXIT
>               IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
>                  CONTINUE
>               ELSE
>                  PERFORM 0225-CALC-AH-REM-TERM
>                                        THRU 0225-EXIT
>               END-IF
>            END-IF
>                                        
>                      
>            .
>        0205-EXIT.
>           EXIT.
>           
>        0207-FIND-LIFE-TYPE.
>        
960,961c1051,1052
<                   (CLAS-INDEXL = CLAS-MAXL) OR
<                   (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
---
>                (CLAS-INDEXL = CLAS-MAXL) OR
>                (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
973c1064,1070
<            IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
---
>            .
>        0207-EXIT.
>            EXIT.
> 
>        0208-FIND-AH-TYPE.
>        
>            IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
976,986c1073,1095
<               PERFORM 0220-CALC-LF-REM-TERM
<                                        THRU 0220-EXIT
<               MOVE ZEROS               TO WS-REM-AMT
<       *       IF LF-REM-TRM2 > ZERO
<       *          PERFORM 2000-CALC-REM-AMT
<       *                                THRU 2999-CALC-REM-AMT-X
<       *       END-IF
<       *       COMPUTE WS-LF-INFORCE = WS-LF-INFORCE + WS-REM-AMT
<               IF CR-LFTYP = ('MG' OR 'MJ' OR 'NJ' OR 'NL')
<                  IF CR-ENTRY-DATE = WS-TEST-RUN-DATE
<                     PERFORM 0215-CALC-RECEIVE 
---
>               PERFORM VARYING CLAS-INDEXA FROM +1 BY +1 UNTIL
>                   (CLAS-INDEXA = CLAS-MAXA) OR
>                   (CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA))
>               END-PERFORM
>               IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
>                  CONTINUE
>               ELSE
>                  DISPLAY ' AH  BENEFIT ' CR-AHTYP ' NOT IN TABLE'
>                  DISPLAY 'RETURN CODE - 0401'
>                  MOVE 0401 TO WS-RETURN-CODE
>                  PERFORM ABEND-PGM
>               END-IF
>            END-IF
> 
>            .
>        0208-EXIT.
>            EXIT.
> 
>        0210-CALC-UEP.
> 
>            MOVE ZEROS                  TO WS-REM-AMT
>            IF THIS-IS-A-GIANT-CERT
>               PERFORM 0215-CALC-RECEIVE 
987a1097,1105
>            ELSE
>               MOVE +0            TO WS-BASE-COMM
>               PERFORM VARYING X1 FROM +1 BY +1 UNTIL
>                  (X1 > +10)
>                  IF CR-AGT-TYPE (X1) = 'C' OR 'D'
>                     COMPUTE WS-BASE-COMM = WS-BASE-COMM
>                     + (CR-LFPRM * CR-LCOM-L (X1))
>                     + (CR-LFPRM-ALT * CR-LCOM-L (X1))
>                     + (CR-AHPRM * CR-LCOM-AH (X1))
989,994c1107,1108
<               ELSE
<                  MOVE +0            TO WS-BASE-COMM
<                  PERFORM VARYING X1 FROM +1 BY +1 UNTIL
<                     (X1 > +10)
<                     IF CR-AGT-TYPE (X1) = 'C' OR 'D'
<                        COMPUTE WS-BASE-COMM = WS-BASE-COMM +
---
>                  IF CR-AGT-TYPE (X1) = 'O' OR 'P'
>                     COMPUTE WS-GA-COMM = WS-GA-COMM +
998,1013d1111
<                     END-IF
<                  END-PERFORM
<                  IF CR-LFTYP (1:1) = 'M'
<                     COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
<                     COMPUTE WS-EXP-PREM = (CR-LFPRM + CR-AHPRM)
<                     IF RUN-DATE = CR-ENTRY-DATE
<                        COMPUTE WS-EXP-PREM = WS-EXP-PREM
<                           * WS-EARN-TERM
<                        COMPUTE WS-BASE-COMM = WS-BASE-COMM
<                           * WS-EARN-TERM
<                     END-IF
<                     COMPUTE WS-EXP-PREM = 
<                        (WS-EXP-PREM - WS-BASE-COMM) 
<                  ELSE
<                     PERFORM 0230-CALC-LF-UEP
<                                        THRU 0230-EXIT
1014a1113,1131
>               END-PERFORM
>               IF (CR-LFTYP (1:1) = 'M')
>                  OR (CR-AHTYP (1:1) = 'M')
>       *          COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
>                  COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TRM2
>                  COMPUTE WS-EXP-PREM = (CR-LFPRM + CR-AHPRM)
>                  IF RUN-DATE = CR-ENTRY-DATE
>                     COMPUTE WS-EXP-PREM = WS-EXP-PREM
>                        * WS-EARN-TERM
>                     COMPUTE WS-BASE-COMM = WS-BASE-COMM
>                        * WS-EARN-TERM
>                     COMPUTE WS-GA-COMM   = WS-GA-COMM  
>                        * WS-EARN-TERM
>                  END-IF
>                  COMPUTE WS-EXP-PREM = 
>                     (WS-EXP-PREM - WS-BASE-COMM) 
>               ELSE
>                  PERFORM 0230-CALC-UEP
>                                        THRU 0230-EXIT
1022a1140
> 
1035,1041c1153,1159
<               ELSE
<                  IF CR-AGT-TYPE (X1) = 'O' OR 'P'
<                     COMPUTE WS-GA-COMM = WS-GA-COMM +
<                        (CR-LFPRM * CR-LCOM-L (X1)) +
<                        (CR-LFPRM-ALT * CR-LCOM-L (X1)) +
<                        (CR-AHPRM * CR-LCOM-AH (X1))
<                  END-IF
---
>       *       ELSE
>       *          IF CR-AGT-TYPE (X1) = 'O' OR 'P'
>       *             COMPUTE WS-GA-COMM = WS-GA-COMM +
>       *                (CR-LFPRM * CR-LCOM-L (X1)) +
>       *                (CR-LFPRM-ALT * CR-LCOM-L (X1)) +
>       *                (CR-AHPRM * CR-LCOM-AH (X1))
>       *          END-IF
1101,1102c1219,1220
<            DISPLAY ' CERT ' CR-CERT-NO ' TERM ' CR-LF-TERM
<               ' REM2 ' LF-REM-TRM2
---
>       *    DISPLAY ' LF CERT ' CR-CERT-NO ' TERM ' CR-LF-TERM
>       *       ' REM2 ' LF-REM-TRM2
1109c1227,1262
<        0230-CALC-LF-UEP.
---
>        0225-CALC-AH-REM-TERM.
> 
>            MOVE BIN-RUN-DATE           TO CP-VALUATION-DT
> 
>            MOVE CLAS-I-RL-AH (CLAS-INDEXA)
>                                        TO CP-BENEFIT-TYPE
>            MOVE CLAS-I-BAL (CLAS-INDEXA)
>                                        TO CP-SPECIAL-CALC-CD
>            MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
>                                           CP-LOAN-TERM
> 
>            MOVE DTE-REM-TRM-CALC-OPTION
>                                        TO CP-REM-TRM-CALC-OPTION
> 
>            PERFORM 0510-GET-REMAINING-TERM
>                                        THRU 0510-EXIT
> 
>            IF CP-REMAINING-TERM-1 NEGATIVE
>                MOVE ZEROS              TO CP-REMAINING-TERM-1
>            END-IF
> 
>            IF CP-REMAINING-TERM-2 NEGATIVE
>                MOVE ZEROS              TO CP-REMAINING-TERM-2
>            END-IF
> 
>            MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
>            MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
>       *    DISPLAY ' AH CERT ' CR-CERT-NO ' TERM ' CR-AH-TERM
>       *       ' REM2 ' AH-REM-TRM2
>               
>            .
> 
>        0225-EXIT.
>            EXIT.
> 
>        0230-CALC-UEP.
1111,1112c1264,1266
<            DISPLAY ' MADE IT TO 0230 '
<            COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
---
>       *    DISPLAY ' MADE IT TO 0230 '
>       *    COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
>            COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TRM2
1114c1268
<            DISPLAY ' EARN TERM ' WS-EARN-TERM
---
>       *    DISPLAY ' EARN TERM ' WS-EARN-TERM
1120a1275,1277
>            IF CR-LOAN-TERM = ZEROS
>               MOVE CR-AH-TERM          TO CR-LOAN-TERM
>            END-IF
1124c1281
<            DISPLAY ' WS I ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS I ' WS-DISPLAY-FLD
1130c1287
<            DISPLAY ' WS J ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS J ' WS-DISPLAY-FLD
1132c1289,1290
<            COMPUTE WS-VM = (1 + WS-J) ** (CR-LF-TERM * -1)
---
>       *    COMPUTE WS-VM = (1 + WS-J) ** (CR-LF-TERM * -1)
>            COMPUTE WS-VM = (1 + WS-J) ** (WS-WORK-TERM * -1)
1135c1293
<            DISPLAY ' WS VM ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS VM ' WS-DISPLAY-FLD
1138c1296
<               ** (CR-LF-TERM * -1))) / WS-J
---
>               ** (WS-WORK-TERM * -1))) / WS-J
1141c1299
<            DISPLAY ' WS ANGLEMJ ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS ANGLEMJ ' WS-DISPLAY-FLD
1146c1304
<            DISPLAY ' WS ANGLEN  ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS ANGLEN  ' WS-DISPLAY-FLD
1148c1306
<               ** (CR-LF-TERM * -1))) / WS-I
---
>               ** (WS-WORK-TERM * -1))) / WS-I
1151c1309
<            DISPLAY ' WS ANGLEM  ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS ANGLEM  ' WS-DISPLAY-FLD
1153c1311
<               ** ((CR-LOAN-TERM - CR-LF-TERM) * -1))) / WS-I
---
>               ** ((CR-LOAN-TERM - WS-WORK-TERM) * -1))) / WS-I
1156c1314,1319
<            DISPLAY ' WS ANGLEN - M ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS ANGLEN - M ' WS-DISPLAY-FLD
> 
>            IF CR-LFAMT = ZEROS
>               COMPUTE CR-LFAMT = CR-AHAMT * WS-WORK-TERM
>            END-IF
> 
1159c1322
<            DISPLAY ' WS P       ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS P       ' WS-DISPLAY-FLD
1162c1325
<            DISPLAY ' WS B       ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS B       ' WS-DISPLAY-FLD
1164c1327
<               / WS-ANGLEM           
---
>               / WS-ANGLEMJ           
1166c1329
<            DISPLAY ' WS R       ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' WS R       ' WS-DISPLAY-FLD
1168a1332
> 
1170c1334
<            DISPLAY ' LF RATE ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' LF RATE ' WS-DISPLAY-FLD
1172c1336
<            DISPLAY ' AH RATE ' WS-DISPLAY-FLD
---
>       *    DISPLAY ' AH RATE ' WS-DISPLAY-FLD
1187,1189c1351,1353
<               DISPLAY ' ' WS-A '  WS-I1  ' WS-DISPLAY-FLD
<               DISPLAY ' RUN DATE ' RUN-DATE
<               DISPLAY ' ENTRY DATE ' CR-ENTRY-DATE
---
>       *       DISPLAY ' ' WS-A '  WS-I1  ' WS-DISPLAY-FLD
>       *       DISPLAY ' RUN DATE ' RUN-DATE
>       *       DISPLAY ' ENTRY DATE ' CR-ENTRY-DATE
1195a1360
>                  COMPUTE WS-GA-COMM   = WS-GA-COMM   * WS-A
1201c1366
<               DISPLAY ' WS-AMT B4    ' WS-AMT
---
>       *       DISPLAY ' WS-AMT B4    ' WS-AMT
1206c1371
<               DISPLAY ' WS-AMT AFTER ' WS-AMT
---
>       *       DISPLAY ' WS-AMT AFTER ' WS-AMT
1224,1227d1388
<            DISPLAY ' WS-LF-PRM        = ' WS-LF-PRM
<            DISPLAY ' WS-AH-PRM        = ' WS-AH-PRM
<            DISPLAY ' WS-BASE-COMM     = ' WS-BASE-COMM
<            DISPLAY ' WS-REC-BASE-COMM = ' WS-REC-BASE-COMM
1228a1390,1394
> 
>       *    DISPLAY ' WS-LF-PRM        = ' WS-LF-PRM
>       *    DISPLAY ' WS-AH-PRM        = ' WS-AH-PRM
>       *    DISPLAY ' WS-BASE-COMM     = ' WS-BASE-COMM
>       *    DISPLAY ' WS-REC-BASE-COMM = ' WS-REC-BASE-COMM
1234a1401
> 
1269c1436
<            DISPLAY ' MADE IT TO 0300 ACCT BREAK '
---
>       *    DISPLAY ' MADE IT TO 0300 ACCT BREAK '
1304c1471
<            DISPLAY ' MADE IT TO 0310  ST  BREAK '
---
>       *    DISPLAY ' MADE IT TO 0310  ST  BREAK '
1340c1507
<            DISPLAY ' MADE IT TO 0320 GRP  BREAK '
---
>       *    DISPLAY ' MADE IT TO 0320 GRP  BREAK '
1376c1543
<            DISPLAY ' MADE IT TO 0330 CAR  BREAK '
---
>       *    DISPLAY ' MADE IT TO 0330 CAR  BREAK '
1412c1579
<            DISPLAY ' MADE IT TO 0340 FIN  BREAK '
---
>       *    DISPLAY ' MADE IT TO 0340 FIN  BREAK '
1442,1443d1608
<            
<        0420-CALC-AH-REM-TERM.
1445d1609
<            MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
1447,1452d1610
<            MOVE CLAS-I-RL-AH (CLAS-INDEXA)
<                                        TO CP-BENEFIT-TYPE
<            MOVE CLAS-I-BAL (CLAS-INDEXA)
<                                        TO CP-SPECIAL-CALC-CD
<            MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
<                                           CP-LOAN-TERM
1454,1479d1611
<            MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS
< 
<            MOVE DTE-REM-TRM-CALC-OPTION
<                                        TO CP-REM-TRM-CALC-OPTION
< 
<            PERFORM 0510-GET-REMAINING-TERM
<                                        THRU 0510-EXIT
< 
<            IF CP-REMAINING-TERM-1 NEGATIVE
<                MOVE ZEROS              TO CP-REMAINING-TERM-1
<            END-IF
< 
<            IF CP-REMAINING-TERM-2 NEGATIVE
<                MOVE ZEROS              TO CP-REMAINING-TERM-2
<            END-IF
< 
<            MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
<            MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
< 
<            .
< 
<        0420-EXIT.
<            EXIT.
< 
< 
< 
1489,1514d1620
< 
<            .
<        2900-DISPLAY-AMTS.
< 
<       *    IF (CR-DT > 19921231) AND
<       *       (CR-DT < 19940101) AND
<       *    IF (WS-BIN-VAL-DATES (VYR) = X'95FF')
<       *       MOVE CR-DT TO WS-DISPLAY-DATE
<       *       MOVE CR-LF-TERM TO WS-DISPLAY-TERM
<       *       MOVE LF-REM-TRM2 TO WS-DISPLAY-RTERM
<       *       MOVE CR-LFPRM TO WS-DISPLAY-PRM
<       *       IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L'
<       *          ADD CR-LFAMT CR-LFAMT-ALT GIVING WS-DISPLAY-AMT
<       *       ELSE
<       *          MOVE CR-LFAMT     TO WS-DISPLAY-AMT
<       *       END-IF
<       *       MOVE WS-REM-AMT   TO WS-DISPLAY-RAMT
<       *       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
<       *        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
<       *        WS-DISPLAY-AMT '   ' WS-DISPLAY-RAMT
<       *    END-IF
< 
<            .
<        2999-CALC-REM-AMT-X.
<            EXIT.
<        EJECT
1515a1622
> 
1552,1555c1659,1660
<        8699-EXIT.                                                       ECS064
<            EXIT.                                                        ECS064
<                                                                         ECS064
<        8800-PRT-RTN.                                                    ECS064
---
>        8699-EXIT.
>            EXIT.
1556a1662,1663
>        8800-PRT-RTN.
> 
